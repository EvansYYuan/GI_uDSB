Using device: cuda
'Cell Death' Gene Sets:
Loaded 161 genes from HALLMARK_APOPTOSIS
Loaded 200 genes from HALLMARK_P53_PATHWAY
Loaded 49 genes from HALLMARK_REACTIVE_OXYGEN_SPECIES_PATHWAY
Loaded 113 genes from HALLMARK_UNFOLDED_PROTEIN_RESPONSE

'Cell Birth' Gene Sets:
Loaded 200 genes from HALLMARK_E2F_TARGETS
Loaded 200 genes from HALLMARK_G2M_CHECKPOINT
Loaded 200 genes from HALLMARK_MYC_TARGETS_V1
Loaded 58 genes from HALLMARK_MYC_TARGETS_V2

Found 109 matching cell death genes in the HVG set.
Found 32 matching cell birth genes in the HVG set.

Found 123 GRN edges overlapping with prior knowledge.
Loaded 53 GRN rules where both TF and target are in the HVG set.
GRN constraints (HVG-filtered): 53 edges

================================================================================
[Seed 1] Starting running whole pipeline...
================================================================================

[Seed 1] Starting VAE pre-training...

    Epoch [01/20], Beta: 0.000, Average Loss: 542.4795
    Epoch [02/20], Beta: 0.000, Average Loss: 305.0493
    Epoch [03/20], Beta: 0.000, Average Loss: 270.9695
    Epoch [04/20], Beta: 0.000, Average Loss: 252.0539
    Epoch [05/20], Beta: 0.100, Average Loss: 246.8968
    Epoch [06/20], Beta: 0.200, Average Loss: 245.4504
    Epoch [07/20], Beta: 0.300, Average Loss: 245.5577
    Epoch [08/20], Beta: 0.400, Average Loss: 246.4791
    Epoch [09/20], Beta: 0.500, Average Loss: 247.6631
    Epoch [10/20], Beta: 0.600, Average Loss: 248.8001
    Epoch [11/20], Beta: 0.700, Average Loss: 249.9610
    Epoch [12/20], Beta: 0.800, Average Loss: 251.1498
    Epoch [13/20], Beta: 0.900, Average Loss: 252.3078
    Epoch [14/20], Beta: 1.000, Average Loss: 253.8883
    Epoch [15/20], Beta: 1.000, Average Loss: 253.4081
    Epoch [16/20], Beta: 1.000, Average Loss: 253.0522
    Epoch [17/20], Beta: 1.000, Average Loss: 252.6847
    Epoch [18/20], Beta: 1.000, Average Loss: 252.2809
    Epoch [19/20], Beta: 1.000, Average Loss: 251.9322
    Epoch [20/20], Beta: 1.000, Average Loss: 251.7606

[Seed 1] VAE pre-training complete.

[Seed 1] Starting joint training (original)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=259.7714, vae=3.4571, dsb=242.8202, bio=26.9882
    Epoch  2/10: total=72.5757, vae=1.0918, dsb=71.4507, bio=0.0664
    Epoch  3/10: total=64.0976, vae=1.0862, dsb=62.9973, bio=0.0281
    Epoch  4/10: total=60.1929, vae=1.0850, dsb=59.0998, bio=0.0162
    Epoch  5/10: total=57.5940, vae=1.0835, dsb=56.5051, bio=0.0108
    Epoch  6/10: total=55.6621, vae=1.0830, dsb=54.5752, bio=0.0078
    Epoch  7/10: total=54.6065, vae=1.0815, dsb=53.5220, bio=0.0061
    Epoch  8/10: total=53.3392, vae=1.0827, dsb=52.2540, bio=0.0051
    Epoch  9/10: total=52.6477, vae=1.0824, dsb=51.5629, bio=0.0049
    Epoch 10/10: total=52.0573, vae=1.0817, dsb=50.9736, bio=0.0039

  [Backward Policy Training]
    Epoch  1/10: total=3.0523, vae=1.0833, dsb=1.9628, bio=0.0123
    Epoch  2/10: total=2.5903, vae=1.0817, dsb=1.5065, bio=0.0040
    Epoch  3/10: total=2.4751, vae=1.0801, dsb=1.3934, bio=0.0030
    Epoch  4/10: total=2.4529, vae=1.0811, dsb=1.3705, bio=0.0026
    Epoch  5/10: total=2.3864, vae=1.0808, dsb=1.3045, bio=0.0022
    Epoch  6/10: total=2.3766, vae=1.0785, dsb=1.2969, bio=0.0023
    Epoch  7/10: total=2.2962, vae=1.0801, dsb=1.2150, bio=0.0021
    Epoch  8/10: total=2.2862, vae=1.0788, dsb=1.2064, bio=0.0020
    Epoch  9/10: total=2.3014, vae=1.0791, dsb=1.2213, bio=0.0020
    Epoch 10/10: total=2.2741, vae=1.0785, dsb=1.1946, bio=0.0019

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=44.3135, vae=1.0815, dsb=43.2303, bio=0.0034
    Epoch  2/10: total=39.8286, vae=1.0812, dsb=38.7463, bio=0.0021
    Epoch  3/10: total=38.7231, vae=1.0800, dsb=37.6423, bio=0.0018
    Epoch  4/10: total=38.2482, vae=1.0805, dsb=37.1668, bio=0.0017
    Epoch  5/10: total=37.9101, vae=1.0799, dsb=36.8293, bio=0.0017
    Epoch  6/10: total=37.6327, vae=1.0791, dsb=36.5528, bio=0.0017
    Epoch  7/10: total=37.5061, vae=1.0792, dsb=36.4261, bio=0.0016
    Epoch  8/10: total=37.4040, vae=1.0801, dsb=36.3230, bio=0.0018
    Epoch  9/10: total=36.9453, vae=1.0789, dsb=35.8656, bio=0.0016
    Epoch 10/10: total=36.8365, vae=1.0791, dsb=35.7566, bio=0.0015

  [Backward Policy Training]
    Epoch  1/10: total=2.0589, vae=1.0801, dsb=0.9754, bio=0.0068
    Epoch  2/10: total=1.9638, vae=1.0790, dsb=0.8839, bio=0.0017
    Epoch  3/10: total=1.9191, vae=1.0782, dsb=0.8401, bio=0.0016
    Epoch  4/10: total=1.9307, vae=1.0784, dsb=0.8515, bio=0.0015
    Epoch  5/10: total=1.8883, vae=1.0776, dsb=0.8100, bio=0.0014
    Epoch  6/10: total=1.8827, vae=1.0782, dsb=0.8038, bio=0.0016
    Epoch  7/10: total=1.8735, vae=1.0780, dsb=0.7949, bio=0.0014
    Epoch  8/10: total=1.8914, vae=1.0782, dsb=0.8125, bio=0.0014
    Epoch  9/10: total=1.8385, vae=1.0780, dsb=0.7598, bio=0.0014
    Epoch 10/10: total=1.8390, vae=1.0778, dsb=0.7605, bio=0.0014

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=36.7201, vae=1.0807, dsb=35.6380, bio=0.0028
    Epoch  2/10: total=35.0982, vae=1.0786, dsb=34.0190, bio=0.0013
    Epoch  3/10: total=34.6598, vae=1.0791, dsb=33.5801, bio=0.0013
    Epoch  4/10: total=34.4836, vae=1.0786, dsb=33.4044, bio=0.0013
    Epoch  5/10: total=34.4309, vae=1.0786, dsb=33.3517, bio=0.0012
    Epoch  6/10: total=34.2359, vae=1.0779, dsb=33.1573, bio=0.0014
    Epoch  7/10: total=34.1574, vae=1.0783, dsb=33.0785, bio=0.0012
    Epoch  8/10: total=34.0222, vae=1.0783, dsb=32.9433, bio=0.0012
    Epoch  9/10: total=34.0316, vae=1.0779, dsb=32.9531, bio=0.0012
    Epoch 10/10: total=33.7425, vae=1.0776, dsb=32.6642, bio=0.0013

  [Backward Policy Training]
    Epoch  1/10: total=1.7834, vae=1.0782, dsb=0.6872, bio=0.0358
    Epoch  2/10: total=1.7010, vae=1.0772, dsb=0.6231, bio=0.0014
    Epoch  3/10: total=1.6931, vae=1.0769, dsb=0.6156, bio=0.0013
    Epoch  4/10: total=1.6600, vae=1.0773, dsb=0.5820, bio=0.0012
    Epoch  5/10: total=1.6704, vae=1.0778, dsb=0.5919, bio=0.0012
    Epoch  6/10: total=1.6713, vae=1.0762, dsb=0.5946, bio=0.0012
    Epoch  7/10: total=1.6692, vae=1.0762, dsb=0.5924, bio=0.0012
    Epoch  8/10: total=1.6631, vae=1.0763, dsb=0.5862, bio=0.0011
    Epoch  9/10: total=1.6642, vae=1.0766, dsb=0.5870, bio=0.0012
    Epoch 10/10: total=1.6524, vae=1.0761, dsb=0.5758, bio=0.0011

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=29.8899, vae=1.0800, dsb=28.8084, bio=0.0029
    Epoch  2/10: total=29.1610, vae=1.0781, dsb=28.0823, bio=0.0011
    Epoch  3/10: total=28.9995, vae=1.0787, dsb=27.9202, bio=0.0011
    Epoch  4/10: total=28.9253, vae=1.0776, dsb=27.8471, bio=0.0011
    Epoch  5/10: total=28.9187, vae=1.0769, dsb=27.8412, bio=0.0011
    Epoch  6/10: total=29.0215, vae=1.0781, dsb=27.9430, bio=0.0007
    Epoch  7/10: total=28.8988, vae=1.0775, dsb=27.8209, bio=0.0007
    Epoch  8/10: total=28.7392, vae=1.0784, dsb=27.6602, bio=0.0012
    Epoch  9/10: total=28.8212, vae=1.0772, dsb=27.7435, bio=0.0011
    Epoch 10/10: total=28.9445, vae=1.0773, dsb=27.8669, bio=0.0005

  [Backward Policy Training]
    Epoch  1/10: total=1.6533, vae=1.0785, dsb=0.5143, bio=0.1211
    Epoch  2/10: total=1.5728, vae=1.0775, dsb=0.4946, bio=0.0015
    Epoch  3/10: total=1.5608, vae=1.0772, dsb=0.4830, bio=0.0012
    Epoch  4/10: total=1.5576, vae=1.0768, dsb=0.4803, bio=0.0012
    Epoch  5/10: total=1.5513, vae=1.0769, dsb=0.4739, bio=0.0011
    Epoch  6/10: total=1.5478, vae=1.0762, dsb=0.4711, bio=0.0011
    Epoch  7/10: total=1.5451, vae=1.0769, dsb=0.4677, bio=0.0010
    Epoch  8/10: total=1.5583, vae=1.0761, dsb=0.4818, bio=0.0009
    Epoch  9/10: total=1.5558, vae=1.0753, dsb=0.4801, bio=0.0009
    Epoch 10/10: total=1.5426, vae=1.0753, dsb=0.4668, bio=0.0010

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=25.3625, vae=1.0792, dsb=24.2810, bio=0.0044
    Epoch  2/10: total=25.1936, vae=1.0773, dsb=24.1158, bio=0.0010
    Epoch  3/10: total=25.1516, vae=1.0781, dsb=24.0733, bio=0.0005
    Epoch  4/10: total=25.2144, vae=1.0779, dsb=24.1362, bio=0.0005
    Epoch  5/10: total=25.1507, vae=1.0772, dsb=24.0729, bio=0.0012
    Epoch  6/10: total=25.1722, vae=1.0776, dsb=24.0941, bio=0.0009
    Epoch  7/10: total=25.0134, vae=1.0776, dsb=23.9356, bio=0.0004
    Epoch  8/10: total=24.8908, vae=1.0769, dsb=23.8137, bio=0.0005
    Epoch  9/10: total=24.9812, vae=1.0771, dsb=23.9034, bio=0.0011
    Epoch 10/10: total=25.0789, vae=1.0769, dsb=24.0016, bio=0.0010

  [Backward Policy Training]
    Epoch  1/10: total=1.6074, vae=1.0787, dsb=0.4346, bio=0.1883
    Epoch  2/10: total=1.5028, vae=1.0768, dsb=0.4255, bio=0.0011
    Epoch  3/10: total=1.5047, vae=1.0764, dsb=0.4278, bio=0.0008
    Epoch  4/10: total=1.5151, vae=1.0769, dsb=0.4376, bio=0.0011
    Epoch  5/10: total=1.4988, vae=1.0770, dsb=0.4213, bio=0.0010
    Epoch  6/10: total=1.5058, vae=1.0760, dsb=0.4293, bio=0.0010
    Epoch  7/10: total=1.4894, vae=1.0762, dsb=0.4129, bio=0.0004
    Epoch  8/10: total=1.4951, vae=1.0762, dsb=0.4184, bio=0.0011
    Epoch  9/10: total=1.4988, vae=1.0760, dsb=0.4223, bio=0.0010
    Epoch 10/10: total=1.4902, vae=1.0754, dsb=0.4143, bio=0.0009

[Seed 1] Joint training (original) complete; models and history saved.

[Seed 1] Starting joint training (ablation)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=244.6236, vae=2.0182, dsb=242.6053, bio=0.0000
    Epoch  2/10: total=72.1399, vae=1.0738, dsb=71.0660, bio=0.0000
    Epoch  3/10: total=63.3894, vae=1.0716, dsb=62.3178, bio=0.0000
    Epoch  4/10: total=59.3247, vae=1.0716, dsb=58.2531, bio=0.0000
    Epoch  5/10: total=56.8033, vae=1.0706, dsb=55.7328, bio=0.0000
    Epoch  6/10: total=55.0039, vae=1.0704, dsb=53.9336, bio=0.0000
    Epoch  7/10: total=54.0778, vae=1.0692, dsb=53.0086, bio=0.0000
    Epoch  8/10: total=52.8999, vae=1.0706, dsb=51.8293, bio=0.0000
    Epoch  9/10: total=52.2905, vae=1.0706, dsb=51.2199, bio=0.0000
    Epoch 10/10: total=51.7569, vae=1.0702, dsb=50.6867, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=2.9476, vae=1.0705, dsb=1.8771, bio=0.0000
    Epoch  2/10: total=2.5040, vae=1.0706, dsb=1.4334, bio=0.0000
    Epoch  3/10: total=2.3968, vae=1.0695, dsb=1.3273, bio=0.0000
    Epoch  4/10: total=2.3761, vae=1.0707, dsb=1.3054, bio=0.0000
    Epoch  5/10: total=2.3119, vae=1.0707, dsb=1.2413, bio=0.0000
    Epoch  6/10: total=2.3038, vae=1.0686, dsb=1.2352, bio=0.0000
    Epoch  7/10: total=2.2283, vae=1.0704, dsb=1.1579, bio=0.0000
    Epoch  8/10: total=2.2210, vae=1.0692, dsb=1.1518, bio=0.0000
    Epoch  9/10: total=2.2362, vae=1.0696, dsb=1.1666, bio=0.0000
    Epoch 10/10: total=2.2110, vae=1.0690, dsb=1.1420, bio=0.0000

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=44.2665, vae=1.0694, dsb=43.1971, bio=0.0000
    Epoch  2/10: total=39.9479, vae=1.0704, dsb=38.8775, bio=0.0000
    Epoch  3/10: total=38.8738, vae=1.0694, dsb=37.8044, bio=0.0000
    Epoch  4/10: total=38.4261, vae=1.0701, dsb=37.3560, bio=0.0000
    Epoch  5/10: total=38.0555, vae=1.0697, dsb=36.9858, bio=0.0000
    Epoch  6/10: total=37.7946, vae=1.0690, dsb=36.7256, bio=0.0000
    Epoch  7/10: total=37.6542, vae=1.0692, dsb=36.5850, bio=0.0000
    Epoch  8/10: total=37.5608, vae=1.0702, dsb=36.4906, bio=0.0000
    Epoch  9/10: total=37.1181, vae=1.0691, dsb=36.0489, bio=0.0000
    Epoch 10/10: total=37.0224, vae=1.0695, dsb=35.9529, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.9770, vae=1.0698, dsb=0.9072, bio=0.0000
    Epoch  2/10: total=1.8938, vae=1.0700, dsb=0.8237, bio=0.0000
    Epoch  3/10: total=1.8521, vae=1.0694, dsb=0.7827, bio=0.0000
    Epoch  4/10: total=1.8650, vae=1.0698, dsb=0.7952, bio=0.0000
    Epoch  5/10: total=1.8250, vae=1.0690, dsb=0.7560, bio=0.0000
    Epoch  6/10: total=1.8203, vae=1.0697, dsb=0.7506, bio=0.0000
    Epoch  7/10: total=1.8112, vae=1.0695, dsb=0.7417, bio=0.0000
    Epoch  8/10: total=1.8283, vae=1.0698, dsb=0.7585, bio=0.0000
    Epoch  9/10: total=1.7785, vae=1.0696, dsb=0.7089, bio=0.0000
    Epoch 10/10: total=1.7789, vae=1.0696, dsb=0.7094, bio=0.0000

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=36.9970, vae=1.0698, dsb=35.9272, bio=0.0000
    Epoch  2/10: total=35.4187, vae=1.0691, dsb=34.3496, bio=0.0000
    Epoch  3/10: total=35.0105, vae=1.0698, dsb=33.9407, bio=0.0000
    Epoch  4/10: total=34.8455, vae=1.0694, dsb=33.7761, bio=0.0000
    Epoch  5/10: total=34.8284, vae=1.0695, dsb=33.7588, bio=0.0000
    Epoch  6/10: total=34.6528, vae=1.0690, dsb=33.5838, bio=0.0000
    Epoch  7/10: total=34.5700, vae=1.0695, dsb=33.5005, bio=0.0000
    Epoch  8/10: total=34.4257, vae=1.0697, dsb=33.3560, bio=0.0000
    Epoch  9/10: total=34.4603, vae=1.0694, dsb=33.3910, bio=0.0000
    Epoch 10/10: total=34.1572, vae=1.0691, dsb=33.0881, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.7075, vae=1.0689, dsb=0.6386, bio=0.0000
    Epoch  2/10: total=1.6480, vae=1.0690, dsb=0.5790, bio=0.0000
    Epoch  3/10: total=1.6414, vae=1.0689, dsb=0.5726, bio=0.0000
    Epoch  4/10: total=1.6104, vae=1.0695, dsb=0.5410, bio=0.0000
    Epoch  5/10: total=1.6205, vae=1.0700, dsb=0.5505, bio=0.0000
    Epoch  6/10: total=1.6215, vae=1.0684, dsb=0.5531, bio=0.0000
    Epoch  7/10: total=1.6197, vae=1.0685, dsb=0.5511, bio=0.0000
    Epoch  8/10: total=1.6139, vae=1.0688, dsb=0.5452, bio=0.0000
    Epoch  9/10: total=1.6148, vae=1.0692, dsb=0.5456, bio=0.0000
    Epoch 10/10: total=1.6033, vae=1.0687, dsb=0.5346, bio=0.0000

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=28.8504, vae=1.0698, dsb=27.7806, bio=0.0000
    Epoch  2/10: total=28.1441, vae=1.0691, dsb=27.0750, bio=0.0000
    Epoch  3/10: total=27.9883, vae=1.0700, dsb=26.9183, bio=0.0000
    Epoch  4/10: total=27.9190, vae=1.0692, dsb=26.8497, bio=0.0000
    Epoch  5/10: total=27.9401, vae=1.0686, dsb=26.8715, bio=0.0000
    Epoch  6/10: total=28.0041, vae=1.0699, dsb=26.9342, bio=0.0000
    Epoch  7/10: total=27.9066, vae=1.0695, dsb=26.8371, bio=0.0000
    Epoch  8/10: total=27.7665, vae=1.0705, dsb=26.6960, bio=0.0000
    Epoch  9/10: total=27.8407, vae=1.0693, dsb=26.7714, bio=0.0000
    Epoch 10/10: total=27.9580, vae=1.0695, dsb=26.8886, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.5373, vae=1.0695, dsb=0.4678, bio=0.0000
    Epoch  2/10: total=1.5197, vae=1.0698, dsb=0.4500, bio=0.0000
    Epoch  3/10: total=1.5090, vae=1.0696, dsb=0.4394, bio=0.0000
    Epoch  4/10: total=1.5063, vae=1.0694, dsb=0.4370, bio=0.0000
    Epoch  5/10: total=1.5011, vae=1.0696, dsb=0.4315, bio=0.0000
    Epoch  6/10: total=1.4982, vae=1.0690, dsb=0.4292, bio=0.0000
    Epoch  7/10: total=1.4957, vae=1.0698, dsb=0.4260, bio=0.0000
    Epoch  8/10: total=1.5085, vae=1.0690, dsb=0.4396, bio=0.0000
    Epoch  9/10: total=1.5067, vae=1.0684, dsb=0.4383, bio=0.0000
    Epoch 10/10: total=1.4941, vae=1.0685, dsb=0.4256, bio=0.0000

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=24.3570, vae=1.0692, dsb=23.2878, bio=0.0000
    Epoch  2/10: total=24.2254, vae=1.0687, dsb=23.1567, bio=0.0000
    Epoch  3/10: total=24.1821, vae=1.0697, dsb=23.1123, bio=0.0000
    Epoch  4/10: total=24.2435, vae=1.0698, dsb=23.1737, bio=0.0000
    Epoch  5/10: total=24.1766, vae=1.0695, dsb=23.1071, bio=0.0000
    Epoch  6/10: total=24.2114, vae=1.0698, dsb=23.1416, bio=0.0000
    Epoch  7/10: total=24.0841, vae=1.0699, dsb=23.0142, bio=0.0000
    Epoch  8/10: total=23.9415, vae=1.0693, dsb=22.8722, bio=0.0000
    Epoch  9/10: total=24.0349, vae=1.0697, dsb=22.9652, bio=0.0000
    Epoch 10/10: total=24.1176, vae=1.0694, dsb=23.0482, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.4641, vae=1.0698, dsb=0.3942, bio=0.0000
    Epoch  2/10: total=1.4561, vae=1.0693, dsb=0.3868, bio=0.0000
    Epoch  3/10: total=1.4587, vae=1.0693, dsb=0.3894, bio=0.0000
    Epoch  4/10: total=1.4688, vae=1.0700, dsb=0.3988, bio=0.0000
    Epoch  5/10: total=1.4538, vae=1.0701, dsb=0.3837, bio=0.0000
    Epoch  6/10: total=1.4603, vae=1.0692, dsb=0.3911, bio=0.0000
    Epoch  7/10: total=1.4450, vae=1.0694, dsb=0.3756, bio=0.0000
    Epoch  8/10: total=1.4504, vae=1.0696, dsb=0.3808, bio=0.0000
    Epoch  9/10: total=1.4539, vae=1.0694, dsb=0.3844, bio=0.0000
    Epoch 10/10: total=1.4456, vae=1.0689, dsb=0.3767, bio=0.0000

[Seed 1] Joint training (ablation) complete; models and history saved.
/home/yyuan/ICB_TCE/notebooks/icb_multirun.py:360: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  pre_cells_expr = expression_data[pre_treatment_mask].to(device)
/home/yyuan/ICB_TCE/notebooks/icb_multirun.py:361: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  post_cells_expr = expression_data[post_treatment_mask].to(device)

[Seed 1] Drift genes saved in /home/yyuan/ICB_TCE/iter_results/run_001

[Seed 1] run finished.

================================================================================
[Seed 2] Starting running whole pipeline...
================================================================================

[Seed 2] Starting VAE pre-training...

    Epoch [01/20], Beta: 0.000, Average Loss: 535.6858
    Epoch [02/20], Beta: 0.000, Average Loss: 305.4417
    Epoch [03/20], Beta: 0.000, Average Loss: 267.0555
    Epoch [04/20], Beta: 0.000, Average Loss: 248.4453
    Epoch [05/20], Beta: 0.100, Average Loss: 245.6155
    Epoch [06/20], Beta: 0.200, Average Loss: 244.7749
    Epoch [07/20], Beta: 0.300, Average Loss: 244.9857
    Epoch [08/20], Beta: 0.400, Average Loss: 245.6118
    Epoch [09/20], Beta: 0.500, Average Loss: 246.6355
    Epoch [10/20], Beta: 0.600, Average Loss: 247.8422
    Epoch [11/20], Beta: 0.700, Average Loss: 249.1421
    Epoch [12/20], Beta: 0.800, Average Loss: 250.5059
    Epoch [13/20], Beta: 0.900, Average Loss: 251.8101
    Epoch [14/20], Beta: 1.000, Average Loss: 253.4411
    Epoch [15/20], Beta: 1.000, Average Loss: 253.0251
    Epoch [16/20], Beta: 1.000, Average Loss: 252.6597
    Epoch [17/20], Beta: 1.000, Average Loss: 252.3067
    Epoch [18/20], Beta: 1.000, Average Loss: 251.9870
    Epoch [19/20], Beta: 1.000, Average Loss: 251.6090
    Epoch [20/20], Beta: 1.000, Average Loss: 251.4167

[Seed 2] VAE pre-training complete.

[Seed 2] Starting joint training (original)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=375.4560, vae=3.4978, dsb=359.9087, bio=24.0989
    Epoch  2/10: total=104.9690, vae=1.1064, dsb=103.8276, bio=0.0699
    Epoch  3/10: total=90.8075, vae=1.1017, dsb=89.6905, bio=0.0306
    Epoch  4/10: total=84.2283, vae=1.1001, dsb=83.1190, bio=0.0184
    Epoch  5/10: total=80.5595, vae=1.0990, dsb=79.4543, bio=0.0124
    Epoch  6/10: total=77.6895, vae=1.0978, dsb=76.5871, bio=0.0092
    Epoch  7/10: total=75.5002, vae=1.0979, dsb=74.3986, bio=0.0073
    Epoch  8/10: total=74.0009, vae=1.0980, dsb=72.8999, bio=0.0059
    Epoch  9/10: total=72.6021, vae=1.0968, dsb=71.5028, bio=0.0051
    Epoch 10/10: total=71.5866, vae=1.0969, dsb=70.4875, bio=0.0045

  [Backward Policy Training]
    Epoch  1/10: total=3.5964, vae=1.0980, dsb=2.4920, bio=0.0129
    Epoch  2/10: total=2.9756, vae=1.0961, dsb=1.8772, bio=0.0047
    Epoch  3/10: total=2.8194, vae=1.0954, dsb=1.7224, bio=0.0034
    Epoch  4/10: total=2.7679, vae=1.0952, dsb=1.6713, bio=0.0029
    Epoch  5/10: total=2.6613, vae=1.0953, dsb=1.5647, bio=0.0026
    Epoch  6/10: total=2.6680, vae=1.0945, dsb=1.5723, bio=0.0024
    Epoch  7/10: total=2.6432, vae=1.0948, dsb=1.5472, bio=0.0025
    Epoch  8/10: total=2.6141, vae=1.0941, dsb=1.5190, bio=0.0021
    Epoch  9/10: total=2.5824, vae=1.0937, dsb=1.4877, bio=0.0021
    Epoch 10/10: total=2.5306, vae=1.0937, dsb=1.4359, bio=0.0020

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=67.3408, vae=1.0980, dsb=66.2410, bio=0.0037
    Epoch  2/10: total=58.7899, vae=1.0960, dsb=57.6929, bio=0.0020
    Epoch  3/10: total=56.4151, vae=1.0956, dsb=55.3185, bio=0.0019
    Epoch  4/10: total=55.1635, vae=1.0942, dsb=54.0683, bio=0.0019
    Epoch  5/10: total=54.5077, vae=1.0953, dsb=53.4114, bio=0.0019
    Epoch  6/10: total=54.0283, vae=1.0948, dsb=52.9326, bio=0.0019
    Epoch  7/10: total=53.3077, vae=1.0954, dsb=52.2111, bio=0.0024
    Epoch  8/10: total=53.2266, vae=1.0955, dsb=52.1302, bio=0.0018
    Epoch  9/10: total=52.7895, vae=1.0944, dsb=51.6942, bio=0.0018
    Epoch 10/10: total=52.5856, vae=1.0951, dsb=51.4896, bio=0.0019

  [Backward Policy Training]
    Epoch  1/10: total=2.2962, vae=1.0945, dsb=1.1991, bio=0.0052
    Epoch  2/10: total=2.1795, vae=1.0934, dsb=1.0851, bio=0.0020
    Epoch  3/10: total=2.1100, vae=1.0934, dsb=1.0157, bio=0.0018
    Epoch  4/10: total=2.1100, vae=1.0929, dsb=1.0163, bio=0.0017
    Epoch  5/10: total=2.0959, vae=1.0941, dsb=1.0010, bio=0.0016
    Epoch  6/10: total=2.1049, vae=1.0940, dsb=1.0100, bio=0.0018
    Epoch  7/10: total=2.0589, vae=1.0925, dsb=0.9656, bio=0.0016
    Epoch  8/10: total=2.0759, vae=1.0927, dsb=0.9825, bio=0.0016
    Epoch  9/10: total=2.0339, vae=1.0938, dsb=0.9393, bio=0.0016
    Epoch 10/10: total=2.0357, vae=1.0932, dsb=0.9418, bio=0.0016

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=51.7995, vae=1.0953, dsb=50.7027, bio=0.0031
    Epoch  2/10: total=48.5117, vae=1.0947, dsb=47.4162, bio=0.0017
    Epoch  3/10: total=47.5366, vae=1.0940, dsb=46.4418, bio=0.0016
    Epoch  4/10: total=46.9310, vae=1.0943, dsb=45.8359, bio=0.0016
    Epoch  5/10: total=46.6716, vae=1.0942, dsb=45.5766, bio=0.0016
    Epoch  6/10: total=46.5193, vae=1.0935, dsb=45.4251, bio=0.0016
    Epoch  7/10: total=46.4259, vae=1.0932, dsb=45.3319, bio=0.0016
    Epoch  8/10: total=46.0380, vae=1.0938, dsb=44.9433, bio=0.0017
    Epoch  9/10: total=45.8593, vae=1.0936, dsb=44.7648, bio=0.0018
    Epoch 10/10: total=46.0342, vae=1.0934, dsb=44.9401, bio=0.0015

  [Backward Policy Training]
    Epoch  1/10: total=1.9206, vae=1.0934, dsb=0.8151, bio=0.0242
    Epoch  2/10: total=1.8457, vae=1.0926, dsb=0.7524, bio=0.0015
    Epoch  3/10: total=1.8200, vae=1.0924, dsb=0.7269, bio=0.0014
    Epoch  4/10: total=1.8111, vae=1.0922, dsb=0.7182, bio=0.0014
    Epoch  5/10: total=1.8028, vae=1.0927, dsb=0.7094, bio=0.0014
    Epoch  6/10: total=1.7966, vae=1.0913, dsb=0.7047, bio=0.0013
    Epoch  7/10: total=1.7813, vae=1.0927, dsb=0.6880, bio=0.0013
    Epoch  8/10: total=1.7826, vae=1.0919, dsb=0.6900, bio=0.0013
    Epoch  9/10: total=1.7813, vae=1.0925, dsb=0.6881, bio=0.0013
    Epoch 10/10: total=1.7812, vae=1.0914, dsb=0.6891, bio=0.0014

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=39.3793, vae=1.0950, dsb=38.2825, bio=0.0036
    Epoch  2/10: total=38.1465, vae=1.0939, dsb=37.0519, bio=0.0013
    Epoch  3/10: total=37.8236, vae=1.0935, dsb=36.7294, bio=0.0013
    Epoch  4/10: total=37.6553, vae=1.0937, dsb=36.5610, bio=0.0013
    Epoch  5/10: total=37.5067, vae=1.0936, dsb=36.4124, bio=0.0015
    Epoch  6/10: total=37.3064, vae=1.0934, dsb=36.2123, bio=0.0013
    Epoch  7/10: total=37.3807, vae=1.0931, dsb=36.2869, bio=0.0013
    Epoch  8/10: total=37.3881, vae=1.0929, dsb=36.2946, bio=0.0013
    Epoch  9/10: total=37.2613, vae=1.0929, dsb=36.1678, bio=0.0011
    Epoch 10/10: total=37.4229, vae=1.0929, dsb=36.3294, bio=0.0012

  [Backward Policy Training]
    Epoch  1/10: total=1.7688, vae=1.0938, dsb=0.6354, bio=0.0791
    Epoch  2/10: total=1.6657, vae=1.0920, dsb=0.5731, bio=0.0013
    Epoch  3/10: total=1.6662, vae=1.0926, dsb=0.5730, bio=0.0012
    Epoch  4/10: total=1.6773, vae=1.0920, dsb=0.5847, bio=0.0011
    Epoch  5/10: total=1.6618, vae=1.0910, dsb=0.5702, bio=0.0011
    Epoch  6/10: total=1.6538, vae=1.0913, dsb=0.5619, bio=0.0011
    Epoch  7/10: total=1.6520, vae=1.0904, dsb=0.5611, bio=0.0011
    Epoch  8/10: total=1.6544, vae=1.0918, dsb=0.5620, bio=0.0011
    Epoch  9/10: total=1.6626, vae=1.0906, dsb=0.5715, bio=0.0010
    Epoch 10/10: total=1.6375, vae=1.0912, dsb=0.5458, bio=0.0010

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=34.9672, vae=1.0941, dsb=33.8705, bio=0.0050
    Epoch  2/10: total=34.2139, vae=1.0935, dsb=33.1199, bio=0.0011
    Epoch  3/10: total=34.1662, vae=1.0938, dsb=33.0718, bio=0.0011
    Epoch  4/10: total=34.0547, vae=1.0932, dsb=32.9609, bio=0.0011
    Epoch  5/10: total=34.1722, vae=1.0926, dsb=33.0792, bio=0.0008
    Epoch  6/10: total=33.6574, vae=1.0927, dsb=32.5640, bio=0.0012
    Epoch  7/10: total=33.9315, vae=1.0924, dsb=32.8386, bio=0.0011
    Epoch  8/10: total=34.0811, vae=1.0924, dsb=32.9882, bio=0.0011
    Epoch  9/10: total=33.9624, vae=1.0918, dsb=32.8703, bio=0.0005
    Epoch 10/10: total=34.0137, vae=1.0925, dsb=32.9208, bio=0.0009

  [Backward Policy Training]
    Epoch  1/10: total=1.6422, vae=1.0938, dsb=0.4792, bio=0.1383
    Epoch  2/10: total=1.5465, vae=1.0919, dsb=0.4540, bio=0.0013
    Epoch  3/10: total=1.5432, vae=1.0913, dsb=0.4516, bio=0.0008
    Epoch  4/10: total=1.5485, vae=1.0920, dsb=0.4560, bio=0.0011
    Epoch  5/10: total=1.5461, vae=1.0913, dsb=0.4543, bio=0.0010
    Epoch  6/10: total=1.5482, vae=1.0916, dsb=0.4561, bio=0.0010
    Epoch  7/10: total=1.5486, vae=1.0907, dsb=0.4575, bio=0.0008
    Epoch  8/10: total=1.5570, vae=1.0909, dsb=0.4657, bio=0.0008
    Epoch  9/10: total=1.5372, vae=1.0910, dsb=0.4458, bio=0.0007
    Epoch 10/10: total=1.5617, vae=1.0916, dsb=0.4697, bio=0.0010

[Seed 2] Joint training (original) complete; models and history saved.

[Seed 2] Starting joint training (ablation)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=361.0816, vae=1.9853, dsb=359.0964, bio=0.0000
    Epoch  2/10: total=104.1420, vae=1.0886, dsb=103.0534, bio=0.0000
    Epoch  3/10: total=90.3663, vae=1.0869, dsb=89.2794, bio=0.0000
    Epoch  4/10: total=84.0552, vae=1.0865, dsb=82.9687, bio=0.0000
    Epoch  5/10: total=80.3073, vae=1.0858, dsb=79.2215, bio=0.0000
    Epoch  6/10: total=77.3751, vae=1.0850, dsb=76.2902, bio=0.0000
    Epoch  7/10: total=75.1335, vae=1.0854, dsb=74.0481, bio=0.0000
    Epoch  8/10: total=73.6783, vae=1.0859, dsb=72.5924, bio=0.0000
    Epoch  9/10: total=72.2612, vae=1.0849, dsb=71.1763, bio=0.0000
    Epoch 10/10: total=71.2206, vae=1.0853, dsb=70.1354, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=3.4418, vae=1.0851, dsb=2.3567, bio=0.0000
    Epoch  2/10: total=2.8611, vae=1.0851, dsb=1.7761, bio=0.0000
    Epoch  3/10: total=2.7122, vae=1.0848, dsb=1.6274, bio=0.0000
    Epoch  4/10: total=2.6650, vae=1.0850, dsb=1.5800, bio=0.0000
    Epoch  5/10: total=2.5616, vae=1.0853, dsb=1.4764, bio=0.0000
    Epoch  6/10: total=2.5691, vae=1.0847, dsb=1.4844, bio=0.0000
    Epoch  7/10: total=2.5472, vae=1.0850, dsb=1.4621, bio=0.0000
    Epoch  8/10: total=2.5191, vae=1.0845, dsb=1.4346, bio=0.0000
    Epoch  9/10: total=2.4904, vae=1.0842, dsb=1.4062, bio=0.0000
    Epoch 10/10: total=2.4412, vae=1.0843, dsb=1.3568, bio=0.0000

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=63.5689, vae=1.0861, dsb=62.4828, bio=0.0000
    Epoch  2/10: total=55.3519, vae=1.0852, dsb=54.2667, bio=0.0000
    Epoch  3/10: total=53.1018, vae=1.0850, dsb=52.0168, bio=0.0000
    Epoch  4/10: total=51.8861, vae=1.0837, dsb=50.8024, bio=0.0000
    Epoch  5/10: total=51.2227, vae=1.0849, dsb=50.1377, bio=0.0000
    Epoch  6/10: total=50.8107, vae=1.0845, dsb=49.7262, bio=0.0000
    Epoch  7/10: total=50.1124, vae=1.0851, dsb=49.0273, bio=0.0000
    Epoch  8/10: total=50.0010, vae=1.0855, dsb=48.9155, bio=0.0000
    Epoch  9/10: total=49.5942, vae=1.0845, dsb=48.5097, bio=0.0000
    Epoch 10/10: total=49.4309, vae=1.0852, dsb=48.3457, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=2.2098, vae=1.0842, dsb=1.1256, bio=0.0000
    Epoch  2/10: total=2.1039, vae=1.0844, dsb=1.0195, bio=0.0000
    Epoch  3/10: total=2.0396, vae=1.0847, dsb=0.9550, bio=0.0000
    Epoch  4/10: total=2.0404, vae=1.0842, dsb=0.9562, bio=0.0000
    Epoch  5/10: total=2.0277, vae=1.0855, dsb=0.9422, bio=0.0000
    Epoch  6/10: total=2.0367, vae=1.0855, dsb=0.9512, bio=0.0000
    Epoch  7/10: total=1.9929, vae=1.0841, dsb=0.9088, bio=0.0000
    Epoch  8/10: total=2.0097, vae=1.0843, dsb=0.9254, bio=0.0000
    Epoch  9/10: total=1.9696, vae=1.0855, dsb=0.8841, bio=0.0000
    Epoch 10/10: total=1.9708, vae=1.0849, dsb=0.8859, bio=0.0000

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=48.4088, vae=1.0843, dsb=47.3245, bio=0.0000
    Epoch  2/10: total=45.3725, vae=1.0849, dsb=44.2876, bio=0.0000
    Epoch  3/10: total=44.4312, vae=1.0846, dsb=43.3466, bio=0.0000
    Epoch  4/10: total=43.9054, vae=1.0850, dsb=42.8204, bio=0.0000
    Epoch  5/10: total=43.6819, vae=1.0849, dsb=42.5970, bio=0.0000
    Epoch  6/10: total=43.5483, vae=1.0843, dsb=42.4640, bio=0.0000
    Epoch  7/10: total=43.4740, vae=1.0841, dsb=42.3899, bio=0.0000
    Epoch  8/10: total=43.1002, vae=1.0848, dsb=42.0153, bio=0.0000
    Epoch  9/10: total=42.9561, vae=1.0846, dsb=41.8715, bio=0.0000
    Epoch 10/10: total=43.1463, vae=1.0845, dsb=42.0617, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.8362, vae=1.0840, dsb=0.7522, bio=0.0000
    Epoch  2/10: total=1.7788, vae=1.0844, dsb=0.6943, bio=0.0000
    Epoch  3/10: total=1.7549, vae=1.0844, dsb=0.6705, bio=0.0000
    Epoch  4/10: total=1.7467, vae=1.0843, dsb=0.6624, bio=0.0000
    Epoch  5/10: total=1.7385, vae=1.0850, dsb=0.6536, bio=0.0000
    Epoch  6/10: total=1.7329, vae=1.0836, dsb=0.6493, bio=0.0000
    Epoch  7/10: total=1.7186, vae=1.0852, dsb=0.6334, bio=0.0000
    Epoch  8/10: total=1.7183, vae=1.0845, dsb=0.6338, bio=0.0000
    Epoch  9/10: total=1.7172, vae=1.0852, dsb=0.6320, bio=0.0000
    Epoch 10/10: total=1.7166, vae=1.0842, dsb=0.6324, bio=0.0000

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=36.4475, vae=1.0845, dsb=35.3630, bio=0.0000
    Epoch  2/10: total=35.3169, vae=1.0846, dsb=34.2323, bio=0.0000
    Epoch  3/10: total=35.0534, vae=1.0845, dsb=33.9689, bio=0.0000
    Epoch  4/10: total=34.8866, vae=1.0849, dsb=33.8017, bio=0.0000
    Epoch  5/10: total=34.7617, vae=1.0849, dsb=33.6768, bio=0.0000
    Epoch  6/10: total=34.5792, vae=1.0848, dsb=33.4944, bio=0.0000
    Epoch  7/10: total=34.6576, vae=1.0846, dsb=33.5730, bio=0.0000
    Epoch  8/10: total=34.6498, vae=1.0845, dsb=33.5653, bio=0.0000
    Epoch  9/10: total=34.5872, vae=1.0846, dsb=33.5025, bio=0.0000
    Epoch 10/10: total=34.7093, vae=1.0848, dsb=33.6245, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.6569, vae=1.0849, dsb=0.5720, bio=0.0000
    Epoch  2/10: total=1.6007, vae=1.0843, dsb=0.5164, bio=0.0000
    Epoch  3/10: total=1.6021, vae=1.0852, dsb=0.5169, bio=0.0000
    Epoch  4/10: total=1.6134, vae=1.0847, dsb=0.5287, bio=0.0000
    Epoch  5/10: total=1.5994, vae=1.0838, dsb=0.5156, bio=0.0000
    Epoch  6/10: total=1.5932, vae=1.0842, dsb=0.5089, bio=0.0000
    Epoch  7/10: total=1.5915, vae=1.0835, dsb=0.5080, bio=0.0000
    Epoch  8/10: total=1.5943, vae=1.0850, dsb=0.5094, bio=0.0000
    Epoch  9/10: total=1.6016, vae=1.0838, dsb=0.5178, bio=0.0000
    Epoch 10/10: total=1.5786, vae=1.0845, dsb=0.4942, bio=0.0000

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=32.1527, vae=1.0843, dsb=31.0685, bio=0.0000
    Epoch  2/10: total=31.5351, vae=1.0846, dsb=30.4505, bio=0.0000
    Epoch  3/10: total=31.4930, vae=1.0852, dsb=30.4079, bio=0.0000
    Epoch  4/10: total=31.3989, vae=1.0847, dsb=30.3142, bio=0.0000
    Epoch  5/10: total=31.5204, vae=1.0842, dsb=30.4362, bio=0.0000
    Epoch  6/10: total=31.0499, vae=1.0847, dsb=29.9653, bio=0.0000
    Epoch  7/10: total=31.2984, vae=1.0845, dsb=30.2139, bio=0.0000
    Epoch  8/10: total=31.4417, vae=1.0845, dsb=30.3571, bio=0.0000
    Epoch  9/10: total=31.3116, vae=1.0840, dsb=30.2276, bio=0.0000
    Epoch 10/10: total=31.3843, vae=1.0848, dsb=30.2995, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.5197, vae=1.0849, dsb=0.4348, bio=0.0000
    Epoch  2/10: total=1.4969, vae=1.0845, dsb=0.4124, bio=0.0000
    Epoch  3/10: total=1.4949, vae=1.0842, dsb=0.4107, bio=0.0000
    Epoch  4/10: total=1.5005, vae=1.0852, dsb=0.4152, bio=0.0000
    Epoch  5/10: total=1.4985, vae=1.0845, dsb=0.4140, bio=0.0000
    Epoch  6/10: total=1.5005, vae=1.0849, dsb=0.4156, bio=0.0000
    Epoch  7/10: total=1.5011, vae=1.0841, dsb=0.4170, bio=0.0000
    Epoch  8/10: total=1.5088, vae=1.0844, dsb=0.4245, bio=0.0000
    Epoch  9/10: total=1.4909, vae=1.0846, dsb=0.4063, bio=0.0000
    Epoch 10/10: total=1.5140, vae=1.0852, dsb=0.4287, bio=0.0000

[Seed 2] Joint training (ablation) complete; models and history saved.

[Seed 2] Drift genes saved in /home/yyuan/ICB_TCE/iter_results/run_002

[Seed 2] run finished.

================================================================================
[Seed 3] Starting running whole pipeline...
================================================================================

[Seed 3] Starting VAE pre-training...

    Epoch [01/20], Beta: 0.000, Average Loss: 535.5787
    Epoch [02/20], Beta: 0.000, Average Loss: 309.6083
    Epoch [03/20], Beta: 0.000, Average Loss: 271.5640
    Epoch [04/20], Beta: 0.000, Average Loss: 251.1416
    Epoch [05/20], Beta: 0.100, Average Loss: 246.0686
    Epoch [06/20], Beta: 0.200, Average Loss: 245.4059
    Epoch [07/20], Beta: 0.300, Average Loss: 245.5024
    Epoch [08/20], Beta: 0.400, Average Loss: 245.9723
    Epoch [09/20], Beta: 0.500, Average Loss: 246.8080
    Epoch [10/20], Beta: 0.600, Average Loss: 247.8211
    Epoch [11/20], Beta: 0.700, Average Loss: 249.0146
    Epoch [12/20], Beta: 0.800, Average Loss: 250.2805
    Epoch [13/20], Beta: 0.900, Average Loss: 251.5001
    Epoch [14/20], Beta: 1.000, Average Loss: 253.0908
    Epoch [15/20], Beta: 1.000, Average Loss: 252.6601
    Epoch [16/20], Beta: 1.000, Average Loss: 252.3286
    Epoch [17/20], Beta: 1.000, Average Loss: 251.9284
    Epoch [18/20], Beta: 1.000, Average Loss: 251.6646
    Epoch [19/20], Beta: 1.000, Average Loss: 251.2698
    Epoch [20/20], Beta: 1.000, Average Loss: 251.1432

[Seed 3] VAE pre-training complete.

[Seed 3] Starting joint training (original)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=250.9134, vae=3.8021, dsb=227.4891, bio=39.2443
    Epoch  2/10: total=70.0122, vae=1.0967, dsb=68.8676, bio=0.0958
    Epoch  3/10: total=58.6303, vae=1.0905, dsb=57.5198, bio=0.0398
    Epoch  4/10: total=53.4226, vae=1.0878, dsb=52.3230, bio=0.0236
    Epoch  5/10: total=50.2783, vae=1.0883, dsb=49.1820, bio=0.0160
    Epoch  6/10: total=47.9824, vae=1.0883, dsb=46.8882, bio=0.0116
    Epoch  7/10: total=46.6078, vae=1.0872, dsb=45.5161, bio=0.0091
    Epoch  8/10: total=45.2668, vae=1.0878, dsb=44.1755, bio=0.0072
    Epoch  9/10: total=44.3990, vae=1.0868, dsb=43.3091, bio=0.0062
    Epoch 10/10: total=43.5446, vae=1.0869, dsb=42.4551, bio=0.0051

  [Backward Policy Training]
    Epoch  1/10: total=3.0531, vae=1.0894, dsb=1.9563, bio=0.0149
    Epoch  2/10: total=2.5943, vae=1.0866, dsb=1.5050, bio=0.0053
    Epoch  3/10: total=2.5278, vae=1.0862, dsb=1.4397, bio=0.0037
    Epoch  4/10: total=2.4158, vae=1.0860, dsb=1.3284, bio=0.0029
    Epoch  5/10: total=2.3810, vae=1.0854, dsb=1.2942, bio=0.0027
    Epoch  6/10: total=2.3468, vae=1.0843, dsb=1.2614, bio=0.0022
    Epoch  7/10: total=2.3231, vae=1.0852, dsb=1.2369, bio=0.0020
    Epoch  8/10: total=2.2855, vae=1.0853, dsb=1.1992, bio=0.0019
    Epoch  9/10: total=2.3032, vae=1.0851, dsb=1.2171, bio=0.0019
    Epoch 10/10: total=2.2920, vae=1.0840, dsb=1.2072, bio=0.0016

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=41.0348, vae=1.0879, dsb=39.9452, bio=0.0033
    Epoch  2/10: total=33.5474, vae=1.0861, dsb=32.4605, bio=0.0017
    Epoch  3/10: total=31.6026, vae=1.0856, dsb=30.5162, bio=0.0016
    Epoch  4/10: total=30.5645, vae=1.0850, dsb=29.4786, bio=0.0016
    Epoch  5/10: total=29.9942, vae=1.0852, dsb=28.9082, bio=0.0017
    Epoch  6/10: total=29.4491, vae=1.0855, dsb=28.3628, bio=0.0016
    Epoch  7/10: total=29.2334, vae=1.0853, dsb=28.1473, bio=0.0016
    Epoch  8/10: total=28.8930, vae=1.0856, dsb=27.8066, bio=0.0016
    Epoch  9/10: total=28.7433, vae=1.0851, dsb=27.6574, bio=0.0016
    Epoch 10/10: total=28.3634, vae=1.0847, dsb=27.2779, bio=0.0016

  [Backward Policy Training]
    Epoch  1/10: total=2.0294, vae=1.0858, dsb=0.9410, bio=0.0050
    Epoch  2/10: total=1.9042, vae=1.0840, dsb=0.8194, bio=0.0016
    Epoch  3/10: total=1.8661, vae=1.0844, dsb=0.7810, bio=0.0014
    Epoch  4/10: total=1.8335, vae=1.0839, dsb=0.7490, bio=0.0014
    Epoch  5/10: total=1.8521, vae=1.0837, dsb=0.7677, bio=0.0013
    Epoch  6/10: total=1.8021, vae=1.0839, dsb=0.7173, bio=0.0019
    Epoch  7/10: total=1.8119, vae=1.0843, dsb=0.7269, bio=0.0013
    Epoch  8/10: total=1.7997, vae=1.0834, dsb=0.7156, bio=0.0013
    Epoch  9/10: total=1.7842, vae=1.0837, dsb=0.6999, bio=0.0013
    Epoch 10/10: total=1.7853, vae=1.0832, dsb=0.7014, bio=0.0013

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=27.1505, vae=1.0860, dsb=26.0631, bio=0.0028
    Epoch  2/10: total=24.3544, vae=1.0845, dsb=23.2692, bio=0.0014
    Epoch  3/10: total=23.6791, vae=1.0840, dsb=22.5944, bio=0.0014
    Epoch  4/10: total=23.0953, vae=1.0846, dsb=22.0100, bio=0.0014
    Epoch  5/10: total=22.8725, vae=1.0836, dsb=21.7882, bio=0.0014
    Epoch  6/10: total=22.6492, vae=1.0841, dsb=21.5645, bio=0.0013
    Epoch  7/10: total=22.4445, vae=1.0841, dsb=21.3597, bio=0.0013
    Epoch  8/10: total=22.2403, vae=1.0834, dsb=21.1562, bio=0.0013
    Epoch  9/10: total=22.2427, vae=1.0846, dsb=21.1575, bio=0.0013
    Epoch 10/10: total=22.2204, vae=1.0837, dsb=21.1360, bio=0.0013

  [Backward Policy Training]
    Epoch  1/10: total=1.7000, vae=1.0839, dsb=0.6052, bio=0.0218
    Epoch  2/10: total=1.6347, vae=1.0832, dsb=0.5509, bio=0.0013
    Epoch  3/10: total=1.6154, vae=1.0827, dsb=0.5321, bio=0.0012
    Epoch  4/10: total=1.6121, vae=1.0832, dsb=0.5284, bio=0.0012
    Epoch  5/10: total=1.6047, vae=1.0827, dsb=0.5214, bio=0.0011
    Epoch  6/10: total=1.5818, vae=1.0834, dsb=0.4979, bio=0.0011
    Epoch  7/10: total=1.5903, vae=1.0837, dsb=0.5061, bio=0.0011
    Epoch  8/10: total=1.5838, vae=1.0825, dsb=0.5007, bio=0.0011
    Epoch  9/10: total=1.5919, vae=1.0833, dsb=0.5081, bio=0.0011
    Epoch 10/10: total=1.5673, vae=1.0817, dsb=0.4851, bio=0.0011

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=20.5113, vae=1.0850, dsb=19.4250, bio=0.0026
    Epoch  2/10: total=19.2413, vae=1.0840, dsb=18.1567, bio=0.0012
    Epoch  3/10: total=18.8282, vae=1.0837, dsb=17.7439, bio=0.0012
    Epoch  4/10: total=18.6724, vae=1.0834, dsb=17.5883, bio=0.0012
    Epoch  5/10: total=18.4727, vae=1.0835, dsb=17.3886, bio=0.0011
    Epoch  6/10: total=18.3451, vae=1.0835, dsb=17.2610, bio=0.0011
    Epoch  7/10: total=18.2763, vae=1.0829, dsb=17.1929, bio=0.0011
    Epoch  8/10: total=18.2291, vae=1.0835, dsb=17.1451, bio=0.0010
    Epoch  9/10: total=18.2052, vae=1.0826, dsb=17.1221, bio=0.0011
    Epoch 10/10: total=18.2589, vae=1.0824, dsb=17.1760, bio=0.0010

  [Backward Policy Training]
    Epoch  1/10: total=1.5833, vae=1.0841, dsb=0.4310, bio=0.1364
    Epoch  2/10: total=1.4823, vae=1.0831, dsb=0.3986, bio=0.0012
    Epoch  3/10: total=1.4728, vae=1.0818, dsb=0.3905, bio=0.0010
    Epoch  4/10: total=1.4666, vae=1.0827, dsb=0.3835, bio=0.0010
    Epoch  5/10: total=1.4682, vae=1.0832, dsb=0.3845, bio=0.0010
    Epoch  6/10: total=1.4674, vae=1.0823, dsb=0.3846, bio=0.0010
    Epoch  7/10: total=1.4646, vae=1.0821, dsb=0.3821, bio=0.0010
    Epoch  8/10: total=1.4671, vae=1.0834, dsb=0.3833, bio=0.0009
    Epoch  9/10: total=1.4555, vae=1.0823, dsb=0.3727, bio=0.0011
    Epoch 10/10: total=1.4593, vae=1.0829, dsb=0.3759, bio=0.0010

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=17.4417, vae=1.0857, dsb=16.3548, bio=0.0025
    Epoch  2/10: total=16.8241, vae=1.0841, dsb=15.7397, bio=0.0008
    Epoch  3/10: total=16.6716, vae=1.0840, dsb=15.5872, bio=0.0009
    Epoch  4/10: total=16.6541, vae=1.0831, dsb=15.5704, bio=0.0011
    Epoch  5/10: total=16.6360, vae=1.0828, dsb=15.5526, bio=0.0010
    Epoch  6/10: total=16.6688, vae=1.0827, dsb=15.5856, bio=0.0010
    Epoch  7/10: total=16.5049, vae=1.0827, dsb=15.4217, bio=0.0009
    Epoch  8/10: total=16.5206, vae=1.0822, dsb=15.4382, bio=0.0004
    Epoch  9/10: total=16.5371, vae=1.0822, dsb=15.4544, bio=0.0010
    Epoch 10/10: total=16.5171, vae=1.0826, dsb=15.4340, bio=0.0010

  [Backward Policy Training]
    Epoch  1/10: total=1.4962, vae=1.0839, dsb=0.3215, bio=0.1817
    Epoch  2/10: total=1.3881, vae=1.0824, dsb=0.3052, bio=0.0011
    Epoch  3/10: total=1.3879, vae=1.0822, dsb=0.3053, bio=0.0006
    Epoch  4/10: total=1.3914, vae=1.0820, dsb=0.3090, bio=0.0009
    Epoch  5/10: total=1.3942, vae=1.0828, dsb=0.3109, bio=0.0010
    Epoch  6/10: total=1.3822, vae=1.0821, dsb=0.2996, bio=0.0009
    Epoch  7/10: total=1.3919, vae=1.0828, dsb=0.3086, bio=0.0009
    Epoch  8/10: total=1.3867, vae=1.0816, dsb=0.3047, bio=0.0007
    Epoch  9/10: total=1.3959, vae=1.0817, dsb=0.3139, bio=0.0005
    Epoch 10/10: total=1.3848, vae=1.0814, dsb=0.3029, bio=0.0011

[Seed 3] Joint training (original) complete; models and history saved.

[Seed 3] Starting joint training (ablation)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=229.1888, vae=2.0299, dsb=227.1588, bio=0.0000
    Epoch  2/10: total=69.6034, vae=1.0798, dsb=68.5236, bio=0.0000
    Epoch  3/10: total=58.3602, vae=1.0768, dsb=57.2834, bio=0.0000
    Epoch  4/10: total=53.1854, vae=1.0750, dsb=52.1104, bio=0.0000
    Epoch  5/10: total=50.0466, vae=1.0759, dsb=48.9707, bio=0.0000
    Epoch  6/10: total=47.7302, vae=1.0761, dsb=46.6540, bio=0.0000
    Epoch  7/10: total=46.3155, vae=1.0752, dsb=45.2404, bio=0.0000
    Epoch  8/10: total=44.9789, vae=1.0760, dsb=43.9029, bio=0.0000
    Epoch  9/10: total=44.1347, vae=1.0752, dsb=43.0595, bio=0.0000
    Epoch 10/10: total=43.3097, vae=1.0755, dsb=42.2342, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=2.9918, vae=1.0765, dsb=1.9153, bio=0.0000
    Epoch  2/10: total=2.5463, vae=1.0757, dsb=1.4706, bio=0.0000
    Epoch  3/10: total=2.4832, vae=1.0758, dsb=1.4074, bio=0.0000
    Epoch  4/10: total=2.3741, vae=1.0758, dsb=1.2983, bio=0.0000
    Epoch  5/10: total=2.3395, vae=1.0754, dsb=1.2641, bio=0.0000
    Epoch  6/10: total=2.3081, vae=1.0747, dsb=1.2334, bio=0.0000
    Epoch  7/10: total=2.2849, vae=1.0756, dsb=1.2093, bio=0.0000
    Epoch  8/10: total=2.2469, vae=1.0758, dsb=1.1711, bio=0.0000
    Epoch  9/10: total=2.2631, vae=1.0757, dsb=1.1874, bio=0.0000
    Epoch 10/10: total=2.2516, vae=1.0747, dsb=1.1768, bio=0.0000

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=40.9337, vae=1.0757, dsb=39.8580, bio=0.0000
    Epoch  2/10: total=33.6231, vae=1.0753, dsb=32.5478, bio=0.0000
    Epoch  3/10: total=31.6926, vae=1.0750, dsb=30.6176, bio=0.0000
    Epoch  4/10: total=30.6459, vae=1.0746, dsb=29.5713, bio=0.0000
    Epoch  5/10: total=30.0118, vae=1.0749, dsb=28.9369, bio=0.0000
    Epoch  6/10: total=29.4402, vae=1.0754, dsb=28.3648, bio=0.0000
    Epoch  7/10: total=29.2279, vae=1.0753, dsb=28.1526, bio=0.0000
    Epoch  8/10: total=28.8920, vae=1.0756, dsb=27.8164, bio=0.0000
    Epoch  9/10: total=28.7644, vae=1.0753, dsb=27.6891, bio=0.0000
    Epoch 10/10: total=28.3785, vae=1.0749, dsb=27.3036, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.9970, vae=1.0755, dsb=0.9214, bio=0.0000
    Epoch  2/10: total=1.8826, vae=1.0752, dsb=0.8074, bio=0.0000
    Epoch  3/10: total=1.8483, vae=1.0758, dsb=0.7726, bio=0.0000
    Epoch  4/10: total=1.8162, vae=1.0753, dsb=0.7409, bio=0.0000
    Epoch  5/10: total=1.8359, vae=1.0752, dsb=0.7608, bio=0.0000
    Epoch  6/10: total=1.7867, vae=1.0754, dsb=0.7113, bio=0.0000
    Epoch  7/10: total=1.7966, vae=1.0759, dsb=0.7207, bio=0.0000
    Epoch  8/10: total=1.7849, vae=1.0751, dsb=0.7098, bio=0.0000
    Epoch  9/10: total=1.7701, vae=1.0753, dsb=0.6948, bio=0.0000
    Epoch 10/10: total=1.7715, vae=1.0749, dsb=0.6966, bio=0.0000

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=27.8142, vae=1.0750, dsb=26.7392, bio=0.0000
    Epoch  2/10: total=24.9640, vae=1.0749, dsb=23.8891, bio=0.0000
    Epoch  3/10: total=24.3164, vae=1.0747, dsb=23.2417, bio=0.0000
    Epoch  4/10: total=23.7165, vae=1.0754, dsb=22.6412, bio=0.0000
    Epoch  5/10: total=23.5342, vae=1.0745, dsb=22.4597, bio=0.0000
    Epoch  6/10: total=23.3109, vae=1.0751, dsb=22.2359, bio=0.0000
    Epoch  7/10: total=23.1240, vae=1.0752, dsb=22.0488, bio=0.0000
    Epoch  8/10: total=22.9363, vae=1.0745, dsb=21.8617, bio=0.0000
    Epoch  9/10: total=22.9576, vae=1.0758, dsb=21.8818, bio=0.0000
    Epoch 10/10: total=22.9365, vae=1.0750, dsb=21.8615, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.6605, vae=1.0746, dsb=0.5859, bio=0.0000
    Epoch  2/10: total=1.6094, vae=1.0750, dsb=0.5344, bio=0.0000
    Epoch  3/10: total=1.5906, vae=1.0746, dsb=0.5160, bio=0.0000
    Epoch  4/10: total=1.5867, vae=1.0752, dsb=0.5116, bio=0.0000
    Epoch  5/10: total=1.5793, vae=1.0749, dsb=0.5044, bio=0.0000
    Epoch  6/10: total=1.5569, vae=1.0754, dsb=0.4815, bio=0.0000
    Epoch  7/10: total=1.5653, vae=1.0758, dsb=0.4894, bio=0.0000
    Epoch  8/10: total=1.5590, vae=1.0746, dsb=0.4843, bio=0.0000
    Epoch  9/10: total=1.5668, vae=1.0755, dsb=0.4913, bio=0.0000
    Epoch 10/10: total=1.5429, vae=1.0739, dsb=0.4689, bio=0.0000

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=21.2634, vae=1.0746, dsb=20.1888, bio=0.0000
    Epoch  2/10: total=20.1140, vae=1.0749, dsb=19.0391, bio=0.0000
    Epoch  3/10: total=19.6972, vae=1.0750, dsb=18.6222, bio=0.0000
    Epoch  4/10: total=19.6116, vae=1.0749, dsb=18.5367, bio=0.0000
    Epoch  5/10: total=19.4046, vae=1.0751, dsb=18.3295, bio=0.0000
    Epoch  6/10: total=19.2969, vae=1.0752, dsb=18.2217, bio=0.0000
    Epoch  7/10: total=19.2343, vae=1.0747, dsb=18.1596, bio=0.0000
    Epoch  8/10: total=19.1724, vae=1.0753, dsb=18.0971, bio=0.0000
    Epoch  9/10: total=19.1444, vae=1.0745, dsb=18.0698, bio=0.0000
    Epoch 10/10: total=19.2264, vae=1.0745, dsb=18.1519, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.4832, vae=1.0749, dsb=0.4083, bio=0.0000
    Epoch  2/10: total=1.4532, vae=1.0752, dsb=0.3780, bio=0.0000
    Epoch  3/10: total=1.4439, vae=1.0740, dsb=0.3699, bio=0.0000
    Epoch  4/10: total=1.4380, vae=1.0751, dsb=0.3629, bio=0.0000
    Epoch  5/10: total=1.4397, vae=1.0756, dsb=0.3642, bio=0.0000
    Epoch  6/10: total=1.4393, vae=1.0747, dsb=0.3646, bio=0.0000
    Epoch  7/10: total=1.4368, vae=1.0746, dsb=0.3622, bio=0.0000
    Epoch  8/10: total=1.4395, vae=1.0759, dsb=0.3637, bio=0.0000
    Epoch  9/10: total=1.4285, vae=1.0750, dsb=0.3535, bio=0.0000
    Epoch 10/10: total=1.4325, vae=1.0756, dsb=0.3569, bio=0.0000

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=17.9372, vae=1.0755, dsb=16.8617, bio=0.0000
    Epoch  2/10: total=17.3954, vae=1.0752, dsb=16.3202, bio=0.0000
    Epoch  3/10: total=17.2560, vae=1.0757, dsb=16.1803, bio=0.0000
    Epoch  4/10: total=17.2421, vae=1.0751, dsb=16.1671, bio=0.0000
    Epoch  5/10: total=17.2474, vae=1.0749, dsb=16.1725, bio=0.0000
    Epoch  6/10: total=17.2763, vae=1.0748, dsb=16.2015, bio=0.0000
    Epoch  7/10: total=17.1129, vae=1.0749, dsb=16.0381, bio=0.0000
    Epoch  8/10: total=17.1435, vae=1.0744, dsb=16.0690, bio=0.0000
    Epoch  9/10: total=17.1426, vae=1.0746, dsb=16.0680, bio=0.0000
    Epoch 10/10: total=17.1480, vae=1.0750, dsb=16.0730, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.3724, vae=1.0750, dsb=0.2974, bio=0.0000
    Epoch  2/10: total=1.3581, vae=1.0749, dsb=0.2833, bio=0.0000
    Epoch  3/10: total=1.3587, vae=1.0748, dsb=0.2839, bio=0.0000
    Epoch  4/10: total=1.3626, vae=1.0747, dsb=0.2879, bio=0.0000
    Epoch  5/10: total=1.3656, vae=1.0757, dsb=0.2899, bio=0.0000
    Epoch  6/10: total=1.3543, vae=1.0749, dsb=0.2793, bio=0.0000
    Epoch  7/10: total=1.3640, vae=1.0758, dsb=0.2882, bio=0.0000
    Epoch  8/10: total=1.3593, vae=1.0746, dsb=0.2846, bio=0.0000
    Epoch  9/10: total=1.3685, vae=1.0748, dsb=0.2937, bio=0.0000
    Epoch 10/10: total=1.3578, vae=1.0747, dsb=0.2831, bio=0.0000

[Seed 3] Joint training (ablation) complete; models and history saved.

[Seed 3] Drift genes saved in /home/yyuan/ICB_TCE/iter_results/run_003

[Seed 3] run finished.

================================================================================
[Seed 4] Starting running whole pipeline...
================================================================================

[Seed 4] Starting VAE pre-training...

    Epoch [01/20], Beta: 0.000, Average Loss: 530.3412
    Epoch [02/20], Beta: 0.000, Average Loss: 303.9120
    Epoch [03/20], Beta: 0.000, Average Loss: 265.8171
    Epoch [04/20], Beta: 0.000, Average Loss: 247.8941
    Epoch [05/20], Beta: 0.100, Average Loss: 244.6803
    Epoch [06/20], Beta: 0.200, Average Loss: 244.0683
    Epoch [07/20], Beta: 0.300, Average Loss: 244.4071
    Epoch [08/20], Beta: 0.400, Average Loss: 245.3388
    Epoch [09/20], Beta: 0.500, Average Loss: 246.4583
    Epoch [10/20], Beta: 0.600, Average Loss: 247.6452
    Epoch [11/20], Beta: 0.700, Average Loss: 248.9746
    Epoch [12/20], Beta: 0.800, Average Loss: 250.2765
    Epoch [13/20], Beta: 0.900, Average Loss: 251.5573
    Epoch [14/20], Beta: 1.000, Average Loss: 253.1370
    Epoch [15/20], Beta: 1.000, Average Loss: 252.7483
    Epoch [16/20], Beta: 1.000, Average Loss: 252.3349
    Epoch [17/20], Beta: 1.000, Average Loss: 252.0551
    Epoch [18/20], Beta: 1.000, Average Loss: 251.7286
    Epoch [19/20], Beta: 1.000, Average Loss: 251.3812
    Epoch [20/20], Beta: 1.000, Average Loss: 251.2193

[Seed 4] VAE pre-training complete.

[Seed 4] Starting joint training (original)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=278.0429, vae=3.7697, dsb=251.1972, bio=46.1518
    Epoch  2/10: total=76.0825, vae=1.1038, dsb=74.9434, bio=0.0707
    Epoch  3/10: total=64.9059, vae=1.1000, dsb=63.7907, bio=0.0306
    Epoch  4/10: total=59.6983, vae=1.0978, dsb=58.5912, bio=0.0185
    Epoch  5/10: total=56.8352, vae=1.0964, dsb=55.7326, bio=0.0124
    Epoch  6/10: total=54.8452, vae=1.0959, dsb=53.7449, bio=0.0089
    Epoch  7/10: total=53.2911, vae=1.0958, dsb=52.1917, bio=0.0071
    Epoch  8/10: total=51.7714, vae=1.0953, dsb=50.6732, bio=0.0058
    Epoch  9/10: total=50.9292, vae=1.0954, dsb=49.8314, bio=0.0048
    Epoch 10/10: total=50.1111, vae=1.0949, dsb=49.0141, bio=0.0043

  [Backward Policy Training]
    Epoch  1/10: total=3.2428, vae=1.0955, dsb=2.1411, bio=0.0122
    Epoch  2/10: total=2.7168, vae=1.0939, dsb=1.6208, bio=0.0042
    Epoch  3/10: total=2.5432, vae=1.0940, dsb=1.4476, bio=0.0031
    Epoch  4/10: total=2.4880, vae=1.0927, dsb=1.3940, bio=0.0026
    Epoch  5/10: total=2.4849, vae=1.0934, dsb=1.3903, bio=0.0024
    Epoch  6/10: total=2.4538, vae=1.0932, dsb=1.3595, bio=0.0022
    Epoch  7/10: total=2.4189, vae=1.0931, dsb=1.3248, bio=0.0021
    Epoch  8/10: total=2.3920, vae=1.0915, dsb=1.2994, bio=0.0020
    Epoch  9/10: total=2.3530, vae=1.0918, dsb=1.2601, bio=0.0022
    Epoch 10/10: total=2.3463, vae=1.0925, dsb=1.2528, bio=0.0019

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=48.1202, vae=1.0952, dsb=47.0232, bio=0.0035
    Epoch  2/10: total=39.9075, vae=1.0941, dsb=38.8124, bio=0.0019
    Epoch  3/10: total=38.0779, vae=1.0923, dsb=36.9847, bio=0.0018
    Epoch  4/10: total=37.0020, vae=1.0933, dsb=35.9077, bio=0.0021
    Epoch  5/10: total=36.1699, vae=1.0931, dsb=35.0759, bio=0.0019
    Epoch  6/10: total=35.6913, vae=1.0926, dsb=34.5977, bio=0.0019
    Epoch  7/10: total=35.4452, vae=1.0930, dsb=34.3513, bio=0.0018
    Epoch  8/10: total=35.1193, vae=1.0935, dsb=34.0249, bio=0.0018
    Epoch  9/10: total=34.7820, vae=1.0927, dsb=33.6883, bio=0.0018
    Epoch 10/10: total=34.6889, vae=1.0932, dsb=33.5947, bio=0.0018

  [Backward Policy Training]
    Epoch  1/10: total=2.1399, vae=1.0924, dsb=1.0448, bio=0.0053
    Epoch  2/10: total=2.0138, vae=1.0908, dsb=0.9220, bio=0.0019
    Epoch  3/10: total=1.9592, vae=1.0918, dsb=0.8665, bio=0.0017
    Epoch  4/10: total=1.9125, vae=1.0918, dsb=0.8197, bio=0.0018
    Epoch  5/10: total=1.9035, vae=1.0921, dsb=0.8105, bio=0.0017
    Epoch  6/10: total=1.8977, vae=1.0914, dsb=0.8055, bio=0.0016
    Epoch  7/10: total=1.8600, vae=1.0908, dsb=0.7685, bio=0.0016
    Epoch  8/10: total=1.8921, vae=1.0913, dsb=0.8000, bio=0.0016
    Epoch  9/10: total=1.8468, vae=1.0912, dsb=0.7548, bio=0.0016
    Epoch 10/10: total=1.8561, vae=1.0909, dsb=0.7644, bio=0.0015

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=31.9970, vae=1.0941, dsb=30.9014, bio=0.0030
    Epoch  2/10: total=28.9613, vae=1.0925, dsb=27.8680, bio=0.0017
    Epoch  3/10: total=28.0161, vae=1.0923, dsb=26.9230, bio=0.0016
    Epoch  4/10: total=27.4696, vae=1.0929, dsb=26.3758, bio=0.0016
    Epoch  5/10: total=27.3579, vae=1.0921, dsb=26.2649, bio=0.0016
    Epoch  6/10: total=27.0838, vae=1.0917, dsb=25.9913, bio=0.0016
    Epoch  7/10: total=26.8423, vae=1.0921, dsb=25.7493, bio=0.0017
    Epoch  8/10: total=26.7287, vae=1.0920, dsb=25.6359, bio=0.0016
    Epoch  9/10: total=26.4672, vae=1.0926, dsb=25.3738, bio=0.0016
    Epoch 10/10: total=26.6040, vae=1.0912, dsb=25.5119, bio=0.0017

  [Backward Policy Training]
    Epoch  1/10: total=1.7652, vae=1.0920, dsb=0.6671, bio=0.0124
    Epoch  2/10: total=1.6945, vae=1.0912, dsb=0.6024, bio=0.0016
    Epoch  3/10: total=1.6652, vae=1.0914, dsb=0.5730, bio=0.0015
    Epoch  4/10: total=1.6605, vae=1.0911, dsb=0.5687, bio=0.0014
    Epoch  5/10: total=1.6497, vae=1.0911, dsb=0.5579, bio=0.0014
    Epoch  6/10: total=1.6385, vae=1.0911, dsb=0.5467, bio=0.0014
    Epoch  7/10: total=1.6417, vae=1.0910, dsb=0.5501, bio=0.0013
    Epoch  8/10: total=1.6336, vae=1.0903, dsb=0.5427, bio=0.0013
    Epoch  9/10: total=1.6559, vae=1.0903, dsb=0.5649, bio=0.0013
    Epoch 10/10: total=1.6138, vae=1.0903, dsb=0.5229, bio=0.0013

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=26.7628, vae=1.0939, dsb=25.6671, bio=0.0036
    Epoch  2/10: total=25.3045, vae=1.0917, dsb=24.2120, bio=0.0014
    Epoch  3/10: total=24.8608, vae=1.0908, dsb=23.7692, bio=0.0014
    Epoch  4/10: total=24.6383, vae=1.0917, dsb=23.5460, bio=0.0014
    Epoch  5/10: total=24.3633, vae=1.0919, dsb=23.2707, bio=0.0014
    Epoch  6/10: total=24.3508, vae=1.0904, dsb=23.2597, bio=0.0014
    Epoch  7/10: total=24.3117, vae=1.0918, dsb=23.2191, bio=0.0016
    Epoch  8/10: total=24.3513, vae=1.0916, dsb=23.2590, bio=0.0014
    Epoch  9/10: total=24.0822, vae=1.0909, dsb=22.9906, bio=0.0014
    Epoch 10/10: total=24.1657, vae=1.0907, dsb=23.0744, bio=0.0014

  [Backward Policy Training]
    Epoch  1/10: total=1.6192, vae=1.0921, dsb=0.4909, bio=0.0725
    Epoch  2/10: total=1.5376, vae=1.0909, dsb=0.4459, bio=0.0014
    Epoch  3/10: total=1.5210, vae=1.0908, dsb=0.4295, bio=0.0013
    Epoch  4/10: total=1.5170, vae=1.0905, dsb=0.4259, bio=0.0013
    Epoch  5/10: total=1.5181, vae=1.0915, dsb=0.4259, bio=0.0012
    Epoch  6/10: total=1.5255, vae=1.0908, dsb=0.4341, bio=0.0012
    Epoch  7/10: total=1.5161, vae=1.0905, dsb=0.4251, bio=0.0012
    Epoch  8/10: total=1.5147, vae=1.0906, dsb=0.4235, bio=0.0012
    Epoch  9/10: total=1.5095, vae=1.0909, dsb=0.4180, bio=0.0013
    Epoch 10/10: total=1.5090, vae=1.0894, dsb=0.4190, bio=0.0011

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=22.0218, vae=1.0933, dsb=20.9272, bio=0.0027
    Epoch  2/10: total=21.4012, vae=1.0920, dsb=20.3086, bio=0.0013
    Epoch  3/10: total=21.3866, vae=1.0914, dsb=20.2946, bio=0.0013
    Epoch  4/10: total=21.2768, vae=1.0914, dsb=20.1847, bio=0.0014
    Epoch  5/10: total=21.2975, vae=1.0913, dsb=20.2055, bio=0.0014
    Epoch  6/10: total=21.2739, vae=1.0906, dsb=20.1828, bio=0.0012
    Epoch  7/10: total=21.0646, vae=1.0911, dsb=19.9728, bio=0.0012
    Epoch  8/10: total=21.1691, vae=1.0898, dsb=20.0787, bio=0.0012
    Epoch  9/10: total=21.0481, vae=1.0910, dsb=19.9564, bio=0.0012
    Epoch 10/10: total=21.0530, vae=1.0901, dsb=19.9623, bio=0.0012

  [Backward Policy Training]
    Epoch  1/10: total=1.4920, vae=1.0912, dsb=0.3511, bio=0.0996
    Epoch  2/10: total=1.4207, vae=1.0901, dsb=0.3299, bio=0.0014
    Epoch  3/10: total=1.4209, vae=1.0912, dsb=0.3291, bio=0.0011
    Epoch  4/10: total=1.4219, vae=1.0904, dsb=0.3310, bio=0.0010
    Epoch  5/10: total=1.4177, vae=1.0901, dsb=0.3271, bio=0.0011
    Epoch  6/10: total=1.4133, vae=1.0902, dsb=0.3225, bio=0.0011
    Epoch  7/10: total=1.4102, vae=1.0903, dsb=0.3194, bio=0.0010
    Epoch  8/10: total=1.4150, vae=1.0895, dsb=0.3250, bio=0.0010
    Epoch  9/10: total=1.4183, vae=1.0896, dsb=0.3282, bio=0.0010
    Epoch 10/10: total=1.4049, vae=1.0902, dsb=0.3142, bio=0.0011

[Seed 4] Joint training (original) complete; models and history saved.

[Seed 4] Starting joint training (ablation)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=252.9884, vae=2.0642, dsb=250.9242, bio=0.0000
    Epoch  2/10: total=75.7344, vae=1.0858, dsb=74.6486, bio=0.0000
    Epoch  3/10: total=64.6989, vae=1.0853, dsb=63.6136, bio=0.0000
    Epoch  4/10: total=59.5922, vae=1.0843, dsb=58.5079, bio=0.0000
    Epoch  5/10: total=56.7647, vae=1.0833, dsb=55.6813, bio=0.0000
    Epoch  6/10: total=54.7651, vae=1.0831, dsb=53.6819, bio=0.0000
    Epoch  7/10: total=53.2129, vae=1.0834, dsb=52.1295, bio=0.0000
    Epoch  8/10: total=51.6879, vae=1.0832, dsb=50.6047, bio=0.0000
    Epoch  9/10: total=50.8689, vae=1.0836, dsb=49.7853, bio=0.0000
    Epoch 10/10: total=50.0465, vae=1.0833, dsb=48.9632, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=3.1713, vae=1.0833, dsb=2.0879, bio=0.0000
    Epoch  2/10: total=2.6637, vae=1.0830, dsb=1.5807, bio=0.0000
    Epoch  3/10: total=2.4955, vae=1.0836, dsb=1.4119, bio=0.0000
    Epoch  4/10: total=2.4439, vae=1.0825, dsb=1.3614, bio=0.0000
    Epoch  5/10: total=2.4414, vae=1.0834, dsb=1.3580, bio=0.0000
    Epoch  6/10: total=2.4111, vae=1.0833, dsb=1.3278, bio=0.0000
    Epoch  7/10: total=2.3771, vae=1.0834, dsb=1.2937, bio=0.0000
    Epoch  8/10: total=2.3508, vae=1.0820, dsb=1.2688, bio=0.0000
    Epoch  9/10: total=2.3130, vae=1.0823, dsb=1.2307, bio=0.0000
    Epoch 10/10: total=2.3072, vae=1.0831, dsb=1.2242, bio=0.0000

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=47.4396, vae=1.0830, dsb=46.3566, bio=0.0000
    Epoch  2/10: total=39.6880, vae=1.0832, dsb=38.6048, bio=0.0000
    Epoch  3/10: total=38.0109, vae=1.0816, dsb=36.9293, bio=0.0000
    Epoch  4/10: total=37.0157, vae=1.0828, dsb=35.9329, bio=0.0000
    Epoch  5/10: total=36.2284, vae=1.0828, dsb=35.1457, bio=0.0000
    Epoch  6/10: total=35.7881, vae=1.0824, dsb=34.7057, bio=0.0000
    Epoch  7/10: total=35.5810, vae=1.0828, dsb=34.4982, bio=0.0000
    Epoch  8/10: total=35.2977, vae=1.0834, dsb=34.2142, bio=0.0000
    Epoch  9/10: total=34.9358, vae=1.0828, dsb=33.8530, bio=0.0000
    Epoch 10/10: total=34.8878, vae=1.0834, dsb=33.8045, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=2.0705, vae=1.0822, dsb=0.9883, bio=0.0000
    Epoch  2/10: total=1.9561, vae=1.0818, dsb=0.8743, bio=0.0000
    Epoch  3/10: total=1.9061, vae=1.0830, dsb=0.8230, bio=0.0000
    Epoch  4/10: total=1.8622, vae=1.0830, dsb=0.7792, bio=0.0000
    Epoch  5/10: total=1.8543, vae=1.0835, dsb=0.7708, bio=0.0000
    Epoch  6/10: total=1.8492, vae=1.0827, dsb=0.7665, bio=0.0000
    Epoch  7/10: total=1.8126, vae=1.0822, dsb=0.7303, bio=0.0000
    Epoch  8/10: total=1.8442, vae=1.0827, dsb=0.7615, bio=0.0000
    Epoch  9/10: total=1.8011, vae=1.0827, dsb=0.7184, bio=0.0000
    Epoch 10/10: total=1.8106, vae=1.0824, dsb=0.7281, bio=0.0000

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=31.9326, vae=1.0832, dsb=30.8494, bio=0.0000
    Epoch  2/10: total=29.1014, vae=1.0828, dsb=28.0186, bio=0.0000
    Epoch  3/10: total=28.2159, vae=1.0827, dsb=27.1332, bio=0.0000
    Epoch  4/10: total=27.6910, vae=1.0834, dsb=26.6075, bio=0.0000
    Epoch  5/10: total=27.5850, vae=1.0827, dsb=26.5023, bio=0.0000
    Epoch  6/10: total=27.3289, vae=1.0824, dsb=26.2464, bio=0.0000
    Epoch  7/10: total=27.1067, vae=1.0829, dsb=26.0238, bio=0.0000
    Epoch  8/10: total=27.0037, vae=1.0829, dsb=25.9209, bio=0.0000
    Epoch  9/10: total=26.7534, vae=1.0835, dsb=25.6699, bio=0.0000
    Epoch 10/10: total=26.8706, vae=1.0822, dsb=25.7884, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.7155, vae=1.0826, dsb=0.6329, bio=0.0000
    Epoch  2/10: total=1.6578, vae=1.0828, dsb=0.5750, bio=0.0000
    Epoch  3/10: total=1.6322, vae=1.0830, dsb=0.5492, bio=0.0000
    Epoch  4/10: total=1.6293, vae=1.0829, dsb=0.5464, bio=0.0000
    Epoch  5/10: total=1.6200, vae=1.0829, dsb=0.5371, bio=0.0000
    Epoch  6/10: total=1.6105, vae=1.0829, dsb=0.5276, bio=0.0000
    Epoch  7/10: total=1.6152, vae=1.0829, dsb=0.5323, bio=0.0000
    Epoch  8/10: total=1.6078, vae=1.0822, dsb=0.5256, bio=0.0000
    Epoch  9/10: total=1.6303, vae=1.0823, dsb=0.5480, bio=0.0000
    Epoch 10/10: total=1.5899, vae=1.0823, dsb=0.5077, bio=0.0000

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=26.1326, vae=1.0831, dsb=25.0495, bio=0.0000
    Epoch  2/10: total=24.8480, vae=1.0824, dsb=23.7656, bio=0.0000
    Epoch  3/10: total=24.4099, vae=1.0818, dsb=23.3281, bio=0.0000
    Epoch  4/10: total=24.2478, vae=1.0828, dsb=23.1650, bio=0.0000
    Epoch  5/10: total=24.0167, vae=1.0831, dsb=22.9336, bio=0.0000
    Epoch  6/10: total=24.0072, vae=1.0817, dsb=22.9254, bio=0.0000
    Epoch  7/10: total=23.9675, vae=1.0832, dsb=22.8843, bio=0.0000
    Epoch  8/10: total=24.0195, vae=1.0832, dsb=22.9363, bio=0.0000
    Epoch  9/10: total=23.7633, vae=1.0825, dsb=22.6808, bio=0.0000
    Epoch 10/10: total=23.8417, vae=1.0824, dsb=22.7594, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.5492, vae=1.0828, dsb=0.4663, bio=0.0000
    Epoch  2/10: total=1.5093, vae=1.0828, dsb=0.4265, bio=0.0000
    Epoch  3/10: total=1.4940, vae=1.0828, dsb=0.4113, bio=0.0000
    Epoch  4/10: total=1.4912, vae=1.0825, dsb=0.4087, bio=0.0000
    Epoch  5/10: total=1.4933, vae=1.0836, dsb=0.4097, bio=0.0000
    Epoch  6/10: total=1.5012, vae=1.0830, dsb=0.4182, bio=0.0000
    Epoch  7/10: total=1.4925, vae=1.0826, dsb=0.4098, bio=0.0000
    Epoch  8/10: total=1.4915, vae=1.0828, dsb=0.4087, bio=0.0000
    Epoch  9/10: total=1.4869, vae=1.0830, dsb=0.4038, bio=0.0000
    Epoch 10/10: total=1.4866, vae=1.0817, dsb=0.4049, bio=0.0000

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=21.3716, vae=1.0826, dsb=20.2891, bio=0.0000
    Epoch  2/10: total=20.7891, vae=1.0830, dsb=19.7061, bio=0.0000
    Epoch  3/10: total=20.7736, vae=1.0827, dsb=19.6909, bio=0.0000
    Epoch  4/10: total=20.6578, vae=1.0829, dsb=19.5749, bio=0.0000
    Epoch  5/10: total=20.6910, vae=1.0829, dsb=19.6080, bio=0.0000
    Epoch  6/10: total=20.6401, vae=1.0824, dsb=19.5577, bio=0.0000
    Epoch  7/10: total=20.4581, vae=1.0830, dsb=19.3751, bio=0.0000
    Epoch  8/10: total=20.5587, vae=1.0818, dsb=19.4769, bio=0.0000
    Epoch  9/10: total=20.4679, vae=1.0831, dsb=19.3848, bio=0.0000
    Epoch 10/10: total=20.4632, vae=1.0822, dsb=19.3810, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.4187, vae=1.0821, dsb=0.3366, bio=0.0000
    Epoch  2/10: total=1.3992, vae=1.0821, dsb=0.3171, bio=0.0000
    Epoch  3/10: total=1.3999, vae=1.0834, dsb=0.3165, bio=0.0000
    Epoch  4/10: total=1.4013, vae=1.0825, dsb=0.3189, bio=0.0000
    Epoch  5/10: total=1.3977, vae=1.0824, dsb=0.3153, bio=0.0000
    Epoch  6/10: total=1.3935, vae=1.0825, dsb=0.3109, bio=0.0000
    Epoch  7/10: total=1.3907, vae=1.0827, dsb=0.3081, bio=0.0000
    Epoch  8/10: total=1.3956, vae=1.0818, dsb=0.3138, bio=0.0000
    Epoch  9/10: total=1.3989, vae=1.0820, dsb=0.3169, bio=0.0000
    Epoch 10/10: total=1.3860, vae=1.0826, dsb=0.3034, bio=0.0000

[Seed 4] Joint training (ablation) complete; models and history saved.

[Seed 4] Drift genes saved in /home/yyuan/ICB_TCE/iter_results/run_004

[Seed 4] run finished.

================================================================================
[Seed 5] Starting running whole pipeline...
================================================================================

[Seed 5] Starting VAE pre-training...

    Epoch [01/20], Beta: 0.000, Average Loss: 534.9435
    Epoch [02/20], Beta: 0.000, Average Loss: 305.1892
    Epoch [03/20], Beta: 0.000, Average Loss: 268.5815
    Epoch [04/20], Beta: 0.000, Average Loss: 250.3689
    Epoch [05/20], Beta: 0.100, Average Loss: 246.0055
    Epoch [06/20], Beta: 0.200, Average Loss: 245.2212
    Epoch [07/20], Beta: 0.300, Average Loss: 245.3954
    Epoch [08/20], Beta: 0.400, Average Loss: 246.0725
    Epoch [09/20], Beta: 0.500, Average Loss: 247.0846
    Epoch [10/20], Beta: 0.600, Average Loss: 248.1695
    Epoch [11/20], Beta: 0.700, Average Loss: 249.3651
    Epoch [12/20], Beta: 0.800, Average Loss: 250.5804
    Epoch [13/20], Beta: 0.900, Average Loss: 251.8340
    Epoch [14/20], Beta: 1.000, Average Loss: 253.4013
    Epoch [15/20], Beta: 1.000, Average Loss: 253.0107
    Epoch [16/20], Beta: 1.000, Average Loss: 252.6197
    Epoch [17/20], Beta: 1.000, Average Loss: 252.3042
    Epoch [18/20], Beta: 1.000, Average Loss: 251.9799
    Epoch [19/20], Beta: 1.000, Average Loss: 251.5828
    Epoch [20/20], Beta: 1.000, Average Loss: 251.4361

[Seed 5] VAE pre-training complete.

[Seed 5] Starting joint training (original)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=219.2868, vae=3.7328, dsb=196.7144, bio=37.6792
    Epoch  2/10: total=58.5946, vae=1.0944, dsb=57.4577, bio=0.0850
    Epoch  3/10: total=49.6953, vae=1.0898, dsb=48.5886, bio=0.0339
    Epoch  4/10: total=45.4884, vae=1.0874, dsb=44.3918, bio=0.0185
    Epoch  5/10: total=42.9655, vae=1.0875, dsb=41.8719, bio=0.0121
    Epoch  6/10: total=41.0265, vae=1.0864, dsb=39.9358, bio=0.0087
    Epoch  7/10: total=39.9044, vae=1.0868, dsb=38.8143, bio=0.0067
    Epoch  8/10: total=38.9392, vae=1.0859, dsb=37.8506, bio=0.0054
    Epoch  9/10: total=38.3171, vae=1.0859, dsb=37.2289, bio=0.0045
    Epoch 10/10: total=37.7167, vae=1.0861, dsb=36.6287, bio=0.0040

  [Backward Policy Training]
    Epoch  1/10: total=3.0052, vae=1.0873, dsb=1.9122, bio=0.0114
    Epoch  2/10: total=2.5152, vae=1.0853, dsb=1.4279, bio=0.0039
    Epoch  3/10: total=2.3904, vae=1.0841, dsb=1.3048, bio=0.0030
    Epoch  4/10: total=2.3526, vae=1.0838, dsb=1.2676, bio=0.0025
    Epoch  5/10: total=2.3204, vae=1.0846, dsb=1.2347, bio=0.0023
    Epoch  6/10: total=2.2731, vae=1.0840, dsb=1.1880, bio=0.0022
    Epoch  7/10: total=2.2686, vae=1.0845, dsb=1.1831, bio=0.0020
    Epoch  8/10: total=2.2439, vae=1.0830, dsb=1.1599, bio=0.0020
    Epoch  9/10: total=2.2213, vae=1.0836, dsb=1.1367, bio=0.0019
    Epoch 10/10: total=2.1981, vae=1.0827, dsb=1.1143, bio=0.0021

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=34.8729, vae=1.0860, dsb=33.7853, bio=0.0033
    Epoch  2/10: total=28.7987, vae=1.0847, dsb=27.7130, bio=0.0018
    Epoch  3/10: total=27.4545, vae=1.0848, dsb=26.3688, bio=0.0018
    Epoch  4/10: total=26.5695, vae=1.0836, dsb=25.4849, bio=0.0018
    Epoch  5/10: total=26.1191, vae=1.0840, dsb=25.0342, bio=0.0018
    Epoch  6/10: total=25.7323, vae=1.0836, dsb=24.6478, bio=0.0018
    Epoch  7/10: total=25.5046, vae=1.0839, dsb=24.4199, bio=0.0017
    Epoch  8/10: total=25.3130, vae=1.0835, dsb=24.2286, bio=0.0017
    Epoch  9/10: total=25.0259, vae=1.0832, dsb=23.9418, bio=0.0017
    Epoch 10/10: total=24.9337, vae=1.0838, dsb=23.8490, bio=0.0017

  [Backward Policy Training]
    Epoch  1/10: total=1.9894, vae=1.0837, dsb=0.8994, bio=0.0125
    Epoch  2/10: total=1.8663, vae=1.0833, dsb=0.7821, bio=0.0018
    Epoch  3/10: total=1.8236, vae=1.0826, dsb=0.7402, bio=0.0016
    Epoch  4/10: total=1.7966, vae=1.0821, dsb=0.7138, bio=0.0015
    Epoch  5/10: total=1.7830, vae=1.0830, dsb=0.6993, bio=0.0015
    Epoch  6/10: total=1.7674, vae=1.0821, dsb=0.6846, bio=0.0014
    Epoch  7/10: total=1.7583, vae=1.0826, dsb=0.6750, bio=0.0014
    Epoch  8/10: total=1.7330, vae=1.0830, dsb=0.6491, bio=0.0016
    Epoch  9/10: total=1.7463, vae=1.0818, dsb=0.6639, bio=0.0012
    Epoch 10/10: total=1.7410, vae=1.0814, dsb=0.6590, bio=0.0013

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=24.7851, vae=1.0841, dsb=23.6997, bio=0.0026
    Epoch  2/10: total=22.5538, vae=1.0822, dsb=21.4709, bio=0.0013
    Epoch  3/10: total=22.0089, vae=1.0827, dsb=20.9256, bio=0.0013
    Epoch  4/10: total=21.5429, vae=1.0828, dsb=20.4594, bio=0.0013
    Epoch  5/10: total=21.5138, vae=1.0828, dsb=20.4303, bio=0.0013
    Epoch  6/10: total=21.1685, vae=1.0827, dsb=20.0852, bio=0.0013
    Epoch  7/10: total=21.1689, vae=1.0822, dsb=20.0860, bio=0.0013
    Epoch  8/10: total=21.0984, vae=1.0822, dsb=20.0155, bio=0.0013
    Epoch  9/10: total=20.9767, vae=1.0820, dsb=19.8941, bio=0.0014
    Epoch 10/10: total=20.8952, vae=1.0819, dsb=19.8127, bio=0.0012

  [Backward Policy Training]
    Epoch  1/10: total=1.6591, vae=1.0831, dsb=0.5503, bio=0.0513
    Epoch  2/10: total=1.5820, vae=1.0815, dsb=0.4997, bio=0.0014
    Epoch  3/10: total=1.5594, vae=1.0812, dsb=0.4775, bio=0.0012
    Epoch  4/10: total=1.5486, vae=1.0824, dsb=0.4656, bio=0.0012
    Epoch  5/10: total=1.5488, vae=1.0819, dsb=0.4663, bio=0.0012
    Epoch  6/10: total=1.5360, vae=1.0816, dsb=0.4538, bio=0.0011
    Epoch  7/10: total=1.5416, vae=1.0816, dsb=0.4595, bio=0.0011
    Epoch  8/10: total=1.5253, vae=1.0810, dsb=0.4438, bio=0.0010
    Epoch  9/10: total=1.5285, vae=1.0809, dsb=0.4470, bio=0.0011
    Epoch 10/10: total=1.5155, vae=1.0823, dsb=0.4327, bio=0.0011

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=19.8114, vae=1.0842, dsb=18.7260, bio=0.0025
    Epoch  2/10: total=18.7934, vae=1.0824, dsb=17.7104, bio=0.0012
    Epoch  3/10: total=18.5798, vae=1.0826, dsb=17.4965, bio=0.0013
    Epoch  4/10: total=18.4644, vae=1.0826, dsb=17.3815, bio=0.0008
    Epoch  5/10: total=18.3032, vae=1.0817, dsb=17.2209, bio=0.0012
    Epoch  6/10: total=18.2537, vae=1.0818, dsb=17.1713, bio=0.0011
    Epoch  7/10: total=18.2266, vae=1.0810, dsb=17.1450, bio=0.0011
    Epoch  8/10: total=18.1424, vae=1.0818, dsb=17.0600, bio=0.0010
    Epoch  9/10: total=18.1271, vae=1.0816, dsb=17.0451, bio=0.0010
    Epoch 10/10: total=18.1454, vae=1.0811, dsb=17.0638, bio=0.0010

  [Backward Policy Training]
    Epoch  1/10: total=1.5067, vae=1.0817, dsb=0.3669, bio=0.1160
    Epoch  2/10: total=1.4289, vae=1.0814, dsb=0.3469, bio=0.0012
    Epoch  3/10: total=1.4378, vae=1.0815, dsb=0.3557, bio=0.0011
    Epoch  4/10: total=1.4261, vae=1.0816, dsb=0.3440, bio=0.0010
    Epoch  5/10: total=1.4304, vae=1.0819, dsb=0.3481, bio=0.0010
    Epoch  6/10: total=1.4298, vae=1.0810, dsb=0.3483, bio=0.0010
    Epoch  7/10: total=1.4255, vae=1.0814, dsb=0.3439, bio=0.0006
    Epoch  8/10: total=1.4215, vae=1.0816, dsb=0.3393, bio=0.0010
    Epoch  9/10: total=1.4245, vae=1.0803, dsb=0.3437, bio=0.0010
    Epoch 10/10: total=1.4215, vae=1.0807, dsb=0.3404, bio=0.0010

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=16.4817, vae=1.0822, dsb=15.3987, bio=0.0016
    Epoch  2/10: total=16.1798, vae=1.0826, dsb=15.0968, bio=0.0009
    Epoch  3/10: total=16.0140, vae=1.0821, dsb=14.9317, bio=0.0006
    Epoch  4/10: total=15.9605, vae=1.0816, dsb=14.8783, bio=0.0012
    Epoch  5/10: total=16.1052, vae=1.0821, dsb=15.0226, bio=0.0011
    Epoch  6/10: total=16.0256, vae=1.0810, dsb=14.9442, bio=0.0010
    Epoch  7/10: total=15.8894, vae=1.0809, dsb=14.8080, bio=0.0009
    Epoch  8/10: total=15.9832, vae=1.0810, dsb=14.9018, bio=0.0008
    Epoch  9/10: total=15.9240, vae=1.0812, dsb=14.8426, bio=0.0003
    Epoch 10/10: total=15.9333, vae=1.0802, dsb=14.8529, bio=0.0004

  [Backward Policy Training]
    Epoch  1/10: total=1.4779, vae=1.0827, dsb=0.2953, bio=0.2001
    Epoch  2/10: total=1.3706, vae=1.0825, dsb=0.2875, bio=0.0013
    Epoch  3/10: total=1.3708, vae=1.0815, dsb=0.2887, bio=0.0011
    Epoch  4/10: total=1.3673, vae=1.0812, dsb=0.2856, bio=0.0009
    Epoch  5/10: total=1.3613, vae=1.0814, dsb=0.2798, bio=0.0003
    Epoch  6/10: total=1.3586, vae=1.0805, dsb=0.2777, bio=0.0007
    Epoch  7/10: total=1.3622, vae=1.0808, dsb=0.2809, bio=0.0009
    Epoch  8/10: total=1.3518, vae=1.0807, dsb=0.2705, bio=0.0010
    Epoch  9/10: total=1.3602, vae=1.0812, dsb=0.2786, bio=0.0010
    Epoch 10/10: total=1.3576, vae=1.0809, dsb=0.2762, bio=0.0009

[Seed 5] Joint training (original) complete; models and history saved.

[Seed 5] Starting joint training (ablation)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=198.4815, vae=2.0375, dsb=196.4440, bio=0.0000
    Epoch  2/10: total=58.2627, vae=1.0777, dsb=57.1849, bio=0.0000
    Epoch  3/10: total=49.3547, vae=1.0761, dsb=48.2786, bio=0.0000
    Epoch  4/10: total=45.2307, vae=1.0746, dsb=44.1561, bio=0.0000
    Epoch  5/10: total=42.6803, vae=1.0750, dsb=41.6053, bio=0.0000
    Epoch  6/10: total=40.7808, vae=1.0740, dsb=39.7068, bio=0.0000
    Epoch  7/10: total=39.6661, vae=1.0747, dsb=38.5914, bio=0.0000
    Epoch  8/10: total=38.7232, vae=1.0741, dsb=37.6491, bio=0.0000
    Epoch  9/10: total=38.0956, vae=1.0743, dsb=37.0212, bio=0.0000
    Epoch 10/10: total=37.4997, vae=1.0747, dsb=36.4250, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=2.9425, vae=1.0747, dsb=1.8678, bio=0.0000
    Epoch  2/10: total=2.4685, vae=1.0745, dsb=1.3940, bio=0.0000
    Epoch  3/10: total=2.3459, vae=1.0737, dsb=1.2722, bio=0.0000
    Epoch  4/10: total=2.3084, vae=1.0737, dsb=1.2347, bio=0.0000
    Epoch  5/10: total=2.2769, vae=1.0746, dsb=1.2022, bio=0.0000
    Epoch  6/10: total=2.2305, vae=1.0742, dsb=1.1564, bio=0.0000
    Epoch  7/10: total=2.2256, vae=1.0748, dsb=1.1508, bio=0.0000
    Epoch  8/10: total=2.2013, vae=1.0734, dsb=1.1278, bio=0.0000
    Epoch  9/10: total=2.1783, vae=1.0741, dsb=1.1042, bio=0.0000
    Epoch 10/10: total=2.1545, vae=1.0732, dsb=1.0813, bio=0.0000

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=33.9935, vae=1.0739, dsb=32.9196, bio=0.0000
    Epoch  2/10: total=28.1319, vae=1.0740, dsb=27.0579, bio=0.0000
    Epoch  3/10: total=26.9367, vae=1.0745, dsb=25.8622, bio=0.0000
    Epoch  4/10: total=26.1072, vae=1.0734, dsb=25.0338, bio=0.0000
    Epoch  5/10: total=25.6747, vae=1.0739, dsb=24.6008, bio=0.0000
    Epoch  6/10: total=25.3120, vae=1.0738, dsb=24.2382, bio=0.0000
    Epoch  7/10: total=25.0984, vae=1.0741, dsb=24.0242, bio=0.0000
    Epoch  8/10: total=24.9204, vae=1.0739, dsb=23.8465, bio=0.0000
    Epoch  9/10: total=24.6424, vae=1.0737, dsb=23.5687, bio=0.0000
    Epoch 10/10: total=24.5692, vae=1.0745, dsb=23.4947, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.9473, vae=1.0738, dsb=0.8735, bio=0.0000
    Epoch  2/10: total=1.8357, vae=1.0745, dsb=0.7612, bio=0.0000
    Epoch  3/10: total=1.7951, vae=1.0738, dsb=0.7213, bio=0.0000
    Epoch  4/10: total=1.7698, vae=1.0734, dsb=0.6964, bio=0.0000
    Epoch  5/10: total=1.7574, vae=1.0744, dsb=0.6830, bio=0.0000
    Epoch  6/10: total=1.7427, vae=1.0735, dsb=0.6691, bio=0.0000
    Epoch  7/10: total=1.7342, vae=1.0742, dsb=0.6600, bio=0.0000
    Epoch  8/10: total=1.7094, vae=1.0745, dsb=0.6349, bio=0.0000
    Epoch  9/10: total=1.7226, vae=1.0734, dsb=0.6492, bio=0.0000
    Epoch 10/10: total=1.7180, vae=1.0731, dsb=0.6449, bio=0.0000

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=24.6243, vae=1.0732, dsb=23.5511, bio=0.0000
    Epoch  2/10: total=22.3076, vae=1.0727, dsb=21.2349, bio=0.0000
    Epoch  3/10: total=21.7622, vae=1.0735, dsb=20.6888, bio=0.0000
    Epoch  4/10: total=21.3102, vae=1.0737, dsb=20.2366, bio=0.0000
    Epoch  5/10: total=21.2762, vae=1.0738, dsb=20.2024, bio=0.0000
    Epoch  6/10: total=20.9461, vae=1.0738, dsb=19.8723, bio=0.0000
    Epoch  7/10: total=20.9170, vae=1.0734, dsb=19.8436, bio=0.0000
    Epoch  8/10: total=20.8643, vae=1.0735, dsb=19.7907, bio=0.0000
    Epoch  9/10: total=20.7441, vae=1.0735, dsb=19.6707, bio=0.0000
    Epoch 10/10: total=20.6800, vae=1.0734, dsb=19.6066, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.6216, vae=1.0738, dsb=0.5478, bio=0.0000
    Epoch  2/10: total=1.5681, vae=1.0732, dsb=0.4948, bio=0.0000
    Epoch  3/10: total=1.5450, vae=1.0731, dsb=0.4718, bio=0.0000
    Epoch  4/10: total=1.5336, vae=1.0743, dsb=0.4593, bio=0.0000
    Epoch  5/10: total=1.5333, vae=1.0739, dsb=0.4594, bio=0.0000
    Epoch  6/10: total=1.5202, vae=1.0736, dsb=0.4467, bio=0.0000
    Epoch  7/10: total=1.5253, vae=1.0736, dsb=0.4517, bio=0.0000
    Epoch  8/10: total=1.5085, vae=1.0730, dsb=0.4355, bio=0.0000
    Epoch  9/10: total=1.5112, vae=1.0730, dsb=0.4382, bio=0.0000
    Epoch 10/10: total=1.4985, vae=1.0744, dsb=0.4240, bio=0.0000

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=20.1231, vae=1.0740, dsb=19.0491, bio=0.0000
    Epoch  2/10: total=19.1473, vae=1.0735, dsb=18.0738, bio=0.0000
    Epoch  3/10: total=18.9485, vae=1.0739, dsb=17.8746, bio=0.0000
    Epoch  4/10: total=18.8143, vae=1.0740, dsb=17.7403, bio=0.0000
    Epoch  5/10: total=18.6659, vae=1.0735, dsb=17.5924, bio=0.0000
    Epoch  6/10: total=18.6062, vae=1.0737, dsb=17.5325, bio=0.0000
    Epoch  7/10: total=18.5725, vae=1.0729, dsb=17.4996, bio=0.0000
    Epoch  8/10: total=18.4906, vae=1.0738, dsb=17.4169, bio=0.0000
    Epoch  9/10: total=18.4873, vae=1.0736, dsb=17.4137, bio=0.0000
    Epoch 10/10: total=18.5041, vae=1.0732, dsb=17.4309, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.4312, vae=1.0726, dsb=0.3586, bio=0.0000
    Epoch  2/10: total=1.4125, vae=1.0735, dsb=0.3390, bio=0.0000
    Epoch  3/10: total=1.4211, vae=1.0737, dsb=0.3474, bio=0.0000
    Epoch  4/10: total=1.4092, vae=1.0739, dsb=0.3354, bio=0.0000
    Epoch  5/10: total=1.4139, vae=1.0741, dsb=0.3397, bio=0.0000
    Epoch  6/10: total=1.4131, vae=1.0734, dsb=0.3398, bio=0.0000
    Epoch  7/10: total=1.4092, vae=1.0737, dsb=0.3355, bio=0.0000
    Epoch  8/10: total=1.4050, vae=1.0741, dsb=0.3309, bio=0.0000
    Epoch  9/10: total=1.4079, vae=1.0728, dsb=0.3351, bio=0.0000
    Epoch 10/10: total=1.4049, vae=1.0732, dsb=0.3317, bio=0.0000

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=16.7533, vae=1.0724, dsb=15.6809, bio=0.0000
    Epoch  2/10: total=16.4783, vae=1.0740, dsb=15.4043, bio=0.0000
    Epoch  3/10: total=16.3368, vae=1.0739, dsb=15.2630, bio=0.0000
    Epoch  4/10: total=16.2817, vae=1.0737, dsb=15.2080, bio=0.0000
    Epoch  5/10: total=16.4386, vae=1.0743, dsb=15.3644, bio=0.0000
    Epoch  6/10: total=16.3435, vae=1.0732, dsb=15.2703, bio=0.0000
    Epoch  7/10: total=16.2281, vae=1.0732, dsb=15.1548, bio=0.0000
    Epoch  8/10: total=16.3250, vae=1.0734, dsb=15.2516, bio=0.0000
    Epoch  9/10: total=16.2630, vae=1.0736, dsb=15.1894, bio=0.0000
    Epoch 10/10: total=16.2770, vae=1.0727, dsb=15.2043, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.3642, vae=1.0736, dsb=0.2906, bio=0.0000
    Epoch  2/10: total=1.3580, vae=1.0747, dsb=0.2833, bio=0.0000
    Epoch  3/10: total=1.3588, vae=1.0740, dsb=0.2848, bio=0.0000
    Epoch  4/10: total=1.3553, vae=1.0736, dsb=0.2817, bio=0.0000
    Epoch  5/10: total=1.3498, vae=1.0739, dsb=0.2759, bio=0.0000
    Epoch  6/10: total=1.3470, vae=1.0731, dsb=0.2739, bio=0.0000
    Epoch  7/10: total=1.3507, vae=1.0735, dsb=0.2771, bio=0.0000
    Epoch  8/10: total=1.3402, vae=1.0735, dsb=0.2667, bio=0.0000
    Epoch  9/10: total=1.3485, vae=1.0739, dsb=0.2745, bio=0.0000
    Epoch 10/10: total=1.3461, vae=1.0737, dsb=0.2724, bio=0.0000

[Seed 5] Joint training (ablation) complete; models and history saved.

[Seed 5] Drift genes saved in /home/yyuan/ICB_TCE/iter_results/run_005

[Seed 5] run finished.

================================================================================
[Seed 6] Starting running whole pipeline...
================================================================================

[Seed 6] Starting VAE pre-training...

    Epoch [01/20], Beta: 0.000, Average Loss: 533.7042
    Epoch [02/20], Beta: 0.000, Average Loss: 303.9857
    Epoch [03/20], Beta: 0.000, Average Loss: 269.0207
    Epoch [04/20], Beta: 0.000, Average Loss: 250.5123
    Epoch [05/20], Beta: 0.100, Average Loss: 245.4831
    Epoch [06/20], Beta: 0.200, Average Loss: 244.6655
    Epoch [07/20], Beta: 0.300, Average Loss: 245.1924
    Epoch [08/20], Beta: 0.400, Average Loss: 245.9703
    Epoch [09/20], Beta: 0.500, Average Loss: 247.0233
    Epoch [10/20], Beta: 0.600, Average Loss: 248.1171
    Epoch [11/20], Beta: 0.700, Average Loss: 249.3507
    Epoch [12/20], Beta: 0.800, Average Loss: 250.5556
    Epoch [13/20], Beta: 0.900, Average Loss: 251.7870
    Epoch [14/20], Beta: 1.000, Average Loss: 253.3718
    Epoch [15/20], Beta: 1.000, Average Loss: 252.9029
    Epoch [16/20], Beta: 1.000, Average Loss: 252.5205
    Epoch [17/20], Beta: 1.000, Average Loss: 252.1664
    Epoch [18/20], Beta: 1.000, Average Loss: 251.8059
    Epoch [19/20], Beta: 1.000, Average Loss: 251.4605
    Epoch [20/20], Beta: 1.000, Average Loss: 251.2782

[Seed 6] VAE pre-training complete.

[Seed 6] Starting joint training (original)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=264.3554, vae=3.6557, dsb=249.1170, bio=23.1655
    Epoch  2/10: total=88.4256, vae=1.1016, dsb=87.2845, bio=0.0788
    Epoch  3/10: total=78.4911, vae=1.0962, dsb=77.3779, bio=0.0341
    Epoch  4/10: total=73.6860, vae=1.0933, dsb=72.5828, bio=0.0200
    Epoch  5/10: total=70.4283, vae=1.0938, dsb=69.3278, bio=0.0134
    Epoch  6/10: total=68.7351, vae=1.0926, dsb=67.6377, bio=0.0096
    Epoch  7/10: total=66.9835, vae=1.0923, dsb=65.8875, bio=0.0074
    Epoch  8/10: total=65.5471, vae=1.0920, dsb=64.4522, bio=0.0060
    Epoch  9/10: total=64.6248, vae=1.0921, dsb=63.5299, bio=0.0057
    Epoch 10/10: total=63.9635, vae=1.0919, dsb=62.8695, bio=0.0042

  [Backward Policy Training]
    Epoch  1/10: total=3.1935, vae=1.0919, dsb=2.0948, bio=0.0136
    Epoch  2/10: total=2.7445, vae=1.0907, dsb=1.6515, bio=0.0046
    Epoch  3/10: total=2.5883, vae=1.0901, dsb=1.4966, bio=0.0033
    Epoch  4/10: total=2.5558, vae=1.0901, dsb=1.4644, bio=0.0026
    Epoch  5/10: total=2.4785, vae=1.0894, dsb=1.3880, bio=0.0023
    Epoch  6/10: total=2.4895, vae=1.0889, dsb=1.3996, bio=0.0021
    Epoch  7/10: total=2.4135, vae=1.0884, dsb=1.3241, bio=0.0019
    Epoch  8/10: total=2.3973, vae=1.0889, dsb=1.3074, bio=0.0018
    Epoch  9/10: total=2.4183, vae=1.0880, dsb=1.3295, bio=0.0017
    Epoch 10/10: total=2.3850, vae=1.0880, dsb=1.2962, bio=0.0017

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=58.9709, vae=1.0913, dsb=57.8779, bio=0.0033
    Epoch  2/10: total=52.5675, vae=1.0900, dsb=51.4767, bio=0.0016
    Epoch  3/10: total=51.0371, vae=1.0899, dsb=49.9463, bio=0.0015
    Epoch  4/10: total=50.1505, vae=1.0894, dsb=49.0604, bio=0.0016
    Epoch  5/10: total=49.5793, vae=1.0893, dsb=48.4892, bio=0.0016
    Epoch  6/10: total=49.1553, vae=1.0888, dsb=48.0657, bio=0.0016
    Epoch  7/10: total=48.5703, vae=1.0889, dsb=47.4806, bio=0.0016
    Epoch  8/10: total=48.4052, vae=1.0886, dsb=47.3158, bio=0.0017
    Epoch  9/10: total=48.3053, vae=1.0882, dsb=47.2163, bio=0.0015
    Epoch 10/10: total=47.9092, vae=1.0885, dsb=46.8200, bio=0.0015

  [Backward Policy Training]
    Epoch  1/10: total=2.1777, vae=1.0894, dsb=1.0833, bio=0.0100
    Epoch  2/10: total=2.0711, vae=1.0878, dsb=0.9826, bio=0.0016
    Epoch  3/10: total=2.0296, vae=1.0876, dsb=0.9414, bio=0.0014
    Epoch  4/10: total=2.0511, vae=1.0873, dsb=0.9632, bio=0.0014
    Epoch  5/10: total=1.9778, vae=1.0876, dsb=0.8895, bio=0.0014
    Epoch  6/10: total=1.9833, vae=1.0871, dsb=0.8956, bio=0.0012
    Epoch  7/10: total=2.0099, vae=1.0863, dsb=0.9230, bio=0.0012
    Epoch  8/10: total=1.9716, vae=1.0871, dsb=0.8838, bio=0.0012
    Epoch  9/10: total=1.9611, vae=1.0873, dsb=0.8732, bio=0.0012
    Epoch 10/10: total=1.9658, vae=1.0871, dsb=0.8780, bio=0.0013

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=42.7510, vae=1.0905, dsb=41.6590, bio=0.0029
    Epoch  2/10: total=40.6605, vae=1.0892, dsb=39.5706, bio=0.0012
    Epoch  3/10: total=40.0134, vae=1.0882, dsb=38.9246, bio=0.0012
    Epoch  4/10: total=39.6691, vae=1.0880, dsb=38.5805, bio=0.0012
    Epoch  5/10: total=39.5735, vae=1.0884, dsb=38.4845, bio=0.0012
    Epoch  6/10: total=39.4443, vae=1.0882, dsb=38.3555, bio=0.0012
    Epoch  7/10: total=39.1457, vae=1.0878, dsb=38.0572, bio=0.0013
    Epoch  8/10: total=39.0612, vae=1.0871, dsb=37.9735, bio=0.0012
    Epoch  9/10: total=38.9405, vae=1.0862, dsb=37.8537, bio=0.0011
    Epoch 10/10: total=38.9146, vae=1.0870, dsb=37.8270, bio=0.0011

  [Backward Policy Training]
    Epoch  1/10: total=1.8575, vae=1.0879, dsb=0.7151, bio=0.1088
    Epoch  2/10: total=1.7653, vae=1.0876, dsb=0.6770, bio=0.0012
    Epoch  3/10: total=1.7567, vae=1.0863, dsb=0.6699, bio=0.0011
    Epoch  4/10: total=1.7325, vae=1.0872, dsb=0.6447, bio=0.0011
    Epoch  5/10: total=1.7394, vae=1.0869, dsb=0.6520, bio=0.0010
    Epoch  6/10: total=1.7217, vae=1.0861, dsb=0.6350, bio=0.0010
    Epoch  7/10: total=1.7361, vae=1.0865, dsb=0.6491, bio=0.0010
    Epoch  8/10: total=1.7124, vae=1.0868, dsb=0.6250, bio=0.0010
    Epoch  9/10: total=1.7109, vae=1.0871, dsb=0.6233, bio=0.0010
    Epoch 10/10: total=1.7264, vae=1.0859, dsb=0.6399, bio=0.0010

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=34.5060, vae=1.0893, dsb=33.4154, bio=0.0025
    Epoch  2/10: total=33.7345, vae=1.0881, dsb=32.6459, bio=0.0011
    Epoch  3/10: total=33.3594, vae=1.0879, dsb=32.2710, bio=0.0010
    Epoch  4/10: total=33.3254, vae=1.0872, dsb=32.2377, bio=0.0010
    Epoch  5/10: total=33.1277, vae=1.0873, dsb=32.0401, bio=0.0004
    Epoch  6/10: total=33.0774, vae=1.0869, dsb=31.9900, bio=0.0010
    Epoch  7/10: total=32.9184, vae=1.0875, dsb=31.8304, bio=0.0010
    Epoch  8/10: total=33.0515, vae=1.0868, dsb=31.9642, bio=0.0010
    Epoch  9/10: total=32.9831, vae=1.0861, dsb=31.8965, bio=0.0008
    Epoch 10/10: total=32.8902, vae=1.0859, dsb=31.8041, bio=0.0004

  [Backward Policy Training]
    Epoch  1/10: total=1.7488, vae=1.0883, dsb=0.5702, bio=0.1803
    Epoch  2/10: total=1.6241, vae=1.0870, dsb=0.5364, bio=0.0013
    Epoch  3/10: total=1.6319, vae=1.0865, dsb=0.5448, bio=0.0011
    Epoch  4/10: total=1.6299, vae=1.0866, dsb=0.5428, bio=0.0009
    Epoch  5/10: total=1.6093, vae=1.0864, dsb=0.5226, bio=0.0005
    Epoch  6/10: total=1.6140, vae=1.0852, dsb=0.5283, bio=0.0011
    Epoch  7/10: total=1.6036, vae=1.0862, dsb=0.5168, bio=0.0010
    Epoch  8/10: total=1.6122, vae=1.0856, dsb=0.5261, bio=0.0009
    Epoch  9/10: total=1.6122, vae=1.0861, dsb=0.5258, bio=0.0006
    Epoch 10/10: total=1.6058, vae=1.0855, dsb=0.5199, bio=0.0006

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=30.6311, vae=1.0883, dsb=29.5397, bio=0.0062
    Epoch  2/10: total=30.2806, vae=1.0871, dsb=29.1929, bio=0.0010
    Epoch  3/10: total=30.3537, vae=1.0877, dsb=29.2656, bio=0.0007
    Epoch  4/10: total=30.2779, vae=1.0871, dsb=29.1906, bio=0.0005
    Epoch  5/10: total=30.3567, vae=1.0866, dsb=29.2695, bio=0.0011
    Epoch  6/10: total=30.1214, vae=1.0865, dsb=29.0344, bio=0.0011
    Epoch  7/10: total=30.0391, vae=1.0869, dsb=28.9520, bio=0.0004
    Epoch  8/10: total=30.1479, vae=1.0868, dsb=29.0608, bio=0.0006
    Epoch  9/10: total=30.1809, vae=1.0860, dsb=29.0948, bio=0.0004
    Epoch 10/10: total=30.1013, vae=1.0869, dsb=29.0141, bio=0.0007

  [Backward Policy Training]
    Epoch  1/10: total=1.6457, vae=1.0877, dsb=0.4661, bio=0.1839
    Epoch  2/10: total=1.5553, vae=1.0855, dsb=0.4691, bio=0.0012
    Epoch  3/10: total=1.5328, vae=1.0864, dsb=0.4459, bio=0.0009
    Epoch  4/10: total=1.5323, vae=1.0863, dsb=0.4455, bio=0.0012
    Epoch  5/10: total=1.5332, vae=1.0856, dsb=0.4471, bio=0.0010
    Epoch  6/10: total=1.5271, vae=1.0850, dsb=0.4419, bio=0.0004
    Epoch  7/10: total=1.5254, vae=1.0859, dsb=0.4391, bio=0.0008
    Epoch  8/10: total=1.5217, vae=1.0853, dsb=0.4358, bio=0.0012
    Epoch  9/10: total=1.5401, vae=1.0860, dsb=0.4537, bio=0.0009
    Epoch 10/10: total=1.5271, vae=1.0852, dsb=0.4416, bio=0.0006

[Seed 6] Joint training (original) complete; models and history saved.

[Seed 6] Starting joint training (ablation)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=250.8115, vae=2.0335, dsb=248.7780, bio=0.0000
    Epoch  2/10: total=88.0438, vae=1.0839, dsb=86.9599, bio=0.0000
    Epoch  3/10: total=78.0895, vae=1.0816, dsb=77.0079, bio=0.0000
    Epoch  4/10: total=73.3568, vae=1.0797, dsb=72.2771, bio=0.0000
    Epoch  5/10: total=70.1853, vae=1.0807, dsb=69.1046, bio=0.0000
    Epoch  6/10: total=68.4653, vae=1.0799, dsb=67.3855, bio=0.0000
    Epoch  7/10: total=66.7106, vae=1.0799, dsb=65.6307, bio=0.0000
    Epoch  8/10: total=65.2839, vae=1.0799, dsb=64.2040, bio=0.0000
    Epoch  9/10: total=64.3605, vae=1.0803, dsb=63.2802, bio=0.0000
    Epoch 10/10: total=63.7094, vae=1.0804, dsb=62.6290, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=3.0827, vae=1.0795, dsb=2.0032, bio=0.0000
    Epoch  2/10: total=2.6608, vae=1.0798, dsb=1.5810, bio=0.0000
    Epoch  3/10: total=2.5114, vae=1.0796, dsb=1.4317, bio=0.0000
    Epoch  4/10: total=2.4786, vae=1.0799, dsb=1.3986, bio=0.0000
    Epoch  5/10: total=2.4027, vae=1.0794, dsb=1.3233, bio=0.0000
    Epoch  6/10: total=2.4132, vae=1.0791, dsb=1.3341, bio=0.0000
    Epoch  7/10: total=2.3395, vae=1.0787, dsb=1.2608, bio=0.0000
    Epoch  8/10: total=2.3237, vae=1.0793, dsb=1.2444, bio=0.0000
    Epoch  9/10: total=2.3438, vae=1.0785, dsb=1.2653, bio=0.0000
    Epoch 10/10: total=2.3120, vae=1.0786, dsb=1.2334, bio=0.0000

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=58.0154, vae=1.0794, dsb=56.9361, bio=0.0000
    Epoch  2/10: total=52.0132, vae=1.0794, dsb=50.9339, bio=0.0000
    Epoch  3/10: total=50.6392, vae=1.0795, dsb=49.5597, bio=0.0000
    Epoch  4/10: total=49.8139, vae=1.0791, dsb=48.7347, bio=0.0000
    Epoch  5/10: total=49.2823, vae=1.0793, dsb=48.2030, bio=0.0000
    Epoch  6/10: total=48.8997, vae=1.0789, dsb=47.8208, bio=0.0000
    Epoch  7/10: total=48.3279, vae=1.0791, dsb=47.2488, bio=0.0000
    Epoch  8/10: total=48.1947, vae=1.0790, dsb=47.1157, bio=0.0000
    Epoch  9/10: total=48.0921, vae=1.0788, dsb=47.0133, bio=0.0000
    Epoch 10/10: total=47.7146, vae=1.0792, dsb=46.6354, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=2.0954, vae=1.0795, dsb=1.0159, bio=0.0000
    Epoch  2/10: total=1.9992, vae=1.0791, dsb=0.9201, bio=0.0000
    Epoch  3/10: total=1.9588, vae=1.0790, dsb=0.8797, bio=0.0000
    Epoch  4/10: total=1.9785, vae=1.0788, dsb=0.8998, bio=0.0000
    Epoch  5/10: total=1.9077, vae=1.0792, dsb=0.8285, bio=0.0000
    Epoch  6/10: total=1.9117, vae=1.0787, dsb=0.8330, bio=0.0000
    Epoch  7/10: total=1.9364, vae=1.0780, dsb=0.8584, bio=0.0000
    Epoch  8/10: total=1.8997, vae=1.0789, dsb=0.8207, bio=0.0000
    Epoch  9/10: total=1.8888, vae=1.0791, dsb=0.8097, bio=0.0000
    Epoch 10/10: total=1.8930, vae=1.0790, dsb=0.8140, bio=0.0000

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=41.9454, vae=1.0794, dsb=40.8660, bio=0.0000
    Epoch  2/10: total=39.9022, vae=1.0799, dsb=38.8224, bio=0.0000
    Epoch  3/10: total=39.3135, vae=1.0790, dsb=38.2345, bio=0.0000
    Epoch  4/10: total=38.9844, vae=1.0791, dsb=37.9053, bio=0.0000
    Epoch  5/10: total=38.8603, vae=1.0796, dsb=37.7807, bio=0.0000
    Epoch  6/10: total=38.7889, vae=1.0795, dsb=37.7094, bio=0.0000
    Epoch  7/10: total=38.4634, vae=1.0794, dsb=37.3839, bio=0.0000
    Epoch  8/10: total=38.3457, vae=1.0788, dsb=37.2668, bio=0.0000
    Epoch  9/10: total=38.2567, vae=1.0780, dsb=37.1787, bio=0.0000
    Epoch 10/10: total=38.2203, vae=1.0789, dsb=37.1414, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.7493, vae=1.0786, dsb=0.6707, bio=0.0000
    Epoch  2/10: total=1.7131, vae=1.0796, dsb=0.6335, bio=0.0000
    Epoch  3/10: total=1.7043, vae=1.0784, dsb=0.6259, bio=0.0000
    Epoch  4/10: total=1.6817, vae=1.0794, dsb=0.6024, bio=0.0000
    Epoch  5/10: total=1.6882, vae=1.0790, dsb=0.6091, bio=0.0000
    Epoch  6/10: total=1.6710, vae=1.0785, dsb=0.5926, bio=0.0000
    Epoch  7/10: total=1.6843, vae=1.0789, dsb=0.6054, bio=0.0000
    Epoch  8/10: total=1.6618, vae=1.0792, dsb=0.5826, bio=0.0000
    Epoch  9/10: total=1.6604, vae=1.0795, dsb=0.5809, bio=0.0000
    Epoch 10/10: total=1.6751, vae=1.0785, dsb=0.5966, bio=0.0000

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=33.7932, vae=1.0794, dsb=32.7139, bio=0.0000
    Epoch  2/10: total=33.0500, vae=1.0794, dsb=31.9706, bio=0.0000
    Epoch  3/10: total=32.7312, vae=1.0795, dsb=31.6517, bio=0.0000
    Epoch  4/10: total=32.6916, vae=1.0790, dsb=31.6126, bio=0.0000
    Epoch  5/10: total=32.5193, vae=1.0792, dsb=31.4401, bio=0.0000
    Epoch  6/10: total=32.4879, vae=1.0790, dsb=31.4089, bio=0.0000
    Epoch  7/10: total=32.3001, vae=1.0797, dsb=31.2205, bio=0.0000
    Epoch  8/10: total=32.4525, vae=1.0790, dsb=31.3735, bio=0.0000
    Epoch  9/10: total=32.3461, vae=1.0784, dsb=31.2676, bio=0.0000
    Epoch 10/10: total=32.2669, vae=1.0782, dsb=31.1887, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.6024, vae=1.0791, dsb=0.5233, bio=0.0000
    Epoch  2/10: total=1.5718, vae=1.0794, dsb=0.4924, bio=0.0000
    Epoch  3/10: total=1.5797, vae=1.0791, dsb=0.5006, bio=0.0000
    Epoch  4/10: total=1.5780, vae=1.0792, dsb=0.4988, bio=0.0000
    Epoch  5/10: total=1.5587, vae=1.0792, dsb=0.4796, bio=0.0000
    Epoch  6/10: total=1.5631, vae=1.0781, dsb=0.4850, bio=0.0000
    Epoch  7/10: total=1.5536, vae=1.0792, dsb=0.4744, bio=0.0000
    Epoch  8/10: total=1.5619, vae=1.0787, dsb=0.4832, bio=0.0000
    Epoch  9/10: total=1.5624, vae=1.0793, dsb=0.4831, bio=0.0000
    Epoch 10/10: total=1.5567, vae=1.0789, dsb=0.4779, bio=0.0000

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=29.8970, vae=1.0785, dsb=28.8184, bio=0.0000
    Epoch  2/10: total=29.6026, vae=1.0785, dsb=28.5240, bio=0.0000
    Epoch  3/10: total=29.7148, vae=1.0794, dsb=28.6354, bio=0.0000
    Epoch  4/10: total=29.6704, vae=1.0792, dsb=28.5912, bio=0.0000
    Epoch  5/10: total=29.7153, vae=1.0789, dsb=28.6364, bio=0.0000
    Epoch  6/10: total=29.5292, vae=1.0788, dsb=28.4504, bio=0.0000
    Epoch  7/10: total=29.4430, vae=1.0792, dsb=28.3638, bio=0.0000
    Epoch  8/10: total=29.5341, vae=1.0793, dsb=28.4548, bio=0.0000
    Epoch  9/10: total=29.5576, vae=1.0785, dsb=28.4791, bio=0.0000
    Epoch 10/10: total=29.4952, vae=1.0795, dsb=28.4157, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.5087, vae=1.0788, dsb=0.4299, bio=0.0000
    Epoch  2/10: total=1.5123, vae=1.0782, dsb=0.4342, bio=0.0000
    Epoch  3/10: total=1.4915, vae=1.0794, dsb=0.4121, bio=0.0000
    Epoch  4/10: total=1.4915, vae=1.0796, dsb=0.4119, bio=0.0000
    Epoch  5/10: total=1.4925, vae=1.0789, dsb=0.4136, bio=0.0000
    Epoch  6/10: total=1.4873, vae=1.0784, dsb=0.4089, bio=0.0000
    Epoch  7/10: total=1.4857, vae=1.0795, dsb=0.4062, bio=0.0000
    Epoch  8/10: total=1.4824, vae=1.0790, dsb=0.4033, bio=0.0000
    Epoch  9/10: total=1.5004, vae=1.0797, dsb=0.4207, bio=0.0000
    Epoch 10/10: total=1.4877, vae=1.0790, dsb=0.4087, bio=0.0000

[Seed 6] Joint training (ablation) complete; models and history saved.

[Seed 6] Drift genes saved in /home/yyuan/ICB_TCE/iter_results/run_006

[Seed 6] run finished.

================================================================================
[Seed 7] Starting running whole pipeline...
================================================================================

[Seed 7] Starting VAE pre-training...

    Epoch [01/20], Beta: 0.000, Average Loss: 537.3039
    Epoch [02/20], Beta: 0.000, Average Loss: 304.6473
    Epoch [03/20], Beta: 0.000, Average Loss: 268.5416
    Epoch [04/20], Beta: 0.000, Average Loss: 248.5526
    Epoch [05/20], Beta: 0.100, Average Loss: 244.7649
    Epoch [06/20], Beta: 0.200, Average Loss: 244.0396
    Epoch [07/20], Beta: 0.300, Average Loss: 244.1358
    Epoch [08/20], Beta: 0.400, Average Loss: 245.1491
    Epoch [09/20], Beta: 0.500, Average Loss: 246.4283
    Epoch [10/20], Beta: 0.600, Average Loss: 247.7130
    Epoch [11/20], Beta: 0.700, Average Loss: 249.1230
    Epoch [12/20], Beta: 0.800, Average Loss: 250.4703
    Epoch [13/20], Beta: 0.900, Average Loss: 251.7573
    Epoch [14/20], Beta: 1.000, Average Loss: 253.3999
    Epoch [15/20], Beta: 1.000, Average Loss: 252.9873
    Epoch [16/20], Beta: 1.000, Average Loss: 252.6528
    Epoch [17/20], Beta: 1.000, Average Loss: 252.2485
    Epoch [18/20], Beta: 1.000, Average Loss: 251.9447
    Epoch [19/20], Beta: 1.000, Average Loss: 251.5726
    Epoch [20/20], Beta: 1.000, Average Loss: 251.3405

[Seed 7] VAE pre-training complete.

[Seed 7] Starting joint training (original)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=265.1488, vae=3.6233, dsb=247.6542, bio=27.7428
    Epoch  2/10: total=73.3260, vae=1.1113, dsb=72.1688, bio=0.0918
    Epoch  3/10: total=62.3106, vae=1.1074, dsb=61.1832, bio=0.0402
    Epoch  4/10: total=57.2809, vae=1.1056, dsb=56.1630, bio=0.0245
    Epoch  5/10: total=54.2226, vae=1.1049, dsb=53.1094, bio=0.0165
    Epoch  6/10: total=52.0686, vae=1.1031, dsb=50.9594, bio=0.0122
    Epoch  7/10: total=50.5826, vae=1.1037, dsb=49.4743, bio=0.0093
    Epoch  8/10: total=49.2166, vae=1.1040, dsb=48.1089, bio=0.0075
    Epoch  9/10: total=48.2709, vae=1.1025, dsb=47.1654, bio=0.0062
    Epoch 10/10: total=47.4960, vae=1.1026, dsb=46.3908, bio=0.0053

  [Backward Policy Training]
    Epoch  1/10: total=3.1792, vae=1.1026, dsb=2.0687, bio=0.0159
    Epoch  2/10: total=2.7251, vae=1.1017, dsb=1.6204, bio=0.0059
    Epoch  3/10: total=2.5175, vae=1.1012, dsb=1.4144, bio=0.0039
    Epoch  4/10: total=2.5069, vae=1.1012, dsb=1.4042, bio=0.0031
    Epoch  5/10: total=2.4787, vae=1.1007, dsb=1.3766, bio=0.0026
    Epoch  6/10: total=2.4193, vae=1.1010, dsb=1.3171, bio=0.0023
    Epoch  7/10: total=2.4103, vae=1.0999, dsb=1.3094, bio=0.0021
    Epoch  8/10: total=2.3422, vae=1.1012, dsb=1.2398, bio=0.0024
    Epoch  9/10: total=2.3447, vae=1.1004, dsb=1.2434, bio=0.0018
    Epoch 10/10: total=2.3379, vae=1.1001, dsb=1.2370, bio=0.0018

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=44.7576, vae=1.1016, dsb=43.6543, bio=0.0032
    Epoch  2/10: total=37.6699, vae=1.1024, dsb=36.5667, bio=0.0017
    Epoch  3/10: total=35.9804, vae=1.1011, dsb=34.8784, bio=0.0016
    Epoch  4/10: total=34.7672, vae=1.1015, dsb=33.6648, bio=0.0016
    Epoch  5/10: total=34.3013, vae=1.1008, dsb=33.1997, bio=0.0015
    Epoch  6/10: total=33.8486, vae=1.1015, dsb=32.7464, bio=0.0015
    Epoch  7/10: total=33.3262, vae=1.1008, dsb=32.2247, bio=0.0015
    Epoch  8/10: total=33.1078, vae=1.1007, dsb=32.0063, bio=0.0017
    Epoch  9/10: total=32.9196, vae=1.1005, dsb=31.8184, bio=0.0014
    Epoch 10/10: total=32.7766, vae=1.1004, dsb=31.6754, bio=0.0015

  [Backward Policy Training]
    Epoch  1/10: total=2.0584, vae=1.1007, dsb=0.9542, bio=0.0069
    Epoch  2/10: total=1.9468, vae=1.0988, dsb=0.8472, bio=0.0016
    Epoch  3/10: total=1.9090, vae=1.0985, dsb=0.8098, bio=0.0015
    Epoch  4/10: total=1.8543, vae=1.0993, dsb=0.7543, bio=0.0014
    Epoch  5/10: total=1.8310, vae=1.0989, dsb=0.7315, bio=0.0013
    Epoch  6/10: total=1.8316, vae=1.0989, dsb=0.7319, bio=0.0017
    Epoch  7/10: total=1.8218, vae=1.0991, dsb=0.7220, bio=0.0012
    Epoch  8/10: total=1.7997, vae=1.0990, dsb=0.7001, bio=0.0012
    Epoch  9/10: total=1.8164, vae=1.0988, dsb=0.7171, bio=0.0012
    Epoch 10/10: total=1.7948, vae=1.0984, dsb=0.6958, bio=0.0012

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=30.5275, vae=1.1007, dsb=29.4255, bio=0.0026
    Epoch  2/10: total=27.9172, vae=1.0999, dsb=26.8166, bio=0.0013
    Epoch  3/10: total=27.1721, vae=1.0995, dsb=26.0720, bio=0.0013
    Epoch  4/10: total=26.8715, vae=1.0995, dsb=25.7715, bio=0.0011
    Epoch  5/10: total=26.5530, vae=1.0999, dsb=25.4525, bio=0.0012
    Epoch  6/10: total=26.5294, vae=1.1000, dsb=25.4288, bio=0.0012
    Epoch  7/10: total=26.2267, vae=1.0998, dsb=25.1263, bio=0.0012
    Epoch  8/10: total=26.1923, vae=1.0990, dsb=25.0927, bio=0.0012
    Epoch  9/10: total=26.1577, vae=1.0987, dsb=25.0584, bio=0.0012
    Epoch 10/10: total=25.9071, vae=1.0986, dsb=24.8079, bio=0.0011

  [Backward Policy Training]
    Epoch  1/10: total=1.6930, vae=1.0988, dsb=0.5798, bio=0.0288
    Epoch  2/10: total=1.6419, vae=1.0984, dsb=0.5429, bio=0.0013
    Epoch  3/10: total=1.6081, vae=1.0977, dsb=0.5097, bio=0.0012
    Epoch  4/10: total=1.5910, vae=1.0981, dsb=0.4923, bio=0.0011
    Epoch  5/10: total=1.5766, vae=1.0978, dsb=0.4782, bio=0.0012
    Epoch  6/10: total=1.5888, vae=1.0981, dsb=0.4902, bio=0.0011
    Epoch  7/10: total=1.5859, vae=1.0980, dsb=0.4873, bio=0.0010
    Epoch  8/10: total=1.5806, vae=1.0973, dsb=0.4828, bio=0.0010
    Epoch  9/10: total=1.5728, vae=1.0974, dsb=0.4748, bio=0.0011
    Epoch 10/10: total=1.5595, vae=1.0977, dsb=0.4613, bio=0.0011

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=23.4287, vae=1.1007, dsb=22.3264, bio=0.0032
    Epoch  2/10: total=22.4017, vae=1.0994, dsb=21.3017, bio=0.0010
    Epoch  3/10: total=22.0706, vae=1.0992, dsb=20.9709, bio=0.0011
    Epoch  4/10: total=21.8944, vae=1.0992, dsb=20.7947, bio=0.0011
    Epoch  5/10: total=21.8075, vae=1.0985, dsb=20.7085, bio=0.0011
    Epoch  6/10: total=21.7050, vae=1.0991, dsb=20.6053, bio=0.0011
    Epoch  7/10: total=21.6801, vae=1.0987, dsb=20.5811, bio=0.0006
    Epoch  8/10: total=21.6245, vae=1.0988, dsb=20.5252, bio=0.0009
    Epoch  9/10: total=21.6046, vae=1.0985, dsb=20.5055, bio=0.0011
    Epoch 10/10: total=21.4992, vae=1.0987, dsb=20.4000, bio=0.0011

  [Backward Policy Training]
    Epoch  1/10: total=1.5552, vae=1.1000, dsb=0.4000, bio=0.1105
    Epoch  2/10: total=1.4665, vae=1.0988, dsb=0.3671, bio=0.0014
    Epoch  3/10: total=1.4667, vae=1.0976, dsb=0.3686, bio=0.0011
    Epoch  4/10: total=1.4580, vae=1.0965, dsb=0.3610, bio=0.0010
    Epoch  5/10: total=1.4497, vae=1.0975, dsb=0.3517, bio=0.0010
    Epoch  6/10: total=1.4526, vae=1.0967, dsb=0.3555, bio=0.0008
    Epoch  7/10: total=1.4396, vae=1.0977, dsb=0.3416, bio=0.0006
    Epoch  8/10: total=1.4429, vae=1.0971, dsb=0.3453, bio=0.0011
    Epoch  9/10: total=1.4520, vae=1.0972, dsb=0.3543, bio=0.0010
    Epoch 10/10: total=1.4318, vae=1.0969, dsb=0.3344, bio=0.0009

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=19.8768, vae=1.1006, dsb=18.7740, bio=0.0044
    Epoch  2/10: total=19.3349, vae=1.0988, dsb=18.2358, bio=0.0007
    Epoch  3/10: total=19.3528, vae=1.0990, dsb=18.2533, bio=0.0010
    Epoch  4/10: total=19.1327, vae=1.0982, dsb=18.0339, bio=0.0011
    Epoch  5/10: total=19.1969, vae=1.0990, dsb=18.0973, bio=0.0011
    Epoch  6/10: total=19.0807, vae=1.0983, dsb=17.9820, bio=0.0008
    Epoch  7/10: total=19.2167, vae=1.0983, dsb=18.1182, bio=0.0004
    Epoch  8/10: total=19.1447, vae=1.0977, dsb=18.0465, bio=0.0010
    Epoch  9/10: total=19.0818, vae=1.0979, dsb=17.9835, bio=0.0008
    Epoch 10/10: total=19.0307, vae=1.0973, dsb=17.9329, bio=0.0011

  [Backward Policy Training]
    Epoch  1/10: total=1.4623, vae=1.0994, dsb=0.2966, bio=0.1325
    Epoch  2/10: total=1.4008, vae=1.0979, dsb=0.3025, bio=0.0008
    Epoch  3/10: total=1.3858, vae=1.0977, dsb=0.2876, bio=0.0011
    Epoch  4/10: total=1.3845, vae=1.0969, dsb=0.2872, bio=0.0010
    Epoch  5/10: total=1.3907, vae=1.0973, dsb=0.2933, bio=0.0002
    Epoch  6/10: total=1.3775, vae=1.0973, dsb=0.2796, bio=0.0012
    Epoch  7/10: total=1.3834, vae=1.0966, dsb=0.2863, bio=0.0011
    Epoch  8/10: total=1.3888, vae=1.0966, dsb=0.2916, bio=0.0010
    Epoch  9/10: total=1.3833, vae=1.0975, dsb=0.2855, bio=0.0008
    Epoch 10/10: total=1.3850, vae=1.0972, dsb=0.2877, bio=0.0002

[Seed 7] Joint training (original) complete; models and history saved.

[Seed 7] Starting joint training (ablation)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=249.2198, vae=2.0168, dsb=247.2029, bio=0.0000
    Epoch  2/10: total=72.9542, vae=1.0939, dsb=71.8603, bio=0.0000
    Epoch  3/10: total=62.0067, vae=1.0931, dsb=60.9136, bio=0.0000
    Epoch  4/10: total=56.8890, vae=1.0922, dsb=55.7968, bio=0.0000
    Epoch  5/10: total=53.8484, vae=1.0919, dsb=52.7565, bio=0.0000
    Epoch  6/10: total=51.6671, vae=1.0905, dsb=50.5766, bio=0.0000
    Epoch  7/10: total=50.1744, vae=1.0914, dsb=49.0830, bio=0.0000
    Epoch  8/10: total=48.8127, vae=1.0920, dsb=47.7207, bio=0.0000
    Epoch  9/10: total=47.8814, vae=1.0907, dsb=46.7906, bio=0.0000
    Epoch 10/10: total=47.1112, vae=1.0912, dsb=46.0200, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=3.0830, vae=1.0902, dsb=1.9927, bio=0.0000
    Epoch  2/10: total=2.6572, vae=1.0910, dsb=1.5662, bio=0.0000
    Epoch  3/10: total=2.4592, vae=1.0908, dsb=1.3684, bio=0.0000
    Epoch  4/10: total=2.4518, vae=1.0911, dsb=1.3608, bio=0.0000
    Epoch  5/10: total=2.4244, vae=1.0908, dsb=1.3336, bio=0.0000
    Epoch  6/10: total=2.3685, vae=1.0912, dsb=1.2773, bio=0.0000
    Epoch  7/10: total=2.3607, vae=1.0902, dsb=1.2705, bio=0.0000
    Epoch  8/10: total=2.2934, vae=1.0915, dsb=1.2018, bio=0.0000
    Epoch  9/10: total=2.2955, vae=1.0910, dsb=1.2044, bio=0.0000
    Epoch 10/10: total=2.2889, vae=1.0907, dsb=1.1981, bio=0.0000

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=44.7068, vae=1.0897, dsb=43.6171, bio=0.0000
    Epoch  2/10: total=37.5492, vae=1.0916, dsb=36.4576, bio=0.0000
    Epoch  3/10: total=35.9132, vae=1.0906, dsb=34.8226, bio=0.0000
    Epoch  4/10: total=34.6826, vae=1.0912, dsb=33.5914, bio=0.0000
    Epoch  5/10: total=34.2313, vae=1.0907, dsb=33.1406, bio=0.0000
    Epoch  6/10: total=33.8153, vae=1.0915, dsb=32.7238, bio=0.0000
    Epoch  7/10: total=33.2939, vae=1.0909, dsb=32.2030, bio=0.0000
    Epoch  8/10: total=33.0600, vae=1.0910, dsb=31.9690, bio=0.0000
    Epoch  9/10: total=32.8889, vae=1.0909, dsb=31.7980, bio=0.0000
    Epoch 10/10: total=32.7736, vae=1.0909, dsb=31.6827, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=2.0167, vae=1.0904, dsb=0.9263, bio=0.0000
    Epoch  2/10: total=1.9077, vae=1.0901, dsb=0.8176, bio=0.0000
    Epoch  3/10: total=1.8723, vae=1.0900, dsb=0.7823, bio=0.0000
    Epoch  4/10: total=1.8200, vae=1.0908, dsb=0.7292, bio=0.0000
    Epoch  5/10: total=1.7985, vae=1.0905, dsb=0.7081, bio=0.0000
    Epoch  6/10: total=1.7989, vae=1.0904, dsb=0.7085, bio=0.0000
    Epoch  7/10: total=1.7910, vae=1.0909, dsb=0.7002, bio=0.0000
    Epoch  8/10: total=1.7699, vae=1.0907, dsb=0.6792, bio=0.0000
    Epoch  9/10: total=1.7866, vae=1.0906, dsb=0.6960, bio=0.0000
    Epoch 10/10: total=1.7663, vae=1.0904, dsb=0.6759, bio=0.0000

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=31.1081, vae=1.0900, dsb=30.0180, bio=0.0000
    Epoch  2/10: total=28.4242, vae=1.0905, dsb=27.3336, bio=0.0000
    Epoch  3/10: total=27.6530, vae=1.0903, dsb=26.5627, bio=0.0000
    Epoch  4/10: total=27.3730, vae=1.0905, dsb=26.2826, bio=0.0000
    Epoch  5/10: total=27.0234, vae=1.0910, dsb=25.9323, bio=0.0000
    Epoch  6/10: total=27.0021, vae=1.0911, dsb=25.9110, bio=0.0000
    Epoch  7/10: total=26.6733, vae=1.0910, dsb=25.5823, bio=0.0000
    Epoch  8/10: total=26.6478, vae=1.0904, dsb=25.5574, bio=0.0000
    Epoch  9/10: total=26.6213, vae=1.0902, dsb=25.5311, bio=0.0000
    Epoch 10/10: total=26.3689, vae=1.0901, dsb=25.2788, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.6548, vae=1.0898, dsb=0.5650, bio=0.0000
    Epoch  2/10: total=1.6198, vae=1.0905, dsb=0.5293, bio=0.0000
    Epoch  3/10: total=1.5874, vae=1.0899, dsb=0.4974, bio=0.0000
    Epoch  4/10: total=1.5703, vae=1.0904, dsb=0.4799, bio=0.0000
    Epoch  5/10: total=1.5560, vae=1.0901, dsb=0.4659, bio=0.0000
    Epoch  6/10: total=1.5687, vae=1.0907, dsb=0.4781, bio=0.0000
    Epoch  7/10: total=1.5667, vae=1.0906, dsb=0.4761, bio=0.0000
    Epoch  8/10: total=1.5615, vae=1.0900, dsb=0.4715, bio=0.0000
    Epoch  9/10: total=1.5543, vae=1.0902, dsb=0.4641, bio=0.0000
    Epoch 10/10: total=1.5420, vae=1.0905, dsb=0.4515, bio=0.0000

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=24.6986, vae=1.0907, dsb=23.6079, bio=0.0000
    Epoch  2/10: total=23.6075, vae=1.0906, dsb=22.5170, bio=0.0000
    Epoch  3/10: total=23.2514, vae=1.0905, dsb=22.1609, bio=0.0000
    Epoch  4/10: total=23.0885, vae=1.0907, dsb=21.9978, bio=0.0000
    Epoch  5/10: total=23.0105, vae=1.0901, dsb=21.9204, bio=0.0000
    Epoch  6/10: total=22.8840, vae=1.0909, dsb=21.7931, bio=0.0000
    Epoch  7/10: total=22.8797, vae=1.0905, dsb=21.7892, bio=0.0000
    Epoch  8/10: total=22.8075, vae=1.0909, dsb=21.7166, bio=0.0000
    Epoch  9/10: total=22.8075, vae=1.0906, dsb=21.7168, bio=0.0000
    Epoch 10/10: total=22.6964, vae=1.0908, dsb=21.6056, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.4783, vae=1.0910, dsb=0.3873, bio=0.0000
    Epoch  2/10: total=1.4474, vae=1.0913, dsb=0.3561, bio=0.0000
    Epoch  3/10: total=1.4483, vae=1.0903, dsb=0.3580, bio=0.0000
    Epoch  4/10: total=1.4400, vae=1.0894, dsb=0.3506, bio=0.0000
    Epoch  5/10: total=1.4321, vae=1.0904, dsb=0.3416, bio=0.0000
    Epoch  6/10: total=1.4350, vae=1.0898, dsb=0.3452, bio=0.0000
    Epoch  7/10: total=1.4224, vae=1.0909, dsb=0.3315, bio=0.0000
    Epoch  8/10: total=1.4258, vae=1.0904, dsb=0.3353, bio=0.0000
    Epoch  9/10: total=1.4347, vae=1.0906, dsb=0.3441, bio=0.0000
    Epoch 10/10: total=1.4147, vae=1.0903, dsb=0.3244, bio=0.0000

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=19.8849, vae=1.0906, dsb=18.7942, bio=0.0000
    Epoch  2/10: total=19.3751, vae=1.0903, dsb=18.2849, bio=0.0000
    Epoch  3/10: total=19.3915, vae=1.0907, dsb=18.3008, bio=0.0000
    Epoch  4/10: total=19.1765, vae=1.0902, dsb=18.0864, bio=0.0000
    Epoch  5/10: total=19.2685, vae=1.0911, dsb=18.1774, bio=0.0000
    Epoch  6/10: total=19.1678, vae=1.0904, dsb=18.0774, bio=0.0000
    Epoch  7/10: total=19.2966, vae=1.0905, dsb=18.2061, bio=0.0000
    Epoch  8/10: total=19.2239, vae=1.0901, dsb=18.1338, bio=0.0000
    Epoch  9/10: total=19.1683, vae=1.0904, dsb=18.0779, bio=0.0000
    Epoch 10/10: total=19.1234, vae=1.0898, dsb=18.0336, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.3713, vae=1.0907, dsb=0.2806, bio=0.0000
    Epoch  2/10: total=1.3781, vae=1.0907, dsb=0.2874, bio=0.0000
    Epoch  3/10: total=1.3642, vae=1.0907, dsb=0.2734, bio=0.0000
    Epoch  4/10: total=1.3629, vae=1.0900, dsb=0.2729, bio=0.0000
    Epoch  5/10: total=1.3697, vae=1.0905, dsb=0.2791, bio=0.0000
    Epoch  6/10: total=1.3563, vae=1.0906, dsb=0.2656, bio=0.0000
    Epoch  7/10: total=1.3623, vae=1.0901, dsb=0.2723, bio=0.0000
    Epoch  8/10: total=1.3681, vae=1.0902, dsb=0.2779, bio=0.0000
    Epoch  9/10: total=1.3627, vae=1.0910, dsb=0.2717, bio=0.0000
    Epoch 10/10: total=1.3647, vae=1.0908, dsb=0.2739, bio=0.0000

[Seed 7] Joint training (ablation) complete; models and history saved.

[Seed 7] Drift genes saved in /home/yyuan/ICB_TCE/iter_results/run_007

[Seed 7] run finished.

================================================================================
[Seed 8] Starting running whole pipeline...
================================================================================

[Seed 8] Starting VAE pre-training...

    Epoch [01/20], Beta: 0.000, Average Loss: 538.6838
    Epoch [02/20], Beta: 0.000, Average Loss: 304.3265
    Epoch [03/20], Beta: 0.000, Average Loss: 265.0965
    Epoch [04/20], Beta: 0.000, Average Loss: 248.0237
    Epoch [05/20], Beta: 0.100, Average Loss: 244.9156
    Epoch [06/20], Beta: 0.200, Average Loss: 244.5763
    Epoch [07/20], Beta: 0.300, Average Loss: 244.8157
    Epoch [08/20], Beta: 0.400, Average Loss: 245.6875
    Epoch [09/20], Beta: 0.500, Average Loss: 246.7629
    Epoch [10/20], Beta: 0.600, Average Loss: 247.9203
    Epoch [11/20], Beta: 0.700, Average Loss: 249.1451
    Epoch [12/20], Beta: 0.800, Average Loss: 250.3981
    Epoch [13/20], Beta: 0.900, Average Loss: 251.6196
    Epoch [14/20], Beta: 1.000, Average Loss: 253.2417
    Epoch [15/20], Beta: 1.000, Average Loss: 252.8471
    Epoch [16/20], Beta: 1.000, Average Loss: 252.4424
    Epoch [17/20], Beta: 1.000, Average Loss: 252.1398
    Epoch [18/20], Beta: 1.000, Average Loss: 251.7804
    Epoch [19/20], Beta: 1.000, Average Loss: 251.3970
    Epoch [20/20], Beta: 1.000, Average Loss: 251.2423

[Seed 8] VAE pre-training complete.

[Seed 8] Starting joint training (original)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=336.4467, vae=3.7882, dsb=314.3293, bio=36.6583
    Epoch  2/10: total=94.7097, vae=1.0990, dsb=93.5642, bio=0.0930
    Epoch  3/10: total=82.1651, vae=1.0938, dsb=81.0509, bio=0.0408
    Epoch  4/10: total=76.2907, vae=1.0916, dsb=75.1870, bio=0.0243
    Epoch  5/10: total=72.6762, vae=1.0911, dsb=71.5770, bio=0.0162
    Epoch  6/10: total=70.5207, vae=1.0897, dsb=69.4252, bio=0.0116
    Epoch  7/10: total=68.7661, vae=1.0882, dsb=67.6735, bio=0.0090
    Epoch  8/10: total=67.6210, vae=1.0890, dsb=66.5285, bio=0.0071
    Epoch  9/10: total=66.5333, vae=1.0885, dsb=65.4418, bio=0.0059
    Epoch 10/10: total=65.7080, vae=1.0881, dsb=64.6174, bio=0.0050

  [Backward Policy Training]
    Epoch  1/10: total=3.3271, vae=1.0893, dsb=2.2307, bio=0.0141
    Epoch  2/10: total=2.7825, vae=1.0872, dsb=1.6929, bio=0.0048
    Epoch  3/10: total=2.7044, vae=1.0874, dsb=1.6154, bio=0.0034
    Epoch  4/10: total=2.5517, vae=1.0868, dsb=1.4635, bio=0.0028
    Epoch  5/10: total=2.5294, vae=1.0856, dsb=1.4425, bio=0.0025
    Epoch  6/10: total=2.5260, vae=1.0855, dsb=1.4393, bio=0.0023
    Epoch  7/10: total=2.4888, vae=1.0857, dsb=1.4020, bio=0.0021
    Epoch  8/10: total=2.4532, vae=1.0854, dsb=1.3668, bio=0.0021
    Epoch  9/10: total=2.4447, vae=1.0855, dsb=1.3582, bio=0.0020
    Epoch 10/10: total=2.4144, vae=1.0854, dsb=1.3280, bio=0.0020

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=59.3810, vae=1.0887, dsb=58.2905, bio=0.0037
    Epoch  2/10: total=52.5819, vae=1.0869, dsb=51.4940, bio=0.0021
    Epoch  3/10: total=51.0074, vae=1.0867, dsb=49.9197, bio=0.0020
    Epoch  4/10: total=50.1374, vae=1.0864, dsb=49.0499, bio=0.0021
    Epoch  5/10: total=49.3261, vae=1.0867, dsb=48.2384, bio=0.0021
    Epoch  6/10: total=48.9821, vae=1.0863, dsb=47.8949, bio=0.0019
    Epoch  7/10: total=48.6997, vae=1.0860, dsb=47.6127, bio=0.0019
    Epoch  8/10: total=48.5672, vae=1.0861, dsb=47.4801, bio=0.0020
    Epoch  9/10: total=48.0983, vae=1.0867, dsb=47.0106, bio=0.0019
    Epoch 10/10: total=48.1095, vae=1.0855, dsb=47.0231, bio=0.0019

  [Backward Policy Training]
    Epoch  1/10: total=2.1457, vae=1.0871, dsb=1.0562, bio=0.0050
    Epoch  2/10: total=2.0346, vae=1.0847, dsb=0.9489, bio=0.0022
    Epoch  3/10: total=1.9689, vae=1.0842, dsb=0.8838, bio=0.0018
    Epoch  4/10: total=1.9553, vae=1.0850, dsb=0.8695, bio=0.0017
    Epoch  5/10: total=1.9590, vae=1.0842, dsb=0.8740, bio=0.0017
    Epoch  6/10: total=1.9316, vae=1.0840, dsb=0.8468, bio=0.0016
    Epoch  7/10: total=1.9139, vae=1.0852, dsb=0.8279, bio=0.0016
    Epoch  8/10: total=1.9237, vae=1.0852, dsb=0.8376, bio=0.0018
    Epoch  9/10: total=1.9108, vae=1.0843, dsb=0.8258, bio=0.0016
    Epoch 10/10: total=1.9146, vae=1.0844, dsb=0.8294, bio=0.0016

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=43.9407, vae=1.0876, dsb=42.8515, bio=0.0031
    Epoch  2/10: total=40.9287, vae=1.0858, dsb=39.8421, bio=0.0018
    Epoch  3/10: total=40.2853, vae=1.0857, dsb=39.1987, bio=0.0019
    Epoch  4/10: total=39.9365, vae=1.0851, dsb=38.8503, bio=0.0021
    Epoch  5/10: total=39.5220, vae=1.0855, dsb=38.4357, bio=0.0017
    Epoch  6/10: total=39.1094, vae=1.0849, dsb=38.0237, bio=0.0017
    Epoch  7/10: total=39.2646, vae=1.0853, dsb=38.1784, bio=0.0017
    Epoch  8/10: total=39.0626, vae=1.0848, dsb=37.9769, bio=0.0017
    Epoch  9/10: total=39.0680, vae=1.0844, dsb=37.9828, bio=0.0017
    Epoch 10/10: total=39.1629, vae=1.0861, dsb=38.0759, bio=0.0018

  [Backward Policy Training]
    Epoch  1/10: total=1.8222, vae=1.0844, dsb=0.7344, bio=0.0068
    Epoch  2/10: total=1.7697, vae=1.0844, dsb=0.6844, bio=0.0016
    Epoch  3/10: total=1.7517, vae=1.0838, dsb=0.6671, bio=0.0015
    Epoch  4/10: total=1.7455, vae=1.0841, dsb=0.6607, bio=0.0015
    Epoch  5/10: total=1.7333, vae=1.0839, dsb=0.6487, bio=0.0014
    Epoch  6/10: total=1.7018, vae=1.0838, dsb=0.6172, bio=0.0014
    Epoch  7/10: total=1.7114, vae=1.0841, dsb=0.6266, bio=0.0014
    Epoch  8/10: total=1.7006, vae=1.0832, dsb=0.6167, bio=0.0014
    Epoch  9/10: total=1.7089, vae=1.0835, dsb=0.6246, bio=0.0015
    Epoch 10/10: total=1.6960, vae=1.0843, dsb=0.6110, bio=0.0014

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=38.4103, vae=1.0861, dsb=37.3226, bio=0.0030
    Epoch  2/10: total=37.2438, vae=1.0855, dsb=36.1575, bio=0.0015
    Epoch  3/10: total=36.9865, vae=1.0851, dsb=35.9006, bio=0.0016
    Epoch  4/10: total=36.7159, vae=1.0852, dsb=35.6299, bio=0.0018
    Epoch  5/10: total=36.8144, vae=1.0846, dsb=35.7290, bio=0.0015
    Epoch  6/10: total=36.5185, vae=1.0835, dsb=35.4342, bio=0.0015
    Epoch  7/10: total=36.2573, vae=1.0848, dsb=35.1717, bio=0.0015
    Epoch  8/10: total=36.4953, vae=1.0851, dsb=35.4094, bio=0.0015
    Epoch  9/10: total=36.1258, vae=1.0844, dsb=35.0406, bio=0.0017
    Epoch 10/10: total=36.4574, vae=1.0835, dsb=35.3732, bio=0.0014

  [Backward Policy Training]
    Epoch  1/10: total=1.6522, vae=1.0849, dsb=0.5491, bio=0.0364
    Epoch  2/10: total=1.5965, vae=1.0837, dsb=0.5121, bio=0.0014
    Epoch  3/10: total=1.6018, vae=1.0838, dsb=0.5174, bio=0.0013
    Epoch  4/10: total=1.6023, vae=1.0829, dsb=0.5187, bio=0.0013
    Epoch  5/10: total=1.5852, vae=1.0842, dsb=0.5004, bio=0.0012
    Epoch  6/10: total=1.5968, vae=1.0838, dsb=0.5124, bio=0.0012
    Epoch  7/10: total=1.5865, vae=1.0841, dsb=0.5018, bio=0.0012
    Epoch  8/10: total=1.5792, vae=1.0830, dsb=0.4956, bio=0.0012
    Epoch  9/10: total=1.5780, vae=1.0840, dsb=0.4931, bio=0.0018
    Epoch 10/10: total=1.5755, vae=1.0840, dsb=0.4910, bio=0.0012

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=32.1875, vae=1.0868, dsb=31.0994, bio=0.0027
    Epoch  2/10: total=31.5955, vae=1.0848, dsb=30.5101, bio=0.0013
    Epoch  3/10: total=31.4430, vae=1.0846, dsb=30.3576, bio=0.0017
    Epoch  4/10: total=31.3837, vae=1.0846, dsb=30.2984, bio=0.0014
    Epoch  5/10: total=31.3874, vae=1.0837, dsb=30.3031, bio=0.0014
    Epoch  6/10: total=31.3577, vae=1.0839, dsb=30.2732, bio=0.0014
    Epoch  7/10: total=31.3697, vae=1.0845, dsb=30.2845, bio=0.0014
    Epoch  8/10: total=31.4009, vae=1.0841, dsb=30.3161, bio=0.0013
    Epoch  9/10: total=31.2039, vae=1.0847, dsb=30.1186, bio=0.0013
    Epoch 10/10: total=31.1814, vae=1.0832, dsb=30.0975, bio=0.0013

  [Backward Policy Training]
    Epoch  1/10: total=1.5541, vae=1.0843, dsb=0.4306, bio=0.0782
    Epoch  2/10: total=1.5018, vae=1.0838, dsb=0.4174, bio=0.0012
    Epoch  3/10: total=1.4886, vae=1.0829, dsb=0.4051, bio=0.0011
    Epoch  4/10: total=1.4945, vae=1.0839, dsb=0.4101, bio=0.0011
    Epoch  5/10: total=1.5024, vae=1.0839, dsb=0.4179, bio=0.0011
    Epoch  6/10: total=1.4999, vae=1.0842, dsb=0.4151, bio=0.0011
    Epoch  7/10: total=1.4965, vae=1.0830, dsb=0.4129, bio=0.0011
    Epoch  8/10: total=1.4899, vae=1.0834, dsb=0.4060, bio=0.0011
    Epoch  9/10: total=1.4830, vae=1.0836, dsb=0.3989, bio=0.0011
    Epoch 10/10: total=1.4994, vae=1.0840, dsb=0.4149, bio=0.0011

[Seed 8] Joint training (original) complete; models and history saved.

[Seed 8] Starting joint training (ablation)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=316.0981, vae=2.0052, dsb=314.0928, bio=0.0000
    Epoch  2/10: total=94.4895, vae=1.0797, dsb=93.4098, bio=0.0000
    Epoch  3/10: total=81.9672, vae=1.0785, dsb=80.8888, bio=0.0000
    Epoch  4/10: total=75.9626, vae=1.0776, dsb=74.8850, bio=0.0000
    Epoch  5/10: total=72.2775, vae=1.0777, dsb=71.1998, bio=0.0000
    Epoch  6/10: total=70.1503, vae=1.0768, dsb=69.0735, bio=0.0000
    Epoch  7/10: total=68.3842, vae=1.0756, dsb=67.3085, bio=0.0000
    Epoch  8/10: total=67.2738, vae=1.0768, dsb=66.1970, bio=0.0000
    Epoch  9/10: total=66.1863, vae=1.0766, dsb=65.1097, bio=0.0000
    Epoch 10/10: total=65.3033, vae=1.0764, dsb=64.2268, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=3.2347, vae=1.0763, dsb=2.1584, bio=0.0000
    Epoch  2/10: total=2.7170, vae=1.0761, dsb=1.6409, bio=0.0000
    Epoch  3/10: total=2.6407, vae=1.0767, dsb=1.5640, bio=0.0000
    Epoch  4/10: total=2.4924, vae=1.0765, dsb=1.4159, bio=0.0000
    Epoch  5/10: total=2.4714, vae=1.0755, dsb=1.3959, bio=0.0000
    Epoch  6/10: total=2.4682, vae=1.0756, dsb=1.3926, bio=0.0000
    Epoch  7/10: total=2.4321, vae=1.0759, dsb=1.3562, bio=0.0000
    Epoch  8/10: total=2.3987, vae=1.0757, dsb=1.3230, bio=0.0000
    Epoch  9/10: total=2.3914, vae=1.0760, dsb=1.3154, bio=0.0000
    Epoch 10/10: total=2.3607, vae=1.0759, dsb=1.2848, bio=0.0000

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=58.6743, vae=1.0760, dsb=57.5982, bio=0.0000
    Epoch  2/10: total=51.7807, vae=1.0758, dsb=50.7049, bio=0.0000
    Epoch  3/10: total=50.2043, vae=1.0759, dsb=49.1285, bio=0.0000
    Epoch  4/10: total=49.3693, vae=1.0757, dsb=48.2936, bio=0.0000
    Epoch  5/10: total=48.5231, vae=1.0762, dsb=47.4469, bio=0.0000
    Epoch  6/10: total=48.2319, vae=1.0759, dsb=47.1560, bio=0.0000
    Epoch  7/10: total=47.9526, vae=1.0757, dsb=46.8769, bio=0.0000
    Epoch  8/10: total=47.8317, vae=1.0758, dsb=46.7558, bio=0.0000
    Epoch  9/10: total=47.3571, vae=1.0765, dsb=46.2806, bio=0.0000
    Epoch 10/10: total=47.3753, vae=1.0754, dsb=46.2999, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=2.0911, vae=1.0766, dsb=1.0146, bio=0.0000
    Epoch  2/10: total=1.9901, vae=1.0756, dsb=0.9146, bio=0.0000
    Epoch  3/10: total=1.9257, vae=1.0753, dsb=0.8504, bio=0.0000
    Epoch  4/10: total=1.9121, vae=1.0762, dsb=0.8359, bio=0.0000
    Epoch  5/10: total=1.9171, vae=1.0755, dsb=0.8416, bio=0.0000
    Epoch  6/10: total=1.8900, vae=1.0754, dsb=0.8146, bio=0.0000
    Epoch  7/10: total=1.8720, vae=1.0766, dsb=0.7954, bio=0.0000
    Epoch  8/10: total=1.8814, vae=1.0766, dsb=0.8048, bio=0.0000
    Epoch  9/10: total=1.8693, vae=1.0758, dsb=0.7935, bio=0.0000
    Epoch 10/10: total=1.8734, vae=1.0759, dsb=0.7975, bio=0.0000

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=42.2425, vae=1.0764, dsb=41.1661, bio=0.0000
    Epoch  2/10: total=39.3964, vae=1.0758, dsb=38.3207, bio=0.0000
    Epoch  3/10: total=38.8054, vae=1.0759, dsb=37.7295, bio=0.0000
    Epoch  4/10: total=38.4561, vae=1.0755, dsb=37.3806, bio=0.0000
    Epoch  5/10: total=38.0830, vae=1.0760, dsb=37.0070, bio=0.0000
    Epoch  6/10: total=37.6507, vae=1.0755, dsb=36.5753, bio=0.0000
    Epoch  7/10: total=37.8452, vae=1.0759, dsb=36.7693, bio=0.0000
    Epoch  8/10: total=37.6267, vae=1.0755, dsb=36.5512, bio=0.0000
    Epoch  9/10: total=37.6382, vae=1.0751, dsb=36.5631, bio=0.0000
    Epoch 10/10: total=37.7238, vae=1.0767, dsb=36.6471, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.7528, vae=1.0749, dsb=0.6779, bio=0.0000
    Epoch  2/10: total=1.7095, vae=1.0761, dsb=0.6334, bio=0.0000
    Epoch  3/10: total=1.6933, vae=1.0756, dsb=0.6177, bio=0.0000
    Epoch  4/10: total=1.6876, vae=1.0759, dsb=0.6117, bio=0.0000
    Epoch  5/10: total=1.6765, vae=1.0757, dsb=0.6008, bio=0.0000
    Epoch  6/10: total=1.6471, vae=1.0757, dsb=0.5714, bio=0.0000
    Epoch  7/10: total=1.6560, vae=1.0760, dsb=0.5800, bio=0.0000
    Epoch  8/10: total=1.6461, vae=1.0751, dsb=0.5709, bio=0.0000
    Epoch  9/10: total=1.6539, vae=1.0755, dsb=0.5784, bio=0.0000
    Epoch 10/10: total=1.6420, vae=1.0763, dsb=0.5657, bio=0.0000

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=34.8259, vae=1.0754, dsb=33.7504, bio=0.0000
    Epoch  2/10: total=33.7363, vae=1.0760, dsb=32.6603, bio=0.0000
    Epoch  3/10: total=33.5052, vae=1.0760, dsb=32.4292, bio=0.0000
    Epoch  4/10: total=33.2544, vae=1.0762, dsb=32.1782, bio=0.0000
    Epoch  5/10: total=33.3233, vae=1.0757, dsb=32.2476, bio=0.0000
    Epoch  6/10: total=33.0875, vae=1.0747, dsb=32.0128, bio=0.0000
    Epoch  7/10: total=32.8629, vae=1.0760, dsb=31.7869, bio=0.0000
    Epoch  8/10: total=33.0996, vae=1.0764, dsb=32.0232, bio=0.0000
    Epoch  9/10: total=32.7638, vae=1.0758, dsb=31.6880, bio=0.0000
    Epoch 10/10: total=33.0499, vae=1.0750, dsb=31.9749, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.5695, vae=1.0759, dsb=0.4936, bio=0.0000
    Epoch  2/10: total=1.5361, vae=1.0757, dsb=0.4604, bio=0.0000
    Epoch  3/10: total=1.5421, vae=1.0759, dsb=0.4663, bio=0.0000
    Epoch  4/10: total=1.5433, vae=1.0750, dsb=0.4683, bio=0.0000
    Epoch  5/10: total=1.5287, vae=1.0764, dsb=0.4523, bio=0.0000
    Epoch  6/10: total=1.5399, vae=1.0760, dsb=0.4638, bio=0.0000
    Epoch  7/10: total=1.5312, vae=1.0762, dsb=0.4549, bio=0.0000
    Epoch  8/10: total=1.5249, vae=1.0753, dsb=0.4496, bio=0.0000
    Epoch  9/10: total=1.5236, vae=1.0763, dsb=0.4474, bio=0.0000
    Epoch 10/10: total=1.5223, vae=1.0763, dsb=0.4460, bio=0.0000

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=29.2816, vae=1.0765, dsb=28.2052, bio=0.0000
    Epoch  2/10: total=28.7600, vae=1.0757, dsb=27.6843, bio=0.0000
    Epoch  3/10: total=28.6304, vae=1.0757, dsb=27.5547, bio=0.0000
    Epoch  4/10: total=28.5848, vae=1.0761, dsb=27.5087, bio=0.0000
    Epoch  5/10: total=28.6040, vae=1.0752, dsb=27.5288, bio=0.0000
    Epoch  6/10: total=28.5673, vae=1.0755, dsb=27.4918, bio=0.0000
    Epoch  7/10: total=28.5478, vae=1.0762, dsb=27.4716, bio=0.0000
    Epoch  8/10: total=28.6282, vae=1.0759, dsb=27.5523, bio=0.0000
    Epoch  9/10: total=28.4265, vae=1.0765, dsb=27.3500, bio=0.0000
    Epoch 10/10: total=28.4119, vae=1.0751, dsb=27.3368, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.4549, vae=1.0754, dsb=0.3795, bio=0.0000
    Epoch  2/10: total=1.4450, vae=1.0760, dsb=0.3691, bio=0.0000
    Epoch  3/10: total=1.4335, vae=1.0752, dsb=0.3583, bio=0.0000
    Epoch  4/10: total=1.4393, vae=1.0761, dsb=0.3631, bio=0.0000
    Epoch  5/10: total=1.4469, vae=1.0763, dsb=0.3706, bio=0.0000
    Epoch  6/10: total=1.4450, vae=1.0766, dsb=0.3684, bio=0.0000
    Epoch  7/10: total=1.4420, vae=1.0755, dsb=0.3665, bio=0.0000
    Epoch  8/10: total=1.4361, vae=1.0759, dsb=0.3603, bio=0.0000
    Epoch  9/10: total=1.4301, vae=1.0761, dsb=0.3540, bio=0.0000
    Epoch 10/10: total=1.4449, vae=1.0764, dsb=0.3685, bio=0.0000

[Seed 8] Joint training (ablation) complete; models and history saved.

[Seed 8] Drift genes saved in /home/yyuan/ICB_TCE/iter_results/run_008

[Seed 8] run finished.

================================================================================
[Seed 9] Starting running whole pipeline...
================================================================================

[Seed 9] Starting VAE pre-training...

    Epoch [01/20], Beta: 0.000, Average Loss: 533.1938
    Epoch [02/20], Beta: 0.000, Average Loss: 301.3194
    Epoch [03/20], Beta: 0.000, Average Loss: 265.5502
    Epoch [04/20], Beta: 0.000, Average Loss: 247.2538
    Epoch [05/20], Beta: 0.100, Average Loss: 243.9900
    Epoch [06/20], Beta: 0.200, Average Loss: 243.7956
    Epoch [07/20], Beta: 0.300, Average Loss: 244.5110
    Epoch [08/20], Beta: 0.400, Average Loss: 245.6229
    Epoch [09/20], Beta: 0.500, Average Loss: 246.8072
    Epoch [10/20], Beta: 0.600, Average Loss: 247.9851
    Epoch [11/20], Beta: 0.700, Average Loss: 249.2458
    Epoch [12/20], Beta: 0.800, Average Loss: 250.5207
    Epoch [13/20], Beta: 0.900, Average Loss: 251.6899
    Epoch [14/20], Beta: 1.000, Average Loss: 253.2968
    Epoch [15/20], Beta: 1.000, Average Loss: 252.8633
    Epoch [16/20], Beta: 1.000, Average Loss: 252.4771
    Epoch [17/20], Beta: 1.000, Average Loss: 252.1250
    Epoch [18/20], Beta: 1.000, Average Loss: 251.7838
    Epoch [19/20], Beta: 1.000, Average Loss: 251.4428
    Epoch [20/20], Beta: 1.000, Average Loss: 251.2151

[Seed 9] VAE pre-training complete.

[Seed 9] Starting joint training (original)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=525.5823, vae=3.4985, dsb=509.0159, bio=26.1357
    Epoch  2/10: total=129.2185, vae=1.0909, dsb=128.0901, bio=0.0750
    Epoch  3/10: total=117.6539, vae=1.0864, dsb=116.5509, bio=0.0330
    Epoch  4/10: total=112.3908, vae=1.0841, dsb=111.2969, bio=0.0196
    Epoch  5/10: total=108.5842, vae=1.0831, dsb=107.4943, bio=0.0135
    Epoch  6/10: total=106.2462, vae=1.0825, dsb=105.1588, bio=0.0099
    Epoch  7/10: total=105.0009, vae=1.0817, dsb=103.9153, bio=0.0078
    Epoch  8/10: total=102.9487, vae=1.0821, dsb=101.8635, bio=0.0063
    Epoch  9/10: total=102.2502, vae=1.0812, dsb=101.1664, bio=0.0053
    Epoch 10/10: total=101.0245, vae=1.0821, dsb=99.9401, bio=0.0046

  [Backward Policy Training]
    Epoch  1/10: total=3.3267, vae=1.0818, dsb=2.2368, bio=0.0161
    Epoch  2/10: total=2.8432, vae=1.0814, dsb=1.7593, bio=0.0050
    Epoch  3/10: total=2.7438, vae=1.0794, dsb=1.6627, bio=0.0034
    Epoch  4/10: total=2.6512, vae=1.0805, dsb=1.5694, bio=0.0028
    Epoch  5/10: total=2.6120, vae=1.0798, dsb=1.5309, bio=0.0025
    Epoch  6/10: total=2.5714, vae=1.0788, dsb=1.4913, bio=0.0025
    Epoch  7/10: total=2.5352, vae=1.0792, dsb=1.4549, bio=0.0022
    Epoch  8/10: total=2.5513, vae=1.0798, dsb=1.4705, bio=0.0020
    Epoch  9/10: total=2.5211, vae=1.0795, dsb=1.4406, bio=0.0019
    Epoch 10/10: total=2.5262, vae=1.0789, dsb=1.4464, bio=0.0019

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=87.5600, vae=1.0821, dsb=86.4760, bio=0.0038
    Epoch  2/10: total=81.6232, vae=1.0803, dsb=80.5417, bio=0.0025
    Epoch  3/10: total=80.1062, vae=1.0805, dsb=79.0248, bio=0.0020
    Epoch  4/10: total=80.0042, vae=1.0805, dsb=78.9228, bio=0.0018
    Epoch  5/10: total=79.3778, vae=1.0804, dsb=78.2965, bio=0.0018
    Epoch  6/10: total=78.4457, vae=1.0797, dsb=77.3651, bio=0.0018
    Epoch  7/10: total=78.0558, vae=1.0796, dsb=76.9753, bio=0.0018
    Epoch  8/10: total=78.1302, vae=1.0800, dsb=77.0493, bio=0.0019
    Epoch  9/10: total=77.9868, vae=1.0803, dsb=76.9055, bio=0.0019
    Epoch 10/10: total=77.6272, vae=1.0784, dsb=76.5478, bio=0.0019

  [Backward Policy Training]
    Epoch  1/10: total=2.2593, vae=1.0803, dsb=1.1756, bio=0.0067
    Epoch  2/10: total=2.1502, vae=1.0782, dsb=1.0711, bio=0.0019
    Epoch  3/10: total=2.1222, vae=1.0783, dsb=1.0430, bio=0.0017
    Epoch  4/10: total=2.0815, vae=1.0788, dsb=1.0019, bio=0.0016
    Epoch  5/10: total=2.0847, vae=1.0781, dsb=1.0056, bio=0.0019
    Epoch  6/10: total=2.0453, vae=1.0778, dsb=0.9667, bio=0.0016
    Epoch  7/10: total=2.0379, vae=1.0768, dsb=0.9603, bio=0.0016
    Epoch  8/10: total=2.0597, vae=1.0775, dsb=0.9813, bio=0.0015
    Epoch  9/10: total=2.0084, vae=1.0775, dsb=0.9301, bio=0.0015
    Epoch 10/10: total=2.0163, vae=1.0765, dsb=0.9391, bio=0.0015

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=62.9245, vae=1.0801, dsb=61.8429, bio=0.0031
    Epoch  2/10: total=61.2325, vae=1.0784, dsb=60.1533, bio=0.0016
    Epoch  3/10: total=60.7872, vae=1.0791, dsb=59.7074, bio=0.0016
    Epoch  4/10: total=60.2145, vae=1.0781, dsb=59.1356, bio=0.0016
    Epoch  5/10: total=60.0906, vae=1.0788, dsb=59.0108, bio=0.0020
    Epoch  6/10: total=60.1221, vae=1.0784, dsb=59.0429, bio=0.0015
    Epoch  7/10: total=59.8390, vae=1.0781, dsb=58.7601, bio=0.0015
    Epoch  8/10: total=59.7599, vae=1.0781, dsb=58.6810, bio=0.0016
    Epoch  9/10: total=59.7986, vae=1.0792, dsb=58.7186, bio=0.0016
    Epoch 10/10: total=59.5737, vae=1.0782, dsb=58.4948, bio=0.0015

  [Backward Policy Training]
    Epoch  1/10: total=1.8823, vae=1.0791, dsb=0.7946, bio=0.0173
    Epoch  2/10: total=1.8507, vae=1.0783, dsb=0.7716, bio=0.0016
    Epoch  3/10: total=1.8173, vae=1.0767, dsb=0.7399, bio=0.0014
    Epoch  4/10: total=1.8136, vae=1.0769, dsb=0.7360, bio=0.0014
    Epoch  5/10: total=1.8116, vae=1.0768, dsb=0.7340, bio=0.0014
    Epoch  6/10: total=1.8080, vae=1.0768, dsb=0.7305, bio=0.0014
    Epoch  7/10: total=1.7884, vae=1.0773, dsb=0.7104, bio=0.0013
    Epoch  8/10: total=1.8142, vae=1.0767, dsb=0.7369, bio=0.0012
    Epoch  9/10: total=1.8019, vae=1.0781, dsb=0.7232, bio=0.0013
    Epoch 10/10: total=1.7957, vae=1.0765, dsb=0.7185, bio=0.0014

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=56.6193, vae=1.0810, dsb=55.5366, bio=0.0034
    Epoch  2/10: total=55.7016, vae=1.0783, dsb=54.6225, bio=0.0013
    Epoch  3/10: total=55.7556, vae=1.0790, dsb=54.6759, bio=0.0014
    Epoch  4/10: total=55.9146, vae=1.0777, dsb=54.8362, bio=0.0014
    Epoch  5/10: total=55.3447, vae=1.0779, dsb=54.2661, bio=0.0013
    Epoch  6/10: total=55.1445, vae=1.0777, dsb=54.0661, bio=0.0014
    Epoch  7/10: total=55.8884, vae=1.0777, dsb=54.8100, bio=0.0013
    Epoch  8/10: total=55.2647, vae=1.0774, dsb=54.1866, bio=0.0013
    Epoch  9/10: total=55.2503, vae=1.0776, dsb=54.1720, bio=0.0013
    Epoch 10/10: total=55.4457, vae=1.0769, dsb=54.3681, bio=0.0013

  [Backward Policy Training]
    Epoch  1/10: total=1.7598, vae=1.0786, dsb=0.6424, bio=0.0777
    Epoch  2/10: total=1.7153, vae=1.0772, dsb=0.6375, bio=0.0014
    Epoch  3/10: total=1.6836, vae=1.0775, dsb=0.6055, bio=0.0012
    Epoch  4/10: total=1.7136, vae=1.0771, dsb=0.6358, bio=0.0013
    Epoch  5/10: total=1.7076, vae=1.0770, dsb=0.6300, bio=0.0012
    Epoch  6/10: total=1.7038, vae=1.0770, dsb=0.6262, bio=0.0011
    Epoch  7/10: total=1.6716, vae=1.0767, dsb=0.5943, bio=0.0011
    Epoch  8/10: total=1.6825, vae=1.0769, dsb=0.6050, bio=0.0011
    Epoch  9/10: total=1.7051, vae=1.0768, dsb=0.6278, bio=0.0011
    Epoch 10/10: total=1.7005, vae=1.0773, dsb=0.6226, bio=0.0011

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=49.5581, vae=1.0788, dsb=48.4778, bio=0.0030
    Epoch  2/10: total=49.0108, vae=1.0786, dsb=47.9317, bio=0.0011
    Epoch  3/10: total=48.9469, vae=1.0775, dsb=47.8688, bio=0.0012
    Epoch  4/10: total=49.0473, vae=1.0772, dsb=47.9695, bio=0.0012
    Epoch  5/10: total=48.4234, vae=1.0772, dsb=47.3456, bio=0.0011
    Epoch  6/10: total=48.7891, vae=1.0775, dsb=47.7113, bio=0.0008
    Epoch  7/10: total=48.7789, vae=1.0770, dsb=47.7013, bio=0.0011
    Epoch  8/10: total=48.8326, vae=1.0767, dsb=47.7553, bio=0.0011
    Epoch  9/10: total=49.1384, vae=1.0773, dsb=48.0606, bio=0.0011
    Epoch 10/10: total=48.9658, vae=1.0769, dsb=47.8884, bio=0.0011

  [Backward Policy Training]
    Epoch  1/10: total=1.7024, vae=1.0790, dsb=0.5428, bio=0.1613
    Epoch  2/10: total=1.6074, vae=1.0760, dsb=0.5308, bio=0.0012
    Epoch  3/10: total=1.6130, vae=1.0767, dsb=0.5359, bio=0.0008
    Epoch  4/10: total=1.6071, vae=1.0760, dsb=0.5306, bio=0.0010
    Epoch  5/10: total=1.6140, vae=1.0772, dsb=0.5362, bio=0.0011
    Epoch  6/10: total=1.6194, vae=1.0774, dsb=0.5415, bio=0.0010
    Epoch  7/10: total=1.6085, vae=1.0762, dsb=0.5317, bio=0.0010
    Epoch  8/10: total=1.6013, vae=1.0768, dsb=0.5240, bio=0.0010
    Epoch  9/10: total=1.6020, vae=1.0768, dsb=0.5247, bio=0.0010
    Epoch 10/10: total=1.6149, vae=1.0762, dsb=0.5382, bio=0.0010

[Seed 9] Joint training (original) complete; models and history saved.

[Seed 9] Starting joint training (ablation)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=510.3253, vae=1.9903, dsb=508.3349, bio=0.0000
    Epoch  2/10: total=128.6729, vae=1.0723, dsb=127.6005, bio=0.0000
    Epoch  3/10: total=117.3431, vae=1.0717, dsb=116.2714, bio=0.0000
    Epoch  4/10: total=111.9558, vae=1.0706, dsb=110.8852, bio=0.0000
    Epoch  5/10: total=108.0667, vae=1.0701, dsb=106.9966, bio=0.0000
    Epoch  6/10: total=105.6225, vae=1.0698, dsb=104.5527, bio=0.0000
    Epoch  7/10: total=104.3504, vae=1.0694, dsb=103.2811, bio=0.0000
    Epoch  8/10: total=102.2674, vae=1.0700, dsb=101.1973, bio=0.0000
    Epoch  9/10: total=101.5949, vae=1.0695, dsb=100.5254, bio=0.0000
    Epoch 10/10: total=100.4596, vae=1.0706, dsb=99.3889, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=3.2194, vae=1.0691, dsb=2.1503, bio=0.0000
    Epoch  2/10: total=2.7589, vae=1.0705, dsb=1.6884, bio=0.0000
    Epoch  3/10: total=2.6659, vae=1.0689, dsb=1.5970, bio=0.0000
    Epoch  4/10: total=2.5781, vae=1.0703, dsb=1.5078, bio=0.0000
    Epoch  5/10: total=2.5396, vae=1.0698, dsb=1.4698, bio=0.0000
    Epoch  6/10: total=2.5023, vae=1.0689, dsb=1.4334, bio=0.0000
    Epoch  7/10: total=2.4675, vae=1.0695, dsb=1.3980, bio=0.0000
    Epoch  8/10: total=2.4839, vae=1.0702, dsb=1.4137, bio=0.0000
    Epoch  9/10: total=2.4544, vae=1.0700, dsb=1.3845, bio=0.0000
    Epoch 10/10: total=2.4595, vae=1.0693, dsb=1.3902, bio=0.0000

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=84.7118, vae=1.0699, dsb=83.6419, bio=0.0000
    Epoch  2/10: total=78.7113, vae=1.0691, dsb=77.6423, bio=0.0000
    Epoch  3/10: total=77.1666, vae=1.0696, dsb=76.0970, bio=0.0000
    Epoch  4/10: total=77.0581, vae=1.0698, dsb=75.9883, bio=0.0000
    Epoch  5/10: total=76.4765, vae=1.0698, dsb=75.4066, bio=0.0000
    Epoch  6/10: total=75.5725, vae=1.0692, dsb=74.5033, bio=0.0000
    Epoch  7/10: total=75.1719, vae=1.0693, dsb=74.1025, bio=0.0000
    Epoch  8/10: total=75.2283, vae=1.0698, dsb=74.1585, bio=0.0000
    Epoch  9/10: total=75.1525, vae=1.0702, dsb=74.0823, bio=0.0000
    Epoch 10/10: total=74.7958, vae=1.0684, dsb=73.7273, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=2.1694, vae=1.0698, dsb=1.0997, bio=0.0000
    Epoch  2/10: total=2.0742, vae=1.0690, dsb=1.0052, bio=0.0000
    Epoch  3/10: total=2.0498, vae=1.0693, dsb=0.9804, bio=0.0000
    Epoch  4/10: total=2.0123, vae=1.0698, dsb=0.9425, bio=0.0000
    Epoch  5/10: total=2.0159, vae=1.0693, dsb=0.9466, bio=0.0000
    Epoch  6/10: total=1.9784, vae=1.0690, dsb=0.9094, bio=0.0000
    Epoch  7/10: total=1.9715, vae=1.0681, dsb=0.9034, bio=0.0000
    Epoch  8/10: total=1.9915, vae=1.0689, dsb=0.9227, bio=0.0000
    Epoch  9/10: total=1.9424, vae=1.0689, dsb=0.8735, bio=0.0000
    Epoch 10/10: total=1.9497, vae=1.0679, dsb=0.8818, bio=0.0000

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=61.6194, vae=1.0688, dsb=60.5506, bio=0.0000
    Epoch  2/10: total=59.9916, vae=1.0684, dsb=58.9231, bio=0.0000
    Epoch  3/10: total=59.4327, vae=1.0694, dsb=58.3633, bio=0.0000
    Epoch  4/10: total=58.8982, vae=1.0686, dsb=57.8296, bio=0.0000
    Epoch  5/10: total=58.7757, vae=1.0692, dsb=57.7065, bio=0.0000
    Epoch  6/10: total=58.7904, vae=1.0691, dsb=57.7214, bio=0.0000
    Epoch  7/10: total=58.5810, vae=1.0689, dsb=57.5122, bio=0.0000
    Epoch  8/10: total=58.4546, vae=1.0689, dsb=57.3858, bio=0.0000
    Epoch  9/10: total=58.5016, vae=1.0701, dsb=57.4315, bio=0.0000
    Epoch 10/10: total=58.2661, vae=1.0691, dsb=57.1970, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.8127, vae=1.0695, dsb=0.7432, bio=0.0000
    Epoch  2/10: total=1.7911, vae=1.0698, dsb=0.7213, bio=0.0000
    Epoch  3/10: total=1.7591, vae=1.0683, dsb=0.6908, bio=0.0000
    Epoch  4/10: total=1.7562, vae=1.0686, dsb=0.6876, bio=0.0000
    Epoch  5/10: total=1.7542, vae=1.0686, dsb=0.6856, bio=0.0000
    Epoch  6/10: total=1.7511, vae=1.0686, dsb=0.6825, bio=0.0000
    Epoch  7/10: total=1.7327, vae=1.0691, dsb=0.6636, bio=0.0000
    Epoch  8/10: total=1.7570, vae=1.0686, dsb=0.6884, bio=0.0000
    Epoch  9/10: total=1.7459, vae=1.0700, dsb=0.6759, bio=0.0000
    Epoch 10/10: total=1.7394, vae=1.0683, dsb=0.6711, bio=0.0000

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=54.0062, vae=1.0695, dsb=52.9367, bio=0.0000
    Epoch  2/10: total=53.1276, vae=1.0689, dsb=52.0587, bio=0.0000
    Epoch  3/10: total=53.1978, vae=1.0699, dsb=52.1279, bio=0.0000
    Epoch  4/10: total=53.3010, vae=1.0688, dsb=52.2322, bio=0.0000
    Epoch  5/10: total=52.7181, vae=1.0691, dsb=51.6490, bio=0.0000
    Epoch  6/10: total=52.6008, vae=1.0692, dsb=51.5316, bio=0.0000
    Epoch  7/10: total=53.2681, vae=1.0693, dsb=52.1989, bio=0.0000
    Epoch  8/10: total=52.6302, vae=1.0690, dsb=51.5612, bio=0.0000
    Epoch  9/10: total=52.6470, vae=1.0693, dsb=51.5777, bio=0.0000
    Epoch 10/10: total=52.8710, vae=1.0686, dsb=51.8024, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.6619, vae=1.0694, dsb=0.5925, bio=0.0000
    Epoch  2/10: total=1.6571, vae=1.0691, dsb=0.5880, bio=0.0000
    Epoch  3/10: total=1.6271, vae=1.0695, dsb=0.5576, bio=0.0000
    Epoch  4/10: total=1.6556, vae=1.0691, dsb=0.5865, bio=0.0000
    Epoch  5/10: total=1.6498, vae=1.0691, dsb=0.5807, bio=0.0000
    Epoch  6/10: total=1.6464, vae=1.0691, dsb=0.5773, bio=0.0000
    Epoch  7/10: total=1.6161, vae=1.0689, dsb=0.5472, bio=0.0000
    Epoch  8/10: total=1.6265, vae=1.0691, dsb=0.5573, bio=0.0000
    Epoch  9/10: total=1.6479, vae=1.0691, dsb=0.5788, bio=0.0000
    Epoch 10/10: total=1.6431, vae=1.0695, dsb=0.5736, bio=0.0000

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=47.5776, vae=1.0685, dsb=46.5091, bio=0.0000
    Epoch  2/10: total=47.0208, vae=1.0694, dsb=45.9514, bio=0.0000
    Epoch  3/10: total=46.9956, vae=1.0687, dsb=45.9270, bio=0.0000
    Epoch  4/10: total=47.0991, vae=1.0688, dsb=46.0303, bio=0.0000
    Epoch  5/10: total=46.4843, vae=1.0690, dsb=45.4154, bio=0.0000
    Epoch  6/10: total=46.8319, vae=1.0694, dsb=45.7625, bio=0.0000
    Epoch  7/10: total=46.8470, vae=1.0691, dsb=45.7779, bio=0.0000
    Epoch  8/10: total=46.9022, vae=1.0689, dsb=45.8334, bio=0.0000
    Epoch  9/10: total=47.1549, vae=1.0694, dsb=46.0855, bio=0.0000
    Epoch 10/10: total=47.0301, vae=1.0691, dsb=45.9610, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.5648, vae=1.0701, dsb=0.4947, bio=0.0000
    Epoch  2/10: total=1.5521, vae=1.0681, dsb=0.4840, bio=0.0000
    Epoch  3/10: total=1.5580, vae=1.0689, dsb=0.4891, bio=0.0000
    Epoch  4/10: total=1.5528, vae=1.0684, dsb=0.4845, bio=0.0000
    Epoch  5/10: total=1.5595, vae=1.0696, dsb=0.4898, bio=0.0000
    Epoch  6/10: total=1.5645, vae=1.0699, dsb=0.4946, bio=0.0000
    Epoch  7/10: total=1.5539, vae=1.0688, dsb=0.4851, bio=0.0000
    Epoch  8/10: total=1.5477, vae=1.0692, dsb=0.4784, bio=0.0000
    Epoch  9/10: total=1.5483, vae=1.0695, dsb=0.4788, bio=0.0000
    Epoch 10/10: total=1.5604, vae=1.0689, dsb=0.4915, bio=0.0000

[Seed 9] Joint training (ablation) complete; models and history saved.

[Seed 9] Drift genes saved in /home/yyuan/ICB_TCE/iter_results/run_009

[Seed 9] run finished.

================================================================================
[Seed 10] Starting running whole pipeline...
================================================================================

[Seed 10] Starting VAE pre-training...

    Epoch [01/20], Beta: 0.000, Average Loss: 533.7838
    Epoch [02/20], Beta: 0.000, Average Loss: 303.1555
    Epoch [03/20], Beta: 0.000, Average Loss: 266.6371
    Epoch [04/20], Beta: 0.000, Average Loss: 247.6776
    Epoch [05/20], Beta: 0.100, Average Loss: 243.8911
    Epoch [06/20], Beta: 0.200, Average Loss: 243.6169
    Epoch [07/20], Beta: 0.300, Average Loss: 244.2171
    Epoch [08/20], Beta: 0.400, Average Loss: 245.2782
    Epoch [09/20], Beta: 0.500, Average Loss: 246.5482
    Epoch [10/20], Beta: 0.600, Average Loss: 247.8642
    Epoch [11/20], Beta: 0.700, Average Loss: 249.1553
    Epoch [12/20], Beta: 0.800, Average Loss: 250.3787
    Epoch [13/20], Beta: 0.900, Average Loss: 251.6411
    Epoch [14/20], Beta: 1.000, Average Loss: 253.2125
    Epoch [15/20], Beta: 1.000, Average Loss: 252.8106
    Epoch [16/20], Beta: 1.000, Average Loss: 252.4043
    Epoch [17/20], Beta: 1.000, Average Loss: 252.1153
    Epoch [18/20], Beta: 1.000, Average Loss: 251.7990
    Epoch [19/20], Beta: 1.000, Average Loss: 251.4535
    Epoch [20/20], Beta: 1.000, Average Loss: 251.2405

[Seed 10] VAE pre-training complete.

[Seed 10] Starting joint training (original)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=598.9625, vae=3.4475, dsb=583.8620, bio=23.3059
    Epoch  2/10: total=167.9449, vae=1.0984, dsb=166.8111, bio=0.0708
    Epoch  3/10: total=157.1907, vae=1.0919, dsb=156.0827, bio=0.0323
    Epoch  4/10: total=151.4420, vae=1.0916, dsb=150.3407, bio=0.0193
    Epoch  5/10: total=148.3284, vae=1.0891, dsb=147.2325, bio=0.0136
    Epoch  6/10: total=145.8708, vae=1.0890, dsb=144.7769, bio=0.0099
    Epoch  7/10: total=144.1783, vae=1.0879, dsb=143.0865, bio=0.0077
    Epoch  8/10: total=143.2393, vae=1.0876, dsb=142.1485, bio=0.0063
    Epoch  9/10: total=141.7385, vae=1.0880, dsb=140.6477, bio=0.0057
    Epoch 10/10: total=141.5442, vae=1.0868, dsb=140.4552, bio=0.0044

  [Backward Policy Training]
    Epoch  1/10: total=3.4735, vae=1.0886, dsb=2.3774, bio=0.0151
    Epoch  2/10: total=2.9066, vae=1.0876, dsb=1.8164, bio=0.0051
    Epoch  3/10: total=2.7820, vae=1.0870, dsb=1.6932, bio=0.0035
    Epoch  4/10: total=2.6818, vae=1.0854, dsb=1.5948, bio=0.0030
    Epoch  5/10: total=2.6434, vae=1.0863, dsb=1.5558, bio=0.0025
    Epoch  6/10: total=2.5968, vae=1.0860, dsb=1.5097, bio=0.0022
    Epoch  7/10: total=2.5995, vae=1.0854, dsb=1.5130, bio=0.0021
    Epoch  8/10: total=2.5307, vae=1.0851, dsb=1.4447, bio=0.0020
    Epoch  9/10: total=2.5461, vae=1.0863, dsb=1.4589, bio=0.0019
    Epoch 10/10: total=2.5733, vae=1.0846, dsb=1.4877, bio=0.0019

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=130.7557, vae=1.0877, dsb=129.6660, bio=0.0040
    Epoch  2/10: total=125.9690, vae=1.0864, dsb=124.8817, bio=0.0018
    Epoch  3/10: total=124.5402, vae=1.0858, dsb=123.4536, bio=0.0017
    Epoch  4/10: total=123.3034, vae=1.0857, dsb=122.2169, bio=0.0017
    Epoch  5/10: total=123.7445, vae=1.0856, dsb=122.6580, bio=0.0018
    Epoch  6/10: total=123.5696, vae=1.0863, dsb=122.4824, bio=0.0018
    Epoch  7/10: total=121.7396, vae=1.0855, dsb=120.6533, bio=0.0017
    Epoch  8/10: total=122.5450, vae=1.0855, dsb=121.4587, bio=0.0017
    Epoch  9/10: total=121.9700, vae=1.0848, dsb=120.8844, bio=0.0018
    Epoch 10/10: total=121.2689, vae=1.0856, dsb=120.1824, bio=0.0018

  [Backward Policy Training]
    Epoch  1/10: total=2.2481, vae=1.0865, dsb=1.1584, bio=0.0063
    Epoch  2/10: total=2.1465, vae=1.0847, dsb=1.0607, bio=0.0022
    Epoch  3/10: total=2.1311, vae=1.0840, dsb=1.0462, bio=0.0017
    Epoch  4/10: total=2.0876, vae=1.0844, dsb=1.0023, bio=0.0016
    Epoch  5/10: total=2.0608, vae=1.0836, dsb=0.9764, bio=0.0016
    Epoch  6/10: total=2.0568, vae=1.0851, dsb=0.9708, bio=0.0020
    Epoch  7/10: total=2.0214, vae=1.0840, dsb=0.9367, bio=0.0015
    Epoch  8/10: total=2.0380, vae=1.0839, dsb=0.9534, bio=0.0015
    Epoch  9/10: total=2.0528, vae=1.0839, dsb=0.9682, bio=0.0014
    Epoch 10/10: total=2.0346, vae=1.0836, dsb=0.9503, bio=0.0014

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=106.8718, vae=1.0862, dsb=105.7840, bio=0.0031
    Epoch  2/10: total=105.4093, vae=1.0858, dsb=104.3227, bio=0.0016
    Epoch  3/10: total=104.3799, vae=1.0858, dsb=103.2933, bio=0.0017
    Epoch  4/10: total=104.2422, vae=1.0844, dsb=103.1570, bio=0.0016
    Epoch  5/10: total=103.2759, vae=1.0848, dsb=102.1903, bio=0.0015
    Epoch  6/10: total=103.8201, vae=1.0846, dsb=102.7347, bio=0.0015
    Epoch  7/10: total=103.7164, vae=1.0848, dsb=102.6308, bio=0.0015
    Epoch  8/10: total=104.0096, vae=1.0852, dsb=102.9237, bio=0.0015
    Epoch  9/10: total=103.5329, vae=1.0848, dsb=102.4473, bio=0.0017
    Epoch 10/10: total=103.6892, vae=1.0851, dsb=102.6033, bio=0.0015

  [Backward Policy Training]
    Epoch  1/10: total=1.9255, vae=1.0842, dsb=0.8337, bio=0.0153
    Epoch  2/10: total=1.8494, vae=1.0839, dsb=0.7647, bio=0.0016
    Epoch  3/10: total=1.8368, vae=1.0837, dsb=0.7524, bio=0.0014
    Epoch  4/10: total=1.8127, vae=1.0845, dsb=0.7276, bio=0.0013
    Epoch  5/10: total=1.8006, vae=1.0829, dsb=0.7171, bio=0.0013
    Epoch  6/10: total=1.8175, vae=1.0835, dsb=0.7334, bio=0.0013
    Epoch  7/10: total=1.7597, vae=1.0834, dsb=0.6757, bio=0.0013
    Epoch  8/10: total=1.7744, vae=1.0834, dsb=0.6904, bio=0.0013
    Epoch  9/10: total=1.7886, vae=1.0839, dsb=0.7041, bio=0.0012
    Epoch 10/10: total=1.8034, vae=1.0832, dsb=0.7195, bio=0.0014

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=88.9232, vae=1.0858, dsb=87.8360, bio=0.0027
    Epoch  2/10: total=87.1409, vae=1.0837, dsb=86.0565, bio=0.0014
    Epoch  3/10: total=87.6388, vae=1.0845, dsb=86.5536, bio=0.0014
    Epoch  4/10: total=87.4986, vae=1.0841, dsb=86.4138, bio=0.0015
    Epoch  5/10: total=87.1460, vae=1.0841, dsb=86.0613, bio=0.0013
    Epoch  6/10: total=86.5899, vae=1.0834, dsb=85.5058, bio=0.0013
    Epoch  7/10: total=87.3790, vae=1.0841, dsb=86.2942, bio=0.0013
    Epoch  8/10: total=86.4509, vae=1.0842, dsb=85.3660, bio=0.0014
    Epoch  9/10: total=87.3839, vae=1.0845, dsb=86.2987, bio=0.0014
    Epoch 10/10: total=86.8524, vae=1.0838, dsb=85.7680, bio=0.0013

  [Backward Policy Training]
    Epoch  1/10: total=1.7305, vae=1.0853, dsb=0.5918, bio=0.1069
    Epoch  2/10: total=1.6682, vae=1.0839, dsb=0.5837, bio=0.0014
    Epoch  3/10: total=1.6634, vae=1.0843, dsb=0.5784, bio=0.0013
    Epoch  4/10: total=1.6470, vae=1.0833, dsb=0.5630, bio=0.0012
    Epoch  5/10: total=1.6222, vae=1.0824, dsb=0.5392, bio=0.0011
    Epoch  6/10: total=1.6377, vae=1.0830, dsb=0.5543, bio=0.0011
    Epoch  7/10: total=1.6646, vae=1.0830, dsb=0.5811, bio=0.0011
    Epoch  8/10: total=1.6402, vae=1.0839, dsb=0.5556, bio=0.0013
    Epoch  9/10: total=1.6325, vae=1.0828, dsb=0.5492, bio=0.0010
    Epoch 10/10: total=1.6365, vae=1.0825, dsb=0.5535, bio=0.0010

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=76.3037, vae=1.0858, dsb=75.2166, bio=0.0027
    Epoch  2/10: total=76.2763, vae=1.0847, dsb=75.1909, bio=0.0013
    Epoch  3/10: total=75.6243, vae=1.0836, dsb=74.5401, bio=0.0012
    Epoch  4/10: total=75.8277, vae=1.0842, dsb=74.7429, bio=0.0012
    Epoch  5/10: total=75.4765, vae=1.0830, dsb=74.3929, bio=0.0012
    Epoch  6/10: total=75.7961, vae=1.0842, dsb=74.7114, bio=0.0012
    Epoch  7/10: total=75.9340, vae=1.0831, dsb=74.8503, bio=0.0012
    Epoch  8/10: total=75.3791, vae=1.0827, dsb=74.2958, bio=0.0012
    Epoch  9/10: total=75.6652, vae=1.0837, dsb=74.5810, bio=0.0011
    Epoch 10/10: total=75.2965, vae=1.0826, dsb=74.2133, bio=0.0011

  [Backward Policy Training]
    Epoch  1/10: total=1.6810, vae=1.0847, dsb=0.5095, bio=0.1736
    Epoch  2/10: total=1.5630, vae=1.0830, dsb=0.4794, bio=0.0013
    Epoch  3/10: total=1.5696, vae=1.0836, dsb=0.4855, bio=0.0009
    Epoch  4/10: total=1.5801, vae=1.0825, dsb=0.4971, bio=0.0010
    Epoch  5/10: total=1.5826, vae=1.0832, dsb=0.4989, bio=0.0010
    Epoch  6/10: total=1.5702, vae=1.0827, dsb=0.4870, bio=0.0010
    Epoch  7/10: total=1.5815, vae=1.0833, dsb=0.4977, bio=0.0010
    Epoch  8/10: total=1.5486, vae=1.0827, dsb=0.4654, bio=0.0009
    Epoch  9/10: total=1.5898, vae=1.0834, dsb=0.5059, bio=0.0009
    Epoch 10/10: total=1.5648, vae=1.0835, dsb=0.4810, bio=0.0007

[Seed 10] Joint training (original) complete; models and history saved.

[Seed 10] Starting joint training (ablation)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=585.2081, vae=1.9923, dsb=583.2159, bio=0.0000
    Epoch  2/10: total=167.1921, vae=1.0799, dsb=166.1123, bio=0.0000
    Epoch  3/10: total=156.4538, vae=1.0770, dsb=155.3768, bio=0.0000
    Epoch  4/10: total=150.6782, vae=1.0780, dsb=149.6002, bio=0.0000
    Epoch  5/10: total=147.7211, vae=1.0760, dsb=146.6451, bio=0.0000
    Epoch  6/10: total=145.3930, vae=1.0764, dsb=144.3166, bio=0.0000
    Epoch  7/10: total=143.8079, vae=1.0757, dsb=142.7322, bio=0.0000
    Epoch  8/10: total=142.9937, vae=1.0756, dsb=141.9180, bio=0.0000
    Epoch  9/10: total=141.4933, vae=1.0763, dsb=140.4171, bio=0.0000
    Epoch 10/10: total=141.2800, vae=1.0754, dsb=140.2046, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=3.3425, vae=1.0762, dsb=2.2663, bio=0.0000
    Epoch  2/10: total=2.8023, vae=1.0768, dsb=1.7255, bio=0.0000
    Epoch  3/10: total=2.6825, vae=1.0767, dsb=1.6057, bio=0.0000
    Epoch  4/10: total=2.5876, vae=1.0754, dsb=1.5123, bio=0.0000
    Epoch  5/10: total=2.5517, vae=1.0765, dsb=1.4752, bio=0.0000
    Epoch  6/10: total=2.5085, vae=1.0764, dsb=1.4322, bio=0.0000
    Epoch  7/10: total=2.5145, vae=1.0760, dsb=1.4386, bio=0.0000
    Epoch  8/10: total=2.4482, vae=1.0757, dsb=1.3726, bio=0.0000
    Epoch  9/10: total=2.4629, vae=1.0770, dsb=1.3859, bio=0.0000
    Epoch 10/10: total=2.4895, vae=1.0754, dsb=1.4141, bio=0.0000

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=133.6659, vae=1.0759, dsb=132.5900, bio=0.0000
    Epoch  2/10: total=129.3653, vae=1.0757, dsb=128.2896, bio=0.0000
    Epoch  3/10: total=128.0182, vae=1.0753, dsb=126.9429, bio=0.0000
    Epoch  4/10: total=126.7242, vae=1.0754, dsb=125.6488, bio=0.0000
    Epoch  5/10: total=127.2233, vae=1.0753, dsb=126.1479, bio=0.0000
    Epoch  6/10: total=127.1844, vae=1.0762, dsb=126.1082, bio=0.0000
    Epoch  7/10: total=125.0678, vae=1.0755, dsb=123.9923, bio=0.0000
    Epoch  8/10: total=125.9804, vae=1.0756, dsb=124.9047, bio=0.0000
    Epoch  9/10: total=125.3686, vae=1.0750, dsb=124.2936, bio=0.0000
    Epoch 10/10: total=124.6900, vae=1.0759, dsb=123.6141, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=2.1691, vae=1.0758, dsb=1.0933, bio=0.0000
    Epoch  2/10: total=2.0814, vae=1.0758, dsb=1.0056, bio=0.0000
    Epoch  3/10: total=2.0693, vae=1.0753, dsb=0.9940, bio=0.0000
    Epoch  4/10: total=2.0283, vae=1.0758, dsb=0.9525, bio=0.0000
    Epoch  5/10: total=2.0039, vae=1.0751, dsb=0.9288, bio=0.0000
    Epoch  6/10: total=2.0008, vae=1.0765, dsb=0.9243, bio=0.0000
    Epoch  7/10: total=1.9676, vae=1.0755, dsb=0.8921, bio=0.0000
    Epoch  8/10: total=1.9848, vae=1.0755, dsb=0.9093, bio=0.0000
    Epoch  9/10: total=2.0005, vae=1.0755, dsb=0.9249, bio=0.0000
    Epoch 10/10: total=1.9838, vae=1.0752, dsb=0.9086, bio=0.0000

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=113.0890, vae=1.0752, dsb=112.0138, bio=0.0000
    Epoch  2/10: total=111.7768, vae=1.0761, dsb=110.7007, bio=0.0000
    Epoch  3/10: total=110.8075, vae=1.0763, dsb=109.7312, bio=0.0000
    Epoch  4/10: total=110.5462, vae=1.0751, dsb=109.4711, bio=0.0000
    Epoch  5/10: total=109.6919, vae=1.0755, dsb=108.6163, bio=0.0000
    Epoch  6/10: total=110.1790, vae=1.0754, dsb=109.1036, bio=0.0000
    Epoch  7/10: total=110.0997, vae=1.0756, dsb=109.0241, bio=0.0000
    Epoch  8/10: total=110.4180, vae=1.0761, dsb=109.3418, bio=0.0000
    Epoch  9/10: total=110.0371, vae=1.0757, dsb=108.9614, bio=0.0000
    Epoch 10/10: total=110.1682, vae=1.0763, dsb=109.0919, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.8752, vae=1.0749, dsb=0.8003, bio=0.0000
    Epoch  2/10: total=1.8129, vae=1.0757, dsb=0.7372, bio=0.0000
    Epoch  3/10: total=1.8037, vae=1.0755, dsb=0.7281, bio=0.0000
    Epoch  4/10: total=1.7814, vae=1.0763, dsb=0.7051, bio=0.0000
    Epoch  5/10: total=1.7712, vae=1.0748, dsb=0.6964, bio=0.0000
    Epoch  6/10: total=1.7906, vae=1.0755, dsb=0.7151, bio=0.0000
    Epoch  7/10: total=1.7332, vae=1.0754, dsb=0.6578, bio=0.0000
    Epoch  8/10: total=1.7488, vae=1.0754, dsb=0.6734, bio=0.0000
    Epoch  9/10: total=1.7639, vae=1.0759, dsb=0.6880, bio=0.0000
    Epoch 10/10: total=1.7796, vae=1.0753, dsb=0.7043, bio=0.0000

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=93.8210, vae=1.0753, dsb=92.7457, bio=0.0000
    Epoch  2/10: total=91.8950, vae=1.0744, dsb=90.8206, bio=0.0000
    Epoch  3/10: total=92.5176, vae=1.0755, dsb=91.4421, bio=0.0000
    Epoch  4/10: total=92.3760, vae=1.0753, dsb=91.3007, bio=0.0000
    Epoch  5/10: total=91.9666, vae=1.0755, dsb=90.8911, bio=0.0000
    Epoch  6/10: total=91.3689, vae=1.0749, dsb=90.2940, bio=0.0000
    Epoch  7/10: total=92.2411, vae=1.0757, dsb=91.1655, bio=0.0000
    Epoch  8/10: total=91.3157, vae=1.0759, dsb=90.2398, bio=0.0000
    Epoch  9/10: total=92.3893, vae=1.0762, dsb=91.3131, bio=0.0000
    Epoch 10/10: total=91.7404, vae=1.0757, dsb=90.6648, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.6479, vae=1.0761, dsb=0.5718, bio=0.0000
    Epoch  2/10: total=1.6431, vae=1.0758, dsb=0.5673, bio=0.0000
    Epoch  3/10: total=1.6393, vae=1.0764, dsb=0.5629, bio=0.0000
    Epoch  4/10: total=1.6238, vae=1.0755, dsb=0.5483, bio=0.0000
    Epoch  5/10: total=1.5990, vae=1.0746, dsb=0.5245, bio=0.0000
    Epoch  6/10: total=1.6147, vae=1.0752, dsb=0.5395, bio=0.0000
    Epoch  7/10: total=1.6426, vae=1.0752, dsb=0.5674, bio=0.0000
    Epoch  8/10: total=1.6178, vae=1.0761, dsb=0.5417, bio=0.0000
    Epoch  9/10: total=1.6102, vae=1.0751, dsb=0.5351, bio=0.0000
    Epoch 10/10: total=1.6146, vae=1.0748, dsb=0.5398, bio=0.0000

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=81.6204, vae=1.0756, dsb=80.5449, bio=0.0000
    Epoch  2/10: total=81.7155, vae=1.0757, dsb=80.6398, bio=0.0000
    Epoch  3/10: total=80.9385, vae=1.0750, dsb=79.8634, bio=0.0000
    Epoch  4/10: total=81.0954, vae=1.0758, dsb=80.0195, bio=0.0000
    Epoch  5/10: total=80.8124, vae=1.0748, dsb=79.7376, bio=0.0000
    Epoch  6/10: total=81.1922, vae=1.0762, dsb=80.1160, bio=0.0000
    Epoch  7/10: total=81.2827, vae=1.0752, dsb=80.2075, bio=0.0000
    Epoch  8/10: total=80.7175, vae=1.0748, dsb=79.6426, bio=0.0000
    Epoch  9/10: total=81.0788, vae=1.0759, dsb=80.0029, bio=0.0000
    Epoch 10/10: total=80.6116, vae=1.0748, dsb=79.5368, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.5774, vae=1.0757, dsb=0.5017, bio=0.0000
    Epoch  2/10: total=1.5482, vae=1.0751, dsb=0.4732, bio=0.0000
    Epoch  3/10: total=1.5556, vae=1.0759, dsb=0.4797, bio=0.0000
    Epoch  4/10: total=1.5671, vae=1.0749, dsb=0.4922, bio=0.0000
    Epoch  5/10: total=1.5697, vae=1.0756, dsb=0.4941, bio=0.0000
    Epoch  6/10: total=1.5569, vae=1.0751, dsb=0.4818, bio=0.0000
    Epoch  7/10: total=1.5690, vae=1.0758, dsb=0.4932, bio=0.0000
    Epoch  8/10: total=1.5352, vae=1.0752, dsb=0.4601, bio=0.0000
    Epoch  9/10: total=1.5779, vae=1.0759, dsb=0.5019, bio=0.0000
    Epoch 10/10: total=1.5523, vae=1.0759, dsb=0.4763, bio=0.0000

[Seed 10] Joint training (ablation) complete; models and history saved.

[Seed 10] Drift genes saved in /home/yyuan/ICB_TCE/iter_results/run_010

[Seed 10] run finished.

================================================================================
[Seed 11] Starting running whole pipeline...
================================================================================

[Seed 11] Starting VAE pre-training...

    Epoch [01/20], Beta: 0.000, Average Loss: 535.9812
    Epoch [02/20], Beta: 0.000, Average Loss: 308.3111
    Epoch [03/20], Beta: 0.000, Average Loss: 271.6619
    Epoch [04/20], Beta: 0.000, Average Loss: 251.9932
    Epoch [05/20], Beta: 0.100, Average Loss: 246.4246
    Epoch [06/20], Beta: 0.200, Average Loss: 244.8193
    Epoch [07/20], Beta: 0.300, Average Loss: 244.8995
    Epoch [08/20], Beta: 0.400, Average Loss: 245.7590
    Epoch [09/20], Beta: 0.500, Average Loss: 246.8040
    Epoch [10/20], Beta: 0.600, Average Loss: 247.9220
    Epoch [11/20], Beta: 0.700, Average Loss: 249.1330
    Epoch [12/20], Beta: 0.800, Average Loss: 250.3869
    Epoch [13/20], Beta: 0.900, Average Loss: 251.6009
    Epoch [14/20], Beta: 1.000, Average Loss: 253.2161
    Epoch [15/20], Beta: 1.000, Average Loss: 252.7873
    Epoch [16/20], Beta: 1.000, Average Loss: 252.3915
    Epoch [17/20], Beta: 1.000, Average Loss: 252.0446
    Epoch [18/20], Beta: 1.000, Average Loss: 251.7298
    Epoch [19/20], Beta: 1.000, Average Loss: 251.3733
    Epoch [20/20], Beta: 1.000, Average Loss: 251.1895

[Seed 11] VAE pre-training complete.

[Seed 11] Starting joint training (original)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=198.8138, vae=3.5785, dsb=175.9146, bio=38.6413
    Epoch  2/10: total=56.2018, vae=1.0970, dsb=55.0741, bio=0.0615
    Epoch  3/10: total=47.2540, vae=1.0938, dsb=46.1468, bio=0.0269
    Epoch  4/10: total=43.1476, vae=1.0921, dsb=42.0477, bio=0.0157
    Epoch  5/10: total=40.4893, vae=1.0912, dsb=39.3929, bio=0.0105
    Epoch  6/10: total=38.9702, vae=1.0904, dsb=37.8760, bio=0.0076
    Epoch  7/10: total=37.6274, vae=1.0892, dsb=36.5352, bio=0.0059
    Epoch  8/10: total=36.6425, vae=1.0898, dsb=35.5503, bio=0.0049
    Epoch  9/10: total=35.9169, vae=1.0890, dsb=34.8258, bio=0.0041
    Epoch 10/10: total=35.1968, vae=1.0885, dsb=34.1065, bio=0.0036

  [Backward Policy Training]
    Epoch  1/10: total=3.0464, vae=1.0897, dsb=1.9513, bio=0.0109
    Epoch  2/10: total=2.5287, vae=1.0880, dsb=1.4388, bio=0.0038
    Epoch  3/10: total=2.3531, vae=1.0875, dsb=1.2642, bio=0.0029
    Epoch  4/10: total=2.3486, vae=1.0877, dsb=1.2596, bio=0.0025
    Epoch  5/10: total=2.2963, vae=1.0874, dsb=1.2077, bio=0.0023
    Epoch  6/10: total=2.2878, vae=1.0870, dsb=1.1998, bio=0.0021
    Epoch  7/10: total=2.2529, vae=1.0877, dsb=1.1639, bio=0.0026
    Epoch  8/10: total=2.2559, vae=1.0869, dsb=1.1680, bio=0.0020
    Epoch  9/10: total=2.2138, vae=1.0867, dsb=1.1261, bio=0.0019
    Epoch 10/10: total=2.2021, vae=1.0870, dsb=1.1141, bio=0.0019

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=33.7313, vae=1.0892, dsb=32.6405, bio=0.0033
    Epoch  2/10: total=28.1200, vae=1.0884, dsb=27.0306, bio=0.0019
    Epoch  3/10: total=26.6387, vae=1.0870, dsb=25.5508, bio=0.0018
    Epoch  4/10: total=25.7967, vae=1.0867, dsb=24.7089, bio=0.0021
    Epoch  5/10: total=25.2978, vae=1.0869, dsb=24.2100, bio=0.0017
    Epoch  6/10: total=24.8503, vae=1.0879, dsb=23.7614, bio=0.0018
    Epoch  7/10: total=24.6103, vae=1.0876, dsb=23.5218, bio=0.0018
    Epoch  8/10: total=24.4110, vae=1.0874, dsb=23.3227, bio=0.0018
    Epoch  9/10: total=24.1875, vae=1.0872, dsb=23.0994, bio=0.0019
    Epoch 10/10: total=24.0915, vae=1.0861, dsb=23.0045, bio=0.0017

  [Backward Policy Training]
    Epoch  1/10: total=2.0027, vae=1.0865, dsb=0.9120, bio=0.0083
    Epoch  2/10: total=1.8790, vae=1.0860, dsb=0.7921, bio=0.0018
    Epoch  3/10: total=1.8503, vae=1.0859, dsb=0.7636, bio=0.0016
    Epoch  4/10: total=1.8235, vae=1.0856, dsb=0.7371, bio=0.0016
    Epoch  5/10: total=1.8063, vae=1.0850, dsb=0.7205, bio=0.0015
    Epoch  6/10: total=1.7776, vae=1.0860, dsb=0.6909, bio=0.0015
    Epoch  7/10: total=1.7929, vae=1.0859, dsb=0.7063, bio=0.0015
    Epoch  8/10: total=1.7810, vae=1.0854, dsb=0.6949, bio=0.0014
    Epoch  9/10: total=1.7671, vae=1.0853, dsb=0.6811, bio=0.0014
    Epoch 10/10: total=1.7435, vae=1.0854, dsb=0.6574, bio=0.0014

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=23.0205, vae=1.0878, dsb=21.9314, bio=0.0028
    Epoch  2/10: total=21.0356, vae=1.0874, dsb=19.9475, bio=0.0015
    Epoch  3/10: total=20.4183, vae=1.0863, dsb=19.3312, bio=0.0016
    Epoch  4/10: total=20.1956, vae=1.0862, dsb=19.1086, bio=0.0016
    Epoch  5/10: total=19.9024, vae=1.0859, dsb=18.8158, bio=0.0013
    Epoch  6/10: total=19.7924, vae=1.0856, dsb=18.7061, bio=0.0014
    Epoch  7/10: total=19.6753, vae=1.0859, dsb=18.5887, bio=0.0014
    Epoch  8/10: total=19.5853, vae=1.0853, dsb=18.4993, bio=0.0013
    Epoch  9/10: total=19.5107, vae=1.0852, dsb=18.4248, bio=0.0014
    Epoch 10/10: total=19.5238, vae=1.0861, dsb=18.4370, bio=0.0012

  [Backward Policy Training]
    Epoch  1/10: total=1.7114, vae=1.0865, dsb=0.5806, bio=0.0886
    Epoch  2/10: total=1.6110, vae=1.0846, dsb=0.5257, bio=0.0015
    Epoch  3/10: total=1.5945, vae=1.0843, dsb=0.5096, bio=0.0013
    Epoch  4/10: total=1.5816, vae=1.0851, dsb=0.4959, bio=0.0013
    Epoch  5/10: total=1.5820, vae=1.0853, dsb=0.4960, bio=0.0014
    Epoch  6/10: total=1.5723, vae=1.0850, dsb=0.4867, bio=0.0012
    Epoch  7/10: total=1.5588, vae=1.0853, dsb=0.4729, bio=0.0012
    Epoch  8/10: total=1.5534, vae=1.0846, dsb=0.4682, bio=0.0014
    Epoch  9/10: total=1.5678, vae=1.0838, dsb=0.4833, bio=0.0012
    Epoch 10/10: total=1.5406, vae=1.0831, dsb=0.4570, bio=0.0011

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=17.9946, vae=1.0878, dsb=16.9049, bio=0.0038
    Epoch  2/10: total=17.1602, vae=1.0860, dsb=16.0736, bio=0.0012
    Epoch  3/10: total=16.9264, vae=1.0865, dsb=15.8394, bio=0.0011
    Epoch  4/10: total=16.9180, vae=1.0867, dsb=15.8307, bio=0.0012
    Epoch  5/10: total=16.6911, vae=1.0861, dsb=15.6046, bio=0.0009
    Epoch  6/10: total=16.6481, vae=1.0851, dsb=15.5624, bio=0.0012
    Epoch  7/10: total=16.5791, vae=1.0849, dsb=15.4936, bio=0.0012
    Epoch  8/10: total=16.5681, vae=1.0859, dsb=15.4817, bio=0.0011
    Epoch  9/10: total=16.5259, vae=1.0848, dsb=15.4406, bio=0.0011
    Epoch 10/10: total=16.5238, vae=1.0853, dsb=15.4381, bio=0.0009

  [Backward Policy Training]
    Epoch  1/10: total=1.5392, vae=1.0860, dsb=0.4038, bio=0.0987
    Epoch  2/10: total=1.4786, vae=1.0847, dsb=0.3932, bio=0.0013
    Epoch  3/10: total=1.4709, vae=1.0846, dsb=0.3859, bio=0.0009
    Epoch  4/10: total=1.4671, vae=1.0836, dsb=0.3828, bio=0.0014
    Epoch  5/10: total=1.4592, vae=1.0846, dsb=0.3742, bio=0.0011
    Epoch  6/10: total=1.4626, vae=1.0841, dsb=0.3780, bio=0.0010
    Epoch  7/10: total=1.4560, vae=1.0845, dsb=0.3710, bio=0.0010
    Epoch  8/10: total=1.4550, vae=1.0844, dsb=0.3702, bio=0.0007
    Epoch  9/10: total=1.4493, vae=1.0834, dsb=0.3653, bio=0.0012
    Epoch 10/10: total=1.4496, vae=1.0835, dsb=0.3657, bio=0.0010

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=15.0959, vae=1.0870, dsb=14.0068, bio=0.0045
    Epoch  2/10: total=14.7403, vae=1.0853, dsb=13.6545, bio=0.0011
    Epoch  3/10: total=14.6824, vae=1.0855, dsb=13.5964, bio=0.0010
    Epoch  4/10: total=14.6684, vae=1.0860, dsb=13.5821, bio=0.0005
    Epoch  5/10: total=14.6241, vae=1.0853, dsb=13.5384, bio=0.0008
    Epoch  6/10: total=14.6064, vae=1.0849, dsb=13.5208, bio=0.0013
    Epoch  7/10: total=14.5648, vae=1.0852, dsb=13.4791, bio=0.0010
    Epoch  8/10: total=14.5489, vae=1.0850, dsb=13.4634, bio=0.0010
    Epoch  9/10: total=14.4440, vae=1.0845, dsb=13.3592, bio=0.0006
    Epoch 10/10: total=14.4565, vae=1.0848, dsb=13.3715, bio=0.0005

  [Backward Policy Training]
    Epoch  1/10: total=1.4981, vae=1.0863, dsb=0.3196, bio=0.1843
    Epoch  2/10: total=1.3998, vae=1.0849, dsb=0.3142, bio=0.0013
    Epoch  3/10: total=1.3839, vae=1.0843, dsb=0.2990, bio=0.0010
    Epoch  4/10: total=1.3960, vae=1.0841, dsb=0.3117, bio=0.0004
    Epoch  5/10: total=1.3969, vae=1.0839, dsb=0.3124, bio=0.0011
    Epoch  6/10: total=1.3970, vae=1.0839, dsb=0.3125, bio=0.0011
    Epoch  7/10: total=1.3992, vae=1.0831, dsb=0.3159, bio=0.0005
    Epoch  8/10: total=1.3864, vae=1.0839, dsb=0.3019, bio=0.0011
    Epoch  9/10: total=1.3901, vae=1.0839, dsb=0.3057, bio=0.0010
    Epoch 10/10: total=1.3884, vae=1.0831, dsb=0.3049, bio=0.0009

[Seed 11] Joint training (original) complete; models and history saved.

[Seed 11] Starting joint training (ablation)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=177.7552, vae=2.0243, dsb=175.7309, bio=0.0000
    Epoch  2/10: total=55.8733, vae=1.0806, dsb=54.7928, bio=0.0000
    Epoch  3/10: total=46.9724, vae=1.0797, dsb=45.8927, bio=0.0000
    Epoch  4/10: total=42.8418, vae=1.0790, dsb=41.7628, bio=0.0000
    Epoch  5/10: total=40.2309, vae=1.0783, dsb=39.1525, bio=0.0000
    Epoch  6/10: total=38.7297, vae=1.0779, dsb=37.6519, bio=0.0000
    Epoch  7/10: total=37.3539, vae=1.0770, dsb=36.2770, bio=0.0000
    Epoch  8/10: total=36.3788, vae=1.0778, dsb=35.3011, bio=0.0000
    Epoch  9/10: total=35.6780, vae=1.0773, dsb=34.6008, bio=0.0000
    Epoch 10/10: total=34.9909, vae=1.0769, dsb=33.9139, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=2.9462, vae=1.0772, dsb=1.8690, bio=0.0000
    Epoch  2/10: total=2.4634, vae=1.0772, dsb=1.3862, bio=0.0000
    Epoch  3/10: total=2.2994, vae=1.0771, dsb=1.2223, bio=0.0000
    Epoch  4/10: total=2.2980, vae=1.0777, dsb=1.2203, bio=0.0000
    Epoch  5/10: total=2.2463, vae=1.0775, dsb=1.1687, bio=0.0000
    Epoch  6/10: total=2.2384, vae=1.0772, dsb=1.1612, bio=0.0000
    Epoch  7/10: total=2.2038, vae=1.0781, dsb=1.1257, bio=0.0000
    Epoch  8/10: total=2.2074, vae=1.0774, dsb=1.1300, bio=0.0000
    Epoch  9/10: total=2.1667, vae=1.0773, dsb=1.0894, bio=0.0000
    Epoch 10/10: total=2.1538, vae=1.0777, dsb=1.0761, bio=0.0000

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=33.2663, vae=1.0772, dsb=32.1891, bio=0.0000
    Epoch  2/10: total=27.7768, vae=1.0776, dsb=26.6991, bio=0.0000
    Epoch  3/10: total=26.4201, vae=1.0765, dsb=25.3435, bio=0.0000
    Epoch  4/10: total=25.7299, vae=1.0763, dsb=24.6536, bio=0.0000
    Epoch  5/10: total=25.3425, vae=1.0768, dsb=24.2657, bio=0.0000
    Epoch  6/10: total=24.9346, vae=1.0779, dsb=23.8567, bio=0.0000
    Epoch  7/10: total=24.7443, vae=1.0777, dsb=23.6666, bio=0.0000
    Epoch  8/10: total=24.5565, vae=1.0776, dsb=23.4789, bio=0.0000
    Epoch  9/10: total=24.3572, vae=1.0774, dsb=23.2798, bio=0.0000
    Epoch 10/10: total=24.3027, vae=1.0766, dsb=23.2262, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.9377, vae=1.0764, dsb=0.8613, bio=0.0000
    Epoch  2/10: total=1.8250, vae=1.0770, dsb=0.7480, bio=0.0000
    Epoch  3/10: total=1.7979, vae=1.0771, dsb=0.7207, bio=0.0000
    Epoch  4/10: total=1.7730, vae=1.0769, dsb=0.6961, bio=0.0000
    Epoch  5/10: total=1.7574, vae=1.0764, dsb=0.6810, bio=0.0000
    Epoch  6/10: total=1.7319, vae=1.0775, dsb=0.6544, bio=0.0000
    Epoch  7/10: total=1.7465, vae=1.0773, dsb=0.6693, bio=0.0000
    Epoch  8/10: total=1.7366, vae=1.0771, dsb=0.6595, bio=0.0000
    Epoch  9/10: total=1.7240, vae=1.0769, dsb=0.6471, bio=0.0000
    Epoch 10/10: total=1.7015, vae=1.0772, dsb=0.6243, bio=0.0000

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=22.8351, vae=1.0767, dsb=21.7583, bio=0.0000
    Epoch  2/10: total=20.9602, vae=1.0778, dsb=19.8824, bio=0.0000
    Epoch  3/10: total=20.3720, vae=1.0771, dsb=19.2950, bio=0.0000
    Epoch  4/10: total=20.1886, vae=1.0771, dsb=19.1115, bio=0.0000
    Epoch  5/10: total=19.9292, vae=1.0770, dsb=18.8522, bio=0.0000
    Epoch  6/10: total=19.8296, vae=1.0768, dsb=18.7528, bio=0.0000
    Epoch  7/10: total=19.7103, vae=1.0772, dsb=18.6331, bio=0.0000
    Epoch  8/10: total=19.6367, vae=1.0767, dsb=18.5600, bio=0.0000
    Epoch  9/10: total=19.5694, vae=1.0766, dsb=18.4927, bio=0.0000
    Epoch 10/10: total=19.5974, vae=1.0778, dsb=18.5195, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.6234, vae=1.0770, dsb=0.5463, bio=0.0000
    Epoch  2/10: total=1.5725, vae=1.0763, dsb=0.4961, bio=0.0000
    Epoch  3/10: total=1.5566, vae=1.0763, dsb=0.4803, bio=0.0000
    Epoch  4/10: total=1.5441, vae=1.0771, dsb=0.4670, bio=0.0000
    Epoch  5/10: total=1.5449, vae=1.0775, dsb=0.4674, bio=0.0000
    Epoch  6/10: total=1.5356, vae=1.0773, dsb=0.4583, bio=0.0000
    Epoch  7/10: total=1.5233, vae=1.0777, dsb=0.4456, bio=0.0000
    Epoch  8/10: total=1.5177, vae=1.0770, dsb=0.4407, bio=0.0000
    Epoch  9/10: total=1.5317, vae=1.0765, dsb=0.4552, bio=0.0000
    Epoch 10/10: total=1.5061, vae=1.0759, dsb=0.4301, bio=0.0000

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=18.5190, vae=1.0771, dsb=17.4419, bio=0.0000
    Epoch  2/10: total=17.7038, vae=1.0768, dsb=16.6270, bio=0.0000
    Epoch  3/10: total=17.5049, vae=1.0775, dsb=16.4274, bio=0.0000
    Epoch  4/10: total=17.4945, vae=1.0779, dsb=16.4166, bio=0.0000
    Epoch  5/10: total=17.2888, vae=1.0773, dsb=16.2115, bio=0.0000
    Epoch  6/10: total=17.2337, vae=1.0767, dsb=16.1570, bio=0.0000
    Epoch  7/10: total=17.1709, vae=1.0766, dsb=16.0943, bio=0.0000
    Epoch  8/10: total=17.1635, vae=1.0777, dsb=16.0859, bio=0.0000
    Epoch  9/10: total=17.1300, vae=1.0767, dsb=16.0532, bio=0.0000
    Epoch 10/10: total=17.1267, vae=1.0773, dsb=16.0495, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.4489, vae=1.0769, dsb=0.3720, bio=0.0000
    Epoch  2/10: total=1.4405, vae=1.0770, dsb=0.3635, bio=0.0000
    Epoch  3/10: total=1.4343, vae=1.0769, dsb=0.3574, bio=0.0000
    Epoch  4/10: total=1.4314, vae=1.0763, dsb=0.3551, bio=0.0000
    Epoch  5/10: total=1.4250, vae=1.0774, dsb=0.3476, bio=0.0000
    Epoch  6/10: total=1.4287, vae=1.0770, dsb=0.3517, bio=0.0000
    Epoch  7/10: total=1.4222, vae=1.0773, dsb=0.3448, bio=0.0000
    Epoch  8/10: total=1.4217, vae=1.0773, dsb=0.3444, bio=0.0000
    Epoch  9/10: total=1.4161, vae=1.0765, dsb=0.3396, bio=0.0000
    Epoch 10/10: total=1.4165, vae=1.0766, dsb=0.3399, bio=0.0000

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=15.6845, vae=1.0768, dsb=14.6077, bio=0.0000
    Epoch  2/10: total=15.4281, vae=1.0765, dsb=14.3516, bio=0.0000
    Epoch  3/10: total=15.3951, vae=1.0770, dsb=14.3182, bio=0.0000
    Epoch  4/10: total=15.4096, vae=1.0777, dsb=14.3318, bio=0.0000
    Epoch  5/10: total=15.3611, vae=1.0772, dsb=14.2838, bio=0.0000
    Epoch  6/10: total=15.3373, vae=1.0771, dsb=14.2602, bio=0.0000
    Epoch  7/10: total=15.3147, vae=1.0774, dsb=14.2373, bio=0.0000
    Epoch  8/10: total=15.2987, vae=1.0773, dsb=14.2214, bio=0.0000
    Epoch  9/10: total=15.2017, vae=1.0769, dsb=14.1249, bio=0.0000
    Epoch 10/10: total=15.2154, vae=1.0772, dsb=14.1382, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.3723, vae=1.0772, dsb=0.2951, bio=0.0000
    Epoch  2/10: total=1.3703, vae=1.0773, dsb=0.2930, bio=0.0000
    Epoch  3/10: total=1.3561, vae=1.0769, dsb=0.2791, bio=0.0000
    Epoch  4/10: total=1.3689, vae=1.0770, dsb=0.2918, bio=0.0000
    Epoch  5/10: total=1.3702, vae=1.0770, dsb=0.2931, bio=0.0000
    Epoch  6/10: total=1.3706, vae=1.0771, dsb=0.2935, bio=0.0000
    Epoch  7/10: total=1.3732, vae=1.0763, dsb=0.2969, bio=0.0000
    Epoch  8/10: total=1.3609, vae=1.0773, dsb=0.2836, bio=0.0000
    Epoch  9/10: total=1.3648, vae=1.0774, dsb=0.2875, bio=0.0000
    Epoch 10/10: total=1.3633, vae=1.0764, dsb=0.2868, bio=0.0000

[Seed 11] Joint training (ablation) complete; models and history saved.

[Seed 11] Drift genes saved in /home/yyuan/ICB_TCE/iter_results/run_011

[Seed 11] run finished.

================================================================================
[Seed 12] Starting running whole pipeline...
================================================================================

[Seed 12] Starting VAE pre-training...

    Epoch [01/20], Beta: 0.000, Average Loss: 532.8428
    Epoch [02/20], Beta: 0.000, Average Loss: 305.3292
    Epoch [03/20], Beta: 0.000, Average Loss: 268.9634
    Epoch [04/20], Beta: 0.000, Average Loss: 249.5155
    Epoch [05/20], Beta: 0.100, Average Loss: 244.7918
    Epoch [06/20], Beta: 0.200, Average Loss: 244.4133
    Epoch [07/20], Beta: 0.300, Average Loss: 244.8090
    Epoch [08/20], Beta: 0.400, Average Loss: 245.7285
    Epoch [09/20], Beta: 0.500, Average Loss: 246.8054
    Epoch [10/20], Beta: 0.600, Average Loss: 247.9506
    Epoch [11/20], Beta: 0.700, Average Loss: 249.1834
    Epoch [12/20], Beta: 0.800, Average Loss: 250.4029
    Epoch [13/20], Beta: 0.900, Average Loss: 251.6437
    Epoch [14/20], Beta: 1.000, Average Loss: 253.2541
    Epoch [15/20], Beta: 1.000, Average Loss: 252.7874
    Epoch [16/20], Beta: 1.000, Average Loss: 252.3998
    Epoch [17/20], Beta: 1.000, Average Loss: 252.0611
    Epoch [18/20], Beta: 1.000, Average Loss: 251.6751
    Epoch [19/20], Beta: 1.000, Average Loss: 251.3099
    Epoch [20/20], Beta: 1.000, Average Loss: 251.1518

[Seed 12] VAE pre-training complete.

[Seed 12] Starting joint training (original)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=291.3737, vae=3.5831, dsb=272.9124, bio=29.7564
    Epoch  2/10: total=84.6307, vae=1.0969, dsb=83.4929, bio=0.0819
    Epoch  3/10: total=74.6760, vae=1.0922, dsb=73.5662, bio=0.0352
    Epoch  4/10: total=69.7646, vae=1.0900, dsb=68.6643, bio=0.0207
    Epoch  5/10: total=67.0354, vae=1.0888, dsb=65.9397, bio=0.0138
    Epoch  6/10: total=64.9352, vae=1.0890, dsb=63.8412, bio=0.0100
    Epoch  7/10: total=63.7282, vae=1.0885, dsb=62.6358, bio=0.0079
    Epoch  8/10: total=62.4207, vae=1.0889, dsb=61.3287, bio=0.0062
    Epoch  9/10: total=61.2637, vae=1.0887, dsb=60.1724, bio=0.0053
    Epoch 10/10: total=60.7816, vae=1.0878, dsb=59.6916, bio=0.0046

  [Backward Policy Training]
    Epoch  1/10: total=3.0854, vae=1.0895, dsb=1.9880, bio=0.0156
    Epoch  2/10: total=2.6864, vae=1.0880, dsb=1.5960, bio=0.0048
    Epoch  3/10: total=2.5131, vae=1.0865, dsb=1.4248, bio=0.0034
    Epoch  4/10: total=2.4888, vae=1.0871, dsb=1.4003, bio=0.0028
    Epoch  5/10: total=2.4151, vae=1.0857, dsb=1.3282, bio=0.0024
    Epoch  6/10: total=2.3715, vae=1.0868, dsb=1.2836, bio=0.0022
    Epoch  7/10: total=2.3612, vae=1.0855, dsb=1.2747, bio=0.0020
    Epoch  8/10: total=2.3697, vae=1.0860, dsb=1.2827, bio=0.0019
    Epoch  9/10: total=2.3084, vae=1.0857, dsb=1.2218, bio=0.0020
    Epoch 10/10: total=2.3338, vae=1.0852, dsb=1.2477, bio=0.0017

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=53.1423, vae=1.0889, dsb=52.0518, bio=0.0034
    Epoch  2/10: total=47.7843, vae=1.0870, dsb=46.6964, bio=0.0018
    Epoch  3/10: total=46.4143, vae=1.0866, dsb=45.3269, bio=0.0017
    Epoch  4/10: total=45.6963, vae=1.0871, dsb=44.6083, bio=0.0016
    Epoch  5/10: total=45.1629, vae=1.0860, dsb=44.0761, bio=0.0016
    Epoch  6/10: total=44.6841, vae=1.0864, dsb=43.5968, bio=0.0019
    Epoch  7/10: total=44.4890, vae=1.0858, dsb=43.4024, bio=0.0015
    Epoch  8/10: total=44.2819, vae=1.0864, dsb=43.1947, bio=0.0015
    Epoch  9/10: total=43.7896, vae=1.0858, dsb=42.7031, bio=0.0015
    Epoch 10/10: total=43.8070, vae=1.0857, dsb=42.7206, bio=0.0015

  [Backward Policy Training]
    Epoch  1/10: total=2.0722, vae=1.0874, dsb=0.9780, bio=0.0136
    Epoch  2/10: total=1.9583, vae=1.0854, dsb=0.8720, bio=0.0016
    Epoch  3/10: total=1.9251, vae=1.0849, dsb=0.8395, bio=0.0014
    Epoch  4/10: total=1.9110, vae=1.0847, dsb=0.8256, bio=0.0013
    Epoch  5/10: total=1.8910, vae=1.0845, dsb=0.8059, bio=0.0013
    Epoch  6/10: total=1.8603, vae=1.0842, dsb=0.7755, bio=0.0013
    Epoch  7/10: total=1.8881, vae=1.0841, dsb=0.8034, bio=0.0013
    Epoch  8/10: total=1.8481, vae=1.0848, dsb=0.7627, bio=0.0013
    Epoch  9/10: total=1.8499, vae=1.0844, dsb=0.7647, bio=0.0016
    Epoch 10/10: total=1.8492, vae=1.0842, dsb=0.7643, bio=0.0012

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=41.7652, vae=1.0868, dsb=40.6771, bio=0.0028
    Epoch  2/10: total=39.7279, vae=1.0846, dsb=38.6427, bio=0.0012
    Epoch  3/10: total=39.0266, vae=1.0853, dsb=37.9407, bio=0.0012
    Epoch  4/10: total=38.5759, vae=1.0850, dsb=37.4903, bio=0.0012
    Epoch  5/10: total=38.5761, vae=1.0859, dsb=37.4896, bio=0.0012
    Epoch  6/10: total=38.4082, vae=1.0851, dsb=37.3224, bio=0.0012
    Epoch  7/10: total=38.1724, vae=1.0844, dsb=37.0873, bio=0.0012
    Epoch  8/10: total=38.1146, vae=1.0841, dsb=37.0300, bio=0.0011
    Epoch  9/10: total=37.9510, vae=1.0841, dsb=36.8662, bio=0.0012
    Epoch 10/10: total=37.9865, vae=1.0839, dsb=36.9020, bio=0.0011

  [Backward Policy Training]
    Epoch  1/10: total=1.7672, vae=1.0851, dsb=0.6416, bio=0.0810
    Epoch  2/10: total=1.6660, vae=1.0841, dsb=0.5813, bio=0.0013
    Epoch  3/10: total=1.6429, vae=1.0841, dsb=0.5583, bio=0.0012
    Epoch  4/10: total=1.6267, vae=1.0829, dsb=0.5433, bio=0.0010
    Epoch  5/10: total=1.6258, vae=1.0831, dsb=0.5422, bio=0.0010
    Epoch  6/10: total=1.6313, vae=1.0837, dsb=0.5469, bio=0.0012
    Epoch  7/10: total=1.6155, vae=1.0838, dsb=0.5312, bio=0.0010
    Epoch  8/10: total=1.6184, vae=1.0840, dsb=0.5339, bio=0.0010
    Epoch  9/10: total=1.6012, vae=1.0833, dsb=0.5174, bio=0.0010
    Epoch 10/10: total=1.6007, vae=1.0827, dsb=0.5175, bio=0.0010

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=34.2823, vae=1.0869, dsb=33.1935, bio=0.0038
    Epoch  2/10: total=33.3276, vae=1.0842, dsb=32.2429, bio=0.0010
    Epoch  3/10: total=32.9851, vae=1.0845, dsb=31.9001, bio=0.0010
    Epoch  4/10: total=32.9060, vae=1.0846, dsb=31.8209, bio=0.0011
    Epoch  5/10: total=32.8360, vae=1.0848, dsb=31.7507, bio=0.0010
    Epoch  6/10: total=32.8061, vae=1.0830, dsb=31.7226, bio=0.0010
    Epoch  7/10: total=32.6962, vae=1.0843, dsb=31.6116, bio=0.0004
    Epoch  8/10: total=32.8578, vae=1.0849, dsb=31.7723, bio=0.0011
    Epoch  9/10: total=32.6201, vae=1.0842, dsb=31.5354, bio=0.0011
    Epoch 10/10: total=32.6341, vae=1.0842, dsb=31.5494, bio=0.0010

  [Backward Policy Training]
    Epoch  1/10: total=1.6058, vae=1.0855, dsb=0.4617, bio=0.1172
    Epoch  2/10: total=1.5104, vae=1.0843, dsb=0.4258, bio=0.0006
    Epoch  3/10: total=1.5182, vae=1.0829, dsb=0.4351, bio=0.0004
    Epoch  4/10: total=1.5071, vae=1.0835, dsb=0.4230, bio=0.0011
    Epoch  5/10: total=1.5225, vae=1.0833, dsb=0.4387, bio=0.0010
    Epoch  6/10: total=1.4968, vae=1.0836, dsb=0.4127, bio=0.0010
    Epoch  7/10: total=1.4917, vae=1.0826, dsb=0.4087, bio=0.0007
    Epoch  8/10: total=1.5063, vae=1.0827, dsb=0.4234, bio=0.0006
    Epoch  9/10: total=1.5007, vae=1.0831, dsb=0.4172, bio=0.0009
    Epoch 10/10: total=1.4950, vae=1.0825, dsb=0.4119, bio=0.0010

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=27.9594, vae=1.0862, dsb=26.8708, bio=0.0048
    Epoch  2/10: total=27.4960, vae=1.0842, dsb=26.4113, bio=0.0010
    Epoch  3/10: total=27.4627, vae=1.0844, dsb=26.3778, bio=0.0008
    Epoch  4/10: total=27.5576, vae=1.0842, dsb=26.4731, bio=0.0004
    Epoch  5/10: total=27.4508, vae=1.0834, dsb=26.3671, bio=0.0005
    Epoch  6/10: total=27.4925, vae=1.0834, dsb=26.4085, bio=0.0013
    Epoch  7/10: total=27.3189, vae=1.0834, dsb=26.2350, bio=0.0010
    Epoch  8/10: total=27.5369, vae=1.0830, dsb=26.4538, bio=0.0004
    Epoch  9/10: total=27.4766, vae=1.0834, dsb=26.3930, bio=0.0004
    Epoch 10/10: total=27.4360, vae=1.0836, dsb=26.3520, bio=0.0007

  [Backward Policy Training]
    Epoch  1/10: total=1.5652, vae=1.0844, dsb=0.3693, bio=0.2232
    Epoch  2/10: total=1.4361, vae=1.0831, dsb=0.3524, bio=0.0012
    Epoch  3/10: total=1.4386, vae=1.0831, dsb=0.3550, bio=0.0011
    Epoch  4/10: total=1.4324, vae=1.0831, dsb=0.3490, bio=0.0006
    Epoch  5/10: total=1.4278, vae=1.0829, dsb=0.3446, bio=0.0007
    Epoch  6/10: total=1.4409, vae=1.0817, dsb=0.3587, bio=0.0011
    Epoch  7/10: total=1.4321, vae=1.0823, dsb=0.3493, bio=0.0009
    Epoch  8/10: total=1.4259, vae=1.0826, dsb=0.3430, bio=0.0005
    Epoch  9/10: total=1.4284, vae=1.0827, dsb=0.3454, bio=0.0007
    Epoch 10/10: total=1.4322, vae=1.0825, dsb=0.3493, bio=0.0009

[Seed 12] Joint training (original) complete; models and history saved.

[Seed 12] Starting joint training (ablation)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=274.4098, vae=2.0121, dsb=272.3977, bio=0.0000
    Epoch  2/10: total=84.2034, vae=1.0799, dsb=83.1234, bio=0.0000
    Epoch  3/10: total=74.0285, vae=1.0782, dsb=72.9503, bio=0.0000
    Epoch  4/10: total=69.1833, vae=1.0768, dsb=68.1065, bio=0.0000
    Epoch  5/10: total=66.6126, vae=1.0759, dsb=65.5367, bio=0.0000
    Epoch  6/10: total=64.5875, vae=1.0764, dsb=63.5111, bio=0.0000
    Epoch  7/10: total=63.4139, vae=1.0761, dsb=62.3378, bio=0.0000
    Epoch  8/10: total=62.1088, vae=1.0769, dsb=61.0319, bio=0.0000
    Epoch  9/10: total=60.9412, vae=1.0769, dsb=59.8643, bio=0.0000
    Epoch 10/10: total=60.4958, vae=1.0762, dsb=59.4196, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=3.0020, vae=1.0765, dsb=1.9254, bio=0.0000
    Epoch  2/10: total=2.6256, vae=1.0769, dsb=1.5487, bio=0.0000
    Epoch  3/10: total=2.4543, vae=1.0759, dsb=1.3784, bio=0.0000
    Epoch  4/10: total=2.4306, vae=1.0768, dsb=1.3538, bio=0.0000
    Epoch  5/10: total=2.3609, vae=1.0756, dsb=1.2852, bio=0.0000
    Epoch  6/10: total=2.3191, vae=1.0769, dsb=1.2422, bio=0.0000
    Epoch  7/10: total=2.3114, vae=1.0757, dsb=1.2357, bio=0.0000
    Epoch  8/10: total=2.3198, vae=1.0764, dsb=1.2434, bio=0.0000
    Epoch  9/10: total=2.2608, vae=1.0761, dsb=1.1848, bio=0.0000
    Epoch 10/10: total=2.2871, vae=1.0759, dsb=1.2112, bio=0.0000

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=53.8905, vae=1.0768, dsb=52.8137, bio=0.0000
    Epoch  2/10: total=48.4068, vae=1.0761, dsb=47.3307, bio=0.0000
    Epoch  3/10: total=46.9921, vae=1.0759, dsb=45.9162, bio=0.0000
    Epoch  4/10: total=46.2683, vae=1.0767, dsb=45.1916, bio=0.0000
    Epoch  5/10: total=45.7446, vae=1.0757, dsb=44.6689, bio=0.0000
    Epoch  6/10: total=45.2638, vae=1.0762, dsb=44.1876, bio=0.0000
    Epoch  7/10: total=45.0716, vae=1.0757, dsb=43.9959, bio=0.0000
    Epoch  8/10: total=44.8587, vae=1.0765, dsb=43.7822, bio=0.0000
    Epoch  9/10: total=44.4019, vae=1.0761, dsb=43.3258, bio=0.0000
    Epoch 10/10: total=44.4400, vae=1.0761, dsb=43.3639, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=2.0218, vae=1.0772, dsb=0.9446, bio=0.0000
    Epoch  2/10: total=1.9219, vae=1.0764, dsb=0.8454, bio=0.0000
    Epoch  3/10: total=1.8920, vae=1.0761, dsb=0.8160, bio=0.0000
    Epoch  4/10: total=1.8792, vae=1.0760, dsb=0.8032, bio=0.0000
    Epoch  5/10: total=1.8596, vae=1.0758, dsb=0.7837, bio=0.0000
    Epoch  6/10: total=1.8298, vae=1.0757, dsb=0.7541, bio=0.0000
    Epoch  7/10: total=1.8577, vae=1.0756, dsb=0.7821, bio=0.0000
    Epoch  8/10: total=1.8181, vae=1.0764, dsb=0.7417, bio=0.0000
    Epoch  9/10: total=1.8196, vae=1.0760, dsb=0.7436, bio=0.0000
    Epoch 10/10: total=1.8189, vae=1.0760, dsb=0.7429, bio=0.0000

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=40.7681, vae=1.0756, dsb=39.6925, bio=0.0000
    Epoch  2/10: total=38.6479, vae=1.0751, dsb=37.5728, bio=0.0000
    Epoch  3/10: total=38.0192, vae=1.0760, dsb=36.9432, bio=0.0000
    Epoch  4/10: total=37.5594, vae=1.0758, dsb=36.4836, bio=0.0000
    Epoch  5/10: total=37.5917, vae=1.0769, dsb=36.5148, bio=0.0000
    Epoch  6/10: total=37.4390, vae=1.0763, dsb=36.3627, bio=0.0000
    Epoch  7/10: total=37.1911, vae=1.0757, dsb=36.1154, bio=0.0000
    Epoch  8/10: total=37.1411, vae=1.0755, dsb=36.0656, bio=0.0000
    Epoch  9/10: total=36.9844, vae=1.0757, dsb=35.9088, bio=0.0000
    Epoch 10/10: total=37.0325, vae=1.0756, dsb=35.9569, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.6856, vae=1.0758, dsb=0.6099, bio=0.0000
    Epoch  2/10: total=1.6289, vae=1.0758, dsb=0.5531, bio=0.0000
    Epoch  3/10: total=1.6075, vae=1.0760, dsb=0.5315, bio=0.0000
    Epoch  4/10: total=1.5926, vae=1.0749, dsb=0.5176, bio=0.0000
    Epoch  5/10: total=1.5918, vae=1.0753, dsb=0.5164, bio=0.0000
    Epoch  6/10: total=1.5974, vae=1.0760, dsb=0.5214, bio=0.0000
    Epoch  7/10: total=1.5828, vae=1.0762, dsb=0.5066, bio=0.0000
    Epoch  8/10: total=1.5860, vae=1.0764, dsb=0.5096, bio=0.0000
    Epoch  9/10: total=1.5699, vae=1.0759, dsb=0.4940, bio=0.0000
    Epoch 10/10: total=1.5693, vae=1.0753, dsb=0.4940, bio=0.0000

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=33.3865, vae=1.0767, dsb=32.3098, bio=0.0000
    Epoch  2/10: total=32.5093, vae=1.0752, dsb=31.4341, bio=0.0000
    Epoch  3/10: total=32.2141, vae=1.0757, dsb=31.1384, bio=0.0000
    Epoch  4/10: total=32.1462, vae=1.0760, dsb=31.0702, bio=0.0000
    Epoch  5/10: total=32.0864, vae=1.0764, dsb=31.0099, bio=0.0000
    Epoch  6/10: total=32.0589, vae=1.0747, dsb=30.9842, bio=0.0000
    Epoch  7/10: total=31.9735, vae=1.0761, dsb=30.8973, bio=0.0000
    Epoch  8/10: total=32.1175, vae=1.0770, dsb=31.0406, bio=0.0000
    Epoch  9/10: total=31.8909, vae=1.0763, dsb=30.8146, bio=0.0000
    Epoch 10/10: total=31.9052, vae=1.0763, dsb=30.8289, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.5148, vae=1.0765, dsb=0.4383, bio=0.0000
    Epoch  2/10: total=1.4818, vae=1.0764, dsb=0.4054, bio=0.0000
    Epoch  3/10: total=1.4902, vae=1.0752, dsb=0.4151, bio=0.0000
    Epoch  4/10: total=1.4795, vae=1.0759, dsb=0.4036, bio=0.0000
    Epoch  5/10: total=1.4952, vae=1.0758, dsb=0.4194, bio=0.0000
    Epoch  6/10: total=1.4703, vae=1.0762, dsb=0.3941, bio=0.0000
    Epoch  7/10: total=1.4653, vae=1.0753, dsb=0.3901, bio=0.0000
    Epoch  8/10: total=1.4802, vae=1.0755, dsb=0.4047, bio=0.0000
    Epoch  9/10: total=1.4751, vae=1.0761, dsb=0.3989, bio=0.0000
    Epoch 10/10: total=1.4691, vae=1.0757, dsb=0.3935, bio=0.0000

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=27.3157, vae=1.0761, dsb=26.2396, bio=0.0000
    Epoch  2/10: total=26.9203, vae=1.0755, dsb=25.8448, bio=0.0000
    Epoch  3/10: total=26.8986, vae=1.0760, dsb=25.8226, bio=0.0000
    Epoch  4/10: total=26.9905, vae=1.0761, dsb=25.9144, bio=0.0000
    Epoch  5/10: total=26.8779, vae=1.0755, dsb=25.8024, bio=0.0000
    Epoch  6/10: total=26.9360, vae=1.0757, dsb=25.8603, bio=0.0000
    Epoch  7/10: total=26.7775, vae=1.0757, dsb=25.7017, bio=0.0000
    Epoch  8/10: total=27.0003, vae=1.0753, dsb=25.9249, bio=0.0000
    Epoch  9/10: total=26.9409, vae=1.0758, dsb=25.8651, bio=0.0000
    Epoch 10/10: total=26.8998, vae=1.0762, dsb=25.8237, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.4255, vae=1.0753, dsb=0.3502, bio=0.0000
    Epoch  2/10: total=1.4109, vae=1.0756, dsb=0.3353, bio=0.0000
    Epoch  3/10: total=1.4139, vae=1.0757, dsb=0.3382, bio=0.0000
    Epoch  4/10: total=1.4083, vae=1.0759, dsb=0.3325, bio=0.0000
    Epoch  5/10: total=1.4044, vae=1.0759, dsb=0.3285, bio=0.0000
    Epoch  6/10: total=1.4169, vae=1.0750, dsb=0.3419, bio=0.0000
    Epoch  7/10: total=1.4085, vae=1.0755, dsb=0.3329, bio=0.0000
    Epoch  8/10: total=1.4027, vae=1.0758, dsb=0.3269, bio=0.0000
    Epoch  9/10: total=1.4053, vae=1.0760, dsb=0.3293, bio=0.0000
    Epoch 10/10: total=1.4089, vae=1.0759, dsb=0.3330, bio=0.0000

[Seed 12] Joint training (ablation) complete; models and history saved.

[Seed 12] Drift genes saved in /home/yyuan/ICB_TCE/iter_results/run_012

[Seed 12] run finished.

================================================================================
[Seed 13] Starting running whole pipeline...
================================================================================

[Seed 13] Starting VAE pre-training...

    Epoch [01/20], Beta: 0.000, Average Loss: 537.2317
    Epoch [02/20], Beta: 0.000, Average Loss: 309.3703
    Epoch [03/20], Beta: 0.000, Average Loss: 273.0662
    Epoch [04/20], Beta: 0.000, Average Loss: 253.0405
    Epoch [05/20], Beta: 0.100, Average Loss: 247.0360
    Epoch [06/20], Beta: 0.200, Average Loss: 245.0930
    Epoch [07/20], Beta: 0.300, Average Loss: 245.0341
    Epoch [08/20], Beta: 0.400, Average Loss: 245.9482
    Epoch [09/20], Beta: 0.500, Average Loss: 247.0235
    Epoch [10/20], Beta: 0.600, Average Loss: 248.1272
    Epoch [11/20], Beta: 0.700, Average Loss: 249.2939
    Epoch [12/20], Beta: 0.800, Average Loss: 250.5475
    Epoch [13/20], Beta: 0.900, Average Loss: 251.7563
    Epoch [14/20], Beta: 1.000, Average Loss: 252.9210
    Epoch [15/20], Beta: 1.000, Average Loss: 252.4914
    Epoch [16/20], Beta: 1.000, Average Loss: 252.1182
    Epoch [17/20], Beta: 1.000, Average Loss: 251.8266
    Epoch [18/20], Beta: 1.000, Average Loss: 251.4451
    Epoch [19/20], Beta: 1.000, Average Loss: 251.1765
    Epoch [20/20], Beta: 1.000, Average Loss: 250.8398

[Seed 13] VAE pre-training complete.

[Seed 13] Starting joint training (original)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=289.9102, vae=3.5019, dsb=268.2331, bio=36.3504
    Epoch  2/10: total=72.0440, vae=1.0942, dsb=70.9082, bio=0.0832
    Epoch  3/10: total=62.4845, vae=1.0885, dsb=61.3777, bio=0.0366
    Epoch  4/10: total=58.0887, vae=1.0880, dsb=56.9897, bio=0.0220
    Epoch  5/10: total=55.3113, vae=1.0865, dsb=54.2173, bio=0.0149
    Epoch  6/10: total=53.1480, vae=1.0860, dsb=52.0566, bio=0.0108
    Epoch  7/10: total=51.6276, vae=1.0858, dsb=50.5376, bio=0.0085
    Epoch  8/10: total=50.6425, vae=1.0855, dsb=49.5536, bio=0.0068
    Epoch  9/10: total=49.6368, vae=1.0850, dsb=48.5489, bio=0.0058
    Epoch 10/10: total=48.9300, vae=1.0857, dsb=47.8419, bio=0.0048

  [Backward Policy Training]
    Epoch  1/10: total=2.9962, vae=1.0862, dsb=1.9028, bio=0.0144
    Epoch  2/10: total=2.4964, vae=1.0848, dsb=1.4089, bio=0.0053
    Epoch  3/10: total=2.4290, vae=1.0832, dsb=1.3440, bio=0.0037
    Epoch  4/10: total=2.3607, vae=1.0836, dsb=1.2756, bio=0.0030
    Epoch  5/10: total=2.2919, vae=1.0837, dsb=1.2068, bio=0.0030
    Epoch  6/10: total=2.2172, vae=1.0826, dsb=1.1333, bio=0.0026
    Epoch  7/10: total=2.2493, vae=1.0826, dsb=1.1656, bio=0.0022
    Epoch  8/10: total=2.2024, vae=1.0830, dsb=1.1184, bio=0.0020
    Epoch  9/10: total=2.2261, vae=1.0830, dsb=1.1421, bio=0.0020
    Epoch 10/10: total=2.1818, vae=1.0826, dsb=1.0983, bio=0.0019

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=44.3751, vae=1.0845, dsb=43.2889, bio=0.0033
    Epoch  2/10: total=38.5121, vae=1.0841, dsb=37.4271, bio=0.0018
    Epoch  3/10: total=36.7757, vae=1.0837, dsb=35.6912, bio=0.0017
    Epoch  4/10: total=36.0426, vae=1.0836, dsb=34.9582, bio=0.0017
    Epoch  5/10: total=35.5981, vae=1.0828, dsb=34.5145, bio=0.0017
    Epoch  6/10: total=35.0618, vae=1.0827, dsb=33.9783, bio=0.0017
    Epoch  7/10: total=34.7557, vae=1.0834, dsb=33.6714, bio=0.0019
    Epoch  8/10: total=34.6839, vae=1.0832, dsb=33.5999, bio=0.0016
    Epoch  9/10: total=34.2950, vae=1.0827, dsb=33.2115, bio=0.0017
    Epoch 10/10: total=34.1345, vae=1.0824, dsb=33.0513, bio=0.0017

  [Backward Policy Training]
    Epoch  1/10: total=1.9875, vae=1.0830, dsb=0.9011, bio=0.0068
    Epoch  2/10: total=1.8941, vae=1.0829, dsb=0.8103, bio=0.0018
    Epoch  3/10: total=1.8622, vae=1.0824, dsb=0.7791, bio=0.0015
    Epoch  4/10: total=1.8309, vae=1.0817, dsb=0.7483, bio=0.0018
    Epoch  5/10: total=1.8162, vae=1.0813, dsb=0.7341, bio=0.0015
    Epoch  6/10: total=1.8077, vae=1.0817, dsb=0.7253, bio=0.0015
    Epoch  7/10: total=1.7846, vae=1.0813, dsb=0.7025, bio=0.0015
    Epoch  8/10: total=1.7852, vae=1.0821, dsb=0.7023, bio=0.0014
    Epoch  9/10: total=1.7840, vae=1.0812, dsb=0.7021, bio=0.0014
    Epoch 10/10: total=1.7632, vae=1.0815, dsb=0.6810, bio=0.0015

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=31.4268, vae=1.0830, dsb=30.3425, bio=0.0026
    Epoch  2/10: total=28.8639, vae=1.0832, dsb=27.7800, bio=0.0015
    Epoch  3/10: total=28.4248, vae=1.0812, dsb=27.3429, bio=0.0015
    Epoch  4/10: total=28.0749, vae=1.0820, dsb=26.9922, bio=0.0015
    Epoch  5/10: total=27.7608, vae=1.0829, dsb=26.6773, bio=0.0014
    Epoch  6/10: total=27.7928, vae=1.0821, dsb=26.7099, bio=0.0016
    Epoch  7/10: total=27.6790, vae=1.0822, dsb=26.5962, bio=0.0012
    Epoch  8/10: total=27.5876, vae=1.0817, dsb=26.5051, bio=0.0015
    Epoch  9/10: total=27.4374, vae=1.0820, dsb=26.3548, bio=0.0014
    Epoch 10/10: total=27.2875, vae=1.0821, dsb=26.2047, bio=0.0014

  [Backward Policy Training]
    Epoch  1/10: total=1.7066, vae=1.0820, dsb=0.5996, bio=0.0500
    Epoch  2/10: total=1.6428, vae=1.0811, dsb=0.5609, bio=0.0015
    Epoch  3/10: total=1.6198, vae=1.0804, dsb=0.5387, bio=0.0013
    Epoch  4/10: total=1.6026, vae=1.0803, dsb=0.5215, bio=0.0015
    Epoch  5/10: total=1.6073, vae=1.0807, dsb=0.5260, bio=0.0012
    Epoch  6/10: total=1.6003, vae=1.0809, dsb=0.5188, bio=0.0012
    Epoch  7/10: total=1.5818, vae=1.0802, dsb=0.5009, bio=0.0012
    Epoch  8/10: total=1.5740, vae=1.0804, dsb=0.4930, bio=0.0012
    Epoch  9/10: total=1.5781, vae=1.0806, dsb=0.4969, bio=0.0012
    Epoch 10/10: total=1.5825, vae=1.0805, dsb=0.5014, bio=0.0011

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=25.0712, vae=1.0836, dsb=23.9859, bio=0.0032
    Epoch  2/10: total=24.0414, vae=1.0818, dsb=22.9589, bio=0.0012
    Epoch  3/10: total=23.8921, vae=1.0814, dsb=22.8100, bio=0.0012
    Epoch  4/10: total=23.6652, vae=1.0810, dsb=22.5836, bio=0.0012
    Epoch  5/10: total=23.6650, vae=1.0816, dsb=22.5828, bio=0.0012
    Epoch  6/10: total=23.5768, vae=1.0811, dsb=22.4951, bio=0.0011
    Epoch  7/10: total=23.6185, vae=1.0813, dsb=22.5366, bio=0.0011
    Epoch  8/10: total=23.5504, vae=1.0812, dsb=22.4686, bio=0.0011
    Epoch  9/10: total=23.5082, vae=1.0807, dsb=22.4270, bio=0.0011
    Epoch 10/10: total=23.5237, vae=1.0815, dsb=22.4416, bio=0.0011

  [Backward Policy Training]
    Epoch  1/10: total=1.5447, vae=1.0820, dsb=0.4258, bio=0.0736
    Epoch  2/10: total=1.4826, vae=1.0806, dsb=0.4016, bio=0.0010
    Epoch  3/10: total=1.4849, vae=1.0805, dsb=0.4039, bio=0.0011
    Epoch  4/10: total=1.4739, vae=1.0796, dsb=0.3937, bio=0.0011
    Epoch  5/10: total=1.4800, vae=1.0804, dsb=0.3991, bio=0.0011
    Epoch  6/10: total=1.4713, vae=1.0800, dsb=0.3907, bio=0.0010
    Epoch  7/10: total=1.4641, vae=1.0810, dsb=0.3825, bio=0.0010
    Epoch  8/10: total=1.4670, vae=1.0803, dsb=0.3862, bio=0.0010
    Epoch  9/10: total=1.4694, vae=1.0804, dsb=0.3886, bio=0.0010
    Epoch 10/10: total=1.4583, vae=1.0798, dsb=0.3780, bio=0.0010

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=21.8250, vae=1.0826, dsb=20.7396, bio=0.0058
    Epoch  2/10: total=21.3999, vae=1.0818, dsb=20.3176, bio=0.0011
    Epoch  3/10: total=21.3061, vae=1.0818, dsb=20.2238, bio=0.0008
    Epoch  4/10: total=21.3079, vae=1.0809, dsb=20.2264, bio=0.0012
    Epoch  5/10: total=21.0077, vae=1.0809, dsb=19.9263, bio=0.0011
    Epoch  6/10: total=21.2990, vae=1.0811, dsb=20.2174, bio=0.0011
    Epoch  7/10: total=21.1640, vae=1.0817, dsb=20.0817, bio=0.0010
    Epoch  8/10: total=21.2841, vae=1.0817, dsb=20.2021, bio=0.0004
    Epoch  9/10: total=21.1898, vae=1.0812, dsb=20.1081, bio=0.0010
    Epoch 10/10: total=21.2520, vae=1.0808, dsb=20.1709, bio=0.0006

  [Backward Policy Training]
    Epoch  1/10: total=1.4814, vae=1.0822, dsb=0.3341, bio=0.1302
    Epoch  2/10: total=1.4056, vae=1.0805, dsb=0.3245, bio=0.0012
    Epoch  3/10: total=1.4032, vae=1.0810, dsb=0.3217, bio=0.0009
    Epoch  4/10: total=1.4004, vae=1.0803, dsb=0.3199, bio=0.0004
    Epoch  5/10: total=1.3963, vae=1.0806, dsb=0.3153, bio=0.0007
    Epoch  6/10: total=1.3974, vae=1.0789, dsb=0.3179, bio=0.0011
    Epoch  7/10: total=1.3916, vae=1.0796, dsb=0.3116, bio=0.0009
    Epoch  8/10: total=1.4043, vae=1.0800, dsb=0.3239, bio=0.0007
    Epoch  9/10: total=1.3910, vae=1.0799, dsb=0.3105, bio=0.0010
    Epoch 10/10: total=1.4016, vae=1.0794, dsb=0.3218, bio=0.0009

[Seed 13] Joint training (original) complete; models and history saved.

[Seed 13] Starting joint training (ablation)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=269.9755, vae=2.0035, dsb=267.9721, bio=0.0000
    Epoch  2/10: total=71.7311, vae=1.0777, dsb=70.6534, bio=0.0000
    Epoch  3/10: total=62.0725, vae=1.0748, dsb=60.9977, bio=0.0000
    Epoch  4/10: total=57.4917, vae=1.0751, dsb=56.4166, bio=0.0000
    Epoch  5/10: total=54.6881, vae=1.0740, dsb=53.6141, bio=0.0000
    Epoch  6/10: total=52.5498, vae=1.0737, dsb=51.4760, bio=0.0000
    Epoch  7/10: total=51.0837, vae=1.0737, dsb=50.0100, bio=0.0000
    Epoch  8/10: total=50.1649, vae=1.0736, dsb=49.0913, bio=0.0000
    Epoch  9/10: total=49.2199, vae=1.0733, dsb=48.1466, bio=0.0000
    Epoch 10/10: total=48.5520, vae=1.0743, dsb=47.4777, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=2.9251, vae=1.0732, dsb=1.8519, bio=0.0000
    Epoch  2/10: total=2.4550, vae=1.0739, dsb=1.3811, bio=0.0000
    Epoch  3/10: total=2.3898, vae=1.0727, dsb=1.3170, bio=0.0000
    Epoch  4/10: total=2.3240, vae=1.0734, dsb=1.2506, bio=0.0000
    Epoch  5/10: total=2.2567, vae=1.0736, dsb=1.1831, bio=0.0000
    Epoch  6/10: total=2.1830, vae=1.0728, dsb=1.1103, bio=0.0000
    Epoch  7/10: total=2.2152, vae=1.0729, dsb=1.1423, bio=0.0000
    Epoch  8/10: total=2.1688, vae=1.0734, dsb=1.0953, bio=0.0000
    Epoch  9/10: total=2.1918, vae=1.0736, dsb=1.1182, bio=0.0000
    Epoch 10/10: total=2.1476, vae=1.0733, dsb=1.0743, bio=0.0000

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=43.9307, vae=1.0726, dsb=42.8581, bio=0.0000
    Epoch  2/10: total=38.0154, vae=1.0732, dsb=36.9422, bio=0.0000
    Epoch  3/10: total=36.3738, vae=1.0732, dsb=35.3005, bio=0.0000
    Epoch  4/10: total=35.6854, vae=1.0732, dsb=34.6121, bio=0.0000
    Epoch  5/10: total=35.2616, vae=1.0725, dsb=34.1891, bio=0.0000
    Epoch  6/10: total=34.7428, vae=1.0726, dsb=33.6702, bio=0.0000
    Epoch  7/10: total=34.4464, vae=1.0733, dsb=33.3731, bio=0.0000
    Epoch  8/10: total=34.3820, vae=1.0732, dsb=33.3088, bio=0.0000
    Epoch  9/10: total=34.0239, vae=1.0729, dsb=32.9510, bio=0.0000
    Epoch 10/10: total=33.8628, vae=1.0727, dsb=32.7902, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.9504, vae=1.0728, dsb=0.8776, bio=0.0000
    Epoch  2/10: total=1.8618, vae=1.0739, dsb=0.7878, bio=0.0000
    Epoch  3/10: total=1.8290, vae=1.0735, dsb=0.7556, bio=0.0000
    Epoch  4/10: total=1.7982, vae=1.0729, dsb=0.7252, bio=0.0000
    Epoch  5/10: total=1.7828, vae=1.0727, dsb=0.7101, bio=0.0000
    Epoch  6/10: total=1.7735, vae=1.0731, dsb=0.7004, bio=0.0000
    Epoch  7/10: total=1.7513, vae=1.0728, dsb=0.6785, bio=0.0000
    Epoch  8/10: total=1.7515, vae=1.0737, dsb=0.6778, bio=0.0000
    Epoch  9/10: total=1.7509, vae=1.0728, dsb=0.6780, bio=0.0000
    Epoch 10/10: total=1.7299, vae=1.0731, dsb=0.6568, bio=0.0000

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=31.3495, vae=1.0721, dsb=30.2773, bio=0.0000
    Epoch  2/10: total=28.9777, vae=1.0736, dsb=27.9042, bio=0.0000
    Epoch  3/10: total=28.5917, vae=1.0717, dsb=27.5200, bio=0.0000
    Epoch  4/10: total=28.2327, vae=1.0727, dsb=27.1600, bio=0.0000
    Epoch  5/10: total=27.9011, vae=1.0736, dsb=26.8274, bio=0.0000
    Epoch  6/10: total=27.9570, vae=1.0729, dsb=26.8842, bio=0.0000
    Epoch  7/10: total=27.8678, vae=1.0732, dsb=26.7947, bio=0.0000
    Epoch  8/10: total=27.7649, vae=1.0729, dsb=26.6920, bio=0.0000
    Epoch  9/10: total=27.6172, vae=1.0731, dsb=26.5440, bio=0.0000
    Epoch 10/10: total=27.4857, vae=1.0734, dsb=26.4123, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.6515, vae=1.0725, dsb=0.5790, bio=0.0000
    Epoch  2/10: total=1.6135, vae=1.0729, dsb=0.5405, bio=0.0000
    Epoch  3/10: total=1.5921, vae=1.0722, dsb=0.5199, bio=0.0000
    Epoch  4/10: total=1.5760, vae=1.0723, dsb=0.5036, bio=0.0000
    Epoch  5/10: total=1.5819, vae=1.0727, dsb=0.5092, bio=0.0000
    Epoch  6/10: total=1.5755, vae=1.0730, dsb=0.5026, bio=0.0000
    Epoch  7/10: total=1.5576, vae=1.0725, dsb=0.4851, bio=0.0000
    Epoch  8/10: total=1.5505, vae=1.0726, dsb=0.4779, bio=0.0000
    Epoch  9/10: total=1.5554, vae=1.0729, dsb=0.4825, bio=0.0000
    Epoch 10/10: total=1.5595, vae=1.0729, dsb=0.4866, bio=0.0000

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=25.8331, vae=1.0731, dsb=24.7600, bio=0.0000
    Epoch  2/10: total=24.8717, vae=1.0726, dsb=23.7991, bio=0.0000
    Epoch  3/10: total=24.7676, vae=1.0724, dsb=23.6953, bio=0.0000
    Epoch  4/10: total=24.5605, vae=1.0720, dsb=23.4885, bio=0.0000
    Epoch  5/10: total=24.5799, vae=1.0729, dsb=23.5071, bio=0.0000
    Epoch  6/10: total=24.5076, vae=1.0725, dsb=23.4350, bio=0.0000
    Epoch  7/10: total=24.5653, vae=1.0730, dsb=23.4923, bio=0.0000
    Epoch  8/10: total=24.4799, vae=1.0729, dsb=23.4070, bio=0.0000
    Epoch  9/10: total=24.4592, vae=1.0724, dsb=23.3868, bio=0.0000
    Epoch 10/10: total=24.4823, vae=1.0734, dsb=23.4090, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.4801, vae=1.0730, dsb=0.4071, bio=0.0000
    Epoch  2/10: total=1.4595, vae=1.0727, dsb=0.3868, bio=0.0000
    Epoch  3/10: total=1.4635, vae=1.0730, dsb=0.3905, bio=0.0000
    Epoch  4/10: total=1.4537, vae=1.0723, dsb=0.3814, bio=0.0000
    Epoch  5/10: total=1.4609, vae=1.0731, dsb=0.3879, bio=0.0000
    Epoch  6/10: total=1.4524, vae=1.0728, dsb=0.3796, bio=0.0000
    Epoch  7/10: total=1.4454, vae=1.0738, dsb=0.3716, bio=0.0000
    Epoch  8/10: total=1.4492, vae=1.0734, dsb=0.3758, bio=0.0000
    Epoch  9/10: total=1.4516, vae=1.0734, dsb=0.3782, bio=0.0000
    Epoch 10/10: total=1.4409, vae=1.0729, dsb=0.3681, bio=0.0000

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=22.5543, vae=1.0724, dsb=21.4819, bio=0.0000
    Epoch  2/10: total=22.2254, vae=1.0728, dsb=21.1526, bio=0.0000
    Epoch  3/10: total=22.1162, vae=1.0731, dsb=21.0432, bio=0.0000
    Epoch  4/10: total=22.1775, vae=1.0724, dsb=21.1050, bio=0.0000
    Epoch  5/10: total=21.8272, vae=1.0725, dsb=20.7547, bio=0.0000
    Epoch  6/10: total=22.1583, vae=1.0729, dsb=21.0854, bio=0.0000
    Epoch  7/10: total=22.0368, vae=1.0737, dsb=20.9631, bio=0.0000
    Epoch  8/10: total=22.1485, vae=1.0737, dsb=21.0748, bio=0.0000
    Epoch  9/10: total=22.0705, vae=1.0734, dsb=20.9971, bio=0.0000
    Epoch 10/10: total=22.1201, vae=1.0730, dsb=21.0470, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.4014, vae=1.0732, dsb=0.3282, bio=0.0000
    Epoch  2/10: total=1.3926, vae=1.0727, dsb=0.3199, bio=0.0000
    Epoch  3/10: total=1.3907, vae=1.0735, dsb=0.3172, bio=0.0000
    Epoch  4/10: total=1.3885, vae=1.0730, dsb=0.3155, bio=0.0000
    Epoch  5/10: total=1.3844, vae=1.0735, dsb=0.3109, bio=0.0000
    Epoch  6/10: total=1.3860, vae=1.0719, dsb=0.3140, bio=0.0000
    Epoch  7/10: total=1.3802, vae=1.0726, dsb=0.3077, bio=0.0000
    Epoch  8/10: total=1.3932, vae=1.0730, dsb=0.3202, bio=0.0000
    Epoch  9/10: total=1.3798, vae=1.0731, dsb=0.3067, bio=0.0000
    Epoch 10/10: total=1.3910, vae=1.0726, dsb=0.3184, bio=0.0000

[Seed 13] Joint training (ablation) complete; models and history saved.

[Seed 13] Drift genes saved in /home/yyuan/ICB_TCE/iter_results/run_013

[Seed 13] run finished.

================================================================================
[Seed 14] Starting running whole pipeline...
================================================================================

[Seed 14] Starting VAE pre-training...

    Epoch [01/20], Beta: 0.000, Average Loss: 538.0779
    Epoch [02/20], Beta: 0.000, Average Loss: 305.8184
    Epoch [03/20], Beta: 0.000, Average Loss: 270.1684
    Epoch [04/20], Beta: 0.000, Average Loss: 250.6687
    Epoch [05/20], Beta: 0.100, Average Loss: 246.9055
    Epoch [06/20], Beta: 0.200, Average Loss: 246.0230
    Epoch [07/20], Beta: 0.300, Average Loss: 245.7197
    Epoch [08/20], Beta: 0.400, Average Loss: 246.2429
    Epoch [09/20], Beta: 0.500, Average Loss: 247.1507
    Epoch [10/20], Beta: 0.600, Average Loss: 248.2128
    Epoch [11/20], Beta: 0.700, Average Loss: 249.3392
    Epoch [12/20], Beta: 0.800, Average Loss: 250.5378
    Epoch [13/20], Beta: 0.900, Average Loss: 251.8002
    Epoch [14/20], Beta: 1.000, Average Loss: 252.9823
    Epoch [15/20], Beta: 1.000, Average Loss: 252.5508
    Epoch [16/20], Beta: 1.000, Average Loss: 252.2231
    Epoch [17/20], Beta: 1.000, Average Loss: 251.8489
    Epoch [18/20], Beta: 1.000, Average Loss: 251.5476
    Epoch [19/20], Beta: 1.000, Average Loss: 251.2602
    Epoch [20/20], Beta: 1.000, Average Loss: 250.9018

[Seed 14] VAE pre-training complete.

[Seed 14] Starting joint training (original)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=400.4750, vae=3.9668, dsb=370.4776, bio=52.0613
    Epoch  2/10: total=99.1045, vae=1.0947, dsb=97.9773, bio=0.0650
    Epoch  3/10: total=87.8494, vae=1.0895, dsb=86.7450, bio=0.0298
    Epoch  4/10: total=83.0303, vae=1.0879, dsb=81.9334, bio=0.0181
    Epoch  5/10: total=79.6057, vae=1.0856, dsb=78.5137, bio=0.0127
    Epoch  6/10: total=78.3040, vae=1.0850, dsb=77.2143, bio=0.0092
    Epoch  7/10: total=76.5042, vae=1.0849, dsb=75.4157, bio=0.0073
    Epoch  8/10: total=75.4681, vae=1.0851, dsb=74.3799, bio=0.0063
    Epoch  9/10: total=74.6359, vae=1.0850, dsb=73.5484, bio=0.0052
    Epoch 10/10: total=73.9506, vae=1.0839, dsb=72.8644, bio=0.0046

  [Backward Policy Training]
    Epoch  1/10: total=3.2952, vae=1.0863, dsb=2.2017, bio=0.0144
    Epoch  2/10: total=2.7997, vae=1.0834, dsb=1.7136, bio=0.0055
    Epoch  3/10: total=2.6767, vae=1.0837, dsb=1.5910, bio=0.0041
    Epoch  4/10: total=2.6276, vae=1.0824, dsb=1.5434, bio=0.0035
    Epoch  5/10: total=2.5887, vae=1.0823, dsb=1.5049, bio=0.0030
    Epoch  6/10: total=2.5345, vae=1.0818, dsb=1.4513, bio=0.0027
    Epoch  7/10: total=2.4743, vae=1.0818, dsb=1.3912, bio=0.0025
    Epoch  8/10: total=2.5102, vae=1.0819, dsb=1.4268, bio=0.0030
    Epoch  9/10: total=2.4931, vae=1.0818, dsb=1.4101, bio=0.0024
    Epoch 10/10: total=2.4529, vae=1.0825, dsb=1.3692, bio=0.0023

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=64.1834, vae=1.0845, dsb=63.0970, bio=0.0038
    Epoch  2/10: total=58.7071, vae=1.0836, dsb=57.6224, bio=0.0023
    Epoch  3/10: total=57.2795, vae=1.0830, dsb=56.1954, bio=0.0022
    Epoch  4/10: total=56.8447, vae=1.0825, dsb=55.7611, bio=0.0022
    Epoch  5/10: total=55.8802, vae=1.0828, dsb=54.7963, bio=0.0022
    Epoch  6/10: total=55.3499, vae=1.0825, dsb=54.2663, bio=0.0021
    Epoch  7/10: total=55.3777, vae=1.0828, dsb=54.2938, bio=0.0023
    Epoch  8/10: total=55.2342, vae=1.0826, dsb=54.1504, bio=0.0022
    Epoch  9/10: total=55.2641, vae=1.0825, dsb=54.1805, bio=0.0021
    Epoch 10/10: total=54.7866, vae=1.0826, dsb=53.7029, bio=0.0021

  [Backward Policy Training]
    Epoch  1/10: total=2.1898, vae=1.0832, dsb=1.1039, bio=0.0052
    Epoch  2/10: total=2.0798, vae=1.0816, dsb=0.9970, bio=0.0022
    Epoch  3/10: total=2.0433, vae=1.0816, dsb=0.9607, bio=0.0021
    Epoch  4/10: total=2.0267, vae=1.0809, dsb=0.9447, bio=0.0020
    Epoch  5/10: total=2.0383, vae=1.0816, dsb=0.9557, bio=0.0020
    Epoch  6/10: total=1.9874, vae=1.0810, dsb=0.9054, bio=0.0020
    Epoch  7/10: total=2.0026, vae=1.0818, dsb=0.9199, bio=0.0019
    Epoch  8/10: total=1.9873, vae=1.0798, dsb=0.9065, bio=0.0019
    Epoch  9/10: total=1.9950, vae=1.0802, dsb=0.9138, bio=0.0019
    Epoch 10/10: total=1.9542, vae=1.0803, dsb=0.8729, bio=0.0021

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=50.4565, vae=1.0844, dsb=49.3702, bio=0.0038
    Epoch  2/10: total=48.5280, vae=1.0818, dsb=47.4451, bio=0.0020
    Epoch  3/10: total=47.9555, vae=1.0818, dsb=46.8728, bio=0.0019
    Epoch  4/10: total=47.7714, vae=1.0822, dsb=46.6882, bio=0.0019
    Epoch  5/10: total=47.6145, vae=1.0818, dsb=46.5317, bio=0.0019
    Epoch  6/10: total=47.4403, vae=1.0815, dsb=46.3579, bio=0.0019
    Epoch  7/10: total=47.3891, vae=1.0813, dsb=46.3068, bio=0.0020
    Epoch  8/10: total=47.2792, vae=1.0815, dsb=46.1967, bio=0.0018
    Epoch  9/10: total=47.0025, vae=1.0821, dsb=45.9193, bio=0.0023
    Epoch 10/10: total=46.9379, vae=1.0813, dsb=45.8557, bio=0.0019

  [Backward Policy Training]
    Epoch  1/10: total=1.8561, vae=1.0821, dsb=0.7716, bio=0.0046
    Epoch  2/10: total=1.7939, vae=1.0804, dsb=0.7125, bio=0.0018
    Epoch  3/10: total=1.7793, vae=1.0799, dsb=0.6984, bio=0.0019
    Epoch  4/10: total=1.7704, vae=1.0809, dsb=0.6886, bio=0.0019
    Epoch  5/10: total=1.7481, vae=1.0803, dsb=0.6669, bio=0.0018
    Epoch  6/10: total=1.7613, vae=1.0805, dsb=0.6797, bio=0.0021
    Epoch  7/10: total=1.7659, vae=1.0807, dsb=0.6843, bio=0.0017
    Epoch  8/10: total=1.7645, vae=1.0808, dsb=0.6829, bio=0.0018
    Epoch  9/10: total=1.7504, vae=1.0808, dsb=0.6688, bio=0.0017
    Epoch 10/10: total=1.7328, vae=1.0801, dsb=0.6519, bio=0.0017

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=46.0381, vae=1.0827, dsb=44.9538, bio=0.0031
    Epoch  2/10: total=45.2156, vae=1.0818, dsb=44.1328, bio=0.0018
    Epoch  3/10: total=44.9217, vae=1.0819, dsb=43.8389, bio=0.0018
    Epoch  4/10: total=45.0400, vae=1.0819, dsb=43.9572, bio=0.0018
    Epoch  5/10: total=44.7492, vae=1.0819, dsb=43.6665, bio=0.0018
    Epoch  6/10: total=44.8262, vae=1.0821, dsb=43.7432, bio=0.0018
    Epoch  7/10: total=44.6279, vae=1.0813, dsb=43.5456, bio=0.0018
    Epoch  8/10: total=44.2446, vae=1.0818, dsb=43.1617, bio=0.0021
    Epoch  9/10: total=44.9076, vae=1.0814, dsb=43.8254, bio=0.0017
    Epoch 10/10: total=44.6569, vae=1.0803, dsb=43.5756, bio=0.0018

  [Backward Policy Training]
    Epoch  1/10: total=1.6631, vae=1.0812, dsb=0.5787, bio=0.0062
    Epoch  2/10: total=1.6706, vae=1.0800, dsb=0.5896, bio=0.0019
    Epoch  3/10: total=1.6505, vae=1.0806, dsb=0.5690, bio=0.0017
    Epoch  4/10: total=1.6256, vae=1.0809, dsb=0.5439, bio=0.0017
    Epoch  5/10: total=1.6463, vae=1.0803, dsb=0.5651, bio=0.0017
    Epoch  6/10: total=1.6177, vae=1.0796, dsb=0.5373, bio=0.0016
    Epoch  7/10: total=1.6431, vae=1.0806, dsb=0.5616, bio=0.0016
    Epoch  8/10: total=1.6410, vae=1.0802, dsb=0.5598, bio=0.0019
    Epoch  9/10: total=1.6363, vae=1.0801, dsb=0.5554, bio=0.0016
    Epoch 10/10: total=1.6192, vae=1.0795, dsb=0.5390, bio=0.0015

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=36.1514, vae=1.0830, dsb=35.0669, bio=0.0029
    Epoch  2/10: total=35.7135, vae=1.0814, dsb=34.6312, bio=0.0016
    Epoch  3/10: total=35.6455, vae=1.0815, dsb=34.5632, bio=0.0016
    Epoch  4/10: total=35.5528, vae=1.0806, dsb=34.4713, bio=0.0018
    Epoch  5/10: total=35.6296, vae=1.0808, dsb=34.5479, bio=0.0017
    Epoch  6/10: total=35.7554, vae=1.0809, dsb=34.6736, bio=0.0017
    Epoch  7/10: total=35.6943, vae=1.0808, dsb=34.6126, bio=0.0017
    Epoch  8/10: total=35.5452, vae=1.0813, dsb=34.4631, bio=0.0018
    Epoch  9/10: total=35.4919, vae=1.0809, dsb=34.4101, bio=0.0018
    Epoch 10/10: total=35.7295, vae=1.0813, dsb=34.6473, bio=0.0019

  [Backward Policy Training]
    Epoch  1/10: total=1.6060, vae=1.0812, dsb=0.5207, bio=0.0080
    Epoch  2/10: total=1.5979, vae=1.0798, dsb=0.5173, bio=0.0017
    Epoch  3/10: total=1.5908, vae=1.0798, dsb=0.5102, bio=0.0016
    Epoch  4/10: total=1.5837, vae=1.0800, dsb=0.5029, bio=0.0016
    Epoch  5/10: total=1.5878, vae=1.0802, dsb=0.5066, bio=0.0020
    Epoch  6/10: total=1.5858, vae=1.0794, dsb=0.5057, bio=0.0015
    Epoch  7/10: total=1.5810, vae=1.0808, dsb=0.4995, bio=0.0015
    Epoch  8/10: total=1.5974, vae=1.0795, dsb=0.5171, bio=0.0015
    Epoch  9/10: total=1.5923, vae=1.0798, dsb=0.5119, bio=0.0015
    Epoch 10/10: total=1.5842, vae=1.0796, dsb=0.5038, bio=0.0016

[Seed 14] Joint training (original) complete; models and history saved.

[Seed 14] Starting joint training (ablation)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=371.9968, vae=2.0572, dsb=369.9396, bio=0.0000
    Epoch  2/10: total=98.2043, vae=1.0757, dsb=97.1286, bio=0.0000
    Epoch  3/10: total=87.2234, vae=1.0742, dsb=86.1492, bio=0.0000
    Epoch  4/10: total=82.6093, vae=1.0740, dsb=81.5353, bio=0.0000
    Epoch  5/10: total=79.2625, vae=1.0724, dsb=78.1901, bio=0.0000
    Epoch  6/10: total=77.9888, vae=1.0723, dsb=76.9165, bio=0.0000
    Epoch  7/10: total=76.2034, vae=1.0725, dsb=75.1310, bio=0.0000
    Epoch  8/10: total=75.1894, vae=1.0729, dsb=74.1165, bio=0.0000
    Epoch  9/10: total=74.3644, vae=1.0732, dsb=73.2912, bio=0.0000
    Epoch 10/10: total=73.6554, vae=1.0722, dsb=72.5832, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=3.1634, vae=1.0737, dsb=2.0897, bio=0.0000
    Epoch  2/10: total=2.6904, vae=1.0725, dsb=1.6179, bio=0.0000
    Epoch  3/10: total=2.5685, vae=1.0732, dsb=1.4953, bio=0.0000
    Epoch  4/10: total=2.5215, vae=1.0723, dsb=1.4493, bio=0.0000
    Epoch  5/10: total=2.4868, vae=1.0723, dsb=1.4145, bio=0.0000
    Epoch  6/10: total=2.4352, vae=1.0720, dsb=1.3632, bio=0.0000
    Epoch  7/10: total=2.3789, vae=1.0721, dsb=1.3068, bio=0.0000
    Epoch  8/10: total=2.4130, vae=1.0722, dsb=1.3408, bio=0.0000
    Epoch  9/10: total=2.3970, vae=1.0723, dsb=1.3247, bio=0.0000
    Epoch 10/10: total=2.3597, vae=1.0730, dsb=1.2867, bio=0.0000

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=62.5738, vae=1.0722, dsb=61.5016, bio=0.0000
    Epoch  2/10: total=57.1538, vae=1.0725, dsb=56.0813, bio=0.0000
    Epoch  3/10: total=55.7076, vae=1.0722, dsb=54.6353, bio=0.0000
    Epoch  4/10: total=55.2682, vae=1.0719, dsb=54.1963, bio=0.0000
    Epoch  5/10: total=54.3734, vae=1.0723, dsb=53.3011, bio=0.0000
    Epoch  6/10: total=53.8289, vae=1.0721, dsb=52.7568, bio=0.0000
    Epoch  7/10: total=53.9003, vae=1.0724, dsb=52.8279, bio=0.0000
    Epoch  8/10: total=53.7151, vae=1.0723, dsb=52.6428, bio=0.0000
    Epoch  9/10: total=53.7614, vae=1.0723, dsb=52.6891, bio=0.0000
    Epoch 10/10: total=53.3142, vae=1.0725, dsb=52.2418, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=2.0983, vae=1.0728, dsb=1.0255, bio=0.0000
    Epoch  2/10: total=2.0013, vae=1.0726, dsb=0.9288, bio=0.0000
    Epoch  3/10: total=1.9695, vae=1.0726, dsb=0.8969, bio=0.0000
    Epoch  4/10: total=1.9547, vae=1.0720, dsb=0.8826, bio=0.0000
    Epoch  5/10: total=1.9661, vae=1.0727, dsb=0.8933, bio=0.0000
    Epoch  6/10: total=1.9185, vae=1.0723, dsb=0.8462, bio=0.0000
    Epoch  7/10: total=1.9333, vae=1.0730, dsb=0.8603, bio=0.0000
    Epoch  8/10: total=1.9195, vae=1.0711, dsb=0.8484, bio=0.0000
    Epoch  9/10: total=1.9270, vae=1.0715, dsb=0.8555, bio=0.0000
    Epoch 10/10: total=1.8888, vae=1.0717, dsb=0.8171, bio=0.0000

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=48.4080, vae=1.0725, dsb=47.3355, bio=0.0000
    Epoch  2/10: total=46.5908, vae=1.0716, dsb=45.5192, bio=0.0000
    Epoch  3/10: total=46.0808, vae=1.0718, dsb=45.0090, bio=0.0000
    Epoch  4/10: total=45.9591, vae=1.0723, dsb=44.8869, bio=0.0000
    Epoch  5/10: total=45.8121, vae=1.0720, dsb=44.7401, bio=0.0000
    Epoch  6/10: total=45.6068, vae=1.0717, dsb=44.5350, bio=0.0000
    Epoch  7/10: total=45.6018, vae=1.0716, dsb=44.5302, bio=0.0000
    Epoch  8/10: total=45.4834, vae=1.0717, dsb=44.4117, bio=0.0000
    Epoch  9/10: total=45.2621, vae=1.0724, dsb=44.1897, bio=0.0000
    Epoch 10/10: total=45.2201, vae=1.0716, dsb=44.1485, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.7763, vae=1.0722, dsb=0.7042, bio=0.0000
    Epoch  2/10: total=1.7205, vae=1.0716, dsb=0.6489, bio=0.0000
    Epoch  3/10: total=1.7072, vae=1.0715, dsb=0.6357, bio=0.0000
    Epoch  4/10: total=1.6998, vae=1.0725, dsb=0.6273, bio=0.0000
    Epoch  5/10: total=1.6793, vae=1.0719, dsb=0.6075, bio=0.0000
    Epoch  6/10: total=1.6914, vae=1.0721, dsb=0.6192, bio=0.0000
    Epoch  7/10: total=1.6964, vae=1.0724, dsb=0.6240, bio=0.0000
    Epoch  8/10: total=1.6952, vae=1.0724, dsb=0.6228, bio=0.0000
    Epoch  9/10: total=1.6822, vae=1.0725, dsb=0.6096, bio=0.0000
    Epoch 10/10: total=1.6658, vae=1.0719, dsb=0.5939, bio=0.0000

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=42.7321, vae=1.0715, dsb=41.6606, bio=0.0000
    Epoch  2/10: total=42.0700, vae=1.0720, dsb=40.9980, bio=0.0000
    Epoch  3/10: total=41.8007, vae=1.0723, dsb=40.7284, bio=0.0000
    Epoch  4/10: total=41.9471, vae=1.0724, dsb=40.8748, bio=0.0000
    Epoch  5/10: total=41.6731, vae=1.0724, dsb=40.6006, bio=0.0000
    Epoch  6/10: total=41.7606, vae=1.0726, dsb=40.6879, bio=0.0000
    Epoch  7/10: total=41.5944, vae=1.0720, dsb=40.5224, bio=0.0000
    Epoch  8/10: total=41.2719, vae=1.0724, dsb=40.1995, bio=0.0000
    Epoch  9/10: total=41.8444, vae=1.0721, dsb=40.7723, bio=0.0000
    Epoch 10/10: total=41.6196, vae=1.0712, dsb=40.5484, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.5846, vae=1.0716, dsb=0.5130, bio=0.0000
    Epoch  2/10: total=1.5969, vae=1.0717, dsb=0.5252, bio=0.0000
    Epoch  3/10: total=1.5795, vae=1.0723, dsb=0.5072, bio=0.0000
    Epoch  4/10: total=1.5573, vae=1.0726, dsb=0.4847, bio=0.0000
    Epoch  5/10: total=1.5771, vae=1.0722, dsb=0.5049, bio=0.0000
    Epoch  6/10: total=1.5511, vae=1.0715, dsb=0.4796, bio=0.0000
    Epoch  7/10: total=1.5747, vae=1.0726, dsb=0.5022, bio=0.0000
    Epoch  8/10: total=1.5729, vae=1.0720, dsb=0.5009, bio=0.0000
    Epoch  9/10: total=1.5691, vae=1.0720, dsb=0.4971, bio=0.0000
    Epoch 10/10: total=1.5537, vae=1.0714, dsb=0.4823, bio=0.0000

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=33.9041, vae=1.0721, dsb=32.8320, bio=0.0000
    Epoch  2/10: total=33.6068, vae=1.0717, dsb=32.5351, bio=0.0000
    Epoch  3/10: total=33.5453, vae=1.0721, dsb=32.4732, bio=0.0000
    Epoch  4/10: total=33.4640, vae=1.0715, dsb=32.3925, bio=0.0000
    Epoch  5/10: total=33.5868, vae=1.0718, dsb=32.5150, bio=0.0000
    Epoch  6/10: total=33.6591, vae=1.0719, dsb=32.5872, bio=0.0000
    Epoch  7/10: total=33.6363, vae=1.0719, dsb=32.5644, bio=0.0000
    Epoch  8/10: total=33.5031, vae=1.0723, dsb=32.4308, bio=0.0000
    Epoch  9/10: total=33.4081, vae=1.0719, dsb=32.3362, bio=0.0000
    Epoch 10/10: total=33.6831, vae=1.0724, dsb=32.6107, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.5363, vae=1.0720, dsb=0.4643, bio=0.0000
    Epoch  2/10: total=1.5344, vae=1.0717, dsb=0.4628, bio=0.0000
    Epoch  3/10: total=1.5288, vae=1.0718, dsb=0.4570, bio=0.0000
    Epoch  4/10: total=1.5228, vae=1.0721, dsb=0.4507, bio=0.0000
    Epoch  5/10: total=1.5262, vae=1.0723, dsb=0.4539, bio=0.0000
    Epoch  6/10: total=1.5250, vae=1.0716, dsb=0.4535, bio=0.0000
    Epoch  7/10: total=1.5205, vae=1.0730, dsb=0.4475, bio=0.0000
    Epoch  8/10: total=1.5358, vae=1.0717, dsb=0.4641, bio=0.0000
    Epoch  9/10: total=1.5311, vae=1.0719, dsb=0.4592, bio=0.0000
    Epoch 10/10: total=1.5239, vae=1.0718, dsb=0.4521, bio=0.0000

[Seed 14] Joint training (ablation) complete; models and history saved.

[Seed 14] Drift genes saved in /home/yyuan/ICB_TCE/iter_results/run_014

[Seed 14] run finished.

================================================================================
[Seed 15] Starting running whole pipeline...
================================================================================

[Seed 15] Starting VAE pre-training...

    Epoch [01/20], Beta: 0.000, Average Loss: 534.7638
    Epoch [02/20], Beta: 0.000, Average Loss: 307.0696
    Epoch [03/20], Beta: 0.000, Average Loss: 268.3365
    Epoch [04/20], Beta: 0.000, Average Loss: 249.5714
    Epoch [05/20], Beta: 0.100, Average Loss: 244.8399
    Epoch [06/20], Beta: 0.200, Average Loss: 244.0649
    Epoch [07/20], Beta: 0.300, Average Loss: 244.4356
    Epoch [08/20], Beta: 0.400, Average Loss: 245.4380
    Epoch [09/20], Beta: 0.500, Average Loss: 246.6476
    Epoch [10/20], Beta: 0.600, Average Loss: 247.9069
    Epoch [11/20], Beta: 0.700, Average Loss: 249.2321
    Epoch [12/20], Beta: 0.800, Average Loss: 250.5350
    Epoch [13/20], Beta: 0.900, Average Loss: 251.8347
    Epoch [14/20], Beta: 1.000, Average Loss: 253.4815
    Epoch [15/20], Beta: 1.000, Average Loss: 253.0817
    Epoch [16/20], Beta: 1.000, Average Loss: 252.6852
    Epoch [17/20], Beta: 1.000, Average Loss: 252.3303
    Epoch [18/20], Beta: 1.000, Average Loss: 251.9773
    Epoch [19/20], Beta: 1.000, Average Loss: 251.6232
    Epoch [20/20], Beta: 1.000, Average Loss: 251.4288

[Seed 15] VAE pre-training complete.

[Seed 15] Starting joint training (original)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=264.2578, vae=3.6280, dsb=245.8244, bio=29.6107
    Epoch  2/10: total=91.0122, vae=1.1123, dsb=89.8627, bio=0.0745
    Epoch  3/10: total=79.6604, vae=1.1066, dsb=78.5382, bio=0.0313
    Epoch  4/10: total=74.4128, vae=1.1054, dsb=73.2983, bio=0.0182
    Epoch  5/10: total=70.8890, vae=1.1040, dsb=69.7788, bio=0.0123
    Epoch  6/10: total=68.5217, vae=1.1029, dsb=67.4142, bio=0.0091
    Epoch  7/10: total=66.9838, vae=1.1026, dsb=65.8775, bio=0.0072
    Epoch  8/10: total=65.9157, vae=1.1022, dsb=64.8107, bio=0.0056
    Epoch  9/10: total=65.2957, vae=1.1021, dsb=64.1913, bio=0.0048
    Epoch 10/10: total=64.1811, vae=1.1024, dsb=63.0767, bio=0.0042

  [Backward Policy Training]
    Epoch  1/10: total=3.4144, vae=1.1012, dsb=2.3075, bio=0.0112
    Epoch  2/10: total=2.7820, vae=1.1007, dsb=1.6791, bio=0.0043
    Epoch  3/10: total=2.6836, vae=1.1007, dsb=1.5813, bio=0.0033
    Epoch  4/10: total=2.6658, vae=1.0997, dsb=1.5646, bio=0.0028
    Epoch  5/10: total=2.5347, vae=1.0996, dsb=1.4338, bio=0.0025
    Epoch  6/10: total=2.5411, vae=1.1002, dsb=1.4397, bio=0.0024
    Epoch  7/10: total=2.5477, vae=1.0993, dsb=1.4470, bio=0.0026
    Epoch  8/10: total=2.4858, vae=1.0987, dsb=1.3860, bio=0.0022
    Epoch  9/10: total=2.4960, vae=1.0994, dsb=1.3956, bio=0.0021
    Epoch 10/10: total=2.4167, vae=1.0985, dsb=1.3172, bio=0.0020

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=58.9493, vae=1.1023, dsb=57.8453, bio=0.0035
    Epoch  2/10: total=51.2752, vae=1.1003, dsb=50.1738, bio=0.0020
    Epoch  3/10: total=49.5140, vae=1.1000, dsb=48.4127, bio=0.0027
    Epoch  4/10: total=48.2790, vae=1.0998, dsb=47.1782, bio=0.0020
    Epoch  5/10: total=47.6739, vae=1.0995, dsb=46.5734, bio=0.0020
    Epoch  6/10: total=47.2842, vae=1.0998, dsb=46.1834, bio=0.0020
    Epoch  7/10: total=46.8477, vae=1.0989, dsb=45.7479, bio=0.0019
    Epoch  8/10: total=46.5616, vae=1.1005, dsb=45.4596, bio=0.0028
    Epoch  9/10: total=46.4536, vae=1.0994, dsb=45.3533, bio=0.0019
    Epoch 10/10: total=46.1335, vae=1.0991, dsb=45.0334, bio=0.0019

  [Backward Policy Training]
    Epoch  1/10: total=2.1924, vae=1.0994, dsb=1.0905, bio=0.0052
    Epoch  2/10: total=2.0642, vae=1.0981, dsb=0.9651, bio=0.0020
    Epoch  3/10: total=2.0134, vae=1.0981, dsb=0.9146, bio=0.0014
    Epoch  4/10: total=2.0107, vae=1.0964, dsb=0.9132, bio=0.0021
    Epoch  5/10: total=1.9848, vae=1.0981, dsb=0.8858, bio=0.0018
    Epoch  6/10: total=1.9668, vae=1.0982, dsb=0.8678, bio=0.0018
    Epoch  7/10: total=1.9526, vae=1.0978, dsb=0.8539, bio=0.0017
    Epoch  8/10: total=1.9513, vae=1.0977, dsb=0.8527, bio=0.0017
    Epoch  9/10: total=1.9543, vae=1.0978, dsb=0.8556, bio=0.0017
    Epoch 10/10: total=1.9414, vae=1.0977, dsb=0.8429, bio=0.0017

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=42.9542, vae=1.1002, dsb=41.8524, bio=0.0032
    Epoch  2/10: total=39.9812, vae=1.0992, dsb=38.8812, bio=0.0018
    Epoch  3/10: total=38.9754, vae=1.0987, dsb=37.8758, bio=0.0017
    Epoch  4/10: total=38.6646, vae=1.0987, dsb=37.5650, bio=0.0017
    Epoch  5/10: total=38.7135, vae=1.0988, dsb=37.6138, bio=0.0017
    Epoch  6/10: total=38.2735, vae=1.0992, dsb=37.1736, bio=0.0015
    Epoch  7/10: total=38.1064, vae=1.0988, dsb=37.0066, bio=0.0021
    Epoch  8/10: total=38.0754, vae=1.0982, dsb=36.9763, bio=0.0017
    Epoch  9/10: total=37.7166, vae=1.0983, dsb=36.6175, bio=0.0017
    Epoch 10/10: total=37.6733, vae=1.0992, dsb=36.5732, bio=0.0017

  [Backward Policy Training]
    Epoch  1/10: total=1.8526, vae=1.0988, dsb=0.7507, bio=0.0062
    Epoch  2/10: total=1.7865, vae=1.0973, dsb=0.6883, bio=0.0019
    Epoch  3/10: total=1.7734, vae=1.0967, dsb=0.6759, bio=0.0016
    Epoch  4/10: total=1.7372, vae=1.0964, dsb=0.6400, bio=0.0015
    Epoch  5/10: total=1.7528, vae=1.0975, dsb=0.6545, bio=0.0015
    Epoch  6/10: total=1.7511, vae=1.0967, dsb=0.6537, bio=0.0016
    Epoch  7/10: total=1.7289, vae=1.0967, dsb=0.6314, bio=0.0015
    Epoch  8/10: total=1.7452, vae=1.0972, dsb=0.6473, bio=0.0015
    Epoch  9/10: total=1.7186, vae=1.0968, dsb=0.6211, bio=0.0014
    Epoch 10/10: total=1.7286, vae=1.0980, dsb=0.6298, bio=0.0014

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=34.7040, vae=1.0998, dsb=33.6025, bio=0.0033
    Epoch  2/10: total=33.3363, vae=1.0992, dsb=32.2363, bio=0.0016
    Epoch  3/10: total=33.1245, vae=1.0985, dsb=32.0252, bio=0.0015
    Epoch  4/10: total=32.9316, vae=1.0977, dsb=31.8331, bio=0.0015
    Epoch  5/10: total=32.5836, vae=1.0991, dsb=31.4838, bio=0.0015
    Epoch  6/10: total=32.6301, vae=1.0977, dsb=31.5317, bio=0.0014
    Epoch  7/10: total=32.5251, vae=1.0970, dsb=31.4271, bio=0.0020
    Epoch  8/10: total=32.3292, vae=1.0977, dsb=31.2308, bio=0.0015
    Epoch  9/10: total=32.3474, vae=1.0984, dsb=31.2483, bio=0.0015
    Epoch 10/10: total=32.2844, vae=1.0983, dsb=31.1853, bio=0.0015

  [Backward Policy Training]
    Epoch  1/10: total=1.6621, vae=1.0979, dsb=0.5591, bio=0.0101
    Epoch  2/10: total=1.6207, vae=1.0976, dsb=0.5223, bio=0.0015
    Epoch  3/10: total=1.6160, vae=1.0973, dsb=0.5180, bio=0.0014
    Epoch  4/10: total=1.6013, vae=1.0972, dsb=0.5035, bio=0.0013
    Epoch  5/10: total=1.6175, vae=1.0969, dsb=0.5199, bio=0.0013
    Epoch  6/10: total=1.6037, vae=1.0968, dsb=0.5063, bio=0.0013
    Epoch  7/10: total=1.5931, vae=1.0966, dsb=0.4958, bio=0.0013
    Epoch  8/10: total=1.6045, vae=1.0967, dsb=0.5072, bio=0.0013
    Epoch  9/10: total=1.6054, vae=1.0966, dsb=0.5081, bio=0.0013
    Epoch 10/10: total=1.5947, vae=1.0964, dsb=0.4974, bio=0.0016

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=29.8462, vae=1.0989, dsb=28.7459, bio=0.0028
    Epoch  2/10: total=29.3834, vae=1.0989, dsb=28.2838, bio=0.0013
    Epoch  3/10: total=29.1056, vae=1.0986, dsb=28.0063, bio=0.0013
    Epoch  4/10: total=29.1345, vae=1.0978, dsb=28.0360, bio=0.0014
    Epoch  5/10: total=29.1348, vae=1.0971, dsb=28.0370, bio=0.0014
    Epoch  6/10: total=29.1336, vae=1.0975, dsb=28.0355, bio=0.0013
    Epoch  7/10: total=29.1246, vae=1.0978, dsb=28.0261, bio=0.0014
    Epoch  8/10: total=29.0873, vae=1.0977, dsb=27.9889, bio=0.0014
    Epoch  9/10: total=28.9407, vae=1.0973, dsb=27.8427, bio=0.0014
    Epoch 10/10: total=28.8347, vae=1.0974, dsb=27.7366, bio=0.0014

  [Backward Policy Training]
    Epoch  1/10: total=1.5409, vae=1.0983, dsb=0.4329, bio=0.0193
    Epoch  2/10: total=1.5128, vae=1.0970, dsb=0.4151, bio=0.0013
    Epoch  3/10: total=1.5172, vae=1.0967, dsb=0.4199, bio=0.0012
    Epoch  4/10: total=1.5189, vae=1.0963, dsb=0.4220, bio=0.0013
    Epoch  5/10: total=1.5048, vae=1.0967, dsb=0.4076, bio=0.0011
    Epoch  6/10: total=1.5056, vae=1.0961, dsb=0.4089, bio=0.0011
    Epoch  7/10: total=1.5090, vae=1.0961, dsb=0.4123, bio=0.0011
    Epoch  8/10: total=1.5040, vae=1.0957, dsb=0.4078, bio=0.0011
    Epoch  9/10: total=1.4970, vae=1.0954, dsb=0.4011, bio=0.0011
    Epoch 10/10: total=1.4993, vae=1.0960, dsb=0.4027, bio=0.0012

[Seed 15] Joint training (original) complete; models and history saved.

[Seed 15] Starting joint training (ablation)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=247.3924, vae=2.0305, dsb=245.3620, bio=0.0000
    Epoch  2/10: total=90.5775, vae=1.0928, dsb=89.4846, bio=0.0000
    Epoch  3/10: total=79.2624, vae=1.0911, dsb=78.1713, bio=0.0000
    Epoch  4/10: total=74.0569, vae=1.0914, dsb=72.9655, bio=0.0000
    Epoch  5/10: total=70.5406, vae=1.0906, dsb=69.4500, bio=0.0000
    Epoch  6/10: total=68.1503, vae=1.0899, dsb=67.0604, bio=0.0000
    Epoch  7/10: total=66.6366, vae=1.0899, dsb=65.5467, bio=0.0000
    Epoch  8/10: total=65.5548, vae=1.0898, dsb=64.4650, bio=0.0000
    Epoch  9/10: total=64.9155, vae=1.0901, dsb=63.8255, bio=0.0000
    Epoch 10/10: total=63.8056, vae=1.0906, dsb=62.7150, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=3.3092, vae=1.0887, dsb=2.2205, bio=0.0000
    Epoch  2/10: total=2.7105, vae=1.0898, dsb=1.6207, bio=0.0000
    Epoch  3/10: total=2.6174, vae=1.0902, dsb=1.5272, bio=0.0000
    Epoch  4/10: total=2.5985, vae=1.0895, dsb=1.5090, bio=0.0000
    Epoch  5/10: total=2.4710, vae=1.0897, dsb=1.3813, bio=0.0000
    Epoch  6/10: total=2.4768, vae=1.0904, dsb=1.3864, bio=0.0000
    Epoch  7/10: total=2.4834, vae=1.0896, dsb=1.3937, bio=0.0000
    Epoch  8/10: total=2.4248, vae=1.0892, dsb=1.3356, bio=0.0000
    Epoch  9/10: total=2.4362, vae=1.0900, dsb=1.3463, bio=0.0000
    Epoch 10/10: total=2.3594, vae=1.0891, dsb=1.2702, bio=0.0000

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=57.7052, vae=1.0901, dsb=56.6150, bio=0.0000
    Epoch  2/10: total=49.9398, vae=1.0893, dsb=48.8505, bio=0.0000
    Epoch  3/10: total=48.2998, vae=1.0893, dsb=47.2105, bio=0.0000
    Epoch  4/10: total=47.1241, vae=1.0892, dsb=46.0349, bio=0.0000
    Epoch  5/10: total=46.6286, vae=1.0890, dsb=45.5396, bio=0.0000
    Epoch  6/10: total=46.2854, vae=1.0895, dsb=45.1960, bio=0.0000
    Epoch  7/10: total=45.9060, vae=1.0886, dsb=44.8174, bio=0.0000
    Epoch  8/10: total=45.6402, vae=1.0903, dsb=44.5499, bio=0.0000
    Epoch  9/10: total=45.5559, vae=1.0893, dsb=44.4666, bio=0.0000
    Epoch 10/10: total=45.2679, vae=1.0890, dsb=44.1789, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=2.1205, vae=1.0888, dsb=1.0317, bio=0.0000
    Epoch  2/10: total=1.9984, vae=1.0890, dsb=0.9094, bio=0.0000
    Epoch  3/10: total=1.9513, vae=1.0891, dsb=0.8622, bio=0.0000
    Epoch  4/10: total=1.9478, vae=1.0877, dsb=0.8601, bio=0.0000
    Epoch  5/10: total=1.9238, vae=1.0894, dsb=0.8344, bio=0.0000
    Epoch  6/10: total=1.9068, vae=1.0896, dsb=0.8173, bio=0.0000
    Epoch  7/10: total=1.8928, vae=1.0892, dsb=0.8036, bio=0.0000
    Epoch  8/10: total=1.8909, vae=1.0892, dsb=0.8018, bio=0.0000
    Epoch  9/10: total=1.8945, vae=1.0893, dsb=0.8052, bio=0.0000
    Epoch 10/10: total=1.8819, vae=1.0891, dsb=0.7929, bio=0.0000

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=40.9749, vae=1.0890, dsb=39.8858, bio=0.0000
    Epoch  2/10: total=38.1227, vae=1.0891, dsb=37.0336, bio=0.0000
    Epoch  3/10: total=37.2159, vae=1.0890, dsb=36.1270, bio=0.0000
    Epoch  4/10: total=36.9329, vae=1.0891, dsb=35.8439, bio=0.0000
    Epoch  5/10: total=36.9503, vae=1.0892, dsb=35.8611, bio=0.0000
    Epoch  6/10: total=36.5238, vae=1.0897, dsb=35.4341, bio=0.0000
    Epoch  7/10: total=36.3828, vae=1.0894, dsb=35.2934, bio=0.0000
    Epoch  8/10: total=36.3577, vae=1.0888, dsb=35.2689, bio=0.0000
    Epoch  9/10: total=35.9896, vae=1.0889, dsb=34.9006, bio=0.0000
    Epoch 10/10: total=35.9661, vae=1.0899, dsb=34.8762, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.7834, vae=1.0891, dsb=0.6944, bio=0.0000
    Epoch  2/10: total=1.7256, vae=1.0889, dsb=0.6367, bio=0.0000
    Epoch  3/10: total=1.7137, vae=1.0885, dsb=0.6252, bio=0.0000
    Epoch  4/10: total=1.6806, vae=1.0883, dsb=0.5924, bio=0.0000
    Epoch  5/10: total=1.6952, vae=1.0894, dsb=0.6058, bio=0.0000
    Epoch  6/10: total=1.6932, vae=1.0886, dsb=0.6046, bio=0.0000
    Epoch  7/10: total=1.6727, vae=1.0886, dsb=0.5841, bio=0.0000
    Epoch  8/10: total=1.6882, vae=1.0892, dsb=0.5990, bio=0.0000
    Epoch  9/10: total=1.6633, vae=1.0888, dsb=0.5745, bio=0.0000
    Epoch 10/10: total=1.6725, vae=1.0901, dsb=0.5824, bio=0.0000

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=32.5627, vae=1.0891, dsb=31.4737, bio=0.0000
    Epoch  2/10: total=31.2775, vae=1.0898, dsb=30.1876, bio=0.0000
    Epoch  3/10: total=31.0856, vae=1.0893, dsb=29.9963, bio=0.0000
    Epoch  4/10: total=30.9180, vae=1.0885, dsb=29.8295, bio=0.0000
    Epoch  5/10: total=30.6176, vae=1.0901, dsb=29.5275, bio=0.0000
    Epoch  6/10: total=30.6451, vae=1.0887, dsb=29.5565, bio=0.0000
    Epoch  7/10: total=30.5605, vae=1.0880, dsb=29.4725, bio=0.0000
    Epoch  8/10: total=30.3751, vae=1.0888, dsb=29.2863, bio=0.0000
    Epoch  9/10: total=30.3860, vae=1.0895, dsb=29.2965, bio=0.0000
    Epoch 10/10: total=30.3282, vae=1.0895, dsb=29.2388, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.5986, vae=1.0887, dsb=0.5099, bio=0.0000
    Epoch  2/10: total=1.5650, vae=1.0896, dsb=0.4754, bio=0.0000
    Epoch  3/10: total=1.5614, vae=1.0895, dsb=0.4719, bio=0.0000
    Epoch  4/10: total=1.5482, vae=1.0893, dsb=0.4589, bio=0.0000
    Epoch  5/10: total=1.5641, vae=1.0892, dsb=0.4749, bio=0.0000
    Epoch  6/10: total=1.5515, vae=1.0890, dsb=0.4625, bio=0.0000
    Epoch  7/10: total=1.5424, vae=1.0890, dsb=0.4534, bio=0.0000
    Epoch  8/10: total=1.5525, vae=1.0890, dsb=0.4635, bio=0.0000
    Epoch  9/10: total=1.5539, vae=1.0890, dsb=0.4649, bio=0.0000
    Epoch 10/10: total=1.5433, vae=1.0888, dsb=0.4545, bio=0.0000

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=27.5580, vae=1.0884, dsb=26.4696, bio=0.0000
    Epoch  2/10: total=27.1451, vae=1.0898, dsb=26.0553, bio=0.0000
    Epoch  3/10: total=26.9108, vae=1.0897, dsb=25.8211, bio=0.0000
    Epoch  4/10: total=26.9128, vae=1.0890, dsb=25.8237, bio=0.0000
    Epoch  5/10: total=26.9401, vae=1.0885, dsb=25.8516, bio=0.0000
    Epoch  6/10: total=26.9307, vae=1.0889, dsb=25.8418, bio=0.0000
    Epoch  7/10: total=26.9014, vae=1.0893, dsb=25.8121, bio=0.0000
    Epoch  8/10: total=26.8785, vae=1.0891, dsb=25.7894, bio=0.0000
    Epoch  9/10: total=26.7402, vae=1.0887, dsb=25.6515, bio=0.0000
    Epoch 10/10: total=26.6473, vae=1.0890, dsb=25.5583, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.4786, vae=1.0895, dsb=0.3891, bio=0.0000
    Epoch  2/10: total=1.4632, vae=1.0891, dsb=0.3740, bio=0.0000
    Epoch  3/10: total=1.4678, vae=1.0890, dsb=0.3788, bio=0.0000
    Epoch  4/10: total=1.4694, vae=1.0887, dsb=0.3807, bio=0.0000
    Epoch  5/10: total=1.4570, vae=1.0892, dsb=0.3678, bio=0.0000
    Epoch  6/10: total=1.4577, vae=1.0887, dsb=0.3690, bio=0.0000
    Epoch  7/10: total=1.4606, vae=1.0888, dsb=0.3719, bio=0.0000
    Epoch  8/10: total=1.4557, vae=1.0884, dsb=0.3673, bio=0.0000
    Epoch  9/10: total=1.4497, vae=1.0882, dsb=0.3615, bio=0.0000
    Epoch 10/10: total=1.4516, vae=1.0889, dsb=0.3628, bio=0.0000

[Seed 15] Joint training (ablation) complete; models and history saved.

[Seed 15] Drift genes saved in /home/yyuan/ICB_TCE/iter_results/run_015

[Seed 15] run finished.

================================================================================
[Seed 16] Starting running whole pipeline...
================================================================================

[Seed 16] Starting VAE pre-training...

    Epoch [01/20], Beta: 0.000, Average Loss: 536.7764
    Epoch [02/20], Beta: 0.000, Average Loss: 304.7895
    Epoch [03/20], Beta: 0.000, Average Loss: 268.3086
    Epoch [04/20], Beta: 0.000, Average Loss: 248.4639
    Epoch [05/20], Beta: 0.100, Average Loss: 244.7167
    Epoch [06/20], Beta: 0.200, Average Loss: 244.0913
    Epoch [07/20], Beta: 0.300, Average Loss: 244.6559
    Epoch [08/20], Beta: 0.400, Average Loss: 245.5124
    Epoch [09/20], Beta: 0.500, Average Loss: 246.4911
    Epoch [10/20], Beta: 0.600, Average Loss: 247.7004
    Epoch [11/20], Beta: 0.700, Average Loss: 249.0621
    Epoch [12/20], Beta: 0.800, Average Loss: 250.3299
    Epoch [13/20], Beta: 0.900, Average Loss: 251.6570
    Epoch [14/20], Beta: 1.000, Average Loss: 253.2486
    Epoch [15/20], Beta: 1.000, Average Loss: 252.8514
    Epoch [16/20], Beta: 1.000, Average Loss: 252.4812
    Epoch [17/20], Beta: 1.000, Average Loss: 252.0941
    Epoch [18/20], Beta: 1.000, Average Loss: 251.8031
    Epoch [19/20], Beta: 1.000, Average Loss: 251.4724
    Epoch [20/20], Beta: 1.000, Average Loss: 251.2547

[Seed 16] VAE pre-training complete.

[Seed 16] Starting joint training (original)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=1082.2476, vae=3.4781, dsb=1067.7977, bio=21.9435
    Epoch  2/10: total=336.7536, vae=1.1044, dsb=335.6111, bio=0.0762
    Epoch  3/10: total=325.7676, vae=1.0994, dsb=324.6522, bio=0.0321
    Epoch  4/10: total=319.5425, vae=1.0973, dsb=318.4358, bio=0.0188
    Epoch  5/10: total=317.5976, vae=1.0961, dsb=316.4953, bio=0.0125
    Epoch  6/10: total=315.1547, vae=1.0963, dsb=314.0537, bio=0.0093
    Epoch  7/10: total=314.5854, vae=1.0958, dsb=313.4859, bio=0.0073
    Epoch  8/10: total=314.5768, vae=1.0955, dsb=313.4783, bio=0.0060
    Epoch  9/10: total=313.0558, vae=1.0949, dsb=311.9583, bio=0.0052
    Epoch 10/10: total=315.5779, vae=1.0938, dsb=314.4817, bio=0.0048

  [Backward Policy Training]
    Epoch  1/10: total=3.9534, vae=1.0955, dsb=2.8496, bio=0.0166
    Epoch  2/10: total=3.3710, vae=1.0940, dsb=2.2743, bio=0.0054
    Epoch  3/10: total=3.2694, vae=1.0937, dsb=2.1738, bio=0.0038
    Epoch  4/10: total=3.1899, vae=1.0936, dsb=2.0948, bio=0.0030
    Epoch  5/10: total=3.1430, vae=1.0928, dsb=2.0489, bio=0.0026
    Epoch  6/10: total=3.1520, vae=1.0937, dsb=2.0571, bio=0.0023
    Epoch  7/10: total=3.0508, vae=1.0921, dsb=1.9575, bio=0.0024
    Epoch  8/10: total=3.0446, vae=1.0930, dsb=1.9506, bio=0.0021
    Epoch  9/10: total=3.0500, vae=1.0926, dsb=1.9564, bio=0.0020
    Epoch 10/10: total=3.0050, vae=1.0919, dsb=1.9121, bio=0.0019

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=283.3077, vae=1.0952, dsb=282.2103, bio=0.0043
    Epoch  2/10: total=278.2602, vae=1.0938, dsb=277.1654, bio=0.0020
    Epoch  3/10: total=277.4907, vae=1.0942, dsb=276.3955, bio=0.0019
    Epoch  4/10: total=276.5998, vae=1.0930, dsb=275.5059, bio=0.0018
    Epoch  5/10: total=277.4236, vae=1.0938, dsb=276.3288, bio=0.0020
    Epoch  6/10: total=276.8246, vae=1.0920, dsb=275.7316, bio=0.0018
    Epoch  7/10: total=276.7786, vae=1.0925, dsb=275.6853, bio=0.0018
    Epoch  8/10: total=276.3703, vae=1.0925, dsb=275.2770, bio=0.0017
    Epoch  9/10: total=278.1042, vae=1.0917, dsb=277.0116, bio=0.0018
    Epoch 10/10: total=275.7047, vae=1.0926, dsb=274.6113, bio=0.0018

  [Backward Policy Training]
    Epoch  1/10: total=2.6313, vae=1.0927, dsb=1.5359, bio=0.0053
    Epoch  2/10: total=2.5197, vae=1.0919, dsb=1.4269, bio=0.0019
    Epoch  3/10: total=2.5011, vae=1.0923, dsb=1.4079, bio=0.0017
    Epoch  4/10: total=2.4964, vae=1.0913, dsb=1.4041, bio=0.0018
    Epoch  5/10: total=2.4308, vae=1.0914, dsb=1.3386, bio=0.0016
    Epoch  6/10: total=2.4647, vae=1.0918, dsb=1.3721, bio=0.0015
    Epoch  7/10: total=2.4354, vae=1.0918, dsb=1.3429, bio=0.0015
    Epoch  8/10: total=2.4144, vae=1.0918, dsb=1.3219, bio=0.0015
    Epoch  9/10: total=2.3962, vae=1.0905, dsb=1.3050, bio=0.0014
    Epoch 10/10: total=2.4606, vae=1.0907, dsb=1.3692, bio=0.0014

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=226.9631, vae=1.0930, dsb=225.8684, bio=0.0033
    Epoch  2/10: total=225.7250, vae=1.0932, dsb=224.6310, bio=0.0016
    Epoch  3/10: total=223.7296, vae=1.0918, dsb=222.6371, bio=0.0015
    Epoch  4/10: total=224.6373, vae=1.0920, dsb=223.5446, bio=0.0015
    Epoch  5/10: total=224.3718, vae=1.0922, dsb=223.2789, bio=0.0015
    Epoch  6/10: total=225.2118, vae=1.0921, dsb=224.1190, bio=0.0015
    Epoch  7/10: total=224.5375, vae=1.0924, dsb=223.4444, bio=0.0015
    Epoch  8/10: total=224.7710, vae=1.0915, dsb=223.6787, bio=0.0015
    Epoch  9/10: total=224.9915, vae=1.0924, dsb=223.8984, bio=0.0015
    Epoch 10/10: total=223.2973, vae=1.0911, dsb=222.2054, bio=0.0015

  [Backward Policy Training]
    Epoch  1/10: total=2.3145, vae=1.0922, dsb=1.2156, bio=0.0133
    Epoch  2/10: total=2.2972, vae=1.0909, dsb=1.2055, bio=0.0015
    Epoch  3/10: total=2.2827, vae=1.0906, dsb=1.1915, bio=0.0013
    Epoch  4/10: total=2.2759, vae=1.0903, dsb=1.1849, bio=0.0012
    Epoch  5/10: total=2.3085, vae=1.0908, dsb=1.2170, bio=0.0014
    Epoch  6/10: total=2.2744, vae=1.0906, dsb=1.1832, bio=0.0012
    Epoch  7/10: total=2.2603, vae=1.0910, dsb=1.1687, bio=0.0012
    Epoch  8/10: total=2.2979, vae=1.0912, dsb=1.2060, bio=0.0012
    Epoch  9/10: total=2.2713, vae=1.0907, dsb=1.1800, bio=0.0012
    Epoch 10/10: total=2.2231, vae=1.0909, dsb=1.1316, bio=0.0012

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=191.5583, vae=1.0932, dsb=190.4637, bio=0.0029
    Epoch  2/10: total=192.0301, vae=1.0913, dsb=190.9382, bio=0.0012
    Epoch  3/10: total=192.4770, vae=1.0917, dsb=191.3847, bio=0.0012
    Epoch  4/10: total=192.3262, vae=1.0911, dsb=191.2344, bio=0.0013
    Epoch  5/10: total=190.3869, vae=1.0919, dsb=189.2943, bio=0.0013
    Epoch  6/10: total=192.0125, vae=1.0917, dsb=190.9202, bio=0.0013
    Epoch  7/10: total=191.6839, vae=1.0912, dsb=190.5921, bio=0.0012
    Epoch  8/10: total=191.8681, vae=1.0912, dsb=190.7762, bio=0.0013
    Epoch  9/10: total=191.7724, vae=1.0911, dsb=190.6808, bio=0.0012
    Epoch 10/10: total=190.4743, vae=1.0908, dsb=189.3830, bio=0.0012

  [Backward Policy Training]
    Epoch  1/10: total=2.1375, vae=1.0923, dsb=1.0095, bio=0.0715
    Epoch  2/10: total=2.0604, vae=1.0912, dsb=0.9685, bio=0.0013
    Epoch  3/10: total=2.0725, vae=1.0906, dsb=0.9813, bio=0.0012
    Epoch  4/10: total=2.0759, vae=1.0907, dsb=0.9845, bio=0.0012
    Epoch  5/10: total=2.1017, vae=1.0903, dsb=1.0109, bio=0.0010
    Epoch  6/10: total=2.0844, vae=1.0909, dsb=0.9930, bio=0.0010
    Epoch  7/10: total=2.0814, vae=1.0902, dsb=0.9906, bio=0.0010
    Epoch  8/10: total=2.0633, vae=1.0904, dsb=0.9724, bio=0.0010
    Epoch  9/10: total=2.0535, vae=1.0901, dsb=0.9629, bio=0.0011
    Epoch 10/10: total=2.0589, vae=1.0901, dsb=0.9683, bio=0.0010

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=164.6221, vae=1.0929, dsb=163.5277, bio=0.0030
    Epoch  2/10: total=164.2741, vae=1.0917, dsb=163.1818, bio=0.0011
    Epoch  3/10: total=165.9780, vae=1.0906, dsb=164.8869, bio=0.0011
    Epoch  4/10: total=165.4832, vae=1.0909, dsb=164.3917, bio=0.0011
    Epoch  5/10: total=165.1054, vae=1.0908, dsb=164.0143, bio=0.0005
    Epoch  6/10: total=166.0985, vae=1.0906, dsb=165.0074, bio=0.0011
    Epoch  7/10: total=164.6981, vae=1.0906, dsb=163.6070, bio=0.0011
    Epoch  8/10: total=166.3373, vae=1.0908, dsb=165.2459, bio=0.0010
    Epoch  9/10: total=164.6144, vae=1.0907, dsb=163.5235, bio=0.0005
    Epoch 10/10: total=164.7137, vae=1.0904, dsb=163.6229, bio=0.0008

  [Backward Policy Training]
    Epoch  1/10: total=2.0632, vae=1.0918, dsb=0.8915, bio=0.1598
    Epoch  2/10: total=1.9889, vae=1.0910, dsb=0.8973, bio=0.0013
    Epoch  3/10: total=1.9601, vae=1.0903, dsb=0.8692, bio=0.0011
    Epoch  4/10: total=1.9579, vae=1.0902, dsb=0.8672, bio=0.0010
    Epoch  5/10: total=1.9765, vae=1.0907, dsb=0.8853, bio=0.0010
    Epoch  6/10: total=1.9978, vae=1.0907, dsb=0.9066, bio=0.0010
    Epoch  7/10: total=1.9736, vae=1.0904, dsb=0.8830, bio=0.0006
    Epoch  8/10: total=1.9825, vae=1.0901, dsb=0.8919, bio=0.0010
    Epoch  9/10: total=1.9656, vae=1.0897, dsb=0.8754, bio=0.0009
    Epoch 10/10: total=1.9544, vae=1.0913, dsb=0.8626, bio=0.0009

[Seed 16] Joint training (original) complete; models and history saved.

[Seed 16] Starting joint training (ablation)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=1068.6616, vae=2.0142, dsb=1066.6474, bio=0.0000
    Epoch  2/10: total=335.4940, vae=1.0864, dsb=334.4076, bio=0.0000
    Epoch  3/10: total=324.8677, vae=1.0852, dsb=323.7825, bio=0.0000
    Epoch  4/10: total=318.7751, vae=1.0841, dsb=317.6910, bio=0.0000
    Epoch  5/10: total=317.1236, vae=1.0832, dsb=316.0403, bio=0.0000
    Epoch  6/10: total=314.8309, vae=1.0838, dsb=313.7471, bio=0.0000
    Epoch  7/10: total=314.3107, vae=1.0837, dsb=313.2270, bio=0.0000
    Epoch  8/10: total=314.3730, vae=1.0837, dsb=313.2893, bio=0.0000
    Epoch  9/10: total=312.8811, vae=1.0833, dsb=311.7978, bio=0.0000
    Epoch 10/10: total=315.4800, vae=1.0825, dsb=314.3974, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=3.6745, vae=1.0830, dsb=2.5915, bio=0.0000
    Epoch  2/10: total=3.1446, vae=1.0832, dsb=2.0615, bio=0.0000
    Epoch  3/10: total=3.0545, vae=1.0833, dsb=1.9712, bio=0.0000
    Epoch  4/10: total=2.9845, vae=1.0835, dsb=1.9009, bio=0.0000
    Epoch  5/10: total=2.9401, vae=1.0829, dsb=1.8572, bio=0.0000
    Epoch  6/10: total=2.9520, vae=1.0839, dsb=1.8681, bio=0.0000
    Epoch  7/10: total=2.8572, vae=1.0825, dsb=1.7747, bio=0.0000
    Epoch  8/10: total=2.8527, vae=1.0835, dsb=1.7692, bio=0.0000
    Epoch  9/10: total=2.8583, vae=1.0831, dsb=1.7752, bio=0.0000
    Epoch 10/10: total=2.8184, vae=1.0825, dsb=1.7358, bio=0.0000

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=278.1437, vae=1.0830, dsb=277.0607, bio=0.0000
    Epoch  2/10: total=273.8682, vae=1.0829, dsb=272.7853, bio=0.0000
    Epoch  3/10: total=272.9064, vae=1.0836, dsb=271.8229, bio=0.0000
    Epoch  4/10: total=271.8551, vae=1.0825, dsb=270.7726, bio=0.0000
    Epoch  5/10: total=273.0728, vae=1.0832, dsb=271.9895, bio=0.0000
    Epoch  6/10: total=272.3705, vae=1.0819, dsb=271.2887, bio=0.0000
    Epoch  7/10: total=272.3215, vae=1.0823, dsb=271.2392, bio=0.0000
    Epoch  8/10: total=272.0347, vae=1.0824, dsb=270.9522, bio=0.0000
    Epoch  9/10: total=273.6432, vae=1.0817, dsb=272.5615, bio=0.0000
    Epoch 10/10: total=271.3344, vae=1.0827, dsb=270.2518, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=2.4448, vae=1.0825, dsb=1.3623, bio=0.0000
    Epoch  2/10: total=2.3517, vae=1.0829, dsb=1.2688, bio=0.0000
    Epoch  3/10: total=2.3388, vae=1.0834, dsb=1.2553, bio=0.0000
    Epoch  4/10: total=2.3364, vae=1.0826, dsb=1.2538, bio=0.0000
    Epoch  5/10: total=2.2800, vae=1.0827, dsb=1.1973, bio=0.0000
    Epoch  6/10: total=2.3112, vae=1.0832, dsb=1.2281, bio=0.0000
    Epoch  7/10: total=2.2865, vae=1.0831, dsb=1.2034, bio=0.0000
    Epoch  8/10: total=2.2666, vae=1.0832, dsb=1.1834, bio=0.0000
    Epoch  9/10: total=2.2508, vae=1.0819, dsb=1.1689, bio=0.0000
    Epoch 10/10: total=2.3101, vae=1.0822, dsb=1.2279, bio=0.0000

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=214.4992, vae=1.0820, dsb=213.4173, bio=0.0000
    Epoch  2/10: total=213.4025, vae=1.0834, dsb=212.3192, bio=0.0000
    Epoch  3/10: total=211.5769, vae=1.0821, dsb=210.4948, bio=0.0000
    Epoch  4/10: total=212.2886, vae=1.0825, dsb=211.2062, bio=0.0000
    Epoch  5/10: total=212.0926, vae=1.0829, dsb=211.0097, bio=0.0000
    Epoch  6/10: total=213.1014, vae=1.0828, dsb=212.0186, bio=0.0000
    Epoch  7/10: total=212.4062, vae=1.0832, dsb=211.3230, bio=0.0000
    Epoch  8/10: total=212.4337, vae=1.0823, dsb=211.3514, bio=0.0000
    Epoch  9/10: total=212.7841, vae=1.0833, dsb=211.7008, bio=0.0000
    Epoch 10/10: total=211.1597, vae=1.0821, dsb=210.0776, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=2.1372, vae=1.0827, dsb=1.0546, bio=0.0000
    Epoch  2/10: total=2.1331, vae=1.0824, dsb=1.0506, bio=0.0000
    Epoch  3/10: total=2.1228, vae=1.0823, dsb=1.0404, bio=0.0000
    Epoch  4/10: total=2.1172, vae=1.0820, dsb=1.0352, bio=0.0000
    Epoch  5/10: total=2.1480, vae=1.0827, dsb=1.0653, bio=0.0000
    Epoch  6/10: total=2.1181, vae=1.0825, dsb=1.0356, bio=0.0000
    Epoch  7/10: total=2.1070, vae=1.0829, dsb=1.0241, bio=0.0000
    Epoch  8/10: total=2.1402, vae=1.0831, dsb=1.0570, bio=0.0000
    Epoch  9/10: total=2.1165, vae=1.0826, dsb=1.0338, bio=0.0000
    Epoch 10/10: total=2.0740, vae=1.0829, dsb=0.9911, bio=0.0000

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=180.9782, vae=1.0825, dsb=179.8957, bio=0.0000
    Epoch  2/10: total=181.6389, vae=1.0820, dsb=180.5569, bio=0.0000
    Epoch  3/10: total=182.0356, vae=1.0826, dsb=180.9530, bio=0.0000
    Epoch  4/10: total=181.9201, vae=1.0823, dsb=180.8378, bio=0.0000
    Epoch  5/10: total=180.1833, vae=1.0832, dsb=179.1001, bio=0.0000
    Epoch  6/10: total=181.6897, vae=1.0830, dsb=180.6067, bio=0.0000
    Epoch  7/10: total=181.5425, vae=1.0827, dsb=180.4598, bio=0.0000
    Epoch  8/10: total=181.6739, vae=1.0829, dsb=180.5910, bio=0.0000
    Epoch  9/10: total=181.5252, vae=1.0828, dsb=180.4425, bio=0.0000
    Epoch 10/10: total=180.3024, vae=1.0826, dsb=179.2198, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.9584, vae=1.0832, dsb=0.8752, bio=0.0000
    Epoch  2/10: total=1.9251, vae=1.0831, dsb=0.8420, bio=0.0000
    Epoch  3/10: total=1.9368, vae=1.0827, dsb=0.8541, bio=0.0000
    Epoch  4/10: total=1.9404, vae=1.0828, dsb=0.8576, bio=0.0000
    Epoch  5/10: total=1.9639, vae=1.0825, dsb=0.8814, bio=0.0000
    Epoch  6/10: total=1.9491, vae=1.0831, dsb=0.8660, bio=0.0000
    Epoch  7/10: total=1.9466, vae=1.0825, dsb=0.8641, bio=0.0000
    Epoch  8/10: total=1.9309, vae=1.0827, dsb=0.8483, bio=0.0000
    Epoch  9/10: total=1.9231, vae=1.0824, dsb=0.8407, bio=0.0000
    Epoch 10/10: total=1.9272, vae=1.0824, dsb=0.8447, bio=0.0000

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=151.9375, vae=1.0822, dsb=150.8553, bio=0.0000
    Epoch  2/10: total=151.7429, vae=1.0829, dsb=150.6600, bio=0.0000
    Epoch  3/10: total=153.1471, vae=1.0821, dsb=152.0650, bio=0.0000
    Epoch  4/10: total=152.7857, vae=1.0827, dsb=151.7030, bio=0.0000
    Epoch  5/10: total=152.4227, vae=1.0827, dsb=151.3400, bio=0.0000
    Epoch  6/10: total=153.3922, vae=1.0827, dsb=152.3096, bio=0.0000
    Epoch  7/10: total=152.0480, vae=1.0828, dsb=150.9652, bio=0.0000
    Epoch  8/10: total=153.5280, vae=1.0830, dsb=152.4450, bio=0.0000
    Epoch  9/10: total=152.0718, vae=1.0828, dsb=150.9890, bio=0.0000
    Epoch 10/10: total=152.0198, vae=1.0827, dsb=150.9371, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.8494, vae=1.0827, dsb=0.7667, bio=0.0000
    Epoch  2/10: total=1.8554, vae=1.0831, dsb=0.7724, bio=0.0000
    Epoch  3/10: total=1.8312, vae=1.0827, dsb=0.7485, bio=0.0000
    Epoch  4/10: total=1.8292, vae=1.0826, dsb=0.7466, bio=0.0000
    Epoch  5/10: total=1.8460, vae=1.0832, dsb=0.7628, bio=0.0000
    Epoch  6/10: total=1.8650, vae=1.0831, dsb=0.7818, bio=0.0000
    Epoch  7/10: total=1.8441, vae=1.0828, dsb=0.7612, bio=0.0000
    Epoch  8/10: total=1.8520, vae=1.0827, dsb=0.7693, bio=0.0000
    Epoch  9/10: total=1.8376, vae=1.0823, dsb=0.7553, bio=0.0000
    Epoch 10/10: total=1.8274, vae=1.0839, dsb=0.7435, bio=0.0000

[Seed 16] Joint training (ablation) complete; models and history saved.

[Seed 16] Drift genes saved in /home/yyuan/ICB_TCE/iter_results/run_016

[Seed 16] run finished.

================================================================================
[Seed 17] Starting running whole pipeline...
================================================================================

[Seed 17] Starting VAE pre-training...

    Epoch [01/20], Beta: 0.000, Average Loss: 537.2680
    Epoch [02/20], Beta: 0.000, Average Loss: 303.6908
    Epoch [03/20], Beta: 0.000, Average Loss: 268.2834
    Epoch [04/20], Beta: 0.000, Average Loss: 251.4903
    Epoch [05/20], Beta: 0.100, Average Loss: 246.4908
    Epoch [06/20], Beta: 0.200, Average Loss: 245.4911
    Epoch [07/20], Beta: 0.300, Average Loss: 245.6181
    Epoch [08/20], Beta: 0.400, Average Loss: 246.1441
    Epoch [09/20], Beta: 0.500, Average Loss: 247.0717
    Epoch [10/20], Beta: 0.600, Average Loss: 248.2523
    Epoch [11/20], Beta: 0.700, Average Loss: 249.5150
    Epoch [12/20], Beta: 0.800, Average Loss: 250.8533
    Epoch [13/20], Beta: 0.900, Average Loss: 252.1134
    Epoch [14/20], Beta: 1.000, Average Loss: 253.7579
    Epoch [15/20], Beta: 1.000, Average Loss: 253.3252
    Epoch [16/20], Beta: 1.000, Average Loss: 252.8956
    Epoch [17/20], Beta: 1.000, Average Loss: 252.5537
    Epoch [18/20], Beta: 1.000, Average Loss: 252.2201
    Epoch [19/20], Beta: 1.000, Average Loss: 251.8714
    Epoch [20/20], Beta: 1.000, Average Loss: 251.6754

[Seed 17] VAE pre-training complete.

[Seed 17] Starting joint training (original)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=272.8676, vae=3.6175, dsb=251.1631, bio=36.1740
    Epoch  2/10: total=81.6311, vae=1.1160, dsb=80.4745, bio=0.0812
    Epoch  3/10: total=70.6564, vae=1.1114, dsb=69.5275, bio=0.0350
    Epoch  4/10: total=65.4193, vae=1.1101, dsb=64.2990, bio=0.0205
    Epoch  5/10: total=61.8396, vae=1.1086, dsb=60.7241, bio=0.0139
    Epoch  6/10: total=60.0398, vae=1.1085, dsb=58.9263, bio=0.0101
    Epoch  7/10: total=58.5992, vae=1.1086, dsb=57.4866, bio=0.0078
    Epoch  8/10: total=57.5226, vae=1.1078, dsb=56.4116, bio=0.0063
    Epoch  9/10: total=56.6616, vae=1.1087, dsb=55.5503, bio=0.0054
    Epoch 10/10: total=55.4593, vae=1.1081, dsb=54.3487, bio=0.0050

  [Backward Policy Training]
    Epoch  1/10: total=3.3956, vae=1.1071, dsb=2.2812, bio=0.0144
    Epoch  2/10: total=2.8304, vae=1.1063, dsb=1.7216, bio=0.0050
    Epoch  3/10: total=2.7416, vae=1.1067, dsb=1.6331, bio=0.0037
    Epoch  4/10: total=2.6650, vae=1.1057, dsb=1.5577, bio=0.0031
    Epoch  5/10: total=2.6009, vae=1.1054, dsb=1.4942, bio=0.0027
    Epoch  6/10: total=2.5901, vae=1.1048, dsb=1.4840, bio=0.0025
    Epoch  7/10: total=2.5298, vae=1.1051, dsb=1.4235, bio=0.0025
    Epoch  8/10: total=2.5308, vae=1.1053, dsb=1.4244, bio=0.0024
    Epoch  9/10: total=2.5379, vae=1.1056, dsb=1.4312, bio=0.0022
    Epoch 10/10: total=2.5039, vae=1.1048, dsb=1.3981, bio=0.0022

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=53.4553, vae=1.1074, dsb=52.3461, bio=0.0037
    Epoch  2/10: total=46.0269, vae=1.1059, dsb=44.9199, bio=0.0022
    Epoch  3/10: total=44.3524, vae=1.1061, dsb=43.2453, bio=0.0021
    Epoch  4/10: total=43.3850, vae=1.1067, dsb=42.2769, bio=0.0027
    Epoch  5/10: total=42.6158, vae=1.1052, dsb=41.5096, bio=0.0021
    Epoch  6/10: total=42.4594, vae=1.1047, dsb=41.3536, bio=0.0020
    Epoch  7/10: total=41.8753, vae=1.1049, dsb=40.7693, bio=0.0020
    Epoch  8/10: total=41.7682, vae=1.1038, dsb=40.6634, bio=0.0020
    Epoch  9/10: total=41.0447, vae=1.1053, dsb=39.9384, bio=0.0021
    Epoch 10/10: total=40.9606, vae=1.1054, dsb=39.8539, bio=0.0026

  [Backward Policy Training]
    Epoch  1/10: total=2.2411, vae=1.1063, dsb=1.1321, bio=0.0055
    Epoch  2/10: total=2.0996, vae=1.1044, dsb=0.9942, bio=0.0022
    Epoch  3/10: total=2.0512, vae=1.1030, dsb=0.9473, bio=0.0020
    Epoch  4/10: total=2.0241, vae=1.1040, dsb=0.9192, bio=0.0019
    Epoch  5/10: total=2.0111, vae=1.1038, dsb=0.9064, bio=0.0018
    Epoch  6/10: total=2.0034, vae=1.1023, dsb=0.9000, bio=0.0023
    Epoch  7/10: total=1.9924, vae=1.1037, dsb=0.8877, bio=0.0019
    Epoch  8/10: total=1.9815, vae=1.1027, dsb=0.8779, bio=0.0018
    Epoch  9/10: total=1.9804, vae=1.1037, dsb=0.8758, bio=0.0018
    Epoch 10/10: total=1.9610, vae=1.1033, dsb=0.8568, bio=0.0018

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=39.4006, vae=1.1067, dsb=38.2923, bio=0.0033
    Epoch  2/10: total=36.1980, vae=1.1052, dsb=35.0919, bio=0.0018
    Epoch  3/10: total=35.5074, vae=1.1046, dsb=34.4018, bio=0.0019
    Epoch  4/10: total=35.0101, vae=1.1042, dsb=33.9050, bio=0.0019
    Epoch  5/10: total=34.6882, vae=1.1048, dsb=33.5826, bio=0.0018
    Epoch  6/10: total=34.4969, vae=1.1046, dsb=33.3914, bio=0.0018
    Epoch  7/10: total=34.2475, vae=1.1039, dsb=33.1426, bio=0.0019
    Epoch  8/10: total=34.1546, vae=1.1035, dsb=33.0501, bio=0.0019
    Epoch  9/10: total=33.9396, vae=1.1040, dsb=32.8345, bio=0.0021
    Epoch 10/10: total=33.9346, vae=1.1045, dsb=32.8294, bio=0.0016

  [Backward Policy Training]
    Epoch  1/10: total=1.8595, vae=1.1050, dsb=0.7512, bio=0.0067
    Epoch  2/10: total=1.7679, vae=1.1025, dsb=0.6644, bio=0.0019
    Epoch  3/10: total=1.7660, vae=1.1038, dsb=0.6613, bio=0.0017
    Epoch  4/10: total=1.7635, vae=1.1037, dsb=0.6590, bio=0.0017
    Epoch  5/10: total=1.7383, vae=1.1037, dsb=0.6338, bio=0.0017
    Epoch  6/10: total=1.7519, vae=1.1021, dsb=0.6490, bio=0.0016
    Epoch  7/10: total=1.7255, vae=1.1029, dsb=0.6217, bio=0.0018
    Epoch  8/10: total=1.7238, vae=1.1027, dsb=0.6203, bio=0.0015
    Epoch  9/10: total=1.7395, vae=1.1030, dsb=0.6357, bio=0.0016
    Epoch 10/10: total=1.7123, vae=1.1026, dsb=0.6089, bio=0.0016

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=32.4503, vae=1.1066, dsb=31.3412, bio=0.0052
    Epoch  2/10: total=31.0442, vae=1.1053, dsb=29.9380, bio=0.0017
    Epoch  3/10: total=30.8349, vae=1.1038, dsb=29.7301, bio=0.0017
    Epoch  4/10: total=30.5254, vae=1.1046, dsb=29.4200, bio=0.0015
    Epoch  5/10: total=30.3201, vae=1.1042, dsb=29.2150, bio=0.0018
    Epoch  6/10: total=30.4716, vae=1.1040, dsb=29.3667, bio=0.0017
    Epoch  7/10: total=30.3424, vae=1.1040, dsb=29.2376, bio=0.0017
    Epoch  8/10: total=30.2870, vae=1.1039, dsb=29.1822, bio=0.0017
    Epoch  9/10: total=30.2906, vae=1.1038, dsb=29.1860, bio=0.0017
    Epoch 10/10: total=30.2284, vae=1.1043, dsb=29.1233, bio=0.0018

  [Backward Policy Training]
    Epoch  1/10: total=1.6665, vae=1.1043, dsb=0.5561, bio=0.0123
    Epoch  2/10: total=1.6291, vae=1.1033, dsb=0.5250, bio=0.0017
    Epoch  3/10: total=1.6093, vae=1.1032, dsb=0.5054, bio=0.0015
    Epoch  4/10: total=1.6142, vae=1.1028, dsb=0.5107, bio=0.0015
    Epoch  5/10: total=1.6022, vae=1.1026, dsb=0.4988, bio=0.0015
    Epoch  6/10: total=1.6182, vae=1.1031, dsb=0.5144, bio=0.0015
    Epoch  7/10: total=1.6069, vae=1.1019, dsb=0.5043, bio=0.0014
    Epoch  8/10: total=1.6057, vae=1.1025, dsb=0.5025, bio=0.0014
    Epoch  9/10: total=1.5995, vae=1.1021, dsb=0.4967, bio=0.0014
    Epoch 10/10: total=1.5937, vae=1.1021, dsb=0.4909, bio=0.0014

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=25.0689, vae=1.1044, dsb=23.9614, bio=0.0061
    Epoch  2/10: total=24.3680, vae=1.1047, dsb=23.2626, bio=0.0015
    Epoch  3/10: total=24.4664, vae=1.1038, dsb=23.3618, bio=0.0016
    Epoch  4/10: total=24.1974, vae=1.1036, dsb=23.0930, bio=0.0017
    Epoch  5/10: total=24.1729, vae=1.1035, dsb=23.0686, bio=0.0015
    Epoch  6/10: total=24.1859, vae=1.1043, dsb=23.0808, bio=0.0015
    Epoch  7/10: total=24.1720, vae=1.1030, dsb=23.0682, bio=0.0016
    Epoch  8/10: total=24.0427, vae=1.1043, dsb=22.9376, bio=0.0016
    Epoch  9/10: total=23.8882, vae=1.1042, dsb=22.7832, bio=0.0016
    Epoch 10/10: total=23.9902, vae=1.1040, dsb=22.8854, bio=0.0015

  [Backward Policy Training]
    Epoch  1/10: total=1.5460, vae=1.1040, dsb=0.4253, bio=0.0334
    Epoch  2/10: total=1.5110, vae=1.1024, dsb=0.4078, bio=0.0015
    Epoch  3/10: total=1.5213, vae=1.1037, dsb=0.4170, bio=0.0014
    Epoch  4/10: total=1.5311, vae=1.1031, dsb=0.4273, bio=0.0014
    Epoch  5/10: total=1.5095, vae=1.1027, dsb=0.4061, bio=0.0014
    Epoch  6/10: total=1.5076, vae=1.1027, dsb=0.4043, bio=0.0013
    Epoch  7/10: total=1.5106, vae=1.1020, dsb=0.4079, bio=0.0013
    Epoch  8/10: total=1.5173, vae=1.1029, dsb=0.4137, bio=0.0013
    Epoch  9/10: total=1.5210, vae=1.1022, dsb=0.4181, bio=0.0013
    Epoch 10/10: total=1.5113, vae=1.1019, dsb=0.4087, bio=0.0013

[Seed 17] Joint training (original) complete; models and history saved.

[Seed 17] Starting joint training (ablation)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=252.6323, vae=1.9910, dsb=250.6413, bio=0.0000
    Epoch  2/10: total=80.9874, vae=1.0995, dsb=79.8879, bio=0.0000
    Epoch  3/10: total=70.2206, vae=1.0974, dsb=69.1232, bio=0.0000
    Epoch  4/10: total=65.1052, vae=1.0969, dsb=64.0083, bio=0.0000
    Epoch  5/10: total=61.6592, vae=1.0958, dsb=60.5634, bio=0.0000
    Epoch  6/10: total=59.8179, vae=1.0960, dsb=58.7220, bio=0.0000
    Epoch  7/10: total=58.3595, vae=1.0964, dsb=57.2631, bio=0.0000
    Epoch  8/10: total=57.2605, vae=1.0959, dsb=56.1647, bio=0.0000
    Epoch  9/10: total=56.3884, vae=1.0970, dsb=55.2913, bio=0.0000
    Epoch 10/10: total=55.1796, vae=1.0966, dsb=54.0830, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=3.3363, vae=1.0947, dsb=2.2416, bio=0.0000
    Epoch  2/10: total=2.7855, vae=1.0954, dsb=1.6901, bio=0.0000
    Epoch  3/10: total=2.6989, vae=1.0962, dsb=1.6028, bio=0.0000
    Epoch  4/10: total=2.6201, vae=1.0955, dsb=1.5246, bio=0.0000
    Epoch  5/10: total=2.5577, vae=1.0954, dsb=1.4624, bio=0.0000
    Epoch  6/10: total=2.5477, vae=1.0949, dsb=1.4528, bio=0.0000
    Epoch  7/10: total=2.4882, vae=1.0953, dsb=1.3929, bio=0.0000
    Epoch  8/10: total=2.4878, vae=1.0956, dsb=1.3922, bio=0.0000
    Epoch  9/10: total=2.4953, vae=1.0961, dsb=1.3992, bio=0.0000
    Epoch 10/10: total=2.4615, vae=1.0953, dsb=1.3662, bio=0.0000

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=52.5207, vae=1.0952, dsb=51.4255, bio=0.0000
    Epoch  2/10: total=45.1123, vae=1.0949, dsb=44.0174, bio=0.0000
    Epoch  3/10: total=43.5219, vae=1.0953, dsb=42.4266, bio=0.0000
    Epoch  4/10: total=42.5404, vae=1.0960, dsb=41.4444, bio=0.0000
    Epoch  5/10: total=41.7619, vae=1.0947, dsb=40.6672, bio=0.0000
    Epoch  6/10: total=41.6453, vae=1.0944, dsb=40.5509, bio=0.0000
    Epoch  7/10: total=41.0732, vae=1.0946, dsb=39.9786, bio=0.0000
    Epoch  8/10: total=41.0182, vae=1.0936, dsb=39.9246, bio=0.0000
    Epoch  9/10: total=40.3145, vae=1.0952, dsb=39.2193, bio=0.0000
    Epoch 10/10: total=40.2693, vae=1.0952, dsb=39.1741, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=2.1869, vae=1.0951, dsb=1.0918, bio=0.0000
    Epoch  2/10: total=2.0539, vae=1.0951, dsb=0.9588, bio=0.0000
    Epoch  3/10: total=2.0086, vae=1.0939, dsb=0.9147, bio=0.0000
    Epoch  4/10: total=1.9828, vae=1.0951, dsb=0.8877, bio=0.0000
    Epoch  5/10: total=1.9702, vae=1.0949, dsb=0.8753, bio=0.0000
    Epoch  6/10: total=1.9628, vae=1.0935, dsb=0.8693, bio=0.0000
    Epoch  7/10: total=1.9527, vae=1.0950, dsb=0.8576, bio=0.0000
    Epoch  8/10: total=1.9419, vae=1.0941, dsb=0.8478, bio=0.0000
    Epoch  9/10: total=1.9408, vae=1.0951, dsb=0.8457, bio=0.0000
    Epoch 10/10: total=1.9227, vae=1.0946, dsb=0.8281, bio=0.0000

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=38.4206, vae=1.0954, dsb=37.3252, bio=0.0000
    Epoch  2/10: total=35.4463, vae=1.0950, dsb=34.3513, bio=0.0000
    Epoch  3/10: total=34.8901, vae=1.0947, dsb=33.7954, bio=0.0000
    Epoch  4/10: total=34.4296, vae=1.0945, dsb=33.3351, bio=0.0000
    Epoch  5/10: total=34.1256, vae=1.0951, dsb=33.0305, bio=0.0000
    Epoch  6/10: total=33.8860, vae=1.0950, dsb=32.7910, bio=0.0000
    Epoch  7/10: total=33.6150, vae=1.0944, dsb=32.5206, bio=0.0000
    Epoch  8/10: total=33.5173, vae=1.0941, dsb=32.4232, bio=0.0000
    Epoch  9/10: total=33.3809, vae=1.0945, dsb=32.2864, bio=0.0000
    Epoch 10/10: total=33.3539, vae=1.0950, dsb=32.2588, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.8174, vae=1.0950, dsb=0.7224, bio=0.0000
    Epoch  2/10: total=1.7347, vae=1.0940, dsb=0.6407, bio=0.0000
    Epoch  3/10: total=1.7326, vae=1.0954, dsb=0.6372, bio=0.0000
    Epoch  4/10: total=1.7309, vae=1.0953, dsb=0.6356, bio=0.0000
    Epoch  5/10: total=1.7065, vae=1.0956, dsb=0.6109, bio=0.0000
    Epoch  6/10: total=1.7198, vae=1.0940, dsb=0.6258, bio=0.0000
    Epoch  7/10: total=1.6933, vae=1.0949, dsb=0.5985, bio=0.0000
    Epoch  8/10: total=1.6921, vae=1.0948, dsb=0.5973, bio=0.0000
    Epoch  9/10: total=1.7075, vae=1.0951, dsb=0.6123, bio=0.0000
    Epoch 10/10: total=1.6802, vae=1.0948, dsb=0.5854, bio=0.0000

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=31.8649, vae=1.0956, dsb=30.7693, bio=0.0000
    Epoch  2/10: total=30.4858, vae=1.0957, dsb=29.3902, bio=0.0000
    Epoch  3/10: total=30.2424, vae=1.0944, dsb=29.1480, bio=0.0000
    Epoch  4/10: total=29.9536, vae=1.0953, dsb=28.8583, bio=0.0000
    Epoch  5/10: total=29.7479, vae=1.0951, dsb=28.6529, bio=0.0000
    Epoch  6/10: total=29.8994, vae=1.0950, dsb=28.8045, bio=0.0000
    Epoch  7/10: total=29.7735, vae=1.0949, dsb=28.6785, bio=0.0000
    Epoch  8/10: total=29.7126, vae=1.0949, dsb=28.6177, bio=0.0000
    Epoch  9/10: total=29.7041, vae=1.0948, dsb=28.6092, bio=0.0000
    Epoch 10/10: total=29.6478, vae=1.0954, dsb=28.5524, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.6211, vae=1.0951, dsb=0.5259, bio=0.0000
    Epoch  2/10: total=1.5904, vae=1.0951, dsb=0.4953, bio=0.0000
    Epoch  3/10: total=1.5712, vae=1.0952, dsb=0.4760, bio=0.0000
    Epoch  4/10: total=1.5759, vae=1.0949, dsb=0.4810, bio=0.0000
    Epoch  5/10: total=1.5643, vae=1.0947, dsb=0.4696, bio=0.0000
    Epoch  6/10: total=1.5799, vae=1.0954, dsb=0.4844, bio=0.0000
    Epoch  7/10: total=1.5683, vae=1.0943, dsb=0.4741, bio=0.0000
    Epoch  8/10: total=1.5673, vae=1.0950, dsb=0.4724, bio=0.0000
    Epoch  9/10: total=1.5607, vae=1.0946, dsb=0.4661, bio=0.0000
    Epoch 10/10: total=1.5552, vae=1.0947, dsb=0.4605, bio=0.0000

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=24.1104, vae=1.0942, dsb=23.0162, bio=0.0000
    Epoch  2/10: total=23.4183, vae=1.0954, dsb=22.3230, bio=0.0000
    Epoch  3/10: total=23.4954, vae=1.0947, dsb=22.4007, bio=0.0000
    Epoch  4/10: total=23.3017, vae=1.0946, dsb=22.2070, bio=0.0000
    Epoch  5/10: total=23.2538, vae=1.0947, dsb=22.1591, bio=0.0000
    Epoch  6/10: total=23.2745, vae=1.0955, dsb=22.1789, bio=0.0000
    Epoch  7/10: total=23.2572, vae=1.0944, dsb=22.1628, bio=0.0000
    Epoch  8/10: total=23.1259, vae=1.0957, dsb=22.0301, bio=0.0000
    Epoch  9/10: total=23.0200, vae=1.0956, dsb=21.9243, bio=0.0000
    Epoch 10/10: total=23.0727, vae=1.0956, dsb=21.9771, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.4915, vae=1.0948, dsb=0.3966, bio=0.0000
    Epoch  2/10: total=1.4747, vae=1.0944, dsb=0.3803, bio=0.0000
    Epoch  3/10: total=1.4851, vae=1.0958, dsb=0.3893, bio=0.0000
    Epoch  4/10: total=1.4949, vae=1.0952, dsb=0.3996, bio=0.0000
    Epoch  5/10: total=1.4739, vae=1.0949, dsb=0.3790, bio=0.0000
    Epoch  6/10: total=1.4721, vae=1.0949, dsb=0.3772, bio=0.0000
    Epoch  7/10: total=1.4754, vae=1.0945, dsb=0.3809, bio=0.0000
    Epoch  8/10: total=1.4823, vae=1.0955, dsb=0.3868, bio=0.0000
    Epoch  9/10: total=1.4857, vae=1.0950, dsb=0.3908, bio=0.0000
    Epoch 10/10: total=1.4769, vae=1.0949, dsb=0.3820, bio=0.0000

[Seed 17] Joint training (ablation) complete; models and history saved.

[Seed 17] Drift genes saved in /home/yyuan/ICB_TCE/iter_results/run_017

[Seed 17] run finished.

================================================================================
[Seed 18] Starting running whole pipeline...
================================================================================

[Seed 18] Starting VAE pre-training...

    Epoch [01/20], Beta: 0.000, Average Loss: 535.3667
    Epoch [02/20], Beta: 0.000, Average Loss: 305.7045
    Epoch [03/20], Beta: 0.000, Average Loss: 269.5169
    Epoch [04/20], Beta: 0.000, Average Loss: 250.1598
    Epoch [05/20], Beta: 0.100, Average Loss: 245.5698
    Epoch [06/20], Beta: 0.200, Average Loss: 245.0145
    Epoch [07/20], Beta: 0.300, Average Loss: 245.6118
    Epoch [08/20], Beta: 0.400, Average Loss: 246.2904
    Epoch [09/20], Beta: 0.500, Average Loss: 247.1341
    Epoch [10/20], Beta: 0.600, Average Loss: 248.2340
    Epoch [11/20], Beta: 0.700, Average Loss: 249.4418
    Epoch [12/20], Beta: 0.800, Average Loss: 250.6810
    Epoch [13/20], Beta: 0.900, Average Loss: 251.8833
    Epoch [14/20], Beta: 1.000, Average Loss: 253.4988
    Epoch [15/20], Beta: 1.000, Average Loss: 253.0528
    Epoch [16/20], Beta: 1.000, Average Loss: 252.7266
    Epoch [17/20], Beta: 1.000, Average Loss: 252.3373
    Epoch [18/20], Beta: 1.000, Average Loss: 251.9749
    Epoch [19/20], Beta: 1.000, Average Loss: 251.6440
    Epoch [20/20], Beta: 1.000, Average Loss: 251.4110

[Seed 18] VAE pre-training complete.

[Seed 18] Starting joint training (original)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=330.4912, vae=3.6486, dsb=311.7459, bio=30.1936
    Epoch  2/10: total=112.6082, vae=1.0969, dsb=111.4750, bio=0.0728
    Epoch  3/10: total=95.5933, vae=1.0915, dsb=94.4859, bio=0.0318
    Epoch  4/10: total=87.8211, vae=1.0902, dsb=86.7214, bio=0.0189
    Epoch  5/10: total=83.2852, vae=1.0884, dsb=82.1904, bio=0.0126
    Epoch  6/10: total=80.1673, vae=1.0885, dsb=79.0743, bio=0.0090
    Epoch  7/10: total=78.1148, vae=1.0874, dsb=77.0240, bio=0.0069
    Epoch  8/10: total=76.3065, vae=1.0872, dsb=75.2165, bio=0.0056
    Epoch  9/10: total=74.8640, vae=1.0872, dsb=73.7745, bio=0.0046
    Epoch 10/10: total=73.7311, vae=1.0867, dsb=72.6422, bio=0.0044

  [Backward Policy Training]
    Epoch  1/10: total=3.6317, vae=1.0886, dsb=2.5371, bio=0.0120
    Epoch  2/10: total=2.9877, vae=1.0864, dsb=1.8992, bio=0.0042
    Epoch  3/10: total=2.8416, vae=1.0853, dsb=1.7548, bio=0.0030
    Epoch  4/10: total=2.7113, vae=1.0856, dsb=1.6244, bio=0.0025
    Epoch  5/10: total=2.6842, vae=1.0846, dsb=1.5985, bio=0.0022
    Epoch  6/10: total=2.6105, vae=1.0848, dsb=1.5246, bio=0.0022
    Epoch  7/10: total=2.5690, vae=1.0845, dsb=1.4834, bio=0.0020
    Epoch  8/10: total=2.5849, vae=1.0839, dsb=1.5000, bio=0.0019
    Epoch  9/10: total=2.5649, vae=1.0843, dsb=1.4797, bio=0.0018
    Epoch 10/10: total=2.5236, vae=1.0843, dsb=1.4385, bio=0.0018

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=70.2570, vae=1.0868, dsb=69.1684, bio=0.0035
    Epoch  2/10: total=60.5354, vae=1.0863, dsb=59.4483, bio=0.0017
    Epoch  3/10: total=57.4961, vae=1.0857, dsb=56.4095, bio=0.0017
    Epoch  4/10: total=56.0224, vae=1.0856, dsb=54.9360, bio=0.0017
    Epoch  5/10: total=55.1329, vae=1.0855, dsb=54.0465, bio=0.0017
    Epoch  6/10: total=54.5217, vae=1.0845, dsb=53.4362, bio=0.0019
    Epoch  7/10: total=53.9146, vae=1.0854, dsb=52.8283, bio=0.0016
    Epoch  8/10: total=53.5030, vae=1.0854, dsb=52.4168, bio=0.0016
    Epoch  9/10: total=53.1693, vae=1.0854, dsb=52.0831, bio=0.0016
    Epoch 10/10: total=52.8352, vae=1.0841, dsb=51.7502, bio=0.0016

  [Backward Policy Training]
    Epoch  1/10: total=2.3175, vae=1.0847, dsb=1.2295, bio=0.0067
    Epoch  2/10: total=2.1661, vae=1.0838, dsb=1.0814, bio=0.0017
    Epoch  3/10: total=2.1119, vae=1.0838, dsb=1.0274, bio=0.0015
    Epoch  4/10: total=2.0931, vae=1.0834, dsb=1.0089, bio=0.0016
    Epoch  5/10: total=2.0519, vae=1.0844, dsb=0.9668, bio=0.0016
    Epoch  6/10: total=2.0495, vae=1.0823, dsb=0.9666, bio=0.0014
    Epoch  7/10: total=2.0340, vae=1.0836, dsb=0.9497, bio=0.0013
    Epoch  8/10: total=2.0163, vae=1.0835, dsb=0.9321, bio=0.0013
    Epoch  9/10: total=2.0010, vae=1.0836, dsb=0.9167, bio=0.0013
    Epoch 10/10: total=1.9825, vae=1.0840, dsb=0.8979, bio=0.0012

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=49.6283, vae=1.0850, dsb=48.5419, bio=0.0029
    Epoch  2/10: total=45.4470, vae=1.0851, dsb=44.3612, bio=0.0014
    Epoch  3/10: total=44.2656, vae=1.0845, dsb=43.1804, bio=0.0014
    Epoch  4/10: total=43.3264, vae=1.0846, dsb=42.2411, bio=0.0014
    Epoch  5/10: total=43.1055, vae=1.0832, dsb=42.0215, bio=0.0014
    Epoch  6/10: total=42.9515, vae=1.0840, dsb=41.8669, bio=0.0014
    Epoch  7/10: total=42.5882, vae=1.0838, dsb=41.5037, bio=0.0015
    Epoch  8/10: total=42.3737, vae=1.0846, dsb=41.2885, bio=0.0013
    Epoch  9/10: total=42.3617, vae=1.0828, dsb=41.2782, bio=0.0013
    Epoch 10/10: total=42.1939, vae=1.0836, dsb=41.1096, bio=0.0013

  [Backward Policy Training]
    Epoch  1/10: total=1.8756, vae=1.0836, dsb=0.7730, bio=0.0380
    Epoch  2/10: total=1.7910, vae=1.0827, dsb=0.7076, bio=0.0014
    Epoch  3/10: total=1.7682, vae=1.0835, dsb=0.6840, bio=0.0012
    Epoch  4/10: total=1.7781, vae=1.0831, dsb=0.6943, bio=0.0014
    Epoch  5/10: total=1.7699, vae=1.0831, dsb=0.6862, bio=0.0011
    Epoch  6/10: total=1.7495, vae=1.0830, dsb=0.6660, bio=0.0011
    Epoch  7/10: total=1.7278, vae=1.0828, dsb=0.6444, bio=0.0011
    Epoch  8/10: total=1.7296, vae=1.0819, dsb=0.6472, bio=0.0011
    Epoch  9/10: total=1.7428, vae=1.0826, dsb=0.6595, bio=0.0011
    Epoch 10/10: total=1.7329, vae=1.0833, dsb=0.6490, bio=0.0011

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=39.0575, vae=1.0862, dsb=37.9699, bio=0.0029
    Epoch  2/10: total=36.8058, vae=1.0846, dsb=35.7206, bio=0.0012
    Epoch  3/10: total=36.6564, vae=1.0839, dsb=35.5719, bio=0.0012
    Epoch  4/10: total=36.2627, vae=1.0838, dsb=35.1783, bio=0.0012
    Epoch  5/10: total=36.1668, vae=1.0829, dsb=35.0833, bio=0.0012
    Epoch  6/10: total=35.9457, vae=1.0829, dsb=34.8622, bio=0.0012
    Epoch  7/10: total=36.1650, vae=1.0832, dsb=35.0812, bio=0.0011
    Epoch  8/10: total=35.6506, vae=1.0829, dsb=34.5671, bio=0.0011
    Epoch  9/10: total=35.6706, vae=1.0826, dsb=34.5875, bio=0.0011
    Epoch 10/10: total=35.6373, vae=1.0827, dsb=34.5541, bio=0.0011

  [Backward Policy Training]
    Epoch  1/10: total=1.7296, vae=1.0832, dsb=0.5859, bio=0.1209
    Epoch  2/10: total=1.6279, vae=1.0823, dsb=0.5450, bio=0.0012
    Epoch  3/10: total=1.6150, vae=1.0827, dsb=0.5318, bio=0.0008
    Epoch  4/10: total=1.6016, vae=1.0818, dsb=0.5192, bio=0.0011
    Epoch  5/10: total=1.6274, vae=1.0826, dsb=0.5443, bio=0.0011
    Epoch  6/10: total=1.6061, vae=1.0823, dsb=0.5233, bio=0.0010
    Epoch  7/10: total=1.6067, vae=1.0832, dsb=0.5230, bio=0.0010
    Epoch  8/10: total=1.6018, vae=1.0823, dsb=0.5189, bio=0.0010
    Epoch  9/10: total=1.5895, vae=1.0826, dsb=0.5064, bio=0.0010
    Epoch 10/10: total=1.5865, vae=1.0821, dsb=0.5039, bio=0.0010

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=31.8799, vae=1.0857, dsb=30.7927, bio=0.0032
    Epoch  2/10: total=31.2235, vae=1.0845, dsb=30.1385, bio=0.0010
    Epoch  3/10: total=30.8434, vae=1.0843, dsb=29.7588, bio=0.0007
    Epoch  4/10: total=30.9851, vae=1.0841, dsb=29.9008, bio=0.0005
    Epoch  5/10: total=30.9180, vae=1.0837, dsb=29.8339, bio=0.0006
    Epoch  6/10: total=30.6800, vae=1.0832, dsb=29.5965, bio=0.0005
    Epoch  7/10: total=30.8260, vae=1.0825, dsb=29.7432, bio=0.0005
    Epoch  8/10: total=30.7090, vae=1.0825, dsb=29.6259, bio=0.0010
    Epoch  9/10: total=30.6177, vae=1.0832, dsb=29.5342, bio=0.0006
    Epoch 10/10: total=30.5158, vae=1.0821, dsb=29.4333, bio=0.0007

  [Backward Policy Training]
    Epoch  1/10: total=1.6014, vae=1.0852, dsb=0.4543, bio=0.1236
    Epoch  2/10: total=1.5158, vae=1.0836, dsb=0.4316, bio=0.0013
    Epoch  3/10: total=1.5161, vae=1.0822, dsb=0.4334, bio=0.0011
    Epoch  4/10: total=1.4981, vae=1.0818, dsb=0.4160, bio=0.0009
    Epoch  5/10: total=1.4989, vae=1.0823, dsb=0.4164, bio=0.0005
    Epoch  6/10: total=1.4947, vae=1.0821, dsb=0.4121, bio=0.0009
    Epoch  7/10: total=1.4940, vae=1.0817, dsb=0.4117, bio=0.0011
    Epoch  8/10: total=1.4953, vae=1.0821, dsb=0.4127, bio=0.0010
    Epoch  9/10: total=1.4995, vae=1.0809, dsb=0.4182, bio=0.0009
    Epoch 10/10: total=1.4944, vae=1.0816, dsb=0.4124, bio=0.0008

[Seed 18] Joint training (original) complete; models and history saved.

[Seed 18] Starting joint training (ablation)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=313.2604, vae=2.0118, dsb=311.2486, bio=0.0000
    Epoch  2/10: total=111.6378, vae=1.0793, dsb=110.5585, bio=0.0000
    Epoch  3/10: total=95.0392, vae=1.0772, dsb=93.9620, bio=0.0000
    Epoch  4/10: total=87.4220, vae=1.0771, dsb=86.3449, bio=0.0000
    Epoch  5/10: total=82.8783, vae=1.0757, dsb=81.8026, bio=0.0000
    Epoch  6/10: total=79.8180, vae=1.0762, dsb=78.7419, bio=0.0000
    Epoch  7/10: total=77.7452, vae=1.0753, dsb=76.6699, bio=0.0000
    Epoch  8/10: total=75.8748, vae=1.0754, dsb=74.7994, bio=0.0000
    Epoch  9/10: total=74.3880, vae=1.0757, dsb=73.3123, bio=0.0000
    Epoch 10/10: total=73.2022, vae=1.0754, dsb=72.1268, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=3.5206, vae=1.0759, dsb=2.4447, bio=0.0000
    Epoch  2/10: total=2.8912, vae=1.0757, dsb=1.8155, bio=0.0000
    Epoch  3/10: total=2.7514, vae=1.0750, dsb=1.6765, bio=0.0000
    Epoch  4/10: total=2.6271, vae=1.0756, dsb=1.5515, bio=0.0000
    Epoch  5/10: total=2.6014, vae=1.0749, dsb=1.5265, bio=0.0000
    Epoch  6/10: total=2.5298, vae=1.0752, dsb=1.4546, bio=0.0000
    Epoch  7/10: total=2.4911, vae=1.0751, dsb=1.4160, bio=0.0000
    Epoch  8/10: total=2.5083, vae=1.0746, dsb=1.4337, bio=0.0000
    Epoch  9/10: total=2.4910, vae=1.0750, dsb=1.4159, bio=0.0000
    Epoch 10/10: total=2.4509, vae=1.0751, dsb=1.3758, bio=0.0000

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=68.2445, vae=1.0747, dsb=67.1698, bio=0.0000
    Epoch  2/10: total=58.8647, vae=1.0757, dsb=57.7891, bio=0.0000
    Epoch  3/10: total=55.9440, vae=1.0753, dsb=54.8687, bio=0.0000
    Epoch  4/10: total=54.6746, vae=1.0754, dsb=53.5992, bio=0.0000
    Epoch  5/10: total=53.8898, vae=1.0755, dsb=52.8143, bio=0.0000
    Epoch  6/10: total=53.3111, vae=1.0746, dsb=52.2365, bio=0.0000
    Epoch  7/10: total=52.7516, vae=1.0756, dsb=51.6760, bio=0.0000
    Epoch  8/10: total=52.3068, vae=1.0756, dsb=51.2311, bio=0.0000
    Epoch  9/10: total=51.9726, vae=1.0758, dsb=50.8969, bio=0.0000
    Epoch 10/10: total=51.7337, vae=1.0746, dsb=50.6591, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=2.2535, vae=1.0747, dsb=1.1788, bio=0.0000
    Epoch  2/10: total=2.1118, vae=1.0750, dsb=1.0367, bio=0.0000
    Epoch  3/10: total=2.0608, vae=1.0752, dsb=0.9856, bio=0.0000
    Epoch  4/10: total=2.0441, vae=1.0748, dsb=0.9693, bio=0.0000
    Epoch  5/10: total=2.0052, vae=1.0760, dsb=0.9292, bio=0.0000
    Epoch  6/10: total=2.0044, vae=1.0739, dsb=0.9305, bio=0.0000
    Epoch  7/10: total=1.9893, vae=1.0753, dsb=0.9140, bio=0.0000
    Epoch  8/10: total=1.9731, vae=1.0752, dsb=0.8978, bio=0.0000
    Epoch  9/10: total=1.9586, vae=1.0754, dsb=0.8833, bio=0.0000
    Epoch 10/10: total=1.9415, vae=1.0757, dsb=0.8658, bio=0.0000

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=49.8960, vae=1.0741, dsb=48.8218, bio=0.0000
    Epoch  2/10: total=46.0945, vae=1.0755, dsb=45.0189, bio=0.0000
    Epoch  3/10: total=44.9630, vae=1.0753, dsb=43.8877, bio=0.0000
    Epoch  4/10: total=44.0759, vae=1.0755, dsb=43.0004, bio=0.0000
    Epoch  5/10: total=43.8415, vae=1.0742, dsb=42.7673, bio=0.0000
    Epoch  6/10: total=43.7729, vae=1.0750, dsb=42.6979, bio=0.0000
    Epoch  7/10: total=43.3758, vae=1.0749, dsb=42.3009, bio=0.0000
    Epoch  8/10: total=43.1207, vae=1.0759, dsb=42.0448, bio=0.0000
    Epoch  9/10: total=43.1893, vae=1.0742, dsb=42.1151, bio=0.0000
    Epoch 10/10: total=42.9731, vae=1.0751, dsb=41.8980, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.8283, vae=1.0743, dsb=0.7540, bio=0.0000
    Epoch  2/10: total=1.7635, vae=1.0746, dsb=0.6890, bio=0.0000
    Epoch  3/10: total=1.7419, vae=1.0755, dsb=0.6664, bio=0.0000
    Epoch  4/10: total=1.7520, vae=1.0751, dsb=0.6769, bio=0.0000
    Epoch  5/10: total=1.7435, vae=1.0752, dsb=0.6682, bio=0.0000
    Epoch  6/10: total=1.7237, vae=1.0751, dsb=0.6486, bio=0.0000
    Epoch  7/10: total=1.7032, vae=1.0750, dsb=0.6282, bio=0.0000
    Epoch  8/10: total=1.7047, vae=1.0741, dsb=0.6306, bio=0.0000
    Epoch  9/10: total=1.7185, vae=1.0749, dsb=0.6437, bio=0.0000
    Epoch 10/10: total=1.7088, vae=1.0757, dsb=0.6331, bio=0.0000

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=38.4950, vae=1.0760, dsb=37.4190, bio=0.0000
    Epoch  2/10: total=36.5103, vae=1.0755, dsb=35.4348, bio=0.0000
    Epoch  3/10: total=36.3450, vae=1.0751, dsb=35.2700, bio=0.0000
    Epoch  4/10: total=36.0044, vae=1.0752, dsb=34.9292, bio=0.0000
    Epoch  5/10: total=35.8895, vae=1.0745, dsb=34.8150, bio=0.0000
    Epoch  6/10: total=35.6695, vae=1.0746, dsb=34.5949, bio=0.0000
    Epoch  7/10: total=35.8947, vae=1.0750, dsb=34.8197, bio=0.0000
    Epoch  8/10: total=35.4166, vae=1.0748, dsb=34.3418, bio=0.0000
    Epoch  9/10: total=35.4018, vae=1.0746, dsb=34.3272, bio=0.0000
    Epoch 10/10: total=35.3953, vae=1.0747, dsb=34.3206, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.6260, vae=1.0740, dsb=0.5520, bio=0.0000
    Epoch  2/10: total=1.5891, vae=1.0744, dsb=0.5147, bio=0.0000
    Epoch  3/10: total=1.5777, vae=1.0750, dsb=0.5027, bio=0.0000
    Epoch  4/10: total=1.5657, vae=1.0743, dsb=0.4914, bio=0.0000
    Epoch  5/10: total=1.5908, vae=1.0750, dsb=0.5159, bio=0.0000
    Epoch  6/10: total=1.5711, vae=1.0747, dsb=0.4964, bio=0.0000
    Epoch  7/10: total=1.5717, vae=1.0758, dsb=0.4958, bio=0.0000
    Epoch  8/10: total=1.5671, vae=1.0750, dsb=0.4922, bio=0.0000
    Epoch  9/10: total=1.5558, vae=1.0753, dsb=0.4804, bio=0.0000
    Epoch 10/10: total=1.5526, vae=1.0750, dsb=0.4776, bio=0.0000

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=32.2991, vae=1.0753, dsb=31.2238, bio=0.0000
    Epoch  2/10: total=31.7023, vae=1.0757, dsb=30.6266, bio=0.0000
    Epoch  3/10: total=31.3439, vae=1.0756, dsb=30.2683, bio=0.0000
    Epoch  4/10: total=31.5340, vae=1.0756, dsb=30.4584, bio=0.0000
    Epoch  5/10: total=31.4262, vae=1.0756, dsb=30.3506, bio=0.0000
    Epoch  6/10: total=31.2046, vae=1.0752, dsb=30.1294, bio=0.0000
    Epoch  7/10: total=31.3649, vae=1.0745, dsb=30.2904, bio=0.0000
    Epoch  8/10: total=31.2416, vae=1.0747, dsb=30.1668, bio=0.0000
    Epoch  9/10: total=31.1388, vae=1.0754, dsb=30.0634, bio=0.0000
    Epoch 10/10: total=31.0385, vae=1.0744, dsb=29.9641, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.5200, vae=1.0761, dsb=0.4439, bio=0.0000
    Epoch  2/10: total=1.4997, vae=1.0761, dsb=0.4236, bio=0.0000
    Epoch  3/10: total=1.5004, vae=1.0749, dsb=0.4255, bio=0.0000
    Epoch  4/10: total=1.4832, vae=1.0746, dsb=0.4087, bio=0.0000
    Epoch  5/10: total=1.4845, vae=1.0752, dsb=0.4093, bio=0.0000
    Epoch  6/10: total=1.4801, vae=1.0752, dsb=0.4048, bio=0.0000
    Epoch  7/10: total=1.4801, vae=1.0750, dsb=0.4051, bio=0.0000
    Epoch  8/10: total=1.4812, vae=1.0755, dsb=0.4058, bio=0.0000
    Epoch  9/10: total=1.4859, vae=1.0742, dsb=0.4117, bio=0.0000
    Epoch 10/10: total=1.4811, vae=1.0750, dsb=0.4061, bio=0.0000

[Seed 18] Joint training (ablation) complete; models and history saved.

[Seed 18] Drift genes saved in /home/yyuan/ICB_TCE/iter_results/run_018

[Seed 18] run finished.

================================================================================
[Seed 19] Starting running whole pipeline...
================================================================================

[Seed 19] Starting VAE pre-training...

    Epoch [01/20], Beta: 0.000, Average Loss: 531.8255
    Epoch [02/20], Beta: 0.000, Average Loss: 304.4317
    Epoch [03/20], Beta: 0.000, Average Loss: 268.7502
    Epoch [04/20], Beta: 0.000, Average Loss: 250.5409
    Epoch [05/20], Beta: 0.100, Average Loss: 245.7919
    Epoch [06/20], Beta: 0.200, Average Loss: 245.0010
    Epoch [07/20], Beta: 0.300, Average Loss: 245.2948
    Epoch [08/20], Beta: 0.400, Average Loss: 246.1543
    Epoch [09/20], Beta: 0.500, Average Loss: 247.2242
    Epoch [10/20], Beta: 0.600, Average Loss: 248.3153
    Epoch [11/20], Beta: 0.700, Average Loss: 249.5684
    Epoch [12/20], Beta: 0.800, Average Loss: 250.7957
    Epoch [13/20], Beta: 0.900, Average Loss: 251.9508
    Epoch [14/20], Beta: 1.000, Average Loss: 253.5906
    Epoch [15/20], Beta: 1.000, Average Loss: 253.1853
    Epoch [16/20], Beta: 1.000, Average Loss: 252.7294
    Epoch [17/20], Beta: 1.000, Average Loss: 252.3754
    Epoch [18/20], Beta: 1.000, Average Loss: 252.0946
    Epoch [19/20], Beta: 1.000, Average Loss: 251.7192
    Epoch [20/20], Beta: 1.000, Average Loss: 251.5022

[Seed 19] VAE pre-training complete.

[Seed 19] Starting joint training (original)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=173.3644, vae=3.8435, dsb=146.3769, bio=46.2879
    Epoch  2/10: total=45.5727, vae=1.1118, dsb=44.4137, bio=0.0943
    Epoch  3/10: total=36.2729, vae=1.1062, dsb=35.1484, bio=0.0367
    Epoch  4/10: total=31.6652, vae=1.1050, dsb=30.5496, bio=0.0214
    Epoch  5/10: total=28.9368, vae=1.1041, dsb=27.8255, bio=0.0143
    Epoch  6/10: total=27.0885, vae=1.1034, dsb=25.9799, bio=0.0103
    Epoch  7/10: total=25.8279, vae=1.1025, dsb=24.7214, bio=0.0080
    Epoch  8/10: total=24.8708, vae=1.1022, dsb=23.7654, bio=0.0064
    Epoch  9/10: total=24.0580, vae=1.1018, dsb=22.9536, bio=0.0053
    Epoch 10/10: total=23.4474, vae=1.1034, dsb=22.3418, bio=0.0046

  [Backward Policy Training]
    Epoch  1/10: total=3.0410, vae=1.1035, dsb=1.9322, bio=0.0105
    Epoch  2/10: total=2.4587, vae=1.1020, dsb=1.3547, bio=0.0040
    Epoch  3/10: total=2.3377, vae=1.1008, dsb=1.2354, bio=0.0030
    Epoch  4/10: total=2.2865, vae=1.1010, dsb=1.1842, bio=0.0026
    Epoch  5/10: total=2.2620, vae=1.0994, dsb=1.1614, bio=0.0023
    Epoch  6/10: total=2.1795, vae=1.0999, dsb=1.0785, bio=0.0022
    Epoch  7/10: total=2.1642, vae=1.1001, dsb=1.0631, bio=0.0021
    Epoch  8/10: total=2.1454, vae=1.1002, dsb=1.0442, bio=0.0020
    Epoch  9/10: total=2.1186, vae=1.1002, dsb=1.0174, bio=0.0020
    Epoch 10/10: total=2.1332, vae=1.0997, dsb=1.0324, bio=0.0022

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=25.6458, vae=1.1025, dsb=24.5417, bio=0.0032
    Epoch  2/10: total=18.7281, vae=1.1006, dsb=17.6266, bio=0.0018
    Epoch  3/10: total=17.0656, vae=1.1012, dsb=15.9636, bio=0.0017
    Epoch  4/10: total=16.1499, vae=1.1007, dsb=15.0484, bio=0.0017
    Epoch  5/10: total=15.5030, vae=1.1011, dsb=14.4011, bio=0.0017
    Epoch  6/10: total=15.1201, vae=1.1004, dsb=14.0189, bio=0.0017
    Epoch  7/10: total=14.7894, vae=1.1002, dsb=13.6884, bio=0.0017
    Epoch  8/10: total=14.5306, vae=1.1006, dsb=13.4292, bio=0.0017
    Epoch  9/10: total=14.3052, vae=1.1003, dsb=13.2040, bio=0.0019
    Epoch 10/10: total=14.1564, vae=1.0997, dsb=13.0558, bio=0.0016

  [Backward Policy Training]
    Epoch  1/10: total=1.9238, vae=1.0998, dsb=0.8214, bio=0.0054
    Epoch  2/10: total=1.7965, vae=1.0993, dsb=0.6964, bio=0.0017
    Epoch  3/10: total=1.7853, vae=1.0991, dsb=0.6854, bio=0.0016
    Epoch  4/10: total=1.7480, vae=1.0996, dsb=0.6477, bio=0.0014
    Epoch  5/10: total=1.7124, vae=1.0990, dsb=0.6124, bio=0.0020
    Epoch  6/10: total=1.7059, vae=1.0985, dsb=0.6067, bio=0.0015
    Epoch  7/10: total=1.7085, vae=1.0986, dsb=0.6091, bio=0.0014
    Epoch  8/10: total=1.7024, vae=1.0992, dsb=0.6025, bio=0.0014
    Epoch  9/10: total=1.6700, vae=1.0986, dsb=0.5708, bio=0.0014
    Epoch 10/10: total=1.6881, vae=1.0984, dsb=0.5890, bio=0.0014

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=15.3903, vae=1.1011, dsb=14.2877, bio=0.0031
    Epoch  2/10: total=12.6554, vae=1.1000, dsb=11.5547, bio=0.0014
    Epoch  3/10: total=11.9434, vae=1.0998, dsb=10.8429, bio=0.0014
    Epoch  4/10: total=11.5887, vae=1.0992, dsb=10.4889, bio=0.0013
    Epoch  5/10: total=11.3614, vae=1.0986, dsb=10.2622, bio=0.0013
    Epoch  6/10: total=11.1800, vae=1.0991, dsb=10.0802, bio=0.0013
    Epoch  7/10: total=11.0351, vae=1.0997, dsb=9.9347, bio=0.0013
    Epoch  8/10: total=10.9155, vae=1.0985, dsb=9.8163, bio=0.0014
    Epoch  9/10: total=10.8773, vae=1.0988, dsb=9.7778, bio=0.0013
    Epoch 10/10: total=10.7560, vae=1.0989, dsb=9.6564, bio=0.0013

  [Backward Policy Training]
    Epoch  1/10: total=1.6071, vae=1.0994, dsb=0.4952, bio=0.0249
    Epoch  2/10: total=1.5403, vae=1.0981, dsb=0.4416, bio=0.0014
    Epoch  3/10: total=1.5183, vae=1.0979, dsb=0.4198, bio=0.0013
    Epoch  4/10: total=1.5102, vae=1.0981, dsb=0.4115, bio=0.0012
    Epoch  5/10: total=1.4944, vae=1.0983, dsb=0.3955, bio=0.0012
    Epoch  6/10: total=1.4995, vae=1.0976, dsb=0.4013, bio=0.0012
    Epoch  7/10: total=1.4803, vae=1.0985, dsb=0.3812, bio=0.0011
    Epoch  8/10: total=1.4836, vae=1.0976, dsb=0.3855, bio=0.0011
    Epoch  9/10: total=1.4760, vae=1.0975, dsb=0.3779, bio=0.0011
    Epoch 10/10: total=1.4656, vae=1.0974, dsb=0.3677, bio=0.0011

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=10.7370, vae=1.1005, dsb=9.6351, bio=0.0027
    Epoch  2/10: total=9.5037, vae=1.0993, dsb=8.4039, bio=0.0011
    Epoch  3/10: total=9.2474, vae=1.0983, dsb=8.1485, bio=0.0012
    Epoch  4/10: total=9.0549, vae=1.0983, dsb=7.9561, bio=0.0012
    Epoch  5/10: total=8.9574, vae=1.0984, dsb=7.8584, bio=0.0011
    Epoch  6/10: total=8.8760, vae=1.0982, dsb=7.7773, bio=0.0011
    Epoch  7/10: total=8.8436, vae=1.0981, dsb=7.7451, bio=0.0011
    Epoch  8/10: total=8.7912, vae=1.0980, dsb=7.6926, bio=0.0011
    Epoch  9/10: total=8.7347, vae=1.0982, dsb=7.6360, bio=0.0011
    Epoch 10/10: total=8.7317, vae=1.0989, dsb=7.6324, bio=0.0009

  [Backward Policy Training]
    Epoch  1/10: total=1.4792, vae=1.0990, dsb=0.3123, bio=0.1358
    Epoch  2/10: total=1.3754, vae=1.0976, dsb=0.2772, bio=0.0013
    Epoch  3/10: total=1.3736, vae=1.0982, dsb=0.2749, bio=0.0011
    Epoch  4/10: total=1.3657, vae=1.0979, dsb=0.2671, bio=0.0012
    Epoch  5/10: total=1.3645, vae=1.0974, dsb=0.2666, bio=0.0010
    Epoch  6/10: total=1.3572, vae=1.0983, dsb=0.2585, bio=0.0010
    Epoch  7/10: total=1.3547, vae=1.0967, dsb=0.2575, bio=0.0010
    Epoch  8/10: total=1.3594, vae=1.0973, dsb=0.2615, bio=0.0010
    Epoch  9/10: total=1.3521, vae=1.0972, dsb=0.2544, bio=0.0010
    Epoch 10/10: total=1.3498, vae=1.0974, dsb=0.2519, bio=0.0010

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=8.1691, vae=1.1007, dsb=7.0671, bio=0.0026
    Epoch  2/10: total=7.7507, vae=1.0981, dsb=6.6521, bio=0.0011
    Epoch  3/10: total=7.6266, vae=1.0990, dsb=6.5271, bio=0.0011
    Epoch  4/10: total=7.5891, vae=1.0976, dsb=6.4909, bio=0.0010
    Epoch  5/10: total=7.5234, vae=1.0982, dsb=6.4250, bio=0.0006
    Epoch  6/10: total=7.5234, vae=1.0980, dsb=6.4252, bio=0.0005
    Epoch  7/10: total=7.4896, vae=1.0979, dsb=6.3910, bio=0.0014
    Epoch  8/10: total=7.4831, vae=1.0989, dsb=6.3837, bio=0.0010
    Epoch  9/10: total=7.4427, vae=1.0978, dsb=6.3444, bio=0.0010
    Epoch 10/10: total=7.4553, vae=1.0972, dsb=6.3576, bio=0.0010

  [Backward Policy Training]
    Epoch  1/10: total=1.4059, vae=1.0989, dsb=0.2100, bio=0.1941
    Epoch  2/10: total=1.3028, vae=1.0977, dsb=0.2045, bio=0.0010
    Epoch  3/10: total=1.2952, vae=1.0966, dsb=0.1980, bio=0.0011
    Epoch  4/10: total=1.2977, vae=1.0966, dsb=0.2005, bio=0.0010
    Epoch  5/10: total=1.3002, vae=1.0977, dsb=0.2021, bio=0.0008
    Epoch  6/10: total=1.2915, vae=1.0973, dsb=0.1937, bio=0.0010
    Epoch  7/10: total=1.2997, vae=1.0964, dsb=0.2028, bio=0.0010
    Epoch  8/10: total=1.2923, vae=1.0967, dsb=0.1951, bio=0.0009
    Epoch  9/10: total=1.2907, vae=1.0958, dsb=0.1944, bio=0.0009
    Epoch 10/10: total=1.2858, vae=1.0970, dsb=0.1883, bio=0.0009

[Seed 19] Joint training (original) complete; models and history saved.

[Seed 19] Starting joint training (ablation)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=148.2699, vae=1.9948, dsb=146.2751, bio=0.0000
    Epoch  2/10: total=45.4389, vae=1.0946, dsb=44.3443, bio=0.0000
    Epoch  3/10: total=36.2139, vae=1.0920, dsb=35.1218, bio=0.0000
    Epoch  4/10: total=31.6418, vae=1.0917, dsb=30.5502, bio=0.0000
    Epoch  5/10: total=28.8945, vae=1.0912, dsb=27.8033, bio=0.0000
    Epoch  6/10: total=27.0742, vae=1.0908, dsb=25.9834, bio=0.0000
    Epoch  7/10: total=25.7998, vae=1.0901, dsb=24.7097, bio=0.0000
    Epoch  8/10: total=24.8244, vae=1.0901, dsb=23.7344, bio=0.0000
    Epoch  9/10: total=24.0155, vae=1.0899, dsb=22.9256, bio=0.0000
    Epoch 10/10: total=23.4301, vae=1.0917, dsb=22.3383, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=2.9449, vae=1.0910, dsb=1.8539, bio=0.0000
    Epoch  2/10: total=2.3970, vae=1.0910, dsb=1.3060, bio=0.0000
    Epoch  3/10: total=2.2837, vae=1.0903, dsb=1.1934, bio=0.0000
    Epoch  4/10: total=2.2357, vae=1.0908, dsb=1.1449, bio=0.0000
    Epoch  5/10: total=2.2136, vae=1.0894, dsb=1.1242, bio=0.0000
    Epoch  6/10: total=2.1354, vae=1.0901, dsb=1.0453, bio=0.0000
    Epoch  7/10: total=2.1220, vae=1.0904, dsb=1.0316, bio=0.0000
    Epoch  8/10: total=2.1040, vae=1.0907, dsb=1.0134, bio=0.0000
    Epoch  9/10: total=2.0793, vae=1.0906, dsb=0.9886, bio=0.0000
    Epoch 10/10: total=2.0947, vae=1.0904, dsb=1.0044, bio=0.0000

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=24.7507, vae=1.0904, dsb=23.6603, bio=0.0000
    Epoch  2/10: total=18.1234, vae=1.0898, dsb=17.0337, bio=0.0000
    Epoch  3/10: total=16.5381, vae=1.0906, dsb=15.4476, bio=0.0000
    Epoch  4/10: total=15.7016, vae=1.0903, dsb=14.6113, bio=0.0000
    Epoch  5/10: total=15.0992, vae=1.0908, dsb=14.0085, bio=0.0000
    Epoch  6/10: total=14.7348, vae=1.0902, dsb=13.6446, bio=0.0000
    Epoch  7/10: total=14.4231, vae=1.0902, dsb=13.3329, bio=0.0000
    Epoch  8/10: total=14.1759, vae=1.0906, dsb=13.0852, bio=0.0000
    Epoch  9/10: total=13.9452, vae=1.0904, dsb=12.8549, bio=0.0000
    Epoch 10/10: total=13.8011, vae=1.0900, dsb=12.7111, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.8784, vae=1.0894, dsb=0.7889, bio=0.0000
    Epoch  2/10: total=1.7559, vae=1.0904, dsb=0.6656, bio=0.0000
    Epoch  3/10: total=1.7442, vae=1.0903, dsb=0.6538, bio=0.0000
    Epoch  4/10: total=1.7065, vae=1.0909, dsb=0.6155, bio=0.0000
    Epoch  5/10: total=1.6713, vae=1.0904, dsb=0.5808, bio=0.0000
    Epoch  6/10: total=1.6657, vae=1.0900, dsb=0.5757, bio=0.0000
    Epoch  7/10: total=1.6677, vae=1.0902, dsb=0.5775, bio=0.0000
    Epoch  8/10: total=1.6619, vae=1.0908, dsb=0.5711, bio=0.0000
    Epoch  9/10: total=1.6307, vae=1.0902, dsb=0.5405, bio=0.0000
    Epoch 10/10: total=1.6479, vae=1.0901, dsb=0.5578, bio=0.0000

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=14.9359, vae=1.0902, dsb=13.8457, bio=0.0000
    Epoch  2/10: total=12.1526, vae=1.0904, dsb=11.0622, bio=0.0000
    Epoch  3/10: total=11.4721, vae=1.0904, dsb=10.3817, bio=0.0000
    Epoch  4/10: total=11.1291, vae=1.0900, dsb=10.0391, bio=0.0000
    Epoch  5/10: total=10.9090, vae=1.0894, dsb=9.8196, bio=0.0000
    Epoch  6/10: total=10.7556, vae=1.0901, dsb=9.6656, bio=0.0000
    Epoch  7/10: total=10.6060, vae=1.0908, dsb=9.5153, bio=0.0000
    Epoch  8/10: total=10.4979, vae=1.0896, dsb=9.4083, bio=0.0000
    Epoch  9/10: total=10.4643, vae=1.0901, dsb=9.3743, bio=0.0000
    Epoch 10/10: total=10.3536, vae=1.0903, dsb=9.2634, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.5518, vae=1.0902, dsb=0.4617, bio=0.0000
    Epoch  2/10: total=1.5005, vae=1.0899, dsb=0.4107, bio=0.0000
    Epoch  3/10: total=1.4797, vae=1.0898, dsb=0.3898, bio=0.0000
    Epoch  4/10: total=1.4722, vae=1.0901, dsb=0.3821, bio=0.0000
    Epoch  5/10: total=1.4579, vae=1.0904, dsb=0.3675, bio=0.0000
    Epoch  6/10: total=1.4624, vae=1.0897, dsb=0.3726, bio=0.0000
    Epoch  7/10: total=1.4444, vae=1.0906, dsb=0.3538, bio=0.0000
    Epoch  8/10: total=1.4475, vae=1.0898, dsb=0.3578, bio=0.0000
    Epoch  9/10: total=1.4402, vae=1.0898, dsb=0.3504, bio=0.0000
    Epoch 10/10: total=1.4304, vae=1.0897, dsb=0.3407, bio=0.0000

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=10.3659, vae=1.0899, dsb=9.2760, bio=0.0000
    Epoch  2/10: total=9.1845, vae=1.0902, dsb=8.0943, bio=0.0000
    Epoch  3/10: total=8.9454, vae=1.0896, dsb=7.8558, bio=0.0000
    Epoch  4/10: total=8.7641, vae=1.0898, dsb=7.6743, bio=0.0000
    Epoch  5/10: total=8.6813, vae=1.0900, dsb=7.5913, bio=0.0000
    Epoch  6/10: total=8.6120, vae=1.0899, dsb=7.5221, bio=0.0000
    Epoch  7/10: total=8.5832, vae=1.0899, dsb=7.4933, bio=0.0000
    Epoch  8/10: total=8.5404, vae=1.0900, dsb=7.4504, bio=0.0000
    Epoch  9/10: total=8.4885, vae=1.0902, dsb=7.3982, bio=0.0000
    Epoch 10/10: total=8.4884, vae=1.0910, dsb=7.3974, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.3752, vae=1.0898, dsb=0.2854, bio=0.0000
    Epoch  2/10: total=1.3418, vae=1.0897, dsb=0.2521, bio=0.0000
    Epoch  3/10: total=1.3401, vae=1.0905, dsb=0.2496, bio=0.0000
    Epoch  4/10: total=1.3324, vae=1.0902, dsb=0.2422, bio=0.0000
    Epoch  5/10: total=1.3313, vae=1.0899, dsb=0.2414, bio=0.0000
    Epoch  6/10: total=1.3245, vae=1.0908, dsb=0.2337, bio=0.0000
    Epoch  7/10: total=1.3222, vae=1.0893, dsb=0.2329, bio=0.0000
    Epoch  8/10: total=1.3265, vae=1.0900, dsb=0.2366, bio=0.0000
    Epoch  9/10: total=1.3202, vae=1.0898, dsb=0.2304, bio=0.0000
    Epoch 10/10: total=1.3186, vae=1.0902, dsb=0.2284, bio=0.0000

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=8.0616, vae=1.0906, dsb=6.9710, bio=0.0000
    Epoch  2/10: total=7.7482, vae=1.0894, dsb=6.6588, bio=0.0000
    Epoch  3/10: total=7.6460, vae=1.0907, dsb=6.5554, bio=0.0000
    Epoch  4/10: total=7.6210, vae=1.0897, dsb=6.5313, bio=0.0000
    Epoch  5/10: total=7.5606, vae=1.0903, dsb=6.4704, bio=0.0000
    Epoch  6/10: total=7.5694, vae=1.0903, dsb=6.4791, bio=0.0000
    Epoch  7/10: total=7.5366, vae=1.0904, dsb=6.4462, bio=0.0000
    Epoch  8/10: total=7.5331, vae=1.0914, dsb=6.4418, bio=0.0000
    Epoch  9/10: total=7.5000, vae=1.0903, dsb=6.4097, bio=0.0000
    Epoch 10/10: total=7.5099, vae=1.0897, dsb=6.4202, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.2802, vae=1.0902, dsb=0.1900, bio=0.0000
    Epoch  2/10: total=1.2770, vae=1.0904, dsb=0.1866, bio=0.0000
    Epoch  3/10: total=1.2707, vae=1.0895, dsb=0.1812, bio=0.0000
    Epoch  4/10: total=1.2734, vae=1.0896, dsb=0.1838, bio=0.0000
    Epoch  5/10: total=1.2762, vae=1.0907, dsb=0.1855, bio=0.0000
    Epoch  6/10: total=1.2681, vae=1.0905, dsb=0.1776, bio=0.0000
    Epoch  7/10: total=1.2765, vae=1.0897, dsb=0.1868, bio=0.0000
    Epoch  8/10: total=1.2694, vae=1.0901, dsb=0.1793, bio=0.0000
    Epoch  9/10: total=1.2681, vae=1.0893, dsb=0.1789, bio=0.0000
    Epoch 10/10: total=1.2636, vae=1.0905, dsb=0.1730, bio=0.0000

[Seed 19] Joint training (ablation) complete; models and history saved.

[Seed 19] Drift genes saved in /home/yyuan/ICB_TCE/iter_results/run_019

[Seed 19] run finished.

================================================================================
[Seed 20] Starting running whole pipeline...
================================================================================

[Seed 20] Starting VAE pre-training...

    Epoch [01/20], Beta: 0.000, Average Loss: 534.8891
    Epoch [02/20], Beta: 0.000, Average Loss: 308.5539
    Epoch [03/20], Beta: 0.000, Average Loss: 273.2529
    Epoch [04/20], Beta: 0.000, Average Loss: 252.4951
    Epoch [05/20], Beta: 0.100, Average Loss: 246.8115
    Epoch [06/20], Beta: 0.200, Average Loss: 245.4497
    Epoch [07/20], Beta: 0.300, Average Loss: 245.3457
    Epoch [08/20], Beta: 0.400, Average Loss: 245.8571
    Epoch [09/20], Beta: 0.500, Average Loss: 246.7418
    Epoch [10/20], Beta: 0.600, Average Loss: 247.8465
    Epoch [11/20], Beta: 0.700, Average Loss: 249.0312
    Epoch [12/20], Beta: 0.800, Average Loss: 250.3217
    Epoch [13/20], Beta: 0.900, Average Loss: 251.6373
    Epoch [14/20], Beta: 1.000, Average Loss: 252.8631
    Epoch [15/20], Beta: 1.000, Average Loss: 252.4671
    Epoch [16/20], Beta: 1.000, Average Loss: 252.0838
    Epoch [17/20], Beta: 1.000, Average Loss: 251.7395
    Epoch [18/20], Beta: 1.000, Average Loss: 251.4873
    Epoch [19/20], Beta: 1.000, Average Loss: 251.2207
    Epoch [20/20], Beta: 1.000, Average Loss: 250.9214

[Seed 20] VAE pre-training complete.

[Seed 20] Starting joint training (original)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=294.6127, vae=3.5894, dsb=274.0341, bio=33.9783
    Epoch  2/10: total=91.7914, vae=1.1014, dsb=90.6424, bio=0.0950
    Epoch  3/10: total=81.6820, vae=1.0964, dsb=80.5666, bio=0.0380
    Epoch  4/10: total=77.5243, vae=1.0938, dsb=76.4200, bio=0.0208
    Epoch  5/10: total=74.4055, vae=1.0931, dsb=73.3055, bio=0.0138
    Epoch  6/10: total=72.2680, vae=1.0924, dsb=71.1705, bio=0.0101
    Epoch  7/10: total=71.2047, vae=1.0918, dsb=70.1090, bio=0.0078
    Epoch  8/10: total=70.1279, vae=1.0910, dsb=69.0337, bio=0.0064
    Epoch  9/10: total=69.3648, vae=1.0913, dsb=68.2708, bio=0.0054
    Epoch 10/10: total=68.6205, vae=1.0912, dsb=67.5270, bio=0.0047

  [Backward Policy Training]
    Epoch  1/10: total=3.1135, vae=1.0918, dsb=2.0142, bio=0.0150
    Epoch  2/10: total=2.6659, vae=1.0905, dsb=1.5729, bio=0.0051
    Epoch  3/10: total=2.5633, vae=1.0897, dsb=1.4717, bio=0.0037
    Epoch  4/10: total=2.5192, vae=1.0897, dsb=1.4280, bio=0.0030
    Epoch  5/10: total=2.4459, vae=1.0896, dsb=1.3550, bio=0.0027
    Epoch  6/10: total=2.4271, vae=1.0901, dsb=1.3358, bio=0.0024
    Epoch  7/10: total=2.3867, vae=1.0886, dsb=1.2970, bio=0.0023
    Epoch  8/10: total=2.3938, vae=1.0890, dsb=1.3037, bio=0.0022
    Epoch  9/10: total=2.3542, vae=1.0892, dsb=1.2639, bio=0.0022
    Epoch 10/10: total=2.3192, vae=1.0902, dsb=1.2279, bio=0.0021

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=61.0136, vae=1.0933, dsb=59.9177, bio=0.0051
    Epoch  2/10: total=55.6331, vae=1.0908, dsb=54.5412, bio=0.0022
    Epoch  3/10: total=54.0336, vae=1.0899, dsb=52.9426, bio=0.0021
    Epoch  4/10: total=53.3422, vae=1.0905, dsb=52.2507, bio=0.0020
    Epoch  5/10: total=52.9778, vae=1.0904, dsb=51.8863, bio=0.0021
    Epoch  6/10: total=52.5772, vae=1.0896, dsb=51.4865, bio=0.0022
    Epoch  7/10: total=52.1477, vae=1.0894, dsb=51.0574, bio=0.0020
    Epoch  8/10: total=52.1785, vae=1.0900, dsb=51.0875, bio=0.0020
    Epoch  9/10: total=51.7980, vae=1.0901, dsb=50.7069, bio=0.0020
    Epoch 10/10: total=51.5959, vae=1.0889, dsb=50.5060, bio=0.0020

  [Backward Policy Training]
    Epoch  1/10: total=2.1335, vae=1.0893, dsb=1.0414, bio=0.0057
    Epoch  2/10: total=1.9957, vae=1.0884, dsb=0.9062, bio=0.0021
    Epoch  3/10: total=1.9952, vae=1.0886, dsb=0.9056, bio=0.0019
    Epoch  4/10: total=1.9668, vae=1.0879, dsb=0.8780, bio=0.0018
    Epoch  5/10: total=1.9689, vae=1.0889, dsb=0.8791, bio=0.0017
    Epoch  6/10: total=1.9268, vae=1.0878, dsb=0.8380, bio=0.0019
    Epoch  7/10: total=1.9349, vae=1.0872, dsb=0.8469, bio=0.0017
    Epoch  8/10: total=1.9317, vae=1.0877, dsb=0.8432, bio=0.0017
    Epoch  9/10: total=1.9154, vae=1.0879, dsb=0.8266, bio=0.0017
    Epoch 10/10: total=1.9102, vae=1.0882, dsb=0.8211, bio=0.0017

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=45.9763, vae=1.0903, dsb=44.8841, bio=0.0037
    Epoch  2/10: total=43.9700, vae=1.0887, dsb=42.8803, bio=0.0018
    Epoch  3/10: total=43.3845, vae=1.0897, dsb=42.2939, bio=0.0018
    Epoch  4/10: total=42.9843, vae=1.0888, dsb=41.8946, bio=0.0018
    Epoch  5/10: total=42.7129, vae=1.0886, dsb=41.6234, bio=0.0019
    Epoch  6/10: total=42.6135, vae=1.0888, dsb=41.5238, bio=0.0018
    Epoch  7/10: total=42.5252, vae=1.0882, dsb=41.4361, bio=0.0018
    Epoch  8/10: total=42.4044, vae=1.0889, dsb=41.3146, bio=0.0018
    Epoch  9/10: total=42.2908, vae=1.0883, dsb=41.2016, bio=0.0018
    Epoch 10/10: total=42.3380, vae=1.0885, dsb=41.2485, bio=0.0018

  [Backward Policy Training]
    Epoch  1/10: total=1.7829, vae=1.0892, dsb=0.6908, bio=0.0058
    Epoch  2/10: total=1.7347, vae=1.0878, dsb=0.6460, bio=0.0018
    Epoch  3/10: total=1.7453, vae=1.0880, dsb=0.6564, bio=0.0016
    Epoch  4/10: total=1.7130, vae=1.0881, dsb=0.6241, bio=0.0016
    Epoch  5/10: total=1.7130, vae=1.0880, dsb=0.6242, bio=0.0015
    Epoch  6/10: total=1.6995, vae=1.0869, dsb=0.6118, bio=0.0017
    Epoch  7/10: total=1.7025, vae=1.0869, dsb=0.6149, bio=0.0015
    Epoch  8/10: total=1.6886, vae=1.0867, dsb=0.6012, bio=0.0015
    Epoch  9/10: total=1.7051, vae=1.0878, dsb=0.6165, bio=0.0015
    Epoch 10/10: total=1.7002, vae=1.0871, dsb=0.6124, bio=0.0015

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=40.0398, vae=1.0896, dsb=38.9486, bio=0.0034
    Epoch  2/10: total=39.2867, vae=1.0885, dsb=38.1974, bio=0.0016
    Epoch  3/10: total=39.1360, vae=1.0887, dsb=38.0465, bio=0.0016
    Epoch  4/10: total=38.9100, vae=1.0885, dsb=37.8206, bio=0.0016
    Epoch  5/10: total=38.9873, vae=1.0888, dsb=37.8977, bio=0.0016
    Epoch  6/10: total=38.9190, vae=1.0877, dsb=37.8304, bio=0.0016
    Epoch  7/10: total=38.9363, vae=1.0883, dsb=37.8472, bio=0.0016
    Epoch  8/10: total=38.6348, vae=1.0878, dsb=37.5462, bio=0.0016
    Epoch  9/10: total=38.6445, vae=1.0888, dsb=37.5546, bio=0.0023
    Epoch 10/10: total=38.5798, vae=1.0881, dsb=37.4909, bio=0.0016

  [Backward Policy Training]
    Epoch  1/10: total=1.6065, vae=1.0883, dsb=0.5150, bio=0.0064
    Epoch  2/10: total=1.5934, vae=1.0879, dsb=0.5046, bio=0.0016
    Epoch  3/10: total=1.5723, vae=1.0866, dsb=0.4849, bio=0.0015
    Epoch  4/10: total=1.5806, vae=1.0873, dsb=0.4926, bio=0.0014
    Epoch  5/10: total=1.5740, vae=1.0871, dsb=0.4863, bio=0.0013
    Epoch  6/10: total=1.5818, vae=1.0872, dsb=0.4938, bio=0.0015
    Epoch  7/10: total=1.5622, vae=1.0879, dsb=0.4736, bio=0.0013
    Epoch  8/10: total=1.5674, vae=1.0858, dsb=0.4809, bio=0.0013
    Epoch  9/10: total=1.5517, vae=1.0867, dsb=0.4644, bio=0.0013
    Epoch 10/10: total=1.5679, vae=1.0871, dsb=0.4802, bio=0.0013

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=32.4014, vae=1.0900, dsb=31.3101, bio=0.0027
    Epoch  2/10: total=32.1383, vae=1.0882, dsb=31.0494, bio=0.0016
    Epoch  3/10: total=31.8396, vae=1.0876, dsb=30.7513, bio=0.0015
    Epoch  4/10: total=31.9750, vae=1.0879, dsb=30.8864, bio=0.0014
    Epoch  5/10: total=31.8965, vae=1.0879, dsb=30.8079, bio=0.0014
    Epoch  6/10: total=31.8734, vae=1.0871, dsb=30.7856, bio=0.0014
    Epoch  7/10: total=31.7884, vae=1.0880, dsb=30.6996, bio=0.0016
    Epoch  8/10: total=31.8247, vae=1.0876, dsb=30.7364, bio=0.0013
    Epoch  9/10: total=31.9603, vae=1.0868, dsb=30.8728, bio=0.0014
    Epoch 10/10: total=31.7889, vae=1.0878, dsb=30.7004, bio=0.0014

  [Backward Policy Training]
    Epoch  1/10: total=1.5309, vae=1.0883, dsb=0.4345, bio=0.0160
    Epoch  2/10: total=1.5212, vae=1.0875, dsb=0.4331, bio=0.0014
    Epoch  3/10: total=1.5251, vae=1.0877, dsb=0.4367, bio=0.0013
    Epoch  4/10: total=1.5101, vae=1.0866, dsb=0.4229, bio=0.0012
    Epoch  5/10: total=1.5197, vae=1.0871, dsb=0.4319, bio=0.0014
    Epoch  6/10: total=1.5214, vae=1.0865, dsb=0.4343, bio=0.0011
    Epoch  7/10: total=1.5164, vae=1.0871, dsb=0.4288, bio=0.0011
    Epoch  8/10: total=1.5155, vae=1.0873, dsb=0.4276, bio=0.0011
    Epoch  9/10: total=1.5312, vae=1.0863, dsb=0.4443, bio=0.0011
    Epoch 10/10: total=1.5166, vae=1.0872, dsb=0.4289, bio=0.0011

[Seed 20] Joint training (original) complete; models and history saved.

[Seed 20] Starting joint training (ablation)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=275.5427, vae=2.0671, dsb=273.4756, bio=0.0000
    Epoch  2/10: total=91.0789, vae=1.0829, dsb=89.9959, bio=0.0000
    Epoch  3/10: total=80.9041, vae=1.0820, dsb=79.8221, bio=0.0000
    Epoch  4/10: total=76.8782, vae=1.0806, dsb=75.7976, bio=0.0000
    Epoch  5/10: total=73.8469, vae=1.0802, dsb=72.7667, bio=0.0000
    Epoch  6/10: total=71.7914, vae=1.0798, dsb=70.7116, bio=0.0000
    Epoch  7/10: total=70.7765, vae=1.0795, dsb=69.6970, bio=0.0000
    Epoch  8/10: total=69.7268, vae=1.0790, dsb=68.6478, bio=0.0000
    Epoch  9/10: total=68.9794, vae=1.0795, dsb=67.8999, bio=0.0000
    Epoch 10/10: total=68.2435, vae=1.0796, dsb=67.1640, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=3.0156, vae=1.0792, dsb=1.9364, bio=0.0000
    Epoch  2/10: total=2.5946, vae=1.0796, dsb=1.5151, bio=0.0000
    Epoch  3/10: total=2.5005, vae=1.0793, dsb=1.4212, bio=0.0000
    Epoch  4/10: total=2.4576, vae=1.0795, dsb=1.3781, bio=0.0000
    Epoch  5/10: total=2.3863, vae=1.0795, dsb=1.3068, bio=0.0000
    Epoch  6/10: total=2.3680, vae=1.0802, dsb=1.2878, bio=0.0000
    Epoch  7/10: total=2.3285, vae=1.0788, dsb=1.2496, bio=0.0000
    Epoch  8/10: total=2.3346, vae=1.0793, dsb=1.2553, bio=0.0000
    Epoch  9/10: total=2.2973, vae=1.0796, dsb=1.2178, bio=0.0000
    Epoch 10/10: total=2.2627, vae=1.0806, dsb=1.1821, bio=0.0000

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=57.3626, vae=1.0800, dsb=56.2826, bio=0.0000
    Epoch  2/10: total=52.3211, vae=1.0797, dsb=51.2414, bio=0.0000
    Epoch  3/10: total=50.8408, vae=1.0791, dsb=49.7617, bio=0.0000
    Epoch  4/10: total=50.2086, vae=1.0798, dsb=49.1288, bio=0.0000
    Epoch  5/10: total=49.8814, vae=1.0798, dsb=48.8016, bio=0.0000
    Epoch  6/10: total=49.5056, vae=1.0793, dsb=48.4263, bio=0.0000
    Epoch  7/10: total=49.1040, vae=1.0791, dsb=48.0250, bio=0.0000
    Epoch  8/10: total=49.1334, vae=1.0798, dsb=48.0536, bio=0.0000
    Epoch  9/10: total=48.7945, vae=1.0799, dsb=47.7146, bio=0.0000
    Epoch 10/10: total=48.6725, vae=1.0788, dsb=47.5937, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=2.0399, vae=1.0788, dsb=0.9611, bio=0.0000
    Epoch  2/10: total=1.9166, vae=1.0793, dsb=0.8372, bio=0.0000
    Epoch  3/10: total=1.9168, vae=1.0797, dsb=0.8371, bio=0.0000
    Epoch  4/10: total=1.8906, vae=1.0790, dsb=0.8116, bio=0.0000
    Epoch  5/10: total=1.8934, vae=1.0802, dsb=0.8133, bio=0.0000
    Epoch  6/10: total=1.8544, vae=1.0791, dsb=0.7754, bio=0.0000
    Epoch  7/10: total=1.8625, vae=1.0785, dsb=0.7840, bio=0.0000
    Epoch  8/10: total=1.8595, vae=1.0791, dsb=0.7804, bio=0.0000
    Epoch  9/10: total=1.8444, vae=1.0792, dsb=0.7652, bio=0.0000
    Epoch 10/10: total=1.8393, vae=1.0796, dsb=0.7597, bio=0.0000

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=42.8184, vae=1.0790, dsb=41.7394, bio=0.0000
    Epoch  2/10: total=40.9774, vae=1.0786, dsb=39.8988, bio=0.0000
    Epoch  3/10: total=40.3420, vae=1.0798, dsb=39.2622, bio=0.0000
    Epoch  4/10: total=39.9747, vae=1.0790, dsb=38.8957, bio=0.0000
    Epoch  5/10: total=39.7566, vae=1.0789, dsb=38.6777, bio=0.0000
    Epoch  6/10: total=39.6546, vae=1.0792, dsb=38.5754, bio=0.0000
    Epoch  7/10: total=39.6127, vae=1.0787, dsb=38.5340, bio=0.0000
    Epoch  8/10: total=39.5179, vae=1.0794, dsb=38.4385, bio=0.0000
    Epoch  9/10: total=39.4116, vae=1.0789, dsb=38.3328, bio=0.0000
    Epoch 10/10: total=39.4423, vae=1.0791, dsb=38.3632, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.7164, vae=1.0793, dsb=0.6372, bio=0.0000
    Epoch  2/10: total=1.6753, vae=1.0793, dsb=0.5960, bio=0.0000
    Epoch  3/10: total=1.6855, vae=1.0796, dsb=0.6059, bio=0.0000
    Epoch  4/10: total=1.6551, vae=1.0797, dsb=0.5754, bio=0.0000
    Epoch  5/10: total=1.6551, vae=1.0796, dsb=0.5754, bio=0.0000
    Epoch  6/10: total=1.6426, vae=1.0787, dsb=0.5639, bio=0.0000
    Epoch  7/10: total=1.6464, vae=1.0787, dsb=0.5677, bio=0.0000
    Epoch  8/10: total=1.6334, vae=1.0785, dsb=0.5549, bio=0.0000
    Epoch  9/10: total=1.6493, vae=1.0797, dsb=0.5697, bio=0.0000
    Epoch 10/10: total=1.6450, vae=1.0790, dsb=0.5659, bio=0.0000

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=38.1620, vae=1.0787, dsb=37.0833, bio=0.0000
    Epoch  2/10: total=37.3994, vae=1.0790, dsb=36.3204, bio=0.0000
    Epoch  3/10: total=37.2490, vae=1.0795, dsb=36.1696, bio=0.0000
    Epoch  4/10: total=37.0081, vae=1.0793, dsb=35.9288, bio=0.0000
    Epoch  5/10: total=37.0780, vae=1.0797, dsb=35.9984, bio=0.0000
    Epoch  6/10: total=37.0050, vae=1.0786, dsb=35.9264, bio=0.0000
    Epoch  7/10: total=37.0360, vae=1.0792, dsb=35.9568, bio=0.0000
    Epoch  8/10: total=36.7483, vae=1.0787, dsb=35.6695, bio=0.0000
    Epoch  9/10: total=36.7792, vae=1.0798, dsb=35.6994, bio=0.0000
    Epoch 10/10: total=36.7121, vae=1.0791, dsb=35.6330, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.5563, vae=1.0792, dsb=0.4772, bio=0.0000
    Epoch  2/10: total=1.5472, vae=1.0798, dsb=0.4674, bio=0.0000
    Epoch  3/10: total=1.5278, vae=1.0786, dsb=0.4492, bio=0.0000
    Epoch  4/10: total=1.5362, vae=1.0794, dsb=0.4568, bio=0.0000
    Epoch  5/10: total=1.5303, vae=1.0791, dsb=0.4511, bio=0.0000
    Epoch  6/10: total=1.5377, vae=1.0792, dsb=0.4585, bio=0.0000
    Epoch  7/10: total=1.5194, vae=1.0801, dsb=0.4393, bio=0.0000
    Epoch  8/10: total=1.5242, vae=1.0780, dsb=0.4463, bio=0.0000
    Epoch  9/10: total=1.5095, vae=1.0789, dsb=0.4306, bio=0.0000
    Epoch 10/10: total=1.5252, vae=1.0793, dsb=0.4459, bio=0.0000

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=31.6275, vae=1.0795, dsb=30.5480, bio=0.0000
    Epoch  2/10: total=31.4142, vae=1.0791, dsb=30.3351, bio=0.0000
    Epoch  3/10: total=31.0964, vae=1.0787, dsb=30.0177, bio=0.0000
    Epoch  4/10: total=31.2180, vae=1.0791, dsb=30.1389, bio=0.0000
    Epoch  5/10: total=31.1512, vae=1.0791, dsb=30.0721, bio=0.0000
    Epoch  6/10: total=31.1076, vae=1.0784, dsb=30.0292, bio=0.0000
    Epoch  7/10: total=31.0494, vae=1.0793, dsb=29.9701, bio=0.0000
    Epoch  8/10: total=31.0564, vae=1.0791, dsb=29.9774, bio=0.0000
    Epoch  9/10: total=31.2425, vae=1.0783, dsb=30.1643, bio=0.0000
    Epoch 10/10: total=31.0356, vae=1.0793, dsb=29.9563, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.4850, vae=1.0795, dsb=0.4056, bio=0.0000
    Epoch  2/10: total=1.4836, vae=1.0796, dsb=0.4039, bio=0.0000
    Epoch  3/10: total=1.4874, vae=1.0799, dsb=0.4075, bio=0.0000
    Epoch  4/10: total=1.4727, vae=1.0789, dsb=0.3938, bio=0.0000
    Epoch  5/10: total=1.4819, vae=1.0794, dsb=0.4025, bio=0.0000
    Epoch  6/10: total=1.4835, vae=1.0789, dsb=0.4046, bio=0.0000
    Epoch  7/10: total=1.4787, vae=1.0794, dsb=0.3992, bio=0.0000
    Epoch  8/10: total=1.4777, vae=1.0797, dsb=0.3980, bio=0.0000
    Epoch  9/10: total=1.4926, vae=1.0788, dsb=0.4138, bio=0.0000
    Epoch 10/10: total=1.4786, vae=1.0796, dsb=0.3990, bio=0.0000

[Seed 20] Joint training (ablation) complete; models and history saved.

[Seed 20] Drift genes saved in /home/yyuan/ICB_TCE/iter_results/run_020

[Seed 20] run finished.

================================================================================
[Seed 21] Starting running whole pipeline...
================================================================================

[Seed 21] Starting VAE pre-training...

    Epoch [01/20], Beta: 0.000, Average Loss: 535.8122
    Epoch [02/20], Beta: 0.000, Average Loss: 309.4804
    Epoch [03/20], Beta: 0.000, Average Loss: 271.9409
    Epoch [04/20], Beta: 0.000, Average Loss: 251.4771
    Epoch [05/20], Beta: 0.100, Average Loss: 246.1889
    Epoch [06/20], Beta: 0.200, Average Loss: 245.2195
    Epoch [07/20], Beta: 0.300, Average Loss: 245.2344
    Epoch [08/20], Beta: 0.400, Average Loss: 245.6832
    Epoch [09/20], Beta: 0.500, Average Loss: 246.5934
    Epoch [10/20], Beta: 0.600, Average Loss: 247.7542
    Epoch [11/20], Beta: 0.700, Average Loss: 248.9729
    Epoch [12/20], Beta: 0.800, Average Loss: 250.3192
    Epoch [13/20], Beta: 0.900, Average Loss: 251.6008
    Epoch [14/20], Beta: 1.000, Average Loss: 253.2418
    Epoch [15/20], Beta: 1.000, Average Loss: 252.8313
    Epoch [16/20], Beta: 1.000, Average Loss: 252.4622
    Epoch [17/20], Beta: 1.000, Average Loss: 252.0882
    Epoch [18/20], Beta: 1.000, Average Loss: 251.8131
    Epoch [19/20], Beta: 1.000, Average Loss: 251.4397
    Epoch [20/20], Beta: 1.000, Average Loss: 251.2367

[Seed 21] VAE pre-training complete.

[Seed 21] Starting joint training (original)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=310.9194, vae=3.8265, dsb=293.1527, bio=27.8805
    Epoch  2/10: total=91.7828, vae=1.1131, dsb=90.6314, bio=0.0765
    Epoch  3/10: total=81.9270, vae=1.1073, dsb=80.8033, bio=0.0329
    Epoch  4/10: total=77.0133, vae=1.1053, dsb=75.8990, bio=0.0182
    Epoch  5/10: total=74.2368, vae=1.1037, dsb=73.1272, bio=0.0118
    Epoch  6/10: total=72.1149, vae=1.1023, dsb=71.0083, bio=0.0086
    Epoch  7/10: total=70.0893, vae=1.1023, dsb=68.9836, bio=0.0068
    Epoch  8/10: total=69.0932, vae=1.1023, dsb=67.9879, bio=0.0059
    Epoch  9/10: total=68.2452, vae=1.1012, dsb=67.1415, bio=0.0048
    Epoch 10/10: total=67.2897, vae=1.1018, dsb=66.1857, bio=0.0043

  [Backward Policy Training]
    Epoch  1/10: total=3.1611, vae=1.1016, dsb=2.0528, bio=0.0133
    Epoch  2/10: total=2.7181, vae=1.1001, dsb=1.6156, bio=0.0048
    Epoch  3/10: total=2.6301, vae=1.1000, dsb=1.5283, bio=0.0035
    Epoch  4/10: total=2.5349, vae=1.1001, dsb=1.4334, bio=0.0030
    Epoch  5/10: total=2.5035, vae=1.0998, dsb=1.4024, bio=0.0026
    Epoch  6/10: total=2.4755, vae=1.1003, dsb=1.3739, bio=0.0026
    Epoch  7/10: total=2.4164, vae=1.0984, dsb=1.3168, bio=0.0024
    Epoch  8/10: total=2.4310, vae=1.0986, dsb=1.3312, bio=0.0023
    Epoch  9/10: total=2.3686, vae=1.0999, dsb=1.2676, bio=0.0022
    Epoch 10/10: total=2.3987, vae=1.0982, dsb=1.2995, bio=0.0022

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=58.5222, vae=1.1016, dsb=57.4185, bio=0.0043
    Epoch  2/10: total=53.6311, vae=1.0993, dsb=52.5308, bio=0.0020
    Epoch  3/10: total=52.4673, vae=1.1003, dsb=51.3659, bio=0.0020
    Epoch  4/10: total=51.6313, vae=1.1002, dsb=50.5302, bio=0.0020
    Epoch  5/10: total=51.1884, vae=1.0989, dsb=50.0885, bio=0.0020
    Epoch  6/10: total=50.7554, vae=1.0999, dsb=49.6545, bio=0.0021
    Epoch  7/10: total=50.6648, vae=1.0997, dsb=49.5640, bio=0.0020
    Epoch  8/10: total=50.2028, vae=1.0999, dsb=49.1020, bio=0.0020
    Epoch  9/10: total=50.0652, vae=1.0993, dsb=48.9648, bio=0.0023
    Epoch 10/10: total=49.7116, vae=1.1000, dsb=48.6107, bio=0.0020

  [Backward Policy Training]
    Epoch  1/10: total=2.1063, vae=1.1001, dsb=1.0033, bio=0.0057
    Epoch  2/10: total=2.0085, vae=1.0977, dsb=0.9097, bio=0.0021
    Epoch  3/10: total=1.9762, vae=1.0976, dsb=0.8777, bio=0.0019
    Epoch  4/10: total=1.9886, vae=1.0974, dsb=0.8903, bio=0.0019
    Epoch  5/10: total=1.9338, vae=1.0976, dsb=0.8353, bio=0.0018
    Epoch  6/10: total=1.9388, vae=1.0975, dsb=0.8403, bio=0.0019
    Epoch  7/10: total=1.9435, vae=1.0976, dsb=0.8450, bio=0.0018
    Epoch  8/10: total=1.9344, vae=1.0973, dsb=0.8362, bio=0.0018
    Epoch  9/10: total=1.9214, vae=1.0979, dsb=0.8226, bio=0.0017
    Epoch 10/10: total=1.9052, vae=1.0974, dsb=0.8070, bio=0.0017

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=46.0579, vae=1.1005, dsb=44.9559, bio=0.0031
    Epoch  2/10: total=44.3416, vae=1.0989, dsb=43.2417, bio=0.0018
    Epoch  3/10: total=43.8199, vae=1.0988, dsb=42.7203, bio=0.0018
    Epoch  4/10: total=43.5164, vae=1.0981, dsb=42.4175, bio=0.0017
    Epoch  5/10: total=43.4432, vae=1.0987, dsb=42.3433, bio=0.0025
    Epoch  6/10: total=43.1080, vae=1.0984, dsb=42.0087, bio=0.0017
    Epoch  7/10: total=43.0222, vae=1.0982, dsb=41.9232, bio=0.0017
    Epoch  8/10: total=42.7980, vae=1.0983, dsb=41.6988, bio=0.0017
    Epoch  9/10: total=43.0896, vae=1.0981, dsb=41.9906, bio=0.0017
    Epoch 10/10: total=42.7677, vae=1.0984, dsb=41.6685, bio=0.0017

  [Backward Policy Training]
    Epoch  1/10: total=1.8002, vae=1.0988, dsb=0.6934, bio=0.0161
    Epoch  2/10: total=1.7384, vae=1.0969, dsb=0.6405, bio=0.0019
    Epoch  3/10: total=1.7229, vae=1.0974, dsb=0.6247, bio=0.0018
    Epoch  4/10: total=1.7151, vae=1.0972, dsb=0.6171, bio=0.0016
    Epoch  5/10: total=1.7202, vae=1.0973, dsb=0.6220, bio=0.0016
    Epoch  6/10: total=1.7184, vae=1.0961, dsb=0.6216, bio=0.0015
    Epoch  7/10: total=1.6990, vae=1.0962, dsb=0.6020, bio=0.0015
    Epoch  8/10: total=1.7062, vae=1.0964, dsb=0.6090, bio=0.0015
    Epoch  9/10: total=1.6829, vae=1.0976, dsb=0.5845, bio=0.0017
    Epoch 10/10: total=1.6851, vae=1.0971, dsb=0.5872, bio=0.0014

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=39.5304, vae=1.0987, dsb=38.4293, bio=0.0049
    Epoch  2/10: total=38.6942, vae=1.0982, dsb=37.5952, bio=0.0016
    Epoch  3/10: total=38.6523, vae=1.0979, dsb=37.5537, bio=0.0015
    Epoch  4/10: total=38.4542, vae=1.0985, dsb=37.3549, bio=0.0015
    Epoch  5/10: total=38.3573, vae=1.0979, dsb=37.2586, bio=0.0016
    Epoch  6/10: total=38.3940, vae=1.0978, dsb=37.2953, bio=0.0016
    Epoch  7/10: total=38.2766, vae=1.0975, dsb=37.1782, bio=0.0018
    Epoch  8/10: total=38.2607, vae=1.0969, dsb=37.1631, bio=0.0015
    Epoch  9/10: total=38.2710, vae=1.0979, dsb=37.1724, bio=0.0015
    Epoch 10/10: total=37.9097, vae=1.0981, dsb=36.8108, bio=0.0015

  [Backward Policy Training]
    Epoch  1/10: total=1.6786, vae=1.0975, dsb=0.5623, bio=0.0377
    Epoch  2/10: total=1.6121, vae=1.0973, dsb=0.5140, bio=0.0015
    Epoch  3/10: total=1.6090, vae=1.0962, dsb=0.5121, bio=0.0014
    Epoch  4/10: total=1.5970, vae=1.0960, dsb=0.5002, bio=0.0014
    Epoch  5/10: total=1.6163, vae=1.0967, dsb=0.5189, bio=0.0015
    Epoch  6/10: total=1.5966, vae=1.0965, dsb=0.4994, bio=0.0013
    Epoch  7/10: total=1.5951, vae=1.0967, dsb=0.4978, bio=0.0012
    Epoch  8/10: total=1.6008, vae=1.0961, dsb=0.5040, bio=0.0013
    Epoch  9/10: total=1.5897, vae=1.0962, dsb=0.4929, bio=0.0013
    Epoch 10/10: total=1.5736, vae=1.0958, dsb=0.4771, bio=0.0013

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=33.4503, vae=1.0994, dsb=32.3478, bio=0.0061
    Epoch  2/10: total=33.1537, vae=1.0985, dsb=32.0546, bio=0.0013
    Epoch  3/10: total=32.9934, vae=1.0987, dsb=31.8941, bio=0.0013
    Epoch  4/10: total=32.8394, vae=1.0976, dsb=31.7411, bio=0.0013
    Epoch  5/10: total=32.9408, vae=1.0981, dsb=31.8420, bio=0.0014
    Epoch  6/10: total=32.8448, vae=1.0973, dsb=31.7468, bio=0.0014
    Epoch  7/10: total=32.9030, vae=1.0977, dsb=31.8047, bio=0.0013
    Epoch  8/10: total=32.7632, vae=1.0967, dsb=31.6659, bio=0.0012
    Epoch  9/10: total=32.8768, vae=1.0973, dsb=31.7790, bio=0.0012
    Epoch 10/10: total=32.8741, vae=1.0970, dsb=31.7765, bio=0.0012

  [Backward Policy Training]
    Epoch  1/10: total=1.5488, vae=1.0977, dsb=0.4224, bio=0.0575
    Epoch  2/10: total=1.5203, vae=1.0958, dsb=0.4240, bio=0.0013
    Epoch  3/10: total=1.5158, vae=1.0955, dsb=0.4196, bio=0.0012
    Epoch  4/10: total=1.5229, vae=1.0966, dsb=0.4257, bio=0.0011
    Epoch  5/10: total=1.5190, vae=1.0950, dsb=0.4236, bio=0.0011
    Epoch  6/10: total=1.5221, vae=1.0960, dsb=0.4256, bio=0.0011
    Epoch  7/10: total=1.5115, vae=1.0951, dsb=0.4159, bio=0.0010
    Epoch  8/10: total=1.5147, vae=1.0959, dsb=0.4183, bio=0.0010
    Epoch  9/10: total=1.5125, vae=1.0951, dsb=0.4169, bio=0.0010
    Epoch 10/10: total=1.5117, vae=1.0957, dsb=0.4155, bio=0.0010

[Seed 21] Joint training (original) complete; models and history saved.

[Seed 21] Starting joint training (ablation)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=294.6834, vae=2.0492, dsb=292.6342, bio=0.0000
    Epoch  2/10: total=91.1172, vae=1.0926, dsb=90.0246, bio=0.0000
    Epoch  3/10: total=81.4753, vae=1.0911, dsb=80.3842, bio=0.0000
    Epoch  4/10: total=76.5612, vae=1.0911, dsb=75.4702, bio=0.0000
    Epoch  5/10: total=73.8025, vae=1.0902, dsb=72.7123, bio=0.0000
    Epoch  6/10: total=71.8123, vae=1.0894, dsb=70.7229, bio=0.0000
    Epoch  7/10: total=69.8227, vae=1.0898, dsb=68.7329, bio=0.0000
    Epoch  8/10: total=68.8692, vae=1.0901, dsb=67.7791, bio=0.0000
    Epoch  9/10: total=68.0658, vae=1.0893, dsb=66.9765, bio=0.0000
    Epoch 10/10: total=67.1103, vae=1.0902, dsb=66.0201, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=3.0656, vae=1.0890, dsb=1.9766, bio=0.0000
    Epoch  2/10: total=2.6372, vae=1.0892, dsb=1.5481, bio=0.0000
    Epoch  3/10: total=2.5528, vae=1.0895, dsb=1.4633, bio=0.0000
    Epoch  4/10: total=2.4641, vae=1.0899, dsb=1.3742, bio=0.0000
    Epoch  5/10: total=2.4343, vae=1.0898, dsb=1.3445, bio=0.0000
    Epoch  6/10: total=2.4081, vae=1.0904, dsb=1.3176, bio=0.0000
    Epoch  7/10: total=2.3504, vae=1.0887, dsb=1.2617, bio=0.0000
    Epoch  8/10: total=2.3644, vae=1.0891, dsb=1.2753, bio=0.0000
    Epoch  9/10: total=2.3045, vae=1.0904, dsb=1.2141, bio=0.0000
    Epoch 10/10: total=2.3344, vae=1.0888, dsb=1.2456, bio=0.0000

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=58.4269, vae=1.0895, dsb=57.3374, bio=0.0000
    Epoch  2/10: total=53.5298, vae=1.0885, dsb=52.4414, bio=0.0000
    Epoch  3/10: total=52.4301, vae=1.0897, dsb=51.3404, bio=0.0000
    Epoch  4/10: total=51.6272, vae=1.0897, dsb=50.5375, bio=0.0000
    Epoch  5/10: total=51.1858, vae=1.0886, dsb=50.0972, bio=0.0000
    Epoch  6/10: total=50.7809, vae=1.0896, dsb=49.6913, bio=0.0000
    Epoch  7/10: total=50.6940, vae=1.0896, dsb=49.6044, bio=0.0000
    Epoch  8/10: total=50.2230, vae=1.0898, dsb=49.1333, bio=0.0000
    Epoch  9/10: total=50.0766, vae=1.0892, dsb=48.9873, bio=0.0000
    Epoch 10/10: total=49.7526, vae=1.0900, dsb=48.6625, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=2.0422, vae=1.0895, dsb=0.9527, bio=0.0000
    Epoch  2/10: total=1.9505, vae=1.0887, dsb=0.8618, bio=0.0000
    Epoch  3/10: total=1.9208, vae=1.0887, dsb=0.8321, bio=0.0000
    Epoch  4/10: total=1.9329, vae=1.0886, dsb=0.8443, bio=0.0000
    Epoch  5/10: total=1.8808, vae=1.0889, dsb=0.7919, bio=0.0000
    Epoch  6/10: total=1.8864, vae=1.0888, dsb=0.7976, bio=0.0000
    Epoch  7/10: total=1.8912, vae=1.0891, dsb=0.8021, bio=0.0000
    Epoch  8/10: total=1.8839, vae=1.0888, dsb=0.7950, bio=0.0000
    Epoch  9/10: total=1.8711, vae=1.0894, dsb=0.7817, bio=0.0000
    Epoch 10/10: total=1.8558, vae=1.0890, dsb=0.7668, bio=0.0000

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=46.4692, vae=1.0893, dsb=45.3799, bio=0.0000
    Epoch  2/10: total=44.7286, vae=1.0890, dsb=43.6396, bio=0.0000
    Epoch  3/10: total=44.2232, vae=1.0890, dsb=43.1341, bio=0.0000
    Epoch  4/10: total=43.9486, vae=1.0885, dsb=42.8601, bio=0.0000
    Epoch  5/10: total=43.8754, vae=1.0891, dsb=42.7863, bio=0.0000
    Epoch  6/10: total=43.5371, vae=1.0891, dsb=42.4481, bio=0.0000
    Epoch  7/10: total=43.4550, vae=1.0889, dsb=42.3661, bio=0.0000
    Epoch  8/10: total=43.2469, vae=1.0892, dsb=42.1577, bio=0.0000
    Epoch  9/10: total=43.5279, vae=1.0890, dsb=42.4389, bio=0.0000
    Epoch 10/10: total=43.2402, vae=1.0894, dsb=42.1508, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.7504, vae=1.0894, dsb=0.6610, bio=0.0000
    Epoch  2/10: total=1.7012, vae=1.0886, dsb=0.6126, bio=0.0000
    Epoch  3/10: total=1.6872, vae=1.0894, dsb=0.5978, bio=0.0000
    Epoch  4/10: total=1.6803, vae=1.0893, dsb=0.5910, bio=0.0000
    Epoch  5/10: total=1.6856, vae=1.0895, dsb=0.5961, bio=0.0000
    Epoch  6/10: total=1.6841, vae=1.0883, dsb=0.5958, bio=0.0000
    Epoch  7/10: total=1.6655, vae=1.0885, dsb=0.5770, bio=0.0000
    Epoch  8/10: total=1.6725, vae=1.0889, dsb=0.5836, bio=0.0000
    Epoch  9/10: total=1.6503, vae=1.0901, dsb=0.5603, bio=0.0000
    Epoch 10/10: total=1.6528, vae=1.0898, dsb=0.5630, bio=0.0000

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=39.6548, vae=1.0880, dsb=38.5668, bio=0.0000
    Epoch  2/10: total=38.7914, vae=1.0888, dsb=37.7026, bio=0.0000
    Epoch  3/10: total=38.7819, vae=1.0886, dsb=37.6933, bio=0.0000
    Epoch  4/10: total=38.6371, vae=1.0893, dsb=37.5478, bio=0.0000
    Epoch  5/10: total=38.5248, vae=1.0889, dsb=37.4358, bio=0.0000
    Epoch  6/10: total=38.5947, vae=1.0890, dsb=37.5057, bio=0.0000
    Epoch  7/10: total=38.4547, vae=1.0886, dsb=37.3661, bio=0.0000
    Epoch  8/10: total=38.4536, vae=1.0883, dsb=37.3654, bio=0.0000
    Epoch  9/10: total=38.4386, vae=1.0893, dsb=37.3492, bio=0.0000
    Epoch 10/10: total=38.0961, vae=1.0896, dsb=37.0065, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.6349, vae=1.0883, dsb=0.5465, bio=0.0000
    Epoch  2/10: total=1.5900, vae=1.0893, dsb=0.5007, bio=0.0000
    Epoch  3/10: total=1.5881, vae=1.0885, dsb=0.4996, bio=0.0000
    Epoch  4/10: total=1.5767, vae=1.0885, dsb=0.4882, bio=0.0000
    Epoch  5/10: total=1.5969, vae=1.0891, dsb=0.5077, bio=0.0000
    Epoch  6/10: total=1.5779, vae=1.0892, dsb=0.4887, bio=0.0000
    Epoch  7/10: total=1.5769, vae=1.0895, dsb=0.4874, bio=0.0000
    Epoch  8/10: total=1.5825, vae=1.0889, dsb=0.4936, bio=0.0000
    Epoch  9/10: total=1.5720, vae=1.0892, dsb=0.4828, bio=0.0000
    Epoch 10/10: total=1.5564, vae=1.0888, dsb=0.4676, bio=0.0000

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=34.0107, vae=1.0889, dsb=32.9218, bio=0.0000
    Epoch  2/10: total=33.7506, vae=1.0893, dsb=32.6613, bio=0.0000
    Epoch  3/10: total=33.5711, vae=1.0896, dsb=32.4815, bio=0.0000
    Epoch  4/10: total=33.4182, vae=1.0887, dsb=32.3295, bio=0.0000
    Epoch  5/10: total=33.5351, vae=1.0893, dsb=32.4458, bio=0.0000
    Epoch  6/10: total=33.4073, vae=1.0888, dsb=32.3185, bio=0.0000
    Epoch  7/10: total=33.4869, vae=1.0893, dsb=32.3977, bio=0.0000
    Epoch  8/10: total=33.3747, vae=1.0884, dsb=32.2863, bio=0.0000
    Epoch  9/10: total=33.5115, vae=1.0890, dsb=32.4224, bio=0.0000
    Epoch 10/10: total=33.4739, vae=1.0889, dsb=32.3850, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.5015, vae=1.0889, dsb=0.4126, bio=0.0000
    Epoch  2/10: total=1.5040, vae=1.0882, dsb=0.4159, bio=0.0000
    Epoch  3/10: total=1.5005, vae=1.0882, dsb=0.4122, bio=0.0000
    Epoch  4/10: total=1.5081, vae=1.0895, dsb=0.4185, bio=0.0000
    Epoch  5/10: total=1.5045, vae=1.0880, dsb=0.4165, bio=0.0000
    Epoch  6/10: total=1.5079, vae=1.0891, dsb=0.4189, bio=0.0000
    Epoch  7/10: total=1.4974, vae=1.0883, dsb=0.4091, bio=0.0000
    Epoch  8/10: total=1.5010, vae=1.0891, dsb=0.4119, bio=0.0000
    Epoch  9/10: total=1.4993, vae=1.0885, dsb=0.4108, bio=0.0000
    Epoch 10/10: total=1.4985, vae=1.0891, dsb=0.4094, bio=0.0000

[Seed 21] Joint training (ablation) complete; models and history saved.

[Seed 21] Drift genes saved in /home/yyuan/ICB_TCE/iter_results/run_021

[Seed 21] run finished.

================================================================================
[Seed 22] Starting running whole pipeline...
================================================================================

[Seed 22] Starting VAE pre-training...

    Epoch [01/20], Beta: 0.000, Average Loss: 538.3322
    Epoch [02/20], Beta: 0.000, Average Loss: 304.7043
    Epoch [03/20], Beta: 0.000, Average Loss: 271.0959
    Epoch [04/20], Beta: 0.000, Average Loss: 251.2618
    Epoch [05/20], Beta: 0.100, Average Loss: 246.2194
    Epoch [06/20], Beta: 0.200, Average Loss: 245.2594
    Epoch [07/20], Beta: 0.300, Average Loss: 245.2555
    Epoch [08/20], Beta: 0.400, Average Loss: 245.9569
    Epoch [09/20], Beta: 0.500, Average Loss: 246.8718
    Epoch [10/20], Beta: 0.600, Average Loss: 247.9515
    Epoch [11/20], Beta: 0.700, Average Loss: 249.1902
    Epoch [12/20], Beta: 0.800, Average Loss: 250.4065
    Epoch [13/20], Beta: 0.900, Average Loss: 251.6736
    Epoch [14/20], Beta: 1.000, Average Loss: 253.2634
    Epoch [15/20], Beta: 1.000, Average Loss: 252.8241
    Epoch [16/20], Beta: 1.000, Average Loss: 252.4872
    Epoch [17/20], Beta: 1.000, Average Loss: 252.0770
    Epoch [18/20], Beta: 1.000, Average Loss: 251.7564
    Epoch [19/20], Beta: 1.000, Average Loss: 251.3862
    Epoch [20/20], Beta: 1.000, Average Loss: 251.2511

[Seed 22] VAE pre-training complete.

[Seed 22] Starting joint training (original)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=280.8503, vae=3.6896, dsb=260.1164, bio=34.0886
    Epoch  2/10: total=98.2982, vae=1.1041, dsb=97.1651, bio=0.0580
    Epoch  3/10: total=88.6251, vae=1.1005, dsb=87.5116, bio=0.0260
    Epoch  4/10: total=83.8300, vae=1.0990, dsb=82.7233, bio=0.0153
    Epoch  5/10: total=81.3723, vae=1.0976, dsb=80.2695, bio=0.0105
    Epoch  6/10: total=79.4672, vae=1.0973, dsb=78.3659, bio=0.0080
    Epoch  7/10: total=77.9898, vae=1.0972, dsb=76.8894, bio=0.0064
    Epoch  8/10: total=77.3660, vae=1.0960, dsb=76.2673, bio=0.0053
    Epoch  9/10: total=76.4902, vae=1.0967, dsb=75.3911, bio=0.0046
    Epoch 10/10: total=75.9159, vae=1.0956, dsb=74.8183, bio=0.0042

  [Backward Policy Training]
    Epoch  1/10: total=3.1941, vae=1.0975, dsb=2.0899, bio=0.0135
    Epoch  2/10: total=2.7265, vae=1.0950, dsb=1.6292, bio=0.0046
    Epoch  3/10: total=2.5927, vae=1.0958, dsb=1.4953, bio=0.0034
    Epoch  4/10: total=2.5210, vae=1.0953, dsb=1.4243, bio=0.0029
    Epoch  5/10: total=2.5129, vae=1.0937, dsb=1.4179, bio=0.0026
    Epoch  6/10: total=2.4737, vae=1.0947, dsb=1.3777, bio=0.0024
    Epoch  7/10: total=2.4580, vae=1.0941, dsb=1.3628, bio=0.0023
    Epoch  8/10: total=2.4167, vae=1.0937, dsb=1.3217, bio=0.0025
    Epoch  9/10: total=2.3908, vae=1.0942, dsb=1.2955, bio=0.0022
    Epoch 10/10: total=2.4054, vae=1.0935, dsb=1.3108, bio=0.0021

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=63.3180, vae=1.0969, dsb=62.2192, bio=0.0036
    Epoch  2/10: total=58.3995, vae=1.0944, dsb=57.3041, bio=0.0021
    Epoch  3/10: total=57.1173, vae=1.0944, dsb=56.0219, bio=0.0020
    Epoch  4/10: total=56.4266, vae=1.0932, dsb=55.3323, bio=0.0023
    Epoch  5/10: total=56.0792, vae=1.0940, dsb=54.9842, bio=0.0019
    Epoch  6/10: total=55.3884, vae=1.0947, dsb=54.2928, bio=0.0019
    Epoch  7/10: total=55.5353, vae=1.0939, dsb=54.4405, bio=0.0019
    Epoch  8/10: total=55.0188, vae=1.0936, dsb=53.9243, bio=0.0019
    Epoch  9/10: total=54.8832, vae=1.0936, dsb=53.7886, bio=0.0020
    Epoch 10/10: total=54.7346, vae=1.0932, dsb=53.6405, bio=0.0019

  [Backward Policy Training]
    Epoch  1/10: total=2.1271, vae=1.0934, dsb=1.0308, bio=0.0058
    Epoch  2/10: total=2.0184, vae=1.0930, dsb=0.9244, bio=0.0020
    Epoch  3/10: total=1.9780, vae=1.0925, dsb=0.8846, bio=0.0018
    Epoch  4/10: total=1.9642, vae=1.0932, dsb=0.8701, bio=0.0017
    Epoch  5/10: total=1.9532, vae=1.0926, dsb=0.8596, bio=0.0021
    Epoch  6/10: total=1.9635, vae=1.0925, dsb=0.8701, bio=0.0017
    Epoch  7/10: total=1.9346, vae=1.0929, dsb=0.8409, bio=0.0017
    Epoch  8/10: total=1.9329, vae=1.0929, dsb=0.8391, bio=0.0016
    Epoch  9/10: total=1.8948, vae=1.0921, dsb=0.8019, bio=0.0016
    Epoch 10/10: total=1.9295, vae=1.0932, dsb=0.8353, bio=0.0021

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=50.7302, vae=1.0948, dsb=49.6339, bio=0.0030
    Epoch  2/10: total=48.8639, vae=1.0932, dsb=47.7699, bio=0.0016
    Epoch  3/10: total=48.3354, vae=1.0929, dsb=47.2417, bio=0.0016
    Epoch  4/10: total=47.8978, vae=1.0933, dsb=46.8037, bio=0.0016
    Epoch  5/10: total=47.9956, vae=1.0936, dsb=46.9012, bio=0.0016
    Epoch  6/10: total=47.8047, vae=1.0938, dsb=46.7100, bio=0.0016
    Epoch  7/10: total=47.3491, vae=1.0931, dsb=46.2553, bio=0.0016
    Epoch  8/10: total=47.7676, vae=1.0932, dsb=46.6736, bio=0.0018
    Epoch  9/10: total=47.5781, vae=1.0925, dsb=46.4848, bio=0.0015
    Epoch 10/10: total=47.3007, vae=1.0927, dsb=46.2073, bio=0.0015

  [Backward Policy Training]
    Epoch  1/10: total=1.8123, vae=1.0935, dsb=0.6944, bio=0.0487
    Epoch  2/10: total=1.7418, vae=1.0923, dsb=0.6486, bio=0.0017
    Epoch  3/10: total=1.7418, vae=1.0908, dsb=0.6502, bio=0.0015
    Epoch  4/10: total=1.7367, vae=1.0922, dsb=0.6439, bio=0.0014
    Epoch  5/10: total=1.7183, vae=1.0917, dsb=0.6259, bio=0.0014
    Epoch  6/10: total=1.7104, vae=1.0921, dsb=0.6176, bio=0.0014
    Epoch  7/10: total=1.7267, vae=1.0916, dsb=0.6345, bio=0.0013
    Epoch  8/10: total=1.7227, vae=1.0920, dsb=0.6300, bio=0.0013
    Epoch  9/10: total=1.7265, vae=1.0919, dsb=0.6339, bio=0.0013
    Epoch 10/10: total=1.7030, vae=1.0912, dsb=0.6111, bio=0.0014

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=43.4090, vae=1.0941, dsb=42.3134, bio=0.0032
    Epoch  2/10: total=42.5162, vae=1.0940, dsb=41.4215, bio=0.0013
    Epoch  3/10: total=42.3974, vae=1.0934, dsb=41.3034, bio=0.0013
    Epoch  4/10: total=42.1954, vae=1.0929, dsb=41.1019, bio=0.0013
    Epoch  5/10: total=42.2293, vae=1.0925, dsb=41.1361, bio=0.0013
    Epoch  6/10: total=42.1870, vae=1.0927, dsb=41.0937, bio=0.0013
    Epoch  7/10: total=42.0274, vae=1.0925, dsb=40.9343, bio=0.0013
    Epoch  8/10: total=42.2876, vae=1.0923, dsb=41.1947, bio=0.0012
    Epoch  9/10: total=42.2208, vae=1.0921, dsb=41.1280, bio=0.0012
    Epoch 10/10: total=42.0418, vae=1.0922, dsb=40.9490, bio=0.0012

  [Backward Policy Training]
    Epoch  1/10: total=1.7131, vae=1.0929, dsb=0.5676, bio=0.1054
    Epoch  2/10: total=1.6333, vae=1.0915, dsb=0.5411, bio=0.0015
    Epoch  3/10: total=1.6088, vae=1.0917, dsb=0.5165, bio=0.0013
    Epoch  4/10: total=1.5961, vae=1.0913, dsb=0.5043, bio=0.0012
    Epoch  5/10: total=1.6155, vae=1.0916, dsb=0.5233, bio=0.0011
    Epoch  6/10: total=1.6085, vae=1.0908, dsb=0.5171, bio=0.0011
    Epoch  7/10: total=1.6042, vae=1.0904, dsb=0.5131, bio=0.0015
    Epoch  8/10: total=1.6120, vae=1.0917, dsb=0.5198, bio=0.0011
    Epoch  9/10: total=1.6056, vae=1.0919, dsb=0.5133, bio=0.0010
    Epoch 10/10: total=1.6153, vae=1.0914, dsb=0.5234, bio=0.0011

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=36.5938, vae=1.0930, dsb=35.4985, bio=0.0046
    Epoch  2/10: total=36.5036, vae=1.0930, dsb=35.4100, bio=0.0011
    Epoch  3/10: total=36.5714, vae=1.0923, dsb=35.4785, bio=0.0012
    Epoch  4/10: total=36.3392, vae=1.0921, dsb=35.2466, bio=0.0011
    Epoch  5/10: total=36.3151, vae=1.0920, dsb=35.2226, bio=0.0011
    Epoch  6/10: total=36.5829, vae=1.0925, dsb=35.4899, bio=0.0011
    Epoch  7/10: total=36.2300, vae=1.0916, dsb=35.1379, bio=0.0011
    Epoch  8/10: total=36.1444, vae=1.0919, dsb=35.0523, bio=0.0004
    Epoch  9/10: total=36.4707, vae=1.0913, dsb=35.3788, bio=0.0012
    Epoch 10/10: total=36.2006, vae=1.0918, dsb=35.1082, bio=0.0011

  [Backward Policy Training]
    Epoch  1/10: total=1.6240, vae=1.0918, dsb=0.4538, bio=0.1570
    Epoch  2/10: total=1.5400, vae=1.0920, dsb=0.4475, bio=0.0012
    Epoch  3/10: total=1.5257, vae=1.0910, dsb=0.4343, bio=0.0009
    Epoch  4/10: total=1.5244, vae=1.0910, dsb=0.4329, bio=0.0011
    Epoch  5/10: total=1.5394, vae=1.0908, dsb=0.4482, bio=0.0007
    Epoch  6/10: total=1.5306, vae=1.0903, dsb=0.4398, bio=0.0010
    Epoch  7/10: total=1.5131, vae=1.0901, dsb=0.4226, bio=0.0010
    Epoch  8/10: total=1.5202, vae=1.0904, dsb=0.4293, bio=0.0010
    Epoch  9/10: total=1.5132, vae=1.0911, dsb=0.4216, bio=0.0009
    Epoch 10/10: total=1.5265, vae=1.0901, dsb=0.4360, bio=0.0007

[Seed 22] Joint training (original) complete; models and history saved.

[Seed 22] Starting joint training (ablation)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=261.6331, vae=2.0227, dsb=259.6104, bio=0.0000
    Epoch  2/10: total=97.4960, vae=1.0868, dsb=96.4093, bio=0.0000
    Epoch  3/10: total=87.9546, vae=1.0862, dsb=86.8684, bio=0.0000
    Epoch  4/10: total=83.2094, vae=1.0858, dsb=82.1236, bio=0.0000
    Epoch  5/10: total=80.7502, vae=1.0847, dsb=79.6655, bio=0.0000
    Epoch  6/10: total=78.8861, vae=1.0847, dsb=77.8014, bio=0.0000
    Epoch  7/10: total=77.4252, vae=1.0848, dsb=76.3404, bio=0.0000
    Epoch  8/10: total=76.8412, vae=1.0840, dsb=75.7572, bio=0.0000
    Epoch  9/10: total=75.9899, vae=1.0850, dsb=74.9049, bio=0.0000
    Epoch 10/10: total=75.4417, vae=1.0841, dsb=74.3577, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=3.1079, vae=1.0848, dsb=2.0231, bio=0.0000
    Epoch  2/10: total=2.6448, vae=1.0840, dsb=1.5608, bio=0.0000
    Epoch  3/10: total=2.5182, vae=1.0852, dsb=1.4330, bio=0.0000
    Epoch  4/10: total=2.4509, vae=1.0850, dsb=1.3658, bio=0.0000
    Epoch  5/10: total=2.4416, vae=1.0837, dsb=1.3579, bio=0.0000
    Epoch  6/10: total=2.4046, vae=1.0849, dsb=1.3196, bio=0.0000
    Epoch  7/10: total=2.3893, vae=1.0844, dsb=1.3049, bio=0.0000
    Epoch  8/10: total=2.3484, vae=1.0842, dsb=1.2642, bio=0.0000
    Epoch  9/10: total=2.3232, vae=1.0848, dsb=1.2384, bio=0.0000
    Epoch 10/10: total=2.3373, vae=1.0841, dsb=1.2531, bio=0.0000

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=63.1377, vae=1.0847, dsb=62.0530, bio=0.0000
    Epoch  2/10: total=58.0094, vae=1.0836, dsb=56.9257, bio=0.0000
    Epoch  3/10: total=56.7596, vae=1.0839, dsb=55.6757, bio=0.0000
    Epoch  4/10: total=56.0855, vae=1.0828, dsb=55.0027, bio=0.0000
    Epoch  5/10: total=55.8229, vae=1.0838, dsb=54.7391, bio=0.0000
    Epoch  6/10: total=55.1475, vae=1.0846, dsb=54.0629, bio=0.0000
    Epoch  7/10: total=55.3103, vae=1.0839, dsb=54.2264, bio=0.0000
    Epoch  8/10: total=54.7674, vae=1.0837, dsb=53.6837, bio=0.0000
    Epoch  9/10: total=54.6233, vae=1.0838, dsb=53.5396, bio=0.0000
    Epoch 10/10: total=54.5247, vae=1.0835, dsb=53.4412, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=2.0417, vae=1.0833, dsb=0.9584, bio=0.0000
    Epoch  2/10: total=1.9389, vae=1.0841, dsb=0.8548, bio=0.0000
    Epoch  3/10: total=1.8995, vae=1.0838, dsb=0.8157, bio=0.0000
    Epoch  4/10: total=1.8850, vae=1.0845, dsb=0.8005, bio=0.0000
    Epoch  5/10: total=1.8745, vae=1.0840, dsb=0.7905, bio=0.0000
    Epoch  6/10: total=1.8841, vae=1.0841, dsb=0.8000, bio=0.0000
    Epoch  7/10: total=1.8568, vae=1.0845, dsb=0.7724, bio=0.0000
    Epoch  8/10: total=1.8546, vae=1.0845, dsb=0.7701, bio=0.0000
    Epoch  9/10: total=1.8191, vae=1.0838, dsb=0.7353, bio=0.0000
    Epoch 10/10: total=1.8507, vae=1.0849, dsb=0.7658, bio=0.0000

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=48.1152, vae=1.0841, dsb=47.0311, bio=0.0000
    Epoch  2/10: total=46.3517, vae=1.0837, dsb=45.2680, bio=0.0000
    Epoch  3/10: total=45.8568, vae=1.0835, dsb=44.7733, bio=0.0000
    Epoch  4/10: total=45.4360, vae=1.0840, dsb=44.3520, bio=0.0000
    Epoch  5/10: total=45.5947, vae=1.0845, dsb=44.5101, bio=0.0000
    Epoch  6/10: total=45.3861, vae=1.0848, dsb=44.3013, bio=0.0000
    Epoch  7/10: total=44.9743, vae=1.0842, dsb=43.8901, bio=0.0000
    Epoch  8/10: total=45.3929, vae=1.0844, dsb=44.3086, bio=0.0000
    Epoch  9/10: total=45.2384, vae=1.0839, dsb=44.1545, bio=0.0000
    Epoch 10/10: total=44.9531, vae=1.0841, dsb=43.8690, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.6967, vae=1.0841, dsb=0.6126, bio=0.0000
    Epoch  2/10: total=1.6589, vae=1.0841, dsb=0.5748, bio=0.0000
    Epoch  3/10: total=1.6595, vae=1.0827, dsb=0.5768, bio=0.0000
    Epoch  4/10: total=1.6552, vae=1.0841, dsb=0.5711, bio=0.0000
    Epoch  5/10: total=1.6386, vae=1.0838, dsb=0.5548, bio=0.0000
    Epoch  6/10: total=1.6316, vae=1.0842, dsb=0.5473, bio=0.0000
    Epoch  7/10: total=1.6466, vae=1.0839, dsb=0.5628, bio=0.0000
    Epoch  8/10: total=1.6431, vae=1.0842, dsb=0.5588, bio=0.0000
    Epoch  9/10: total=1.6466, vae=1.0843, dsb=0.5623, bio=0.0000
    Epoch 10/10: total=1.6255, vae=1.0837, dsb=0.5418, bio=0.0000

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=41.5416, vae=1.0837, dsb=40.4579, bio=0.0000
    Epoch  2/10: total=40.7380, vae=1.0849, dsb=39.6531, bio=0.0000
    Epoch  3/10: total=40.6570, vae=1.0844, dsb=39.5726, bio=0.0000
    Epoch  4/10: total=40.4653, vae=1.0841, dsb=39.3812, bio=0.0000
    Epoch  5/10: total=40.5388, vae=1.0839, dsb=39.4548, bio=0.0000
    Epoch  6/10: total=40.4849, vae=1.0843, dsb=39.4006, bio=0.0000
    Epoch  7/10: total=40.3402, vae=1.0842, dsb=39.2561, bio=0.0000
    Epoch  8/10: total=40.6144, vae=1.0840, dsb=39.5304, bio=0.0000
    Epoch  9/10: total=40.5643, vae=1.0841, dsb=39.4802, bio=0.0000
    Epoch 10/10: total=40.3979, vae=1.0842, dsb=39.3137, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.5825, vae=1.0839, dsb=0.4986, bio=0.0000
    Epoch  2/10: total=1.5599, vae=1.0837, dsb=0.4761, bio=0.0000
    Epoch  3/10: total=1.5383, vae=1.0842, dsb=0.4542, bio=0.0000
    Epoch  4/10: total=1.5270, vae=1.0839, dsb=0.4431, bio=0.0000
    Epoch  5/10: total=1.5453, vae=1.0843, dsb=0.4610, bio=0.0000
    Epoch  6/10: total=1.5388, vae=1.0836, dsb=0.4552, bio=0.0000
    Epoch  7/10: total=1.5353, vae=1.0833, dsb=0.4520, bio=0.0000
    Epoch  8/10: total=1.5427, vae=1.0847, dsb=0.4579, bio=0.0000
    Epoch  9/10: total=1.5375, vae=1.0850, dsb=0.4526, bio=0.0000
    Epoch 10/10: total=1.5466, vae=1.0846, dsb=0.4620, bio=0.0000

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=35.4990, vae=1.0830, dsb=34.4160, bio=0.0000
    Epoch  2/10: total=35.4995, vae=1.0843, dsb=34.4153, bio=0.0000
    Epoch  3/10: total=35.5500, vae=1.0837, dsb=34.4663, bio=0.0000
    Epoch  4/10: total=35.3162, vae=1.0837, dsb=34.2325, bio=0.0000
    Epoch  5/10: total=35.3381, vae=1.0837, dsb=34.2544, bio=0.0000
    Epoch  6/10: total=35.5691, vae=1.0844, dsb=34.4846, bio=0.0000
    Epoch  7/10: total=35.2431, vae=1.0836, dsb=34.1595, bio=0.0000
    Epoch  8/10: total=35.1581, vae=1.0840, dsb=34.0742, bio=0.0000
    Epoch  9/10: total=35.4954, vae=1.0836, dsb=34.4117, bio=0.0000
    Epoch 10/10: total=35.2271, vae=1.0842, dsb=34.1429, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.4878, vae=1.0830, dsb=0.4048, bio=0.0000
    Epoch  2/10: total=1.4846, vae=1.0845, dsb=0.4001, bio=0.0000
    Epoch  3/10: total=1.4721, vae=1.0839, dsb=0.3882, bio=0.0000
    Epoch  4/10: total=1.4713, vae=1.0841, dsb=0.3872, bio=0.0000
    Epoch  5/10: total=1.4857, vae=1.0839, dsb=0.4017, bio=0.0000
    Epoch  6/10: total=1.4776, vae=1.0837, dsb=0.3940, bio=0.0000
    Epoch  7/10: total=1.4615, vae=1.0835, dsb=0.3780, bio=0.0000
    Epoch  8/10: total=1.4681, vae=1.0839, dsb=0.3842, bio=0.0000
    Epoch  9/10: total=1.4622, vae=1.0846, dsb=0.3776, bio=0.0000
    Epoch 10/10: total=1.4747, vae=1.0836, dsb=0.3911, bio=0.0000

[Seed 22] Joint training (ablation) complete; models and history saved.

[Seed 22] Drift genes saved in /home/yyuan/ICB_TCE/iter_results/run_022

[Seed 22] run finished.

================================================================================
[Seed 23] Starting running whole pipeline...
================================================================================

[Seed 23] Starting VAE pre-training...

    Epoch [01/20], Beta: 0.000, Average Loss: 536.6779
    Epoch [02/20], Beta: 0.000, Average Loss: 312.7586
    Epoch [03/20], Beta: 0.000, Average Loss: 272.2759
    Epoch [04/20], Beta: 0.000, Average Loss: 252.2268
    Epoch [05/20], Beta: 0.100, Average Loss: 246.8603
    Epoch [06/20], Beta: 0.200, Average Loss: 245.2058
    Epoch [07/20], Beta: 0.300, Average Loss: 244.8741
    Epoch [08/20], Beta: 0.400, Average Loss: 245.3806
    Epoch [09/20], Beta: 0.500, Average Loss: 246.3266
    Epoch [10/20], Beta: 0.600, Average Loss: 247.4443
    Epoch [11/20], Beta: 0.700, Average Loss: 248.6690
    Epoch [12/20], Beta: 0.800, Average Loss: 249.9351
    Epoch [13/20], Beta: 0.900, Average Loss: 251.1993
    Epoch [14/20], Beta: 1.000, Average Loss: 252.4624
    Epoch [15/20], Beta: 1.000, Average Loss: 251.9975
    Epoch [16/20], Beta: 1.000, Average Loss: 251.7059
    Epoch [17/20], Beta: 1.000, Average Loss: 251.3542
    Epoch [18/20], Beta: 1.000, Average Loss: 251.0779
    Epoch [19/20], Beta: 1.000, Average Loss: 250.7837
    Epoch [20/20], Beta: 1.000, Average Loss: 250.4452

[Seed 23] VAE pre-training complete.

[Seed 23] Starting joint training (original)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=707.2319, vae=3.9226, dsb=682.3955, bio=41.8276
    Epoch  2/10: total=169.6536, vae=1.0968, dsb=168.5175, bio=0.0786
    Epoch  3/10: total=156.9790, vae=1.0912, dsb=155.8697, bio=0.0361
    Epoch  4/10: total=150.2359, vae=1.0901, dsb=149.1346, bio=0.0222
    Epoch  5/10: total=145.6383, vae=1.0891, dsb=144.5415, bio=0.0152
    Epoch  6/10: total=143.7329, vae=1.0881, dsb=142.6393, bio=0.0110
    Epoch  7/10: total=141.5285, vae=1.0876, dsb=140.4366, bio=0.0085
    Epoch  8/10: total=139.4465, vae=1.0870, dsb=138.3560, bio=0.0069
    Epoch  9/10: total=139.5415, vae=1.0876, dsb=138.4511, bio=0.0056
    Epoch 10/10: total=138.4514, vae=1.0869, dsb=137.3621, bio=0.0048

  [Backward Policy Training]
    Epoch  1/10: total=3.5881, vae=1.0885, dsb=2.4924, bio=0.0144
    Epoch  2/10: total=3.0071, vae=1.0862, dsb=1.9184, bio=0.0049
    Epoch  3/10: total=2.8664, vae=1.0869, dsb=1.7778, bio=0.0034
    Epoch  4/10: total=2.8115, vae=1.0860, dsb=1.7241, bio=0.0028
    Epoch  5/10: total=2.7155, vae=1.0863, dsb=1.6280, bio=0.0024
    Epoch  6/10: total=2.7595, vae=1.0851, dsb=1.6733, bio=0.0021
    Epoch  7/10: total=2.6818, vae=1.0843, dsb=1.5965, bio=0.0020
    Epoch  8/10: total=2.6327, vae=1.0854, dsb=1.5464, bio=0.0019
    Epoch  9/10: total=2.6423, vae=1.0849, dsb=1.5564, bio=0.0019
    Epoch 10/10: total=2.6067, vae=1.0852, dsb=1.5206, bio=0.0018

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=118.6277, vae=1.0877, dsb=117.5384, bio=0.0032
    Epoch  2/10: total=111.0072, vae=1.0864, dsb=109.9199, bio=0.0017
    Epoch  3/10: total=109.0695, vae=1.0856, dsb=107.9831, bio=0.0017
    Epoch  4/10: total=107.0613, vae=1.0859, dsb=105.9744, bio=0.0020
    Epoch  5/10: total=106.8604, vae=1.0858, dsb=105.7739, bio=0.0016
    Epoch  6/10: total=105.7148, vae=1.0858, dsb=104.6282, bio=0.0016
    Epoch  7/10: total=105.0722, vae=1.0850, dsb=103.9865, bio=0.0016
    Epoch  8/10: total=104.7474, vae=1.0850, dsb=103.6614, bio=0.0020
    Epoch  9/10: total=104.8234, vae=1.0849, dsb=103.7376, bio=0.0016
    Epoch 10/10: total=104.8684, vae=1.0859, dsb=103.7817, bio=0.0016

  [Backward Policy Training]
    Epoch  1/10: total=2.3628, vae=1.0852, dsb=1.2747, bio=0.0058
    Epoch  2/10: total=2.1995, vae=1.0844, dsb=1.1143, bio=0.0017
    Epoch  3/10: total=2.1960, vae=1.0832, dsb=1.1120, bio=0.0016
    Epoch  4/10: total=2.1971, vae=1.0835, dsb=1.1128, bio=0.0016
    Epoch  5/10: total=2.1677, vae=1.0834, dsb=1.0836, bio=0.0014
    Epoch  6/10: total=2.1282, vae=1.0844, dsb=1.0431, bio=0.0014
    Epoch  7/10: total=2.1490, vae=1.0835, dsb=1.0648, bio=0.0014
    Epoch  8/10: total=2.1137, vae=1.0835, dsb=1.0295, bio=0.0014
    Epoch  9/10: total=2.0968, vae=1.0835, dsb=1.0126, bio=0.0014
    Epoch 10/10: total=2.1233, vae=1.0836, dsb=1.0390, bio=0.0013

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=95.7777, vae=1.0854, dsb=94.6909, bio=0.0027
    Epoch  2/10: total=91.8986, vae=1.0841, dsb=90.8138, bio=0.0014
    Epoch  3/10: total=90.9060, vae=1.0843, dsb=89.8210, bio=0.0014
    Epoch  4/10: total=91.4069, vae=1.0842, dsb=90.3220, bio=0.0014
    Epoch  5/10: total=90.6944, vae=1.0847, dsb=89.6090, bio=0.0014
    Epoch  6/10: total=90.8830, vae=1.0838, dsb=89.7985, bio=0.0014
    Epoch  7/10: total=90.6148, vae=1.0840, dsb=89.5301, bio=0.0014
    Epoch  8/10: total=90.6061, vae=1.0848, dsb=89.5204, bio=0.0016
    Epoch  9/10: total=90.5810, vae=1.0833, dsb=89.4971, bio=0.0013
    Epoch 10/10: total=90.0125, vae=1.0837, dsb=88.9281, bio=0.0014

  [Backward Policy Training]
    Epoch  1/10: total=1.9872, vae=1.0842, dsb=0.8907, bio=0.0245
    Epoch  2/10: total=1.9001, vae=1.0832, dsb=0.8162, bio=0.0014
    Epoch  3/10: total=1.8809, vae=1.0831, dsb=0.7971, bio=0.0013
    Epoch  4/10: total=1.8820, vae=1.0831, dsb=0.7983, bio=0.0013
    Epoch  5/10: total=1.8735, vae=1.0838, dsb=0.7890, bio=0.0014
    Epoch  6/10: total=1.8704, vae=1.0835, dsb=0.7863, bio=0.0012
    Epoch  7/10: total=1.8527, vae=1.0834, dsb=0.7687, bio=0.0012
    Epoch  8/10: total=1.8510, vae=1.0830, dsb=0.7674, bio=0.0012
    Epoch  9/10: total=1.8549, vae=1.0833, dsb=0.7710, bio=0.0012
    Epoch 10/10: total=1.8458, vae=1.0823, dsb=0.7629, bio=0.0012

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=83.6664, vae=1.0863, dsb=82.5788, bio=0.0027
    Epoch  2/10: total=82.3398, vae=1.0843, dsb=81.2549, bio=0.0013
    Epoch  3/10: total=81.9999, vae=1.0834, dsb=80.9159, bio=0.0013
    Epoch  4/10: total=82.3902, vae=1.0835, dsb=81.3061, bio=0.0013
    Epoch  5/10: total=82.1937, vae=1.0846, dsb=81.1085, bio=0.0012
    Epoch  6/10: total=81.7181, vae=1.0838, dsb=80.6337, bio=0.0012
    Epoch  7/10: total=81.3235, vae=1.0831, dsb=80.2399, bio=0.0012
    Epoch  8/10: total=81.1006, vae=1.0832, dsb=80.0169, bio=0.0012
    Epoch  9/10: total=81.6216, vae=1.0832, dsb=80.5377, bio=0.0013
    Epoch 10/10: total=81.7413, vae=1.0828, dsb=80.6580, bio=0.0011

  [Backward Policy Training]
    Epoch  1/10: total=1.8696, vae=1.0842, dsb=0.7040, bio=0.1630
    Epoch  2/10: total=1.7507, vae=1.0829, dsb=0.6672, bio=0.0013
    Epoch  3/10: total=1.7469, vae=1.0836, dsb=0.6627, bio=0.0012
    Epoch  4/10: total=1.7515, vae=1.0830, dsb=0.6680, bio=0.0011
    Epoch  5/10: total=1.7689, vae=1.0824, dsb=0.6860, bio=0.0011
    Epoch  6/10: total=1.7223, vae=1.0827, dsb=0.6390, bio=0.0012
    Epoch  7/10: total=1.7201, vae=1.0824, dsb=0.6371, bio=0.0011
    Epoch  8/10: total=1.7180, vae=1.0829, dsb=0.6345, bio=0.0010
    Epoch  9/10: total=1.7131, vae=1.0816, dsb=0.6310, bio=0.0011
    Epoch 10/10: total=1.7411, vae=1.0817, dsb=0.6589, bio=0.0010

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=65.2126, vae=1.0841, dsb=64.1268, bio=0.0033
    Epoch  2/10: total=64.9179, vae=1.0837, dsb=63.8336, bio=0.0011
    Epoch  3/10: total=64.6769, vae=1.0844, dsb=63.5920, bio=0.0011
    Epoch  4/10: total=65.1325, vae=1.0838, dsb=64.0481, bio=0.0011
    Epoch  5/10: total=65.0009, vae=1.0831, dsb=63.9174, bio=0.0008
    Epoch  6/10: total=65.3696, vae=1.0829, dsb=64.2861, bio=0.0012
    Epoch  7/10: total=64.6290, vae=1.0830, dsb=63.5454, bio=0.0011
    Epoch  8/10: total=64.8421, vae=1.0831, dsb=63.7584, bio=0.0011
    Epoch  9/10: total=64.8119, vae=1.0829, dsb=63.7287, bio=0.0007
    Epoch 10/10: total=64.7207, vae=1.0830, dsb=63.6372, bio=0.0010

  [Backward Policy Training]
    Epoch  1/10: total=1.7346, vae=1.0837, dsb=0.5648, bio=0.1722
    Epoch  2/10: total=1.6206, vae=1.0827, dsb=0.5373, bio=0.0012
    Epoch  3/10: total=1.6329, vae=1.0826, dsb=0.5498, bio=0.0011
    Epoch  4/10: total=1.6253, vae=1.0832, dsb=0.5417, bio=0.0008
    Epoch  5/10: total=1.6334, vae=1.0825, dsb=0.5503, bio=0.0011
    Epoch  6/10: total=1.6269, vae=1.0819, dsb=0.5445, bio=0.0010
    Epoch  7/10: total=1.6172, vae=1.0814, dsb=0.5353, bio=0.0010
    Epoch  8/10: total=1.6212, vae=1.0819, dsb=0.5388, bio=0.0010
    Epoch  9/10: total=1.6311, vae=1.0818, dsb=0.5489, bio=0.0007
    Epoch 10/10: total=1.6197, vae=1.0809, dsb=0.5384, bio=0.0009

[Seed 23] Joint training (original) complete; models and history saved.

[Seed 23] Starting joint training (ablation)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=683.6872, vae=2.0606, dsb=681.6267, bio=0.0000
    Epoch  2/10: total=168.2677, vae=1.0796, dsb=167.1881, bio=0.0000
    Epoch  3/10: total=156.1837, vae=1.0769, dsb=155.1068, bio=0.0000
    Epoch  4/10: total=149.7276, vae=1.0768, dsb=148.6508, bio=0.0000
    Epoch  5/10: total=145.0205, vae=1.0763, dsb=143.9442, bio=0.0000
    Epoch  6/10: total=142.9886, vae=1.0756, dsb=141.9130, bio=0.0000
    Epoch  7/10: total=140.7574, vae=1.0754, dsb=139.6820, bio=0.0000
    Epoch  8/10: total=138.7044, vae=1.0751, dsb=137.6293, bio=0.0000
    Epoch  9/10: total=138.8061, vae=1.0759, dsb=137.7302, bio=0.0000
    Epoch 10/10: total=137.7510, vae=1.0755, dsb=136.6756, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=3.4293, vae=1.0759, dsb=2.3534, bio=0.0000
    Epoch  2/10: total=2.8742, vae=1.0753, dsb=1.7989, bio=0.0000
    Epoch  3/10: total=2.7432, vae=1.0764, dsb=1.6667, bio=0.0000
    Epoch  4/10: total=2.6921, vae=1.0758, dsb=1.6163, bio=0.0000
    Epoch  5/10: total=2.6032, vae=1.0764, dsb=1.5268, bio=0.0000
    Epoch  6/10: total=2.6479, vae=1.0753, dsb=1.5726, bio=0.0000
    Epoch  7/10: total=2.5752, vae=1.0746, dsb=1.5006, bio=0.0000
    Epoch  8/10: total=2.5301, vae=1.0758, dsb=1.4544, bio=0.0000
    Epoch  9/10: total=2.5403, vae=1.0753, dsb=1.4649, bio=0.0000
    Epoch 10/10: total=2.5074, vae=1.0757, dsb=1.4317, bio=0.0000

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=118.7550, vae=1.0755, dsb=117.6795, bio=0.0000
    Epoch  2/10: total=111.7845, vae=1.0755, dsb=110.7090, bio=0.0000
    Epoch  3/10: total=110.0444, vae=1.0749, dsb=108.9694, bio=0.0000
    Epoch  4/10: total=108.1070, vae=1.0755, dsb=107.0315, bio=0.0000
    Epoch  5/10: total=108.1165, vae=1.0755, dsb=107.0409, bio=0.0000
    Epoch  6/10: total=107.0765, vae=1.0756, dsb=106.0008, bio=0.0000
    Epoch  7/10: total=106.2978, vae=1.0749, dsb=105.2229, bio=0.0000
    Epoch  8/10: total=106.1431, vae=1.0751, dsb=105.0681, bio=0.0000
    Epoch  9/10: total=106.1433, vae=1.0751, dsb=105.0682, bio=0.0000
    Epoch 10/10: total=106.2833, vae=1.0762, dsb=105.2071, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=2.2646, vae=1.0747, dsb=1.1899, bio=0.0000
    Epoch  2/10: total=2.1189, vae=1.0754, dsb=1.0435, bio=0.0000
    Epoch  3/10: total=2.1190, vae=1.0744, dsb=1.0446, bio=0.0000
    Epoch  4/10: total=2.1205, vae=1.0746, dsb=1.0459, bio=0.0000
    Epoch  5/10: total=2.0948, vae=1.0748, dsb=1.0200, bio=0.0000
    Epoch  6/10: total=2.0570, vae=1.0758, dsb=0.9812, bio=0.0000
    Epoch  7/10: total=2.0779, vae=1.0750, dsb=1.0029, bio=0.0000
    Epoch  8/10: total=2.0433, vae=1.0749, dsb=0.9683, bio=0.0000
    Epoch  9/10: total=2.0279, vae=1.0750, dsb=0.9529, bio=0.0000
    Epoch 10/10: total=2.0534, vae=1.0752, dsb=0.9782, bio=0.0000

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=95.0253, vae=1.0744, dsb=93.9508, bio=0.0000
    Epoch  2/10: total=91.0348, vae=1.0745, dsb=89.9603, bio=0.0000
    Epoch  3/10: total=90.1764, vae=1.0749, dsb=89.1015, bio=0.0000
    Epoch  4/10: total=90.5901, vae=1.0749, dsb=89.5152, bio=0.0000
    Epoch  5/10: total=89.8620, vae=1.0755, dsb=88.7865, bio=0.0000
    Epoch  6/10: total=90.0660, vae=1.0746, dsb=88.9913, bio=0.0000
    Epoch  7/10: total=89.8947, vae=1.0750, dsb=88.8198, bio=0.0000
    Epoch  8/10: total=89.7793, vae=1.0758, dsb=88.7035, bio=0.0000
    Epoch  9/10: total=89.8273, vae=1.0745, dsb=88.7528, bio=0.0000
    Epoch 10/10: total=89.2403, vae=1.0749, dsb=88.1654, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.9201, vae=1.0748, dsb=0.8454, bio=0.0000
    Epoch  2/10: total=1.8472, vae=1.0748, dsb=0.7724, bio=0.0000
    Epoch  3/10: total=1.8295, vae=1.0748, dsb=0.7547, bio=0.0000
    Epoch  4/10: total=1.8307, vae=1.0749, dsb=0.7559, bio=0.0000
    Epoch  5/10: total=1.8226, vae=1.0756, dsb=0.7470, bio=0.0000
    Epoch  6/10: total=1.8197, vae=1.0755, dsb=0.7442, bio=0.0000
    Epoch  7/10: total=1.8032, vae=1.0753, dsb=0.7279, bio=0.0000
    Epoch  8/10: total=1.8013, vae=1.0749, dsb=0.7263, bio=0.0000
    Epoch  9/10: total=1.8052, vae=1.0754, dsb=0.7298, bio=0.0000
    Epoch 10/10: total=1.7964, vae=1.0744, dsb=0.7220, bio=0.0000

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=76.7974, vae=1.0758, dsb=75.7216, bio=0.0000
    Epoch  2/10: total=75.3904, vae=1.0753, dsb=74.3151, bio=0.0000
    Epoch  3/10: total=75.1817, vae=1.0747, dsb=74.1070, bio=0.0000
    Epoch  4/10: total=75.4275, vae=1.0749, dsb=74.3527, bio=0.0000
    Epoch  5/10: total=75.2458, vae=1.0762, dsb=74.1696, bio=0.0000
    Epoch  6/10: total=74.7663, vae=1.0754, dsb=73.6908, bio=0.0000
    Epoch  7/10: total=74.4507, vae=1.0748, dsb=73.3759, bio=0.0000
    Epoch  8/10: total=74.3075, vae=1.0750, dsb=73.2326, bio=0.0000
    Epoch  9/10: total=74.6993, vae=1.0751, dsb=73.6242, bio=0.0000
    Epoch 10/10: total=74.7980, vae=1.0748, dsb=73.7232, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.7222, vae=1.0749, dsb=0.6474, bio=0.0000
    Epoch  2/10: total=1.6865, vae=1.0748, dsb=0.6118, bio=0.0000
    Epoch  3/10: total=1.6824, vae=1.0756, dsb=0.6068, bio=0.0000
    Epoch  4/10: total=1.6863, vae=1.0752, dsb=0.6112, bio=0.0000
    Epoch  5/10: total=1.7022, vae=1.0746, dsb=0.6276, bio=0.0000
    Epoch  6/10: total=1.6587, vae=1.0749, dsb=0.5838, bio=0.0000
    Epoch  7/10: total=1.6566, vae=1.0748, dsb=0.5817, bio=0.0000
    Epoch  8/10: total=1.6539, vae=1.0754, dsb=0.5785, bio=0.0000
    Epoch  9/10: total=1.6491, vae=1.0742, dsb=0.5750, bio=0.0000
    Epoch 10/10: total=1.6742, vae=1.0744, dsb=0.5997, bio=0.0000

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=59.0497, vae=1.0741, dsb=57.9756, bio=0.0000
    Epoch  2/10: total=58.6880, vae=1.0749, dsb=57.6131, bio=0.0000
    Epoch  3/10: total=58.4085, vae=1.0757, dsb=57.3328, bio=0.0000
    Epoch  4/10: total=58.8724, vae=1.0753, dsb=57.7971, bio=0.0000
    Epoch  5/10: total=58.7744, vae=1.0749, dsb=57.6995, bio=0.0000
    Epoch  6/10: total=59.0151, vae=1.0749, dsb=57.9402, bio=0.0000
    Epoch  7/10: total=58.4202, vae=1.0751, dsb=57.3451, bio=0.0000
    Epoch  8/10: total=58.5937, vae=1.0753, dsb=57.5184, bio=0.0000
    Epoch  9/10: total=58.6369, vae=1.0751, dsb=57.5619, bio=0.0000
    Epoch 10/10: total=58.4485, vae=1.0754, dsb=57.3731, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.5803, vae=1.0747, dsb=0.5056, bio=0.0000
    Epoch  2/10: total=1.5557, vae=1.0749, dsb=0.4808, bio=0.0000
    Epoch  3/10: total=1.5674, vae=1.0751, dsb=0.4924, bio=0.0000
    Epoch  4/10: total=1.5612, vae=1.0757, dsb=0.4855, bio=0.0000
    Epoch  5/10: total=1.5688, vae=1.0754, dsb=0.4934, bio=0.0000
    Epoch  6/10: total=1.5631, vae=1.0749, dsb=0.4883, bio=0.0000
    Epoch  7/10: total=1.5545, vae=1.0745, dsb=0.4800, bio=0.0000
    Epoch  8/10: total=1.5578, vae=1.0750, dsb=0.4828, bio=0.0000
    Epoch  9/10: total=1.5668, vae=1.0750, dsb=0.4918, bio=0.0000
    Epoch 10/10: total=1.5569, vae=1.0741, dsb=0.4827, bio=0.0000

[Seed 23] Joint training (ablation) complete; models and history saved.

[Seed 23] Drift genes saved in /home/yyuan/ICB_TCE/iter_results/run_023

[Seed 23] run finished.

================================================================================
[Seed 24] Starting running whole pipeline...
================================================================================

[Seed 24] Starting VAE pre-training...

    Epoch [01/20], Beta: 0.000, Average Loss: 533.5691
    Epoch [02/20], Beta: 0.000, Average Loss: 307.9824
    Epoch [03/20], Beta: 0.000, Average Loss: 272.3803
    Epoch [04/20], Beta: 0.000, Average Loss: 251.7639
    Epoch [05/20], Beta: 0.100, Average Loss: 245.3022
    Epoch [06/20], Beta: 0.200, Average Loss: 243.7777
    Epoch [07/20], Beta: 0.300, Average Loss: 244.0475
    Epoch [08/20], Beta: 0.400, Average Loss: 244.9410
    Epoch [09/20], Beta: 0.500, Average Loss: 246.0209
    Epoch [10/20], Beta: 0.600, Average Loss: 247.3317
    Epoch [11/20], Beta: 0.700, Average Loss: 248.6634
    Epoch [12/20], Beta: 0.800, Average Loss: 250.0771
    Epoch [13/20], Beta: 0.900, Average Loss: 251.3802
    Epoch [14/20], Beta: 1.000, Average Loss: 252.9726
    Epoch [15/20], Beta: 1.000, Average Loss: 252.5819
    Epoch [16/20], Beta: 1.000, Average Loss: 252.2435
    Epoch [17/20], Beta: 1.000, Average Loss: 251.9046
    Epoch [18/20], Beta: 1.000, Average Loss: 251.6369
    Epoch [19/20], Beta: 1.000, Average Loss: 251.2375
    Epoch [20/20], Beta: 1.000, Average Loss: 251.1177

[Seed 24] VAE pre-training complete.

[Seed 24] Starting joint training (original)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=384.3024, vae=3.5415, dsb=366.5790, bio=28.3639
    Epoch  2/10: total=118.0854, vae=1.1128, dsb=116.9341, bio=0.0769
    Epoch  3/10: total=107.4921, vae=1.1078, dsb=106.3665, bio=0.0356
    Epoch  4/10: total=102.6785, vae=1.1045, dsb=101.5635, bio=0.0211
    Epoch  5/10: total=99.5782, vae=1.1040, dsb=98.4669, bio=0.0147
    Epoch  6/10: total=97.1431, vae=1.1036, dsb=96.0339, bio=0.0111
    Epoch  7/10: total=95.7434, vae=1.1031, dsb=94.6359, bio=0.0087
    Epoch  8/10: total=94.5175, vae=1.1038, dsb=93.4100, bio=0.0074
    Epoch  9/10: total=93.4263, vae=1.1031, dsb=92.3201, bio=0.0061
    Epoch 10/10: total=92.8588, vae=1.1018, dsb=91.7543, bio=0.0054

  [Backward Policy Training]
    Epoch  1/10: total=3.4298, vae=1.1048, dsb=2.3132, bio=0.0237
    Epoch  2/10: total=2.9773, vae=1.1019, dsb=1.8716, bio=0.0077
    Epoch  3/10: total=2.8588, vae=1.1021, dsb=1.7541, bio=0.0051
    Epoch  4/10: total=2.7483, vae=1.1013, dsb=1.6450, bio=0.0040
    Epoch  5/10: total=2.7029, vae=1.1022, dsb=1.5990, bio=0.0033
    Epoch  6/10: total=2.7067, vae=1.1010, dsb=1.6043, bio=0.0029
    Epoch  7/10: total=2.7053, vae=1.1001, dsb=1.6038, bio=0.0029
    Epoch  8/10: total=2.6144, vae=1.1004, dsb=1.5128, bio=0.0024
    Epoch  9/10: total=2.5947, vae=1.0991, dsb=1.4944, bio=0.0022
    Epoch 10/10: total=2.5992, vae=1.1002, dsb=1.4979, bio=0.0021

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=82.4674, vae=1.1035, dsb=81.3614, bio=0.0051
    Epoch  2/10: total=77.2267, vae=1.1014, dsb=76.1242, bio=0.0022
    Epoch  3/10: total=76.0909, vae=1.1019, dsb=74.9880, bio=0.0020
    Epoch  4/10: total=75.0112, vae=1.1014, dsb=73.9089, bio=0.0019
    Epoch  5/10: total=74.6394, vae=1.1013, dsb=73.5370, bio=0.0021
    Epoch  6/10: total=74.3216, vae=1.1011, dsb=73.2196, bio=0.0019
    Epoch  7/10: total=73.9869, vae=1.1001, dsb=72.8859, bio=0.0019
    Epoch  8/10: total=73.8225, vae=1.1009, dsb=72.7207, bio=0.0019
    Epoch  9/10: total=73.6792, vae=1.1013, dsb=72.5770, bio=0.0019
    Epoch 10/10: total=73.6714, vae=1.1000, dsb=72.5705, bio=0.0019

  [Backward Policy Training]
    Epoch  1/10: total=2.3405, vae=1.1009, dsb=1.2366, bio=0.0061
    Epoch  2/10: total=2.2352, vae=1.1003, dsb=1.1338, bio=0.0020
    Epoch  3/10: total=2.2394, vae=1.0994, dsb=1.1391, bio=0.0018
    Epoch  4/10: total=2.2182, vae=1.0997, dsb=1.1177, bio=0.0017
    Epoch  5/10: total=2.1858, vae=1.1000, dsb=1.0850, bio=0.0016
    Epoch  6/10: total=2.1894, vae=1.0996, dsb=1.0890, bio=0.0016
    Epoch  7/10: total=2.1683, vae=1.0997, dsb=1.0678, bio=0.0015
    Epoch  8/10: total=2.1520, vae=1.0995, dsb=1.0518, bio=0.0014
    Epoch  9/10: total=2.1516, vae=1.0986, dsb=1.0523, bio=0.0014
    Epoch 10/10: total=2.1528, vae=1.0990, dsb=1.0531, bio=0.0014

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=65.8244, vae=1.1022, dsb=64.7203, bio=0.0037
    Epoch  2/10: total=63.7304, vae=1.1000, dsb=62.6296, bio=0.0016
    Epoch  3/10: total=63.3586, vae=1.1006, dsb=62.2572, bio=0.0015
    Epoch  4/10: total=63.0636, vae=1.1000, dsb=61.9628, bio=0.0016
    Epoch  5/10: total=63.0222, vae=1.0997, dsb=61.9216, bio=0.0018
    Epoch  6/10: total=62.8070, vae=1.0985, dsb=61.7077, bio=0.0015
    Epoch  7/10: total=62.4914, vae=1.1004, dsb=61.3903, bio=0.0015
    Epoch  8/10: total=62.3242, vae=1.0995, dsb=61.2239, bio=0.0015
    Epoch  9/10: total=62.4099, vae=1.0998, dsb=61.3094, bio=0.0015
    Epoch 10/10: total=62.2456, vae=1.0999, dsb=61.1449, bio=0.0015

  [Backward Policy Training]
    Epoch  1/10: total=2.0226, vae=1.0995, dsb=0.9187, bio=0.0089
    Epoch  2/10: total=1.9677, vae=1.1005, dsb=0.8665, bio=0.0015
    Epoch  3/10: total=1.9329, vae=1.0990, dsb=0.8332, bio=0.0013
    Epoch  4/10: total=1.9011, vae=1.0992, dsb=0.8013, bio=0.0012
    Epoch  5/10: total=1.8867, vae=1.0996, dsb=0.7865, bio=0.0014
    Epoch  6/10: total=1.8964, vae=1.0988, dsb=0.7969, bio=0.0011
    Epoch  7/10: total=1.8870, vae=1.0991, dsb=0.7873, bio=0.0011
    Epoch  8/10: total=1.9021, vae=1.0990, dsb=0.8026, bio=0.0012
    Epoch  9/10: total=1.8969, vae=1.0987, dsb=0.7976, bio=0.0012
    Epoch 10/10: total=1.8980, vae=1.0981, dsb=0.7993, bio=0.0012

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=52.7226, vae=1.1014, dsb=51.6197, bio=0.0030
    Epoch  2/10: total=51.7201, vae=1.0999, dsb=50.6196, bio=0.0013
    Epoch  3/10: total=51.7902, vae=1.0995, dsb=50.6900, bio=0.0013
    Epoch  4/10: total=51.7667, vae=1.0992, dsb=50.6668, bio=0.0014
    Epoch  5/10: total=51.3554, vae=1.0991, dsb=50.2557, bio=0.0013
    Epoch  6/10: total=51.4985, vae=1.0996, dsb=50.3983, bio=0.0013
    Epoch  7/10: total=51.5754, vae=1.0994, dsb=50.4754, bio=0.0013
    Epoch  8/10: total=51.1235, vae=1.0986, dsb=50.0242, bio=0.0014
    Epoch  9/10: total=51.1739, vae=1.0985, dsb=50.0748, bio=0.0012
    Epoch 10/10: total=51.3822, vae=1.0995, dsb=50.2822, bio=0.0012

  [Backward Policy Training]
    Epoch  1/10: total=1.8663, vae=1.1004, dsb=0.7298, bio=0.0723
    Epoch  2/10: total=1.8413, vae=1.0982, dsb=0.7425, bio=0.0012
    Epoch  3/10: total=1.8179, vae=1.0974, dsb=0.7199, bio=0.0011
    Epoch  4/10: total=1.7944, vae=1.0981, dsb=0.6957, bio=0.0011
    Epoch  5/10: total=1.8198, vae=1.0985, dsb=0.7208, bio=0.0010
    Epoch  6/10: total=1.8193, vae=1.0977, dsb=0.7211, bio=0.0010
    Epoch  7/10: total=1.7999, vae=1.0979, dsb=0.7015, bio=0.0010
    Epoch  8/10: total=1.8011, vae=1.0979, dsb=0.7027, bio=0.0011
    Epoch  9/10: total=1.7962, vae=1.0985, dsb=0.6973, bio=0.0009
    Epoch 10/10: total=1.8083, vae=1.0982, dsb=0.7096, bio=0.0010

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=48.3009, vae=1.1015, dsb=47.1980, bio=0.0029
    Epoch  2/10: total=47.9398, vae=1.0994, dsb=46.8398, bio=0.0012
    Epoch  3/10: total=48.0525, vae=1.0991, dsb=46.9529, bio=0.0012
    Epoch  4/10: total=47.8183, vae=1.0993, dsb=46.7186, bio=0.0010
    Epoch  5/10: total=47.7464, vae=1.0980, dsb=46.6478, bio=0.0012
    Epoch  6/10: total=47.9134, vae=1.0978, dsb=46.8151, bio=0.0011
    Epoch  7/10: total=47.7047, vae=1.0987, dsb=46.6054, bio=0.0011
    Epoch  8/10: total=47.7311, vae=1.0981, dsb=46.6324, bio=0.0010
    Epoch  9/10: total=47.7631, vae=1.0985, dsb=46.6641, bio=0.0010
    Epoch 10/10: total=47.7633, vae=1.0983, dsb=46.6646, bio=0.0007

  [Backward Policy Training]
    Epoch  1/10: total=1.7965, vae=1.0996, dsb=0.6371, bio=0.1196
    Epoch  2/10: total=1.7170, vae=1.0989, dsb=0.6175, bio=0.0012
    Epoch  3/10: total=1.7225, vae=1.0982, dsb=0.6239, bio=0.0008
    Epoch  4/10: total=1.7252, vae=1.0979, dsb=0.6267, bio=0.0009
    Epoch  5/10: total=1.7287, vae=1.0982, dsb=0.6299, bio=0.0010
    Epoch  6/10: total=1.7301, vae=1.0972, dsb=0.6324, bio=0.0008
    Epoch  7/10: total=1.7074, vae=1.0983, dsb=0.6086, bio=0.0011
    Epoch  8/10: total=1.7023, vae=1.0969, dsb=0.6049, bio=0.0010
    Epoch  9/10: total=1.7312, vae=1.0980, dsb=0.6327, bio=0.0010
    Epoch 10/10: total=1.7154, vae=1.0978, dsb=0.6172, bio=0.0010

[Seed 24] Joint training (original) complete; models and history saved.

[Seed 24] Starting joint training (ablation)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=367.5142, vae=2.0327, dsb=365.4815, bio=0.0000
    Epoch  2/10: total=116.6867, vae=1.0950, dsb=115.5917, bio=0.0000
    Epoch  3/10: total=106.5358, vae=1.0935, dsb=105.4423, bio=0.0000
    Epoch  4/10: total=102.0320, vae=1.0913, dsb=100.9407, bio=0.0000
    Epoch  5/10: total=99.1070, vae=1.0910, dsb=98.0160, bio=0.0000
    Epoch  6/10: total=96.6528, vae=1.0910, dsb=95.5618, bio=0.0000
    Epoch  7/10: total=95.2570, vae=1.0908, dsb=94.1661, bio=0.0000
    Epoch  8/10: total=94.0130, vae=1.0918, dsb=92.9212, bio=0.0000
    Epoch  9/10: total=92.9939, vae=1.0914, dsb=91.9024, bio=0.0000
    Epoch 10/10: total=92.4318, vae=1.0903, dsb=91.3415, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=3.2849, vae=1.0922, dsb=2.1927, bio=0.0000
    Epoch  2/10: total=2.8610, vae=1.0909, dsb=1.7701, bio=0.0000
    Epoch  3/10: total=2.7515, vae=1.0916, dsb=1.6599, bio=0.0000
    Epoch  4/10: total=2.6465, vae=1.0911, dsb=1.5555, bio=0.0000
    Epoch  5/10: total=2.6042, vae=1.0922, dsb=1.5120, bio=0.0000
    Epoch  6/10: total=2.6066, vae=1.0912, dsb=1.5154, bio=0.0000
    Epoch  7/10: total=2.6051, vae=1.0903, dsb=1.5148, bio=0.0000
    Epoch  8/10: total=2.5182, vae=1.0908, dsb=1.4273, bio=0.0000
    Epoch  9/10: total=2.5006, vae=1.0897, dsb=1.4110, bio=0.0000
    Epoch 10/10: total=2.5054, vae=1.0907, dsb=1.4147, bio=0.0000

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=80.3378, vae=1.0911, dsb=79.2467, bio=0.0000
    Epoch  2/10: total=75.1584, vae=1.0905, dsb=74.0679, bio=0.0000
    Epoch  3/10: total=74.0570, vae=1.0911, dsb=72.9659, bio=0.0000
    Epoch  4/10: total=72.9498, vae=1.0908, dsb=71.8590, bio=0.0000
    Epoch  5/10: total=72.5720, vae=1.0908, dsb=71.4812, bio=0.0000
    Epoch  6/10: total=72.2496, vae=1.0907, dsb=71.1588, bio=0.0000
    Epoch  7/10: total=71.9418, vae=1.0899, dsb=70.8519, bio=0.0000
    Epoch  8/10: total=71.7588, vae=1.0907, dsb=70.6681, bio=0.0000
    Epoch  9/10: total=71.5905, vae=1.0911, dsb=70.4993, bio=0.0000
    Epoch 10/10: total=71.6437, vae=1.0899, dsb=70.5538, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=2.2275, vae=1.0904, dsb=1.1371, bio=0.0000
    Epoch  2/10: total=2.1351, vae=1.0912, dsb=1.0438, bio=0.0000
    Epoch  3/10: total=2.1406, vae=1.0905, dsb=1.0501, bio=0.0000
    Epoch  4/10: total=2.1233, vae=1.0908, dsb=1.0325, bio=0.0000
    Epoch  5/10: total=2.0945, vae=1.0912, dsb=1.0034, bio=0.0000
    Epoch  6/10: total=2.0985, vae=1.0908, dsb=1.0077, bio=0.0000
    Epoch  7/10: total=2.0794, vae=1.0911, dsb=0.9883, bio=0.0000
    Epoch  8/10: total=2.0649, vae=1.0909, dsb=0.9740, bio=0.0000
    Epoch  9/10: total=2.0650, vae=1.0900, dsb=0.9750, bio=0.0000
    Epoch 10/10: total=2.0666, vae=1.0905, dsb=0.9761, bio=0.0000

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=62.7597, vae=1.0905, dsb=61.6693, bio=0.0000
    Epoch  2/10: total=60.8979, vae=1.0901, dsb=59.8078, bio=0.0000
    Epoch  3/10: total=60.5419, vae=1.0907, dsb=59.4512, bio=0.0000
    Epoch  4/10: total=60.3171, vae=1.0904, dsb=59.2267, bio=0.0000
    Epoch  5/10: total=60.2680, vae=1.0902, dsb=59.1778, bio=0.0000
    Epoch  6/10: total=60.0737, vae=1.0892, dsb=58.9845, bio=0.0000
    Epoch  7/10: total=59.7971, vae=1.0910, dsb=58.7061, bio=0.0000
    Epoch  8/10: total=59.6391, vae=1.0903, dsb=58.5488, bio=0.0000
    Epoch  9/10: total=59.7026, vae=1.0906, dsb=58.6120, bio=0.0000
    Epoch 10/10: total=59.5544, vae=1.0908, dsb=58.4636, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.9299, vae=1.0901, dsb=0.8399, bio=0.0000
    Epoch  2/10: total=1.8859, vae=1.0921, dsb=0.7939, bio=0.0000
    Epoch  3/10: total=1.8551, vae=1.0907, dsb=0.7644, bio=0.0000
    Epoch  4/10: total=1.8266, vae=1.0910, dsb=0.7356, bio=0.0000
    Epoch  5/10: total=1.8139, vae=1.0913, dsb=0.7226, bio=0.0000
    Epoch  6/10: total=1.8241, vae=1.0908, dsb=0.7333, bio=0.0000
    Epoch  7/10: total=1.8162, vae=1.0910, dsb=0.7252, bio=0.0000
    Epoch  8/10: total=1.8308, vae=1.0910, dsb=0.7398, bio=0.0000
    Epoch  9/10: total=1.8268, vae=1.0907, dsb=0.7362, bio=0.0000
    Epoch 10/10: total=1.8285, vae=1.0901, dsb=0.7384, bio=0.0000

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=49.8580, vae=1.0906, dsb=48.7674, bio=0.0000
    Epoch  2/10: total=49.0081, vae=1.0904, dsb=47.9177, bio=0.0000
    Epoch  3/10: total=49.0875, vae=1.0903, dsb=47.9972, bio=0.0000
    Epoch  4/10: total=49.0900, vae=1.0902, dsb=47.9998, bio=0.0000
    Epoch  5/10: total=48.7417, vae=1.0903, dsb=47.6514, bio=0.0000
    Epoch  6/10: total=48.8355, vae=1.0909, dsb=47.7447, bio=0.0000
    Epoch  7/10: total=48.8927, vae=1.0908, dsb=47.8019, bio=0.0000
    Epoch  8/10: total=48.4903, vae=1.0901, dsb=47.4002, bio=0.0000
    Epoch  9/10: total=48.5151, vae=1.0901, dsb=47.4250, bio=0.0000
    Epoch 10/10: total=48.7285, vae=1.0912, dsb=47.6373, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.7453, vae=1.0913, dsb=0.6540, bio=0.0000
    Epoch  2/10: total=1.7583, vae=1.0902, dsb=0.6681, bio=0.0000
    Epoch  3/10: total=1.7380, vae=1.0896, dsb=0.6485, bio=0.0000
    Epoch  4/10: total=1.7172, vae=1.0903, dsb=0.6269, bio=0.0000
    Epoch  5/10: total=1.7406, vae=1.0907, dsb=0.6498, bio=0.0000
    Epoch  6/10: total=1.7408, vae=1.0900, dsb=0.6507, bio=0.0000
    Epoch  7/10: total=1.7233, vae=1.0902, dsb=0.6331, bio=0.0000
    Epoch  8/10: total=1.7242, vae=1.0902, dsb=0.6340, bio=0.0000
    Epoch  9/10: total=1.7199, vae=1.0909, dsb=0.6291, bio=0.0000
    Epoch 10/10: total=1.7310, vae=1.0906, dsb=0.6404, bio=0.0000

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=44.6025, vae=1.0908, dsb=43.5117, bio=0.0000
    Epoch  2/10: total=44.3181, vae=1.0904, dsb=43.2277, bio=0.0000
    Epoch  3/10: total=44.4515, vae=1.0903, dsb=43.3613, bio=0.0000
    Epoch  4/10: total=44.2558, vae=1.0908, dsb=43.1651, bio=0.0000
    Epoch  5/10: total=44.1772, vae=1.0898, dsb=43.0875, bio=0.0000
    Epoch  6/10: total=44.3237, vae=1.0897, dsb=43.2341, bio=0.0000
    Epoch  7/10: total=44.1795, vae=1.0906, dsb=43.0888, bio=0.0000
    Epoch  8/10: total=44.1551, vae=1.0901, dsb=43.0650, bio=0.0000
    Epoch  9/10: total=44.1917, vae=1.0905, dsb=43.1013, bio=0.0000
    Epoch 10/10: total=44.2211, vae=1.0903, dsb=43.1308, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.6632, vae=1.0909, dsb=0.5723, bio=0.0000
    Epoch  2/10: total=1.6465, vae=1.0912, dsb=0.5553, bio=0.0000
    Epoch  3/10: total=1.6519, vae=1.0906, dsb=0.5613, bio=0.0000
    Epoch  4/10: total=1.6548, vae=1.0905, dsb=0.5644, bio=0.0000
    Epoch  5/10: total=1.6581, vae=1.0909, dsb=0.5672, bio=0.0000
    Epoch  6/10: total=1.6591, vae=1.0898, dsb=0.5693, bio=0.0000
    Epoch  7/10: total=1.6389, vae=1.0911, dsb=0.5478, bio=0.0000
    Epoch  8/10: total=1.6344, vae=1.0898, dsb=0.5447, bio=0.0000
    Epoch  9/10: total=1.6611, vae=1.0910, dsb=0.5701, bio=0.0000
    Epoch 10/10: total=1.6466, vae=1.0908, dsb=0.5559, bio=0.0000

[Seed 24] Joint training (ablation) complete; models and history saved.

[Seed 24] Drift genes saved in /home/yyuan/ICB_TCE/iter_results/run_024

[Seed 24] run finished.

================================================================================
[Seed 25] Starting running whole pipeline...
================================================================================

[Seed 25] Starting VAE pre-training...

    Epoch [01/20], Beta: 0.000, Average Loss: 536.1674
    Epoch [02/20], Beta: 0.000, Average Loss: 309.4157
    Epoch [03/20], Beta: 0.000, Average Loss: 273.2777
    Epoch [04/20], Beta: 0.000, Average Loss: 250.8793
    Epoch [05/20], Beta: 0.100, Average Loss: 244.9146
    Epoch [06/20], Beta: 0.200, Average Loss: 244.1175
    Epoch [07/20], Beta: 0.300, Average Loss: 244.4646
    Epoch [08/20], Beta: 0.400, Average Loss: 245.1865
    Epoch [09/20], Beta: 0.500, Average Loss: 246.2411
    Epoch [10/20], Beta: 0.600, Average Loss: 247.5184
    Epoch [11/20], Beta: 0.700, Average Loss: 248.8490
    Epoch [12/20], Beta: 0.800, Average Loss: 250.2068
    Epoch [13/20], Beta: 0.900, Average Loss: 251.4734
    Epoch [14/20], Beta: 1.000, Average Loss: 253.0937
    Epoch [15/20], Beta: 1.000, Average Loss: 252.6874
    Epoch [16/20], Beta: 1.000, Average Loss: 252.3530
    Epoch [17/20], Beta: 1.000, Average Loss: 251.9638
    Epoch [18/20], Beta: 1.000, Average Loss: 251.7041
    Epoch [19/20], Beta: 1.000, Average Loss: 251.3326
    Epoch [20/20], Beta: 1.000, Average Loss: 251.1598

[Seed 25] VAE pre-training complete.

[Seed 25] Starting joint training (original)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=493.0821, vae=3.5935, dsb=475.3666, bio=28.2440
    Epoch  2/10: total=119.0355, vae=1.1111, dsb=117.8917, bio=0.0652
    Epoch  3/10: total=105.8604, vae=1.1063, dsb=104.7394, bio=0.0293
    Epoch  4/10: total=99.4390, vae=1.1038, dsb=98.3264, bio=0.0177
    Epoch  5/10: total=95.4711, vae=1.1026, dsb=94.3624, bio=0.0121
    Epoch  6/10: total=93.3035, vae=1.1028, dsb=92.1963, bio=0.0088
    Epoch  7/10: total=91.2424, vae=1.1017, dsb=90.1372, bio=0.0069
    Epoch  8/10: total=90.1239, vae=1.1021, dsb=89.0190, bio=0.0056
    Epoch  9/10: total=88.6147, vae=1.1009, dsb=87.5114, bio=0.0047
    Epoch 10/10: total=88.0958, vae=1.1017, dsb=86.9921, bio=0.0041

  [Backward Policy Training]
    Epoch  1/10: total=3.5733, vae=1.1016, dsb=2.4657, bio=0.0120
    Epoch  2/10: total=3.0001, vae=1.1004, dsb=1.8976, bio=0.0044
    Epoch  3/10: total=2.9006, vae=1.0999, dsb=1.7991, bio=0.0032
    Epoch  4/10: total=2.7953, vae=1.0997, dsb=1.6943, bio=0.0027
    Epoch  5/10: total=2.7324, vae=1.0999, dsb=1.6313, bio=0.0024
    Epoch  6/10: total=2.6931, vae=1.0995, dsb=1.5924, bio=0.0023
    Epoch  7/10: total=2.7048, vae=1.0996, dsb=1.6042, bio=0.0021
    Epoch  8/10: total=2.6932, vae=1.0997, dsb=1.5925, bio=0.0020
    Epoch  9/10: total=2.6454, vae=1.0990, dsb=1.5454, bio=0.0020
    Epoch 10/10: total=2.5774, vae=1.0986, dsb=1.4779, bio=0.0019

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=78.2209, vae=1.1016, dsb=77.1177, bio=0.0033
    Epoch  2/10: total=70.1466, vae=1.0997, dsb=69.0460, bio=0.0020
    Epoch  3/10: total=68.0671, vae=1.0995, dsb=66.9666, bio=0.0020
    Epoch  4/10: total=67.1701, vae=1.0994, dsb=66.0698, bio=0.0019
    Epoch  5/10: total=66.6042, vae=1.0998, dsb=65.5035, bio=0.0019
    Epoch  6/10: total=66.0901, vae=1.0998, dsb=64.9893, bio=0.0019
    Epoch  7/10: total=65.3074, vae=1.0991, dsb=64.2073, bio=0.0020
    Epoch  8/10: total=65.0210, vae=1.0987, dsb=63.9213, bio=0.0019
    Epoch  9/10: total=64.9964, vae=1.0989, dsb=63.8965, bio=0.0019
    Epoch 10/10: total=64.7048, vae=1.0997, dsb=63.6041, bio=0.0019

  [Backward Policy Training]
    Epoch  1/10: total=2.3562, vae=1.0998, dsb=1.2532, bio=0.0064
    Epoch  2/10: total=2.1670, vae=1.0985, dsb=1.0676, bio=0.0019
    Epoch  3/10: total=2.1578, vae=1.0968, dsb=1.0601, bio=0.0018
    Epoch  4/10: total=2.0866, vae=1.0975, dsb=0.9882, bio=0.0017
    Epoch  5/10: total=2.1330, vae=1.0969, dsb=1.0353, bio=0.0017
    Epoch  6/10: total=2.0766, vae=1.0978, dsb=0.9780, bio=0.0017
    Epoch  7/10: total=2.0624, vae=1.0980, dsb=0.9636, bio=0.0016
    Epoch  8/10: total=2.0526, vae=1.0974, dsb=0.9545, bio=0.0016
    Epoch  9/10: total=2.0663, vae=1.0972, dsb=0.9684, bio=0.0016
    Epoch 10/10: total=2.0881, vae=1.0977, dsb=0.9896, bio=0.0015

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=57.9471, vae=1.1002, dsb=56.8454, bio=0.0030
    Epoch  2/10: total=54.6208, vae=1.0977, dsb=53.5222, bio=0.0017
    Epoch  3/10: total=54.1102, vae=1.0977, dsb=53.0117, bio=0.0017
    Epoch  4/10: total=53.4120, vae=1.0980, dsb=52.3131, bio=0.0017
    Epoch  5/10: total=53.2686, vae=1.0984, dsb=52.1694, bio=0.0017
    Epoch  6/10: total=53.0724, vae=1.0971, dsb=51.9746, bio=0.0016
    Epoch  7/10: total=52.9714, vae=1.0979, dsb=51.8725, bio=0.0021
    Epoch  8/10: total=53.0091, vae=1.0983, dsb=51.9099, bio=0.0016
    Epoch  9/10: total=52.8105, vae=1.0984, dsb=51.7113, bio=0.0016
    Epoch 10/10: total=52.6373, vae=1.0978, dsb=51.5387, bio=0.0016

  [Backward Policy Training]
    Epoch  1/10: total=1.9827, vae=1.0989, dsb=0.8630, bio=0.0415
    Epoch  2/10: total=1.9105, vae=1.0984, dsb=0.8113, bio=0.0017
    Epoch  3/10: total=1.9029, vae=1.0974, dsb=0.8047, bio=0.0015
    Epoch  4/10: total=1.8938, vae=1.0978, dsb=0.7953, bio=0.0014
    Epoch  5/10: total=1.8702, vae=1.0972, dsb=0.7724, bio=0.0014
    Epoch  6/10: total=1.8649, vae=1.0973, dsb=0.7669, bio=0.0014
    Epoch  7/10: total=1.8513, vae=1.0977, dsb=0.7529, bio=0.0014
    Epoch  8/10: total=1.8411, vae=1.0979, dsb=0.7425, bio=0.0015
    Epoch  9/10: total=1.8476, vae=1.0972, dsb=0.7498, bio=0.0015
    Epoch 10/10: total=1.8401, vae=1.0964, dsb=0.7431, bio=0.0013

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=48.9517, vae=1.0991, dsb=47.8512, bio=0.0029
    Epoch  2/10: total=48.0115, vae=1.0982, dsb=46.9126, bio=0.0014
    Epoch  3/10: total=47.3656, vae=1.0982, dsb=46.2667, bio=0.0015
    Epoch  4/10: total=47.4167, vae=1.0982, dsb=46.3177, bio=0.0015
    Epoch  5/10: total=47.3185, vae=1.0988, dsb=46.2190, bio=0.0015
    Epoch  6/10: total=47.0669, vae=1.0985, dsb=45.9677, bio=0.0014
    Epoch  7/10: total=47.2019, vae=1.0978, dsb=46.1034, bio=0.0014
    Epoch  8/10: total=47.1342, vae=1.0978, dsb=46.0356, bio=0.0016
    Epoch  9/10: total=46.8913, vae=1.0970, dsb=45.7936, bio=0.0013
    Epoch 10/10: total=46.6990, vae=1.0981, dsb=45.6003, bio=0.0013

  [Backward Policy Training]
    Epoch  1/10: total=1.8067, vae=1.0984, dsb=0.6486, bio=0.1193
    Epoch  2/10: total=1.7091, vae=1.0977, dsb=0.6107, bio=0.0014
    Epoch  3/10: total=1.7149, vae=1.0973, dsb=0.6169, bio=0.0013
    Epoch  4/10: total=1.7100, vae=1.0968, dsb=0.6126, bio=0.0012
    Epoch  5/10: total=1.6941, vae=1.0969, dsb=0.5966, bio=0.0012
    Epoch  6/10: total=1.6785, vae=1.0968, dsb=0.5810, bio=0.0012
    Epoch  7/10: total=1.6965, vae=1.0969, dsb=0.5990, bio=0.0012
    Epoch  8/10: total=1.6956, vae=1.0972, dsb=0.5977, bio=0.0014
    Epoch  9/10: total=1.6813, vae=1.0972, dsb=0.5836, bio=0.0010
    Epoch 10/10: total=1.6879, vae=1.0968, dsb=0.5906, bio=0.0011

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=41.5494, vae=1.0989, dsb=40.4491, bio=0.0027
    Epoch  2/10: total=41.2371, vae=1.0988, dsb=40.1377, bio=0.0013
    Epoch  3/10: total=41.0837, vae=1.0978, dsb=39.9853, bio=0.0013
    Epoch  4/10: total=41.1395, vae=1.0974, dsb=40.0414, bio=0.0013
    Epoch  5/10: total=41.0685, vae=1.0972, dsb=39.9707, bio=0.0013
    Epoch  6/10: total=41.0868, vae=1.0976, dsb=39.9886, bio=0.0012
    Epoch  7/10: total=41.1351, vae=1.0969, dsb=40.0376, bio=0.0012
    Epoch  8/10: total=40.9700, vae=1.0968, dsb=39.8724, bio=0.0016
    Epoch  9/10: total=40.8049, vae=1.0976, dsb=39.7067, bio=0.0011
    Epoch 10/10: total=40.9021, vae=1.0972, dsb=39.8043, bio=0.0011

  [Backward Policy Training]
    Epoch  1/10: total=1.7177, vae=1.0981, dsb=0.5443, bio=0.1507
    Epoch  2/10: total=1.6334, vae=1.0970, dsb=0.5358, bio=0.0012
    Epoch  3/10: total=1.6289, vae=1.0963, dsb=0.5320, bio=0.0011
    Epoch  4/10: total=1.6386, vae=1.0968, dsb=0.5413, bio=0.0011
    Epoch  5/10: total=1.6322, vae=1.0964, dsb=0.5352, bio=0.0011
    Epoch  6/10: total=1.6301, vae=1.0970, dsb=0.5326, bio=0.0010
    Epoch  7/10: total=1.6048, vae=1.0968, dsb=0.5075, bio=0.0010
    Epoch  8/10: total=1.6279, vae=1.0963, dsb=0.5312, bio=0.0010
    Epoch  9/10: total=1.6231, vae=1.0965, dsb=0.5261, bio=0.0010
    Epoch 10/10: total=1.6204, vae=1.0969, dsb=0.5230, bio=0.0011

[Seed 25] Joint training (original) complete; models and history saved.

[Seed 25] Starting joint training (ablation)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=476.7346, vae=2.0176, dsb=474.7170, bio=0.0000
    Epoch  2/10: total=117.6901, vae=1.0929, dsb=116.5973, bio=0.0000
    Epoch  3/10: total=104.6561, vae=1.0915, dsb=103.5646, bio=0.0000
    Epoch  4/10: total=98.5776, vae=1.0903, dsb=97.4873, bio=0.0000
    Epoch  5/10: total=94.7533, vae=1.0896, dsb=93.6637, bio=0.0000
    Epoch  6/10: total=92.6959, vae=1.0902, dsb=91.6057, bio=0.0000
    Epoch  7/10: total=90.6350, vae=1.0895, dsb=89.5455, bio=0.0000
    Epoch  8/10: total=89.5558, vae=1.0902, dsb=88.4655, bio=0.0000
    Epoch  9/10: total=88.0681, vae=1.0894, dsb=86.9787, bio=0.0000
    Epoch 10/10: total=87.5473, vae=1.0904, dsb=86.4569, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=3.4178, vae=1.0896, dsb=2.3282, bio=0.0000
    Epoch  2/10: total=2.8664, vae=1.0898, dsb=1.7765, bio=0.0000
    Epoch  3/10: total=2.7770, vae=1.0897, dsb=1.6873, bio=0.0000
    Epoch  4/10: total=2.6797, vae=1.0898, dsb=1.5899, bio=0.0000
    Epoch  5/10: total=2.6171, vae=1.0902, dsb=1.5270, bio=0.0000
    Epoch  6/10: total=2.5769, vae=1.0899, dsb=1.4871, bio=0.0000
    Epoch  7/10: total=2.5868, vae=1.0901, dsb=1.4967, bio=0.0000
    Epoch  8/10: total=2.5768, vae=1.0903, dsb=1.4865, bio=0.0000
    Epoch  9/10: total=2.5300, vae=1.0897, dsb=1.4403, bio=0.0000
    Epoch 10/10: total=2.4664, vae=1.0894, dsb=1.3771, bio=0.0000

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=76.6952, vae=1.0896, dsb=75.6056, bio=0.0000
    Epoch  2/10: total=68.9604, vae=1.0890, dsb=67.8714, bio=0.0000
    Epoch  3/10: total=66.9530, vae=1.0891, dsb=65.8639, bio=0.0000
    Epoch  4/10: total=66.1541, vae=1.0891, dsb=65.0650, bio=0.0000
    Epoch  5/10: total=65.5340, vae=1.0897, dsb=64.4444, bio=0.0000
    Epoch  6/10: total=65.0429, vae=1.0898, dsb=63.9531, bio=0.0000
    Epoch  7/10: total=64.2661, vae=1.0892, dsb=63.1769, bio=0.0000
    Epoch  8/10: total=64.0486, vae=1.0889, dsb=62.9596, bio=0.0000
    Epoch  9/10: total=64.0367, vae=1.0892, dsb=62.9476, bio=0.0000
    Epoch 10/10: total=63.7343, vae=1.0900, dsb=62.6442, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=2.2637, vae=1.0895, dsb=1.1742, bio=0.0000
    Epoch  2/10: total=2.0853, vae=1.0896, dsb=0.9957, bio=0.0000
    Epoch  3/10: total=2.0743, vae=1.0882, dsb=0.9861, bio=0.0000
    Epoch  4/10: total=2.0070, vae=1.0889, dsb=0.9181, bio=0.0000
    Epoch  5/10: total=2.0509, vae=1.0883, dsb=0.9626, bio=0.0000
    Epoch  6/10: total=1.9969, vae=1.0893, dsb=0.9076, bio=0.0000
    Epoch  7/10: total=1.9834, vae=1.0896, dsb=0.8938, bio=0.0000
    Epoch  8/10: total=1.9742, vae=1.0891, dsb=0.8851, bio=0.0000
    Epoch  9/10: total=1.9871, vae=1.0888, dsb=0.8983, bio=0.0000
    Epoch 10/10: total=2.0077, vae=1.0895, dsb=0.9183, bio=0.0000

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=57.3101, vae=1.0892, dsb=56.2209, bio=0.0000
    Epoch  2/10: total=54.1609, vae=1.0881, dsb=53.0727, bio=0.0000
    Epoch  3/10: total=53.6717, vae=1.0884, dsb=52.5833, bio=0.0000
    Epoch  4/10: total=53.0487, vae=1.0889, dsb=51.9598, bio=0.0000
    Epoch  5/10: total=52.9067, vae=1.0893, dsb=51.8173, bio=0.0000
    Epoch  6/10: total=52.7500, vae=1.0882, dsb=51.6619, bio=0.0000
    Epoch  7/10: total=52.6251, vae=1.0890, dsb=51.5361, bio=0.0000
    Epoch  8/10: total=52.7168, vae=1.0897, dsb=51.6271, bio=0.0000
    Epoch  9/10: total=52.4853, vae=1.0898, dsb=51.3955, bio=0.0000
    Epoch 10/10: total=52.3355, vae=1.0893, dsb=51.2463, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.8877, vae=1.0898, dsb=0.7979, bio=0.0000
    Epoch  2/10: total=1.8411, vae=1.0901, dsb=0.7509, bio=0.0000
    Epoch  3/10: total=1.8357, vae=1.0893, dsb=0.7464, bio=0.0000
    Epoch  4/10: total=1.8283, vae=1.0898, dsb=0.7385, bio=0.0000
    Epoch  5/10: total=1.8067, vae=1.0892, dsb=0.7175, bio=0.0000
    Epoch  6/10: total=1.8030, vae=1.0893, dsb=0.7137, bio=0.0000
    Epoch  7/10: total=1.7913, vae=1.0897, dsb=0.7016, bio=0.0000
    Epoch  8/10: total=1.7824, vae=1.0899, dsb=0.6925, bio=0.0000
    Epoch  9/10: total=1.7894, vae=1.0893, dsb=0.7001, bio=0.0000
    Epoch 10/10: total=1.7829, vae=1.0885, dsb=0.6944, bio=0.0000

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=47.5885, vae=1.0885, dsb=46.5000, bio=0.0000
    Epoch  2/10: total=46.8509, vae=1.0890, dsb=45.7619, bio=0.0000
    Epoch  3/10: total=46.2762, vae=1.0893, dsb=45.1870, bio=0.0000
    Epoch  4/10: total=46.3411, vae=1.0896, dsb=45.2515, bio=0.0000
    Epoch  5/10: total=46.2829, vae=1.0905, dsb=45.1924, bio=0.0000
    Epoch  6/10: total=46.0478, vae=1.0902, dsb=44.9575, bio=0.0000
    Epoch  7/10: total=46.1703, vae=1.0896, dsb=45.0807, bio=0.0000
    Epoch  8/10: total=46.1000, vae=1.0896, dsb=45.0104, bio=0.0000
    Epoch  9/10: total=45.8457, vae=1.0890, dsb=44.7567, bio=0.0000
    Epoch 10/10: total=45.7402, vae=1.0901, dsb=44.6501, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.6832, vae=1.0895, dsb=0.5937, bio=0.0000
    Epoch  2/10: total=1.6510, vae=1.0898, dsb=0.5612, bio=0.0000
    Epoch  3/10: total=1.6580, vae=1.0894, dsb=0.5686, bio=0.0000
    Epoch  4/10: total=1.6544, vae=1.0891, dsb=0.5653, bio=0.0000
    Epoch  5/10: total=1.6399, vae=1.0891, dsb=0.5508, bio=0.0000
    Epoch  6/10: total=1.6256, vae=1.0891, dsb=0.5365, bio=0.0000
    Epoch  7/10: total=1.6426, vae=1.0893, dsb=0.5533, bio=0.0000
    Epoch  8/10: total=1.6421, vae=1.0894, dsb=0.5527, bio=0.0000
    Epoch  9/10: total=1.6289, vae=1.0895, dsb=0.5394, bio=0.0000
    Epoch 10/10: total=1.6355, vae=1.0892, dsb=0.5462, bio=0.0000

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=40.2875, vae=1.0891, dsb=39.1984, bio=0.0000
    Epoch  2/10: total=40.0546, vae=1.0899, dsb=38.9647, bio=0.0000
    Epoch  3/10: total=39.8572, vae=1.0893, dsb=38.7679, bio=0.0000
    Epoch  4/10: total=39.9721, vae=1.0893, dsb=38.8828, bio=0.0000
    Epoch  5/10: total=39.8937, vae=1.0893, dsb=38.8044, bio=0.0000
    Epoch  6/10: total=39.8537, vae=1.0897, dsb=38.7639, bio=0.0000
    Epoch  7/10: total=39.9350, vae=1.0891, dsb=38.8459, bio=0.0000
    Epoch  8/10: total=39.7604, vae=1.0889, dsb=38.6716, bio=0.0000
    Epoch  9/10: total=39.6589, vae=1.0899, dsb=38.5690, bio=0.0000
    Epoch 10/10: total=39.7622, vae=1.0895, dsb=38.6726, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.5805, vae=1.0892, dsb=0.4913, bio=0.0000
    Epoch  2/10: total=1.5736, vae=1.0894, dsb=0.4843, bio=0.0000
    Epoch  3/10: total=1.5698, vae=1.0887, dsb=0.4812, bio=0.0000
    Epoch  4/10: total=1.5790, vae=1.0892, dsb=0.4898, bio=0.0000
    Epoch  5/10: total=1.5733, vae=1.0889, dsb=0.4844, bio=0.0000
    Epoch  6/10: total=1.5713, vae=1.0895, dsb=0.4818, bio=0.0000
    Epoch  7/10: total=1.5482, vae=1.0893, dsb=0.4588, bio=0.0000
    Epoch  8/10: total=1.5697, vae=1.0889, dsb=0.4808, bio=0.0000
    Epoch  9/10: total=1.5654, vae=1.0891, dsb=0.4763, bio=0.0000
    Epoch 10/10: total=1.5632, vae=1.0895, dsb=0.4737, bio=0.0000

[Seed 25] Joint training (ablation) complete; models and history saved.

[Seed 25] Drift genes saved in /home/yyuan/ICB_TCE/iter_results/run_025

[Seed 25] run finished.

================================================================================
[Seed 26] Starting running whole pipeline...
================================================================================

[Seed 26] Starting VAE pre-training...

    Epoch [01/20], Beta: 0.000, Average Loss: 536.8686
    Epoch [02/20], Beta: 0.000, Average Loss: 310.4571
    Epoch [03/20], Beta: 0.000, Average Loss: 272.5835
    Epoch [04/20], Beta: 0.000, Average Loss: 251.6119
    Epoch [05/20], Beta: 0.100, Average Loss: 245.6403
    Epoch [06/20], Beta: 0.200, Average Loss: 244.4731
    Epoch [07/20], Beta: 0.300, Average Loss: 244.7318
    Epoch [08/20], Beta: 0.400, Average Loss: 245.5340
    Epoch [09/20], Beta: 0.500, Average Loss: 246.5970
    Epoch [10/20], Beta: 0.600, Average Loss: 247.8067
    Epoch [11/20], Beta: 0.700, Average Loss: 249.1178
    Epoch [12/20], Beta: 0.800, Average Loss: 250.4335
    Epoch [13/20], Beta: 0.900, Average Loss: 251.7595
    Epoch [14/20], Beta: 1.000, Average Loss: 253.4056
    Epoch [15/20], Beta: 1.000, Average Loss: 252.9744
    Epoch [16/20], Beta: 1.000, Average Loss: 252.6112
    Epoch [17/20], Beta: 1.000, Average Loss: 252.2740
    Epoch [18/20], Beta: 1.000, Average Loss: 251.9553
    Epoch [19/20], Beta: 1.000, Average Loss: 251.6029
    Epoch [20/20], Beta: 1.000, Average Loss: 251.4596

[Seed 26] VAE pre-training complete.

[Seed 26] Starting joint training (original)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=539.9485, vae=3.4290, dsb=526.6909, bio=19.6571
    Epoch  2/10: total=151.3213, vae=1.1018, dsb=150.1817, bio=0.0755
    Epoch  3/10: total=139.6657, vae=1.0966, dsb=138.5520, bio=0.0341
    Epoch  4/10: total=135.6556, vae=1.0949, dsb=134.5509, bio=0.0197
    Epoch  5/10: total=133.1725, vae=1.0940, dsb=132.0720, bio=0.0132
    Epoch  6/10: total=130.9842, vae=1.0934, dsb=129.8860, bio=0.0096
    Epoch  7/10: total=129.0893, vae=1.0928, dsb=127.9927, bio=0.0075
    Epoch  8/10: total=128.4632, vae=1.0917, dsb=127.3685, bio=0.0060
    Epoch  9/10: total=126.9561, vae=1.0921, dsb=125.8615, bio=0.0051
    Epoch 10/10: total=126.2859, vae=1.0914, dsb=125.1922, bio=0.0045

  [Backward Policy Training]
    Epoch  1/10: total=3.5232, vae=1.0922, dsb=2.4230, bio=0.0159
    Epoch  2/10: total=3.0380, vae=1.0916, dsb=1.9440, bio=0.0048
    Epoch  3/10: total=2.9052, vae=1.0905, dsb=1.8129, bio=0.0034
    Epoch  4/10: total=2.8323, vae=1.0898, dsb=1.7412, bio=0.0028
    Epoch  5/10: total=2.8411, vae=1.0905, dsb=1.7494, bio=0.0025
    Epoch  6/10: total=2.7542, vae=1.0897, dsb=1.6633, bio=0.0023
    Epoch  7/10: total=2.7393, vae=1.0899, dsb=1.6484, bio=0.0021
    Epoch  8/10: total=2.7038, vae=1.0889, dsb=1.6135, bio=0.0027
    Epoch  9/10: total=2.7116, vae=1.0901, dsb=1.6206, bio=0.0018
    Epoch 10/10: total=2.6894, vae=1.0892, dsb=1.5994, bio=0.0018

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=115.9373, vae=1.0931, dsb=114.8422, bio=0.0041
    Epoch  2/10: total=111.6210, vae=1.0901, dsb=110.5301, bio=0.0018
    Epoch  3/10: total=109.5301, vae=1.0897, dsb=108.4396, bio=0.0017
    Epoch  4/10: total=108.9607, vae=1.0899, dsb=107.8700, bio=0.0017
    Epoch  5/10: total=108.3723, vae=1.0898, dsb=107.2814, bio=0.0022
    Epoch  6/10: total=108.4039, vae=1.0902, dsb=107.3129, bio=0.0016
    Epoch  7/10: total=108.5936, vae=1.0892, dsb=107.5036, bio=0.0015
    Epoch  8/10: total=107.5611, vae=1.0899, dsb=106.4704, bio=0.0015
    Epoch  9/10: total=107.4991, vae=1.0897, dsb=106.4086, bio=0.0015
    Epoch 10/10: total=107.5625, vae=1.0894, dsb=106.4723, bio=0.0015

  [Backward Policy Training]
    Epoch  1/10: total=2.3674, vae=1.0899, dsb=1.2739, bio=0.0070
    Epoch  2/10: total=2.2384, vae=1.0881, dsb=1.1494, bio=0.0017
    Epoch  3/10: total=2.2332, vae=1.0877, dsb=1.1447, bio=0.0015
    Epoch  4/10: total=2.1964, vae=1.0893, dsb=1.1063, bio=0.0014
    Epoch  5/10: total=2.1653, vae=1.0891, dsb=1.0754, bio=0.0017
    Epoch  6/10: total=2.2207, vae=1.0873, dsb=1.1327, bio=0.0013
    Epoch  7/10: total=2.1761, vae=1.0880, dsb=1.0874, bio=0.0013
    Epoch  8/10: total=2.1800, vae=1.0883, dsb=1.0910, bio=0.0013
    Epoch  9/10: total=2.1664, vae=1.0876, dsb=1.0781, bio=0.0013
    Epoch 10/10: total=2.1662, vae=1.0884, dsb=1.0772, bio=0.0012

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=89.8116, vae=1.0903, dsb=88.7199, bio=0.0028
    Epoch  2/10: total=87.9396, vae=1.0888, dsb=86.8502, bio=0.0012
    Epoch  3/10: total=86.6600, vae=1.0883, dsb=85.5711, bio=0.0012
    Epoch  4/10: total=87.1753, vae=1.0890, dsb=86.0858, bio=0.0011
    Epoch  5/10: total=86.6954, vae=1.0882, dsb=85.6067, bio=0.0011
    Epoch  6/10: total=86.3352, vae=1.0884, dsb=85.2463, bio=0.0011
    Epoch  7/10: total=85.9229, vae=1.0890, dsb=84.8334, bio=0.0010
    Epoch  8/10: total=85.8157, vae=1.0883, dsb=84.7271, bio=0.0006
    Epoch  9/10: total=85.9370, vae=1.0884, dsb=84.8482, bio=0.0009
    Epoch 10/10: total=85.9299, vae=1.0877, dsb=84.8416, bio=0.0010

  [Backward Policy Training]
    Epoch  1/10: total=2.1060, vae=1.0890, dsb=0.9698, bio=0.0944
    Epoch  2/10: total=2.0074, vae=1.0874, dsb=0.9193, bio=0.0015
    Epoch  3/10: total=1.9837, vae=1.0873, dsb=0.8958, bio=0.0012
    Epoch  4/10: total=2.0113, vae=1.0877, dsb=0.9230, bio=0.0012
    Epoch  5/10: total=1.9757, vae=1.0883, dsb=0.8869, bio=0.0011
    Epoch  6/10: total=1.9737, vae=1.0874, dsb=0.8858, bio=0.0010
    Epoch  7/10: total=1.9680, vae=1.0876, dsb=0.8798, bio=0.0010
    Epoch  8/10: total=1.9404, vae=1.0878, dsb=0.8521, bio=0.0010
    Epoch  9/10: total=1.9523, vae=1.0868, dsb=0.8651, bio=0.0010
    Epoch 10/10: total=1.9229, vae=1.0870, dsb=0.8352, bio=0.0014

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=77.7352, vae=1.0898, dsb=76.6438, bio=0.0033
    Epoch  2/10: total=76.9331, vae=1.0885, dsb=75.8444, bio=0.0005
    Epoch  3/10: total=76.5794, vae=1.0884, dsb=75.4906, bio=0.0006
    Epoch  4/10: total=76.4524, vae=1.0894, dsb=75.3627, bio=0.0006
    Epoch  5/10: total=76.3772, vae=1.0874, dsb=75.2895, bio=0.0007
    Epoch  6/10: total=76.3022, vae=1.0880, dsb=75.2140, bio=0.0005
    Epoch  7/10: total=76.0918, vae=1.0868, dsb=75.0043, bio=0.0014
    Epoch  8/10: total=75.6854, vae=1.0872, dsb=74.5977, bio=0.0009
    Epoch  9/10: total=76.0140, vae=1.0875, dsb=74.9263, bio=0.0004
    Epoch 10/10: total=76.0694, vae=1.0878, dsb=74.9813, bio=0.0006

  [Backward Policy Training]
    Epoch  1/10: total=1.9485, vae=1.0895, dsb=0.7771, bio=0.1637
    Epoch  2/10: total=1.8525, vae=1.0867, dsb=0.7651, bio=0.0014
    Epoch  3/10: total=1.8204, vae=1.0877, dsb=0.7323, bio=0.0009
    Epoch  4/10: total=1.8046, vae=1.0869, dsb=0.7171, bio=0.0011
    Epoch  5/10: total=1.8104, vae=1.0869, dsb=0.7230, bio=0.0010
    Epoch  6/10: total=1.8189, vae=1.0862, dsb=0.7322, bio=0.0010
    Epoch  7/10: total=1.8210, vae=1.0866, dsb=0.7339, bio=0.0010
    Epoch  8/10: total=1.8144, vae=1.0865, dsb=0.7277, bio=0.0004
    Epoch  9/10: total=1.8297, vae=1.0866, dsb=0.7426, bio=0.0011
    Epoch 10/10: total=1.8306, vae=1.0864, dsb=0.7437, bio=0.0010

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=68.2832, vae=1.0891, dsb=67.1921, bio=0.0038
    Epoch  2/10: total=67.6631, vae=1.0882, dsb=66.5746, bio=0.0005
    Epoch  3/10: total=68.0277, vae=1.0873, dsb=66.9401, bio=0.0007
    Epoch  4/10: total=67.8134, vae=1.0876, dsb=66.7256, bio=0.0005
    Epoch  5/10: total=67.7166, vae=1.0872, dsb=66.6292, bio=0.0004
    Epoch  6/10: total=67.9420, vae=1.0871, dsb=66.8546, bio=0.0006
    Epoch  7/10: total=67.5023, vae=1.0871, dsb=66.4150, bio=0.0005
    Epoch  8/10: total=67.4959, vae=1.0873, dsb=66.4080, bio=0.0011
    Epoch  9/10: total=67.8489, vae=1.0879, dsb=66.7605, bio=0.0008
    Epoch 10/10: total=67.1759, vae=1.0865, dsb=66.0893, bio=0.0003

  [Backward Policy Training]
    Epoch  1/10: total=1.8533, vae=1.0894, dsb=0.6276, bio=0.2726
    Epoch  2/10: total=1.7043, vae=1.0883, dsb=0.6154, bio=0.0013
    Epoch  3/10: total=1.7032, vae=1.0863, dsb=0.6164, bio=0.0011
    Epoch  4/10: total=1.7112, vae=1.0873, dsb=0.6234, bio=0.0008
    Epoch  5/10: total=1.7188, vae=1.0869, dsb=0.6317, bio=0.0003
    Epoch  6/10: total=1.7142, vae=1.0862, dsb=0.6276, bio=0.0009
    Epoch  7/10: total=1.7078, vae=1.0857, dsb=0.6216, bio=0.0011
    Epoch  8/10: total=1.7060, vae=1.0857, dsb=0.6198, bio=0.0009
    Epoch  9/10: total=1.6876, vae=1.0860, dsb=0.6013, bio=0.0007
    Epoch 10/10: total=1.7251, vae=1.0858, dsb=0.6392, bio=0.0002

[Seed 26] Joint training (original) complete; models and history saved.

[Seed 26] Starting joint training (ablation)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=527.5333, vae=1.9968, dsb=525.5365, bio=0.0000
    Epoch  2/10: total=150.2306, vae=1.0835, dsb=149.1471, bio=0.0000
    Epoch  3/10: total=138.8664, vae=1.0819, dsb=137.7845, bio=0.0000
    Epoch  4/10: total=135.0910, vae=1.0813, dsb=134.0098, bio=0.0000
    Epoch  5/10: total=132.6795, vae=1.0809, dsb=131.5986, bio=0.0000
    Epoch  6/10: total=130.4898, vae=1.0807, dsb=129.4091, bio=0.0000
    Epoch  7/10: total=128.5954, vae=1.0804, dsb=127.5149, bio=0.0000
    Epoch  8/10: total=127.9075, vae=1.0797, dsb=126.8278, bio=0.0000
    Epoch  9/10: total=126.3779, vae=1.0803, dsb=125.2975, bio=0.0000
    Epoch 10/10: total=125.6997, vae=1.0799, dsb=124.6198, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=3.3741, vae=1.0798, dsb=2.2943, bio=0.0000
    Epoch  2/10: total=2.9211, vae=1.0807, dsb=1.8404, bio=0.0000
    Epoch  3/10: total=2.7977, vae=1.0801, dsb=1.7176, bio=0.0000
    Epoch  4/10: total=2.7274, vae=1.0796, dsb=1.6477, bio=0.0000
    Epoch  5/10: total=2.7382, vae=1.0805, dsb=1.6577, bio=0.0000
    Epoch  6/10: total=2.6573, vae=1.0800, dsb=1.5773, bio=0.0000
    Epoch  7/10: total=2.6434, vae=1.0802, dsb=1.5631, bio=0.0000
    Epoch  8/10: total=2.6079, vae=1.0793, dsb=1.5286, bio=0.0000
    Epoch  9/10: total=2.6175, vae=1.0808, dsb=1.5368, bio=0.0000
    Epoch 10/10: total=2.5973, vae=1.0799, dsb=1.5175, bio=0.0000

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=117.1902, vae=1.0804, dsb=116.1098, bio=0.0000
    Epoch  2/10: total=113.1729, vae=1.0793, dsb=112.0936, bio=0.0000
    Epoch  3/10: total=111.1416, vae=1.0791, dsb=110.0625, bio=0.0000
    Epoch  4/10: total=110.6922, vae=1.0795, dsb=109.6127, bio=0.0000
    Epoch  5/10: total=110.1206, vae=1.0794, dsb=109.0412, bio=0.0000
    Epoch  6/10: total=110.3522, vae=1.0800, dsb=109.2722, bio=0.0000
    Epoch  7/10: total=110.5184, vae=1.0792, dsb=109.4392, bio=0.0000
    Epoch  8/10: total=109.4143, vae=1.0801, dsb=108.3342, bio=0.0000
    Epoch  9/10: total=109.4257, vae=1.0800, dsb=108.3457, bio=0.0000
    Epoch 10/10: total=109.4037, vae=1.0798, dsb=108.3239, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=2.2707, vae=1.0796, dsb=1.1911, bio=0.0000
    Epoch  2/10: total=2.1646, vae=1.0792, dsb=1.0854, bio=0.0000
    Epoch  3/10: total=2.1641, vae=1.0790, dsb=1.0851, bio=0.0000
    Epoch  4/10: total=2.1313, vae=1.0807, dsb=1.0506, bio=0.0000
    Epoch  5/10: total=2.1022, vae=1.0805, dsb=1.0217, bio=0.0000
    Epoch  6/10: total=2.1589, vae=1.0789, dsb=1.0801, bio=0.0000
    Epoch  7/10: total=2.1163, vae=1.0795, dsb=1.0367, bio=0.0000
    Epoch  8/10: total=2.1212, vae=1.0800, dsb=1.0412, bio=0.0000
    Epoch  9/10: total=2.1086, vae=1.0793, dsb=1.0293, bio=0.0000
    Epoch 10/10: total=2.1095, vae=1.0801, dsb=1.0293, bio=0.0000

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=91.9727, vae=1.0793, dsb=90.8934, bio=0.0000
    Epoch  2/10: total=90.3836, vae=1.0793, dsb=89.3043, bio=0.0000
    Epoch  3/10: total=89.2093, vae=1.0791, dsb=88.1302, bio=0.0000
    Epoch  4/10: total=89.6680, vae=1.0800, dsb=88.5880, bio=0.0000
    Epoch  5/10: total=89.2309, vae=1.0792, dsb=88.1517, bio=0.0000
    Epoch  6/10: total=88.9012, vae=1.0796, dsb=87.8215, bio=0.0000
    Epoch  7/10: total=88.4550, vae=1.0803, dsb=87.3747, bio=0.0000
    Epoch  8/10: total=88.3889, vae=1.0797, dsb=87.3092, bio=0.0000
    Epoch  9/10: total=88.5765, vae=1.0800, dsb=87.4965, bio=0.0000
    Epoch 10/10: total=88.5906, vae=1.0795, dsb=87.5111, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.9853, vae=1.0795, dsb=0.9058, bio=0.0000
    Epoch  2/10: total=1.9420, vae=1.0791, dsb=0.8628, bio=0.0000
    Epoch  3/10: total=1.9213, vae=1.0792, dsb=0.8421, bio=0.0000
    Epoch  4/10: total=1.9480, vae=1.0797, dsb=0.8683, bio=0.0000
    Epoch  5/10: total=1.9153, vae=1.0803, dsb=0.8350, bio=0.0000
    Epoch  6/10: total=1.9139, vae=1.0795, dsb=0.8344, bio=0.0000
    Epoch  7/10: total=1.9090, vae=1.0798, dsb=0.8292, bio=0.0000
    Epoch  8/10: total=1.8829, vae=1.0801, dsb=0.8028, bio=0.0000
    Epoch  9/10: total=1.8952, vae=1.0789, dsb=0.8163, bio=0.0000
    Epoch 10/10: total=1.8664, vae=1.0794, dsb=0.7870, bio=0.0000

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=81.3516, vae=1.0791, dsb=80.2725, bio=0.0000
    Epoch  2/10: total=80.8097, vae=1.0795, dsb=79.7302, bio=0.0000
    Epoch  3/10: total=80.4732, vae=1.0798, dsb=79.3934, bio=0.0000
    Epoch  4/10: total=80.3452, vae=1.0809, dsb=79.2643, bio=0.0000
    Epoch  5/10: total=80.2784, vae=1.0791, dsb=79.1993, bio=0.0000
    Epoch  6/10: total=80.3289, vae=1.0798, dsb=79.2492, bio=0.0000
    Epoch  7/10: total=80.0045, vae=1.0788, dsb=78.9258, bio=0.0000
    Epoch  8/10: total=79.5648, vae=1.0792, dsb=78.4857, bio=0.0000
    Epoch  9/10: total=79.9364, vae=1.0795, dsb=78.8569, bio=0.0000
    Epoch 10/10: total=80.0018, vae=1.0799, dsb=78.9218, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.7984, vae=1.0802, dsb=0.7181, bio=0.0000
    Epoch  2/10: total=1.7890, vae=1.0788, dsb=0.7101, bio=0.0000
    Epoch  3/10: total=1.7592, vae=1.0799, dsb=0.6794, bio=0.0000
    Epoch  4/10: total=1.7452, vae=1.0794, dsb=0.6658, bio=0.0000
    Epoch  5/10: total=1.7509, vae=1.0794, dsb=0.6714, bio=0.0000
    Epoch  6/10: total=1.7602, vae=1.0788, dsb=0.6814, bio=0.0000
    Epoch  7/10: total=1.7630, vae=1.0793, dsb=0.6838, bio=0.0000
    Epoch  8/10: total=1.7573, vae=1.0793, dsb=0.6780, bio=0.0000
    Epoch  9/10: total=1.7717, vae=1.0796, dsb=0.6920, bio=0.0000
    Epoch 10/10: total=1.7740, vae=1.0795, dsb=0.6945, bio=0.0000

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=71.0478, vae=1.0793, dsb=69.9685, bio=0.0000
    Epoch  2/10: total=70.5488, vae=1.0797, dsb=69.4691, bio=0.0000
    Epoch  3/10: total=70.8465, vae=1.0791, dsb=69.7674, bio=0.0000
    Epoch  4/10: total=70.7330, vae=1.0796, dsb=69.6533, bio=0.0000
    Epoch  5/10: total=70.6217, vae=1.0794, dsb=69.5423, bio=0.0000
    Epoch  6/10: total=70.8926, vae=1.0794, dsb=69.8132, bio=0.0000
    Epoch  7/10: total=70.4509, vae=1.0795, dsb=69.3715, bio=0.0000
    Epoch  8/10: total=70.4300, vae=1.0798, dsb=69.3502, bio=0.0000
    Epoch  9/10: total=70.8402, vae=1.0805, dsb=69.7597, bio=0.0000
    Epoch 10/10: total=70.0416, vae=1.0790, dsb=68.9625, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.6616, vae=1.0805, dsb=0.5811, bio=0.0000
    Epoch  2/10: total=1.6524, vae=1.0807, dsb=0.5717, bio=0.0000
    Epoch  3/10: total=1.6522, vae=1.0790, dsb=0.5732, bio=0.0000
    Epoch  4/10: total=1.6606, vae=1.0801, dsb=0.5805, bio=0.0000
    Epoch  5/10: total=1.6687, vae=1.0799, dsb=0.5888, bio=0.0000
    Epoch  6/10: total=1.6643, vae=1.0794, dsb=0.5849, bio=0.0000
    Epoch  7/10: total=1.6584, vae=1.0791, dsb=0.5793, bio=0.0000
    Epoch  8/10: total=1.6567, vae=1.0791, dsb=0.5777, bio=0.0000
    Epoch  9/10: total=1.6401, vae=1.0795, dsb=0.5606, bio=0.0000
    Epoch 10/10: total=1.6766, vae=1.0794, dsb=0.5973, bio=0.0000

[Seed 26] Joint training (ablation) complete; models and history saved.

[Seed 26] Drift genes saved in /home/yyuan/ICB_TCE/iter_results/run_026

[Seed 26] run finished.

================================================================================
[Seed 27] Starting running whole pipeline...
================================================================================

[Seed 27] Starting VAE pre-training...

    Epoch [01/20], Beta: 0.000, Average Loss: 534.0328
    Epoch [02/20], Beta: 0.000, Average Loss: 304.0572
    Epoch [03/20], Beta: 0.000, Average Loss: 269.8673
    Epoch [04/20], Beta: 0.000, Average Loss: 252.4349
    Epoch [05/20], Beta: 0.100, Average Loss: 246.1897
    Epoch [06/20], Beta: 0.200, Average Loss: 244.6485
    Epoch [07/20], Beta: 0.300, Average Loss: 244.7806
    Epoch [08/20], Beta: 0.400, Average Loss: 245.6343
    Epoch [09/20], Beta: 0.500, Average Loss: 246.8355
    Epoch [10/20], Beta: 0.600, Average Loss: 248.0616
    Epoch [11/20], Beta: 0.700, Average Loss: 249.3514
    Epoch [12/20], Beta: 0.800, Average Loss: 250.5703
    Epoch [13/20], Beta: 0.900, Average Loss: 251.8141
    Epoch [14/20], Beta: 1.000, Average Loss: 253.4091
    Epoch [15/20], Beta: 1.000, Average Loss: 252.9955
    Epoch [16/20], Beta: 1.000, Average Loss: 252.5745
    Epoch [17/20], Beta: 1.000, Average Loss: 252.2067
    Epoch [18/20], Beta: 1.000, Average Loss: 251.8688
    Epoch [19/20], Beta: 1.000, Average Loss: 251.5517
    Epoch [20/20], Beta: 1.000, Average Loss: 251.3847

[Seed 27] VAE pre-training complete.

[Seed 27] Starting joint training (original)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=261.9174, vae=3.6153, dsb=241.9828, bio=32.6387
    Epoch  2/10: total=68.9118, vae=1.1064, dsb=67.7764, bio=0.0579
    Epoch  3/10: total=58.8829, vae=1.1007, dsb=57.7695, bio=0.0256
    Epoch  4/10: total=53.8392, vae=1.0992, dsb=52.7321, bio=0.0159
    Epoch  5/10: total=51.0891, vae=1.0981, dsb=49.9856, bio=0.0107
    Epoch  6/10: total=49.1513, vae=1.0972, dsb=48.0499, bio=0.0082
    Epoch  7/10: total=47.6490, vae=1.0974, dsb=46.5484, bio=0.0065
    Epoch  8/10: total=46.4802, vae=1.0962, dsb=45.3813, bio=0.0054
    Epoch  9/10: total=45.4939, vae=1.0964, dsb=44.3952, bio=0.0047
    Epoch 10/10: total=44.8927, vae=1.0957, dsb=43.7949, bio=0.0042

  [Backward Policy Training]
    Epoch  1/10: total=3.2257, vae=1.0968, dsb=2.1230, bio=0.0117
    Epoch  2/10: total=2.7059, vae=1.0959, dsb=1.6078, bio=0.0044
    Epoch  3/10: total=2.5719, vae=1.0951, dsb=1.4751, bio=0.0034
    Epoch  4/10: total=2.4914, vae=1.0941, dsb=1.3959, bio=0.0028
    Epoch  5/10: total=2.4742, vae=1.0949, dsb=1.3781, bio=0.0025
    Epoch  6/10: total=2.4345, vae=1.0945, dsb=1.3388, bio=0.0024
    Epoch  7/10: total=2.3618, vae=1.0938, dsb=1.2669, bio=0.0022
    Epoch  8/10: total=2.3419, vae=1.0940, dsb=1.2468, bio=0.0023
    Epoch  9/10: total=2.3564, vae=1.0937, dsb=1.2616, bio=0.0021
    Epoch 10/10: total=2.3228, vae=1.0945, dsb=1.2274, bio=0.0020

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=41.6477, vae=1.0968, dsb=40.5491, bio=0.0037
    Epoch  2/10: total=35.2694, vae=1.0952, dsb=34.1732, bio=0.0020
    Epoch  3/10: total=33.8116, vae=1.0951, dsb=32.7155, bio=0.0020
    Epoch  4/10: total=32.9553, vae=1.0947, dsb=31.8596, bio=0.0020
    Epoch  5/10: total=32.2855, vae=1.0948, dsb=31.1898, bio=0.0019
    Epoch  6/10: total=31.9633, vae=1.0943, dsb=30.8681, bio=0.0020
    Epoch  7/10: total=31.6664, vae=1.0950, dsb=30.5704, bio=0.0020
    Epoch  8/10: total=31.2927, vae=1.0938, dsb=30.1978, bio=0.0022
    Epoch  9/10: total=31.0026, vae=1.0941, dsb=29.9077, bio=0.0018
    Epoch 10/10: total=31.0153, vae=1.0943, dsb=29.9201, bio=0.0018

  [Backward Policy Training]
    Epoch  1/10: total=2.0838, vae=1.0938, dsb=0.9874, bio=0.0050
    Epoch  2/10: total=1.9743, vae=1.0927, dsb=0.8806, bio=0.0019
    Epoch  3/10: total=1.9274, vae=1.0925, dsb=0.8340, bio=0.0018
    Epoch  4/10: total=1.9043, vae=1.0932, dsb=0.8103, bio=0.0017
    Epoch  5/10: total=1.8935, vae=1.0929, dsb=0.7998, bio=0.0017
    Epoch  6/10: total=1.8686, vae=1.0927, dsb=0.7751, bio=0.0017
    Epoch  7/10: total=1.8548, vae=1.0927, dsb=0.7614, bio=0.0016
    Epoch  8/10: total=1.8564, vae=1.0932, dsb=0.7624, bio=0.0016
    Epoch  9/10: total=1.8483, vae=1.0917, dsb=0.7559, bio=0.0015
    Epoch 10/10: total=1.8524, vae=1.0922, dsb=0.7594, bio=0.0015

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=28.9813, vae=1.0948, dsb=27.8850, bio=0.0030
    Epoch  2/10: total=26.3615, vae=1.0945, dsb=25.2662, bio=0.0016
    Epoch  3/10: total=25.6640, vae=1.0926, dsb=24.5707, bio=0.0015
    Epoch  4/10: total=25.2469, vae=1.0932, dsb=24.1529, bio=0.0015
    Epoch  5/10: total=25.0130, vae=1.0931, dsb=23.9192, bio=0.0015
    Epoch  6/10: total=24.8267, vae=1.0935, dsb=23.7324, bio=0.0015
    Epoch  7/10: total=24.7427, vae=1.0940, dsb=23.6479, bio=0.0016
    Epoch  8/10: total=24.6209, vae=1.0936, dsb=23.5265, bio=0.0014
    Epoch  9/10: total=24.4397, vae=1.0931, dsb=23.3459, bio=0.0014
    Epoch 10/10: total=24.4410, vae=1.0926, dsb=23.3477, bio=0.0014

  [Backward Policy Training]
    Epoch  1/10: total=1.7660, vae=1.0930, dsb=0.6610, bio=0.0239
    Epoch  2/10: total=1.6901, vae=1.0926, dsb=0.5967, bio=0.0015
    Epoch  3/10: total=1.6811, vae=1.0930, dsb=0.5874, bio=0.0013
    Epoch  4/10: total=1.6611, vae=1.0923, dsb=0.5681, bio=0.0014
    Epoch  5/10: total=1.6534, vae=1.0926, dsb=0.5601, bio=0.0012
    Epoch  6/10: total=1.6336, vae=1.0930, dsb=0.5401, bio=0.0012
    Epoch  7/10: total=1.6293, vae=1.0919, dsb=0.5368, bio=0.0012
    Epoch  8/10: total=1.6332, vae=1.0922, dsb=0.5404, bio=0.0012
    Epoch  9/10: total=1.6403, vae=1.0918, dsb=0.5479, bio=0.0012
    Epoch 10/10: total=1.6245, vae=1.0919, dsb=0.5320, bio=0.0012

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=23.0442, vae=1.0948, dsb=21.9480, bio=0.0028
    Epoch  2/10: total=21.8137, vae=1.0929, dsb=20.7202, bio=0.0012
    Epoch  3/10: total=21.4747, vae=1.0929, dsb=20.3811, bio=0.0012
    Epoch  4/10: total=21.3550, vae=1.0923, dsb=20.2621, bio=0.0012
    Epoch  5/10: total=21.1569, vae=1.0929, dsb=20.0634, bio=0.0012
    Epoch  6/10: total=21.1134, vae=1.0922, dsb=20.0208, bio=0.0009
    Epoch  7/10: total=21.0241, vae=1.0922, dsb=19.9314, bio=0.0010
    Epoch  8/10: total=21.0281, vae=1.0921, dsb=19.9354, bio=0.0012
    Epoch  9/10: total=20.9759, vae=1.0919, dsb=19.8834, bio=0.0011
    Epoch 10/10: total=20.9448, vae=1.0921, dsb=19.8521, bio=0.0011

  [Backward Policy Training]
    Epoch  1/10: total=1.6469, vae=1.0930, dsb=0.4940, bio=0.1199
    Epoch  2/10: total=1.5431, vae=1.0922, dsb=0.4503, bio=0.0013
    Epoch  3/10: total=1.5312, vae=1.0914, dsb=0.4392, bio=0.0012
    Epoch  4/10: total=1.5295, vae=1.0915, dsb=0.4374, bio=0.0011
    Epoch  5/10: total=1.5242, vae=1.0911, dsb=0.4325, bio=0.0011
    Epoch  6/10: total=1.5201, vae=1.0917, dsb=0.4278, bio=0.0011
    Epoch  7/10: total=1.5087, vae=1.0910, dsb=0.4173, bio=0.0010
    Epoch  8/10: total=1.5237, vae=1.0919, dsb=0.4313, bio=0.0010
    Epoch  9/10: total=1.5114, vae=1.0916, dsb=0.4194, bio=0.0010
    Epoch 10/10: total=1.5159, vae=1.0903, dsb=0.4252, bio=0.0009

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=18.8260, vae=1.0946, dsb=17.7299, bio=0.0029
    Epoch  2/10: total=18.4202, vae=1.0928, dsb=17.3269, bio=0.0010
    Epoch  3/10: total=18.2759, vae=1.0927, dsb=17.1828, bio=0.0008
    Epoch  4/10: total=18.1993, vae=1.0923, dsb=17.1067, bio=0.0005
    Epoch  5/10: total=18.1021, vae=1.0915, dsb=17.0101, bio=0.0011
    Epoch  6/10: total=18.1438, vae=1.0930, dsb=17.0502, bio=0.0011
    Epoch  7/10: total=18.1784, vae=1.0916, dsb=17.0862, bio=0.0010
    Epoch  8/10: total=18.1443, vae=1.0921, dsb=17.0519, bio=0.0007
    Epoch  9/10: total=18.0934, vae=1.0917, dsb=17.0014, bio=0.0005
    Epoch 10/10: total=18.0394, vae=1.0919, dsb=16.9469, bio=0.0012

  [Backward Policy Training]
    Epoch  1/10: total=1.5300, vae=1.0929, dsb=0.3500, bio=0.1740
    Epoch  2/10: total=1.4366, vae=1.0915, dsb=0.3445, bio=0.0013
    Epoch  3/10: total=1.4313, vae=1.0918, dsb=0.3390, bio=0.0010
    Epoch  4/10: total=1.4326, vae=1.0915, dsb=0.3406, bio=0.0011
    Epoch  5/10: total=1.4308, vae=1.0914, dsb=0.3389, bio=0.0010
    Epoch  6/10: total=1.4325, vae=1.0908, dsb=0.3415, bio=0.0005
    Epoch  7/10: total=1.4249, vae=1.0904, dsb=0.3339, bio=0.0011
    Epoch  8/10: total=1.4357, vae=1.0910, dsb=0.3442, bio=0.0010
    Epoch  9/10: total=1.4270, vae=1.0902, dsb=0.3364, bio=0.0009
    Epoch 10/10: total=1.4344, vae=1.0915, dsb=0.3425, bio=0.0009

[Seed 27] Joint training (original) complete; models and history saved.

[Seed 27] Starting joint training (ablation)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=243.6642, vae=1.9965, dsb=241.6677, bio=0.0000
    Epoch  2/10: total=68.3892, vae=1.0885, dsb=67.3007, bio=0.0000
    Epoch  3/10: total=58.3190, vae=1.0857, dsb=57.2332, bio=0.0000
    Epoch  4/10: total=53.4115, vae=1.0855, dsb=52.3261, bio=0.0000
    Epoch  5/10: total=50.6988, vae=1.0850, dsb=49.6137, bio=0.0000
    Epoch  6/10: total=48.7168, vae=1.0846, dsb=47.6322, bio=0.0000
    Epoch  7/10: total=47.2526, vae=1.0851, dsb=46.1675, bio=0.0000
    Epoch  8/10: total=46.1458, vae=1.0842, dsb=45.0616, bio=0.0000
    Epoch  9/10: total=45.1807, vae=1.0846, dsb=44.0961, bio=0.0000
    Epoch 10/10: total=44.5836, vae=1.0843, dsb=43.4994, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=3.1133, vae=1.0847, dsb=2.0286, bio=0.0000
    Epoch  2/10: total=2.6192, vae=1.0851, dsb=1.5340, bio=0.0000
    Epoch  3/10: total=2.4892, vae=1.0847, dsb=1.4045, bio=0.0000
    Epoch  4/10: total=2.4117, vae=1.0840, dsb=1.3277, bio=0.0000
    Epoch  5/10: total=2.3959, vae=1.0850, dsb=1.3109, bio=0.0000
    Epoch  6/10: total=2.3579, vae=1.0848, dsb=1.2731, bio=0.0000
    Epoch  7/10: total=2.2883, vae=1.0841, dsb=1.2041, bio=0.0000
    Epoch  8/10: total=2.2703, vae=1.0844, dsb=1.1859, bio=0.0000
    Epoch  9/10: total=2.2851, vae=1.0844, dsb=1.2007, bio=0.0000
    Epoch 10/10: total=2.2531, vae=1.0851, dsb=1.1679, bio=0.0000

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=40.9945, vae=1.0847, dsb=39.9098, bio=0.0000
    Epoch  2/10: total=34.4881, vae=1.0844, dsb=33.4037, bio=0.0000
    Epoch  3/10: total=33.1215, vae=1.0846, dsb=32.0369, bio=0.0000
    Epoch  4/10: total=32.3155, vae=1.0844, dsb=31.2311, bio=0.0000
    Epoch  5/10: total=31.7113, vae=1.0845, dsb=30.6268, bio=0.0000
    Epoch  6/10: total=31.3781, vae=1.0842, dsb=30.2939, bio=0.0000
    Epoch  7/10: total=31.0843, vae=1.0849, dsb=29.9994, bio=0.0000
    Epoch  8/10: total=30.7408, vae=1.0839, dsb=29.6569, bio=0.0000
    Epoch  9/10: total=30.4702, vae=1.0843, dsb=29.3860, bio=0.0000
    Epoch 10/10: total=30.4873, vae=1.0845, dsb=29.4028, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=2.0003, vae=1.0835, dsb=0.9169, bio=0.0000
    Epoch  2/10: total=1.9012, vae=1.0838, dsb=0.8174, bio=0.0000
    Epoch  3/10: total=1.8571, vae=1.0837, dsb=0.7734, bio=0.0000
    Epoch  4/10: total=1.8355, vae=1.0845, dsb=0.7510, bio=0.0000
    Epoch  5/10: total=1.8258, vae=1.0842, dsb=0.7416, bio=0.0000
    Epoch  6/10: total=1.8035, vae=1.0842, dsb=0.7193, bio=0.0000
    Epoch  7/10: total=1.7911, vae=1.0842, dsb=0.7069, bio=0.0000
    Epoch  8/10: total=1.7939, vae=1.0848, dsb=0.7091, bio=0.0000
    Epoch  9/10: total=1.7864, vae=1.0832, dsb=0.7032, bio=0.0000
    Epoch 10/10: total=1.7911, vae=1.0839, dsb=0.7073, bio=0.0000

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=28.1533, vae=1.0841, dsb=27.0692, bio=0.0000
    Epoch  2/10: total=25.7086, vae=1.0850, dsb=24.6236, bio=0.0000
    Epoch  3/10: total=25.1093, vae=1.0832, dsb=24.0260, bio=0.0000
    Epoch  4/10: total=24.7188, vae=1.0839, dsb=23.6349, bio=0.0000
    Epoch  5/10: total=24.5122, vae=1.0839, dsb=23.4284, bio=0.0000
    Epoch  6/10: total=24.3810, vae=1.0843, dsb=23.2967, bio=0.0000
    Epoch  7/10: total=24.2960, vae=1.0849, dsb=23.2111, bio=0.0000
    Epoch  8/10: total=24.1924, vae=1.0847, dsb=23.1077, bio=0.0000
    Epoch  9/10: total=24.0128, vae=1.0842, dsb=22.9286, bio=0.0000
    Epoch 10/10: total=24.0311, vae=1.0838, dsb=22.9472, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.6943, vae=1.0838, dsb=0.6105, bio=0.0000
    Epoch  2/10: total=1.6391, vae=1.0844, dsb=0.5547, bio=0.0000
    Epoch  3/10: total=1.6319, vae=1.0849, dsb=0.5470, bio=0.0000
    Epoch  4/10: total=1.6135, vae=1.0843, dsb=0.5292, bio=0.0000
    Epoch  5/10: total=1.6066, vae=1.0846, dsb=0.5220, bio=0.0000
    Epoch  6/10: total=1.5886, vae=1.0849, dsb=0.5037, bio=0.0000
    Epoch  7/10: total=1.5846, vae=1.0840, dsb=0.5006, bio=0.0000
    Epoch  8/10: total=1.5886, vae=1.0843, dsb=0.5043, bio=0.0000
    Epoch  9/10: total=1.5954, vae=1.0840, dsb=0.5114, bio=0.0000
    Epoch 10/10: total=1.5799, vae=1.0841, dsb=0.4957, bio=0.0000

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=22.1076, vae=1.0842, dsb=21.0234, bio=0.0000
    Epoch  2/10: total=21.0184, vae=1.0840, dsb=19.9344, bio=0.0000
    Epoch  3/10: total=20.7165, vae=1.0842, dsb=19.6323, bio=0.0000
    Epoch  4/10: total=20.6334, vae=1.0837, dsb=19.5497, bio=0.0000
    Epoch  5/10: total=20.4667, vae=1.0844, dsb=19.3823, bio=0.0000
    Epoch  6/10: total=20.4268, vae=1.0838, dsb=19.3430, bio=0.0000
    Epoch  7/10: total=20.3500, vae=1.0839, dsb=19.2661, bio=0.0000
    Epoch  8/10: total=20.3520, vae=1.0840, dsb=19.2680, bio=0.0000
    Epoch  9/10: total=20.3221, vae=1.0839, dsb=19.2382, bio=0.0000
    Epoch 10/10: total=20.2842, vae=1.0842, dsb=19.2001, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.5353, vae=1.0840, dsb=0.4514, bio=0.0000
    Epoch  2/10: total=1.4987, vae=1.0844, dsb=0.4143, bio=0.0000
    Epoch  3/10: total=1.4887, vae=1.0837, dsb=0.4050, bio=0.0000
    Epoch  4/10: total=1.4882, vae=1.0839, dsb=0.4043, bio=0.0000
    Epoch  5/10: total=1.4840, vae=1.0835, dsb=0.4004, bio=0.0000
    Epoch  6/10: total=1.4806, vae=1.0842, dsb=0.3963, bio=0.0000
    Epoch  7/10: total=1.4703, vae=1.0836, dsb=0.3867, bio=0.0000
    Epoch  8/10: total=1.4846, vae=1.0846, dsb=0.4000, bio=0.0000
    Epoch  9/10: total=1.4735, vae=1.0844, dsb=0.3891, bio=0.0000
    Epoch 10/10: total=1.4776, vae=1.0832, dsb=0.3944, bio=0.0000

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=18.3043, vae=1.0844, dsb=17.2200, bio=0.0000
    Epoch  2/10: total=17.9658, vae=1.0841, dsb=16.8817, bio=0.0000
    Epoch  3/10: total=17.8636, vae=1.0840, dsb=16.7796, bio=0.0000
    Epoch  4/10: total=17.7963, vae=1.0840, dsb=16.7123, bio=0.0000
    Epoch  5/10: total=17.7004, vae=1.0835, dsb=16.6169, bio=0.0000
    Epoch  6/10: total=17.7587, vae=1.0850, dsb=16.6736, bio=0.0000
    Epoch  7/10: total=17.7949, vae=1.0838, dsb=16.7112, bio=0.0000
    Epoch  8/10: total=17.7735, vae=1.0842, dsb=16.6892, bio=0.0000
    Epoch  9/10: total=17.7189, vae=1.0840, dsb=16.6349, bio=0.0000
    Epoch 10/10: total=17.6817, vae=1.0843, dsb=16.5974, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.4105, vae=1.0841, dsb=0.3265, bio=0.0000
    Epoch  2/10: total=1.4068, vae=1.0840, dsb=0.3228, bio=0.0000
    Epoch  3/10: total=1.4026, vae=1.0846, dsb=0.3180, bio=0.0000
    Epoch  4/10: total=1.4039, vae=1.0843, dsb=0.3196, bio=0.0000
    Epoch  5/10: total=1.4027, vae=1.0842, dsb=0.3185, bio=0.0000
    Epoch  6/10: total=1.4047, vae=1.0837, dsb=0.3211, bio=0.0000
    Epoch  7/10: total=1.3978, vae=1.0835, dsb=0.3143, bio=0.0000
    Epoch  8/10: total=1.4084, vae=1.0841, dsb=0.3243, bio=0.0000
    Epoch  9/10: total=1.4000, vae=1.0834, dsb=0.3167, bio=0.0000
    Epoch 10/10: total=1.4075, vae=1.0847, dsb=0.3228, bio=0.0000

[Seed 27] Joint training (ablation) complete; models and history saved.

[Seed 27] Drift genes saved in /home/yyuan/ICB_TCE/iter_results/run_027

[Seed 27] run finished.

================================================================================
[Seed 28] Starting running whole pipeline...
================================================================================

[Seed 28] Starting VAE pre-training...

    Epoch [01/20], Beta: 0.000, Average Loss: 536.7412
    Epoch [02/20], Beta: 0.000, Average Loss: 308.9029
    Epoch [03/20], Beta: 0.000, Average Loss: 272.4271
    Epoch [04/20], Beta: 0.000, Average Loss: 252.5790
    Epoch [05/20], Beta: 0.100, Average Loss: 246.4994
    Epoch [06/20], Beta: 0.200, Average Loss: 244.8840
    Epoch [07/20], Beta: 0.300, Average Loss: 245.0152
    Epoch [08/20], Beta: 0.400, Average Loss: 245.7517
    Epoch [09/20], Beta: 0.500, Average Loss: 246.6134
    Epoch [10/20], Beta: 0.600, Average Loss: 247.6817
    Epoch [11/20], Beta: 0.700, Average Loss: 248.9610
    Epoch [12/20], Beta: 0.800, Average Loss: 250.1879
    Epoch [13/20], Beta: 0.900, Average Loss: 251.4400
    Epoch [14/20], Beta: 1.000, Average Loss: 253.0532
    Epoch [15/20], Beta: 1.000, Average Loss: 252.6439
    Epoch [16/20], Beta: 1.000, Average Loss: 252.3232
    Epoch [17/20], Beta: 1.000, Average Loss: 251.9051
    Epoch [18/20], Beta: 1.000, Average Loss: 251.5775
    Epoch [19/20], Beta: 1.000, Average Loss: 251.2959
    Epoch [20/20], Beta: 1.000, Average Loss: 251.1218

[Seed 28] VAE pre-training complete.

[Seed 28] Starting joint training (original)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=598.9140, vae=3.3975, dsb=586.0956, bio=18.8418
    Epoch  2/10: total=172.1591, vae=1.1109, dsb=170.9975, bio=0.1013
    Epoch  3/10: total=162.0830, vae=1.1048, dsb=160.9564, bio=0.0437
    Epoch  4/10: total=156.7682, vae=1.1013, dsb=155.6554, bio=0.0229
    Epoch  5/10: total=154.0281, vae=1.1002, dsb=152.9203, bio=0.0150
    Epoch  6/10: total=152.6472, vae=1.1000, dsb=151.5419, bio=0.0105
    Epoch  7/10: total=150.3614, vae=1.1000, dsb=149.2574, bio=0.0081
    Epoch  8/10: total=149.3607, vae=1.0994, dsb=148.2580, bio=0.0065
    Epoch  9/10: total=148.8927, vae=1.0985, dsb=147.7915, bio=0.0055
    Epoch 10/10: total=148.4902, vae=1.0988, dsb=147.3891, bio=0.0047

  [Backward Policy Training]
    Epoch  1/10: total=3.4200, vae=1.0991, dsb=2.3122, bio=0.0174
    Epoch  2/10: total=2.9200, vae=1.0982, dsb=1.8189, bio=0.0058
    Epoch  3/10: total=2.8337, vae=1.0975, dsb=1.7343, bio=0.0039
    Epoch  4/10: total=2.7176, vae=1.0969, dsb=1.6191, bio=0.0031
    Epoch  5/10: total=2.6862, vae=1.0966, dsb=1.5882, bio=0.0026
    Epoch  6/10: total=2.6589, vae=1.0961, dsb=1.5616, bio=0.0023
    Epoch  7/10: total=2.6237, vae=1.0968, dsb=1.5258, bio=0.0021
    Epoch  8/10: total=2.6324, vae=1.0963, dsb=1.5352, bio=0.0020
    Epoch  9/10: total=2.6674, vae=1.0960, dsb=1.5704, bio=0.0019
    Epoch 10/10: total=2.5796, vae=1.0957, dsb=1.4830, bio=0.0018

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=125.4517, vae=1.0991, dsb=124.3507, bio=0.0039
    Epoch  2/10: total=121.0351, vae=1.0975, dsb=119.9366, bio=0.0019
    Epoch  3/10: total=119.2047, vae=1.0974, dsb=118.1064, bio=0.0017
    Epoch  4/10: total=118.4303, vae=1.0970, dsb=117.3324, bio=0.0017
    Epoch  5/10: total=118.4801, vae=1.0974, dsb=117.3818, bio=0.0018
    Epoch  6/10: total=118.1719, vae=1.0965, dsb=117.0745, bio=0.0017
    Epoch  7/10: total=118.0935, vae=1.0967, dsb=116.9959, bio=0.0017
    Epoch  8/10: total=117.4798, vae=1.0971, dsb=116.3819, bio=0.0015
    Epoch  9/10: total=117.2899, vae=1.0963, dsb=116.1926, bio=0.0020
    Epoch 10/10: total=117.2394, vae=1.0961, dsb=116.1424, bio=0.0016

  [Backward Policy Training]
    Epoch  1/10: total=2.3040, vae=1.0976, dsb=1.2035, bio=0.0058
    Epoch  2/10: total=2.1848, vae=1.0950, dsb=1.0889, bio=0.0019
    Epoch  3/10: total=2.1618, vae=1.0962, dsb=1.0647, bio=0.0016
    Epoch  4/10: total=2.1221, vae=1.0958, dsb=1.0255, bio=0.0016
    Epoch  5/10: total=2.1052, vae=1.0952, dsb=1.0093, bio=0.0015
    Epoch  6/10: total=2.0964, vae=1.0946, dsb=1.0011, bio=0.0014
    Epoch  7/10: total=2.1173, vae=1.0944, dsb=1.0222, bio=0.0014
    Epoch  8/10: total=2.0819, vae=1.0951, dsb=0.9861, bio=0.0016
    Epoch  9/10: total=2.0830, vae=1.0955, dsb=0.9869, bio=0.0013
    Epoch 10/10: total=2.0506, vae=1.0946, dsb=0.9553, bio=0.0013

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=102.5210, vae=1.0978, dsb=101.4217, bio=0.0029
    Epoch  2/10: total=100.8095, vae=1.0970, dsb=99.7118, bio=0.0014
    Epoch  3/10: total=100.9447, vae=1.0957, dsb=99.8483, bio=0.0014
    Epoch  4/10: total=100.5959, vae=1.0955, dsb=99.4997, bio=0.0014
    Epoch  5/10: total=100.5750, vae=1.0955, dsb=99.4788, bio=0.0014
    Epoch  6/10: total=100.3559, vae=1.0954, dsb=99.2598, bio=0.0014
    Epoch  7/10: total=99.8771, vae=1.0965, dsb=98.7799, bio=0.0014
    Epoch  8/10: total=100.5063, vae=1.0958, dsb=99.4098, bio=0.0014
    Epoch  9/10: total=99.8783, vae=1.0947, dsb=98.7830, bio=0.0013
    Epoch 10/10: total=99.9999, vae=1.0964, dsb=98.9028, bio=0.0013

  [Backward Policy Training]
    Epoch  1/10: total=1.9792, vae=1.0952, dsb=0.8801, bio=0.0077
    Epoch  2/10: total=1.9506, vae=1.0948, dsb=0.8551, bio=0.0014
    Epoch  3/10: total=1.9220, vae=1.0950, dsb=0.8263, bio=0.0013
    Epoch  4/10: total=1.8984, vae=1.0941, dsb=0.8036, bio=0.0012
    Epoch  5/10: total=1.8962, vae=1.0948, dsb=0.8007, bio=0.0012
    Epoch  6/10: total=1.8982, vae=1.0948, dsb=0.8028, bio=0.0012
    Epoch  7/10: total=1.8690, vae=1.0951, dsb=0.7733, bio=0.0012
    Epoch  8/10: total=1.8934, vae=1.0944, dsb=0.7985, bio=0.0011
    Epoch  9/10: total=1.8976, vae=1.0946, dsb=0.8025, bio=0.0011
    Epoch 10/10: total=1.8837, vae=1.0945, dsb=0.7887, bio=0.0011

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=92.6997, vae=1.0971, dsb=91.6010, bio=0.0032
    Epoch  2/10: total=91.3910, vae=1.0958, dsb=90.2946, bio=0.0011
    Epoch  3/10: total=90.9714, vae=1.0954, dsb=89.8755, bio=0.0011
    Epoch  4/10: total=91.2131, vae=1.0954, dsb=90.1172, bio=0.0011
    Epoch  5/10: total=91.3879, vae=1.0954, dsb=90.2920, bio=0.0010
    Epoch  6/10: total=90.8472, vae=1.0946, dsb=89.7520, bio=0.0013
    Epoch  7/10: total=91.0129, vae=1.0950, dsb=89.9173, bio=0.0012
    Epoch  8/10: total=91.5584, vae=1.0944, dsb=90.4634, bio=0.0011
    Epoch  9/10: total=91.3788, vae=1.0957, dsb=90.2826, bio=0.0011
    Epoch 10/10: total=91.3627, vae=1.0942, dsb=90.2680, bio=0.0010

  [Backward Policy Training]
    Epoch  1/10: total=1.8744, vae=1.0948, dsb=0.7337, bio=0.0918
    Epoch  2/10: total=1.7775, vae=1.0950, dsb=0.6819, bio=0.0012
    Epoch  3/10: total=1.7831, vae=1.0950, dsb=0.6876, bio=0.0011
    Epoch  4/10: total=1.7775, vae=1.0947, dsb=0.6823, bio=0.0010
    Epoch  5/10: total=1.7763, vae=1.0941, dsb=0.6817, bio=0.0010
    Epoch  6/10: total=1.7975, vae=1.0942, dsb=0.7029, bio=0.0008
    Epoch  7/10: total=1.7884, vae=1.0939, dsb=0.6939, bio=0.0012
    Epoch  8/10: total=1.7966, vae=1.0934, dsb=0.7027, bio=0.0010
    Epoch  9/10: total=1.7948, vae=1.0940, dsb=0.7003, bio=0.0010
    Epoch 10/10: total=1.7799, vae=1.0936, dsb=0.6858, bio=0.0010

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=76.0175, vae=1.0968, dsb=74.9196, bio=0.0024
    Epoch  2/10: total=76.1331, vae=1.0953, dsb=75.0373, bio=0.0010
    Epoch  3/10: total=75.9692, vae=1.0951, dsb=74.8736, bio=0.0010
    Epoch  4/10: total=75.8702, vae=1.0947, dsb=74.7752, bio=0.0006
    Epoch  5/10: total=76.2380, vae=1.0945, dsb=75.1433, bio=0.0004
    Epoch  6/10: total=76.0041, vae=1.0936, dsb=74.9099, bio=0.0012
    Epoch  7/10: total=75.7525, vae=1.0938, dsb=74.6582, bio=0.0010
    Epoch  8/10: total=76.5177, vae=1.0942, dsb=75.4232, bio=0.0008
    Epoch  9/10: total=76.1638, vae=1.0946, dsb=75.0690, bio=0.0004
    Epoch 10/10: total=75.7858, vae=1.0935, dsb=74.6920, bio=0.0004

  [Backward Policy Training]
    Epoch  1/10: total=1.8266, vae=1.0951, dsb=0.6398, bio=0.1834
    Epoch  2/10: total=1.7225, vae=1.0939, dsb=0.6281, bio=0.0011
    Epoch  3/10: total=1.7112, vae=1.0943, dsb=0.6163, bio=0.0011
    Epoch  4/10: total=1.7116, vae=1.0946, dsb=0.6165, bio=0.0010
    Epoch  5/10: total=1.7340, vae=1.0936, dsb=0.6401, bio=0.0006
    Epoch  6/10: total=1.7375, vae=1.0943, dsb=0.6426, bio=0.0011
    Epoch  7/10: total=1.7174, vae=1.0945, dsb=0.6224, bio=0.0009
    Epoch  8/10: total=1.7084, vae=1.0935, dsb=0.6145, bio=0.0007
    Epoch  9/10: total=1.7247, vae=1.0940, dsb=0.6302, bio=0.0010
    Epoch 10/10: total=1.7105, vae=1.0936, dsb=0.6164, bio=0.0009

[Seed 28] Joint training (original) complete; models and history saved.

[Seed 28] Starting joint training (ablation)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=587.2693, vae=2.0071, dsb=585.2622, bio=0.0000
    Epoch  2/10: total=171.1538, vae=1.0905, dsb=170.0633, bio=0.0000
    Epoch  3/10: total=161.1054, vae=1.0891, dsb=160.0163, bio=0.0000
    Epoch  4/10: total=156.0711, vae=1.0876, dsb=154.9835, bio=0.0000
    Epoch  5/10: total=153.3859, vae=1.0872, dsb=152.2988, bio=0.0000
    Epoch  6/10: total=152.0877, vae=1.0874, dsb=151.0002, bio=0.0000
    Epoch  7/10: total=149.8981, vae=1.0876, dsb=148.8105, bio=0.0000
    Epoch  8/10: total=148.8735, vae=1.0874, dsb=147.7861, bio=0.0000
    Epoch  9/10: total=148.4083, vae=1.0868, dsb=147.3215, bio=0.0000
    Epoch 10/10: total=147.9882, vae=1.0873, dsb=146.9009, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=3.2579, vae=1.0868, dsb=2.1711, bio=0.0000
    Epoch  2/10: total=2.7972, vae=1.0873, dsb=1.7098, bio=0.0000
    Epoch  3/10: total=2.7209, vae=1.0870, dsb=1.6339, bio=0.0000
    Epoch  4/10: total=2.6115, vae=1.0868, dsb=1.5246, bio=0.0000
    Epoch  5/10: total=2.5833, vae=1.0868, dsb=1.4966, bio=0.0000
    Epoch  6/10: total=2.5577, vae=1.0864, dsb=1.4713, bio=0.0000
    Epoch  7/10: total=2.5266, vae=1.0872, dsb=1.4394, bio=0.0000
    Epoch  8/10: total=2.5354, vae=1.0868, dsb=1.4486, bio=0.0000
    Epoch  9/10: total=2.5700, vae=1.0865, dsb=1.4835, bio=0.0000
    Epoch 10/10: total=2.4866, vae=1.0864, dsb=1.4002, bio=0.0000

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=124.3538, vae=1.0872, dsb=123.2666, bio=0.0000
    Epoch  2/10: total=120.2056, vae=1.0867, dsb=119.1189, bio=0.0000
    Epoch  3/10: total=118.4606, vae=1.0868, dsb=117.3738, bio=0.0000
    Epoch  4/10: total=117.6228, vae=1.0866, dsb=116.5362, bio=0.0000
    Epoch  5/10: total=117.8241, vae=1.0871, dsb=116.7370, bio=0.0000
    Epoch  6/10: total=117.5410, vae=1.0863, dsb=116.4546, bio=0.0000
    Epoch  7/10: total=117.3997, vae=1.0867, dsb=116.3130, bio=0.0000
    Epoch  8/10: total=116.8731, vae=1.0871, dsb=115.7860, bio=0.0000
    Epoch  9/10: total=116.6504, vae=1.0863, dsb=115.5641, bio=0.0000
    Epoch 10/10: total=116.5471, vae=1.0864, dsb=115.4607, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=2.2066, vae=1.0870, dsb=1.1196, bio=0.0000
    Epoch  2/10: total=2.1039, vae=1.0861, dsb=1.0178, bio=0.0000
    Epoch  3/10: total=2.0855, vae=1.0874, dsb=0.9980, bio=0.0000
    Epoch  4/10: total=2.0495, vae=1.0871, dsb=0.9624, bio=0.0000
    Epoch  5/10: total=2.0337, vae=1.0866, dsb=0.9471, bio=0.0000
    Epoch  6/10: total=2.0265, vae=1.0860, dsb=0.9406, bio=0.0000
    Epoch  7/10: total=2.0473, vae=1.0859, dsb=0.9615, bio=0.0000
    Epoch  8/10: total=2.0138, vae=1.0865, dsb=0.9272, bio=0.0000
    Epoch  9/10: total=2.0157, vae=1.0870, dsb=0.9287, bio=0.0000
    Epoch 10/10: total=1.9847, vae=1.0862, dsb=0.8985, bio=0.0000

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=100.5888, vae=1.0867, dsb=99.5022, bio=0.0000
    Epoch  2/10: total=98.9317, vae=1.0872, dsb=97.8445, bio=0.0000
    Epoch  3/10: total=99.1089, vae=1.0862, dsb=98.0227, bio=0.0000
    Epoch  4/10: total=98.6909, vae=1.0861, dsb=97.6048, bio=0.0000
    Epoch  5/10: total=98.7426, vae=1.0862, dsb=97.6564, bio=0.0000
    Epoch  6/10: total=98.4895, vae=1.0861, dsb=97.4033, bio=0.0000
    Epoch  7/10: total=98.0635, vae=1.0873, dsb=96.9762, bio=0.0000
    Epoch  8/10: total=98.7367, vae=1.0867, dsb=97.6500, bio=0.0000
    Epoch  9/10: total=98.0434, vae=1.0855, dsb=96.9579, bio=0.0000
    Epoch 10/10: total=98.1766, vae=1.0873, dsb=97.0893, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.9055, vae=1.0859, dsb=0.8196, bio=0.0000
    Epoch  2/10: total=1.8855, vae=1.0865, dsb=0.7991, bio=0.0000
    Epoch  3/10: total=1.8594, vae=1.0868, dsb=0.7726, bio=0.0000
    Epoch  4/10: total=1.8367, vae=1.0860, dsb=0.7507, bio=0.0000
    Epoch  5/10: total=1.8343, vae=1.0868, dsb=0.7475, bio=0.0000
    Epoch  6/10: total=1.8360, vae=1.0868, dsb=0.7491, bio=0.0000
    Epoch  7/10: total=1.8085, vae=1.0870, dsb=0.7216, bio=0.0000
    Epoch  8/10: total=1.8312, vae=1.0865, dsb=0.7447, bio=0.0000
    Epoch  9/10: total=1.8354, vae=1.0867, dsb=0.7487, bio=0.0000
    Epoch 10/10: total=1.8218, vae=1.0866, dsb=0.7352, bio=0.0000

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=92.1144, vae=1.0861, dsb=91.0283, bio=0.0000
    Epoch  2/10: total=90.8716, vae=1.0866, dsb=89.7850, bio=0.0000
    Epoch  3/10: total=90.4574, vae=1.0864, dsb=89.3710, bio=0.0000
    Epoch  4/10: total=90.7625, vae=1.0866, dsb=89.6759, bio=0.0000
    Epoch  5/10: total=91.0021, vae=1.0867, dsb=89.9155, bio=0.0000
    Epoch  6/10: total=90.3534, vae=1.0860, dsb=89.2674, bio=0.0000
    Epoch  7/10: total=90.5698, vae=1.0866, dsb=89.4832, bio=0.0000
    Epoch  8/10: total=91.0177, vae=1.0860, dsb=89.9317, bio=0.0000
    Epoch  9/10: total=90.9204, vae=1.0874, dsb=89.8330, bio=0.0000
    Epoch 10/10: total=90.9238, vae=1.0859, dsb=89.8379, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.7481, vae=1.0856, dsb=0.6624, bio=0.0000
    Epoch  2/10: total=1.7008, vae=1.0870, dsb=0.6138, bio=0.0000
    Epoch  3/10: total=1.7059, vae=1.0871, dsb=0.6188, bio=0.0000
    Epoch  4/10: total=1.7011, vae=1.0869, dsb=0.6142, bio=0.0000
    Epoch  5/10: total=1.6999, vae=1.0863, dsb=0.6135, bio=0.0000
    Epoch  6/10: total=1.7200, vae=1.0864, dsb=0.6336, bio=0.0000
    Epoch  7/10: total=1.7114, vae=1.0862, dsb=0.6252, bio=0.0000
    Epoch  8/10: total=1.7196, vae=1.0858, dsb=0.6338, bio=0.0000
    Epoch  9/10: total=1.7181, vae=1.0864, dsb=0.6317, bio=0.0000
    Epoch 10/10: total=1.7044, vae=1.0860, dsb=0.6184, bio=0.0000

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=71.9816, vae=1.0862, dsb=70.8955, bio=0.0000
    Epoch  2/10: total=71.9555, vae=1.0866, dsb=70.8689, bio=0.0000
    Epoch  3/10: total=71.8354, vae=1.0868, dsb=70.7486, bio=0.0000
    Epoch  4/10: total=71.6783, vae=1.0864, dsb=70.5918, bio=0.0000
    Epoch  5/10: total=72.1444, vae=1.0864, dsb=71.0581, bio=0.0000
    Epoch  6/10: total=71.8239, vae=1.0857, dsb=70.7382, bio=0.0000
    Epoch  7/10: total=71.5899, vae=1.0860, dsb=70.5039, bio=0.0000
    Epoch  8/10: total=72.3746, vae=1.0863, dsb=71.2883, bio=0.0000
    Epoch  9/10: total=72.0534, vae=1.0868, dsb=70.9666, bio=0.0000
    Epoch 10/10: total=71.6070, vae=1.0858, dsb=70.5211, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.6524, vae=1.0860, dsb=0.5663, bio=0.0000
    Epoch  2/10: total=1.6422, vae=1.0862, dsb=0.5560, bio=0.0000
    Epoch  3/10: total=1.6324, vae=1.0867, dsb=0.5457, bio=0.0000
    Epoch  4/10: total=1.6327, vae=1.0870, dsb=0.5457, bio=0.0000
    Epoch  5/10: total=1.6533, vae=1.0861, dsb=0.5672, bio=0.0000
    Epoch  6/10: total=1.6570, vae=1.0870, dsb=0.5700, bio=0.0000
    Epoch  7/10: total=1.6385, vae=1.0870, dsb=0.5515, bio=0.0000
    Epoch  8/10: total=1.6309, vae=1.0862, dsb=0.5446, bio=0.0000
    Epoch  9/10: total=1.6454, vae=1.0868, dsb=0.5586, bio=0.0000
    Epoch 10/10: total=1.6329, vae=1.0864, dsb=0.5465, bio=0.0000

[Seed 28] Joint training (ablation) complete; models and history saved.

[Seed 28] Drift genes saved in /home/yyuan/ICB_TCE/iter_results/run_028

[Seed 28] run finished.

================================================================================
[Seed 29] Starting running whole pipeline...
================================================================================

[Seed 29] Starting VAE pre-training...

    Epoch [01/20], Beta: 0.000, Average Loss: 534.1155
    Epoch [02/20], Beta: 0.000, Average Loss: 306.4031
    Epoch [03/20], Beta: 0.000, Average Loss: 269.0472
    Epoch [04/20], Beta: 0.000, Average Loss: 249.6039
    Epoch [05/20], Beta: 0.100, Average Loss: 245.4176
    Epoch [06/20], Beta: 0.200, Average Loss: 244.6982
    Epoch [07/20], Beta: 0.300, Average Loss: 244.5424
    Epoch [08/20], Beta: 0.400, Average Loss: 245.3338
    Epoch [09/20], Beta: 0.500, Average Loss: 246.4797
    Epoch [10/20], Beta: 0.600, Average Loss: 247.7114
    Epoch [11/20], Beta: 0.700, Average Loss: 249.0361
    Epoch [12/20], Beta: 0.800, Average Loss: 250.3173
    Epoch [13/20], Beta: 0.900, Average Loss: 251.6468
    Epoch [14/20], Beta: 1.000, Average Loss: 252.8351
    Epoch [15/20], Beta: 1.000, Average Loss: 252.4590
    Epoch [16/20], Beta: 1.000, Average Loss: 252.0956
    Epoch [17/20], Beta: 1.000, Average Loss: 251.7567
    Epoch [18/20], Beta: 1.000, Average Loss: 251.4393
    Epoch [19/20], Beta: 1.000, Average Loss: 251.1921
    Epoch [20/20], Beta: 1.000, Average Loss: 250.8427

[Seed 29] VAE pre-training complete.

[Seed 29] Starting joint training (original)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=592.5945, vae=3.5774, dsb=579.0167, bio=20.0008
    Epoch  2/10: total=159.5463, vae=1.1081, dsb=158.4059, bio=0.0647
    Epoch  3/10: total=149.2325, vae=1.1036, dsb=148.1141, bio=0.0294
    Epoch  4/10: total=143.7771, vae=1.1018, dsb=142.6665, bio=0.0177
    Epoch  5/10: total=140.9159, vae=1.1024, dsb=139.8077, bio=0.0117
    Epoch  6/10: total=138.8386, vae=1.1014, dsb=137.7330, bio=0.0086
    Epoch  7/10: total=137.7158, vae=1.1011, dsb=136.6114, bio=0.0067
    Epoch  8/10: total=135.7864, vae=1.1012, dsb=134.6824, bio=0.0055
    Epoch  9/10: total=134.9584, vae=1.1011, dsb=133.8550, bio=0.0047
    Epoch 10/10: total=134.6317, vae=1.0994, dsb=133.5302, bio=0.0041

  [Backward Policy Training]
    Epoch  1/10: total=3.4094, vae=1.1007, dsb=2.3015, bio=0.0144
    Epoch  2/10: total=2.9532, vae=1.0993, dsb=1.8516, bio=0.0045
    Epoch  3/10: total=2.8428, vae=1.0995, dsb=1.7418, bio=0.0032
    Epoch  4/10: total=2.8130, vae=1.0976, dsb=1.7141, bio=0.0027
    Epoch  5/10: total=2.7300, vae=1.0988, dsb=1.6300, bio=0.0024
    Epoch  6/10: total=2.7163, vae=1.0980, dsb=1.6171, bio=0.0024
    Epoch  7/10: total=2.6674, vae=1.0989, dsb=1.5674, bio=0.0020
    Epoch  8/10: total=2.6278, vae=1.0981, dsb=1.5287, bio=0.0020
    Epoch  9/10: total=2.5882, vae=1.0979, dsb=1.4893, bio=0.0019
    Epoch 10/10: total=2.6216, vae=1.0972, dsb=1.5235, bio=0.0019

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=115.6446, vae=1.1001, dsb=114.5426, bio=0.0036
    Epoch  2/10: total=110.6684, vae=1.0987, dsb=109.5687, bio=0.0020
    Epoch  3/10: total=109.2360, vae=1.0989, dsb=108.1361, bio=0.0021
    Epoch  4/10: total=108.4448, vae=1.0986, dsb=107.3454, bio=0.0017
    Epoch  5/10: total=108.2649, vae=1.0983, dsb=107.1657, bio=0.0017
    Epoch  6/10: total=107.8841, vae=1.0980, dsb=106.7852, bio=0.0018
    Epoch  7/10: total=108.3018, vae=1.0984, dsb=107.2025, bio=0.0018
    Epoch  8/10: total=107.4143, vae=1.0983, dsb=106.3152, bio=0.0018
    Epoch  9/10: total=106.7881, vae=1.0989, dsb=105.6882, bio=0.0020
    Epoch 10/10: total=107.0135, vae=1.0970, dsb=105.9156, bio=0.0019

  [Backward Policy Training]
    Epoch  1/10: total=2.3478, vae=1.0990, dsb=1.2459, bio=0.0059
    Epoch  2/10: total=2.2391, vae=1.0967, dsb=1.1415, bio=0.0020
    Epoch  3/10: total=2.1979, vae=1.0966, dsb=1.1004, bio=0.0017
    Epoch  4/10: total=2.1877, vae=1.0958, dsb=1.0910, bio=0.0017
    Epoch  5/10: total=2.1511, vae=1.0975, dsb=1.0528, bio=0.0016
    Epoch  6/10: total=2.1545, vae=1.0969, dsb=1.0569, bio=0.0016
    Epoch  7/10: total=2.1544, vae=1.0968, dsb=1.0568, bio=0.0017
    Epoch  8/10: total=2.1261, vae=1.0961, dsb=1.0293, bio=0.0015
    Epoch  9/10: total=2.1633, vae=1.0962, dsb=1.0664, bio=0.0015
    Epoch 10/10: total=2.1363, vae=1.0956, dsb=1.0400, bio=0.0015

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=89.6210, vae=1.0987, dsb=88.5207, bio=0.0031
    Epoch  2/10: total=88.4149, vae=1.0978, dsb=87.3163, bio=0.0016
    Epoch  3/10: total=87.6809, vae=1.0969, dsb=86.5832, bio=0.0016
    Epoch  4/10: total=87.5184, vae=1.0973, dsb=86.4202, bio=0.0017
    Epoch  5/10: total=87.6097, vae=1.0974, dsb=86.5116, bio=0.0015
    Epoch  6/10: total=87.6576, vae=1.0974, dsb=86.5594, bio=0.0015
    Epoch  7/10: total=87.0715, vae=1.0968, dsb=85.9739, bio=0.0015
    Epoch  8/10: total=86.9811, vae=1.0972, dsb=85.8832, bio=0.0015
    Epoch  9/10: total=87.0282, vae=1.0971, dsb=85.9303, bio=0.0015
    Epoch 10/10: total=86.8810, vae=1.0962, dsb=85.7840, bio=0.0015

  [Backward Policy Training]
    Epoch  1/10: total=2.0208, vae=1.0968, dsb=0.9167, bio=0.0148
    Epoch  2/10: total=1.9595, vae=1.0967, dsb=0.8621, bio=0.0016
    Epoch  3/10: total=1.9802, vae=1.0963, dsb=0.8832, bio=0.0014
    Epoch  4/10: total=1.9054, vae=1.0960, dsb=0.8086, bio=0.0018
    Epoch  5/10: total=1.9311, vae=1.0955, dsb=0.8349, bio=0.0013
    Epoch  6/10: total=1.9296, vae=1.0965, dsb=0.8325, bio=0.0013
    Epoch  7/10: total=1.9213, vae=1.0951, dsb=0.8256, bio=0.0013
    Epoch  8/10: total=1.9155, vae=1.0950, dsb=0.8199, bio=0.0013
    Epoch  9/10: total=1.9335, vae=1.0957, dsb=0.8372, bio=0.0013
    Epoch 10/10: total=1.9243, vae=1.0961, dsb=0.8275, bio=0.0012

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=80.6463, vae=1.0985, dsb=79.5464, bio=0.0029
    Epoch  2/10: total=80.1887, vae=1.0970, dsb=79.0910, bio=0.0013
    Epoch  3/10: total=79.2525, vae=1.0972, dsb=78.1546, bio=0.0014
    Epoch  4/10: total=79.7445, vae=1.0968, dsb=78.6471, bio=0.0014
    Epoch  5/10: total=79.8294, vae=1.0966, dsb=78.7321, bio=0.0014
    Epoch  6/10: total=79.6535, vae=1.0964, dsb=78.5564, bio=0.0014
    Epoch  7/10: total=79.1291, vae=1.0963, dsb=78.0322, bio=0.0013
    Epoch  8/10: total=79.5653, vae=1.0960, dsb=78.4686, bio=0.0014
    Epoch  9/10: total=79.2584, vae=1.0967, dsb=78.1610, bio=0.0013
    Epoch 10/10: total=79.6591, vae=1.0960, dsb=78.5625, bio=0.0013

  [Backward Policy Training]
    Epoch  1/10: total=1.8247, vae=1.0969, dsb=0.7015, bio=0.0526
    Epoch  2/10: total=1.7914, vae=1.0963, dsb=0.6944, bio=0.0014
    Epoch  3/10: total=1.8077, vae=1.0954, dsb=0.7118, bio=0.0013
    Epoch  4/10: total=1.7737, vae=1.0953, dsb=0.6778, bio=0.0012
    Epoch  5/10: total=1.7782, vae=1.0963, dsb=0.6814, bio=0.0012
    Epoch  6/10: total=1.7623, vae=1.0955, dsb=0.6663, bio=0.0011
    Epoch  7/10: total=1.7630, vae=1.0955, dsb=0.6669, bio=0.0011
    Epoch  8/10: total=1.7744, vae=1.0955, dsb=0.6783, bio=0.0011
    Epoch  9/10: total=1.7777, vae=1.0956, dsb=0.6815, bio=0.0011
    Epoch 10/10: total=1.7714, vae=1.0948, dsb=0.6760, bio=0.0011

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=67.8194, vae=1.0989, dsb=66.7192, bio=0.0026
    Epoch  2/10: total=67.5584, vae=1.0976, dsb=66.4603, bio=0.0011
    Epoch  3/10: total=67.6285, vae=1.0960, dsb=66.5318, bio=0.0013
    Epoch  4/10: total=67.4077, vae=1.0963, dsb=66.3108, bio=0.0012
    Epoch  5/10: total=67.5605, vae=1.0975, dsb=66.4625, bio=0.0012
    Epoch  6/10: total=67.8770, vae=1.0959, dsb=66.7805, bio=0.0012
    Epoch  7/10: total=67.4613, vae=1.0959, dsb=66.3648, bio=0.0011
    Epoch  8/10: total=67.3601, vae=1.0949, dsb=66.2647, bio=0.0011
    Epoch  9/10: total=67.7263, vae=1.0961, dsb=66.6297, bio=0.0011
    Epoch 10/10: total=67.7043, vae=1.0959, dsb=66.6079, bio=0.0010

  [Backward Policy Training]
    Epoch  1/10: total=1.7974, vae=1.0956, dsb=0.6208, bio=0.1621
    Epoch  2/10: total=1.7108, vae=1.0959, dsb=0.6143, bio=0.0013
    Epoch  3/10: total=1.7017, vae=1.0951, dsb=0.6061, bio=0.0011
    Epoch  4/10: total=1.6903, vae=1.0956, dsb=0.5942, bio=0.0011
    Epoch  5/10: total=1.7107, vae=1.0954, dsb=0.6148, bio=0.0011
    Epoch  6/10: total=1.6845, vae=1.0952, dsb=0.5887, bio=0.0012
    Epoch  7/10: total=1.7159, vae=1.0952, dsb=0.6201, bio=0.0010
    Epoch  8/10: total=1.7005, vae=1.0960, dsb=0.6040, bio=0.0010
    Epoch  9/10: total=1.7077, vae=1.0955, dsb=0.6117, bio=0.0010
    Epoch 10/10: total=1.6630, vae=1.0940, dsb=0.5684, bio=0.0011

[Seed 29] Joint training (original) complete; models and history saved.

[Seed 29] Starting joint training (ablation)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=579.9730, vae=2.0349, dsb=577.9381, bio=0.0000
    Epoch  2/10: total=158.4043, vae=1.0922, dsb=157.3122, bio=0.0000
    Epoch  3/10: total=148.5713, vae=1.0899, dsb=147.4814, bio=0.0000
    Epoch  4/10: total=143.3334, vae=1.0887, dsb=142.2447, bio=0.0000
    Epoch  5/10: total=140.5709, vae=1.0895, dsb=139.4813, bio=0.0000
    Epoch  6/10: total=138.4741, vae=1.0887, dsb=137.3853, bio=0.0000
    Epoch  7/10: total=137.3096, vae=1.0888, dsb=136.2207, bio=0.0000
    Epoch  8/10: total=135.4096, vae=1.0891, dsb=134.3205, bio=0.0000
    Epoch  9/10: total=134.5972, vae=1.0893, dsb=133.5079, bio=0.0000
    Epoch 10/10: total=134.2732, vae=1.0878, dsb=133.1854, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=3.2884, vae=1.0882, dsb=2.2002, bio=0.0000
    Epoch  2/10: total=2.8475, vae=1.0883, dsb=1.7591, bio=0.0000
    Epoch  3/10: total=2.7400, vae=1.0889, dsb=1.6511, bio=0.0000
    Epoch  4/10: total=2.7125, vae=1.0874, dsb=1.6251, bio=0.0000
    Epoch  5/10: total=2.6348, vae=1.0888, dsb=1.5460, bio=0.0000
    Epoch  6/10: total=2.6220, vae=1.0881, dsb=1.5339, bio=0.0000
    Epoch  7/10: total=2.5749, vae=1.0892, dsb=1.4857, bio=0.0000
    Epoch  8/10: total=2.5357, vae=1.0884, dsb=1.4473, bio=0.0000
    Epoch  9/10: total=2.4989, vae=1.0885, dsb=1.4104, bio=0.0000
    Epoch 10/10: total=2.5311, vae=1.0877, dsb=1.4434, bio=0.0000

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=114.5024, vae=1.0879, dsb=113.4144, bio=0.0000
    Epoch  2/10: total=109.5331, vae=1.0878, dsb=108.4453, bio=0.0000
    Epoch  3/10: total=107.9721, vae=1.0882, dsb=106.8839, bio=0.0000
    Epoch  4/10: total=107.2662, vae=1.0881, dsb=106.1780, bio=0.0000
    Epoch  5/10: total=107.1158, vae=1.0879, dsb=106.0278, bio=0.0000
    Epoch  6/10: total=106.6653, vae=1.0878, dsb=105.5776, bio=0.0000
    Epoch  7/10: total=107.1031, vae=1.0882, dsb=106.0149, bio=0.0000
    Epoch  8/10: total=106.2336, vae=1.0882, dsb=105.1455, bio=0.0000
    Epoch  9/10: total=105.6087, vae=1.0888, dsb=104.5199, bio=0.0000
    Epoch 10/10: total=105.8615, vae=1.0871, dsb=104.7744, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=2.2553, vae=1.0882, dsb=1.1671, bio=0.0000
    Epoch  2/10: total=2.1574, vae=1.0877, dsb=1.0697, bio=0.0000
    Epoch  3/10: total=2.1182, vae=1.0878, dsb=1.0304, bio=0.0000
    Epoch  4/10: total=2.1088, vae=1.0871, dsb=1.0217, bio=0.0000
    Epoch  5/10: total=2.0734, vae=1.0887, dsb=0.9847, bio=0.0000
    Epoch  6/10: total=2.0765, vae=1.0882, dsb=0.9883, bio=0.0000
    Epoch  7/10: total=2.0762, vae=1.0882, dsb=0.9879, bio=0.0000
    Epoch  8/10: total=2.0491, vae=1.0875, dsb=0.9616, bio=0.0000
    Epoch  9/10: total=2.0846, vae=1.0877, dsb=0.9969, bio=0.0000
    Epoch 10/10: total=2.0582, vae=1.0870, dsb=0.9712, bio=0.0000

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=88.0124, vae=1.0875, dsb=86.9250, bio=0.0000
    Epoch  2/10: total=86.7850, vae=1.0879, dsb=85.6970, bio=0.0000
    Epoch  3/10: total=86.0816, vae=1.0872, dsb=84.9944, bio=0.0000
    Epoch  4/10: total=85.9503, vae=1.0877, dsb=84.8626, bio=0.0000
    Epoch  5/10: total=86.0379, vae=1.0880, dsb=84.9499, bio=0.0000
    Epoch  6/10: total=86.0883, vae=1.0880, dsb=85.0003, bio=0.0000
    Epoch  7/10: total=85.5550, vae=1.0875, dsb=84.4675, bio=0.0000
    Epoch  8/10: total=85.4692, vae=1.0880, dsb=84.3812, bio=0.0000
    Epoch  9/10: total=85.4685, vae=1.0880, dsb=84.3806, bio=0.0000
    Epoch 10/10: total=85.3456, vae=1.0872, dsb=84.2584, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.9358, vae=1.0875, dsb=0.8484, bio=0.0000
    Epoch  2/10: total=1.8866, vae=1.0883, dsb=0.7983, bio=0.0000
    Epoch  3/10: total=1.9075, vae=1.0881, dsb=0.8194, bio=0.0000
    Epoch  4/10: total=1.8366, vae=1.0877, dsb=0.7489, bio=0.0000
    Epoch  5/10: total=1.8612, vae=1.0874, dsb=0.7737, bio=0.0000
    Epoch  6/10: total=1.8600, vae=1.0884, dsb=0.7716, bio=0.0000
    Epoch  7/10: total=1.8524, vae=1.0870, dsb=0.7654, bio=0.0000
    Epoch  8/10: total=1.8466, vae=1.0869, dsb=0.7597, bio=0.0000
    Epoch  9/10: total=1.8637, vae=1.0876, dsb=0.7761, bio=0.0000
    Epoch 10/10: total=1.8556, vae=1.0881, dsb=0.7674, bio=0.0000

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=79.4503, vae=1.0878, dsb=78.3626, bio=0.0000
    Epoch  2/10: total=79.0380, vae=1.0876, dsb=77.9504, bio=0.0000
    Epoch  3/10: total=78.0910, vae=1.0882, dsb=77.0028, bio=0.0000
    Epoch  4/10: total=78.6772, vae=1.0879, dsb=77.5893, bio=0.0000
    Epoch  5/10: total=78.6923, vae=1.0878, dsb=77.6045, bio=0.0000
    Epoch  6/10: total=78.5093, vae=1.0877, dsb=77.4216, bio=0.0000
    Epoch  7/10: total=78.0380, vae=1.0876, dsb=76.9503, bio=0.0000
    Epoch  8/10: total=78.4616, vae=1.0875, dsb=77.3741, bio=0.0000
    Epoch  9/10: total=78.1485, vae=1.0883, dsb=77.0602, bio=0.0000
    Epoch 10/10: total=78.6074, vae=1.0877, dsb=77.5197, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.7293, vae=1.0878, dsb=0.6416, bio=0.0000
    Epoch  2/10: total=1.7256, vae=1.0883, dsb=0.6373, bio=0.0000
    Epoch  3/10: total=1.7426, vae=1.0874, dsb=0.6552, bio=0.0000
    Epoch  4/10: total=1.7110, vae=1.0874, dsb=0.6236, bio=0.0000
    Epoch  5/10: total=1.7163, vae=1.0885, dsb=0.6278, bio=0.0000
    Epoch  6/10: total=1.7012, vae=1.0876, dsb=0.6136, bio=0.0000
    Epoch  7/10: total=1.7023, vae=1.0878, dsb=0.6145, bio=0.0000
    Epoch  8/10: total=1.7134, vae=1.0878, dsb=0.6256, bio=0.0000
    Epoch  9/10: total=1.7161, vae=1.0879, dsb=0.6282, bio=0.0000
    Epoch 10/10: total=1.7104, vae=1.0872, dsb=0.6233, bio=0.0000

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=66.6123, vae=1.0884, dsb=65.5239, bio=0.0000
    Epoch  2/10: total=66.4573, vae=1.0885, dsb=65.3689, bio=0.0000
    Epoch  3/10: total=66.5162, vae=1.0874, dsb=65.4288, bio=0.0000
    Epoch  4/10: total=66.3086, vae=1.0880, dsb=65.2206, bio=0.0000
    Epoch  5/10: total=66.5013, vae=1.0892, dsb=65.4121, bio=0.0000
    Epoch  6/10: total=66.7507, vae=1.0878, dsb=65.6629, bio=0.0000
    Epoch  7/10: total=66.3652, vae=1.0879, dsb=65.2773, bio=0.0000
    Epoch  8/10: total=66.2647, vae=1.0870, dsb=65.1778, bio=0.0000
    Epoch  9/10: total=66.6334, vae=1.0882, dsb=65.5452, bio=0.0000
    Epoch 10/10: total=66.6016, vae=1.0881, dsb=65.5136, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.6570, vae=1.0867, dsb=0.5702, bio=0.0000
    Epoch  2/10: total=1.6543, vae=1.0881, dsb=0.5662, bio=0.0000
    Epoch  3/10: total=1.6463, vae=1.0874, dsb=0.5589, bio=0.0000
    Epoch  4/10: total=1.6362, vae=1.0880, dsb=0.5482, bio=0.0000
    Epoch  5/10: total=1.6562, vae=1.0879, dsb=0.5683, bio=0.0000
    Epoch  6/10: total=1.6312, vae=1.0877, dsb=0.5435, bio=0.0000
    Epoch  7/10: total=1.6609, vae=1.0878, dsb=0.5731, bio=0.0000
    Epoch  8/10: total=1.6468, vae=1.0886, dsb=0.5582, bio=0.0000
    Epoch  9/10: total=1.6538, vae=1.0881, dsb=0.5656, bio=0.0000
    Epoch 10/10: total=1.6114, vae=1.0867, dsb=0.5247, bio=0.0000

[Seed 29] Joint training (ablation) complete; models and history saved.

[Seed 29] Drift genes saved in /home/yyuan/ICB_TCE/iter_results/run_029

[Seed 29] run finished.

================================================================================
[Seed 30] Starting running whole pipeline...
================================================================================

[Seed 30] Starting VAE pre-training...

    Epoch [01/20], Beta: 0.000, Average Loss: 534.3140
    Epoch [02/20], Beta: 0.000, Average Loss: 309.3878
    Epoch [03/20], Beta: 0.000, Average Loss: 274.6210
    Epoch [04/20], Beta: 0.000, Average Loss: 254.6604
    Epoch [05/20], Beta: 0.100, Average Loss: 247.1643
    Epoch [06/20], Beta: 0.200, Average Loss: 245.8707
    Epoch [07/20], Beta: 0.300, Average Loss: 245.5410
    Epoch [08/20], Beta: 0.400, Average Loss: 245.8480
    Epoch [09/20], Beta: 0.500, Average Loss: 246.6885
    Epoch [10/20], Beta: 0.600, Average Loss: 247.8234
    Epoch [11/20], Beta: 0.700, Average Loss: 249.0597
    Epoch [12/20], Beta: 0.800, Average Loss: 250.3157
    Epoch [13/20], Beta: 0.900, Average Loss: 251.6790
    Epoch [14/20], Beta: 1.000, Average Loss: 252.8645
    Epoch [15/20], Beta: 1.000, Average Loss: 252.4285
    Epoch [16/20], Beta: 1.000, Average Loss: 252.1010
    Epoch [17/20], Beta: 1.000, Average Loss: 251.7655
    Epoch [18/20], Beta: 1.000, Average Loss: 251.4790
    Epoch [19/20], Beta: 1.000, Average Loss: 251.1654
    Epoch [20/20], Beta: 1.000, Average Loss: 250.8350

[Seed 30] VAE pre-training complete.

[Seed 30] Starting joint training (original)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=244.3849, vae=3.5120, dsb=228.3519, bio=25.0420
    Epoch  2/10: total=70.3339, vae=1.1010, dsb=69.1966, bio=0.0726
    Epoch  3/10: total=60.2703, vae=1.0957, dsb=59.1594, bio=0.0304
    Epoch  4/10: total=55.2968, vae=1.0932, dsb=54.1944, bio=0.0184
    Epoch  5/10: total=52.4635, vae=1.0925, dsb=51.3648, bio=0.0122
    Epoch  6/10: total=50.2836, vae=1.0909, dsb=49.1882, bio=0.0091
    Epoch  7/10: total=48.8319, vae=1.0909, dsb=47.7376, bio=0.0070
    Epoch  8/10: total=47.7206, vae=1.0909, dsb=46.6264, bio=0.0065
    Epoch  9/10: total=47.1221, vae=1.0907, dsb=46.0291, bio=0.0046
    Epoch 10/10: total=46.3898, vae=1.0896, dsb=45.2983, bio=0.0040

  [Backward Policy Training]
    Epoch  1/10: total=3.1151, vae=1.0912, dsb=2.0180, bio=0.0120
    Epoch  2/10: total=2.6727, vae=1.0893, dsb=1.5813, bio=0.0041
    Epoch  3/10: total=2.5408, vae=1.0899, dsb=1.4494, bio=0.0031
    Epoch  4/10: total=2.4661, vae=1.0889, dsb=1.3759, bio=0.0026
    Epoch  5/10: total=2.4315, vae=1.0885, dsb=1.3419, bio=0.0023
    Epoch  6/10: total=2.3913, vae=1.0887, dsb=1.3016, bio=0.0021
    Epoch  7/10: total=2.3603, vae=1.0892, dsb=1.2701, bio=0.0021
    Epoch  8/10: total=2.3814, vae=1.0873, dsb=1.2931, bio=0.0019
    Epoch  9/10: total=2.3558, vae=1.0882, dsb=1.2667, bio=0.0018
    Epoch 10/10: total=2.3079, vae=1.0879, dsb=1.2192, bio=0.0017

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=41.2968, vae=1.0908, dsb=40.2044, bio=0.0031
    Epoch  2/10: total=35.0550, vae=1.0891, dsb=33.9652, bio=0.0014
    Epoch  3/10: total=33.4880, vae=1.0889, dsb=32.3982, bio=0.0019
    Epoch  4/10: total=32.6823, vae=1.0889, dsb=31.5927, bio=0.0016
    Epoch  5/10: total=31.9959, vae=1.0884, dsb=30.9068, bio=0.0015
    Epoch  6/10: total=31.7773, vae=1.0885, dsb=30.6880, bio=0.0015
    Epoch  7/10: total=31.4668, vae=1.0882, dsb=30.3778, bio=0.0015
    Epoch  8/10: total=31.3021, vae=1.0886, dsb=30.2127, bio=0.0016
    Epoch  9/10: total=31.1027, vae=1.0883, dsb=30.0138, bio=0.0013
    Epoch 10/10: total=30.9066, vae=1.0884, dsb=29.8172, bio=0.0019

  [Backward Policy Training]
    Epoch  1/10: total=2.0814, vae=1.0887, dsb=0.9883, bio=0.0087
    Epoch  2/10: total=1.9628, vae=1.0874, dsb=0.8746, bio=0.0017
    Epoch  3/10: total=1.9331, vae=1.0881, dsb=0.8443, bio=0.0015
    Epoch  4/10: total=1.9059, vae=1.0869, dsb=0.8183, bio=0.0014
    Epoch  5/10: total=1.8900, vae=1.0869, dsb=0.8025, bio=0.0014
    Epoch  6/10: total=1.8613, vae=1.0868, dsb=0.7738, bio=0.0013
    Epoch  7/10: total=1.8959, vae=1.0875, dsb=0.8077, bio=0.0013
    Epoch  8/10: total=1.8378, vae=1.0874, dsb=0.7498, bio=0.0012
    Epoch  9/10: total=1.8493, vae=1.0864, dsb=0.7623, bio=0.0013
    Epoch 10/10: total=1.8454, vae=1.0867, dsb=0.7581, bio=0.0012

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=31.6749, vae=1.0894, dsb=30.5842, bio=0.0025
    Epoch  2/10: total=29.1842, vae=1.0875, dsb=28.0961, bio=0.0012
    Epoch  3/10: total=28.5010, vae=1.0889, dsb=27.4115, bio=0.0013
    Epoch  4/10: total=28.1531, vae=1.0870, dsb=27.0655, bio=0.0012
    Epoch  5/10: total=27.8126, vae=1.0872, dsb=26.7248, bio=0.0013
    Epoch  6/10: total=27.6874, vae=1.0869, dsb=26.5999, bio=0.0012
    Epoch  7/10: total=27.4868, vae=1.0874, dsb=26.3988, bio=0.0012
    Epoch  8/10: total=27.4713, vae=1.0880, dsb=26.3827, bio=0.0012
    Epoch  9/10: total=27.3055, vae=1.0864, dsb=26.2185, bio=0.0012
    Epoch 10/10: total=27.2282, vae=1.0870, dsb=26.1408, bio=0.0010

  [Backward Policy Training]
    Epoch  1/10: total=1.7646, vae=1.0882, dsb=0.6591, bio=0.0346
    Epoch  2/10: total=1.6625, vae=1.0865, dsb=0.5752, bio=0.0015
    Epoch  3/10: total=1.6545, vae=1.0857, dsb=0.5682, bio=0.0012
    Epoch  4/10: total=1.6380, vae=1.0857, dsb=0.5517, bio=0.0011
    Epoch  5/10: total=1.6359, vae=1.0857, dsb=0.5497, bio=0.0011
    Epoch  6/10: total=1.6540, vae=1.0862, dsb=0.5672, bio=0.0010
    Epoch  7/10: total=1.6314, vae=1.0866, dsb=0.5442, bio=0.0011
    Epoch  8/10: total=1.6236, vae=1.0865, dsb=0.5366, bio=0.0010
    Epoch  9/10: total=1.6395, vae=1.0862, dsb=0.5528, bio=0.0010
    Epoch 10/10: total=1.6290, vae=1.0862, dsb=0.5423, bio=0.0010

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=24.2616, vae=1.0888, dsb=23.1716, bio=0.0022
    Epoch  2/10: total=23.2281, vae=1.0870, dsb=22.1408, bio=0.0007
    Epoch  3/10: total=22.9501, vae=1.0868, dsb=21.8628, bio=0.0009
    Epoch  4/10: total=22.8049, vae=1.0868, dsb=21.7175, bio=0.0011
    Epoch  5/10: total=22.7725, vae=1.0866, dsb=21.6854, bio=0.0010
    Epoch  6/10: total=22.6302, vae=1.0867, dsb=21.5430, bio=0.0010
    Epoch  7/10: total=22.5948, vae=1.0865, dsb=21.5079, bio=0.0008
    Epoch  8/10: total=22.5948, vae=1.0861, dsb=21.5084, bio=0.0005
    Epoch  9/10: total=22.4600, vae=1.0857, dsb=21.3739, bio=0.0009
    Epoch 10/10: total=22.4065, vae=1.0864, dsb=21.3195, bio=0.0011

  [Backward Policy Training]
    Epoch  1/10: total=1.6163, vae=1.0875, dsb=0.4622, bio=0.1333
    Epoch  2/10: total=1.5219, vae=1.0866, dsb=0.4346, bio=0.0012
    Epoch  3/10: total=1.5258, vae=1.0865, dsb=0.4387, bio=0.0011
    Epoch  4/10: total=1.5124, vae=1.0862, dsb=0.4259, bio=0.0007
    Epoch  5/10: total=1.5027, vae=1.0858, dsb=0.4162, bio=0.0014
    Epoch  6/10: total=1.4957, vae=1.0866, dsb=0.4086, bio=0.0010
    Epoch  7/10: total=1.5008, vae=1.0853, dsb=0.4151, bio=0.0008
    Epoch  8/10: total=1.4870, vae=1.0860, dsb=0.4005, bio=0.0010
    Epoch  9/10: total=1.5160, vae=1.0858, dsb=0.4297, bio=0.0010
    Epoch 10/10: total=1.4935, vae=1.0854, dsb=0.4076, bio=0.0010

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=20.9407, vae=1.0885, dsb=19.8512, bio=0.0019
    Epoch  2/10: total=20.4651, vae=1.0869, dsb=19.3779, bio=0.0005
    Epoch  3/10: total=20.3680, vae=1.0868, dsb=19.2809, bio=0.0005
    Epoch  4/10: total=20.3372, vae=1.0862, dsb=19.2507, bio=0.0006
    Epoch  5/10: total=20.3619, vae=1.0861, dsb=19.2754, bio=0.0007
    Epoch  6/10: total=20.3149, vae=1.0864, dsb=19.2280, bio=0.0011
    Epoch  7/10: total=20.2777, vae=1.0861, dsb=19.1911, bio=0.0010
    Epoch  8/10: total=20.2234, vae=1.0866, dsb=19.1365, bio=0.0005
    Epoch  9/10: total=20.2476, vae=1.0860, dsb=19.1614, bio=0.0004
    Epoch 10/10: total=20.2334, vae=1.0857, dsb=19.1472, bio=0.0011

  [Backward Policy Training]
    Epoch  1/10: total=1.5515, vae=1.0868, dsb=0.3601, bio=0.2091
    Epoch  2/10: total=1.4337, vae=1.0852, dsb=0.3481, bio=0.0009
    Epoch  3/10: total=1.4371, vae=1.0849, dsb=0.3518, bio=0.0010
    Epoch  4/10: total=1.4394, vae=1.0860, dsb=0.3528, bio=0.0010
    Epoch  5/10: total=1.4218, vae=1.0845, dsb=0.3368, bio=0.0010
    Epoch  6/10: total=1.4241, vae=1.0853, dsb=0.3385, bio=0.0005
    Epoch  7/10: total=1.4294, vae=1.0854, dsb=0.3435, bio=0.0009
    Epoch  8/10: total=1.4199, vae=1.0855, dsb=0.3339, bio=0.0010
    Epoch  9/10: total=1.4245, vae=1.0853, dsb=0.3388, bio=0.0008
    Epoch 10/10: total=1.4325, vae=1.0848, dsb=0.3474, bio=0.0006

[Seed 30] Joint training (original) complete; models and history saved.

[Seed 30] Starting joint training (ablation)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=230.1287, vae=2.0220, dsb=228.1067, bio=0.0000
    Epoch  2/10: total=70.0663, vae=1.0826, dsb=68.9837, bio=0.0000
    Epoch  3/10: total=60.0066, vae=1.0811, dsb=58.9255, bio=0.0000
    Epoch  4/10: total=54.9928, vae=1.0798, dsb=53.9130, bio=0.0000
    Epoch  5/10: total=52.1637, vae=1.0796, dsb=51.0841, bio=0.0000
    Epoch  6/10: total=50.0498, vae=1.0783, dsb=48.9715, bio=0.0000
    Epoch  7/10: total=48.5897, vae=1.0786, dsb=47.5111, bio=0.0000
    Epoch  8/10: total=47.4700, vae=1.0789, dsb=46.3911, bio=0.0000
    Epoch  9/10: total=46.8385, vae=1.0791, dsb=45.7594, bio=0.0000
    Epoch 10/10: total=46.0842, vae=1.0782, dsb=45.0060, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=3.0452, vae=1.0790, dsb=1.9662, bio=0.0000
    Epoch  2/10: total=2.6196, vae=1.0786, dsb=1.5409, bio=0.0000
    Epoch  3/10: total=2.4908, vae=1.0796, dsb=1.4112, bio=0.0000
    Epoch  4/10: total=2.4183, vae=1.0789, dsb=1.3394, bio=0.0000
    Epoch  5/10: total=2.3851, vae=1.0786, dsb=1.3065, bio=0.0000
    Epoch  6/10: total=2.3466, vae=1.0790, dsb=1.2677, bio=0.0000
    Epoch  7/10: total=2.3157, vae=1.0795, dsb=1.2362, bio=0.0000
    Epoch  8/10: total=2.3363, vae=1.0779, dsb=1.2584, bio=0.0000
    Epoch  9/10: total=2.3118, vae=1.0789, dsb=1.2330, bio=0.0000
    Epoch 10/10: total=2.2643, vae=1.0786, dsb=1.1857, bio=0.0000

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=41.7954, vae=1.0788, dsb=40.7166, bio=0.0000
    Epoch  2/10: total=35.6350, vae=1.0784, dsb=34.5566, bio=0.0000
    Epoch  3/10: total=34.0924, vae=1.0786, dsb=33.0138, bio=0.0000
    Epoch  4/10: total=33.3179, vae=1.0787, dsb=32.2393, bio=0.0000
    Epoch  5/10: total=32.6153, vae=1.0783, dsb=31.5370, bio=0.0000
    Epoch  6/10: total=32.4315, vae=1.0786, dsb=31.3530, bio=0.0000
    Epoch  7/10: total=32.1293, vae=1.0785, dsb=31.0508, bio=0.0000
    Epoch  8/10: total=31.9794, vae=1.0789, dsb=30.9005, bio=0.0000
    Epoch  9/10: total=31.7924, vae=1.0787, dsb=30.7137, bio=0.0000
    Epoch 10/10: total=31.5868, vae=1.0790, dsb=30.5078, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=2.0257, vae=1.0788, dsb=0.9469, bio=0.0000
    Epoch  2/10: total=1.9219, vae=1.0786, dsb=0.8433, bio=0.0000
    Epoch  3/10: total=1.8952, vae=1.0795, dsb=0.8158, bio=0.0000
    Epoch  4/10: total=1.8691, vae=1.0783, dsb=0.7908, bio=0.0000
    Epoch  5/10: total=1.8545, vae=1.0784, dsb=0.7761, bio=0.0000
    Epoch  6/10: total=1.8268, vae=1.0784, dsb=0.7484, bio=0.0000
    Epoch  7/10: total=1.8613, vae=1.0790, dsb=0.7822, bio=0.0000
    Epoch  8/10: total=1.8053, vae=1.0790, dsb=0.7262, bio=0.0000
    Epoch  9/10: total=1.8181, vae=1.0782, dsb=0.7399, bio=0.0000
    Epoch 10/10: total=1.8130, vae=1.0784, dsb=0.7346, bio=0.0000

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=30.8846, vae=1.0787, dsb=29.8059, bio=0.0000
    Epoch  2/10: total=28.6592, vae=1.0781, dsb=27.5811, bio=0.0000
    Epoch  3/10: total=28.0387, vae=1.0797, dsb=26.9590, bio=0.0000
    Epoch  4/10: total=27.7535, vae=1.0779, dsb=26.6756, bio=0.0000
    Epoch  5/10: total=27.4582, vae=1.0782, dsb=26.3800, bio=0.0000
    Epoch  6/10: total=27.3688, vae=1.0781, dsb=26.2906, bio=0.0000
    Epoch  7/10: total=27.2011, vae=1.0786, dsb=26.1226, bio=0.0000
    Epoch  8/10: total=27.1799, vae=1.0793, dsb=26.1006, bio=0.0000
    Epoch  9/10: total=27.0283, vae=1.0778, dsb=25.9505, bio=0.0000
    Epoch 10/10: total=26.9502, vae=1.0785, dsb=25.8717, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.7026, vae=1.0789, dsb=0.6238, bio=0.0000
    Epoch  2/10: total=1.6232, vae=1.0783, dsb=0.5449, bio=0.0000
    Epoch  3/10: total=1.6163, vae=1.0778, dsb=0.5386, bio=0.0000
    Epoch  4/10: total=1.6008, vae=1.0777, dsb=0.5231, bio=0.0000
    Epoch  5/10: total=1.5995, vae=1.0777, dsb=0.5218, bio=0.0000
    Epoch  6/10: total=1.6175, vae=1.0782, dsb=0.5393, bio=0.0000
    Epoch  7/10: total=1.5968, vae=1.0787, dsb=0.5181, bio=0.0000
    Epoch  8/10: total=1.5900, vae=1.0787, dsb=0.5114, bio=0.0000
    Epoch  9/10: total=1.6058, vae=1.0783, dsb=0.5275, bio=0.0000
    Epoch 10/10: total=1.5967, vae=1.0784, dsb=0.5183, bio=0.0000

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=23.9739, vae=1.0786, dsb=22.8953, bio=0.0000
    Epoch  2/10: total=23.0568, vae=1.0781, dsb=21.9787, bio=0.0000
    Epoch  3/10: total=22.8106, vae=1.0784, dsb=21.7323, bio=0.0000
    Epoch  4/10: total=22.6936, vae=1.0786, dsb=21.6150, bio=0.0000
    Epoch  5/10: total=22.6594, vae=1.0784, dsb=21.5810, bio=0.0000
    Epoch  6/10: total=22.5305, vae=1.0786, dsb=21.4519, bio=0.0000
    Epoch  7/10: total=22.5040, vae=1.0785, dsb=21.4255, bio=0.0000
    Epoch  8/10: total=22.4926, vae=1.0782, dsb=21.4144, bio=0.0000
    Epoch  9/10: total=22.3674, vae=1.0779, dsb=21.2895, bio=0.0000
    Epoch 10/10: total=22.3384, vae=1.0787, dsb=21.2597, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.5277, vae=1.0785, dsb=0.4492, bio=0.0000
    Epoch  2/10: total=1.5024, vae=1.0788, dsb=0.4235, bio=0.0000
    Epoch  3/10: total=1.5069, vae=1.0788, dsb=0.4281, bio=0.0000
    Epoch  4/10: total=1.4942, vae=1.0785, dsb=0.4157, bio=0.0000
    Epoch  5/10: total=1.4847, vae=1.0783, dsb=0.4064, bio=0.0000
    Epoch  6/10: total=1.4781, vae=1.0792, dsb=0.3989, bio=0.0000
    Epoch  7/10: total=1.4835, vae=1.0778, dsb=0.4058, bio=0.0000
    Epoch  8/10: total=1.4697, vae=1.0786, dsb=0.3910, bio=0.0000
    Epoch  9/10: total=1.4985, vae=1.0785, dsb=0.4200, bio=0.0000
    Epoch 10/10: total=1.4766, vae=1.0782, dsb=0.3983, bio=0.0000

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=20.6068, vae=1.0785, dsb=19.5284, bio=0.0000
    Epoch  2/10: total=20.1469, vae=1.0785, dsb=19.0684, bio=0.0000
    Epoch  3/10: total=20.0536, vae=1.0789, dsb=18.9747, bio=0.0000
    Epoch  4/10: total=20.0304, vae=1.0785, dsb=18.9519, bio=0.0000
    Epoch  5/10: total=20.0584, vae=1.0784, dsb=18.9800, bio=0.0000
    Epoch  6/10: total=19.9965, vae=1.0788, dsb=18.9176, bio=0.0000
    Epoch  7/10: total=19.9615, vae=1.0786, dsb=18.8829, bio=0.0000
    Epoch  8/10: total=19.9097, vae=1.0791, dsb=18.8306, bio=0.0000
    Epoch  9/10: total=19.9264, vae=1.0786, dsb=18.8478, bio=0.0000
    Epoch 10/10: total=19.9283, vae=1.0784, dsb=18.8499, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.4252, vae=1.0778, dsb=0.3474, bio=0.0000
    Epoch  2/10: total=1.4130, vae=1.0775, dsb=0.3355, bio=0.0000
    Epoch  3/10: total=1.4161, vae=1.0775, dsb=0.3386, bio=0.0000
    Epoch  4/10: total=1.4182, vae=1.0787, dsb=0.3395, bio=0.0000
    Epoch  5/10: total=1.4010, vae=1.0773, dsb=0.3237, bio=0.0000
    Epoch  6/10: total=1.4036, vae=1.0781, dsb=0.3255, bio=0.0000
    Epoch  7/10: total=1.4086, vae=1.0784, dsb=0.3302, bio=0.0000
    Epoch  8/10: total=1.3994, vae=1.0786, dsb=0.3208, bio=0.0000
    Epoch  9/10: total=1.4042, vae=1.0784, dsb=0.3257, bio=0.0000
    Epoch 10/10: total=1.4121, vae=1.0781, dsb=0.3340, bio=0.0000

[Seed 30] Joint training (ablation) complete; models and history saved.

[Seed 30] Drift genes saved in /home/yyuan/ICB_TCE/iter_results/run_030

[Seed 30] run finished.

================================================================================
[Seed 31] Starting running whole pipeline...
================================================================================

[Seed 31] Starting VAE pre-training...

    Epoch [01/20], Beta: 0.000, Average Loss: 535.9674
    Epoch [02/20], Beta: 0.000, Average Loss: 310.6306
    Epoch [03/20], Beta: 0.000, Average Loss: 273.7161
    Epoch [04/20], Beta: 0.000, Average Loss: 252.6695
    Epoch [05/20], Beta: 0.100, Average Loss: 246.1606
    Epoch [06/20], Beta: 0.200, Average Loss: 244.9702
    Epoch [07/20], Beta: 0.300, Average Loss: 245.1289
    Epoch [08/20], Beta: 0.400, Average Loss: 245.8501
    Epoch [09/20], Beta: 0.500, Average Loss: 246.8534
    Epoch [10/20], Beta: 0.600, Average Loss: 247.9779
    Epoch [11/20], Beta: 0.700, Average Loss: 249.1116
    Epoch [12/20], Beta: 0.800, Average Loss: 250.3746
    Epoch [13/20], Beta: 0.900, Average Loss: 251.6136
    Epoch [14/20], Beta: 1.000, Average Loss: 253.2241
    Epoch [15/20], Beta: 1.000, Average Loss: 252.7987
    Epoch [16/20], Beta: 1.000, Average Loss: 252.4660
    Epoch [17/20], Beta: 1.000, Average Loss: 252.0741
    Epoch [18/20], Beta: 1.000, Average Loss: 251.7342
    Epoch [19/20], Beta: 1.000, Average Loss: 251.4339
    Epoch [20/20], Beta: 1.000, Average Loss: 251.2291

[Seed 31] VAE pre-training complete.

[Seed 31] Starting joint training (original)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=282.6160, vae=3.8374, dsb=260.1303, bio=37.2968
    Epoch  2/10: total=82.2260, vae=1.1014, dsb=81.0786, bio=0.0919
    Epoch  3/10: total=72.0095, vae=1.0942, dsb=70.8958, bio=0.0390
    Epoch  4/10: total=67.8200, vae=1.0914, dsb=66.7179, bio=0.0213
    Epoch  5/10: total=65.1647, vae=1.0903, dsb=64.0673, bio=0.0143
    Epoch  6/10: total=63.4493, vae=1.0892, dsb=62.3551, bio=0.0101
    Epoch  7/10: total=62.2472, vae=1.0891, dsb=61.1542, bio=0.0079
    Epoch  8/10: total=61.1951, vae=1.0886, dsb=60.1032, bio=0.0064
    Epoch  9/10: total=60.5752, vae=1.0883, dsb=59.4842, bio=0.0054
    Epoch 10/10: total=59.7513, vae=1.0887, dsb=58.6598, bio=0.0055

  [Backward Policy Training]
    Epoch  1/10: total=3.2129, vae=1.0890, dsb=2.1163, bio=0.0152
    Epoch  2/10: total=2.7294, vae=1.0880, dsb=1.6387, bio=0.0055
    Epoch  3/10: total=2.6052, vae=1.0867, dsb=1.5166, bio=0.0039
    Epoch  4/10: total=2.5393, vae=1.0869, dsb=1.4508, bio=0.0033
    Epoch  5/10: total=2.5126, vae=1.0868, dsb=1.4244, bio=0.0029
    Epoch  6/10: total=2.4566, vae=1.0863, dsb=1.3690, bio=0.0026
    Epoch  7/10: total=2.4045, vae=1.0864, dsb=1.3169, bio=0.0024
    Epoch  8/10: total=2.3970, vae=1.0864, dsb=1.3095, bio=0.0023
    Epoch  9/10: total=2.4008, vae=1.0860, dsb=1.3137, bio=0.0022
    Epoch 10/10: total=2.3759, vae=1.0849, dsb=1.2900, bio=0.0021

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=50.3272, vae=1.0885, dsb=49.2365, bio=0.0045
    Epoch  2/10: total=44.8550, vae=1.0870, dsb=43.7670, bio=0.0021
    Epoch  3/10: total=43.5608, vae=1.0869, dsb=42.4728, bio=0.0021
    Epoch  4/10: total=42.9588, vae=1.0875, dsb=41.8703, bio=0.0021
    Epoch  5/10: total=42.3293, vae=1.0871, dsb=41.2413, bio=0.0019
    Epoch  6/10: total=42.0674, vae=1.0865, dsb=40.9798, bio=0.0021
    Epoch  7/10: total=41.6679, vae=1.0853, dsb=40.5816, bio=0.0021
    Epoch  8/10: total=41.3679, vae=1.0855, dsb=40.2814, bio=0.0020
    Epoch  9/10: total=41.2945, vae=1.0864, dsb=40.2070, bio=0.0020
    Epoch 10/10: total=41.2396, vae=1.0858, dsb=40.1528, bio=0.0020

  [Backward Policy Training]
    Epoch  1/10: total=2.0350, vae=1.0875, dsb=0.9447, bio=0.0056
    Epoch  2/10: total=1.9287, vae=1.0853, dsb=0.8424, bio=0.0021
    Epoch  3/10: total=1.9131, vae=1.0851, dsb=0.8271, bio=0.0019
    Epoch  4/10: total=1.8793, vae=1.0855, dsb=0.7930, bio=0.0018
    Epoch  5/10: total=1.8679, vae=1.0848, dsb=0.7821, bio=0.0020
    Epoch  6/10: total=1.8837, vae=1.0859, dsb=0.7969, bio=0.0018
    Epoch  7/10: total=1.8482, vae=1.0852, dsb=0.7621, bio=0.0018
    Epoch  8/10: total=1.8303, vae=1.0854, dsb=0.7440, bio=0.0017
    Epoch  9/10: total=1.8273, vae=1.0841, dsb=0.7424, bio=0.0017
    Epoch 10/10: total=1.8100, vae=1.0842, dsb=0.7249, bio=0.0017

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=39.6094, vae=1.0878, dsb=38.5198, bio=0.0035
    Epoch  2/10: total=37.2532, vae=1.0862, dsb=36.1661, bio=0.0018
    Epoch  3/10: total=36.8212, vae=1.0859, dsb=35.7344, bio=0.0018
    Epoch  4/10: total=36.7317, vae=1.0859, dsb=35.6449, bio=0.0018
    Epoch  5/10: total=36.5291, vae=1.0860, dsb=35.4422, bio=0.0018
    Epoch  6/10: total=36.2817, vae=1.0856, dsb=35.1954, bio=0.0015
    Epoch  7/10: total=36.3330, vae=1.0857, dsb=35.2447, bio=0.0053
    Epoch  8/10: total=35.9568, vae=1.0849, dsb=34.8709, bio=0.0019
    Epoch  9/10: total=36.0275, vae=1.0847, dsb=34.9418, bio=0.0018
    Epoch 10/10: total=36.0531, vae=1.0854, dsb=34.9668, bio=0.0018

  [Backward Policy Training]
    Epoch  1/10: total=1.7627, vae=1.0859, dsb=0.6688, bio=0.0161
    Epoch  2/10: total=1.6920, vae=1.0849, dsb=0.6064, bio=0.0016
    Epoch  3/10: total=1.6758, vae=1.0847, dsb=0.5903, bio=0.0016
    Epoch  4/10: total=1.6461, vae=1.0841, dsb=0.5612, bio=0.0016
    Epoch  5/10: total=1.6595, vae=1.0844, dsb=0.5743, bio=0.0016
    Epoch  6/10: total=1.6342, vae=1.0837, dsb=0.5497, bio=0.0015
    Epoch  7/10: total=1.6639, vae=1.0850, dsb=0.5782, bio=0.0016
    Epoch  8/10: total=1.6445, vae=1.0842, dsb=0.5595, bio=0.0015
    Epoch  9/10: total=1.6445, vae=1.0850, dsb=0.5588, bio=0.0015
    Epoch 10/10: total=1.6450, vae=1.0840, dsb=0.5604, bio=0.0015

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=31.6298, vae=1.0866, dsb=30.5415, bio=0.0032
    Epoch  2/10: total=30.7880, vae=1.0854, dsb=29.7017, bio=0.0017
    Epoch  3/10: total=30.5159, vae=1.0842, dsb=29.4310, bio=0.0015
    Epoch  4/10: total=30.5483, vae=1.0849, dsb=29.4625, bio=0.0019
    Epoch  5/10: total=30.4899, vae=1.0851, dsb=29.4039, bio=0.0017
    Epoch  6/10: total=30.3161, vae=1.0845, dsb=29.2307, bio=0.0016
    Epoch  7/10: total=30.2976, vae=1.0849, dsb=29.2118, bio=0.0016
    Epoch  8/10: total=30.2866, vae=1.0845, dsb=29.2013, bio=0.0016
    Epoch  9/10: total=30.2597, vae=1.0842, dsb=29.1747, bio=0.0016
    Epoch 10/10: total=30.2371, vae=1.0849, dsb=29.1515, bio=0.0015

  [Backward Policy Training]
    Epoch  1/10: total=1.5960, vae=1.0848, dsb=0.4853, bio=0.0519
    Epoch  2/10: total=1.5532, vae=1.0837, dsb=0.4687, bio=0.0016
    Epoch  3/10: total=1.5518, vae=1.0841, dsb=0.4670, bio=0.0014
    Epoch  4/10: total=1.5229, vae=1.0837, dsb=0.4385, bio=0.0014
    Epoch  5/10: total=1.5353, vae=1.0840, dsb=0.4507, bio=0.0012
    Epoch  6/10: total=1.5273, vae=1.0838, dsb=0.4428, bio=0.0014
    Epoch  7/10: total=1.5390, vae=1.0844, dsb=0.4539, bio=0.0013
    Epoch  8/10: total=1.5311, vae=1.0847, dsb=0.4458, bio=0.0013
    Epoch  9/10: total=1.5326, vae=1.0832, dsb=0.4487, bio=0.0013
    Epoch 10/10: total=1.5290, vae=1.0843, dsb=0.4441, bio=0.0014

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=26.4305, vae=1.0868, dsb=25.3423, bio=0.0028
    Epoch  2/10: total=26.0250, vae=1.0853, dsb=24.9390, bio=0.0014
    Epoch  3/10: total=25.9597, vae=1.0855, dsb=24.8735, bio=0.0014
    Epoch  4/10: total=25.8963, vae=1.0843, dsb=24.8113, bio=0.0015
    Epoch  5/10: total=25.7689, vae=1.0841, dsb=24.6840, bio=0.0015
    Epoch  6/10: total=25.8783, vae=1.0846, dsb=24.7931, bio=0.0014
    Epoch  7/10: total=25.7653, vae=1.0843, dsb=24.6803, bio=0.0014
    Epoch  8/10: total=25.8777, vae=1.0840, dsb=24.7928, bio=0.0017
    Epoch  9/10: total=25.6628, vae=1.0847, dsb=24.5774, bio=0.0013
    Epoch 10/10: total=25.7659, vae=1.0836, dsb=24.6817, bio=0.0013

  [Backward Policy Training]
    Epoch  1/10: total=1.5438, vae=1.0856, dsb=0.4033, bio=0.1099
    Epoch  2/10: total=1.4834, vae=1.0833, dsb=0.3994, bio=0.0014
    Epoch  3/10: total=1.4813, vae=1.0825, dsb=0.3981, bio=0.0012
    Epoch  4/10: total=1.4864, vae=1.0834, dsb=0.4024, bio=0.0012
    Epoch  5/10: total=1.4660, vae=1.0839, dsb=0.3816, bio=0.0010
    Epoch  6/10: total=1.4739, vae=1.0832, dsb=0.3901, bio=0.0013
    Epoch  7/10: total=1.4646, vae=1.0843, dsb=0.3797, bio=0.0011
    Epoch  8/10: total=1.4765, vae=1.0834, dsb=0.3926, bio=0.0011
    Epoch  9/10: total=1.4689, vae=1.0834, dsb=0.3850, bio=0.0011
    Epoch 10/10: total=1.4807, vae=1.0838, dsb=0.3963, bio=0.0011

[Seed 31] Joint training (original) complete; models and history saved.

[Seed 31] Starting joint training (ablation)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=261.8084, vae=2.0417, dsb=259.7667, bio=0.0000
    Epoch  2/10: total=81.7784, vae=1.0807, dsb=80.6977, bio=0.0000
    Epoch  3/10: total=71.7037, vae=1.0783, dsb=70.6254, bio=0.0000
    Epoch  4/10: total=67.5611, vae=1.0775, dsb=66.4836, bio=0.0000
    Epoch  5/10: total=64.8596, vae=1.0772, dsb=63.7825, bio=0.0000
    Epoch  6/10: total=63.1500, vae=1.0765, dsb=62.0734, bio=0.0000
    Epoch  7/10: total=61.9117, vae=1.0767, dsb=60.8350, bio=0.0000
    Epoch  8/10: total=60.8088, vae=1.0766, dsb=59.7322, bio=0.0000
    Epoch  9/10: total=60.1698, vae=1.0765, dsb=59.0933, bio=0.0000
    Epoch 10/10: total=59.4039, vae=1.0769, dsb=58.3270, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=3.0720, vae=1.0765, dsb=1.9955, bio=0.0000
    Epoch  2/10: total=2.6096, vae=1.0771, dsb=1.5325, bio=0.0000
    Epoch  3/10: total=2.4936, vae=1.0762, dsb=1.4174, bio=0.0000
    Epoch  4/10: total=2.4337, vae=1.0767, dsb=1.3570, bio=0.0000
    Epoch  5/10: total=2.4103, vae=1.0767, dsb=1.3336, bio=0.0000
    Epoch  6/10: total=2.3573, vae=1.0764, dsb=1.2809, bio=0.0000
    Epoch  7/10: total=2.3093, vae=1.0767, dsb=1.2327, bio=0.0000
    Epoch  8/10: total=2.3044, vae=1.0768, dsb=1.2276, bio=0.0000
    Epoch  9/10: total=2.3094, vae=1.0765, dsb=1.2330, bio=0.0000
    Epoch 10/10: total=2.2871, vae=1.0754, dsb=1.2116, bio=0.0000

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=49.9557, vae=1.0755, dsb=48.8802, bio=0.0000
    Epoch  2/10: total=44.6335, vae=1.0760, dsb=43.5574, bio=0.0000
    Epoch  3/10: total=43.4191, vae=1.0761, dsb=42.3430, bio=0.0000
    Epoch  4/10: total=42.8433, vae=1.0768, dsb=41.7665, bio=0.0000
    Epoch  5/10: total=42.2455, vae=1.0765, dsb=41.1690, bio=0.0000
    Epoch  6/10: total=42.0108, vae=1.0762, dsb=40.9346, bio=0.0000
    Epoch  7/10: total=41.6648, vae=1.0750, dsb=40.5898, bio=0.0000
    Epoch  8/10: total=41.3630, vae=1.0753, dsb=40.2877, bio=0.0000
    Epoch  9/10: total=41.3356, vae=1.0763, dsb=40.2593, bio=0.0000
    Epoch 10/10: total=41.2900, vae=1.0758, dsb=40.2143, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.9732, vae=1.0766, dsb=0.8966, bio=0.0000
    Epoch  2/10: total=1.8772, vae=1.0761, dsb=0.8011, bio=0.0000
    Epoch  3/10: total=1.8649, vae=1.0761, dsb=0.7888, bio=0.0000
    Epoch  4/10: total=1.8346, vae=1.0766, dsb=0.7581, bio=0.0000
    Epoch  5/10: total=1.8250, vae=1.0759, dsb=0.7491, bio=0.0000
    Epoch  6/10: total=1.8414, vae=1.0772, dsb=0.7643, bio=0.0000
    Epoch  7/10: total=1.8083, vae=1.0764, dsb=0.7319, bio=0.0000
    Epoch  8/10: total=1.7915, vae=1.0767, dsb=0.7147, bio=0.0000
    Epoch  9/10: total=1.7887, vae=1.0754, dsb=0.7132, bio=0.0000
    Epoch 10/10: total=1.7728, vae=1.0756, dsb=0.6972, bio=0.0000

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=39.5619, vae=1.0766, dsb=38.4854, bio=0.0000
    Epoch  2/10: total=37.3851, vae=1.0761, dsb=36.3090, bio=0.0000
    Epoch  3/10: total=36.9718, vae=1.0760, dsb=35.8957, bio=0.0000
    Epoch  4/10: total=36.8872, vae=1.0762, dsb=35.8111, bio=0.0000
    Epoch  5/10: total=36.7123, vae=1.0763, dsb=35.6360, bio=0.0000
    Epoch  6/10: total=36.4611, vae=1.0760, dsb=35.3852, bio=0.0000
    Epoch  7/10: total=36.5073, vae=1.0762, dsb=35.4311, bio=0.0000
    Epoch  8/10: total=36.1310, vae=1.0755, dsb=35.0555, bio=0.0000
    Epoch  9/10: total=36.1855, vae=1.0754, dsb=35.1102, bio=0.0000
    Epoch 10/10: total=36.2318, vae=1.0761, dsb=35.1557, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.7132, vae=1.0763, dsb=0.6369, bio=0.0000
    Epoch  2/10: total=1.6553, vae=1.0763, dsb=0.5790, bio=0.0000
    Epoch  3/10: total=1.6415, vae=1.0763, dsb=0.5652, bio=0.0000
    Epoch  4/10: total=1.6137, vae=1.0758, dsb=0.5378, bio=0.0000
    Epoch  5/10: total=1.6271, vae=1.0761, dsb=0.5510, bio=0.0000
    Epoch  6/10: total=1.6035, vae=1.0755, dsb=0.5280, bio=0.0000
    Epoch  7/10: total=1.6325, vae=1.0767, dsb=0.5558, bio=0.0000
    Epoch  8/10: total=1.6145, vae=1.0761, dsb=0.5383, bio=0.0000
    Epoch  9/10: total=1.6150, vae=1.0768, dsb=0.5382, bio=0.0000
    Epoch 10/10: total=1.6156, vae=1.0758, dsb=0.5398, bio=0.0000

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=31.8469, vae=1.0755, dsb=30.7714, bio=0.0000
    Epoch  2/10: total=31.0354, vae=1.0759, dsb=29.9595, bio=0.0000
    Epoch  3/10: total=30.8111, vae=1.0748, dsb=29.7362, bio=0.0000
    Epoch  4/10: total=30.8285, vae=1.0759, dsb=29.7526, bio=0.0000
    Epoch  5/10: total=30.7739, vae=1.0762, dsb=29.6977, bio=0.0000
    Epoch  6/10: total=30.6236, vae=1.0757, dsb=29.5480, bio=0.0000
    Epoch  7/10: total=30.5757, vae=1.0761, dsb=29.4996, bio=0.0000
    Epoch  8/10: total=30.6280, vae=1.0758, dsb=29.5522, bio=0.0000
    Epoch  9/10: total=30.5885, vae=1.0755, dsb=29.5130, bio=0.0000
    Epoch 10/10: total=30.5676, vae=1.0763, dsb=29.4913, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.5319, vae=1.0754, dsb=0.4565, bio=0.0000
    Epoch  2/10: total=1.5161, vae=1.0755, dsb=0.4406, bio=0.0000
    Epoch  3/10: total=1.5149, vae=1.0760, dsb=0.4388, bio=0.0000
    Epoch  4/10: total=1.4876, vae=1.0756, dsb=0.4119, bio=0.0000
    Epoch  5/10: total=1.4998, vae=1.0761, dsb=0.4237, bio=0.0000
    Epoch  6/10: total=1.4921, vae=1.0759, dsb=0.4162, bio=0.0000
    Epoch  7/10: total=1.5029, vae=1.0765, dsb=0.4264, bio=0.0000
    Epoch  8/10: total=1.4956, vae=1.0768, dsb=0.4188, bio=0.0000
    Epoch  9/10: total=1.4971, vae=1.0754, dsb=0.4216, bio=0.0000
    Epoch 10/10: total=1.4934, vae=1.0763, dsb=0.4170, bio=0.0000

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=26.2801, vae=1.0763, dsb=25.2038, bio=0.0000
    Epoch  2/10: total=25.8517, vae=1.0760, dsb=24.7756, bio=0.0000
    Epoch  3/10: total=25.8168, vae=1.0764, dsb=24.7403, bio=0.0000
    Epoch  4/10: total=25.7428, vae=1.0755, dsb=24.6673, bio=0.0000
    Epoch  5/10: total=25.6419, vae=1.0756, dsb=24.5663, bio=0.0000
    Epoch  6/10: total=25.7276, vae=1.0761, dsb=24.6515, bio=0.0000
    Epoch  7/10: total=25.6286, vae=1.0759, dsb=24.5527, bio=0.0000
    Epoch  8/10: total=25.7383, vae=1.0757, dsb=24.6626, bio=0.0000
    Epoch  9/10: total=25.5567, vae=1.0765, dsb=24.4801, bio=0.0000
    Epoch 10/10: total=25.6410, vae=1.0754, dsb=24.5656, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.4524, vae=1.0767, dsb=0.3757, bio=0.0000
    Epoch  2/10: total=1.4470, vae=1.0754, dsb=0.3716, bio=0.0000
    Epoch  3/10: total=1.4453, vae=1.0748, dsb=0.3706, bio=0.0000
    Epoch  4/10: total=1.4504, vae=1.0756, dsb=0.3748, bio=0.0000
    Epoch  5/10: total=1.4312, vae=1.0760, dsb=0.3551, bio=0.0000
    Epoch  6/10: total=1.4388, vae=1.0756, dsb=0.3632, bio=0.0000
    Epoch  7/10: total=1.4303, vae=1.0767, dsb=0.3536, bio=0.0000
    Epoch  8/10: total=1.4415, vae=1.0758, dsb=0.3658, bio=0.0000
    Epoch  9/10: total=1.4342, vae=1.0758, dsb=0.3584, bio=0.0000
    Epoch 10/10: total=1.4453, vae=1.0762, dsb=0.3691, bio=0.0000

[Seed 31] Joint training (ablation) complete; models and history saved.

[Seed 31] Drift genes saved in /home/yyuan/ICB_TCE/iter_results/run_031

[Seed 31] run finished.

================================================================================
[Seed 32] Starting running whole pipeline...
================================================================================

[Seed 32] Starting VAE pre-training...

    Epoch [01/20], Beta: 0.000, Average Loss: 537.3809
    Epoch [02/20], Beta: 0.000, Average Loss: 303.1128
    Epoch [03/20], Beta: 0.000, Average Loss: 267.2873
    Epoch [04/20], Beta: 0.000, Average Loss: 249.8997
    Epoch [05/20], Beta: 0.100, Average Loss: 244.7004
    Epoch [06/20], Beta: 0.200, Average Loss: 243.8515
    Epoch [07/20], Beta: 0.300, Average Loss: 244.2707
    Epoch [08/20], Beta: 0.400, Average Loss: 245.3247
    Epoch [09/20], Beta: 0.500, Average Loss: 246.6475
    Epoch [10/20], Beta: 0.600, Average Loss: 247.8876
    Epoch [11/20], Beta: 0.700, Average Loss: 249.1996
    Epoch [12/20], Beta: 0.800, Average Loss: 250.4517
    Epoch [13/20], Beta: 0.900, Average Loss: 251.7447
    Epoch [14/20], Beta: 1.000, Average Loss: 253.3023
    Epoch [15/20], Beta: 1.000, Average Loss: 252.9039
    Epoch [16/20], Beta: 1.000, Average Loss: 252.4573
    Epoch [17/20], Beta: 1.000, Average Loss: 252.1428
    Epoch [18/20], Beta: 1.000, Average Loss: 251.7436
    Epoch [19/20], Beta: 1.000, Average Loss: 251.4377
    Epoch [20/20], Beta: 1.000, Average Loss: 251.2357

[Seed 32] VAE pre-training complete.

[Seed 32] Starting joint training (original)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=285.7322, vae=3.7811, dsb=261.0623, bio=41.7776
    Epoch  2/10: total=86.0231, vae=1.0952, dsb=84.8866, bio=0.0827
    Epoch  3/10: total=73.6917, vae=1.0898, dsb=72.5852, bio=0.0334
    Epoch  4/10: total=68.1278, vae=1.0891, dsb=67.0291, bio=0.0192
    Epoch  5/10: total=64.5369, vae=1.0871, dsb=63.4433, bio=0.0129
    Epoch  6/10: total=62.6493, vae=1.0873, dsb=61.5574, bio=0.0092
    Epoch  7/10: total=61.1787, vae=1.0866, dsb=60.0884, bio=0.0073
    Epoch  8/10: total=59.7094, vae=1.0856, dsb=58.6208, bio=0.0060
    Epoch  9/10: total=58.7715, vae=1.0859, dsb=57.6830, bio=0.0050
    Epoch 10/10: total=57.8712, vae=1.0856, dsb=56.7834, bio=0.0044

  [Backward Policy Training]
    Epoch  1/10: total=3.2821, vae=1.0875, dsb=2.1881, bio=0.0131
    Epoch  2/10: total=2.7501, vae=1.0843, dsb=1.6636, bio=0.0044
    Epoch  3/10: total=2.6213, vae=1.0844, dsb=1.5354, bio=0.0032
    Epoch  4/10: total=2.5610, vae=1.0836, dsb=1.4761, bio=0.0027
    Epoch  5/10: total=2.5112, vae=1.0838, dsb=1.4263, bio=0.0024
    Epoch  6/10: total=2.4632, vae=1.0841, dsb=1.3780, bio=0.0022
    Epoch  7/10: total=2.4390, vae=1.0837, dsb=1.3545, bio=0.0017
    Epoch  8/10: total=2.4362, vae=1.0830, dsb=1.3521, bio=0.0021
    Epoch  9/10: total=2.4224, vae=1.0828, dsb=1.3387, bio=0.0019
    Epoch 10/10: total=2.3854, vae=1.0829, dsb=1.3016, bio=0.0018

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=50.9555, vae=1.0858, dsb=49.8678, bio=0.0038
    Epoch  2/10: total=44.3444, vae=1.0851, dsb=43.2585, bio=0.0018
    Epoch  3/10: total=42.4730, vae=1.0841, dsb=41.3881, bio=0.0017
    Epoch  4/10: total=41.5220, vae=1.0837, dsb=40.4374, bio=0.0017
    Epoch  5/10: total=41.0066, vae=1.0835, dsb=39.9222, bio=0.0016
    Epoch  6/10: total=40.4505, vae=1.0837, dsb=39.3660, bio=0.0017
    Epoch  7/10: total=40.2327, vae=1.0833, dsb=39.1486, bio=0.0016
    Epoch  8/10: total=39.8113, vae=1.0842, dsb=38.7263, bio=0.0016
    Epoch  9/10: total=39.7463, vae=1.0835, dsb=38.6620, bio=0.0016
    Epoch 10/10: total=39.3910, vae=1.0835, dsb=38.3068, bio=0.0016

  [Backward Policy Training]
    Epoch  1/10: total=2.1644, vae=1.0838, dsb=1.0748, bio=0.0115
    Epoch  2/10: total=2.0303, vae=1.0825, dsb=0.9470, bio=0.0016
    Epoch  3/10: total=1.9706, vae=1.0821, dsb=0.8877, bio=0.0014
    Epoch  4/10: total=1.9805, vae=1.0815, dsb=0.8983, bio=0.0013
    Epoch  5/10: total=1.9433, vae=1.0814, dsb=0.8613, bio=0.0013
    Epoch  6/10: total=1.9117, vae=1.0811, dsb=0.8300, bio=0.0012
    Epoch  7/10: total=1.9053, vae=1.0821, dsb=0.8226, bio=0.0013
    Epoch  8/10: total=1.8969, vae=1.0816, dsb=0.8147, bio=0.0012
    Epoch  9/10: total=1.8906, vae=1.0819, dsb=0.8080, bio=0.0012
    Epoch 10/10: total=1.8701, vae=1.0823, dsb=0.7872, bio=0.0012

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=39.7077, vae=1.0840, dsb=38.6223, bio=0.0028
    Epoch  2/10: total=36.8158, vae=1.0834, dsb=35.7318, bio=0.0013
    Epoch  3/10: total=35.9988, vae=1.0828, dsb=34.9154, bio=0.0013
    Epoch  4/10: total=35.7175, vae=1.0824, dsb=34.6344, bio=0.0013
    Epoch  5/10: total=35.3851, vae=1.0826, dsb=34.3019, bio=0.0012
    Epoch  6/10: total=35.2824, vae=1.0825, dsb=34.1993, bio=0.0013
    Epoch  7/10: total=34.9816, vae=1.0817, dsb=33.8993, bio=0.0012
    Epoch  8/10: total=35.0431, vae=1.0820, dsb=33.9605, bio=0.0012
    Epoch  9/10: total=34.6581, vae=1.0827, dsb=33.5748, bio=0.0011
    Epoch 10/10: total=34.6252, vae=1.0815, dsb=33.5433, bio=0.0009

  [Backward Policy Training]
    Epoch  1/10: total=1.8693, vae=1.0827, dsb=0.7370, bio=0.0994
    Epoch  2/10: total=1.7464, vae=1.0823, dsb=0.6635, bio=0.0013
    Epoch  3/10: total=1.7287, vae=1.0819, dsb=0.6462, bio=0.0011
    Epoch  4/10: total=1.7193, vae=1.0815, dsb=0.6373, bio=0.0011
    Epoch  5/10: total=1.7073, vae=1.0817, dsb=0.6251, bio=0.0010
    Epoch  6/10: total=1.6946, vae=1.0815, dsb=0.6125, bio=0.0011
    Epoch  7/10: total=1.6967, vae=1.0811, dsb=0.6151, bio=0.0010
    Epoch  8/10: total=1.6966, vae=1.0811, dsb=0.6150, bio=0.0009
    Epoch  9/10: total=1.6803, vae=1.0808, dsb=0.5990, bio=0.0010
    Epoch 10/10: total=1.6882, vae=1.0808, dsb=0.6069, bio=0.0010

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=30.9308, vae=1.0840, dsb=29.8456, bio=0.0023
    Epoch  2/10: total=29.7626, vae=1.0822, dsb=28.6798, bio=0.0013
    Epoch  3/10: total=29.3015, vae=1.0816, dsb=28.2194, bio=0.0012
    Epoch  4/10: total=29.0467, vae=1.0822, dsb=27.9639, bio=0.0011
    Epoch  5/10: total=28.8636, vae=1.0815, dsb=27.7817, bio=0.0008
    Epoch  6/10: total=28.7815, vae=1.0821, dsb=27.6990, bio=0.0008
    Epoch  7/10: total=28.8055, vae=1.0809, dsb=27.7241, bio=0.0010
    Epoch  8/10: total=28.5912, vae=1.0823, dsb=27.5083, bio=0.0011
    Epoch  9/10: total=28.8668, vae=1.0805, dsb=27.7858, bio=0.0010
    Epoch 10/10: total=28.6516, vae=1.0811, dsb=27.5701, bio=0.0009

  [Backward Policy Training]
    Epoch  1/10: total=1.7070, vae=1.0829, dsb=0.5406, bio=0.1670
    Epoch  2/10: total=1.5997, vae=1.0813, dsb=0.5178, bio=0.0012
    Epoch  3/10: total=1.5684, vae=1.0807, dsb=0.4872, bio=0.0011
    Epoch  4/10: total=1.5816, vae=1.0811, dsb=0.5000, bio=0.0010
    Epoch  5/10: total=1.5664, vae=1.0819, dsb=0.4841, bio=0.0007
    Epoch  6/10: total=1.5601, vae=1.0809, dsb=0.4788, bio=0.0007
    Epoch  7/10: total=1.5672, vae=1.0806, dsb=0.4860, bio=0.0013
    Epoch  8/10: total=1.5725, vae=1.0815, dsb=0.4905, bio=0.0010
    Epoch  9/10: total=1.5507, vae=1.0814, dsb=0.4689, bio=0.0009
    Epoch 10/10: total=1.5514, vae=1.0802, dsb=0.4707, bio=0.0009

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=26.5051, vae=1.0829, dsb=25.4207, bio=0.0030
    Epoch  2/10: total=26.0508, vae=1.0825, dsb=24.9680, bio=0.0006
    Epoch  3/10: total=25.7069, vae=1.0814, dsb=24.6251, bio=0.0010
    Epoch  4/10: total=25.6763, vae=1.0820, dsb=24.5940, bio=0.0007
    Epoch  5/10: total=25.8538, vae=1.0818, dsb=24.7717, bio=0.0007
    Epoch  6/10: total=25.5855, vae=1.0817, dsb=24.5034, bio=0.0008
    Epoch  7/10: total=25.6383, vae=1.0814, dsb=24.5563, bio=0.0011
    Epoch  8/10: total=25.4910, vae=1.0812, dsb=24.4094, bio=0.0009
    Epoch  9/10: total=25.4560, vae=1.0809, dsb=24.3749, bio=0.0003
    Epoch 10/10: total=25.4421, vae=1.0811, dsb=24.3607, bio=0.0008

  [Backward Policy Training]
    Epoch  1/10: total=1.6018, vae=1.0817, dsb=0.4104, bio=0.2196
    Epoch  2/10: total=1.4763, vae=1.0809, dsb=0.3949, bio=0.0012
    Epoch  3/10: total=1.4853, vae=1.0807, dsb=0.4044, bio=0.0003
    Epoch  4/10: total=1.4815, vae=1.0807, dsb=0.4003, bio=0.0011
    Epoch  5/10: total=1.4764, vae=1.0807, dsb=0.3953, bio=0.0010
    Epoch  6/10: total=1.4676, vae=1.0798, dsb=0.3874, bio=0.0008
    Epoch  7/10: total=1.4704, vae=1.0803, dsb=0.3900, bio=0.0002
    Epoch  8/10: total=1.4614, vae=1.0804, dsb=0.3805, bio=0.0010
    Epoch  9/10: total=1.4693, vae=1.0810, dsb=0.3879, bio=0.0009
    Epoch 10/10: total=1.4719, vae=1.0806, dsb=0.3909, bio=0.0008

[Seed 32] Joint training (original) complete; models and history saved.

[Seed 32] Starting joint training (ablation)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=262.5171, vae=1.9908, dsb=260.5263, bio=0.0000
    Epoch  2/10: total=85.2602, vae=1.0777, dsb=84.1824, bio=0.0000
    Epoch  3/10: total=73.1205, vae=1.0757, dsb=72.0447, bio=0.0000
    Epoch  4/10: total=67.6935, vae=1.0759, dsb=66.6176, bio=0.0000
    Epoch  5/10: total=64.1527, vae=1.0743, dsb=63.0783, bio=0.0000
    Epoch  6/10: total=62.1980, vae=1.0748, dsb=61.1232, bio=0.0000
    Epoch  7/10: total=60.7145, vae=1.0743, dsb=59.6401, bio=0.0000
    Epoch  8/10: total=59.2277, vae=1.0736, dsb=58.1541, bio=0.0000
    Epoch  9/10: total=58.2819, vae=1.0742, dsb=57.2077, bio=0.0000
    Epoch 10/10: total=57.3844, vae=1.0741, dsb=56.3103, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=3.1316, vae=1.0748, dsb=2.0568, bio=0.0000
    Epoch  2/10: total=2.6468, vae=1.0734, dsb=1.5734, bio=0.0000
    Epoch  3/10: total=2.5279, vae=1.0740, dsb=1.4540, bio=0.0000
    Epoch  4/10: total=2.4698, vae=1.0735, dsb=1.3963, bio=0.0000
    Epoch  5/10: total=2.4235, vae=1.0739, dsb=1.3496, bio=0.0000
    Epoch  6/10: total=2.3800, vae=1.0744, dsb=1.3056, bio=0.0000
    Epoch  7/10: total=2.3568, vae=1.0741, dsb=1.2827, bio=0.0000
    Epoch  8/10: total=2.3546, vae=1.0735, dsb=1.2812, bio=0.0000
    Epoch  9/10: total=2.3427, vae=1.0736, dsb=1.2692, bio=0.0000
    Epoch 10/10: total=2.3065, vae=1.0737, dsb=1.2328, bio=0.0000

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=49.0623, vae=1.0735, dsb=47.9888, bio=0.0000
    Epoch  2/10: total=42.6638, vae=1.0745, dsb=41.5893, bio=0.0000
    Epoch  3/10: total=40.8902, vae=1.0736, dsb=39.8165, bio=0.0000
    Epoch  4/10: total=39.9794, vae=1.0735, dsb=38.9059, bio=0.0000
    Epoch  5/10: total=39.5100, vae=1.0734, dsb=38.4366, bio=0.0000
    Epoch  6/10: total=38.9929, vae=1.0737, dsb=37.9192, bio=0.0000
    Epoch  7/10: total=38.7573, vae=1.0736, dsb=37.6837, bio=0.0000
    Epoch  8/10: total=38.3812, vae=1.0746, dsb=37.3066, bio=0.0000
    Epoch  9/10: total=38.3422, vae=1.0740, dsb=37.2682, bio=0.0000
    Epoch 10/10: total=38.0164, vae=1.0742, dsb=36.9422, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=2.0801, vae=1.0739, dsb=1.0062, bio=0.0000
    Epoch  2/10: total=1.9623, vae=1.0737, dsb=0.8886, bio=0.0000
    Epoch  3/10: total=1.9064, vae=1.0735, dsb=0.8328, bio=0.0000
    Epoch  4/10: total=1.9159, vae=1.0729, dsb=0.8429, bio=0.0000
    Epoch  5/10: total=1.8809, vae=1.0729, dsb=0.8079, bio=0.0000
    Epoch  6/10: total=1.8510, vae=1.0727, dsb=0.7783, bio=0.0000
    Epoch  7/10: total=1.8449, vae=1.0738, dsb=0.7711, bio=0.0000
    Epoch  8/10: total=1.8369, vae=1.0734, dsb=0.7635, bio=0.0000
    Epoch  9/10: total=1.8311, vae=1.0737, dsb=0.7574, bio=0.0000
    Epoch 10/10: total=1.8117, vae=1.0742, dsb=0.7375, bio=0.0000

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=36.6406, vae=1.0734, dsb=35.5672, bio=0.0000
    Epoch  2/10: total=33.8234, vae=1.0742, dsb=32.7492, bio=0.0000
    Epoch  3/10: total=33.0881, vae=1.0738, dsb=32.0144, bio=0.0000
    Epoch  4/10: total=32.8307, vae=1.0735, dsb=31.7572, bio=0.0000
    Epoch  5/10: total=32.5146, vae=1.0738, dsb=31.4409, bio=0.0000
    Epoch  6/10: total=32.4116, vae=1.0739, dsb=31.3377, bio=0.0000
    Epoch  7/10: total=32.1459, vae=1.0732, dsb=31.0727, bio=0.0000
    Epoch  8/10: total=32.1946, vae=1.0737, dsb=31.1209, bio=0.0000
    Epoch  9/10: total=31.8580, vae=1.0744, dsb=30.7835, bio=0.0000
    Epoch 10/10: total=31.8373, vae=1.0732, dsb=30.7641, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.7271, vae=1.0732, dsb=0.6539, bio=0.0000
    Epoch  2/10: total=1.6623, vae=1.0741, dsb=0.5882, bio=0.0000
    Epoch  3/10: total=1.6476, vae=1.0739, dsb=0.5737, bio=0.0000
    Epoch  4/10: total=1.6403, vae=1.0736, dsb=0.5667, bio=0.0000
    Epoch  5/10: total=1.6301, vae=1.0739, dsb=0.5562, bio=0.0000
    Epoch  6/10: total=1.6188, vae=1.0737, dsb=0.5451, bio=0.0000
    Epoch  7/10: total=1.6212, vae=1.0734, dsb=0.5478, bio=0.0000
    Epoch  8/10: total=1.6211, vae=1.0735, dsb=0.5477, bio=0.0000
    Epoch  9/10: total=1.6063, vae=1.0734, dsb=0.5329, bio=0.0000
    Epoch 10/10: total=1.6136, vae=1.0733, dsb=0.5402, bio=0.0000

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=27.7115, vae=1.0737, dsb=26.6378, bio=0.0000
    Epoch  2/10: total=26.6735, vae=1.0735, dsb=25.6000, bio=0.0000
    Epoch  3/10: total=26.3383, vae=1.0731, dsb=25.2652, bio=0.0000
    Epoch  4/10: total=26.1280, vae=1.0739, dsb=25.0541, bio=0.0000
    Epoch  5/10: total=25.9789, vae=1.0733, dsb=24.9056, bio=0.0000
    Epoch  6/10: total=25.9436, vae=1.0740, dsb=24.8696, bio=0.0000
    Epoch  7/10: total=25.9613, vae=1.0730, dsb=24.8883, bio=0.0000
    Epoch  8/10: total=25.7618, vae=1.0745, dsb=24.6873, bio=0.0000
    Epoch  9/10: total=25.9995, vae=1.0727, dsb=24.9268, bio=0.0000
    Epoch 10/10: total=25.8293, vae=1.0733, dsb=24.7560, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.5378, vae=1.0740, dsb=0.4638, bio=0.0000
    Epoch  2/10: total=1.5190, vae=1.0737, dsb=0.4453, bio=0.0000
    Epoch  3/10: total=1.4925, vae=1.0731, dsb=0.4193, bio=0.0000
    Epoch  4/10: total=1.5047, vae=1.0738, dsb=0.4310, bio=0.0000
    Epoch  5/10: total=1.4920, vae=1.0746, dsb=0.4174, bio=0.0000
    Epoch  6/10: total=1.4869, vae=1.0737, dsb=0.4132, bio=0.0000
    Epoch  7/10: total=1.4931, vae=1.0735, dsb=0.4196, bio=0.0000
    Epoch  8/10: total=1.4984, vae=1.0746, dsb=0.4239, bio=0.0000
    Epoch  9/10: total=1.4796, vae=1.0745, dsb=0.4052, bio=0.0000
    Epoch 10/10: total=1.4804, vae=1.0733, dsb=0.4071, bio=0.0000

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=23.3323, vae=1.0733, dsb=22.2590, bio=0.0000
    Epoch  2/10: total=23.0221, vae=1.0742, dsb=21.9480, bio=0.0000
    Epoch  3/10: total=22.7141, vae=1.0733, dsb=21.6407, bio=0.0000
    Epoch  4/10: total=22.7128, vae=1.0741, dsb=21.6387, bio=0.0000
    Epoch  5/10: total=22.8441, vae=1.0740, dsb=21.7701, bio=0.0000
    Epoch  6/10: total=22.6268, vae=1.0740, dsb=21.5528, bio=0.0000
    Epoch  7/10: total=22.6634, vae=1.0739, dsb=21.5895, bio=0.0000
    Epoch  8/10: total=22.5436, vae=1.0736, dsb=21.4699, bio=0.0000
    Epoch  9/10: total=22.5228, vae=1.0735, dsb=21.4494, bio=0.0000
    Epoch 10/10: total=22.5135, vae=1.0737, dsb=21.4399, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.4212, vae=1.0728, dsb=0.3485, bio=0.0000
    Epoch  2/10: total=1.4104, vae=1.0733, dsb=0.3371, bio=0.0000
    Epoch  3/10: total=1.4195, vae=1.0733, dsb=0.3462, bio=0.0000
    Epoch  4/10: total=1.4170, vae=1.0736, dsb=0.3434, bio=0.0000
    Epoch  5/10: total=1.4130, vae=1.0737, dsb=0.3393, bio=0.0000
    Epoch  6/10: total=1.4052, vae=1.0728, dsb=0.3324, bio=0.0000
    Epoch  7/10: total=1.4085, vae=1.0734, dsb=0.3351, bio=0.0000
    Epoch  8/10: total=1.4003, vae=1.0736, dsb=0.3267, bio=0.0000
    Epoch  9/10: total=1.4075, vae=1.0742, dsb=0.3332, bio=0.0000
    Epoch 10/10: total=1.4101, vae=1.0739, dsb=0.3363, bio=0.0000

[Seed 32] Joint training (ablation) complete; models and history saved.

[Seed 32] Drift genes saved in /home/yyuan/ICB_TCE/iter_results/run_032

[Seed 32] run finished.

================================================================================
[Seed 33] Starting running whole pipeline...
================================================================================

[Seed 33] Starting VAE pre-training...

    Epoch [01/20], Beta: 0.000, Average Loss: 538.3744
    Epoch [02/20], Beta: 0.000, Average Loss: 309.6380
    Epoch [03/20], Beta: 0.000, Average Loss: 269.5478
    Epoch [04/20], Beta: 0.000, Average Loss: 248.0792
    Epoch [05/20], Beta: 0.100, Average Loss: 244.1157
    Epoch [06/20], Beta: 0.200, Average Loss: 243.7455
    Epoch [07/20], Beta: 0.300, Average Loss: 244.3333
    Epoch [08/20], Beta: 0.400, Average Loss: 245.2601
    Epoch [09/20], Beta: 0.500, Average Loss: 246.4202
    Epoch [10/20], Beta: 0.600, Average Loss: 247.6571
    Epoch [11/20], Beta: 0.700, Average Loss: 248.9655
    Epoch [12/20], Beta: 0.800, Average Loss: 250.2755
    Epoch [13/20], Beta: 0.900, Average Loss: 251.5765
    Epoch [14/20], Beta: 1.000, Average Loss: 253.2178
    Epoch [15/20], Beta: 1.000, Average Loss: 252.8278
    Epoch [16/20], Beta: 1.000, Average Loss: 252.4264
    Epoch [17/20], Beta: 1.000, Average Loss: 252.0777
    Epoch [18/20], Beta: 1.000, Average Loss: 251.7677
    Epoch [19/20], Beta: 1.000, Average Loss: 251.3899
    Epoch [20/20], Beta: 1.000, Average Loss: 251.2489

[Seed 33] VAE pre-training complete.

[Seed 33] Starting joint training (original)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=294.8416, vae=3.3024, dsb=284.6582, bio=13.7621
    Epoch  2/10: total=96.2564, vae=1.1112, dsb=95.1112, bio=0.0679
    Epoch  3/10: total=86.5541, vae=1.1056, dsb=85.4330, bio=0.0309
    Epoch  4/10: total=81.9976, vae=1.1036, dsb=80.8847, bio=0.0186
    Epoch  5/10: total=79.1814, vae=1.1040, dsb=78.0711, bio=0.0126
    Epoch  6/10: total=77.3039, vae=1.1026, dsb=76.1966, bio=0.0094
    Epoch  7/10: total=75.9303, vae=1.1024, dsb=74.8242, bio=0.0074
    Epoch  8/10: total=75.1321, vae=1.1019, dsb=74.0272, bio=0.0060
    Epoch  9/10: total=74.1022, vae=1.1013, dsb=72.9983, bio=0.0051
    Epoch 10/10: total=73.2276, vae=1.1008, dsb=72.1246, bio=0.0044

  [Backward Policy Training]
    Epoch  1/10: total=3.3335, vae=1.1023, dsb=2.2223, bio=0.0180
    Epoch  2/10: total=2.8287, vae=1.1006, dsb=1.7254, bio=0.0055
    Epoch  3/10: total=2.7018, vae=1.1006, dsb=1.5993, bio=0.0038
    Epoch  4/10: total=2.6311, vae=1.1000, dsb=1.5296, bio=0.0030
    Epoch  5/10: total=2.5525, vae=1.0995, dsb=1.4517, bio=0.0027
    Epoch  6/10: total=2.5950, vae=1.1002, dsb=1.4936, bio=0.0025
    Epoch  7/10: total=2.4952, vae=1.0993, dsb=1.3949, bio=0.0021
    Epoch  8/10: total=2.5029, vae=1.0988, dsb=1.4030, bio=0.0020
    Epoch  9/10: total=2.5176, vae=1.0995, dsb=1.4171, bio=0.0019
    Epoch 10/10: total=2.4919, vae=1.0987, dsb=1.3923, bio=0.0019

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=65.2269, vae=1.1018, dsb=64.1229, bio=0.0043
    Epoch  2/10: total=60.0968, vae=1.1011, dsb=58.9948, bio=0.0018
    Epoch  3/10: total=58.6430, vae=1.1001, dsb=57.5421, bio=0.0017
    Epoch  4/10: total=57.8981, vae=1.0992, dsb=56.7981, bio=0.0017
    Epoch  5/10: total=57.5314, vae=1.1000, dsb=56.4306, bio=0.0016
    Epoch  6/10: total=57.1647, vae=1.0990, dsb=56.0649, bio=0.0017
    Epoch  7/10: total=57.1658, vae=1.1001, dsb=56.0649, bio=0.0016
    Epoch  8/10: total=56.7655, vae=1.0980, dsb=55.6666, bio=0.0017
    Epoch  9/10: total=56.9601, vae=1.0985, dsb=55.8608, bio=0.0016
    Epoch 10/10: total=56.3849, vae=1.0993, dsb=55.2848, bio=0.0016

  [Backward Policy Training]
    Epoch  1/10: total=2.2268, vae=1.0999, dsb=1.1237, bio=0.0066
    Epoch  2/10: total=2.0721, vae=1.0980, dsb=0.9732, bio=0.0019
    Epoch  3/10: total=2.0675, vae=1.0980, dsb=0.9687, bio=0.0018
    Epoch  4/10: total=2.0664, vae=1.0975, dsb=0.9681, bio=0.0015
    Epoch  5/10: total=2.0278, vae=1.0984, dsb=0.9287, bio=0.0015
    Epoch  6/10: total=2.0342, vae=1.0978, dsb=0.9357, bio=0.0014
    Epoch  7/10: total=1.9885, vae=1.0974, dsb=0.8904, bio=0.0014
    Epoch  8/10: total=1.9887, vae=1.0976, dsb=0.8903, bio=0.0014
    Epoch  9/10: total=1.9954, vae=1.0984, dsb=0.8964, bio=0.0014
    Epoch 10/10: total=1.9863, vae=1.0974, dsb=0.8882, bio=0.0014

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=49.7180, vae=1.1009, dsb=48.6157, bio=0.0028
    Epoch  2/10: total=47.6793, vae=1.0988, dsb=46.5798, bio=0.0014
    Epoch  3/10: total=47.6569, vae=1.0981, dsb=46.5581, bio=0.0014
    Epoch  4/10: total=47.1670, vae=1.0987, dsb=46.0676, bio=0.0014
    Epoch  5/10: total=47.0452, vae=1.0993, dsb=45.9453, bio=0.0012
    Epoch  6/10: total=46.8039, vae=1.0993, dsb=45.7031, bio=0.0030
    Epoch  7/10: total=46.8496, vae=1.0981, dsb=45.7502, bio=0.0027
    Epoch  8/10: total=46.8944, vae=1.0980, dsb=45.7958, bio=0.0013
    Epoch  9/10: total=46.8186, vae=1.0987, dsb=45.7192, bio=0.0013
    Epoch 10/10: total=46.5100, vae=1.0983, dsb=45.4111, bio=0.0013

  [Backward Policy Training]
    Epoch  1/10: total=1.8704, vae=1.0987, dsb=0.7649, bio=0.0136
    Epoch  2/10: total=1.8216, vae=1.0973, dsb=0.7236, bio=0.0014
    Epoch  3/10: total=1.8146, vae=1.0972, dsb=0.7167, bio=0.0013
    Epoch  4/10: total=1.7981, vae=1.0974, dsb=0.7001, bio=0.0012
    Epoch  5/10: total=1.7958, vae=1.0967, dsb=0.6984, bio=0.0012
    Epoch  6/10: total=1.7994, vae=1.0972, dsb=0.7016, bio=0.0012
    Epoch  7/10: total=1.7918, vae=1.0968, dsb=0.6944, bio=0.0012
    Epoch  8/10: total=1.7745, vae=1.0965, dsb=0.6774, bio=0.0011
    Epoch  9/10: total=1.7940, vae=1.0972, dsb=0.6962, bio=0.0011
    Epoch 10/10: total=1.7699, vae=1.0964, dsb=0.6729, bio=0.0011

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=40.8400, vae=1.0987, dsb=39.7401, bio=0.0025
    Epoch  2/10: total=40.3017, vae=1.0982, dsb=39.2029, bio=0.0013
    Epoch  3/10: total=39.9083, vae=1.0987, dsb=38.8090, bio=0.0012
    Epoch  4/10: total=39.7963, vae=1.0979, dsb=38.6978, bio=0.0011
    Epoch  5/10: total=39.7636, vae=1.0977, dsb=38.6653, bio=0.0011
    Epoch  6/10: total=39.6233, vae=1.0980, dsb=38.5247, bio=0.0011
    Epoch  7/10: total=39.6965, vae=1.0977, dsb=38.5983, bio=0.0011
    Epoch  8/10: total=39.6217, vae=1.0971, dsb=38.5240, bio=0.0011
    Epoch  9/10: total=39.8239, vae=1.0971, dsb=38.7265, bio=0.0006
    Epoch 10/10: total=39.7647, vae=1.0968, dsb=38.6673, bio=0.0012

  [Backward Policy Training]
    Epoch  1/10: total=1.7183, vae=1.0980, dsb=0.5749, bio=0.0909
    Epoch  2/10: total=1.6604, vae=1.0978, dsb=0.5618, bio=0.0015
    Epoch  3/10: total=1.6477, vae=1.0971, dsb=0.5499, bio=0.0012
    Epoch  4/10: total=1.6400, vae=1.0968, dsb=0.5426, bio=0.0011
    Epoch  5/10: total=1.6571, vae=1.0968, dsb=0.5597, bio=0.0011
    Epoch  6/10: total=1.6437, vae=1.0969, dsb=0.5463, bio=0.0010
    Epoch  7/10: total=1.6263, vae=1.0961, dsb=0.5298, bio=0.0009
    Epoch  8/10: total=1.6438, vae=1.0964, dsb=0.5470, bio=0.0008
    Epoch  9/10: total=1.6404, vae=1.0956, dsb=0.5443, bio=0.0010
    Epoch 10/10: total=1.6422, vae=1.0961, dsb=0.5456, bio=0.0010

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=34.6077, vae=1.0992, dsb=33.5072, bio=0.0026
    Epoch  2/10: total=34.2204, vae=1.0978, dsb=33.1218, bio=0.0015
    Epoch  3/10: total=34.1085, vae=1.0978, dsb=33.0101, bio=0.0011
    Epoch  4/10: total=34.0550, vae=1.0983, dsb=32.9562, bio=0.0011
    Epoch  5/10: total=34.0976, vae=1.0975, dsb=32.9996, bio=0.0010
    Epoch  6/10: total=34.0618, vae=1.0970, dsb=32.9644, bio=0.0009
    Epoch  7/10: total=34.1460, vae=1.0961, dsb=33.0497, bio=0.0004
    Epoch  8/10: total=34.0439, vae=1.0970, dsb=32.9466, bio=0.0005
    Epoch  9/10: total=34.0899, vae=1.0974, dsb=32.9919, bio=0.0012
    Epoch 10/10: total=34.0470, vae=1.0969, dsb=32.9496, bio=0.0010

  [Backward Policy Training]
    Epoch  1/10: total=1.6807, vae=1.0985, dsb=0.5147, bio=0.1349
    Epoch  2/10: total=1.5852, vae=1.0967, dsb=0.4879, bio=0.0013
    Epoch  3/10: total=1.5807, vae=1.0979, dsb=0.4822, bio=0.0011
    Epoch  4/10: total=1.5978, vae=1.0965, dsb=0.5007, bio=0.0010
    Epoch  5/10: total=1.5967, vae=1.0958, dsb=0.5007, bio=0.0005
    Epoch  6/10: total=1.5906, vae=1.0964, dsb=0.4936, bio=0.0011
    Epoch  7/10: total=1.5908, vae=1.0963, dsb=0.4940, bio=0.0010
    Epoch  8/10: total=1.5778, vae=1.0953, dsb=0.4820, bio=0.0009
    Epoch  9/10: total=1.5766, vae=1.0962, dsb=0.4801, bio=0.0006
    Epoch 10/10: total=1.5848, vae=1.0959, dsb=0.4886, bio=0.0006

[Seed 33] Joint training (original) complete; models and history saved.

[Seed 33] Starting joint training (ablation)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=286.1064, vae=1.9899, dsb=284.1165, bio=0.0000
    Epoch  2/10: total=95.4571, vae=1.0931, dsb=94.3640, bio=0.0000
    Epoch  3/10: total=85.9223, vae=1.0908, dsb=84.8315, bio=0.0000
    Epoch  4/10: total=81.3612, vae=1.0899, dsb=80.2713, bio=0.0000
    Epoch  5/10: total=78.5341, vae=1.0908, dsb=77.4433, bio=0.0000
    Epoch  6/10: total=76.7312, vae=1.0899, dsb=75.6413, bio=0.0000
    Epoch  7/10: total=75.4810, vae=1.0901, dsb=74.3909, bio=0.0000
    Epoch  8/10: total=74.7031, vae=1.0899, dsb=73.6132, bio=0.0000
    Epoch  9/10: total=73.6704, vae=1.0897, dsb=72.5808, bio=0.0000
    Epoch 10/10: total=72.7916, vae=1.0894, dsb=71.7022, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=3.2046, vae=1.0897, dsb=2.1149, bio=0.0000
    Epoch  2/10: total=2.7481, vae=1.0898, dsb=1.6583, bio=0.0000
    Epoch  3/10: total=2.6293, vae=1.0902, dsb=1.5391, bio=0.0000
    Epoch  4/10: total=2.5651, vae=1.0899, dsb=1.4752, bio=0.0000
    Epoch  5/10: total=2.4901, vae=1.0895, dsb=1.4006, bio=0.0000
    Epoch  6/10: total=2.5347, vae=1.0905, dsb=1.4442, bio=0.0000
    Epoch  7/10: total=2.4374, vae=1.0896, dsb=1.3478, bio=0.0000
    Epoch  8/10: total=2.4456, vae=1.0893, dsb=1.3563, bio=0.0000
    Epoch  9/10: total=2.4592, vae=1.0901, dsb=1.3691, bio=0.0000
    Epoch 10/10: total=2.4345, vae=1.0894, dsb=1.3451, bio=0.0000

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=63.7446, vae=1.0891, dsb=62.6555, bio=0.0000
    Epoch  2/10: total=58.6085, vae=1.0904, dsb=57.5181, bio=0.0000
    Epoch  3/10: total=57.3001, vae=1.0896, dsb=56.2106, bio=0.0000
    Epoch  4/10: total=56.5323, vae=1.0889, dsb=55.4434, bio=0.0000
    Epoch  5/10: total=56.2089, vae=1.0899, dsb=55.1191, bio=0.0000
    Epoch  6/10: total=55.8750, vae=1.0890, dsb=54.7860, bio=0.0000
    Epoch  7/10: total=55.8916, vae=1.0901, dsb=54.8015, bio=0.0000
    Epoch  8/10: total=55.5103, vae=1.0882, dsb=54.4220, bio=0.0000
    Epoch  9/10: total=55.7225, vae=1.0887, dsb=54.6338, bio=0.0000
    Epoch 10/10: total=55.1737, vae=1.0896, dsb=54.0841, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=2.1359, vae=1.0893, dsb=1.0466, bio=0.0000
    Epoch  2/10: total=1.9939, vae=1.0892, dsb=0.9047, bio=0.0000
    Epoch  3/10: total=1.9917, vae=1.0893, dsb=0.9024, bio=0.0000
    Epoch  4/10: total=1.9918, vae=1.0890, dsb=0.9028, bio=0.0000
    Epoch  5/10: total=1.9559, vae=1.0899, dsb=0.8660, bio=0.0000
    Epoch  6/10: total=1.9627, vae=1.0894, dsb=0.8733, bio=0.0000
    Epoch  7/10: total=1.9204, vae=1.0890, dsb=0.8314, bio=0.0000
    Epoch  8/10: total=1.9209, vae=1.0893, dsb=0.8316, bio=0.0000
    Epoch  9/10: total=1.9276, vae=1.0900, dsb=0.8375, bio=0.0000
    Epoch 10/10: total=1.9200, vae=1.0891, dsb=0.8308, bio=0.0000

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=47.8492, vae=1.0891, dsb=46.7601, bio=0.0000
    Epoch  2/10: total=45.7659, vae=1.0893, dsb=44.6766, bio=0.0000
    Epoch  3/10: total=45.7264, vae=1.0887, dsb=44.6377, bio=0.0000
    Epoch  4/10: total=45.2648, vae=1.0895, dsb=44.1753, bio=0.0000
    Epoch  5/10: total=45.1750, vae=1.0901, dsb=44.0849, bio=0.0000
    Epoch  6/10: total=44.9417, vae=1.0902, dsb=43.8515, bio=0.0000
    Epoch  7/10: total=44.9965, vae=1.0891, dsb=43.9074, bio=0.0000
    Epoch  8/10: total=44.9915, vae=1.0891, dsb=43.9024, bio=0.0000
    Epoch  9/10: total=44.9765, vae=1.0899, dsb=43.8866, bio=0.0000
    Epoch 10/10: total=44.7141, vae=1.0895, dsb=43.6246, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.7976, vae=1.0894, dsb=0.7083, bio=0.0000
    Epoch  2/10: total=1.7606, vae=1.0892, dsb=0.6714, bio=0.0000
    Epoch  3/10: total=1.7551, vae=1.0892, dsb=0.6659, bio=0.0000
    Epoch  4/10: total=1.7398, vae=1.0894, dsb=0.6504, bio=0.0000
    Epoch  5/10: total=1.7383, vae=1.0887, dsb=0.6496, bio=0.0000
    Epoch  6/10: total=1.7418, vae=1.0893, dsb=0.6525, bio=0.0000
    Epoch  7/10: total=1.7354, vae=1.0889, dsb=0.6466, bio=0.0000
    Epoch  8/10: total=1.7189, vae=1.0888, dsb=0.6302, bio=0.0000
    Epoch  9/10: total=1.7379, vae=1.0894, dsb=0.6486, bio=0.0000
    Epoch 10/10: total=1.7154, vae=1.0887, dsb=0.6267, bio=0.0000

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=39.8342, vae=1.0882, dsb=38.7460, bio=0.0000
    Epoch  2/10: total=39.3436, vae=1.0890, dsb=38.2546, bio=0.0000
    Epoch  3/10: total=39.0081, vae=1.0900, dsb=37.9181, bio=0.0000
    Epoch  4/10: total=38.9259, vae=1.0893, dsb=37.8366, bio=0.0000
    Epoch  5/10: total=38.8597, vae=1.0892, dsb=37.7706, bio=0.0000
    Epoch  6/10: total=38.7359, vae=1.0896, dsb=37.6463, bio=0.0000
    Epoch  7/10: total=38.8295, vae=1.0893, dsb=37.7402, bio=0.0000
    Epoch  8/10: total=38.7764, vae=1.0889, dsb=37.6876, bio=0.0000
    Epoch  9/10: total=38.9598, vae=1.0889, dsb=37.8709, bio=0.0000
    Epoch 10/10: total=38.8939, vae=1.0889, dsb=37.8050, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.6233, vae=1.0890, dsb=0.5343, bio=0.0000
    Epoch  2/10: total=1.6139, vae=1.0900, dsb=0.5239, bio=0.0000
    Epoch  3/10: total=1.6022, vae=1.0895, dsb=0.5127, bio=0.0000
    Epoch  4/10: total=1.5957, vae=1.0893, dsb=0.5064, bio=0.0000
    Epoch  5/10: total=1.6122, vae=1.0894, dsb=0.5229, bio=0.0000
    Epoch  6/10: total=1.5994, vae=1.0895, dsb=0.5099, bio=0.0000
    Epoch  7/10: total=1.5831, vae=1.0888, dsb=0.4943, bio=0.0000
    Epoch  8/10: total=1.6009, vae=1.0893, dsb=0.5116, bio=0.0000
    Epoch  9/10: total=1.5975, vae=1.0887, dsb=0.5088, bio=0.0000
    Epoch 10/10: total=1.5993, vae=1.0892, dsb=0.5101, bio=0.0000

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=34.0693, vae=1.0894, dsb=32.9798, bio=0.0000
    Epoch  2/10: total=33.7013, vae=1.0892, dsb=32.6121, bio=0.0000
    Epoch  3/10: total=33.6245, vae=1.0894, dsb=32.5351, bio=0.0000
    Epoch  4/10: total=33.5715, vae=1.0901, dsb=32.4814, bio=0.0000
    Epoch  5/10: total=33.6197, vae=1.0894, dsb=32.5304, bio=0.0000
    Epoch  6/10: total=33.6108, vae=1.0889, dsb=32.5219, bio=0.0000
    Epoch  7/10: total=33.6812, vae=1.0881, dsb=32.5930, bio=0.0000
    Epoch  8/10: total=33.5400, vae=1.0892, dsb=32.4508, bio=0.0000
    Epoch  9/10: total=33.6071, vae=1.0898, dsb=32.5174, bio=0.0000
    Epoch 10/10: total=33.5400, vae=1.0893, dsb=32.4506, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.5664, vae=1.0896, dsb=0.4768, bio=0.0000
    Epoch  2/10: total=1.5400, vae=1.0893, dsb=0.4507, bio=0.0000
    Epoch  3/10: total=1.5363, vae=1.0907, dsb=0.4456, bio=0.0000
    Epoch  4/10: total=1.5526, vae=1.0894, dsb=0.4631, bio=0.0000
    Epoch  5/10: total=1.5521, vae=1.0889, dsb=0.4633, bio=0.0000
    Epoch  6/10: total=1.5465, vae=1.0897, dsb=0.4568, bio=0.0000
    Epoch  7/10: total=1.5470, vae=1.0896, dsb=0.4573, bio=0.0000
    Epoch  8/10: total=1.5345, vae=1.0887, dsb=0.4459, bio=0.0000
    Epoch  9/10: total=1.5334, vae=1.0895, dsb=0.4439, bio=0.0000
    Epoch 10/10: total=1.5417, vae=1.0894, dsb=0.4523, bio=0.0000

[Seed 33] Joint training (ablation) complete; models and history saved.

[Seed 33] Drift genes saved in /home/yyuan/ICB_TCE/iter_results/run_033

[Seed 33] run finished.

================================================================================
[Seed 34] Starting running whole pipeline...
================================================================================

[Seed 34] Starting VAE pre-training...

    Epoch [01/20], Beta: 0.000, Average Loss: 541.0353
    Epoch [02/20], Beta: 0.000, Average Loss: 304.6723
    Epoch [03/20], Beta: 0.000, Average Loss: 267.0815
    Epoch [04/20], Beta: 0.000, Average Loss: 247.7291
    Epoch [05/20], Beta: 0.100, Average Loss: 244.5516
    Epoch [06/20], Beta: 0.200, Average Loss: 244.2044
    Epoch [07/20], Beta: 0.300, Average Loss: 244.5456
    Epoch [08/20], Beta: 0.400, Average Loss: 245.3298
    Epoch [09/20], Beta: 0.500, Average Loss: 246.4512
    Epoch [10/20], Beta: 0.600, Average Loss: 247.6902
    Epoch [11/20], Beta: 0.700, Average Loss: 248.9496
    Epoch [12/20], Beta: 0.800, Average Loss: 250.3101
    Epoch [13/20], Beta: 0.900, Average Loss: 251.5805
    Epoch [14/20], Beta: 1.000, Average Loss: 253.2208
    Epoch [15/20], Beta: 1.000, Average Loss: 252.8158
    Epoch [16/20], Beta: 1.000, Average Loss: 252.4170
    Epoch [17/20], Beta: 1.000, Average Loss: 252.0744
    Epoch [18/20], Beta: 1.000, Average Loss: 251.7771
    Epoch [19/20], Beta: 1.000, Average Loss: 251.3860
    Epoch [20/20], Beta: 1.000, Average Loss: 251.2054

[Seed 34] VAE pre-training complete.

[Seed 34] Starting joint training (original)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=485.3538, vae=3.5071, dsb=466.2645, bio=31.1644
    Epoch  2/10: total=142.3602, vae=1.1075, dsb=141.2186, bio=0.0682
    Epoch  3/10: total=129.5495, vae=1.1031, dsb=128.4312, bio=0.0303
    Epoch  4/10: total=123.0255, vae=1.1016, dsb=121.9152, bio=0.0175
    Epoch  5/10: total=120.1309, vae=1.0999, dsb=119.0252, bio=0.0117
    Epoch  6/10: total=117.0079, vae=1.0998, dsb=115.9037, bio=0.0086
    Epoch  7/10: total=114.5896, vae=1.0987, dsb=113.4874, bio=0.0068
    Epoch  8/10: total=113.9900, vae=1.0997, dsb=112.8875, bio=0.0056
    Epoch  9/10: total=113.0793, vae=1.0991, dsb=111.9778, bio=0.0047
    Epoch 10/10: total=111.9285, vae=1.0981, dsb=110.8281, bio=0.0045

  [Backward Policy Training]
    Epoch  1/10: total=3.6661, vae=1.0989, dsb=2.5603, bio=0.0138
    Epoch  2/10: total=3.1228, vae=1.0974, dsb=2.0230, bio=0.0047
    Epoch  3/10: total=2.9701, vae=1.0972, dsb=1.8712, bio=0.0033
    Epoch  4/10: total=2.8698, vae=1.0978, dsb=1.7706, bio=0.0028
    Epoch  5/10: total=2.7770, vae=1.0966, dsb=1.6792, bio=0.0024
    Epoch  6/10: total=2.7756, vae=1.0971, dsb=1.6774, bio=0.0023
    Epoch  7/10: total=2.7604, vae=1.0970, dsb=1.6623, bio=0.0021
    Epoch  8/10: total=2.7307, vae=1.0969, dsb=1.6328, bio=0.0020
    Epoch  9/10: total=2.7016, vae=1.0967, dsb=1.6039, bio=0.0020
    Epoch 10/10: total=2.7235, vae=1.0964, dsb=1.6259, bio=0.0023

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=102.3575, vae=1.0995, dsb=101.2560, bio=0.0039
    Epoch  2/10: total=95.4960, vae=1.0965, dsb=94.3985, bio=0.0020
    Epoch  3/10: total=93.3134, vae=1.0976, dsb=92.2148, bio=0.0019
    Epoch  4/10: total=92.7489, vae=1.0976, dsb=91.6504, bio=0.0019
    Epoch  5/10: total=92.4316, vae=1.0969, dsb=91.3338, bio=0.0019
    Epoch  6/10: total=91.5589, vae=1.0969, dsb=90.4611, bio=0.0020
    Epoch  7/10: total=91.1930, vae=1.0962, dsb=90.0958, bio=0.0019
    Epoch  8/10: total=90.6341, vae=1.0969, dsb=89.5363, bio=0.0019
    Epoch  9/10: total=90.3100, vae=1.0968, dsb=89.2123, bio=0.0019
    Epoch 10/10: total=90.0152, vae=1.0963, dsb=88.9180, bio=0.0019

  [Backward Policy Training]
    Epoch  1/10: total=2.4289, vae=1.0971, dsb=1.3292, bio=0.0053
    Epoch  2/10: total=2.3287, vae=1.0955, dsb=1.2323, bio=0.0019
    Epoch  3/10: total=2.3250, vae=1.0955, dsb=1.2286, bio=0.0018
    Epoch  4/10: total=2.2518, vae=1.0959, dsb=1.1552, bio=0.0014
    Epoch  5/10: total=2.2446, vae=1.0954, dsb=1.1483, bio=0.0019
    Epoch  6/10: total=2.2037, vae=1.0945, dsb=1.1084, bio=0.0016
    Epoch  7/10: total=2.2193, vae=1.0955, dsb=1.1231, bio=0.0016
    Epoch  8/10: total=2.1986, vae=1.0953, dsb=1.1025, bio=0.0016
    Epoch  9/10: total=2.2306, vae=1.0946, dsb=1.1353, bio=0.0015
    Epoch 10/10: total=2.2066, vae=1.0947, dsb=1.1112, bio=0.0015

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=84.7129, vae=1.0972, dsb=83.6141, bio=0.0030
    Epoch  2/10: total=82.1304, vae=1.0965, dsb=81.0331, bio=0.0017
    Epoch  3/10: total=81.3480, vae=1.0962, dsb=80.2510, bio=0.0016
    Epoch  4/10: total=80.9414, vae=1.0957, dsb=79.8449, bio=0.0016
    Epoch  5/10: total=80.7203, vae=1.0966, dsb=79.6229, bio=0.0016
    Epoch  6/10: total=80.3762, vae=1.0961, dsb=79.2793, bio=0.0016
    Epoch  7/10: total=80.3189, vae=1.0959, dsb=79.2222, bio=0.0016
    Epoch  8/10: total=79.6262, vae=1.0956, dsb=78.5298, bio=0.0017
    Epoch  9/10: total=79.8824, vae=1.0951, dsb=78.7866, bio=0.0016
    Epoch 10/10: total=79.5978, vae=1.0953, dsb=78.5017, bio=0.0016

  [Backward Policy Training]
    Epoch  1/10: total=2.0721, vae=1.0961, dsb=0.9724, bio=0.0071
    Epoch  2/10: total=2.0057, vae=1.0946, dsb=0.9103, bio=0.0016
    Epoch  3/10: total=2.0173, vae=1.0949, dsb=0.9216, bio=0.0014
    Epoch  4/10: total=1.9730, vae=1.0944, dsb=0.8779, bio=0.0014
    Epoch  5/10: total=1.9729, vae=1.0943, dsb=0.8779, bio=0.0013
    Epoch  6/10: total=1.9822, vae=1.0940, dsb=0.8875, bio=0.0014
    Epoch  7/10: total=1.9565, vae=1.0947, dsb=0.8612, bio=0.0013
    Epoch  8/10: total=1.9405, vae=1.0947, dsb=0.8452, bio=0.0013
    Epoch  9/10: total=1.9480, vae=1.0946, dsb=0.8528, bio=0.0013
    Epoch 10/10: total=1.9506, vae=1.0946, dsb=0.8554, bio=0.0012

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=70.1702, vae=1.0983, dsb=69.0700, bio=0.0038
    Epoch  2/10: total=69.1091, vae=1.0950, dsb=68.0134, bio=0.0013
    Epoch  3/10: total=68.5889, vae=1.0958, dsb=67.4924, bio=0.0014
    Epoch  4/10: total=68.6028, vae=1.0957, dsb=67.5064, bio=0.0014
    Epoch  5/10: total=68.3164, vae=1.0951, dsb=67.2206, bio=0.0014
    Epoch  6/10: total=67.9524, vae=1.0955, dsb=66.8562, bio=0.0014
    Epoch  7/10: total=67.8505, vae=1.0946, dsb=66.7553, bio=0.0014
    Epoch  8/10: total=67.5076, vae=1.0944, dsb=66.4125, bio=0.0014
    Epoch  9/10: total=67.7488, vae=1.0948, dsb=66.6533, bio=0.0014
    Epoch 10/10: total=67.8543, vae=1.0949, dsb=66.7587, bio=0.0013

  [Backward Policy Training]
    Epoch  1/10: total=1.8700, vae=1.0960, dsb=0.7576, bio=0.0329
    Epoch  2/10: total=1.8234, vae=1.0942, dsb=0.7285, bio=0.0013
    Epoch  3/10: total=1.8327, vae=1.0940, dsb=0.7381, bio=0.0012
    Epoch  4/10: total=1.8053, vae=1.0945, dsb=0.7101, bio=0.0012
    Epoch  5/10: total=1.8251, vae=1.0941, dsb=0.7305, bio=0.0011
    Epoch  6/10: total=1.8118, vae=1.0934, dsb=0.7178, bio=0.0011
    Epoch  7/10: total=1.8042, vae=1.0940, dsb=0.7097, bio=0.0011
    Epoch  8/10: total=1.8199, vae=1.0941, dsb=0.7252, bio=0.0011
    Epoch  9/10: total=1.7961, vae=1.0943, dsb=0.7012, bio=0.0011
    Epoch 10/10: total=1.7961, vae=1.0942, dsb=0.7014, bio=0.0011

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=58.8164, vae=1.0964, dsb=57.7187, bio=0.0027
    Epoch  2/10: total=58.1715, vae=1.0959, dsb=57.0750, bio=0.0012
    Epoch  3/10: total=58.0416, vae=1.0950, dsb=56.9459, bio=0.0012
    Epoch  4/10: total=58.0973, vae=1.0951, dsb=57.0015, bio=0.0013
    Epoch  5/10: total=58.0510, vae=1.0944, dsb=56.9560, bio=0.0012
    Epoch  6/10: total=58.2088, vae=1.0942, dsb=57.1140, bio=0.0012
    Epoch  7/10: total=57.9248, vae=1.0949, dsb=56.8294, bio=0.0011
    Epoch  8/10: total=58.0555, vae=1.0935, dsb=56.9614, bio=0.0012
    Epoch  9/10: total=58.1371, vae=1.0936, dsb=57.0429, bio=0.0011
    Epoch 10/10: total=58.0770, vae=1.0934, dsb=56.9831, bio=0.0011

  [Backward Policy Training]
    Epoch  1/10: total=1.7960, vae=1.0959, dsb=0.6538, bio=0.0924
    Epoch  2/10: total=1.7310, vae=1.0944, dsb=0.6359, bio=0.0012
    Epoch  3/10: total=1.7200, vae=1.0937, dsb=0.6258, bio=0.0011
    Epoch  4/10: total=1.7301, vae=1.0943, dsb=0.6353, bio=0.0010
    Epoch  5/10: total=1.7248, vae=1.0947, dsb=0.6296, bio=0.0012
    Epoch  6/10: total=1.7227, vae=1.0943, dsb=0.6280, bio=0.0010
    Epoch  7/10: total=1.7265, vae=1.0939, dsb=0.6322, bio=0.0010
    Epoch  8/10: total=1.7277, vae=1.0951, dsb=0.6322, bio=0.0010
    Epoch  9/10: total=1.7071, vae=1.0930, dsb=0.6137, bio=0.0010
    Epoch 10/10: total=1.7249, vae=1.0948, dsb=0.6297, bio=0.0009

[Seed 34] Joint training (original) complete; models and history saved.

[Seed 34] Starting joint training (ablation)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=467.0843, vae=1.9905, dsb=465.0938, bio=0.0000
    Epoch  2/10: total=141.2726, vae=1.0900, dsb=140.1826, bio=0.0000
    Epoch  3/10: total=128.8941, vae=1.0886, dsb=127.8055, bio=0.0000
    Epoch  4/10: total=122.4804, vae=1.0881, dsb=121.3923, bio=0.0000
    Epoch  5/10: total=119.6536, vae=1.0869, dsb=118.5668, bio=0.0000
    Epoch  6/10: total=116.6845, vae=1.0872, dsb=115.5973, bio=0.0000
    Epoch  7/10: total=114.3954, vae=1.0864, dsb=113.3089, bio=0.0000
    Epoch  8/10: total=113.8357, vae=1.0877, dsb=112.7479, bio=0.0000
    Epoch  9/10: total=112.9846, vae=1.0874, dsb=111.8972, bio=0.0000
    Epoch 10/10: total=111.8864, vae=1.0866, dsb=110.7998, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=3.5433, vae=1.0864, dsb=2.4569, bio=0.0000
    Epoch  2/10: total=3.0138, vae=1.0864, dsb=1.9274, bio=0.0000
    Epoch  3/10: total=2.8618, vae=1.0866, dsb=1.7751, bio=0.0000
    Epoch  4/10: total=2.7601, vae=1.0876, dsb=1.6725, bio=0.0000
    Epoch  5/10: total=2.6693, vae=1.0865, dsb=1.5827, bio=0.0000
    Epoch  6/10: total=2.6677, vae=1.0872, dsb=1.5804, bio=0.0000
    Epoch  7/10: total=2.6539, vae=1.0872, dsb=1.5666, bio=0.0000
    Epoch  8/10: total=2.6273, vae=1.0872, dsb=1.5401, bio=0.0000
    Epoch  9/10: total=2.6000, vae=1.0872, dsb=1.5128, bio=0.0000
    Epoch 10/10: total=2.6216, vae=1.0868, dsb=1.5347, bio=0.0000

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=100.4096, vae=1.0867, dsb=99.3229, bio=0.0000
    Epoch  2/10: total=94.1564, vae=1.0856, dsb=93.0708, bio=0.0000
    Epoch  3/10: total=92.1406, vae=1.0870, dsb=91.0536, bio=0.0000
    Epoch  4/10: total=91.6896, vae=1.0871, dsb=90.6025, bio=0.0000
    Epoch  5/10: total=91.3888, vae=1.0865, dsb=90.3023, bio=0.0000
    Epoch  6/10: total=90.6078, vae=1.0866, dsb=89.5212, bio=0.0000
    Epoch  7/10: total=90.2785, vae=1.0861, dsb=89.1924, bio=0.0000
    Epoch  8/10: total=89.6778, vae=1.0868, dsb=88.5910, bio=0.0000
    Epoch  9/10: total=89.3804, vae=1.0868, dsb=88.2936, bio=0.0000
    Epoch 10/10: total=89.0916, vae=1.0864, dsb=88.0052, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=2.3421, vae=1.0866, dsb=1.2554, bio=0.0000
    Epoch  2/10: total=2.2486, vae=1.0866, dsb=1.1620, bio=0.0000
    Epoch  3/10: total=2.2456, vae=1.0866, dsb=1.1590, bio=0.0000
    Epoch  4/10: total=2.1763, vae=1.0871, dsb=1.0892, bio=0.0000
    Epoch  5/10: total=2.1702, vae=1.0868, dsb=1.0833, bio=0.0000
    Epoch  6/10: total=2.1328, vae=1.0860, dsb=1.0468, bio=0.0000
    Epoch  7/10: total=2.1495, vae=1.0870, dsb=1.0625, bio=0.0000
    Epoch  8/10: total=2.1302, vae=1.0868, dsb=1.0434, bio=0.0000
    Epoch  9/10: total=2.1624, vae=1.0861, dsb=1.0763, bio=0.0000
    Epoch 10/10: total=2.1396, vae=1.0863, dsb=1.0533, bio=0.0000

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=81.7579, vae=1.0861, dsb=80.6718, bio=0.0000
    Epoch  2/10: total=79.3696, vae=1.0867, dsb=78.2829, bio=0.0000
    Epoch  3/10: total=78.6414, vae=1.0865, dsb=77.5549, bio=0.0000
    Epoch  4/10: total=78.2815, vae=1.0863, dsb=77.1953, bio=0.0000
    Epoch  5/10: total=78.0859, vae=1.0873, dsb=76.9986, bio=0.0000
    Epoch  6/10: total=77.7475, vae=1.0868, dsb=76.6607, bio=0.0000
    Epoch  7/10: total=77.6793, vae=1.0867, dsb=76.5926, bio=0.0000
    Epoch  8/10: total=77.0555, vae=1.0865, dsb=75.9691, bio=0.0000
    Epoch  9/10: total=77.2987, vae=1.0861, dsb=76.2127, bio=0.0000
    Epoch 10/10: total=77.0394, vae=1.0863, dsb=75.9531, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.9803, vae=1.0863, dsb=0.8940, bio=0.0000
    Epoch  2/10: total=1.9220, vae=1.0863, dsb=0.8357, bio=0.0000
    Epoch  3/10: total=1.9327, vae=1.0868, dsb=0.8460, bio=0.0000
    Epoch  4/10: total=1.8922, vae=1.0864, dsb=0.8059, bio=0.0000
    Epoch  5/10: total=1.8920, vae=1.0863, dsb=0.8057, bio=0.0000
    Epoch  6/10: total=1.9008, vae=1.0860, dsb=0.8148, bio=0.0000
    Epoch  7/10: total=1.8771, vae=1.0868, dsb=0.7904, bio=0.0000
    Epoch  8/10: total=1.8626, vae=1.0868, dsb=0.7758, bio=0.0000
    Epoch  9/10: total=1.8691, vae=1.0867, dsb=0.7824, bio=0.0000
    Epoch 10/10: total=1.8722, vae=1.0867, dsb=0.7855, bio=0.0000

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=66.7168, vae=1.0870, dsb=65.6297, bio=0.0000
    Epoch  2/10: total=65.8798, vae=1.0859, dsb=64.7940, bio=0.0000
    Epoch  3/10: total=65.4052, vae=1.0869, dsb=64.3183, bio=0.0000
    Epoch  4/10: total=65.4515, vae=1.0869, dsb=64.3646, bio=0.0000
    Epoch  5/10: total=65.1627, vae=1.0864, dsb=64.0763, bio=0.0000
    Epoch  6/10: total=64.8161, vae=1.0868, dsb=63.7293, bio=0.0000
    Epoch  7/10: total=64.7641, vae=1.0861, dsb=63.6781, bio=0.0000
    Epoch  8/10: total=64.4580, vae=1.0860, dsb=63.3720, bio=0.0000
    Epoch  9/10: total=64.6502, vae=1.0864, dsb=63.5638, bio=0.0000
    Epoch 10/10: total=64.7533, vae=1.0867, dsb=63.6666, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.7793, vae=1.0871, dsb=0.6922, bio=0.0000
    Epoch  2/10: total=1.7523, vae=1.0863, dsb=0.6661, bio=0.0000
    Epoch  3/10: total=1.7612, vae=1.0863, dsb=0.6749, bio=0.0000
    Epoch  4/10: total=1.7364, vae=1.0868, dsb=0.6496, bio=0.0000
    Epoch  5/10: total=1.7549, vae=1.0864, dsb=0.6686, bio=0.0000
    Epoch  6/10: total=1.7427, vae=1.0858, dsb=0.6570, bio=0.0000
    Epoch  7/10: total=1.7365, vae=1.0864, dsb=0.6501, bio=0.0000
    Epoch  8/10: total=1.7510, vae=1.0864, dsb=0.6646, bio=0.0000
    Epoch  9/10: total=1.7296, vae=1.0867, dsb=0.6429, bio=0.0000
    Epoch 10/10: total=1.7300, vae=1.0866, dsb=0.6434, bio=0.0000

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=54.7663, vae=1.0862, dsb=53.6800, bio=0.0000
    Epoch  2/10: total=54.1114, vae=1.0870, dsb=53.0244, bio=0.0000
    Epoch  3/10: total=53.9901, vae=1.0864, dsb=52.9036, bio=0.0000
    Epoch  4/10: total=54.0262, vae=1.0867, dsb=52.9395, bio=0.0000
    Epoch  5/10: total=54.1095, vae=1.0861, dsb=53.0234, bio=0.0000
    Epoch  6/10: total=54.2490, vae=1.0860, dsb=53.1630, bio=0.0000
    Epoch  7/10: total=53.9504, vae=1.0868, dsb=52.8636, bio=0.0000
    Epoch  8/10: total=54.0599, vae=1.0855, dsb=52.9744, bio=0.0000
    Epoch  9/10: total=54.1115, vae=1.0857, dsb=53.0259, bio=0.0000
    Epoch 10/10: total=54.0881, vae=1.0855, dsb=53.0026, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.6817, vae=1.0872, dsb=0.5945, bio=0.0000
    Epoch  2/10: total=1.6644, vae=1.0867, dsb=0.5777, bio=0.0000
    Epoch  3/10: total=1.6545, vae=1.0862, dsb=0.5683, bio=0.0000
    Epoch  4/10: total=1.6644, vae=1.0868, dsb=0.5776, bio=0.0000
    Epoch  5/10: total=1.6597, vae=1.0872, dsb=0.5725, bio=0.0000
    Epoch  6/10: total=1.6578, vae=1.0868, dsb=0.5709, bio=0.0000
    Epoch  7/10: total=1.6609, vae=1.0864, dsb=0.5745, bio=0.0000
    Epoch  8/10: total=1.6623, vae=1.0877, dsb=0.5746, bio=0.0000
    Epoch  9/10: total=1.6429, vae=1.0855, dsb=0.5574, bio=0.0000
    Epoch 10/10: total=1.6595, vae=1.0874, dsb=0.5721, bio=0.0000

[Seed 34] Joint training (ablation) complete; models and history saved.

[Seed 34] Drift genes saved in /home/yyuan/ICB_TCE/iter_results/run_034

[Seed 34] run finished.

================================================================================
[Seed 35] Starting running whole pipeline...
================================================================================

[Seed 35] Starting VAE pre-training...

    Epoch [01/20], Beta: 0.000, Average Loss: 537.6695
    Epoch [02/20], Beta: 0.000, Average Loss: 307.9636
    Epoch [03/20], Beta: 0.000, Average Loss: 270.0766
    Epoch [04/20], Beta: 0.000, Average Loss: 249.9438
    Epoch [05/20], Beta: 0.100, Average Loss: 245.3702
    Epoch [06/20], Beta: 0.200, Average Loss: 244.4001
    Epoch [07/20], Beta: 0.300, Average Loss: 244.6513
    Epoch [08/20], Beta: 0.400, Average Loss: 245.4101
    Epoch [09/20], Beta: 0.500, Average Loss: 246.5520
    Epoch [10/20], Beta: 0.600, Average Loss: 247.7736
    Epoch [11/20], Beta: 0.700, Average Loss: 249.0547
    Epoch [12/20], Beta: 0.800, Average Loss: 250.2826
    Epoch [13/20], Beta: 0.900, Average Loss: 251.5682
    Epoch [14/20], Beta: 1.000, Average Loss: 253.1797
    Epoch [15/20], Beta: 1.000, Average Loss: 252.7949
    Epoch [16/20], Beta: 1.000, Average Loss: 252.4081
    Epoch [17/20], Beta: 1.000, Average Loss: 252.0624
    Epoch [18/20], Beta: 1.000, Average Loss: 251.7418
    Epoch [19/20], Beta: 1.000, Average Loss: 251.4107
    Epoch [20/20], Beta: 1.000, Average Loss: 251.2713

[Seed 35] VAE pre-training complete.

[Seed 35] Starting joint training (original)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=291.1443, vae=3.6006, dsb=268.4845, bio=38.1183
    Epoch  2/10: total=90.4313, vae=1.1001, dsb=89.3000, bio=0.0623
    Epoch  3/10: total=80.1175, vae=1.0954, dsb=79.0081, bio=0.0280
    Epoch  4/10: total=75.3003, vae=1.0945, dsb=74.1972, bio=0.0170
    Epoch  5/10: total=72.4810, vae=1.0929, dsb=71.3824, bio=0.0115
    Epoch  6/10: total=70.3352, vae=1.0923, dsb=69.2386, bio=0.0086
    Epoch  7/10: total=68.6686, vae=1.0914, dsb=67.5737, bio=0.0068
    Epoch  8/10: total=67.6474, vae=1.0913, dsb=66.5532, bio=0.0057
    Epoch  9/10: total=66.6491, vae=1.0909, dsb=65.5558, bio=0.0048
    Epoch 10/10: total=65.8091, vae=1.0902, dsb=64.7168, bio=0.0043

  [Backward Policy Training]
    Epoch  1/10: total=3.4351, vae=1.0922, dsb=2.3345, bio=0.0170
    Epoch  2/10: total=2.8991, vae=1.0900, dsb=1.8066, bio=0.0051
    Epoch  3/10: total=2.7314, vae=1.0900, dsb=1.6395, bio=0.0036
    Epoch  4/10: total=2.6599, vae=1.0899, dsb=1.5686, bio=0.0030
    Epoch  5/10: total=2.5985, vae=1.0892, dsb=1.5078, bio=0.0030
    Epoch  6/10: total=2.5745, vae=1.0899, dsb=1.4833, bio=0.0024
    Epoch  7/10: total=2.5968, vae=1.0884, dsb=1.5073, bio=0.0023
    Epoch  8/10: total=2.5566, vae=1.0887, dsb=1.4669, bio=0.0022
    Epoch  9/10: total=2.5242, vae=1.0883, dsb=1.4349, bio=0.0021
    Epoch 10/10: total=2.5289, vae=1.0891, dsb=1.4388, bio=0.0019

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=63.1326, vae=1.0912, dsb=62.0395, bio=0.0036
    Epoch  2/10: total=56.8353, vae=1.0903, dsb=55.7439, bio=0.0020
    Epoch  3/10: total=55.3096, vae=1.0902, dsb=54.2185, bio=0.0019
    Epoch  4/10: total=54.4291, vae=1.0894, dsb=53.3387, bio=0.0019
    Epoch  5/10: total=53.8342, vae=1.0895, dsb=52.7437, bio=0.0019
    Epoch  6/10: total=53.6462, vae=1.0894, dsb=52.5558, bio=0.0019
    Epoch  7/10: total=53.1839, vae=1.0896, dsb=52.0936, bio=0.0016
    Epoch  8/10: total=52.6068, vae=1.0887, dsb=51.5171, bio=0.0021
    Epoch  9/10: total=52.6403, vae=1.0892, dsb=51.5501, bio=0.0019
    Epoch 10/10: total=52.5792, vae=1.0904, dsb=51.4879, bio=0.0019

  [Backward Policy Training]
    Epoch  1/10: total=2.2476, vae=1.0888, dsb=1.1562, bio=0.0052
    Epoch  2/10: total=2.1236, vae=1.0877, dsb=1.0349, bio=0.0020
    Epoch  3/10: total=2.0729, vae=1.0875, dsb=0.9845, bio=0.0018
    Epoch  4/10: total=2.0714, vae=1.0875, dsb=0.9830, bio=0.0018
    Epoch  5/10: total=2.0322, vae=1.0878, dsb=0.9434, bio=0.0018
    Epoch  6/10: total=2.0522, vae=1.0877, dsb=0.9636, bio=0.0018
    Epoch  7/10: total=2.0153, vae=1.0877, dsb=0.9268, bio=0.0017
    Epoch  8/10: total=2.0181, vae=1.0880, dsb=0.9293, bio=0.0017
    Epoch  9/10: total=2.0057, vae=1.0876, dsb=0.9173, bio=0.0016
    Epoch 10/10: total=2.0124, vae=1.0881, dsb=0.9236, bio=0.0016

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=47.3588, vae=1.0914, dsb=46.2657, bio=0.0035
    Epoch  2/10: total=44.8621, vae=1.0899, dsb=43.7713, bio=0.0017
    Epoch  3/10: total=44.6125, vae=1.0880, dsb=43.5237, bio=0.0017
    Epoch  4/10: total=44.0939, vae=1.0886, dsb=43.0043, bio=0.0018
    Epoch  5/10: total=43.9083, vae=1.0891, dsb=42.8185, bio=0.0014
    Epoch  6/10: total=43.7066, vae=1.0894, dsb=42.6162, bio=0.0019
    Epoch  7/10: total=43.4139, vae=1.0884, dsb=42.3247, bio=0.0017
    Epoch  8/10: total=43.5338, vae=1.0874, dsb=42.4455, bio=0.0017
    Epoch  9/10: total=43.5344, vae=1.0876, dsb=42.4460, bio=0.0017
    Epoch 10/10: total=43.3257, vae=1.0879, dsb=42.2370, bio=0.0017

  [Backward Policy Training]
    Epoch  1/10: total=1.8971, vae=1.0899, dsb=0.8031, bio=0.0083
    Epoch  2/10: total=1.8734, vae=1.0882, dsb=0.7844, bio=0.0017
    Epoch  3/10: total=1.8374, vae=1.0880, dsb=0.7486, bio=0.0016
    Epoch  4/10: total=1.8233, vae=1.0879, dsb=0.7347, bio=0.0015
    Epoch  5/10: total=1.8009, vae=1.0869, dsb=0.7133, bio=0.0016
    Epoch  6/10: total=1.7960, vae=1.0869, dsb=0.7083, bio=0.0015
    Epoch  7/10: total=1.7958, vae=1.0874, dsb=0.7077, bio=0.0015
    Epoch  8/10: total=1.8276, vae=1.0866, dsb=0.7402, bio=0.0015
    Epoch  9/10: total=1.8121, vae=1.0876, dsb=0.7238, bio=0.0015
    Epoch 10/10: total=1.8007, vae=1.0863, dsb=0.7136, bio=0.0014

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=38.9475, vae=1.0902, dsb=37.8558, bio=0.0030
    Epoch  2/10: total=37.9800, vae=1.0884, dsb=36.8909, bio=0.0015
    Epoch  3/10: total=37.7044, vae=1.0884, dsb=36.6153, bio=0.0015
    Epoch  4/10: total=37.6615, vae=1.0890, dsb=36.5717, bio=0.0015
    Epoch  5/10: total=37.6105, vae=1.0881, dsb=36.5216, bio=0.0015
    Epoch  6/10: total=37.3608, vae=1.0883, dsb=36.2717, bio=0.0016
    Epoch  7/10: total=37.3950, vae=1.0879, dsb=36.3062, bio=0.0019
    Epoch  8/10: total=37.3604, vae=1.0885, dsb=36.2712, bio=0.0015
    Epoch  9/10: total=37.3862, vae=1.0890, dsb=36.2964, bio=0.0015
    Epoch 10/10: total=37.4915, vae=1.0880, dsb=36.4028, bio=0.0015

  [Backward Policy Training]
    Epoch  1/10: total=1.7273, vae=1.0882, dsb=0.6257, bio=0.0269
    Epoch  2/10: total=1.6851, vae=1.0877, dsb=0.5966, bio=0.0016
    Epoch  3/10: total=1.6671, vae=1.0871, dsb=0.5793, bio=0.0014
    Epoch  4/10: total=1.6920, vae=1.0871, dsb=0.6042, bio=0.0014
    Epoch  5/10: total=1.6847, vae=1.0865, dsb=0.5976, bio=0.0013
    Epoch  6/10: total=1.6710, vae=1.0867, dsb=0.5835, bio=0.0014
    Epoch  7/10: total=1.6571, vae=1.0868, dsb=0.5696, bio=0.0013
    Epoch  8/10: total=1.6668, vae=1.0865, dsb=0.5797, bio=0.0012
    Epoch  9/10: total=1.6689, vae=1.0870, dsb=0.5813, bio=0.0012
    Epoch 10/10: total=1.6764, vae=1.0859, dsb=0.5899, bio=0.0013

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=33.3259, vae=1.0898, dsb=32.2343, bio=0.0036
    Epoch  2/10: total=32.9047, vae=1.0887, dsb=31.8152, bio=0.0015
    Epoch  3/10: total=32.6926, vae=1.0886, dsb=31.6033, bio=0.0013
    Epoch  4/10: total=32.7925, vae=1.0885, dsb=31.7033, bio=0.0013
    Epoch  5/10: total=32.6015, vae=1.0876, dsb=31.5131, bio=0.0014
    Epoch  6/10: total=32.5709, vae=1.0879, dsb=31.4823, bio=0.0014
    Epoch  7/10: total=32.7040, vae=1.0870, dsb=31.6163, bio=0.0013
    Epoch  8/10: total=32.8985, vae=1.0877, dsb=31.8101, bio=0.0014
    Epoch  9/10: total=32.7346, vae=1.0883, dsb=31.6456, bio=0.0013
    Epoch 10/10: total=32.5652, vae=1.0870, dsb=31.4776, bio=0.0012

  [Backward Policy Training]
    Epoch  1/10: total=1.6444, vae=1.0876, dsb=0.5378, bio=0.0379
    Epoch  2/10: total=1.6150, vae=1.0868, dsb=0.5275, bio=0.0014
    Epoch  3/10: total=1.6103, vae=1.0867, dsb=0.5229, bio=0.0013
    Epoch  4/10: total=1.6031, vae=1.0860, dsb=0.5163, bio=0.0013
    Epoch  5/10: total=1.6036, vae=1.0860, dsb=0.5170, bio=0.0011
    Epoch  6/10: total=1.6003, vae=1.0864, dsb=0.5133, bio=0.0011
    Epoch  7/10: total=1.6177, vae=1.0867, dsb=0.5305, bio=0.0011
    Epoch  8/10: total=1.6091, vae=1.0862, dsb=0.5224, bio=0.0011
    Epoch  9/10: total=1.6141, vae=1.0853, dsb=0.5282, bio=0.0010
    Epoch 10/10: total=1.6088, vae=1.0860, dsb=0.5223, bio=0.0011

[Seed 35] Joint training (original) complete; models and history saved.

[Seed 35] Starting joint training (ablation)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=269.8904, vae=2.0005, dsb=267.8899, bio=0.0000
    Epoch  2/10: total=89.6507, vae=1.0832, dsb=88.5675, bio=0.0000
    Epoch  3/10: total=79.2860, vae=1.0811, dsb=78.2049, bio=0.0000
    Epoch  4/10: total=74.6307, vae=1.0812, dsb=73.5496, bio=0.0000
    Epoch  5/10: total=71.9554, vae=1.0800, dsb=70.8754, bio=0.0000
    Epoch  6/10: total=69.9305, vae=1.0798, dsb=68.8508, bio=0.0000
    Epoch  7/10: total=68.3032, vae=1.0792, dsb=67.2240, bio=0.0000
    Epoch  8/10: total=67.3022, vae=1.0793, dsb=66.2229, bio=0.0000
    Epoch  9/10: total=66.2875, vae=1.0793, dsb=65.2083, bio=0.0000
    Epoch 10/10: total=65.4355, vae=1.0788, dsb=64.3567, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=3.3102, vae=1.0794, dsb=2.2307, bio=0.0000
    Epoch  2/10: total=2.8017, vae=1.0792, dsb=1.7226, bio=0.0000
    Epoch  3/10: total=2.6444, vae=1.0796, dsb=1.5648, bio=0.0000
    Epoch  4/10: total=2.5770, vae=1.0797, dsb=1.4974, bio=0.0000
    Epoch  5/10: total=2.5217, vae=1.0792, dsb=1.4425, bio=0.0000
    Epoch  6/10: total=2.5002, vae=1.0801, dsb=1.4201, bio=0.0000
    Epoch  7/10: total=2.5237, vae=1.0787, dsb=1.4450, bio=0.0000
    Epoch  8/10: total=2.4864, vae=1.0790, dsb=1.4073, bio=0.0000
    Epoch  9/10: total=2.4563, vae=1.0788, dsb=1.3775, bio=0.0000
    Epoch 10/10: total=2.4609, vae=1.0797, dsb=1.3813, bio=0.0000

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=62.4192, vae=1.0792, dsb=61.3400, bio=0.0000
    Epoch  2/10: total=56.0870, vae=1.0794, dsb=55.0076, bio=0.0000
    Epoch  3/10: total=54.6489, vae=1.0796, dsb=53.5693, bio=0.0000
    Epoch  4/10: total=53.8162, vae=1.0790, dsb=52.7373, bio=0.0000
    Epoch  5/10: total=53.2561, vae=1.0791, dsb=52.1770, bio=0.0000
    Epoch  6/10: total=53.0771, vae=1.0790, dsb=51.9980, bio=0.0000
    Epoch  7/10: total=52.6082, vae=1.0793, dsb=51.5289, bio=0.0000
    Epoch  8/10: total=52.0528, vae=1.0786, dsb=50.9742, bio=0.0000
    Epoch  9/10: total=52.1011, vae=1.0792, dsb=51.0219, bio=0.0000
    Epoch 10/10: total=52.0280, vae=1.0804, dsb=50.9476, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=2.1789, vae=1.0785, dsb=1.1004, bio=0.0000
    Epoch  2/10: total=2.0613, vae=1.0786, dsb=0.9826, bio=0.0000
    Epoch  3/10: total=2.0130, vae=1.0785, dsb=0.9344, bio=0.0000
    Epoch  4/10: total=2.0106, vae=1.0786, dsb=0.9320, bio=0.0000
    Epoch  5/10: total=1.9714, vae=1.0790, dsb=0.8925, bio=0.0000
    Epoch  6/10: total=1.9905, vae=1.0791, dsb=0.9115, bio=0.0000
    Epoch  7/10: total=1.9542, vae=1.0790, dsb=0.8752, bio=0.0000
    Epoch  8/10: total=1.9564, vae=1.0793, dsb=0.8771, bio=0.0000
    Epoch  9/10: total=1.9442, vae=1.0790, dsb=0.8652, bio=0.0000
    Epoch 10/10: total=1.9511, vae=1.0795, dsb=0.8715, bio=0.0000

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=46.0808, vae=1.0798, dsb=45.0009, bio=0.0000
    Epoch  2/10: total=43.6681, vae=1.0799, dsb=42.5882, bio=0.0000
    Epoch  3/10: total=43.4429, vae=1.0782, dsb=42.3647, bio=0.0000
    Epoch  4/10: total=42.9762, vae=1.0790, dsb=41.8972, bio=0.0000
    Epoch  5/10: total=42.8001, vae=1.0794, dsb=41.7207, bio=0.0000
    Epoch  6/10: total=42.5769, vae=1.0799, dsb=41.4969, bio=0.0000
    Epoch  7/10: total=42.2944, vae=1.0790, dsb=41.2155, bio=0.0000
    Epoch  8/10: total=42.4697, vae=1.0781, dsb=41.3915, bio=0.0000
    Epoch  9/10: total=42.4196, vae=1.0783, dsb=41.3413, bio=0.0000
    Epoch 10/10: total=42.2399, vae=1.0787, dsb=41.1612, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.8431, vae=1.0802, dsb=0.7629, bio=0.0000
    Epoch  2/10: total=1.8240, vae=1.0797, dsb=0.7443, bio=0.0000
    Epoch  3/10: total=1.7897, vae=1.0796, dsb=0.7101, bio=0.0000
    Epoch  4/10: total=1.7762, vae=1.0795, dsb=0.6967, bio=0.0000
    Epoch  5/10: total=1.7554, vae=1.0786, dsb=0.6768, bio=0.0000
    Epoch  6/10: total=1.7510, vae=1.0787, dsb=0.6723, bio=0.0000
    Epoch  7/10: total=1.7509, vae=1.0792, dsb=0.6717, bio=0.0000
    Epoch  8/10: total=1.7817, vae=1.0784, dsb=0.7033, bio=0.0000
    Epoch  9/10: total=1.7668, vae=1.0795, dsb=0.6873, bio=0.0000
    Epoch 10/10: total=1.7567, vae=1.0783, dsb=0.6784, bio=0.0000

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=38.3302, vae=1.0792, dsb=37.2510, bio=0.0000
    Epoch  2/10: total=37.2880, vae=1.0788, dsb=36.2091, bio=0.0000
    Epoch  3/10: total=37.0531, vae=1.0791, dsb=35.9741, bio=0.0000
    Epoch  4/10: total=36.9968, vae=1.0799, dsb=35.9169, bio=0.0000
    Epoch  5/10: total=36.9623, vae=1.0790, dsb=35.8833, bio=0.0000
    Epoch  6/10: total=36.7254, vae=1.0793, dsb=35.6461, bio=0.0000
    Epoch  7/10: total=36.7526, vae=1.0790, dsb=35.6737, bio=0.0000
    Epoch  8/10: total=36.7060, vae=1.0797, dsb=35.6263, bio=0.0000
    Epoch  9/10: total=36.7713, vae=1.0802, dsb=35.6911, bio=0.0000
    Epoch 10/10: total=36.8686, vae=1.0793, dsb=35.7893, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.6512, vae=1.0789, dsb=0.5723, bio=0.0000
    Epoch  2/10: total=1.6235, vae=1.0795, dsb=0.5440, bio=0.0000
    Epoch  3/10: total=1.6067, vae=1.0791, dsb=0.5276, bio=0.0000
    Epoch  4/10: total=1.6304, vae=1.0792, dsb=0.5512, bio=0.0000
    Epoch  5/10: total=1.6239, vae=1.0787, dsb=0.5452, bio=0.0000
    Epoch  6/10: total=1.6107, vae=1.0789, dsb=0.5318, bio=0.0000
    Epoch  7/10: total=1.5975, vae=1.0790, dsb=0.5185, bio=0.0000
    Epoch  8/10: total=1.6073, vae=1.0789, dsb=0.5284, bio=0.0000
    Epoch  9/10: total=1.6093, vae=1.0794, dsb=0.5298, bio=0.0000
    Epoch 10/10: total=1.6162, vae=1.0784, dsb=0.5378, bio=0.0000

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=32.2556, vae=1.0791, dsb=31.1766, bio=0.0000
    Epoch  2/10: total=31.8353, vae=1.0794, dsb=30.7560, bio=0.0000
    Epoch  3/10: total=31.6322, vae=1.0794, dsb=30.5528, bio=0.0000
    Epoch  4/10: total=31.7652, vae=1.0796, dsb=30.6857, bio=0.0000
    Epoch  5/10: total=31.5781, vae=1.0788, dsb=30.4993, bio=0.0000
    Epoch  6/10: total=31.5661, vae=1.0792, dsb=30.4868, bio=0.0000
    Epoch  7/10: total=31.6620, vae=1.0784, dsb=30.5837, bio=0.0000
    Epoch  8/10: total=31.8754, vae=1.0791, dsb=30.7963, bio=0.0000
    Epoch  9/10: total=31.7452, vae=1.0799, dsb=30.6653, bio=0.0000
    Epoch 10/10: total=31.5479, vae=1.0787, dsb=30.4692, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.5655, vae=1.0786, dsb=0.4869, bio=0.0000
    Epoch  2/10: total=1.5555, vae=1.0790, dsb=0.4765, bio=0.0000
    Epoch  3/10: total=1.5512, vae=1.0791, dsb=0.4721, bio=0.0000
    Epoch  4/10: total=1.5443, vae=1.0786, dsb=0.4656, bio=0.0000
    Epoch  5/10: total=1.5452, vae=1.0787, dsb=0.4665, bio=0.0000
    Epoch  6/10: total=1.5419, vae=1.0792, dsb=0.4628, bio=0.0000
    Epoch  7/10: total=1.5585, vae=1.0795, dsb=0.4790, bio=0.0000
    Epoch  8/10: total=1.5504, vae=1.0791, dsb=0.4713, bio=0.0000
    Epoch  9/10: total=1.5551, vae=1.0784, dsb=0.4767, bio=0.0000
    Epoch 10/10: total=1.5503, vae=1.0791, dsb=0.4711, bio=0.0000

[Seed 35] Joint training (ablation) complete; models and history saved.

[Seed 35] Drift genes saved in /home/yyuan/ICB_TCE/iter_results/run_035

[Seed 35] run finished.

================================================================================
[Seed 36] Starting running whole pipeline...
================================================================================

[Seed 36] Starting VAE pre-training...

    Epoch [01/20], Beta: 0.000, Average Loss: 537.1584
    Epoch [02/20], Beta: 0.000, Average Loss: 307.0063
    Epoch [03/20], Beta: 0.000, Average Loss: 268.7652
    Epoch [04/20], Beta: 0.000, Average Loss: 248.4118
    Epoch [05/20], Beta: 0.100, Average Loss: 244.4494
    Epoch [06/20], Beta: 0.200, Average Loss: 243.7716
    Epoch [07/20], Beta: 0.300, Average Loss: 244.0970
    Epoch [08/20], Beta: 0.400, Average Loss: 244.9432
    Epoch [09/20], Beta: 0.500, Average Loss: 245.9962
    Epoch [10/20], Beta: 0.600, Average Loss: 247.2633
    Epoch [11/20], Beta: 0.700, Average Loss: 248.5445
    Epoch [12/20], Beta: 0.800, Average Loss: 249.8820
    Epoch [13/20], Beta: 0.900, Average Loss: 251.1644
    Epoch [14/20], Beta: 1.000, Average Loss: 252.8661
    Epoch [15/20], Beta: 1.000, Average Loss: 252.4394
    Epoch [16/20], Beta: 1.000, Average Loss: 252.0309
    Epoch [17/20], Beta: 1.000, Average Loss: 251.7253
    Epoch [18/20], Beta: 1.000, Average Loss: 251.4390
    Epoch [19/20], Beta: 1.000, Average Loss: 251.0203
    Epoch [20/20], Beta: 1.000, Average Loss: 250.8395

[Seed 36] VAE pre-training complete.

[Seed 36] Starting joint training (original)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=1419.0255, vae=3.3422, dsb=1401.7312, bio=27.9042
    Epoch  2/10: total=487.3795, vae=1.1026, dsb=486.2440, bio=0.0658
    Epoch  3/10: total=472.7924, vae=1.0977, dsb=471.6797, bio=0.0299
    Epoch  4/10: total=471.7231, vae=1.0953, dsb=470.6189, bio=0.0178
    Epoch  5/10: total=469.2955, vae=1.0948, dsb=468.1945, bio=0.0125
    Epoch  6/10: total=471.1576, vae=1.0938, dsb=470.0591, bio=0.0094
    Epoch  7/10: total=467.7598, vae=1.0935, dsb=466.6626, bio=0.0075
    Epoch  8/10: total=463.2456, vae=1.0922, dsb=462.1503, bio=0.0063
    Epoch  9/10: total=464.2093, vae=1.0932, dsb=463.1134, bio=0.0054
    Epoch 10/10: total=461.5142, vae=1.0920, dsb=460.4199, bio=0.0047

  [Backward Policy Training]
    Epoch  1/10: total=4.5171, vae=1.0930, dsb=3.4130, bio=0.0223
    Epoch  2/10: total=4.0595, vae=1.0921, dsb=2.9641, bio=0.0066
    Epoch  3/10: total=3.8412, vae=1.0927, dsb=2.7462, bio=0.0046
    Epoch  4/10: total=3.7600, vae=1.0921, dsb=2.6661, bio=0.0036
    Epoch  5/10: total=3.6990, vae=1.0920, dsb=2.6055, bio=0.0030
    Epoch  6/10: total=3.7161, vae=1.0914, dsb=2.6232, bio=0.0029
    Epoch  7/10: total=3.6527, vae=1.0914, dsb=2.5601, bio=0.0023
    Epoch  8/10: total=3.7071, vae=1.0907, dsb=2.6154, bio=0.0022
    Epoch  9/10: total=3.6305, vae=1.0909, dsb=2.5386, bio=0.0020
    Epoch 10/10: total=3.6533, vae=1.0909, dsb=2.5614, bio=0.0019

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=386.8736, vae=1.0943, dsb=385.7773, bio=0.0041
    Epoch  2/10: total=382.2295, vae=1.0924, dsb=381.1361, bio=0.0020
    Epoch  3/10: total=381.6349, vae=1.0922, dsb=380.5417, bio=0.0020
    Epoch  4/10: total=380.9296, vae=1.0914, dsb=379.8373, bio=0.0019
    Epoch  5/10: total=383.7590, vae=1.0912, dsb=382.6669, bio=0.0018
    Epoch  6/10: total=380.7526, vae=1.0916, dsb=379.6601, bio=0.0018
    Epoch  7/10: total=378.9825, vae=1.0917, dsb=377.8899, bio=0.0018
    Epoch  8/10: total=378.6318, vae=1.0922, dsb=377.5387, bio=0.0018
    Epoch  9/10: total=380.7264, vae=1.0915, dsb=379.6340, bio=0.0018
    Epoch 10/10: total=379.0862, vae=1.0903, dsb=377.9949, bio=0.0018

  [Backward Policy Training]
    Epoch  1/10: total=3.2866, vae=1.0916, dsb=2.1919, bio=0.0061
    Epoch  2/10: total=3.2668, vae=1.0908, dsb=2.1750, bio=0.0019
    Epoch  3/10: total=3.1568, vae=1.0888, dsb=2.0671, bio=0.0017
    Epoch  4/10: total=3.2028, vae=1.0898, dsb=2.1120, bio=0.0020
    Epoch  5/10: total=3.1570, vae=1.0892, dsb=2.0670, bio=0.0016
    Epoch  6/10: total=3.1134, vae=1.0899, dsb=2.0227, bio=0.0015
    Epoch  7/10: total=3.1672, vae=1.0899, dsb=2.0766, bio=0.0015
    Epoch  8/10: total=3.0861, vae=1.0897, dsb=1.9957, bio=0.0015
    Epoch  9/10: total=3.1564, vae=1.0895, dsb=2.0662, bio=0.0015
    Epoch 10/10: total=3.1006, vae=1.0882, dsb=2.0117, bio=0.0014

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=327.0921, vae=1.0934, dsb=325.9969, bio=0.0037
    Epoch  2/10: total=327.3769, vae=1.0910, dsb=326.2851, bio=0.0015
    Epoch  3/10: total=325.3495, vae=1.0902, dsb=324.2585, bio=0.0015
    Epoch  4/10: total=326.7970, vae=1.0905, dsb=325.7057, bio=0.0015
    Epoch  5/10: total=328.8981, vae=1.0900, dsb=327.8074, bio=0.0014
    Epoch  6/10: total=324.3832, vae=1.0914, dsb=323.2911, bio=0.0014
    Epoch  7/10: total=327.0898, vae=1.0898, dsb=325.9993, bio=0.0014
    Epoch  8/10: total=326.0599, vae=1.0907, dsb=324.9686, bio=0.0014
    Epoch  9/10: total=328.0410, vae=1.0901, dsb=326.9502, bio=0.0014
    Epoch 10/10: total=325.9637, vae=1.0901, dsb=324.8730, bio=0.0014

  [Backward Policy Training]
    Epoch  1/10: total=2.8582, vae=1.0916, dsb=1.7630, bio=0.0074
    Epoch  2/10: total=2.8168, vae=1.0892, dsb=1.7267, bio=0.0017
    Epoch  3/10: total=2.9119, vae=1.0893, dsb=1.8218, bio=0.0016
    Epoch  4/10: total=2.8159, vae=1.0891, dsb=1.7262, bio=0.0013
    Epoch  5/10: total=2.7875, vae=1.0891, dsb=1.6977, bio=0.0013
    Epoch  6/10: total=2.8376, vae=1.0874, dsb=1.7495, bio=0.0013
    Epoch  7/10: total=2.7876, vae=1.0893, dsb=1.6976, bio=0.0013
    Epoch  8/10: total=2.7821, vae=1.0887, dsb=1.6927, bio=0.0014
    Epoch  9/10: total=2.8162, vae=1.0885, dsb=1.7270, bio=0.0012
    Epoch 10/10: total=2.8484, vae=1.0883, dsb=1.7596, bio=0.0012

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=280.9200, vae=1.0924, dsb=279.8255, bio=0.0041
    Epoch  2/10: total=279.6088, vae=1.0894, dsb=278.5188, bio=0.0012
    Epoch  3/10: total=278.1492, vae=1.0905, dsb=277.0581, bio=0.0012
    Epoch  4/10: total=277.3130, vae=1.0898, dsb=276.2226, bio=0.0012
    Epoch  5/10: total=278.5402, vae=1.0904, dsb=277.4492, bio=0.0012
    Epoch  6/10: total=280.3285, vae=1.0905, dsb=279.2373, bio=0.0016
    Epoch  7/10: total=278.0900, vae=1.0899, dsb=276.9995, bio=0.0012
    Epoch  8/10: total=279.7036, vae=1.0897, dsb=278.6133, bio=0.0012
    Epoch  9/10: total=278.8669, vae=1.0894, dsb=277.7769, bio=0.0011
    Epoch 10/10: total=278.3933, vae=1.0895, dsb=277.3033, bio=0.0009

  [Backward Policy Training]
    Epoch  1/10: total=2.6759, vae=1.0904, dsb=1.5802, bio=0.0107
    Epoch  2/10: total=2.6284, vae=1.0890, dsb=1.5387, bio=0.0014
    Epoch  3/10: total=2.6110, vae=1.0886, dsb=1.5217, bio=0.0012
    Epoch  4/10: total=2.6404, vae=1.0892, dsb=1.5507, bio=0.0011
    Epoch  5/10: total=2.6765, vae=1.0883, dsb=1.5877, bio=0.0011
    Epoch  6/10: total=2.6080, vae=1.0886, dsb=1.5189, bio=0.0011
    Epoch  7/10: total=2.6297, vae=1.0882, dsb=1.5410, bio=0.0011
    Epoch  8/10: total=2.6715, vae=1.0885, dsb=1.5824, bio=0.0010
    Epoch  9/10: total=2.5935, vae=1.0885, dsb=1.5044, bio=0.0011
    Epoch 10/10: total=2.5984, vae=1.0879, dsb=1.5100, bio=0.0009

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=233.0753, vae=1.0917, dsb=231.9809, bio=0.0055
    Epoch  2/10: total=231.6365, vae=1.0897, dsb=230.5464, bio=0.0010
    Epoch  3/10: total=232.5165, vae=1.0895, dsb=231.4264, bio=0.0010
    Epoch  4/10: total=232.8559, vae=1.0900, dsb=231.7654, bio=0.0010
    Epoch  5/10: total=231.6646, vae=1.0890, dsb=230.5754, bio=0.0006
    Epoch  6/10: total=231.5956, vae=1.0897, dsb=230.5056, bio=0.0006
    Epoch  7/10: total=233.6106, vae=1.0897, dsb=232.5203, bio=0.0013
    Epoch  8/10: total=232.9545, vae=1.0891, dsb=231.8648, bio=0.0011
    Epoch  9/10: total=230.8058, vae=1.0888, dsb=229.7165, bio=0.0011
    Epoch 10/10: total=233.8018, vae=1.0897, dsb=232.7117, bio=0.0009

  [Backward Policy Training]
    Epoch  1/10: total=2.5240, vae=1.0903, dsb=1.4167, bio=0.0342
    Epoch  2/10: total=2.4200, vae=1.0887, dsb=1.3307, bio=0.0012
    Epoch  3/10: total=2.4939, vae=1.0883, dsb=1.4052, bio=0.0009
    Epoch  4/10: total=2.5031, vae=1.0870, dsb=1.4157, bio=0.0009
    Epoch  5/10: total=2.4763, vae=1.0883, dsb=1.3876, bio=0.0010
    Epoch  6/10: total=2.4632, vae=1.0879, dsb=1.3749, bio=0.0009
    Epoch  7/10: total=2.4655, vae=1.0878, dsb=1.3772, bio=0.0009
    Epoch  8/10: total=2.4645, vae=1.0881, dsb=1.3760, bio=0.0009
    Epoch  9/10: total=2.4292, vae=1.0873, dsb=1.3415, bio=0.0009
    Epoch 10/10: total=2.4561, vae=1.0872, dsb=1.3684, bio=0.0010

[Seed 36] Joint training (original) complete; models and history saved.

[Seed 36] Starting joint training (ablation)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=1402.1241, vae=1.9806, dsb=1400.1435, bio=0.0000
    Epoch  2/10: total=485.4961, vae=1.0856, dsb=484.4105, bio=0.0000
    Epoch  3/10: total=471.7616, vae=1.0838, dsb=470.6778, bio=0.0000
    Epoch  4/10: total=470.8312, vae=1.0823, dsb=469.7489, bio=0.0000
    Epoch  5/10: total=468.4486, vae=1.0822, dsb=467.3664, bio=0.0000
    Epoch  6/10: total=470.4268, vae=1.0814, dsb=469.3454, bio=0.0000
    Epoch  7/10: total=467.0814, vae=1.0814, dsb=466.0000, bio=0.0000
    Epoch  8/10: total=462.6932, vae=1.0804, dsb=461.6128, bio=0.0000
    Epoch  9/10: total=463.6310, vae=1.0816, dsb=462.5494, bio=0.0000
    Epoch 10/10: total=460.9949, vae=1.0806, dsb=459.9142, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=4.2035, vae=1.0804, dsb=3.1232, bio=0.0000
    Epoch  2/10: total=3.7786, vae=1.0811, dsb=2.6975, bio=0.0000
    Epoch  3/10: total=3.5759, vae=1.0822, dsb=2.4937, bio=0.0000
    Epoch  4/10: total=3.4984, vae=1.0820, dsb=2.4164, bio=0.0000
    Epoch  5/10: total=3.4468, vae=1.0821, dsb=2.3647, bio=0.0000
    Epoch  6/10: total=3.4641, vae=1.0815, dsb=2.3827, bio=0.0000
    Epoch  7/10: total=3.4048, vae=1.0818, dsb=2.3230, bio=0.0000
    Epoch  8/10: total=3.4567, vae=1.0810, dsb=2.3757, bio=0.0000
    Epoch  9/10: total=3.3859, vae=1.0815, dsb=2.3044, bio=0.0000
    Epoch 10/10: total=3.4090, vae=1.0816, dsb=2.3275, bio=0.0000

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=389.1013, vae=1.0818, dsb=388.0195, bio=0.0000
    Epoch  2/10: total=384.9615, vae=1.0815, dsb=383.8800, bio=0.0000
    Epoch  3/10: total=384.1668, vae=1.0814, dsb=383.0853, bio=0.0000
    Epoch  4/10: total=383.6847, vae=1.0809, dsb=382.6038, bio=0.0000
    Epoch  5/10: total=386.5050, vae=1.0808, dsb=385.4242, bio=0.0000
    Epoch  6/10: total=383.5383, vae=1.0812, dsb=382.4571, bio=0.0000
    Epoch  7/10: total=381.6753, vae=1.0814, dsb=380.5939, bio=0.0000
    Epoch  8/10: total=381.8054, vae=1.0820, dsb=380.7234, bio=0.0000
    Epoch  9/10: total=383.5853, vae=1.0814, dsb=382.5038, bio=0.0000
    Epoch 10/10: total=382.0671, vae=1.0803, dsb=380.9867, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=3.0463, vae=1.0810, dsb=1.9653, bio=0.0000
    Epoch  2/10: total=3.0382, vae=1.0817, dsb=1.9566, bio=0.0000
    Epoch  3/10: total=2.9427, vae=1.0799, dsb=1.8627, bio=0.0000
    Epoch  4/10: total=2.9867, vae=1.0810, dsb=1.9058, bio=0.0000
    Epoch  5/10: total=2.9466, vae=1.0805, dsb=1.8660, bio=0.0000
    Epoch  6/10: total=2.9079, vae=1.0813, dsb=1.8266, bio=0.0000
    Epoch  7/10: total=2.9592, vae=1.0813, dsb=1.8779, bio=0.0000
    Epoch  8/10: total=2.8846, vae=1.0811, dsb=1.8035, bio=0.0000
    Epoch  9/10: total=2.9516, vae=1.0811, dsb=1.8705, bio=0.0000
    Epoch 10/10: total=2.9005, vae=1.0798, dsb=1.8208, bio=0.0000

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=327.3827, vae=1.0818, dsb=326.3008, bio=0.0000
    Epoch  2/10: total=327.8096, vae=1.0811, dsb=326.7285, bio=0.0000
    Epoch  3/10: total=325.8182, vae=1.0805, dsb=324.7377, bio=0.0000
    Epoch  4/10: total=327.4320, vae=1.0809, dsb=326.3511, bio=0.0000
    Epoch  5/10: total=329.3534, vae=1.0804, dsb=328.2730, bio=0.0000
    Epoch  6/10: total=324.9487, vae=1.0820, dsb=323.8667, bio=0.0000
    Epoch  7/10: total=327.5619, vae=1.0805, dsb=326.4814, bio=0.0000
    Epoch  8/10: total=326.5697, vae=1.0813, dsb=325.4884, bio=0.0000
    Epoch  9/10: total=328.6083, vae=1.0808, dsb=327.5275, bio=0.0000
    Epoch 10/10: total=326.4390, vae=1.0809, dsb=325.3582, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=2.6724, vae=1.0816, dsb=1.5908, bio=0.0000
    Epoch  2/10: total=2.6450, vae=1.0809, dsb=1.5641, bio=0.0000
    Epoch  3/10: total=2.7375, vae=1.0812, dsb=1.6563, bio=0.0000
    Epoch  4/10: total=2.6501, vae=1.0811, dsb=1.5690, bio=0.0000
    Epoch  5/10: total=2.6244, vae=1.0813, dsb=1.5431, bio=0.0000
    Epoch  6/10: total=2.6722, vae=1.0797, dsb=1.5925, bio=0.0000
    Epoch  7/10: total=2.6267, vae=1.0817, dsb=1.5450, bio=0.0000
    Epoch  8/10: total=2.6220, vae=1.0811, dsb=1.5409, bio=0.0000
    Epoch  9/10: total=2.6544, vae=1.0811, dsb=1.5732, bio=0.0000
    Epoch 10/10: total=2.6856, vae=1.0810, dsb=1.6046, bio=0.0000

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=287.1679, vae=1.0818, dsb=286.0861, bio=0.0000
    Epoch  2/10: total=285.9167, vae=1.0800, dsb=284.8367, bio=0.0000
    Epoch  3/10: total=284.3765, vae=1.0814, dsb=283.2951, bio=0.0000
    Epoch  4/10: total=283.4934, vae=1.0808, dsb=282.4126, bio=0.0000
    Epoch  5/10: total=284.6481, vae=1.0814, dsb=283.5667, bio=0.0000
    Epoch  6/10: total=286.4615, vae=1.0815, dsb=285.3799, bio=0.0000
    Epoch  7/10: total=284.3163, vae=1.0810, dsb=283.2353, bio=0.0000
    Epoch  8/10: total=285.9642, vae=1.0809, dsb=284.8833, bio=0.0000
    Epoch  9/10: total=285.0661, vae=1.0807, dsb=283.9854, bio=0.0000
    Epoch 10/10: total=284.4424, vae=1.0807, dsb=283.3617, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=2.5143, vae=1.0815, dsb=1.4328, bio=0.0000
    Epoch  2/10: total=2.4797, vae=1.0812, dsb=1.3986, bio=0.0000
    Epoch  3/10: total=2.4652, vae=1.0811, dsb=1.3841, bio=0.0000
    Epoch  4/10: total=2.4937, vae=1.0818, dsb=1.4119, bio=0.0000
    Epoch  5/10: total=2.5290, vae=1.0811, dsb=1.4479, bio=0.0000
    Epoch  6/10: total=2.4657, vae=1.0814, dsb=1.3843, bio=0.0000
    Epoch  7/10: total=2.4860, vae=1.0811, dsb=1.4049, bio=0.0000
    Epoch  8/10: total=2.5259, vae=1.0815, dsb=1.4444, bio=0.0000
    Epoch  9/10: total=2.4532, vae=1.0815, dsb=1.3717, bio=0.0000
    Epoch 10/10: total=2.4579, vae=1.0810, dsb=1.3769, bio=0.0000

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=246.1706, vae=1.0812, dsb=245.0895, bio=0.0000
    Epoch  2/10: total=244.6680, vae=1.0805, dsb=243.5875, bio=0.0000
    Epoch  3/10: total=245.4854, vae=1.0807, dsb=244.4046, bio=0.0000
    Epoch  4/10: total=246.0864, vae=1.0813, dsb=245.0050, bio=0.0000
    Epoch  5/10: total=244.7230, vae=1.0804, dsb=243.6426, bio=0.0000
    Epoch  6/10: total=244.5466, vae=1.0813, dsb=243.4654, bio=0.0000
    Epoch  7/10: total=246.6042, vae=1.0814, dsb=245.5229, bio=0.0000
    Epoch  8/10: total=246.1244, vae=1.0808, dsb=245.0435, bio=0.0000
    Epoch  9/10: total=243.5775, vae=1.0806, dsb=242.4969, bio=0.0000
    Epoch 10/10: total=247.0007, vae=1.0815, dsb=245.9192, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=2.3646, vae=1.0813, dsb=1.2833, bio=0.0000
    Epoch  2/10: total=2.2866, vae=1.0812, dsb=1.2054, bio=0.0000
    Epoch  3/10: total=2.3554, vae=1.0811, dsb=1.2743, bio=0.0000
    Epoch  4/10: total=2.3655, vae=1.0800, dsb=1.2855, bio=0.0000
    Epoch  5/10: total=2.3403, vae=1.0814, dsb=1.2589, bio=0.0000
    Epoch  6/10: total=2.3295, vae=1.0811, dsb=1.2485, bio=0.0000
    Epoch  7/10: total=2.3319, vae=1.0810, dsb=1.2509, bio=0.0000
    Epoch  8/10: total=2.3304, vae=1.0814, dsb=1.2490, bio=0.0000
    Epoch  9/10: total=2.2975, vae=1.0806, dsb=1.2169, bio=0.0000
    Epoch 10/10: total=2.3237, vae=1.0807, dsb=1.2431, bio=0.0000

[Seed 36] Joint training (ablation) complete; models and history saved.

[Seed 36] Drift genes saved in /home/yyuan/ICB_TCE/iter_results/run_036

[Seed 36] run finished.

================================================================================
[Seed 37] Starting running whole pipeline...
================================================================================

[Seed 37] Starting VAE pre-training...

    Epoch [01/20], Beta: 0.000, Average Loss: 536.0802
    Epoch [02/20], Beta: 0.000, Average Loss: 307.1412
    Epoch [03/20], Beta: 0.000, Average Loss: 267.5817
    Epoch [04/20], Beta: 0.000, Average Loss: 248.5477
    Epoch [05/20], Beta: 0.100, Average Loss: 245.4215
    Epoch [06/20], Beta: 0.200, Average Loss: 244.9929
    Epoch [07/20], Beta: 0.300, Average Loss: 245.1989
    Epoch [08/20], Beta: 0.400, Average Loss: 245.6864
    Epoch [09/20], Beta: 0.500, Average Loss: 246.5911
    Epoch [10/20], Beta: 0.600, Average Loss: 247.7352
    Epoch [11/20], Beta: 0.700, Average Loss: 248.9325
    Epoch [12/20], Beta: 0.800, Average Loss: 250.1702
    Epoch [13/20], Beta: 0.900, Average Loss: 251.4383
    Epoch [14/20], Beta: 1.000, Average Loss: 252.9799
    Epoch [15/20], Beta: 1.000, Average Loss: 252.5997
    Epoch [16/20], Beta: 1.000, Average Loss: 252.2643
    Epoch [17/20], Beta: 1.000, Average Loss: 251.9018
    Epoch [18/20], Beta: 1.000, Average Loss: 251.5917
    Epoch [19/20], Beta: 1.000, Average Loss: 251.2334
    Epoch [20/20], Beta: 1.000, Average Loss: 251.1244

[Seed 37] VAE pre-training complete.

[Seed 37] Starting joint training (original)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=290.0016, vae=3.6890, dsb=272.4621, bio=27.7009
    Epoch  2/10: total=90.6211, vae=1.1076, dsb=89.4785, bio=0.0699
    Epoch  3/10: total=79.5337, vae=1.1030, dsb=78.4153, bio=0.0308
    Epoch  4/10: total=73.8971, vae=1.1013, dsb=72.7867, bio=0.0183
    Epoch  5/10: total=71.3524, vae=1.0999, dsb=70.2465, bio=0.0120
    Epoch  6/10: total=68.9790, vae=1.0999, dsb=67.8747, bio=0.0088
    Epoch  7/10: total=67.3080, vae=1.0990, dsb=66.2056, bio=0.0069
    Epoch  8/10: total=66.4002, vae=1.0985, dsb=65.2990, bio=0.0054
    Epoch  9/10: total=65.1864, vae=1.0983, dsb=64.0859, bio=0.0046
    Epoch 10/10: total=64.7791, vae=1.0980, dsb=63.6791, bio=0.0040

  [Backward Policy Training]
    Epoch  1/10: total=3.2189, vae=1.0994, dsb=2.1138, bio=0.0114
    Epoch  2/10: total=2.7652, vae=1.0967, dsb=1.6665, bio=0.0041
    Epoch  3/10: total=2.6437, vae=1.0973, dsb=1.5448, bio=0.0030
    Epoch  4/10: total=2.5460, vae=1.0957, dsb=1.4490, bio=0.0025
    Epoch  5/10: total=2.5215, vae=1.0968, dsb=1.4236, bio=0.0024
    Epoch  6/10: total=2.4755, vae=1.0961, dsb=1.3784, bio=0.0022
    Epoch  7/10: total=2.4059, vae=1.0949, dsb=1.3099, bio=0.0020
    Epoch  8/10: total=2.4077, vae=1.0945, dsb=1.3122, bio=0.0020
    Epoch  9/10: total=2.3952, vae=1.0954, dsb=1.2988, bio=0.0019
    Epoch 10/10: total=2.4174, vae=1.0960, dsb=1.3204, bio=0.0019

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=57.0686, vae=1.0984, dsb=55.9687, bio=0.0031
    Epoch  2/10: total=51.5274, vae=1.0969, dsb=50.4296, bio=0.0017
    Epoch  3/10: total=50.0497, vae=1.0969, dsb=48.9519, bio=0.0017
    Epoch  4/10: total=49.4375, vae=1.0961, dsb=48.3406, bio=0.0017
    Epoch  5/10: total=48.9224, vae=1.0970, dsb=47.8246, bio=0.0016
    Epoch  6/10: total=48.3542, vae=1.0968, dsb=47.2567, bio=0.0015
    Epoch  7/10: total=47.8771, vae=1.0966, dsb=46.7797, bio=0.0016
    Epoch  8/10: total=47.9817, vae=1.0958, dsb=46.8852, bio=0.0016
    Epoch  9/10: total=47.9867, vae=1.0964, dsb=46.8895, bio=0.0016
    Epoch 10/10: total=47.5064, vae=1.0955, dsb=46.4101, bio=0.0016

  [Backward Policy Training]
    Epoch  1/10: total=2.1097, vae=1.0965, dsb=1.0089, bio=0.0088
    Epoch  2/10: total=1.9992, vae=1.0953, dsb=0.9031, bio=0.0017
    Epoch  3/10: total=1.9714, vae=1.0952, dsb=0.8752, bio=0.0018
    Epoch  4/10: total=1.9520, vae=1.0942, dsb=0.8570, bio=0.0015
    Epoch  5/10: total=1.9087, vae=1.0948, dsb=0.8132, bio=0.0014
    Epoch  6/10: total=1.8906, vae=1.0940, dsb=0.7959, bio=0.0014
    Epoch  7/10: total=1.9092, vae=1.0944, dsb=0.8141, bio=0.0014
    Epoch  8/10: total=1.8981, vae=1.0943, dsb=0.8031, bio=0.0014
    Epoch  9/10: total=1.8836, vae=1.0950, dsb=0.7879, bio=0.0014
    Epoch 10/10: total=1.8863, vae=1.0937, dsb=0.7919, bio=0.0014

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=40.1831, vae=1.0970, dsb=39.0847, bio=0.0029
    Epoch  2/10: total=38.3921, vae=1.0960, dsb=37.2954, bio=0.0013
    Epoch  3/10: total=37.7791, vae=1.0952, dsb=36.6832, bio=0.0013
    Epoch  4/10: total=37.5416, vae=1.0949, dsb=36.4460, bio=0.0013
    Epoch  5/10: total=37.3623, vae=1.0951, dsb=36.2665, bio=0.0013
    Epoch  6/10: total=37.3745, vae=1.0946, dsb=36.2793, bio=0.0013
    Epoch  7/10: total=37.2375, vae=1.0944, dsb=36.1425, bio=0.0013
    Epoch  8/10: total=36.9833, vae=1.0950, dsb=35.8877, bio=0.0013
    Epoch  9/10: total=37.1744, vae=1.0940, dsb=36.0798, bio=0.0013
    Epoch 10/10: total=37.1368, vae=1.0953, dsb=36.0408, bio=0.0014

  [Backward Policy Training]
    Epoch  1/10: total=1.8242, vae=1.0958, dsb=0.6945, bio=0.0679
    Epoch  2/10: total=1.7267, vae=1.0940, dsb=0.6320, bio=0.0014
    Epoch  3/10: total=1.7087, vae=1.0941, dsb=0.6140, bio=0.0013
    Epoch  4/10: total=1.7064, vae=1.0935, dsb=0.6123, bio=0.0012
    Epoch  5/10: total=1.6922, vae=1.0937, dsb=0.5978, bio=0.0012
    Epoch  6/10: total=1.7027, vae=1.0936, dsb=0.6085, bio=0.0012
    Epoch  7/10: total=1.6789, vae=1.0935, dsb=0.5848, bio=0.0011
    Epoch  8/10: total=1.6943, vae=1.0940, dsb=0.5998, bio=0.0011
    Epoch  9/10: total=1.6665, vae=1.0926, dsb=0.5733, bio=0.0011
    Epoch 10/10: total=1.6617, vae=1.0931, dsb=0.5680, bio=0.0011

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=33.2459, vae=1.0966, dsb=32.1472, bio=0.0043
    Epoch  2/10: total=32.5541, vae=1.0946, dsb=31.4584, bio=0.0021
    Epoch  3/10: total=32.3696, vae=1.0948, dsb=31.2742, bio=0.0012
    Epoch  4/10: total=32.2297, vae=1.0945, dsb=31.1347, bio=0.0012
    Epoch  5/10: total=32.2697, vae=1.0939, dsb=31.1752, bio=0.0012
    Epoch  6/10: total=32.1855, vae=1.0945, dsb=31.0905, bio=0.0011
    Epoch  7/10: total=32.3044, vae=1.0944, dsb=31.2095, bio=0.0011
    Epoch  8/10: total=32.1491, vae=1.0940, dsb=31.0545, bio=0.0011
    Epoch  9/10: total=32.1679, vae=1.0940, dsb=31.0734, bio=0.0011
    Epoch 10/10: total=32.0711, vae=1.0930, dsb=30.9778, bio=0.0006

  [Backward Policy Training]
    Epoch  1/10: total=1.6308, vae=1.0952, dsb=0.4768, bio=0.1177
    Epoch  2/10: total=1.5602, vae=1.0938, dsb=0.4657, bio=0.0015
    Epoch  3/10: total=1.5502, vae=1.0936, dsb=0.4559, bio=0.0013
    Epoch  4/10: total=1.5544, vae=1.0935, dsb=0.4603, bio=0.0011
    Epoch  5/10: total=1.5523, vae=1.0935, dsb=0.4582, bio=0.0010
    Epoch  6/10: total=1.5629, vae=1.0928, dsb=0.4696, bio=0.0010
    Epoch  7/10: total=1.5636, vae=1.0934, dsb=0.4696, bio=0.0011
    Epoch  8/10: total=1.5519, vae=1.0926, dsb=0.4588, bio=0.0010
    Epoch  9/10: total=1.5557, vae=1.0933, dsb=0.4618, bio=0.0011
    Epoch 10/10: total=1.5414, vae=1.0924, dsb=0.4485, bio=0.0010

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=29.8100, vae=1.0962, dsb=28.7106, bio=0.0064
    Epoch  2/10: total=29.5416, vae=1.0957, dsb=28.4454, bio=0.0011
    Epoch  3/10: total=29.4107, vae=1.0942, dsb=28.3159, bio=0.0011
    Epoch  4/10: total=29.2391, vae=1.0946, dsb=28.1440, bio=0.0010
    Epoch  5/10: total=29.4340, vae=1.0940, dsb=28.3397, bio=0.0005
    Epoch  6/10: total=29.2713, vae=1.0937, dsb=28.1771, bio=0.0012
    Epoch  7/10: total=29.4871, vae=1.0934, dsb=28.3932, bio=0.0011
    Epoch  8/10: total=29.5783, vae=1.0942, dsb=28.4836, bio=0.0010
    Epoch  9/10: total=29.4253, vae=1.0938, dsb=28.3310, bio=0.0010
    Epoch 10/10: total=29.3357, vae=1.0931, dsb=28.2422, bio=0.0007

  [Backward Policy Training]
    Epoch  1/10: total=1.6025, vae=1.0945, dsb=0.4087, bio=0.1986
    Epoch  2/10: total=1.4916, vae=1.0936, dsb=0.3974, bio=0.0013
    Epoch  3/10: total=1.4984, vae=1.0931, dsb=0.4048, bio=0.0011
    Epoch  4/10: total=1.4970, vae=1.0931, dsb=0.4033, bio=0.0010
    Epoch  5/10: total=1.4892, vae=1.0927, dsb=0.3963, bio=0.0005
    Epoch  6/10: total=1.5005, vae=1.0928, dsb=0.4074, bio=0.0006
    Epoch  7/10: total=1.5008, vae=1.0931, dsb=0.4071, bio=0.0011
    Epoch  8/10: total=1.5103, vae=1.0936, dsb=0.4164, bio=0.0008
    Epoch  9/10: total=1.4930, vae=1.0926, dsb=0.3999, bio=0.0010
    Epoch 10/10: total=1.4945, vae=1.0924, dsb=0.4016, bio=0.0010

[Seed 37] Joint training (original) complete; models and history saved.

[Seed 37] Starting joint training (ablation)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=273.8515, vae=2.0414, dsb=271.8101, bio=0.0000
    Epoch  2/10: total=89.9900, vae=1.0900, dsb=88.8999, bio=0.0000
    Epoch  3/10: total=79.0511, vae=1.0887, dsb=77.9624, bio=0.0000
    Epoch  4/10: total=73.3831, vae=1.0880, dsb=72.2951, bio=0.0000
    Epoch  5/10: total=70.9330, vae=1.0871, dsb=69.8459, bio=0.0000
    Epoch  6/10: total=68.6750, vae=1.0874, dsb=67.5876, bio=0.0000
    Epoch  7/10: total=67.0473, vae=1.0868, dsb=65.9605, bio=0.0000
    Epoch  8/10: total=66.1604, vae=1.0866, dsb=65.0738, bio=0.0000
    Epoch  9/10: total=65.0166, vae=1.0866, dsb=63.9300, bio=0.0000
    Epoch 10/10: total=64.6547, vae=1.0866, dsb=63.5681, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=3.0929, vae=1.0865, dsb=2.0063, bio=0.0000
    Epoch  2/10: total=2.6632, vae=1.0860, dsb=1.5773, bio=0.0000
    Epoch  3/10: total=2.5453, vae=1.0870, dsb=1.4583, bio=0.0000
    Epoch  4/10: total=2.4499, vae=1.0857, dsb=1.3642, bio=0.0000
    Epoch  5/10: total=2.4257, vae=1.0869, dsb=1.3387, bio=0.0000
    Epoch  6/10: total=2.3822, vae=1.0864, dsb=1.2957, bio=0.0000
    Epoch  7/10: total=2.3156, vae=1.0855, dsb=1.2302, bio=0.0000
    Epoch  8/10: total=2.3183, vae=1.0851, dsb=1.2332, bio=0.0000
    Epoch  9/10: total=2.3068, vae=1.0861, dsb=1.2207, bio=0.0000
    Epoch 10/10: total=2.3291, vae=1.0867, dsb=1.2424, bio=0.0000

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=56.9366, vae=1.0866, dsb=55.8501, bio=0.0000
    Epoch  2/10: total=51.2983, vae=1.0862, dsb=50.2121, bio=0.0000
    Epoch  3/10: total=49.7106, vae=1.0865, dsb=48.6241, bio=0.0000
    Epoch  4/10: total=49.0577, vae=1.0858, dsb=47.9719, bio=0.0000
    Epoch  5/10: total=48.5342, vae=1.0869, dsb=47.4473, bio=0.0000
    Epoch  6/10: total=48.0028, vae=1.0868, dsb=46.9160, bio=0.0000
    Epoch  7/10: total=47.4668, vae=1.0867, dsb=46.3801, bio=0.0000
    Epoch  8/10: total=47.5827, vae=1.0860, dsb=46.4968, bio=0.0000
    Epoch  9/10: total=47.5770, vae=1.0867, dsb=46.4903, bio=0.0000
    Epoch 10/10: total=47.1051, vae=1.0859, dsb=46.0192, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=2.0561, vae=1.0862, dsb=0.9699, bio=0.0000
    Epoch  2/10: total=1.9570, vae=1.0864, dsb=0.8706, bio=0.0000
    Epoch  3/10: total=1.9305, vae=1.0865, dsb=0.8441, bio=0.0000
    Epoch  4/10: total=1.9116, vae=1.0857, dsb=0.8260, bio=0.0000
    Epoch  5/10: total=1.8693, vae=1.0864, dsb=0.7830, bio=0.0000
    Epoch  6/10: total=1.8522, vae=1.0857, dsb=0.7665, bio=0.0000
    Epoch  7/10: total=1.8699, vae=1.0862, dsb=0.7837, bio=0.0000
    Epoch  8/10: total=1.8592, vae=1.0861, dsb=0.7731, bio=0.0000
    Epoch  9/10: total=1.8460, vae=1.0869, dsb=0.7591, bio=0.0000
    Epoch 10/10: total=1.8490, vae=1.0857, dsb=0.7632, bio=0.0000

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=39.8726, vae=1.0862, dsb=38.7864, bio=0.0000
    Epoch  2/10: total=38.2242, vae=1.0866, dsb=37.1376, bio=0.0000
    Epoch  3/10: total=37.6230, vae=1.0860, dsb=36.5371, bio=0.0000
    Epoch  4/10: total=37.3771, vae=1.0858, dsb=36.2913, bio=0.0000
    Epoch  5/10: total=37.1979, vae=1.0861, dsb=36.1118, bio=0.0000
    Epoch  6/10: total=37.2154, vae=1.0856, dsb=36.1297, bio=0.0000
    Epoch  7/10: total=37.0988, vae=1.0856, dsb=36.0132, bio=0.0000
    Epoch  8/10: total=36.8481, vae=1.0863, dsb=35.7617, bio=0.0000
    Epoch  9/10: total=37.0174, vae=1.0855, dsb=35.9319, bio=0.0000
    Epoch 10/10: total=37.0077, vae=1.0868, dsb=35.9209, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.7407, vae=1.0864, dsb=0.6543, bio=0.0000
    Epoch  2/10: total=1.6833, vae=1.0858, dsb=0.5975, bio=0.0000
    Epoch  3/10: total=1.6674, vae=1.0862, dsb=0.5812, bio=0.0000
    Epoch  4/10: total=1.6663, vae=1.0856, dsb=0.5807, bio=0.0000
    Epoch  5/10: total=1.6530, vae=1.0860, dsb=0.5670, bio=0.0000
    Epoch  6/10: total=1.6635, vae=1.0860, dsb=0.5775, bio=0.0000
    Epoch  7/10: total=1.6413, vae=1.0860, dsb=0.5553, bio=0.0000
    Epoch  8/10: total=1.6565, vae=1.0866, dsb=0.5699, bio=0.0000
    Epoch  9/10: total=1.6295, vae=1.0853, dsb=0.5442, bio=0.0000
    Epoch 10/10: total=1.6248, vae=1.0859, dsb=0.5389, bio=0.0000

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=33.3828, vae=1.0864, dsb=32.2964, bio=0.0000
    Epoch  2/10: total=32.7219, vae=1.0857, dsb=31.6362, bio=0.0000
    Epoch  3/10: total=32.5130, vae=1.0861, dsb=31.4270, bio=0.0000
    Epoch  4/10: total=32.3941, vae=1.0859, dsb=31.3082, bio=0.0000
    Epoch  5/10: total=32.4271, vae=1.0855, dsb=31.3416, bio=0.0000
    Epoch  6/10: total=32.3815, vae=1.0862, dsb=31.2953, bio=0.0000
    Epoch  7/10: total=32.5109, vae=1.0862, dsb=31.4247, bio=0.0000
    Epoch  8/10: total=32.3622, vae=1.0859, dsb=31.2763, bio=0.0000
    Epoch  9/10: total=32.3620, vae=1.0860, dsb=31.2760, bio=0.0000
    Epoch 10/10: total=32.2683, vae=1.0850, dsb=31.1833, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.5316, vae=1.0861, dsb=0.4455, bio=0.0000
    Epoch  2/10: total=1.5209, vae=1.0861, dsb=0.4348, bio=0.0000
    Epoch  3/10: total=1.5122, vae=1.0862, dsb=0.4260, bio=0.0000
    Epoch  4/10: total=1.5167, vae=1.0863, dsb=0.4304, bio=0.0000
    Epoch  5/10: total=1.5149, vae=1.0864, dsb=0.4285, bio=0.0000
    Epoch  6/10: total=1.5249, vae=1.0857, dsb=0.4392, bio=0.0000
    Epoch  7/10: total=1.5255, vae=1.0865, dsb=0.4390, bio=0.0000
    Epoch  8/10: total=1.5146, vae=1.0858, dsb=0.4288, bio=0.0000
    Epoch  9/10: total=1.5182, vae=1.0865, dsb=0.4317, bio=0.0000
    Epoch 10/10: total=1.5043, vae=1.0857, dsb=0.4187, bio=0.0000

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=30.0152, vae=1.0863, dsb=28.9289, bio=0.0000
    Epoch  2/10: total=29.7756, vae=1.0870, dsb=28.6885, bio=0.0000
    Epoch  3/10: total=29.6496, vae=1.0859, dsb=28.5637, bio=0.0000
    Epoch  4/10: total=29.5005, vae=1.0864, dsb=28.4141, bio=0.0000
    Epoch  5/10: total=29.6928, vae=1.0861, dsb=28.6067, bio=0.0000
    Epoch  6/10: total=29.5202, vae=1.0860, dsb=28.4342, bio=0.0000
    Epoch  7/10: total=29.7350, vae=1.0857, dsb=28.6494, bio=0.0000
    Epoch  8/10: total=29.8682, vae=1.0865, dsb=28.7817, bio=0.0000
    Epoch  9/10: total=29.6791, vae=1.0862, dsb=28.5929, bio=0.0000
    Epoch 10/10: total=29.6032, vae=1.0855, dsb=28.5177, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.4645, vae=1.0855, dsb=0.3790, bio=0.0000
    Epoch  2/10: total=1.4543, vae=1.0859, dsb=0.3684, bio=0.0000
    Epoch  3/10: total=1.4615, vae=1.0858, dsb=0.3757, bio=0.0000
    Epoch  4/10: total=1.4605, vae=1.0860, dsb=0.3745, bio=0.0000
    Epoch  5/10: total=1.4533, vae=1.0857, dsb=0.3677, bio=0.0000
    Epoch  6/10: total=1.4649, vae=1.0860, dsb=0.3789, bio=0.0000
    Epoch  7/10: total=1.4649, vae=1.0864, dsb=0.3785, bio=0.0000
    Epoch  8/10: total=1.4742, vae=1.0868, dsb=0.3874, bio=0.0000
    Epoch  9/10: total=1.4574, vae=1.0860, dsb=0.3714, bio=0.0000
    Epoch 10/10: total=1.4594, vae=1.0859, dsb=0.3736, bio=0.0000

[Seed 37] Joint training (ablation) complete; models and history saved.

[Seed 37] Drift genes saved in /home/yyuan/ICB_TCE/iter_results/run_037

[Seed 37] run finished.

================================================================================
[Seed 38] Starting running whole pipeline...
================================================================================

[Seed 38] Starting VAE pre-training...

    Epoch [01/20], Beta: 0.000, Average Loss: 537.5744
    Epoch [02/20], Beta: 0.000, Average Loss: 314.9300
    Epoch [03/20], Beta: 0.000, Average Loss: 275.2001
    Epoch [04/20], Beta: 0.000, Average Loss: 253.1109
    Epoch [05/20], Beta: 0.100, Average Loss: 246.2811
    Epoch [06/20], Beta: 0.200, Average Loss: 245.1824
    Epoch [07/20], Beta: 0.300, Average Loss: 245.2093
    Epoch [08/20], Beta: 0.400, Average Loss: 245.9306
    Epoch [09/20], Beta: 0.500, Average Loss: 246.8605
    Epoch [10/20], Beta: 0.600, Average Loss: 248.0399
    Epoch [11/20], Beta: 0.700, Average Loss: 249.3070
    Epoch [12/20], Beta: 0.800, Average Loss: 250.5805
    Epoch [13/20], Beta: 0.900, Average Loss: 251.8362
    Epoch [14/20], Beta: 1.000, Average Loss: 253.4104
    Epoch [15/20], Beta: 1.000, Average Loss: 253.0104
    Epoch [16/20], Beta: 1.000, Average Loss: 252.6089
    Epoch [17/20], Beta: 1.000, Average Loss: 252.3101
    Epoch [18/20], Beta: 1.000, Average Loss: 251.9580
    Epoch [19/20], Beta: 1.000, Average Loss: 251.5811
    Epoch [20/20], Beta: 1.000, Average Loss: 251.4485

[Seed 38] VAE pre-training complete.

[Seed 38] Starting joint training (original)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=509.6898, vae=3.7072, dsb=482.6512, bio=46.6629
    Epoch  2/10: total=120.0852, vae=1.0907, dsb=118.9593, bio=0.0706
    Epoch  3/10: total=109.9102, vae=1.0849, dsb=108.8106, bio=0.0293
    Epoch  4/10: total=105.4620, vae=1.0836, dsb=104.3696, bio=0.0176
    Epoch  5/10: total=102.9165, vae=1.0817, dsb=101.8290, bio=0.0116
    Epoch  6/10: total=101.3390, vae=1.0816, dsb=100.2532, bio=0.0086
    Epoch  7/10: total=100.2495, vae=1.0802, dsb=99.1659, bio=0.0067
    Epoch  8/10: total=99.0080, vae=1.0807, dsb=97.9246, bio=0.0055
    Epoch  9/10: total=98.4519, vae=1.0804, dsb=97.3691, bio=0.0048
    Epoch 10/10: total=97.1350, vae=1.0801, dsb=96.0528, bio=0.0041

  [Backward Policy Training]
    Epoch  1/10: total=3.1738, vae=1.0811, dsb=2.0860, bio=0.0135
    Epoch  2/10: total=2.7150, vae=1.0796, dsb=1.6330, bio=0.0046
    Epoch  3/10: total=2.6093, vae=1.0786, dsb=1.5290, bio=0.0034
    Epoch  4/10: total=2.5121, vae=1.0782, dsb=1.4324, bio=0.0028
    Epoch  5/10: total=2.4653, vae=1.0793, dsb=1.3847, bio=0.0026
    Epoch  6/10: total=2.4553, vae=1.0790, dsb=1.3751, bio=0.0025
    Epoch  7/10: total=2.4255, vae=1.0778, dsb=1.3466, bio=0.0022
    Epoch  8/10: total=2.4068, vae=1.0780, dsb=1.3278, bio=0.0021
    Epoch  9/10: total=2.3972, vae=1.0779, dsb=1.3183, bio=0.0020
    Epoch 10/10: total=2.3922, vae=1.0777, dsb=1.3135, bio=0.0020

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=85.2816, vae=1.0806, dsb=84.1990, bio=0.0041
    Epoch  2/10: total=79.8165, vae=1.0784, dsb=78.7372, bio=0.0019
    Epoch  3/10: total=79.1183, vae=1.0784, dsb=78.0389, bio=0.0018
    Epoch  4/10: total=78.5588, vae=1.0782, dsb=77.4797, bio=0.0018
    Epoch  5/10: total=77.8324, vae=1.0790, dsb=76.7525, bio=0.0019
    Epoch  6/10: total=78.0818, vae=1.0780, dsb=77.0028, bio=0.0020
    Epoch  7/10: total=77.2665, vae=1.0784, dsb=76.1871, bio=0.0020
    Epoch  8/10: total=77.3301, vae=1.0787, dsb=76.2505, bio=0.0019
    Epoch  9/10: total=77.1512, vae=1.0774, dsb=76.0729, bio=0.0019
    Epoch 10/10: total=76.8239, vae=1.0785, dsb=75.7445, bio=0.0019

  [Backward Policy Training]
    Epoch  1/10: total=2.1465, vae=1.0776, dsb=1.0659, bio=0.0060
    Epoch  2/10: total=2.0435, vae=1.0780, dsb=0.9646, bio=0.0019
    Epoch  3/10: total=1.9738, vae=1.0772, dsb=0.8957, bio=0.0018
    Epoch  4/10: total=1.9760, vae=1.0771, dsb=0.8980, bio=0.0017
    Epoch  5/10: total=1.9687, vae=1.0763, dsb=0.8915, bio=0.0017
    Epoch  6/10: total=1.9780, vae=1.0765, dsb=0.9006, bio=0.0016
    Epoch  7/10: total=1.9468, vae=1.0760, dsb=0.8700, bio=0.0016
    Epoch  8/10: total=1.9703, vae=1.0767, dsb=0.8928, bio=0.0016
    Epoch  9/10: total=1.9206, vae=1.0756, dsb=0.8441, bio=0.0017
    Epoch 10/10: total=1.9354, vae=1.0756, dsb=0.8588, bio=0.0020

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=65.8138, vae=1.0798, dsb=64.7326, bio=0.0030
    Epoch  2/10: total=64.3698, vae=1.0782, dsb=63.2907, bio=0.0017
    Epoch  3/10: total=63.5543, vae=1.0773, dsb=62.4762, bio=0.0017
    Epoch  4/10: total=63.4415, vae=1.0772, dsb=62.3635, bio=0.0017
    Epoch  5/10: total=62.9767, vae=1.0779, dsb=61.8980, bio=0.0017
    Epoch  6/10: total=63.2872, vae=1.0771, dsb=62.2093, bio=0.0017
    Epoch  7/10: total=63.4662, vae=1.0769, dsb=62.3884, bio=0.0017
    Epoch  8/10: total=63.4497, vae=1.0767, dsb=62.3723, bio=0.0016
    Epoch  9/10: total=62.7227, vae=1.0770, dsb=61.6448, bio=0.0016
    Epoch 10/10: total=63.0007, vae=1.0771, dsb=61.9227, bio=0.0016

  [Backward Policy Training]
    Epoch  1/10: total=1.8417, vae=1.0775, dsb=0.7570, bio=0.0143
    Epoch  2/10: total=1.7729, vae=1.0761, dsb=0.6960, bio=0.0016
    Epoch  3/10: total=1.7491, vae=1.0759, dsb=0.6725, bio=0.0015
    Epoch  4/10: total=1.7753, vae=1.0759, dsb=0.6987, bio=0.0014
    Epoch  5/10: total=1.7582, vae=1.0762, dsb=0.6814, bio=0.0012
    Epoch  6/10: total=1.7489, vae=1.0766, dsb=0.6715, bio=0.0016
    Epoch  7/10: total=1.7342, vae=1.0758, dsb=0.6578, bio=0.0013
    Epoch  8/10: total=1.7375, vae=1.0761, dsb=0.6607, bio=0.0013
    Epoch  9/10: total=1.7263, vae=1.0761, dsb=0.6495, bio=0.0013
    Epoch 10/10: total=1.7417, vae=1.0761, dsb=0.6649, bio=0.0014

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=57.4380, vae=1.0794, dsb=56.3574, bio=0.0024
    Epoch  2/10: total=57.1189, vae=1.0776, dsb=56.0406, bio=0.0014
    Epoch  3/10: total=56.5190, vae=1.0772, dsb=55.4412, bio=0.0014
    Epoch  4/10: total=56.2381, vae=1.0766, dsb=55.1608, bio=0.0014
    Epoch  5/10: total=56.8225, vae=1.0766, dsb=55.7452, bio=0.0014
    Epoch  6/10: total=56.6087, vae=1.0777, dsb=55.5305, bio=0.0011
    Epoch  7/10: total=56.2640, vae=1.0770, dsb=55.1863, bio=0.0014
    Epoch  8/10: total=56.3256, vae=1.0771, dsb=55.2478, bio=0.0013
    Epoch  9/10: total=56.5098, vae=1.0753, dsb=55.4338, bio=0.0013
    Epoch 10/10: total=56.2730, vae=1.0768, dsb=55.1956, bio=0.0013

  [Backward Policy Training]
    Epoch  1/10: total=1.6970, vae=1.0765, dsb=0.5754, bio=0.0902
    Epoch  2/10: total=1.6249, vae=1.0769, dsb=0.5473, bio=0.0014
    Epoch  3/10: total=1.6021, vae=1.0759, dsb=0.5256, bio=0.0013
    Epoch  4/10: total=1.6030, vae=1.0748, dsb=0.5276, bio=0.0014
    Epoch  5/10: total=1.6126, vae=1.0751, dsb=0.5369, bio=0.0012
    Epoch  6/10: total=1.6117, vae=1.0753, dsb=0.5358, bio=0.0012
    Epoch  7/10: total=1.6053, vae=1.0758, dsb=0.5290, bio=0.0011
    Epoch  8/10: total=1.6134, vae=1.0762, dsb=0.5366, bio=0.0012
    Epoch  9/10: total=1.5943, vae=1.0755, dsb=0.5182, bio=0.0013
    Epoch 10/10: total=1.6051, vae=1.0759, dsb=0.5286, bio=0.0011

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=49.8042, vae=1.0790, dsb=48.7238, bio=0.0028
    Epoch  2/10: total=49.6161, vae=1.0771, dsb=48.5385, bio=0.0011
    Epoch  3/10: total=49.3507, vae=1.0765, dsb=48.2737, bio=0.0011
    Epoch  4/10: total=49.4219, vae=1.0764, dsb=48.3449, bio=0.0012
    Epoch  5/10: total=49.1727, vae=1.0768, dsb=48.0954, bio=0.0011
    Epoch  6/10: total=48.9321, vae=1.0762, dsb=47.8552, bio=0.0014
    Epoch  7/10: total=48.8054, vae=1.0758, dsb=47.7291, bio=0.0011
    Epoch  8/10: total=49.0265, vae=1.0758, dsb=47.9502, bio=0.0011
    Epoch  9/10: total=49.0571, vae=1.0760, dsb=47.9805, bio=0.0010
    Epoch 10/10: total=48.9121, vae=1.0757, dsb=47.8360, bio=0.0006

  [Backward Policy Training]
    Epoch  1/10: total=1.6407, vae=1.0780, dsb=0.4766, bio=0.1724
    Epoch  2/10: total=1.5594, vae=1.0756, dsb=0.4831, bio=0.0013
    Epoch  3/10: total=1.5208, vae=1.0750, dsb=0.4452, bio=0.0012
    Epoch  4/10: total=1.5343, vae=1.0752, dsb=0.4586, bio=0.0011
    Epoch  5/10: total=1.5488, vae=1.0759, dsb=0.4724, bio=0.0009
    Epoch  6/10: total=1.5236, vae=1.0741, dsb=0.4490, bio=0.0010
    Epoch  7/10: total=1.5402, vae=1.0753, dsb=0.4644, bio=0.0010
    Epoch  8/10: total=1.5312, vae=1.0750, dsb=0.4557, bio=0.0010
    Epoch  9/10: total=1.5313, vae=1.0749, dsb=0.4560, bio=0.0010
    Epoch 10/10: total=1.5427, vae=1.0750, dsb=0.4672, bio=0.0009

[Seed 38] Joint training (original) complete; models and history saved.

[Seed 38] Starting joint training (ablation)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=483.9301, vae=2.0297, dsb=481.9003, bio=0.0000
    Epoch  2/10: total=119.2723, vae=1.0719, dsb=118.2004, bio=0.0000
    Epoch  3/10: total=109.2739, vae=1.0698, dsb=108.2041, bio=0.0000
    Epoch  4/10: total=104.9643, vae=1.0698, dsb=103.8945, bio=0.0000
    Epoch  5/10: total=102.5985, vae=1.0685, dsb=101.5300, bio=0.0000
    Epoch  6/10: total=101.0494, vae=1.0688, dsb=99.9806, bio=0.0000
    Epoch  7/10: total=99.9756, vae=1.0678, dsb=98.9077, bio=0.0000
    Epoch  8/10: total=98.7425, vae=1.0686, dsb=97.6739, bio=0.0000
    Epoch  9/10: total=98.1848, vae=1.0686, dsb=97.1162, bio=0.0000
    Epoch 10/10: total=96.8974, vae=1.0687, dsb=95.8288, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=3.0526, vae=1.0685, dsb=1.9841, bio=0.0000
    Epoch  2/10: total=2.6123, vae=1.0687, dsb=1.5435, bio=0.0000
    Epoch  3/10: total=2.5095, vae=1.0682, dsb=1.4413, bio=0.0000
    Epoch  4/10: total=2.4164, vae=1.0681, dsb=1.3483, bio=0.0000
    Epoch  5/10: total=2.3706, vae=1.0694, dsb=1.3012, bio=0.0000
    Epoch  6/10: total=2.3593, vae=1.0693, dsb=1.2900, bio=0.0000
    Epoch  7/10: total=2.3299, vae=1.0683, dsb=1.2616, bio=0.0000
    Epoch  8/10: total=2.3126, vae=1.0685, dsb=1.2441, bio=0.0000
    Epoch  9/10: total=2.3033, vae=1.0685, dsb=1.2348, bio=0.0000
    Epoch 10/10: total=2.2985, vae=1.0684, dsb=1.2301, bio=0.0000

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=84.0046, vae=1.0686, dsb=82.9360, bio=0.0000
    Epoch  2/10: total=78.9339, vae=1.0677, dsb=77.8662, bio=0.0000
    Epoch  3/10: total=78.2560, vae=1.0679, dsb=77.1882, bio=0.0000
    Epoch  4/10: total=77.7733, vae=1.0677, dsb=76.7056, bio=0.0000
    Epoch  5/10: total=77.0389, vae=1.0687, dsb=75.9702, bio=0.0000
    Epoch  6/10: total=77.2879, vae=1.0679, dsb=76.2200, bio=0.0000
    Epoch  7/10: total=76.4934, vae=1.0683, dsb=75.4252, bio=0.0000
    Epoch  8/10: total=76.5662, vae=1.0687, dsb=75.4975, bio=0.0000
    Epoch  9/10: total=76.3947, vae=1.0675, dsb=75.3272, bio=0.0000
    Epoch 10/10: total=76.0836, vae=1.0687, dsb=75.0149, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=2.0595, vae=1.0674, dsb=0.9921, bio=0.0000
    Epoch  2/10: total=1.9678, vae=1.0691, dsb=0.8987, bio=0.0000
    Epoch  3/10: total=1.9050, vae=1.0684, dsb=0.8366, bio=0.0000
    Epoch  4/10: total=1.9081, vae=1.0683, dsb=0.8397, bio=0.0000
    Epoch  5/10: total=1.9016, vae=1.0678, dsb=0.8339, bio=0.0000
    Epoch  6/10: total=1.9111, vae=1.0680, dsb=0.8431, bio=0.0000
    Epoch  7/10: total=1.8822, vae=1.0675, dsb=0.8147, bio=0.0000
    Epoch  8/10: total=1.9048, vae=1.0682, dsb=0.8365, bio=0.0000
    Epoch  9/10: total=1.8572, vae=1.0671, dsb=0.7901, bio=0.0000
    Epoch 10/10: total=1.8712, vae=1.0671, dsb=0.8040, bio=0.0000

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=63.6319, vae=1.0686, dsb=62.5633, bio=0.0000
    Epoch  2/10: total=62.2149, vae=1.0684, dsb=61.1465, bio=0.0000
    Epoch  3/10: total=61.4520, vae=1.0677, dsb=60.3842, bio=0.0000
    Epoch  4/10: total=61.3905, vae=1.0678, dsb=60.3228, bio=0.0000
    Epoch  5/10: total=61.0325, vae=1.0686, dsb=59.9639, bio=0.0000
    Epoch  6/10: total=61.3085, vae=1.0678, dsb=60.2407, bio=0.0000
    Epoch  7/10: total=61.4905, vae=1.0677, dsb=60.4228, bio=0.0000
    Epoch  8/10: total=61.4471, vae=1.0676, dsb=60.3795, bio=0.0000
    Epoch  9/10: total=60.7763, vae=1.0680, dsb=59.7083, bio=0.0000
    Epoch 10/10: total=61.0088, vae=1.0682, dsb=59.9406, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.7532, vae=1.0682, dsb=0.6850, bio=0.0000
    Epoch  2/10: total=1.6988, vae=1.0678, dsb=0.6309, bio=0.0000
    Epoch  3/10: total=1.6779, vae=1.0677, dsb=0.6102, bio=0.0000
    Epoch  4/10: total=1.7039, vae=1.0677, dsb=0.6362, bio=0.0000
    Epoch  5/10: total=1.6885, vae=1.0681, dsb=0.6204, bio=0.0000
    Epoch  6/10: total=1.6801, vae=1.0686, dsb=0.6116, bio=0.0000
    Epoch  7/10: total=1.6668, vae=1.0678, dsb=0.5990, bio=0.0000
    Epoch  8/10: total=1.6707, vae=1.0681, dsb=0.6026, bio=0.0000
    Epoch  9/10: total=1.6598, vae=1.0682, dsb=0.5917, bio=0.0000
    Epoch 10/10: total=1.6749, vae=1.0682, dsb=0.6067, bio=0.0000

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=54.6026, vae=1.0687, dsb=53.5339, bio=0.0000
    Epoch  2/10: total=54.4656, vae=1.0683, dsb=53.3973, bio=0.0000
    Epoch  3/10: total=53.9693, vae=1.0682, dsb=52.9011, bio=0.0000
    Epoch  4/10: total=53.7334, vae=1.0678, dsb=52.6656, bio=0.0000
    Epoch  5/10: total=54.3063, vae=1.0678, dsb=53.2385, bio=0.0000
    Epoch  6/10: total=54.1096, vae=1.0691, dsb=53.0405, bio=0.0000
    Epoch  7/10: total=53.7799, vae=1.0685, dsb=52.7114, bio=0.0000
    Epoch  8/10: total=53.8620, vae=1.0687, dsb=52.7932, bio=0.0000
    Epoch  9/10: total=54.0477, vae=1.0671, dsb=52.9806, bio=0.0000
    Epoch 10/10: total=53.8377, vae=1.0686, dsb=52.7690, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.5883, vae=1.0674, dsb=0.5209, bio=0.0000
    Epoch  2/10: total=1.5679, vae=1.0689, dsb=0.4990, bio=0.0000
    Epoch  3/10: total=1.5491, vae=1.0680, dsb=0.4811, bio=0.0000
    Epoch  4/10: total=1.5509, vae=1.0671, dsb=0.4839, bio=0.0000
    Epoch  5/10: total=1.5613, vae=1.0674, dsb=0.4939, bio=0.0000
    Epoch  6/10: total=1.5614, vae=1.0677, dsb=0.4937, bio=0.0000
    Epoch  7/10: total=1.5559, vae=1.0683, dsb=0.4876, bio=0.0000
    Epoch  8/10: total=1.5640, vae=1.0687, dsb=0.4953, bio=0.0000
    Epoch  9/10: total=1.5461, vae=1.0681, dsb=0.4780, bio=0.0000
    Epoch 10/10: total=1.5571, vae=1.0687, dsb=0.4884, bio=0.0000

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=46.8697, vae=1.0687, dsb=45.8009, bio=0.0000
    Epoch  2/10: total=46.7839, vae=1.0680, dsb=45.7159, bio=0.0000
    Epoch  3/10: total=46.6053, vae=1.0676, dsb=45.5376, bio=0.0000
    Epoch  4/10: total=46.6541, vae=1.0678, dsb=45.5863, bio=0.0000
    Epoch  5/10: total=46.4397, vae=1.0685, dsb=45.3712, bio=0.0000
    Epoch  6/10: total=46.2442, vae=1.0681, dsb=45.1761, bio=0.0000
    Epoch  7/10: total=46.1375, vae=1.0678, dsb=45.0697, bio=0.0000
    Epoch  8/10: total=46.2824, vae=1.0680, dsb=45.2144, bio=0.0000
    Epoch  9/10: total=46.3281, vae=1.0682, dsb=45.2600, bio=0.0000
    Epoch 10/10: total=46.2306, vae=1.0680, dsb=45.1626, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.5046, vae=1.0689, dsb=0.4357, bio=0.0000
    Epoch  2/10: total=1.5123, vae=1.0679, dsb=0.4444, bio=0.0000
    Epoch  3/10: total=1.4773, vae=1.0676, dsb=0.4097, bio=0.0000
    Epoch  4/10: total=1.4904, vae=1.0678, dsb=0.4226, bio=0.0000
    Epoch  5/10: total=1.5045, vae=1.0686, dsb=0.4358, bio=0.0000
    Epoch  6/10: total=1.4813, vae=1.0671, dsb=0.4142, bio=0.0000
    Epoch  7/10: total=1.4972, vae=1.0684, dsb=0.4288, bio=0.0000
    Epoch  8/10: total=1.4890, vae=1.0680, dsb=0.4209, bio=0.0000
    Epoch  9/10: total=1.4893, vae=1.0680, dsb=0.4213, bio=0.0000
    Epoch 10/10: total=1.5003, vae=1.0682, dsb=0.4320, bio=0.0000

[Seed 38] Joint training (ablation) complete; models and history saved.

[Seed 38] Drift genes saved in /home/yyuan/ICB_TCE/iter_results/run_038

[Seed 38] run finished.

================================================================================
[Seed 39] Starting running whole pipeline...
================================================================================

[Seed 39] Starting VAE pre-training...

    Epoch [01/20], Beta: 0.000, Average Loss: 534.2295
    Epoch [02/20], Beta: 0.000, Average Loss: 307.9546
    Epoch [03/20], Beta: 0.000, Average Loss: 269.5920
    Epoch [04/20], Beta: 0.000, Average Loss: 250.0485
    Epoch [05/20], Beta: 0.100, Average Loss: 245.6848
    Epoch [06/20], Beta: 0.200, Average Loss: 245.1191
    Epoch [07/20], Beta: 0.300, Average Loss: 245.0873
    Epoch [08/20], Beta: 0.400, Average Loss: 245.4228
    Epoch [09/20], Beta: 0.500, Average Loss: 246.3605
    Epoch [10/20], Beta: 0.600, Average Loss: 247.4683
    Epoch [11/20], Beta: 0.700, Average Loss: 248.7379
    Epoch [12/20], Beta: 0.800, Average Loss: 249.9927
    Epoch [13/20], Beta: 0.900, Average Loss: 251.2701
    Epoch [14/20], Beta: 1.000, Average Loss: 252.5452
    Epoch [15/20], Beta: 1.000, Average Loss: 252.1156
    Epoch [16/20], Beta: 1.000, Average Loss: 251.7784
    Epoch [17/20], Beta: 1.000, Average Loss: 251.4959
    Epoch [18/20], Beta: 1.000, Average Loss: 251.1537
    Epoch [19/20], Beta: 1.000, Average Loss: 250.9181
    Epoch [20/20], Beta: 1.000, Average Loss: 250.5412

[Seed 39] VAE pre-training complete.

[Seed 39] Starting joint training (original)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=229.6318, vae=3.7336, dsb=208.7292, bio=34.3379
    Epoch  2/10: total=47.6786, vae=1.0942, dsb=46.5391, bio=0.0905
    Epoch  3/10: total=39.2827, vae=1.0890, dsb=38.1752, bio=0.0371
    Epoch  4/10: total=35.4333, vae=1.0876, dsb=34.3347, bio=0.0218
    Epoch  5/10: total=32.9511, vae=1.0865, dsb=31.8572, bio=0.0146
    Epoch  6/10: total=31.3755, vae=1.0855, dsb=30.2847, bio=0.0107
    Epoch  7/10: total=30.2531, vae=1.0853, dsb=29.1637, bio=0.0082
    Epoch  8/10: total=29.2905, vae=1.0842, dsb=28.2031, bio=0.0064
    Epoch  9/10: total=28.4624, vae=1.0848, dsb=27.3748, bio=0.0056
    Epoch 10/10: total=27.9446, vae=1.0843, dsb=26.8579, bio=0.0047

  [Backward Policy Training]
    Epoch  1/10: total=2.9245, vae=1.0855, dsb=1.8327, bio=0.0126
    Epoch  2/10: total=2.4025, vae=1.0839, dsb=1.3164, bio=0.0046
    Epoch  3/10: total=2.3236, vae=1.0837, dsb=1.2383, bio=0.0033
    Epoch  4/10: total=2.2606, vae=1.0831, dsb=1.1761, bio=0.0028
    Epoch  5/10: total=2.2088, vae=1.0822, dsb=1.1255, bio=0.0023
    Epoch  6/10: total=2.1868, vae=1.0825, dsb=1.1032, bio=0.0023
    Epoch  7/10: total=2.1517, vae=1.0822, dsb=1.0684, bio=0.0022
    Epoch  8/10: total=2.1797, vae=1.0821, dsb=1.0965, bio=0.0021
    Epoch  9/10: total=2.1388, vae=1.0822, dsb=1.0556, bio=0.0020
    Epoch 10/10: total=2.1128, vae=1.0824, dsb=1.0294, bio=0.0019

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=25.9284, vae=1.0851, dsb=24.8411, bio=0.0045
    Epoch  2/10: total=20.7483, vae=1.0836, dsb=19.6638, bio=0.0020
    Epoch  3/10: total=19.4921, vae=1.0832, dsb=18.4079, bio=0.0019
    Epoch  4/10: total=18.6595, vae=1.0843, dsb=17.5742, bio=0.0019
    Epoch  5/10: total=18.2622, vae=1.0824, dsb=17.1788, bio=0.0019
    Epoch  6/10: total=17.8475, vae=1.0816, dsb=16.7649, bio=0.0019
    Epoch  7/10: total=17.6134, vae=1.0828, dsb=16.5297, bio=0.0019
    Epoch  8/10: total=17.3931, vae=1.0828, dsb=16.3092, bio=0.0022
    Epoch  9/10: total=17.2235, vae=1.0820, dsb=16.1406, bio=0.0019
    Epoch 10/10: total=17.0629, vae=1.0831, dsb=15.9789, bio=0.0018

  [Backward Policy Training]
    Epoch  1/10: total=1.8799, vae=1.0827, dsb=0.7948, bio=0.0048
    Epoch  2/10: total=1.7735, vae=1.0809, dsb=0.6916, bio=0.0019
    Epoch  3/10: total=1.7454, vae=1.0816, dsb=0.6629, bio=0.0017
    Epoch  4/10: total=1.7367, vae=1.0809, dsb=0.6551, bio=0.0014
    Epoch  5/10: total=1.7184, vae=1.0813, dsb=0.6362, bio=0.0019
    Epoch  6/10: total=1.6988, vae=1.0813, dsb=0.6167, bio=0.0016
    Epoch  7/10: total=1.6703, vae=1.0811, dsb=0.5884, bio=0.0016
    Epoch  8/10: total=1.6754, vae=1.0816, dsb=0.5930, bio=0.0016
    Epoch  9/10: total=1.6736, vae=1.0807, dsb=0.5921, bio=0.0016
    Epoch 10/10: total=1.6605, vae=1.0809, dsb=0.5788, bio=0.0016

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=17.8793, vae=1.0837, dsb=16.7937, bio=0.0037
    Epoch  2/10: total=15.7370, vae=1.0830, dsb=14.6531, bio=0.0017
    Epoch  3/10: total=15.1555, vae=1.0827, dsb=14.0719, bio=0.0017
    Epoch  4/10: total=14.8678, vae=1.0819, dsb=13.7850, bio=0.0017
    Epoch  5/10: total=14.6394, vae=1.0821, dsb=13.5565, bio=0.0017
    Epoch  6/10: total=14.4941, vae=1.0823, dsb=13.4110, bio=0.0017
    Epoch  7/10: total=14.3745, vae=1.0824, dsb=13.2910, bio=0.0022
    Epoch  8/10: total=14.2976, vae=1.0814, dsb=13.2154, bio=0.0016
    Epoch  9/10: total=14.1986, vae=1.0819, dsb=13.1159, bio=0.0016
    Epoch 10/10: total=14.2286, vae=1.0817, dsb=13.1462, bio=0.0017

  [Backward Policy Training]
    Epoch  1/10: total=1.5864, vae=1.0817, dsb=0.5022, bio=0.0050
    Epoch  2/10: total=1.5234, vae=1.0805, dsb=0.4421, bio=0.0016
    Epoch  3/10: total=1.5254, vae=1.0812, dsb=0.4434, bio=0.0017
    Epoch  4/10: total=1.5170, vae=1.0808, dsb=0.4353, bio=0.0016
    Epoch  5/10: total=1.4999, vae=1.0806, dsb=0.4186, bio=0.0014
    Epoch  6/10: total=1.4773, vae=1.0809, dsb=0.3957, bio=0.0014
    Epoch  7/10: total=1.4880, vae=1.0804, dsb=0.4070, bio=0.0014
    Epoch  8/10: total=1.4806, vae=1.0804, dsb=0.3995, bio=0.0014
    Epoch  9/10: total=1.4882, vae=1.0801, dsb=0.4071, bio=0.0018
    Epoch 10/10: total=1.4782, vae=1.0800, dsb=0.3975, bio=0.0013

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=12.4052, vae=1.0832, dsb=11.3201, bio=0.0038
    Epoch  2/10: total=11.5408, vae=1.0822, dsb=10.4579, bio=0.0015
    Epoch  3/10: total=11.2770, vae=1.0807, dsb=10.1955, bio=0.0015
    Epoch  4/10: total=11.1696, vae=1.0808, dsb=10.0880, bio=0.0015
    Epoch  5/10: total=11.0950, vae=1.0816, dsb=10.0127, bio=0.0015
    Epoch  6/10: total=11.0343, vae=1.0813, dsb=9.9522, bio=0.0015
    Epoch  7/10: total=10.9735, vae=1.0804, dsb=9.8919, bio=0.0021
    Epoch  8/10: total=10.9708, vae=1.0810, dsb=9.8890, bio=0.0015
    Epoch  9/10: total=10.9440, vae=1.0817, dsb=9.8616, bio=0.0015
    Epoch 10/10: total=10.9014, vae=1.0814, dsb=9.8193, bio=0.0015

  [Backward Policy Training]
    Epoch  1/10: total=1.4285, vae=1.0808, dsb=0.3369, bio=0.0215
    Epoch  2/10: total=1.3911, vae=1.0809, dsb=0.3096, bio=0.0014
    Epoch  3/10: total=1.3929, vae=1.0813, dsb=0.3110, bio=0.0013
    Epoch  4/10: total=1.3759, vae=1.0803, dsb=0.2950, bio=0.0013
    Epoch  5/10: total=1.3809, vae=1.0806, dsb=0.2996, bio=0.0013
    Epoch  6/10: total=1.3767, vae=1.0804, dsb=0.2957, bio=0.0013
    Epoch  7/10: total=1.3874, vae=1.0802, dsb=0.3066, bio=0.0012
    Epoch  8/10: total=1.3738, vae=1.0800, dsb=0.2931, bio=0.0013
    Epoch  9/10: total=1.3786, vae=1.0811, dsb=0.2968, bio=0.0013
    Epoch 10/10: total=1.3736, vae=1.0798, dsb=0.2931, bio=0.0013

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=10.1650, vae=1.0833, dsb=9.0802, bio=0.0030
    Epoch  2/10: total=9.8377, vae=1.0815, dsb=8.7555, bio=0.0013
    Epoch  3/10: total=9.7139, vae=1.0811, dsb=8.6321, bio=0.0013
    Epoch  4/10: total=9.6861, vae=1.0810, dsb=8.6042, bio=0.0017
    Epoch  5/10: total=9.6702, vae=1.0811, dsb=8.5885, bio=0.0014
    Epoch  6/10: total=9.7219, vae=1.0809, dsb=8.6403, bio=0.0014
    Epoch  7/10: total=9.6248, vae=1.0809, dsb=8.5432, bio=0.0014
    Epoch  8/10: total=9.6259, vae=1.0808, dsb=8.5444, bio=0.0014
    Epoch  9/10: total=9.6229, vae=1.0811, dsb=8.5411, bio=0.0014
    Epoch 10/10: total=9.6615, vae=1.0800, dsb=8.5808, bio=0.0013

  [Backward Policy Training]
    Epoch  1/10: total=1.3575, vae=1.0813, dsb=0.2535, bio=0.0455
    Epoch  2/10: total=1.3247, vae=1.0802, dsb=0.2438, bio=0.0013
    Epoch  3/10: total=1.3191, vae=1.0795, dsb=0.2389, bio=0.0012
    Epoch  4/10: total=1.3158, vae=1.0796, dsb=0.2355, bio=0.0012
    Epoch  5/10: total=1.3236, vae=1.0796, dsb=0.2435, bio=0.0011
    Epoch  6/10: total=1.3184, vae=1.0798, dsb=0.2381, bio=0.0011
    Epoch  7/10: total=1.3150, vae=1.0796, dsb=0.2347, bio=0.0011
    Epoch  8/10: total=1.3144, vae=1.0796, dsb=0.2343, bio=0.0011
    Epoch  9/10: total=1.3177, vae=1.0794, dsb=0.2377, bio=0.0011
    Epoch 10/10: total=1.3162, vae=1.0795, dsb=0.2362, bio=0.0011

[Seed 39] Joint training (original) complete; models and history saved.

[Seed 39] Starting joint training (ablation)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=210.6002, vae=2.0280, dsb=208.5722, bio=0.0000
    Epoch  2/10: total=47.4296, vae=1.0762, dsb=46.3534, bio=0.0000
    Epoch  3/10: total=39.0128, vae=1.0744, dsb=37.9385, bio=0.0000
    Epoch  4/10: total=35.1089, vae=1.0741, dsb=34.0348, bio=0.0000
    Epoch  5/10: total=32.6405, vae=1.0735, dsb=31.5670, bio=0.0000
    Epoch  6/10: total=31.0707, vae=1.0728, dsb=29.9979, bio=0.0000
    Epoch  7/10: total=29.9921, vae=1.0729, dsb=28.9192, bio=0.0000
    Epoch  8/10: total=29.0497, vae=1.0721, dsb=27.9776, bio=0.0000
    Epoch  9/10: total=28.2421, vae=1.0730, dsb=27.1692, bio=0.0000
    Epoch 10/10: total=27.7022, vae=1.0727, dsb=26.6294, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=2.8706, vae=1.0729, dsb=1.7977, bio=0.0000
    Epoch  2/10: total=2.3592, vae=1.0730, dsb=1.2862, bio=0.0000
    Epoch  3/10: total=2.2823, vae=1.0733, dsb=1.2089, bio=0.0000
    Epoch  4/10: total=2.2196, vae=1.0730, dsb=1.1466, bio=0.0000
    Epoch  5/10: total=2.1684, vae=1.0723, dsb=1.0961, bio=0.0000
    Epoch  6/10: total=2.1459, vae=1.0727, dsb=1.0732, bio=0.0000
    Epoch  7/10: total=2.1112, vae=1.0726, dsb=1.0386, bio=0.0000
    Epoch  8/10: total=2.1386, vae=1.0726, dsb=1.0661, bio=0.0000
    Epoch  9/10: total=2.1004, vae=1.0727, dsb=1.0277, bio=0.0000
    Epoch 10/10: total=2.0755, vae=1.0730, dsb=1.0025, bio=0.0000

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=26.0770, vae=1.0723, dsb=25.0047, bio=0.0000
    Epoch  2/10: total=20.7019, vae=1.0726, dsb=19.6294, bio=0.0000
    Epoch  3/10: total=19.3392, vae=1.0725, dsb=18.2667, bio=0.0000
    Epoch  4/10: total=18.4620, vae=1.0737, dsb=17.3884, bio=0.0000
    Epoch  5/10: total=18.0381, vae=1.0719, dsb=16.9662, bio=0.0000
    Epoch  6/10: total=17.6230, vae=1.0712, dsb=16.5518, bio=0.0000
    Epoch  7/10: total=17.3785, vae=1.0724, dsb=16.3062, bio=0.0000
    Epoch  8/10: total=17.1368, vae=1.0725, dsb=16.0643, bio=0.0000
    Epoch  9/10: total=16.9625, vae=1.0718, dsb=15.8907, bio=0.0000
    Epoch 10/10: total=16.8067, vae=1.0730, dsb=15.7337, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.8443, vae=1.0724, dsb=0.7719, bio=0.0000
    Epoch  2/10: total=1.7445, vae=1.0719, dsb=0.6726, bio=0.0000
    Epoch  3/10: total=1.7168, vae=1.0727, dsb=0.6441, bio=0.0000
    Epoch  4/10: total=1.7078, vae=1.0720, dsb=0.6358, bio=0.0000
    Epoch  5/10: total=1.6914, vae=1.0725, dsb=0.6189, bio=0.0000
    Epoch  6/10: total=1.6721, vae=1.0726, dsb=0.5995, bio=0.0000
    Epoch  7/10: total=1.6445, vae=1.0724, dsb=0.5721, bio=0.0000
    Epoch  8/10: total=1.6493, vae=1.0729, dsb=0.5764, bio=0.0000
    Epoch  9/10: total=1.6479, vae=1.0720, dsb=0.5759, bio=0.0000
    Epoch 10/10: total=1.6345, vae=1.0723, dsb=0.5621, bio=0.0000

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=17.7835, vae=1.0718, dsb=16.7117, bio=0.0000
    Epoch  2/10: total=15.5578, vae=1.0730, dsb=14.4848, bio=0.0000
    Epoch  3/10: total=14.9620, vae=1.0729, dsb=13.8891, bio=0.0000
    Epoch  4/10: total=14.6586, vae=1.0722, dsb=13.5864, bio=0.0000
    Epoch  5/10: total=14.4220, vae=1.0724, dsb=13.3496, bio=0.0000
    Epoch  6/10: total=14.2701, vae=1.0726, dsb=13.1975, bio=0.0000
    Epoch  7/10: total=14.1499, vae=1.0728, dsb=13.0771, bio=0.0000
    Epoch  8/10: total=14.0585, vae=1.0719, dsb=12.9866, bio=0.0000
    Epoch  9/10: total=13.9644, vae=1.0725, dsb=12.8919, bio=0.0000
    Epoch 10/10: total=13.9904, vae=1.0723, dsb=12.9182, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.5536, vae=1.0720, dsb=0.4816, bio=0.0000
    Epoch  2/10: total=1.4954, vae=1.0720, dsb=0.4234, bio=0.0000
    Epoch  3/10: total=1.4967, vae=1.0728, dsb=0.4240, bio=0.0000
    Epoch  4/10: total=1.4879, vae=1.0725, dsb=0.4153, bio=0.0000
    Epoch  5/10: total=1.4706, vae=1.0723, dsb=0.3982, bio=0.0000
    Epoch  6/10: total=1.4484, vae=1.0727, dsb=0.3757, bio=0.0000
    Epoch  7/10: total=1.4578, vae=1.0722, dsb=0.3856, bio=0.0000
    Epoch  8/10: total=1.4504, vae=1.0722, dsb=0.3782, bio=0.0000
    Epoch  9/10: total=1.4570, vae=1.0720, dsb=0.3851, bio=0.0000
    Epoch 10/10: total=1.4471, vae=1.0720, dsb=0.3752, bio=0.0000

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=12.2599, vae=1.0718, dsb=11.1881, bio=0.0000
    Epoch  2/10: total=11.4233, vae=1.0728, dsb=10.3505, bio=0.0000
    Epoch  3/10: total=11.1667, vae=1.0715, dsb=10.0952, bio=0.0000
    Epoch  4/10: total=11.0690, vae=1.0716, dsb=9.9973, bio=0.0000
    Epoch  5/10: total=11.0115, vae=1.0726, dsb=9.9390, bio=0.0000
    Epoch  6/10: total=10.9585, vae=1.0723, dsb=9.8861, bio=0.0000
    Epoch  7/10: total=10.9032, vae=1.0715, dsb=9.8317, bio=0.0000
    Epoch  8/10: total=10.9205, vae=1.0722, dsb=9.8483, bio=0.0000
    Epoch  9/10: total=10.8763, vae=1.0730, dsb=9.8033, bio=0.0000
    Epoch 10/10: total=10.8452, vae=1.0727, dsb=9.7725, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.3812, vae=1.0717, dsb=0.3094, bio=0.0000
    Epoch  2/10: total=1.3590, vae=1.0728, dsb=0.2862, bio=0.0000
    Epoch  3/10: total=1.3614, vae=1.0733, dsb=0.2880, bio=0.0000
    Epoch  4/10: total=1.3451, vae=1.0724, dsb=0.2727, bio=0.0000
    Epoch  5/10: total=1.3500, vae=1.0729, dsb=0.2772, bio=0.0000
    Epoch  6/10: total=1.3461, vae=1.0726, dsb=0.2735, bio=0.0000
    Epoch  7/10: total=1.3566, vae=1.0725, dsb=0.2841, bio=0.0000
    Epoch  8/10: total=1.3436, vae=1.0724, dsb=0.2711, bio=0.0000
    Epoch  9/10: total=1.3485, vae=1.0736, dsb=0.2749, bio=0.0000
    Epoch 10/10: total=1.3437, vae=1.0724, dsb=0.2713, bio=0.0000

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=10.0910, vae=1.0727, dsb=9.0183, bio=0.0000
    Epoch  2/10: total=9.8456, vae=1.0721, dsb=8.7735, bio=0.0000
    Epoch  3/10: total=9.7425, vae=1.0719, dsb=8.6705, bio=0.0000
    Epoch  4/10: total=9.7212, vae=1.0722, dsb=8.6490, bio=0.0000
    Epoch  5/10: total=9.7163, vae=1.0724, dsb=8.6439, bio=0.0000
    Epoch  6/10: total=9.7704, vae=1.0724, dsb=8.6980, bio=0.0000
    Epoch  7/10: total=9.6718, vae=1.0725, dsb=8.5993, bio=0.0000
    Epoch  8/10: total=9.6773, vae=1.0724, dsb=8.6049, bio=0.0000
    Epoch  9/10: total=9.6739, vae=1.0728, dsb=8.6011, bio=0.0000
    Epoch 10/10: total=9.7165, vae=1.0719, dsb=8.6447, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.3043, vae=1.0726, dsb=0.2317, bio=0.0000
    Epoch  2/10: total=1.2965, vae=1.0726, dsb=0.2239, bio=0.0000
    Epoch  3/10: total=1.2917, vae=1.0720, dsb=0.2197, bio=0.0000
    Epoch  4/10: total=1.2889, vae=1.0723, dsb=0.2166, bio=0.0000
    Epoch  5/10: total=1.2966, vae=1.0723, dsb=0.2242, bio=0.0000
    Epoch  6/10: total=1.2918, vae=1.0726, dsb=0.2192, bio=0.0000
    Epoch  7/10: total=1.2887, vae=1.0726, dsb=0.2161, bio=0.0000
    Epoch  8/10: total=1.2882, vae=1.0726, dsb=0.2156, bio=0.0000
    Epoch  9/10: total=1.2916, vae=1.0725, dsb=0.2191, bio=0.0000
    Epoch 10/10: total=1.2903, vae=1.0727, dsb=0.2176, bio=0.0000

[Seed 39] Joint training (ablation) complete; models and history saved.

[Seed 39] Drift genes saved in /home/yyuan/ICB_TCE/iter_results/run_039

[Seed 39] run finished.

================================================================================
[Seed 40] Starting running whole pipeline...
================================================================================

[Seed 40] Starting VAE pre-training...

    Epoch [01/20], Beta: 0.000, Average Loss: 537.6831
    Epoch [02/20], Beta: 0.000, Average Loss: 304.4765
    Epoch [03/20], Beta: 0.000, Average Loss: 269.3405
    Epoch [04/20], Beta: 0.000, Average Loss: 251.2961
    Epoch [05/20], Beta: 0.100, Average Loss: 246.4877
    Epoch [06/20], Beta: 0.200, Average Loss: 245.4102
    Epoch [07/20], Beta: 0.300, Average Loss: 245.4619
    Epoch [08/20], Beta: 0.400, Average Loss: 245.9099
    Epoch [09/20], Beta: 0.500, Average Loss: 246.7875
    Epoch [10/20], Beta: 0.600, Average Loss: 247.9291
    Epoch [11/20], Beta: 0.700, Average Loss: 249.1761
    Epoch [12/20], Beta: 0.800, Average Loss: 250.5415
    Epoch [13/20], Beta: 0.900, Average Loss: 251.7763
    Epoch [14/20], Beta: 1.000, Average Loss: 253.4101
    Epoch [15/20], Beta: 1.000, Average Loss: 252.9605
    Epoch [16/20], Beta: 1.000, Average Loss: 252.6418
    Epoch [17/20], Beta: 1.000, Average Loss: 252.2720
    Epoch [18/20], Beta: 1.000, Average Loss: 251.9230
    Epoch [19/20], Beta: 1.000, Average Loss: 251.5854
    Epoch [20/20], Beta: 1.000, Average Loss: 251.3935

[Seed 40] VAE pre-training complete.

[Seed 40] Starting joint training (original)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=256.3611, vae=3.6745, dsb=231.6226, bio=42.1279
    Epoch  2/10: total=72.3605, vae=1.1168, dsb=71.2068, bio=0.0737
    Epoch  3/10: total=63.8974, vae=1.1136, dsb=62.7678, bio=0.0320
    Epoch  4/10: total=59.4900, vae=1.1122, dsb=58.3681, bio=0.0193
    Epoch  5/10: total=57.1514, vae=1.1116, dsb=56.0333, bio=0.0130
    Epoch  6/10: total=55.6557, vae=1.1098, dsb=54.5411, bio=0.0096
    Epoch  7/10: total=54.1440, vae=1.1094, dsb=53.0309, bio=0.0075
    Epoch  8/10: total=53.2613, vae=1.1099, dsb=52.1484, bio=0.0060
    Epoch  9/10: total=52.6228, vae=1.1094, dsb=51.5109, bio=0.0050
    Epoch 10/10: total=52.1649, vae=1.1089, dsb=51.0538, bio=0.0043

  [Backward Policy Training]
    Epoch  1/10: total=3.0884, vae=1.1104, dsb=1.9710, bio=0.0138
    Epoch  2/10: total=2.6271, vae=1.1081, dsb=1.5167, bio=0.0047
    Epoch  3/10: total=2.5236, vae=1.1077, dsb=1.4142, bio=0.0034
    Epoch  4/10: total=2.4425, vae=1.1084, dsb=1.3327, bio=0.0029
    Epoch  5/10: total=2.3318, vae=1.1073, dsb=1.2232, bio=0.0025
    Epoch  6/10: total=2.3415, vae=1.1078, dsb=1.2325, bio=0.0023
    Epoch  7/10: total=2.3439, vae=1.1066, dsb=1.2361, bio=0.0024
    Epoch  8/10: total=2.3154, vae=1.1074, dsb=1.2070, bio=0.0020
    Epoch  9/10: total=2.3054, vae=1.1064, dsb=1.1980, bio=0.0019
    Epoch 10/10: total=2.3098, vae=1.1066, dsb=1.2022, bio=0.0019

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=46.7134, vae=1.1092, dsb=45.6026, bio=0.0033
    Epoch  2/10: total=41.3191, vae=1.1083, dsb=40.2100, bio=0.0017
    Epoch  3/10: total=39.8672, vae=1.1080, dsb=38.7583, bio=0.0017
    Epoch  4/10: total=39.2424, vae=1.1081, dsb=38.1335, bio=0.0016
    Epoch  5/10: total=38.7204, vae=1.1074, dsb=37.6122, bio=0.0016
    Epoch  6/10: total=38.2900, vae=1.1071, dsb=37.1821, bio=0.0016
    Epoch  7/10: total=38.1539, vae=1.1080, dsb=37.0451, bio=0.0015
    Epoch  8/10: total=37.9994, vae=1.1074, dsb=36.8913, bio=0.0015
    Epoch  9/10: total=37.7741, vae=1.1073, dsb=36.6661, bio=0.0015
    Epoch 10/10: total=37.7517, vae=1.1066, dsb=36.6444, bio=0.0014

  [Backward Policy Training]
    Epoch  1/10: total=2.0579, vae=1.1074, dsb=0.9438, bio=0.0134
    Epoch  2/10: total=1.9544, vae=1.1065, dsb=0.8471, bio=0.0017
    Epoch  3/10: total=1.9159, vae=1.1061, dsb=0.8090, bio=0.0015
    Epoch  4/10: total=1.9098, vae=1.1058, dsb=0.8033, bio=0.0014
    Epoch  5/10: total=1.8929, vae=1.1055, dsb=0.7868, bio=0.0013
    Epoch  6/10: total=1.8744, vae=1.1056, dsb=0.7682, bio=0.0013
    Epoch  7/10: total=1.8599, vae=1.1060, dsb=0.7533, bio=0.0013
    Epoch  8/10: total=1.8491, vae=1.1050, dsb=0.7435, bio=0.0013
    Epoch  9/10: total=1.8554, vae=1.1054, dsb=0.7493, bio=0.0012
    Epoch 10/10: total=1.8533, vae=1.1049, dsb=0.7477, bio=0.0014

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=32.9808, vae=1.1081, dsb=31.8714, bio=0.0024
    Epoch  2/10: total=30.9439, vae=1.1070, dsb=29.8363, bio=0.0011
    Epoch  3/10: total=30.4459, vae=1.1061, dsb=29.3392, bio=0.0011
    Epoch  4/10: total=30.1702, vae=1.1052, dsb=29.0644, bio=0.0011
    Epoch  5/10: total=29.8886, vae=1.1059, dsb=28.7822, bio=0.0011
    Epoch  6/10: total=29.9708, vae=1.1057, dsb=28.8647, bio=0.0007
    Epoch  7/10: total=29.7270, vae=1.1057, dsb=28.6208, bio=0.0009
    Epoch  8/10: total=29.6416, vae=1.1054, dsb=28.5356, bio=0.0013
    Epoch  9/10: total=29.6491, vae=1.1060, dsb=28.5428, bio=0.0006
    Epoch 10/10: total=29.5517, vae=1.1052, dsb=28.4460, bio=0.0011

  [Backward Policy Training]
    Epoch  1/10: total=1.8044, vae=1.1062, dsb=0.6573, bio=0.0817
    Epoch  2/10: total=1.6890, vae=1.1051, dsb=0.5831, bio=0.0014
    Epoch  3/10: total=1.6776, vae=1.1058, dsb=0.5712, bio=0.0012
    Epoch  4/10: total=1.6776, vae=1.1051, dsb=0.5719, bio=0.0011
    Epoch  5/10: total=1.6785, vae=1.1055, dsb=0.5725, bio=0.0011
    Epoch  6/10: total=1.6591, vae=1.1049, dsb=0.5536, bio=0.0010
    Epoch  7/10: total=1.6579, vae=1.1055, dsb=0.5519, bio=0.0010
    Epoch  8/10: total=1.6470, vae=1.1050, dsb=0.5415, bio=0.0011
    Epoch  9/10: total=1.6404, vae=1.1044, dsb=0.5355, bio=0.0010
    Epoch 10/10: total=1.6531, vae=1.1047, dsb=0.5479, bio=0.0010

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=28.3863, vae=1.1076, dsb=27.2776, bio=0.0022
    Epoch  2/10: total=27.5208, vae=1.1060, dsb=26.4146, bio=0.0005
    Epoch  3/10: total=27.3558, vae=1.1052, dsb=26.2501, bio=0.0009
    Epoch  4/10: total=27.2155, vae=1.1055, dsb=26.1095, bio=0.0011
    Epoch  5/10: total=27.0434, vae=1.1062, dsb=25.9369, bio=0.0005
    Epoch  6/10: total=27.0869, vae=1.1053, dsb=25.9814, bio=0.0004
    Epoch  7/10: total=26.9686, vae=1.1052, dsb=25.8629, bio=0.0008
    Epoch  8/10: total=26.9682, vae=1.1048, dsb=25.8631, bio=0.0005
    Epoch  9/10: total=26.9688, vae=1.1053, dsb=25.8632, bio=0.0007
    Epoch 10/10: total=26.9139, vae=1.1044, dsb=25.8090, bio=0.0009

  [Backward Policy Training]
    Epoch  1/10: total=1.6622, vae=1.1073, dsb=0.4717, bio=0.1664
    Epoch  2/10: total=1.5663, vae=1.1045, dsb=0.4611, bio=0.0014
    Epoch  3/10: total=1.5713, vae=1.1052, dsb=0.4656, bio=0.0011
    Epoch  4/10: total=1.5448, vae=1.1046, dsb=0.4399, bio=0.0007
    Epoch  5/10: total=1.5396, vae=1.1051, dsb=0.4339, bio=0.0011
    Epoch  6/10: total=1.5484, vae=1.1045, dsb=0.4433, bio=0.0011
    Epoch  7/10: total=1.5484, vae=1.1039, dsb=0.4440, bio=0.0010
    Epoch  8/10: total=1.5464, vae=1.1042, dsb=0.4417, bio=0.0010
    Epoch  9/10: total=1.5429, vae=1.1041, dsb=0.4384, bio=0.0007
    Epoch 10/10: total=1.5436, vae=1.1033, dsb=0.4401, bio=0.0006

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=24.9217, vae=1.1076, dsb=23.8131, bio=0.0018
    Epoch  2/10: total=24.5923, vae=1.1054, dsb=23.4866, bio=0.0005
    Epoch  3/10: total=24.4497, vae=1.1046, dsb=23.3448, bio=0.0005
    Epoch  4/10: total=24.3774, vae=1.1045, dsb=23.2727, bio=0.0005
    Epoch  5/10: total=24.4343, vae=1.1052, dsb=23.3289, bio=0.0004
    Epoch  6/10: total=24.4520, vae=1.1042, dsb=23.3476, bio=0.0004
    Epoch  7/10: total=24.3070, vae=1.1048, dsb=23.2019, bio=0.0005
    Epoch  8/10: total=24.3322, vae=1.1047, dsb=23.2268, bio=0.0015
    Epoch  9/10: total=24.3362, vae=1.1040, dsb=23.2321, bio=0.0003
    Epoch 10/10: total=24.2532, vae=1.1045, dsb=23.1481, bio=0.0010

  [Backward Policy Training]
    Epoch  1/10: total=1.5927, vae=1.1058, dsb=0.3796, bio=0.2147
    Epoch  2/10: total=1.4861, vae=1.1048, dsb=0.3808, bio=0.0012
    Epoch  3/10: total=1.4838, vae=1.1043, dsb=0.3793, bio=0.0005
    Epoch  4/10: total=1.4879, vae=1.1047, dsb=0.3825, bio=0.0014
    Epoch  5/10: total=1.4805, vae=1.1048, dsb=0.3752, bio=0.0009
    Epoch  6/10: total=1.4688, vae=1.1051, dsb=0.3635, bio=0.0003
    Epoch  7/10: total=1.4647, vae=1.1041, dsb=0.3604, bio=0.0005
    Epoch  8/10: total=1.4871, vae=1.1043, dsb=0.3822, bio=0.0011
    Epoch  9/10: total=1.4769, vae=1.1037, dsb=0.3727, bio=0.0010
    Epoch 10/10: total=1.4833, vae=1.1042, dsb=0.3789, bio=0.0006

[Seed 40] Joint training (original) complete; models and history saved.

[Seed 40] Starting joint training (ablation)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=233.3410, vae=2.0026, dsb=231.3385, bio=0.0000
    Epoch  2/10: total=72.0529, vae=1.1011, dsb=70.9517, bio=0.0000
    Epoch  3/10: total=63.7116, vae=1.1000, dsb=62.6117, bio=0.0000
    Epoch  4/10: total=59.3107, vae=1.0992, dsb=58.2115, bio=0.0000
    Epoch  5/10: total=56.9761, vae=1.0989, dsb=55.8772, bio=0.0000
    Epoch  6/10: total=55.4747, vae=1.0974, dsb=54.3772, bio=0.0000
    Epoch  7/10: total=53.9128, vae=1.0973, dsb=52.8154, bio=0.0000
    Epoch  8/10: total=52.9748, vae=1.0981, dsb=51.8768, bio=0.0000
    Epoch  9/10: total=52.3174, vae=1.0978, dsb=51.2195, bio=0.0000
    Epoch 10/10: total=51.8523, vae=1.0976, dsb=50.7547, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=2.9810, vae=1.0977, dsb=1.8833, bio=0.0000
    Epoch  2/10: total=2.5465, vae=1.0973, dsb=1.4492, bio=0.0000
    Epoch  3/10: total=2.4499, vae=1.0973, dsb=1.3526, bio=0.0000
    Epoch  4/10: total=2.3726, vae=1.0983, dsb=1.2743, bio=0.0000
    Epoch  5/10: total=2.2677, vae=1.0974, dsb=1.1703, bio=0.0000
    Epoch  6/10: total=2.2784, vae=1.0980, dsb=1.1804, bio=0.0000
    Epoch  7/10: total=2.2826, vae=1.0969, dsb=1.1857, bio=0.0000
    Epoch  8/10: total=2.2557, vae=1.0978, dsb=1.1578, bio=0.0000
    Epoch  9/10: total=2.2469, vae=1.0970, dsb=1.1500, bio=0.0000
    Epoch 10/10: total=2.2522, vae=1.0973, dsb=1.1549, bio=0.0000

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=46.0418, vae=1.0972, dsb=44.9446, bio=0.0000
    Epoch  2/10: total=40.8407, vae=1.0975, dsb=39.7432, bio=0.0000
    Epoch  3/10: total=39.4626, vae=1.0976, dsb=38.3650, bio=0.0000
    Epoch  4/10: total=38.9034, vae=1.0978, dsb=37.8056, bio=0.0000
    Epoch  5/10: total=38.4276, vae=1.0973, dsb=37.3304, bio=0.0000
    Epoch  6/10: total=38.0171, vae=1.0971, dsb=36.9201, bio=0.0000
    Epoch  7/10: total=37.8779, vae=1.0981, dsb=36.7798, bio=0.0000
    Epoch  8/10: total=37.7218, vae=1.0976, dsb=36.6242, bio=0.0000
    Epoch  9/10: total=37.4921, vae=1.0976, dsb=36.3945, bio=0.0000
    Epoch 10/10: total=37.4730, vae=1.0970, dsb=36.3760, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.9787, vae=1.0973, dsb=0.8814, bio=0.0000
    Epoch  2/10: total=1.8877, vae=1.0975, dsb=0.7901, bio=0.0000
    Epoch  3/10: total=1.8517, vae=1.0974, dsb=0.7543, bio=0.0000
    Epoch  4/10: total=1.8461, vae=1.0971, dsb=0.7489, bio=0.0000
    Epoch  5/10: total=1.8303, vae=1.0969, dsb=0.7334, bio=0.0000
    Epoch  6/10: total=1.8133, vae=1.0970, dsb=0.7163, bio=0.0000
    Epoch  7/10: total=1.7995, vae=1.0975, dsb=0.7021, bio=0.0000
    Epoch  8/10: total=1.7885, vae=1.0966, dsb=0.6919, bio=0.0000
    Epoch  9/10: total=1.7947, vae=1.0971, dsb=0.6977, bio=0.0000
    Epoch 10/10: total=1.7926, vae=1.0965, dsb=0.6960, bio=0.0000

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=31.9241, vae=1.0974, dsb=30.8268, bio=0.0000
    Epoch  2/10: total=30.0230, vae=1.0976, dsb=28.9254, bio=0.0000
    Epoch  3/10: total=29.5925, vae=1.0969, dsb=28.4956, bio=0.0000
    Epoch  4/10: total=29.3441, vae=1.0961, dsb=28.2480, bio=0.0000
    Epoch  5/10: total=29.0800, vae=1.0969, dsb=27.9831, bio=0.0000
    Epoch  6/10: total=29.1837, vae=1.0967, dsb=28.0870, bio=0.0000
    Epoch  7/10: total=28.9278, vae=1.0969, dsb=27.8309, bio=0.0000
    Epoch  8/10: total=28.8433, vae=1.0968, dsb=27.7465, bio=0.0000
    Epoch  9/10: total=28.8555, vae=1.0974, dsb=27.7582, bio=0.0000
    Epoch 10/10: total=28.7803, vae=1.0967, dsb=27.6836, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.6827, vae=1.0967, dsb=0.5861, bio=0.0000
    Epoch  2/10: total=1.6149, vae=1.0969, dsb=0.5180, bio=0.0000
    Epoch  3/10: total=1.6052, vae=1.0977, dsb=0.5075, bio=0.0000
    Epoch  4/10: total=1.6050, vae=1.0971, dsb=0.5079, bio=0.0000
    Epoch  5/10: total=1.6062, vae=1.0974, dsb=0.5088, bio=0.0000
    Epoch  6/10: total=1.5886, vae=1.0969, dsb=0.4917, bio=0.0000
    Epoch  7/10: total=1.5876, vae=1.0975, dsb=0.4901, bio=0.0000
    Epoch  8/10: total=1.5774, vae=1.0970, dsb=0.4804, bio=0.0000
    Epoch  9/10: total=1.5713, vae=1.0966, dsb=0.4748, bio=0.0000
    Epoch 10/10: total=1.5827, vae=1.0969, dsb=0.4858, bio=0.0000

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=26.7902, vae=1.0974, dsb=25.6928, bio=0.0000
    Epoch  2/10: total=25.9826, vae=1.0972, dsb=24.8854, bio=0.0000
    Epoch  3/10: total=25.8400, vae=1.0968, dsb=24.7432, bio=0.0000
    Epoch  4/10: total=25.7221, vae=1.0971, dsb=24.6250, bio=0.0000
    Epoch  5/10: total=25.5588, vae=1.0979, dsb=24.4609, bio=0.0000
    Epoch  6/10: total=25.6209, vae=1.0972, dsb=24.5237, bio=0.0000
    Epoch  7/10: total=25.5085, vae=1.0972, dsb=24.4113, bio=0.0000
    Epoch  8/10: total=25.4921, vae=1.0968, dsb=24.3953, bio=0.0000
    Epoch  9/10: total=25.5264, vae=1.0973, dsb=24.4291, bio=0.0000
    Epoch 10/10: total=25.4682, vae=1.0966, dsb=24.3716, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.5050, vae=1.0981, dsb=0.4068, bio=0.0000
    Epoch  2/10: total=1.4954, vae=1.0966, dsb=0.3988, bio=0.0000
    Epoch  3/10: total=1.5008, vae=1.0973, dsb=0.4035, bio=0.0000
    Epoch  4/10: total=1.4774, vae=1.0968, dsb=0.3807, bio=0.0000
    Epoch  5/10: total=1.4730, vae=1.0975, dsb=0.3755, bio=0.0000
    Epoch  6/10: total=1.4811, vae=1.0970, dsb=0.3841, bio=0.0000
    Epoch  7/10: total=1.4812, vae=1.0963, dsb=0.3849, bio=0.0000
    Epoch  8/10: total=1.4798, vae=1.0966, dsb=0.3832, bio=0.0000
    Epoch  9/10: total=1.4765, vae=1.0966, dsb=0.3799, bio=0.0000
    Epoch 10/10: total=1.4775, vae=1.0957, dsb=0.3818, bio=0.0000

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=22.9158, vae=1.0977, dsb=21.8181, bio=0.0000
    Epoch  2/10: total=22.7109, vae=1.0969, dsb=21.6140, bio=0.0000
    Epoch  3/10: total=22.6147, vae=1.0965, dsb=21.5182, bio=0.0000
    Epoch  4/10: total=22.5579, vae=1.0965, dsb=21.4614, bio=0.0000
    Epoch  5/10: total=22.6117, vae=1.0974, dsb=21.5144, bio=0.0000
    Epoch  6/10: total=22.6472, vae=1.0964, dsb=21.5508, bio=0.0000
    Epoch  7/10: total=22.5128, vae=1.0971, dsb=21.4157, bio=0.0000
    Epoch  8/10: total=22.5448, vae=1.0970, dsb=21.4478, bio=0.0000
    Epoch  9/10: total=22.5420, vae=1.0963, dsb=21.4457, bio=0.0000
    Epoch 10/10: total=22.4875, vae=1.0970, dsb=21.3905, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.4202, vae=1.0968, dsb=0.3234, bio=0.0000
    Epoch  2/10: total=1.4238, vae=1.0971, dsb=0.3267, bio=0.0000
    Epoch  3/10: total=1.4231, vae=1.0967, dsb=0.3263, bio=0.0000
    Epoch  4/10: total=1.4271, vae=1.0974, dsb=0.3297, bio=0.0000
    Epoch  5/10: total=1.4212, vae=1.0975, dsb=0.3237, bio=0.0000
    Epoch  6/10: total=1.4112, vae=1.0978, dsb=0.3134, bio=0.0000
    Epoch  7/10: total=1.4077, vae=1.0969, dsb=0.3107, bio=0.0000
    Epoch  8/10: total=1.4281, vae=1.0973, dsb=0.3308, bio=0.0000
    Epoch  9/10: total=1.4193, vae=1.0968, dsb=0.3225, bio=0.0000
    Epoch 10/10: total=1.4255, vae=1.0972, dsb=0.3283, bio=0.0000

[Seed 40] Joint training (ablation) complete; models and history saved.

[Seed 40] Drift genes saved in /home/yyuan/ICB_TCE/iter_results/run_040

[Seed 40] run finished.

================================================================================
[Seed 41] Starting running whole pipeline...
================================================================================

[Seed 41] Starting VAE pre-training...

    Epoch [01/20], Beta: 0.000, Average Loss: 535.8245
    Epoch [02/20], Beta: 0.000, Average Loss: 306.6449
    Epoch [03/20], Beta: 0.000, Average Loss: 267.6382
    Epoch [04/20], Beta: 0.000, Average Loss: 247.4570
    Epoch [05/20], Beta: 0.100, Average Loss: 244.3527
    Epoch [06/20], Beta: 0.200, Average Loss: 244.3385
    Epoch [07/20], Beta: 0.300, Average Loss: 245.1129
    Epoch [08/20], Beta: 0.400, Average Loss: 245.9032
    Epoch [09/20], Beta: 0.500, Average Loss: 246.9346
    Epoch [10/20], Beta: 0.600, Average Loss: 248.0833
    Epoch [11/20], Beta: 0.700, Average Loss: 249.2924
    Epoch [12/20], Beta: 0.800, Average Loss: 250.5542
    Epoch [13/20], Beta: 0.900, Average Loss: 252.2543
    Epoch [14/20], Beta: 1.000, Average Loss: 253.8213
    Epoch [15/20], Beta: 1.000, Average Loss: 253.4118
    Epoch [16/20], Beta: 1.000, Average Loss: 252.9294
    Epoch [17/20], Beta: 1.000, Average Loss: 252.6365
    Epoch [18/20], Beta: 1.000, Average Loss: 252.2073
    Epoch [19/20], Beta: 1.000, Average Loss: 252.0518
    Epoch [20/20], Beta: 1.000, Average Loss: 251.8578

[Seed 41] VAE pre-training complete.

[Seed 41] Starting joint training (original)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=339.3699, vae=3.6040, dsb=317.0349, bio=37.4621
    Epoch  2/10: total=87.4847, vae=1.0970, dsb=86.3464, bio=0.0826
    Epoch  3/10: total=78.8918, vae=1.0920, dsb=77.7818, bio=0.0359
    Epoch  4/10: total=75.1478, vae=1.0909, dsb=74.0467, bio=0.0204
    Epoch  5/10: total=73.0863, vae=1.0897, dsb=71.9897, bio=0.0139
    Epoch  6/10: total=71.3711, vae=1.0888, dsb=70.2774, bio=0.0100
    Epoch  7/10: total=70.1406, vae=1.0890, dsb=69.0477, bio=0.0079
    Epoch  8/10: total=68.8239, vae=1.0877, dsb=67.7330, bio=0.0065
    Epoch  9/10: total=68.1627, vae=1.0880, dsb=67.0719, bio=0.0055
    Epoch 10/10: total=68.1542, vae=1.0886, dsb=67.0633, bio=0.0048

  [Backward Policy Training]
    Epoch  1/10: total=3.0999, vae=1.0903, dsb=2.0017, bio=0.0160
    Epoch  2/10: total=2.6216, vae=1.0870, dsb=1.5320, bio=0.0051
    Epoch  3/10: total=2.5200, vae=1.0875, dsb=1.4307, bio=0.0036
    Epoch  4/10: total=2.4571, vae=1.0862, dsb=1.3695, bio=0.0029
    Epoch  5/10: total=2.4040, vae=1.0860, dsb=1.3167, bio=0.0026
    Epoch  6/10: total=2.3654, vae=1.0854, dsb=1.2788, bio=0.0023
    Epoch  7/10: total=2.3368, vae=1.0863, dsb=1.2494, bio=0.0022
    Epoch  8/10: total=2.3422, vae=1.0862, dsb=1.2549, bio=0.0021
    Epoch  9/10: total=2.3307, vae=1.0865, dsb=1.2432, bio=0.0020
    Epoch 10/10: total=2.2879, vae=1.0857, dsb=1.2012, bio=0.0019

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=59.2393, vae=1.0882, dsb=58.1489, bio=0.0041
    Epoch  2/10: total=54.5326, vae=1.0875, dsb=53.4441, bio=0.0021
    Epoch  3/10: total=53.4693, vae=1.0868, dsb=52.3815, bio=0.0020
    Epoch  4/10: total=52.8096, vae=1.0873, dsb=51.7213, bio=0.0019
    Epoch  5/10: total=51.8169, vae=1.0862, dsb=50.7297, bio=0.0019
    Epoch  6/10: total=52.2909, vae=1.0871, dsb=51.2028, bio=0.0019
    Epoch  7/10: total=51.5046, vae=1.0861, dsb=50.4176, bio=0.0019
    Epoch  8/10: total=51.4740, vae=1.0855, dsb=50.3876, bio=0.0019
    Epoch  9/10: total=51.0345, vae=1.0853, dsb=49.9482, bio=0.0019
    Epoch 10/10: total=51.0192, vae=1.0856, dsb=49.9323, bio=0.0026

  [Backward Policy Training]
    Epoch  1/10: total=2.0778, vae=1.0872, dsb=0.9875, bio=0.0061
    Epoch  2/10: total=1.9288, vae=1.0837, dsb=0.8441, bio=0.0019
    Epoch  3/10: total=1.9177, vae=1.0845, dsb=0.8323, bio=0.0017
    Epoch  4/10: total=1.9251, vae=1.0840, dsb=0.8403, bio=0.0017
    Epoch  5/10: total=1.8960, vae=1.0839, dsb=0.8113, bio=0.0016
    Epoch  6/10: total=1.8721, vae=1.0849, dsb=0.7864, bio=0.0016
    Epoch  7/10: total=1.8954, vae=1.0846, dsb=0.8100, bio=0.0016
    Epoch  8/10: total=1.8606, vae=1.0845, dsb=0.7753, bio=0.0016
    Epoch  9/10: total=1.8734, vae=1.0840, dsb=0.7884, bio=0.0021
    Epoch 10/10: total=1.8801, vae=1.0843, dsb=0.7950, bio=0.0015

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=46.1268, vae=1.0866, dsb=45.0387, bio=0.0032
    Epoch  2/10: total=44.9524, vae=1.0852, dsb=43.8663, bio=0.0017
    Epoch  3/10: total=44.1661, vae=1.0858, dsb=43.0795, bio=0.0017
    Epoch  4/10: total=44.0594, vae=1.0852, dsb=42.9734, bio=0.0016
    Epoch  5/10: total=43.9772, vae=1.0848, dsb=42.8916, bio=0.0016
    Epoch  6/10: total=43.7742, vae=1.0849, dsb=42.6883, bio=0.0019
    Epoch  7/10: total=43.3990, vae=1.0853, dsb=42.3130, bio=0.0016
    Epoch  8/10: total=43.4829, vae=1.0846, dsb=42.3975, bio=0.0016
    Epoch  9/10: total=43.3019, vae=1.0849, dsb=42.2161, bio=0.0016
    Epoch 10/10: total=43.6157, vae=1.0849, dsb=42.5300, bio=0.0016

  [Backward Policy Training]
    Epoch  1/10: total=1.7467, vae=1.0844, dsb=0.6543, bio=0.0161
    Epoch  2/10: total=1.6988, vae=1.0842, dsb=0.6138, bio=0.0016
    Epoch  3/10: total=1.6668, vae=1.0855, dsb=0.5806, bio=0.0015
    Epoch  4/10: total=1.6634, vae=1.0836, dsb=0.5790, bio=0.0015
    Epoch  5/10: total=1.6578, vae=1.0834, dsb=0.5737, bio=0.0014
    Epoch  6/10: total=1.6565, vae=1.0836, dsb=0.5722, bio=0.0014
    Epoch  7/10: total=1.6301, vae=1.0836, dsb=0.5458, bio=0.0014
    Epoch  8/10: total=1.6429, vae=1.0844, dsb=0.5578, bio=0.0014
    Epoch  9/10: total=1.6529, vae=1.0833, dsb=0.5690, bio=0.0013
    Epoch 10/10: total=1.6386, vae=1.0829, dsb=0.5550, bio=0.0014

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=41.1534, vae=1.0861, dsb=40.0655, bio=0.0036
    Epoch  2/10: total=40.4857, vae=1.0849, dsb=39.4000, bio=0.0015
    Epoch  3/10: total=40.1749, vae=1.0842, dsb=39.0899, bio=0.0015
    Epoch  4/10: total=40.2776, vae=1.0840, dsb=39.1928, bio=0.0015
    Epoch  5/10: total=40.3280, vae=1.0844, dsb=39.2428, bio=0.0014
    Epoch  6/10: total=40.0136, vae=1.0838, dsb=38.9291, bio=0.0014
    Epoch  7/10: total=40.1290, vae=1.0844, dsb=39.0438, bio=0.0017
    Epoch  8/10: total=39.9042, vae=1.0843, dsb=38.8192, bio=0.0013
    Epoch  9/10: total=40.0403, vae=1.0838, dsb=38.9558, bio=0.0013
    Epoch 10/10: total=39.7854, vae=1.0833, dsb=38.7014, bio=0.0013

  [Backward Policy Training]
    Epoch  1/10: total=1.6032, vae=1.0848, dsb=0.4871, bio=0.0625
    Epoch  2/10: total=1.5434, vae=1.0844, dsb=0.4582, bio=0.0015
    Epoch  3/10: total=1.5529, vae=1.0830, dsb=0.4692, bio=0.0013
    Epoch  4/10: total=1.5343, vae=1.0833, dsb=0.4504, bio=0.0013
    Epoch  5/10: total=1.5287, vae=1.0840, dsb=0.4440, bio=0.0013
    Epoch  6/10: total=1.5299, vae=1.0831, dsb=0.4462, bio=0.0012
    Epoch  7/10: total=1.5444, vae=1.0832, dsb=0.4607, bio=0.0012
    Epoch  8/10: total=1.5271, vae=1.0835, dsb=0.4431, bio=0.0012
    Epoch  9/10: total=1.5415, vae=1.0825, dsb=0.4584, bio=0.0012
    Epoch 10/10: total=1.5192, vae=1.0823, dsb=0.4363, bio=0.0011

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=33.3605, vae=1.0864, dsb=32.2712, bio=0.0058
    Epoch  2/10: total=33.3996, vae=1.0843, dsb=32.3147, bio=0.0013
    Epoch  3/10: total=33.1812, vae=1.0846, dsb=32.0959, bio=0.0013
    Epoch  4/10: total=32.8924, vae=1.0842, dsb=31.8076, bio=0.0013
    Epoch  5/10: total=33.0730, vae=1.0843, dsb=31.9878, bio=0.0017
    Epoch  6/10: total=32.8101, vae=1.0837, dsb=31.7258, bio=0.0012
    Epoch  7/10: total=33.0797, vae=1.0850, dsb=31.9940, bio=0.0012
    Epoch  8/10: total=32.9545, vae=1.0840, dsb=31.8700, bio=0.0012
    Epoch  9/10: total=33.0337, vae=1.0836, dsb=31.9496, bio=0.0012
    Epoch 10/10: total=33.0810, vae=1.0838, dsb=31.9966, bio=0.0012

  [Backward Policy Training]
    Epoch  1/10: total=1.5343, vae=1.0847, dsb=0.3898, bio=0.1197
    Epoch  2/10: total=1.4740, vae=1.0829, dsb=0.3905, bio=0.0013
    Epoch  3/10: total=1.4842, vae=1.0833, dsb=0.4003, bio=0.0011
    Epoch  4/10: total=1.4681, vae=1.0832, dsb=0.3842, bio=0.0012
    Epoch  5/10: total=1.4731, vae=1.0828, dsb=0.3897, bio=0.0011
    Epoch  6/10: total=1.4668, vae=1.0830, dsb=0.3833, bio=0.0011
    Epoch  7/10: total=1.4651, vae=1.0821, dsb=0.3825, bio=0.0011
    Epoch  8/10: total=1.4733, vae=1.0832, dsb=0.3895, bio=0.0011
    Epoch  9/10: total=1.4727, vae=1.0824, dsb=0.3897, bio=0.0010
    Epoch 10/10: total=1.4752, vae=1.0820, dsb=0.3927, bio=0.0010

[Seed 41] Joint training (original) complete; models and history saved.

[Seed 41] Starting joint training (ablation)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=318.2706, vae=1.9876, dsb=316.2830, bio=0.0000
    Epoch  2/10: total=86.7059, vae=1.0791, dsb=85.6268, bio=0.0000
    Epoch  3/10: total=78.5381, vae=1.0777, dsb=77.4604, bio=0.0000
    Epoch  4/10: total=74.8138, vae=1.0775, dsb=73.7362, bio=0.0000
    Epoch  5/10: total=72.6730, vae=1.0767, dsb=71.5963, bio=0.0000
    Epoch  6/10: total=71.0294, vae=1.0761, dsb=69.9533, bio=0.0000
    Epoch  7/10: total=69.8307, vae=1.0766, dsb=68.7540, bio=0.0000
    Epoch  8/10: total=68.5288, vae=1.0756, dsb=67.4532, bio=0.0000
    Epoch  9/10: total=67.8795, vae=1.0762, dsb=66.8033, bio=0.0000
    Epoch 10/10: total=67.8641, vae=1.0770, dsb=66.7872, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=2.9604, vae=1.0772, dsb=1.8833, bio=0.0000
    Epoch  2/10: total=2.5035, vae=1.0759, dsb=1.4276, bio=0.0000
    Epoch  3/10: total=2.4117, vae=1.0769, dsb=1.3348, bio=0.0000
    Epoch  4/10: total=2.3508, vae=1.0758, dsb=1.2750, bio=0.0000
    Epoch  5/10: total=2.3048, vae=1.0759, dsb=1.2290, bio=0.0000
    Epoch  6/10: total=2.2690, vae=1.0754, dsb=1.1935, bio=0.0000
    Epoch  7/10: total=2.2439, vae=1.0764, dsb=1.1675, bio=0.0000
    Epoch  8/10: total=2.2504, vae=1.0765, dsb=1.1738, bio=0.0000
    Epoch  9/10: total=2.2402, vae=1.0768, dsb=1.1635, bio=0.0000
    Epoch 10/10: total=2.1999, vae=1.0761, dsb=1.1238, bio=0.0000

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=57.3923, vae=1.0758, dsb=56.3165, bio=0.0000
    Epoch  2/10: total=53.0892, vae=1.0765, dsb=52.0127, bio=0.0000
    Epoch  3/10: total=52.0834, vae=1.0761, dsb=51.0073, bio=0.0000
    Epoch  4/10: total=51.4892, vae=1.0767, dsb=50.4124, bio=0.0000
    Epoch  5/10: total=50.5698, vae=1.0757, dsb=49.4941, bio=0.0000
    Epoch  6/10: total=51.1012, vae=1.0768, dsb=50.0244, bio=0.0000
    Epoch  7/10: total=50.3283, vae=1.0758, dsb=49.2525, bio=0.0000
    Epoch  8/10: total=50.2938, vae=1.0753, dsb=49.2184, bio=0.0000
    Epoch  9/10: total=49.9043, vae=1.0753, dsb=48.8290, bio=0.0000
    Epoch 10/10: total=49.8348, vae=1.0756, dsb=48.7592, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.9985, vae=1.0767, dsb=0.9218, bio=0.0000
    Epoch  2/10: total=1.8635, vae=1.0746, dsb=0.7889, bio=0.0000
    Epoch  3/10: total=1.8553, vae=1.0756, dsb=0.7797, bio=0.0000
    Epoch  4/10: total=1.8627, vae=1.0751, dsb=0.7876, bio=0.0000
    Epoch  5/10: total=1.8372, vae=1.0751, dsb=0.7621, bio=0.0000
    Epoch  6/10: total=1.8150, vae=1.0761, dsb=0.7388, bio=0.0000
    Epoch  7/10: total=1.8365, vae=1.0759, dsb=0.7605, bio=0.0000
    Epoch  8/10: total=1.8044, vae=1.0757, dsb=0.7287, bio=0.0000
    Epoch  9/10: total=1.8165, vae=1.0755, dsb=0.7410, bio=0.0000
    Epoch 10/10: total=1.8225, vae=1.0759, dsb=0.7467, bio=0.0000

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=44.6688, vae=1.0753, dsb=43.5935, bio=0.0000
    Epoch  2/10: total=43.5409, vae=1.0753, dsb=42.4656, bio=0.0000
    Epoch  3/10: total=42.8601, vae=1.0761, dsb=41.7840, bio=0.0000
    Epoch  4/10: total=42.7203, vae=1.0757, dsb=41.6446, bio=0.0000
    Epoch  5/10: total=42.6785, vae=1.0754, dsb=41.6031, bio=0.0000
    Epoch  6/10: total=42.4638, vae=1.0755, dsb=41.3883, bio=0.0000
    Epoch  7/10: total=42.1284, vae=1.0761, dsb=41.0523, bio=0.0000
    Epoch  8/10: total=42.1624, vae=1.0755, dsb=41.0869, bio=0.0000
    Epoch  9/10: total=42.0408, vae=1.0758, dsb=40.9650, bio=0.0000
    Epoch 10/10: total=42.3968, vae=1.0759, dsb=41.3209, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.6841, vae=1.0750, dsb=0.6091, bio=0.0000
    Epoch  2/10: total=1.6472, vae=1.0758, dsb=0.5714, bio=0.0000
    Epoch  3/10: total=1.6180, vae=1.0772, dsb=0.5408, bio=0.0000
    Epoch  4/10: total=1.6152, vae=1.0754, dsb=0.5397, bio=0.0000
    Epoch  5/10: total=1.6103, vae=1.0754, dsb=0.5349, bio=0.0000
    Epoch  6/10: total=1.6091, vae=1.0756, dsb=0.5334, bio=0.0000
    Epoch  7/10: total=1.5845, vae=1.0757, dsb=0.5087, bio=0.0000
    Epoch  8/10: total=1.5968, vae=1.0767, dsb=0.5201, bio=0.0000
    Epoch  9/10: total=1.6063, vae=1.0756, dsb=0.5307, bio=0.0000
    Epoch 10/10: total=1.5930, vae=1.0753, dsb=0.5177, bio=0.0000

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=39.7469, vae=1.0754, dsb=38.6716, bio=0.0000
    Epoch  2/10: total=39.1067, vae=1.0756, dsb=38.0311, bio=0.0000
    Epoch  3/10: total=38.8209, vae=1.0751, dsb=37.7458, bio=0.0000
    Epoch  4/10: total=38.9548, vae=1.0751, dsb=37.8797, bio=0.0000
    Epoch  5/10: total=39.0130, vae=1.0757, dsb=37.9373, bio=0.0000
    Epoch  6/10: total=38.6722, vae=1.0752, dsb=37.5971, bio=0.0000
    Epoch  7/10: total=38.7864, vae=1.0758, dsb=37.7106, bio=0.0000
    Epoch  8/10: total=38.5884, vae=1.0759, dsb=37.5126, bio=0.0000
    Epoch  9/10: total=38.7119, vae=1.0754, dsb=37.6364, bio=0.0000
    Epoch 10/10: total=38.4863, vae=1.0750, dsb=37.4113, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.5220, vae=1.0759, dsb=0.4461, bio=0.0000
    Epoch  2/10: total=1.4973, vae=1.0766, dsb=0.4207, bio=0.0000
    Epoch  3/10: total=1.5072, vae=1.0755, dsb=0.4317, bio=0.0000
    Epoch  4/10: total=1.4905, vae=1.0760, dsb=0.4145, bio=0.0000
    Epoch  5/10: total=1.4858, vae=1.0767, dsb=0.4091, bio=0.0000
    Epoch  6/10: total=1.4877, vae=1.0760, dsb=0.4117, bio=0.0000
    Epoch  7/10: total=1.5016, vae=1.0761, dsb=0.4256, bio=0.0000
    Epoch  8/10: total=1.4856, vae=1.0765, dsb=0.4091, bio=0.0000
    Epoch  9/10: total=1.4997, vae=1.0756, dsb=0.4241, bio=0.0000
    Epoch 10/10: total=1.4788, vae=1.0755, dsb=0.4033, bio=0.0000

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=32.0239, vae=1.0761, dsb=30.9479, bio=0.0000
    Epoch  2/10: total=32.0499, vae=1.0753, dsb=30.9746, bio=0.0000
    Epoch  3/10: total=31.8724, vae=1.0757, dsb=30.7967, bio=0.0000
    Epoch  4/10: total=31.6117, vae=1.0755, dsb=30.5363, bio=0.0000
    Epoch  5/10: total=31.7970, vae=1.0756, dsb=30.7214, bio=0.0000
    Epoch  6/10: total=31.5462, vae=1.0753, dsb=30.4710, bio=0.0000
    Epoch  7/10: total=31.8397, vae=1.0769, dsb=30.7628, bio=0.0000
    Epoch  8/10: total=31.6952, vae=1.0760, dsb=30.6193, bio=0.0000
    Epoch  9/10: total=31.7993, vae=1.0757, dsb=30.7236, bio=0.0000
    Epoch 10/10: total=31.8154, vae=1.0759, dsb=30.7395, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.4368, vae=1.0756, dsb=0.3612, bio=0.0000
    Epoch  2/10: total=1.4387, vae=1.0750, dsb=0.3637, bio=0.0000
    Epoch  3/10: total=1.4498, vae=1.0757, dsb=0.3741, bio=0.0000
    Epoch  4/10: total=1.4353, vae=1.0760, dsb=0.3592, bio=0.0000
    Epoch  5/10: total=1.4404, vae=1.0757, dsb=0.3647, bio=0.0000
    Epoch  6/10: total=1.4349, vae=1.0760, dsb=0.3589, bio=0.0000
    Epoch  7/10: total=1.4333, vae=1.0752, dsb=0.3582, bio=0.0000
    Epoch  8/10: total=1.4412, vae=1.0763, dsb=0.3650, bio=0.0000
    Epoch  9/10: total=1.4413, vae=1.0756, dsb=0.3657, bio=0.0000
    Epoch 10/10: total=1.4437, vae=1.0753, dsb=0.3684, bio=0.0000

[Seed 41] Joint training (ablation) complete; models and history saved.

[Seed 41] Drift genes saved in /home/yyuan/ICB_TCE/iter_results/run_041

[Seed 41] run finished.

================================================================================
[Seed 42] Starting running whole pipeline...
================================================================================

[Seed 42] Starting VAE pre-training...

    Epoch [01/20], Beta: 0.000, Average Loss: 530.7192
    Epoch [02/20], Beta: 0.000, Average Loss: 308.9547
    Epoch [03/20], Beta: 0.000, Average Loss: 270.0910
    Epoch [04/20], Beta: 0.000, Average Loss: 250.6785
    Epoch [05/20], Beta: 0.100, Average Loss: 245.4692
    Epoch [06/20], Beta: 0.200, Average Loss: 244.6766
    Epoch [07/20], Beta: 0.300, Average Loss: 244.9574
    Epoch [08/20], Beta: 0.400, Average Loss: 245.6596
    Epoch [09/20], Beta: 0.500, Average Loss: 246.6732
    Epoch [10/20], Beta: 0.600, Average Loss: 247.8303
    Epoch [11/20], Beta: 0.700, Average Loss: 249.0777
    Epoch [12/20], Beta: 0.800, Average Loss: 250.3356
    Epoch [13/20], Beta: 0.900, Average Loss: 251.5813
    Epoch [14/20], Beta: 1.000, Average Loss: 253.2153
    Epoch [15/20], Beta: 1.000, Average Loss: 252.7792
    Epoch [16/20], Beta: 1.000, Average Loss: 252.4466
    Epoch [17/20], Beta: 1.000, Average Loss: 252.0184
    Epoch [18/20], Beta: 1.000, Average Loss: 251.7679
    Epoch [19/20], Beta: 1.000, Average Loss: 251.3980
    Epoch [20/20], Beta: 1.000, Average Loss: 251.2125

[Seed 42] VAE pre-training complete.

[Seed 42] Starting joint training (original)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=380.8120, vae=3.7383, dsb=356.6886, bio=40.7703
    Epoch  2/10: total=104.4347, vae=1.1041, dsb=103.2932, bio=0.0747
    Epoch  3/10: total=95.7107, vae=1.0990, dsb=94.5973, bio=0.0287
    Epoch  4/10: total=91.3347, vae=1.0965, dsb=90.2301, bio=0.0163
    Epoch  5/10: total=88.5548, vae=1.0951, dsb=87.4544, bio=0.0107
    Epoch  6/10: total=86.8931, vae=1.0945, dsb=85.7946, bio=0.0080
    Epoch  7/10: total=85.4147, vae=1.0942, dsb=84.3173, bio=0.0063
    Epoch  8/10: total=84.3606, vae=1.0942, dsb=83.2637, bio=0.0053
    Epoch  9/10: total=84.1144, vae=1.0941, dsb=83.0181, bio=0.0045
    Epoch 10/10: total=83.2801, vae=1.0934, dsb=82.1845, bio=0.0045

  [Backward Policy Training]
    Epoch  1/10: total=3.1508, vae=1.0951, dsb=2.0496, bio=0.0124
    Epoch  2/10: total=2.6627, vae=1.0932, dsb=1.5673, bio=0.0044
    Epoch  3/10: total=2.5494, vae=1.0920, dsb=1.4558, bio=0.0033
    Epoch  4/10: total=2.5082, vae=1.0920, dsb=1.4148, bio=0.0028
    Epoch  5/10: total=2.4538, vae=1.0923, dsb=1.3603, bio=0.0025
    Epoch  6/10: total=2.4258, vae=1.0922, dsb=1.3327, bio=0.0019
    Epoch  7/10: total=2.4399, vae=1.0915, dsb=1.3472, bio=0.0025
    Epoch  8/10: total=2.3932, vae=1.0917, dsb=1.3003, bio=0.0022
    Epoch  9/10: total=2.3692, vae=1.0914, dsb=1.2768, bio=0.0022
    Epoch 10/10: total=2.3613, vae=1.0915, dsb=1.2687, bio=0.0021

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=70.4570, vae=1.0944, dsb=69.3608, bio=0.0037
    Epoch  2/10: total=65.8931, vae=1.0928, dsb=64.7993, bio=0.0021
    Epoch  3/10: total=64.8096, vae=1.0927, dsb=63.7158, bio=0.0021
    Epoch  4/10: total=64.6699, vae=1.0925, dsb=63.5764, bio=0.0021
    Epoch  5/10: total=63.7292, vae=1.0913, dsb=62.6369, bio=0.0020
    Epoch  6/10: total=63.6358, vae=1.0920, dsb=62.5428, bio=0.0020
    Epoch  7/10: total=63.1819, vae=1.0919, dsb=62.0890, bio=0.0020
    Epoch  8/10: total=63.2697, vae=1.0925, dsb=62.1761, bio=0.0020
    Epoch  9/10: total=63.0989, vae=1.0916, dsb=62.0062, bio=0.0023
    Epoch 10/10: total=63.0956, vae=1.0922, dsb=62.0025, bio=0.0018

  [Backward Policy Training]
    Epoch  1/10: total=2.1432, vae=1.0931, dsb=1.0471, bio=0.0060
    Epoch  2/10: total=2.0250, vae=1.0908, dsb=0.9331, bio=0.0022
    Epoch  3/10: total=2.0183, vae=1.0906, dsb=0.9268, bio=0.0019
    Epoch  4/10: total=2.0050, vae=1.0914, dsb=0.9127, bio=0.0018
    Epoch  5/10: total=2.0070, vae=1.0906, dsb=0.9154, bio=0.0018
    Epoch  6/10: total=1.9639, vae=1.0907, dsb=0.8724, bio=0.0017
    Epoch  7/10: total=1.9486, vae=1.0907, dsb=0.8573, bio=0.0012
    Epoch  8/10: total=1.9649, vae=1.0901, dsb=0.8739, bio=0.0019
    Epoch  9/10: total=1.9722, vae=1.0902, dsb=0.8812, bio=0.0017
    Epoch 10/10: total=1.9574, vae=1.0904, dsb=0.8662, bio=0.0017

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=55.5214, vae=1.0935, dsb=54.4260, bio=0.0036
    Epoch  2/10: total=54.1382, vae=1.0913, dsb=53.0460, bio=0.0016
    Epoch  3/10: total=53.6376, vae=1.0910, dsb=52.5458, bio=0.0017
    Epoch  4/10: total=53.6576, vae=1.0916, dsb=52.5652, bio=0.0017
    Epoch  5/10: total=53.1479, vae=1.0906, dsb=52.0565, bio=0.0017
    Epoch  6/10: total=53.3479, vae=1.0912, dsb=52.2559, bio=0.0017
    Epoch  7/10: total=53.0387, vae=1.0907, dsb=51.9471, bio=0.0019
    Epoch  8/10: total=52.9528, vae=1.0910, dsb=51.8610, bio=0.0017
    Epoch  9/10: total=52.7222, vae=1.0904, dsb=51.6310, bio=0.0016
    Epoch 10/10: total=53.0573, vae=1.0903, dsb=51.9662, bio=0.0016

  [Backward Policy Training]
    Epoch  1/10: total=1.8380, vae=1.0907, dsb=0.7335, bio=0.0277
    Epoch  2/10: total=1.7801, vae=1.0902, dsb=0.6891, bio=0.0017
    Epoch  3/10: total=1.7482, vae=1.0903, dsb=0.6571, bio=0.0015
    Epoch  4/10: total=1.7565, vae=1.0899, dsb=0.6659, bio=0.0015
    Epoch  5/10: total=1.7527, vae=1.0896, dsb=0.6624, bio=0.0014
    Epoch  6/10: total=1.7543, vae=1.0899, dsb=0.6637, bio=0.0014
    Epoch  7/10: total=1.7550, vae=1.0900, dsb=0.6643, bio=0.0014
    Epoch  8/10: total=1.7500, vae=1.0899, dsb=0.6595, bio=0.0012
    Epoch  9/10: total=1.7421, vae=1.0893, dsb=0.6521, bio=0.0016
    Epoch 10/10: total=1.7362, vae=1.0888, dsb=0.6468, bio=0.0013

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=50.6966, vae=1.0927, dsb=49.6021, bio=0.0035
    Epoch  2/10: total=49.7563, vae=1.0906, dsb=48.6650, bio=0.0014
    Epoch  3/10: total=49.8545, vae=1.0910, dsb=48.7627, bio=0.0014
    Epoch  4/10: total=49.7081, vae=1.0907, dsb=48.6167, bio=0.0013
    Epoch  5/10: total=49.7871, vae=1.0907, dsb=48.6957, bio=0.0013
    Epoch  6/10: total=49.3579, vae=1.0900, dsb=48.2672, bio=0.0014
    Epoch  7/10: total=49.4795, vae=1.0898, dsb=48.3890, bio=0.0013
    Epoch  8/10: total=49.5874, vae=1.0899, dsb=48.4969, bio=0.0013
    Epoch  9/10: total=49.6200, vae=1.0900, dsb=48.5294, bio=0.0013
    Epoch 10/10: total=49.6094, vae=1.0904, dsb=48.5184, bio=0.0013

  [Backward Policy Training]
    Epoch  1/10: total=1.7207, vae=1.0906, dsb=0.5815, bio=0.0972
    Epoch  2/10: total=1.6700, vae=1.0891, dsb=0.5803, bio=0.0014
    Epoch  3/10: total=1.6530, vae=1.0887, dsb=0.5636, bio=0.0013
    Epoch  4/10: total=1.6560, vae=1.0897, dsb=0.5657, bio=0.0012
    Epoch  5/10: total=1.6539, vae=1.0892, dsb=0.5641, bio=0.0012
    Epoch  6/10: total=1.6439, vae=1.0891, dsb=0.5542, bio=0.0011
    Epoch  7/10: total=1.6365, vae=1.0884, dsb=0.5476, bio=0.0011
    Epoch  8/10: total=1.6446, vae=1.0888, dsb=0.5552, bio=0.0011
    Epoch  9/10: total=1.6521, vae=1.0897, dsb=0.5619, bio=0.0010
    Epoch 10/10: total=1.6468, vae=1.0882, dsb=0.5580, bio=0.0011

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=40.8528, vae=1.0917, dsb=39.7584, bio=0.0054
    Epoch  2/10: total=40.8640, vae=1.0906, dsb=39.7728, bio=0.0011
    Epoch  3/10: total=40.7257, vae=1.0900, dsb=39.6351, bio=0.0011
    Epoch  4/10: total=40.4061, vae=1.0896, dsb=39.3159, bio=0.0011
    Epoch  5/10: total=40.6597, vae=1.0899, dsb=39.5694, bio=0.0007
    Epoch  6/10: total=40.6544, vae=1.0899, dsb=39.5639, bio=0.0013
    Epoch  7/10: total=40.5811, vae=1.0894, dsb=39.4912, bio=0.0011
    Epoch  8/10: total=40.5423, vae=1.0890, dsb=39.4527, bio=0.0011
    Epoch  9/10: total=40.3261, vae=1.0901, dsb=39.2355, bio=0.0010
    Epoch 10/10: total=40.5238, vae=1.0892, dsb=39.4341, bio=0.0010

  [Backward Policy Training]
    Epoch  1/10: total=1.6599, vae=1.0899, dsb=0.5020, bio=0.1359
    Epoch  2/10: total=1.5841, vae=1.0893, dsb=0.4942, bio=0.0012
    Epoch  3/10: total=1.5848, vae=1.0892, dsb=0.4950, bio=0.0012
    Epoch  4/10: total=1.5637, vae=1.0888, dsb=0.4744, bio=0.0010
    Epoch  5/10: total=1.5712, vae=1.0890, dsb=0.4818, bio=0.0008
    Epoch  6/10: total=1.5909, vae=1.0891, dsb=0.5013, bio=0.0012
    Epoch  7/10: total=1.5771, vae=1.0883, dsb=0.4883, bio=0.0011
    Epoch  8/10: total=1.5615, vae=1.0882, dsb=0.4728, bio=0.0010
    Epoch  9/10: total=1.5797, vae=1.0877, dsb=0.4915, bio=0.0010
    Epoch 10/10: total=1.5765, vae=1.0874, dsb=0.4886, bio=0.0009

[Seed 42] Joint training (original) complete; models and history saved.

[Seed 42] Starting joint training (ablation)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=358.0794, vae=2.0069, dsb=356.0725, bio=0.0000
    Epoch  2/10: total=103.8013, vae=1.0857, dsb=102.7156, bio=0.0000
    Epoch  3/10: total=94.9560, vae=1.0844, dsb=93.8716, bio=0.0000
    Epoch  4/10: total=90.6860, vae=1.0832, dsb=89.6028, bio=0.0000
    Epoch  5/10: total=88.0636, vae=1.0822, dsb=86.9815, bio=0.0000
    Epoch  6/10: total=86.5221, vae=1.0819, dsb=85.4402, bio=0.0000
    Epoch  7/10: total=85.0626, vae=1.0819, dsb=83.9807, bio=0.0000
    Epoch  8/10: total=84.0104, vae=1.0821, dsb=82.9283, bio=0.0000
    Epoch  9/10: total=83.7540, vae=1.0822, dsb=82.6718, bio=0.0000
    Epoch 10/10: total=82.8902, vae=1.0818, dsb=81.8085, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=3.0080, vae=1.0825, dsb=1.9255, bio=0.0000
    Epoch  2/10: total=2.5563, vae=1.0823, dsb=1.4739, bio=0.0000
    Epoch  3/10: total=2.4495, vae=1.0815, dsb=1.3680, bio=0.0000
    Epoch  4/10: total=2.4117, vae=1.0818, dsb=1.3299, bio=0.0000
    Epoch  5/10: total=2.3614, vae=1.0823, dsb=1.2791, bio=0.0000
    Epoch  6/10: total=2.3357, vae=1.0823, dsb=1.2533, bio=0.0000
    Epoch  7/10: total=2.3507, vae=1.0819, dsb=1.2688, bio=0.0000
    Epoch  8/10: total=2.3050, vae=1.0821, dsb=1.2228, bio=0.0000
    Epoch  9/10: total=2.2833, vae=1.0819, dsb=1.2015, bio=0.0000
    Epoch 10/10: total=2.2744, vae=1.0821, dsb=1.1923, bio=0.0000

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=71.3459, vae=1.0823, dsb=70.2636, bio=0.0000
    Epoch  2/10: total=67.0582, vae=1.0819, dsb=65.9763, bio=0.0000
    Epoch  3/10: total=66.0090, vae=1.0819, dsb=64.9270, bio=0.0000
    Epoch  4/10: total=65.8759, vae=1.0820, dsb=64.7939, bio=0.0000
    Epoch  5/10: total=64.9636, vae=1.0809, dsb=63.8826, bio=0.0000
    Epoch  6/10: total=64.8378, vae=1.0817, dsb=63.7561, bio=0.0000
    Epoch  7/10: total=64.3846, vae=1.0817, dsb=63.3029, bio=0.0000
    Epoch  8/10: total=64.4712, vae=1.0824, dsb=63.3888, bio=0.0000
    Epoch  9/10: total=64.3213, vae=1.0815, dsb=63.2397, bio=0.0000
    Epoch 10/10: total=64.3550, vae=1.0821, dsb=63.2729, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=2.0738, vae=1.0823, dsb=0.9915, bio=0.0000
    Epoch  2/10: total=1.9663, vae=1.0818, dsb=0.8845, bio=0.0000
    Epoch  3/10: total=1.9634, vae=1.0817, dsb=0.8817, bio=0.0000
    Epoch  4/10: total=1.9521, vae=1.0826, dsb=0.8694, bio=0.0000
    Epoch  5/10: total=1.9558, vae=1.0819, dsb=0.8739, bio=0.0000
    Epoch  6/10: total=1.9151, vae=1.0821, dsb=0.8331, bio=0.0000
    Epoch  7/10: total=1.9025, vae=1.0821, dsb=0.8204, bio=0.0000
    Epoch  8/10: total=1.9197, vae=1.0816, dsb=0.8381, bio=0.0000
    Epoch  9/10: total=1.9284, vae=1.0818, dsb=0.8465, bio=0.0000
    Epoch 10/10: total=1.9150, vae=1.0821, dsb=0.8329, bio=0.0000

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=56.8194, vae=1.0819, dsb=55.7376, bio=0.0000
    Epoch  2/10: total=55.4814, vae=1.0816, dsb=54.3998, bio=0.0000
    Epoch  3/10: total=55.0167, vae=1.0814, dsb=53.9352, bio=0.0000
    Epoch  4/10: total=55.0583, vae=1.0822, dsb=53.9762, bio=0.0000
    Epoch  5/10: total=54.5668, vae=1.0812, dsb=53.4856, bio=0.0000
    Epoch  6/10: total=54.7694, vae=1.0820, dsb=53.6874, bio=0.0000
    Epoch  7/10: total=54.4235, vae=1.0814, dsb=53.3421, bio=0.0000
    Epoch  8/10: total=54.4064, vae=1.0820, dsb=53.3244, bio=0.0000
    Epoch  9/10: total=54.1225, vae=1.0816, dsb=53.0409, bio=0.0000
    Epoch 10/10: total=54.5042, vae=1.0816, dsb=53.4227, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.7729, vae=1.0813, dsb=0.6916, bio=0.0000
    Epoch  2/10: total=1.7332, vae=1.0819, dsb=0.6513, bio=0.0000
    Epoch  3/10: total=1.7034, vae=1.0821, dsb=0.6213, bio=0.0000
    Epoch  4/10: total=1.7126, vae=1.0819, dsb=0.6307, bio=0.0000
    Epoch  5/10: total=1.7095, vae=1.0816, dsb=0.6278, bio=0.0000
    Epoch  6/10: total=1.7122, vae=1.0820, dsb=0.6302, bio=0.0000
    Epoch  7/10: total=1.7135, vae=1.0822, dsb=0.6313, bio=0.0000
    Epoch  8/10: total=1.7090, vae=1.0822, dsb=0.6268, bio=0.0000
    Epoch  9/10: total=1.7008, vae=1.0817, dsb=0.6191, bio=0.0000
    Epoch 10/10: total=1.6954, vae=1.0814, dsb=0.6141, bio=0.0000

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=50.8843, vae=1.0820, dsb=49.8023, bio=0.0000
    Epoch  2/10: total=49.9071, vae=1.0813, dsb=48.8258, bio=0.0000
    Epoch  3/10: total=50.0063, vae=1.0819, dsb=48.9243, bio=0.0000
    Epoch  4/10: total=49.8938, vae=1.0817, dsb=48.8121, bio=0.0000
    Epoch  5/10: total=49.9822, vae=1.0821, dsb=48.9002, bio=0.0000
    Epoch  6/10: total=49.5290, vae=1.0815, dsb=48.4475, bio=0.0000
    Epoch  7/10: total=49.6475, vae=1.0814, dsb=48.5661, bio=0.0000
    Epoch  8/10: total=49.7655, vae=1.0816, dsb=48.6839, bio=0.0000
    Epoch  9/10: total=49.7764, vae=1.0818, dsb=48.6946, bio=0.0000
    Epoch 10/10: total=49.8075, vae=1.0822, dsb=48.7253, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.6323, vae=1.0814, dsb=0.5508, bio=0.0000
    Epoch  2/10: total=1.6315, vae=1.0812, dsb=0.5503, bio=0.0000
    Epoch  3/10: total=1.6156, vae=1.0811, dsb=0.5345, bio=0.0000
    Epoch  4/10: total=1.6188, vae=1.0821, dsb=0.5367, bio=0.0000
    Epoch  5/10: total=1.6173, vae=1.0819, dsb=0.5354, bio=0.0000
    Epoch  6/10: total=1.6075, vae=1.0818, dsb=0.5257, bio=0.0000
    Epoch  7/10: total=1.6006, vae=1.0811, dsb=0.5194, bio=0.0000
    Epoch  8/10: total=1.6085, vae=1.0817, dsb=0.5268, bio=0.0000
    Epoch  9/10: total=1.6162, vae=1.0826, dsb=0.5336, bio=0.0000
    Epoch 10/10: total=1.6109, vae=1.0813, dsb=0.5296, bio=0.0000

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=41.8966, vae=1.0817, dsb=40.8150, bio=0.0000
    Epoch  2/10: total=41.9578, vae=1.0817, dsb=40.8761, bio=0.0000
    Epoch  3/10: total=41.7570, vae=1.0812, dsb=40.6758, bio=0.0000
    Epoch  4/10: total=41.4439, vae=1.0810, dsb=40.3629, bio=0.0000
    Epoch  5/10: total=41.6964, vae=1.0815, dsb=40.6149, bio=0.0000
    Epoch  6/10: total=41.7246, vae=1.0818, dsb=40.6427, bio=0.0000
    Epoch  7/10: total=41.6283, vae=1.0814, dsb=40.5469, bio=0.0000
    Epoch  8/10: total=41.6218, vae=1.0811, dsb=40.5406, bio=0.0000
    Epoch  9/10: total=41.4062, vae=1.0823, dsb=40.3239, bio=0.0000
    Epoch 10/10: total=41.6109, vae=1.0814, dsb=40.5295, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.5541, vae=1.0811, dsb=0.4730, bio=0.0000
    Epoch  2/10: total=1.5480, vae=1.0815, dsb=0.4665, bio=0.0000
    Epoch  3/10: total=1.5491, vae=1.0817, dsb=0.4673, bio=0.0000
    Epoch  4/10: total=1.5287, vae=1.0816, dsb=0.4471, bio=0.0000
    Epoch  5/10: total=1.5363, vae=1.0819, dsb=0.4545, bio=0.0000
    Epoch  6/10: total=1.5561, vae=1.0822, dsb=0.4739, bio=0.0000
    Epoch  7/10: total=1.5428, vae=1.0816, dsb=0.4612, bio=0.0000
    Epoch  8/10: total=1.5278, vae=1.0816, dsb=0.4462, bio=0.0000
    Epoch  9/10: total=1.5452, vae=1.0811, dsb=0.4642, bio=0.0000
    Epoch 10/10: total=1.5424, vae=1.0809, dsb=0.4616, bio=0.0000

[Seed 42] Joint training (ablation) complete; models and history saved.

[Seed 42] Drift genes saved in /home/yyuan/ICB_TCE/iter_results/run_042

[Seed 42] run finished.

================================================================================
[Seed 43] Starting running whole pipeline...
================================================================================

[Seed 43] Starting VAE pre-training...

    Epoch [01/20], Beta: 0.000, Average Loss: 535.0255
    Epoch [02/20], Beta: 0.000, Average Loss: 303.7286
    Epoch [03/20], Beta: 0.000, Average Loss: 270.9774
    Epoch [04/20], Beta: 0.000, Average Loss: 251.6340
    Epoch [05/20], Beta: 0.100, Average Loss: 245.9951
    Epoch [06/20], Beta: 0.200, Average Loss: 244.9654
    Epoch [07/20], Beta: 0.300, Average Loss: 245.1627
    Epoch [08/20], Beta: 0.400, Average Loss: 245.8521
    Epoch [09/20], Beta: 0.500, Average Loss: 246.8140
    Epoch [10/20], Beta: 0.600, Average Loss: 247.9183
    Epoch [11/20], Beta: 0.700, Average Loss: 249.1476
    Epoch [12/20], Beta: 0.800, Average Loss: 250.4499
    Epoch [13/20], Beta: 0.900, Average Loss: 251.6689
    Epoch [14/20], Beta: 1.000, Average Loss: 253.2691
    Epoch [15/20], Beta: 1.000, Average Loss: 252.9109
    Epoch [16/20], Beta: 1.000, Average Loss: 252.5369
    Epoch [17/20], Beta: 1.000, Average Loss: 252.1873
    Epoch [18/20], Beta: 1.000, Average Loss: 251.9154
    Epoch [19/20], Beta: 1.000, Average Loss: 251.5546
    Epoch [20/20], Beta: 1.000, Average Loss: 251.3467

[Seed 43] VAE pre-training complete.

[Seed 43] Starting joint training (original)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=285.8233, vae=3.7057, dsb=259.0297, bio=46.1757
    Epoch  2/10: total=68.3816, vae=1.1011, dsb=67.2468, bio=0.0674
    Epoch  3/10: total=58.7412, vae=1.0968, dsb=57.6298, bio=0.0292
    Epoch  4/10: total=54.3303, vae=1.0943, dsb=53.2281, bio=0.0159
    Epoch  5/10: total=51.5031, vae=1.0936, dsb=50.4041, bio=0.0109
    Epoch  6/10: total=49.8052, vae=1.0928, dsb=48.7084, bio=0.0080
    Epoch  7/10: total=48.4907, vae=1.0934, dsb=47.3942, bio=0.0063
    Epoch  8/10: total=47.5018, vae=1.0924, dsb=46.4067, bio=0.0053
    Epoch  9/10: total=46.6864, vae=1.0923, dsb=45.5918, bio=0.0046
    Epoch 10/10: total=46.0673, vae=1.0920, dsb=44.9733, bio=0.0039

  [Backward Policy Training]
    Epoch  1/10: total=3.2241, vae=1.0926, dsb=2.1254, bio=0.0122
    Epoch  2/10: total=2.6847, vae=1.0919, dsb=1.5906, bio=0.0044
    Epoch  3/10: total=2.5874, vae=1.0907, dsb=1.4951, bio=0.0033
    Epoch  4/10: total=2.5097, vae=1.0909, dsb=1.4174, bio=0.0028
    Epoch  5/10: total=2.4174, vae=1.0905, dsb=1.3257, bio=0.0025
    Epoch  6/10: total=2.4068, vae=1.0900, dsb=1.3154, bio=0.0028
    Epoch  7/10: total=2.3551, vae=1.0896, dsb=1.2644, bio=0.0022
    Epoch  8/10: total=2.3689, vae=1.0894, dsb=1.2784, bio=0.0021
    Epoch  9/10: total=2.3475, vae=1.0908, dsb=1.2557, bio=0.0020
    Epoch 10/10: total=2.3490, vae=1.0892, dsb=1.2587, bio=0.0021

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=42.8970, vae=1.0920, dsb=41.8028, bio=0.0042
    Epoch  2/10: total=36.4546, vae=1.0910, dsb=35.3625, bio=0.0021
    Epoch  3/10: total=35.0008, vae=1.0908, dsb=33.9090, bio=0.0020
    Epoch  4/10: total=34.2403, vae=1.0903, dsb=33.1490, bio=0.0021
    Epoch  5/10: total=33.5582, vae=1.0894, dsb=32.4675, bio=0.0026
    Epoch  6/10: total=33.1323, vae=1.0899, dsb=32.0414, bio=0.0020
    Epoch  7/10: total=32.8707, vae=1.0903, dsb=31.7795, bio=0.0020
    Epoch  8/10: total=32.5271, vae=1.0898, dsb=31.4363, bio=0.0020
    Epoch  9/10: total=32.3071, vae=1.0907, dsb=31.2153, bio=0.0021
    Epoch 10/10: total=32.2409, vae=1.0900, dsb=31.1499, bio=0.0020

  [Backward Policy Training]
    Epoch  1/10: total=2.1426, vae=1.0907, dsb=1.0492, bio=0.0054
    Epoch  2/10: total=2.0032, vae=1.0889, dsb=0.9133, bio=0.0021
    Epoch  3/10: total=1.9694, vae=1.0881, dsb=0.8803, bio=0.0020
    Epoch  4/10: total=1.9421, vae=1.0888, dsb=0.8524, bio=0.0019
    Epoch  5/10: total=1.9308, vae=1.0890, dsb=0.8409, bio=0.0019
    Epoch  6/10: total=1.9148, vae=1.0897, dsb=0.8242, bio=0.0020
    Epoch  7/10: total=1.8994, vae=1.0887, dsb=0.8098, bio=0.0018
    Epoch  8/10: total=1.8730, vae=1.0880, dsb=0.7842, bio=0.0017
    Epoch  9/10: total=1.8864, vae=1.0888, dsb=0.7967, bio=0.0017
    Epoch 10/10: total=1.8618, vae=1.0892, dsb=0.7717, bio=0.0017

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=33.4138, vae=1.0921, dsb=32.3200, bio=0.0034
    Epoch  2/10: total=30.9004, vae=1.0899, dsb=29.8095, bio=0.0018
    Epoch  3/10: total=30.2239, vae=1.0901, dsb=29.1329, bio=0.0018
    Epoch  4/10: total=29.9043, vae=1.0899, dsb=28.8135, bio=0.0018
    Epoch  5/10: total=29.8204, vae=1.0891, dsb=28.7304, bio=0.0019
    Epoch  6/10: total=29.5496, vae=1.0892, dsb=28.4593, bio=0.0021
    Epoch  7/10: total=29.4707, vae=1.0900, dsb=28.3798, bio=0.0018
    Epoch  8/10: total=29.3009, vae=1.0892, dsb=28.2107, bio=0.0018
    Epoch  9/10: total=29.1366, vae=1.0898, dsb=28.0459, bio=0.0019
    Epoch 10/10: total=29.1174, vae=1.0902, dsb=28.0263, bio=0.0019

  [Backward Policy Training]
    Epoch  1/10: total=1.7998, vae=1.0895, dsb=0.7052, bio=0.0103
    Epoch  2/10: total=1.7458, vae=1.0884, dsb=0.6565, bio=0.0018
    Epoch  3/10: total=1.7059, vae=1.0883, dsb=0.6168, bio=0.0017
    Epoch  4/10: total=1.7077, vae=1.0885, dsb=0.6184, bio=0.0016
    Epoch  5/10: total=1.7051, vae=1.0884, dsb=0.6157, bio=0.0021
    Epoch  6/10: total=1.6951, vae=1.0888, dsb=0.6055, bio=0.0015
    Epoch  7/10: total=1.6906, vae=1.0883, dsb=0.6015, bio=0.0015
    Epoch  8/10: total=1.6897, vae=1.0877, dsb=0.6013, bio=0.0015
    Epoch  9/10: total=1.6932, vae=1.0880, dsb=0.6044, bio=0.0015
    Epoch 10/10: total=1.7048, vae=1.0872, dsb=0.6168, bio=0.0016

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=26.3995, vae=1.0906, dsb=25.3075, bio=0.0028
    Epoch  2/10: total=25.0711, vae=1.0893, dsb=23.9809, bio=0.0017
    Epoch  3/10: total=24.8164, vae=1.0886, dsb=23.7270, bio=0.0017
    Epoch  4/10: total=24.5529, vae=1.0887, dsb=23.4633, bio=0.0017
    Epoch  5/10: total=24.4675, vae=1.0890, dsb=23.3775, bio=0.0021
    Epoch  6/10: total=24.3349, vae=1.0890, dsb=23.2450, bio=0.0017
    Epoch  7/10: total=24.2889, vae=1.0890, dsb=23.1991, bio=0.0016
    Epoch  8/10: total=24.3705, vae=1.0888, dsb=23.2808, bio=0.0017
    Epoch  9/10: total=24.1788, vae=1.0893, dsb=23.0886, bio=0.0018
    Epoch 10/10: total=24.1280, vae=1.0891, dsb=23.0381, bio=0.0017

  [Backward Policy Training]
    Epoch  1/10: total=1.6290, vae=1.0891, dsb=0.5210, bio=0.0378
    Epoch  2/10: total=1.5903, vae=1.0876, dsb=0.5018, bio=0.0017
    Epoch  3/10: total=1.5855, vae=1.0886, dsb=0.4962, bio=0.0015
    Epoch  4/10: total=1.5647, vae=1.0878, dsb=0.4762, bio=0.0016
    Epoch  5/10: total=1.5802, vae=1.0875, dsb=0.4919, bio=0.0015
    Epoch  6/10: total=1.5636, vae=1.0879, dsb=0.4750, bio=0.0014
    Epoch  7/10: total=1.5781, vae=1.0877, dsb=0.4897, bio=0.0014
    Epoch  8/10: total=1.5690, vae=1.0883, dsb=0.4799, bio=0.0014
    Epoch  9/10: total=1.5735, vae=1.0877, dsb=0.4850, bio=0.0016
    Epoch 10/10: total=1.5648, vae=1.0872, dsb=0.4769, bio=0.0014

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=22.6082, vae=1.0905, dsb=21.5161, bio=0.0033
    Epoch  2/10: total=22.1052, vae=1.0890, dsb=21.0155, bio=0.0015
    Epoch  3/10: total=22.0216, vae=1.0892, dsb=20.9318, bio=0.0014
    Epoch  4/10: total=21.8414, vae=1.0892, dsb=20.7514, bio=0.0015
    Epoch  5/10: total=21.8054, vae=1.0882, dsb=20.7164, bio=0.0016
    Epoch  6/10: total=21.7951, vae=1.0884, dsb=20.7060, bio=0.0016
    Epoch  7/10: total=21.7625, vae=1.0883, dsb=20.6734, bio=0.0015
    Epoch  8/10: total=21.7196, vae=1.0880, dsb=20.6308, bio=0.0015
    Epoch  9/10: total=21.6119, vae=1.0882, dsb=20.5230, bio=0.0015
    Epoch 10/10: total=21.5766, vae=1.0879, dsb=20.4879, bio=0.0015

  [Backward Policy Training]
    Epoch  1/10: total=1.5582, vae=1.0888, dsb=0.4262, bio=0.0864
    Epoch  2/10: total=1.4962, vae=1.0872, dsb=0.4082, bio=0.0015
    Epoch  3/10: total=1.4959, vae=1.0879, dsb=0.4074, bio=0.0014
    Epoch  4/10: total=1.4942, vae=1.0873, dsb=0.4061, bio=0.0014
    Epoch  5/10: total=1.4937, vae=1.0873, dsb=0.4057, bio=0.0012
    Epoch  6/10: total=1.4944, vae=1.0876, dsb=0.4062, bio=0.0012
    Epoch  7/10: total=1.4807, vae=1.0875, dsb=0.3926, bio=0.0012
    Epoch  8/10: total=1.4802, vae=1.0875, dsb=0.3919, bio=0.0016
    Epoch  9/10: total=1.4825, vae=1.0876, dsb=0.3943, bio=0.0012
    Epoch 10/10: total=1.4836, vae=1.0876, dsb=0.3954, bio=0.0012

[Seed 43] Joint training (original) complete; models and history saved.

[Seed 43] Starting joint training (ablation)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=260.6833, vae=2.0214, dsb=258.6619, bio=0.0000
    Epoch  2/10: total=67.9686, vae=1.0837, dsb=66.8849, bio=0.0000
    Epoch  3/10: total=58.1375, vae=1.0827, dsb=57.0548, bio=0.0000
    Epoch  4/10: total=53.8332, vae=1.0814, dsb=52.7517, bio=0.0000
    Epoch  5/10: total=51.1556, vae=1.0810, dsb=50.0746, bio=0.0000
    Epoch  6/10: total=49.5274, vae=1.0805, dsb=48.4469, bio=0.0000
    Epoch  7/10: total=48.2375, vae=1.0813, dsb=47.1562, bio=0.0000
    Epoch  8/10: total=47.2725, vae=1.0805, dsb=46.1920, bio=0.0000
    Epoch  9/10: total=46.4425, vae=1.0807, dsb=45.3618, bio=0.0000
    Epoch 10/10: total=45.7914, vae=1.0807, dsb=44.7107, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=3.1203, vae=1.0806, dsb=2.0397, bio=0.0000
    Epoch  2/10: total=2.6134, vae=1.0813, dsb=1.5320, bio=0.0000
    Epoch  3/10: total=2.5171, vae=1.0805, dsb=1.4366, bio=0.0000
    Epoch  4/10: total=2.4411, vae=1.0809, dsb=1.3602, bio=0.0000
    Epoch  5/10: total=2.3531, vae=1.0806, dsb=1.2725, bio=0.0000
    Epoch  6/10: total=2.3435, vae=1.0802, dsb=1.2634, bio=0.0000
    Epoch  7/10: total=2.2930, vae=1.0801, dsb=1.2129, bio=0.0000
    Epoch  8/10: total=2.3059, vae=1.0799, dsb=1.2260, bio=0.0000
    Epoch  9/10: total=2.2855, vae=1.0813, dsb=1.2041, bio=0.0000
    Epoch 10/10: total=2.2875, vae=1.0800, dsb=1.2076, bio=0.0000

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=41.1730, vae=1.0800, dsb=40.0930, bio=0.0000
    Epoch  2/10: total=34.8047, vae=1.0801, dsb=33.7246, bio=0.0000
    Epoch  3/10: total=33.3877, vae=1.0802, dsb=32.3076, bio=0.0000
    Epoch  4/10: total=32.6756, vae=1.0799, dsb=31.5957, bio=0.0000
    Epoch  5/10: total=32.0050, vae=1.0790, dsb=30.9259, bio=0.0000
    Epoch  6/10: total=31.6110, vae=1.0797, dsb=30.5313, bio=0.0000
    Epoch  7/10: total=31.3598, vae=1.0802, dsb=30.2797, bio=0.0000
    Epoch  8/10: total=31.0641, vae=1.0798, dsb=29.9842, bio=0.0000
    Epoch  9/10: total=30.8463, vae=1.0808, dsb=29.7655, bio=0.0000
    Epoch 10/10: total=30.7637, vae=1.0802, dsb=29.6836, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=2.0573, vae=1.0802, dsb=0.9771, bio=0.0000
    Epoch  2/10: total=1.9289, vae=1.0799, dsb=0.8490, bio=0.0000
    Epoch  3/10: total=1.8969, vae=1.0793, dsb=0.8176, bio=0.0000
    Epoch  4/10: total=1.8713, vae=1.0800, dsb=0.7913, bio=0.0000
    Epoch  5/10: total=1.8614, vae=1.0802, dsb=0.7811, bio=0.0000
    Epoch  6/10: total=1.8453, vae=1.0808, dsb=0.7646, bio=0.0000
    Epoch  7/10: total=1.8309, vae=1.0802, dsb=0.7507, bio=0.0000
    Epoch  8/10: total=1.8065, vae=1.0795, dsb=0.7270, bio=0.0000
    Epoch  9/10: total=1.8191, vae=1.0803, dsb=0.7388, bio=0.0000
    Epoch 10/10: total=1.7958, vae=1.0806, dsb=0.7151, bio=0.0000

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=31.8731, vae=1.0808, dsb=30.7922, bio=0.0000
    Epoch  2/10: total=29.5120, vae=1.0800, dsb=28.4320, bio=0.0000
    Epoch  3/10: total=28.8748, vae=1.0804, dsb=27.7944, bio=0.0000
    Epoch  4/10: total=28.5766, vae=1.0803, dsb=27.4963, bio=0.0000
    Epoch  5/10: total=28.4795, vae=1.0796, dsb=27.3999, bio=0.0000
    Epoch  6/10: total=28.2294, vae=1.0797, dsb=27.1497, bio=0.0000
    Epoch  7/10: total=28.1587, vae=1.0807, dsb=27.0780, bio=0.0000
    Epoch  8/10: total=27.9916, vae=1.0800, dsb=26.9116, bio=0.0000
    Epoch  9/10: total=27.8399, vae=1.0806, dsb=26.7593, bio=0.0000
    Epoch 10/10: total=27.8261, vae=1.0811, dsb=26.7451, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.7298, vae=1.0800, dsb=0.6498, bio=0.0000
    Epoch  2/10: total=1.6855, vae=1.0800, dsb=0.6056, bio=0.0000
    Epoch  3/10: total=1.6477, vae=1.0799, dsb=0.5677, bio=0.0000
    Epoch  4/10: total=1.6494, vae=1.0802, dsb=0.5692, bio=0.0000
    Epoch  5/10: total=1.6460, vae=1.0801, dsb=0.5659, bio=0.0000
    Epoch  6/10: total=1.6367, vae=1.0806, dsb=0.5561, bio=0.0000
    Epoch  7/10: total=1.6326, vae=1.0801, dsb=0.5524, bio=0.0000
    Epoch  8/10: total=1.6315, vae=1.0796, dsb=0.5519, bio=0.0000
    Epoch  9/10: total=1.6350, vae=1.0799, dsb=0.5551, bio=0.0000
    Epoch 10/10: total=1.6462, vae=1.0791, dsb=0.5671, bio=0.0000

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=25.1887, vae=1.0799, dsb=24.1088, bio=0.0000
    Epoch  2/10: total=24.0738, vae=1.0800, dsb=22.9938, bio=0.0000
    Epoch  3/10: total=23.8716, vae=1.0794, dsb=22.7922, bio=0.0000
    Epoch  4/10: total=23.6642, vae=1.0797, dsb=22.5844, bio=0.0000
    Epoch  5/10: total=23.5757, vae=1.0800, dsb=22.4957, bio=0.0000
    Epoch  6/10: total=23.4511, vae=1.0802, dsb=22.3709, bio=0.0000
    Epoch  7/10: total=23.4308, vae=1.0803, dsb=22.3505, bio=0.0000
    Epoch  8/10: total=23.5076, vae=1.0801, dsb=22.4274, bio=0.0000
    Epoch  9/10: total=23.3467, vae=1.0806, dsb=22.2661, bio=0.0000
    Epoch 10/10: total=23.2864, vae=1.0806, dsb=22.2058, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.5440, vae=1.0800, dsb=0.4641, bio=0.0000
    Epoch  2/10: total=1.5279, vae=1.0795, dsb=0.4484, bio=0.0000
    Epoch  3/10: total=1.5241, vae=1.0805, dsb=0.4436, bio=0.0000
    Epoch  4/10: total=1.5054, vae=1.0798, dsb=0.4256, bio=0.0000
    Epoch  5/10: total=1.5204, vae=1.0795, dsb=0.4409, bio=0.0000
    Epoch  6/10: total=1.5054, vae=1.0801, dsb=0.4253, bio=0.0000
    Epoch  7/10: total=1.5191, vae=1.0798, dsb=0.4393, bio=0.0000
    Epoch  8/10: total=1.5107, vae=1.0805, dsb=0.4303, bio=0.0000
    Epoch  9/10: total=1.5149, vae=1.0799, dsb=0.4350, bio=0.0000
    Epoch 10/10: total=1.5075, vae=1.0795, dsb=0.4281, bio=0.0000

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=21.3894, vae=1.0798, dsb=20.3096, bio=0.0000
    Epoch  2/10: total=21.0166, vae=1.0797, dsb=19.9369, bio=0.0000
    Epoch  3/10: total=20.9751, vae=1.0801, dsb=19.8950, bio=0.0000
    Epoch  4/10: total=20.8392, vae=1.0804, dsb=19.7587, bio=0.0000
    Epoch  5/10: total=20.8098, vae=1.0796, dsb=19.7303, bio=0.0000
    Epoch  6/10: total=20.8192, vae=1.0800, dsb=19.7392, bio=0.0000
    Epoch  7/10: total=20.7972, vae=1.0800, dsb=19.7172, bio=0.0000
    Epoch  8/10: total=20.7530, vae=1.0798, dsb=19.6732, bio=0.0000
    Epoch  9/10: total=20.6654, vae=1.0800, dsb=19.5854, bio=0.0000
    Epoch 10/10: total=20.6346, vae=1.0798, dsb=19.5549, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.4615, vae=1.0800, dsb=0.3816, bio=0.0000
    Epoch  2/10: total=1.4463, vae=1.0793, dsb=0.3671, bio=0.0000
    Epoch  3/10: total=1.4471, vae=1.0800, dsb=0.3671, bio=0.0000
    Epoch  4/10: total=1.4458, vae=1.0796, dsb=0.3662, bio=0.0000
    Epoch  5/10: total=1.4460, vae=1.0796, dsb=0.3664, bio=0.0000
    Epoch  6/10: total=1.4472, vae=1.0800, dsb=0.3672, bio=0.0000
    Epoch  7/10: total=1.4346, vae=1.0799, dsb=0.3547, bio=0.0000
    Epoch  8/10: total=1.4342, vae=1.0799, dsb=0.3543, bio=0.0000
    Epoch  9/10: total=1.4367, vae=1.0800, dsb=0.3567, bio=0.0000
    Epoch 10/10: total=1.4379, vae=1.0800, dsb=0.3579, bio=0.0000

[Seed 43] Joint training (ablation) complete; models and history saved.

[Seed 43] Drift genes saved in /home/yyuan/ICB_TCE/iter_results/run_043

[Seed 43] run finished.

================================================================================
[Seed 44] Starting running whole pipeline...
================================================================================

[Seed 44] Starting VAE pre-training...

    Epoch [01/20], Beta: 0.000, Average Loss: 534.4380
    Epoch [02/20], Beta: 0.000, Average Loss: 308.2533
    Epoch [03/20], Beta: 0.000, Average Loss: 269.3288
    Epoch [04/20], Beta: 0.000, Average Loss: 249.0656
    Epoch [05/20], Beta: 0.100, Average Loss: 244.3247
    Epoch [06/20], Beta: 0.200, Average Loss: 243.7978
    Epoch [07/20], Beta: 0.300, Average Loss: 244.2095
    Epoch [08/20], Beta: 0.400, Average Loss: 245.2775
    Epoch [09/20], Beta: 0.500, Average Loss: 246.5520
    Epoch [10/20], Beta: 0.600, Average Loss: 247.8977
    Epoch [11/20], Beta: 0.700, Average Loss: 249.1551
    Epoch [12/20], Beta: 0.800, Average Loss: 250.4753
    Epoch [13/20], Beta: 0.900, Average Loss: 251.7140
    Epoch [14/20], Beta: 1.000, Average Loss: 253.3460
    Epoch [15/20], Beta: 1.000, Average Loss: 252.9744
    Epoch [16/20], Beta: 1.000, Average Loss: 252.6010
    Epoch [17/20], Beta: 1.000, Average Loss: 252.2061
    Epoch [18/20], Beta: 1.000, Average Loss: 251.8746
    Epoch [19/20], Beta: 1.000, Average Loss: 251.5015
    Epoch [20/20], Beta: 1.000, Average Loss: 251.3375

[Seed 44] VAE pre-training complete.

[Seed 44] Starting joint training (original)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=548.9489, vae=3.5584, dsb=533.7433, bio=23.2944
    Epoch  2/10: total=142.8349, vae=1.1040, dsb=141.6996, bio=0.0627
    Epoch  3/10: total=133.2850, vae=1.0982, dsb=132.1731, bio=0.0275
    Epoch  4/10: total=129.2997, vae=1.0963, dsb=128.1952, bio=0.0163
    Epoch  5/10: total=127.6607, vae=1.0948, dsb=126.5605, bio=0.0109
    Epoch  6/10: total=125.6826, vae=1.0938, dsb=124.5847, bio=0.0080
    Epoch  7/10: total=124.9123, vae=1.0943, dsb=123.8149, bio=0.0062
    Epoch  8/10: total=123.2352, vae=1.0935, dsb=122.1390, bio=0.0053
    Epoch  9/10: total=122.3926, vae=1.0936, dsb=121.2966, bio=0.0047
    Epoch 10/10: total=121.9751, vae=1.0932, dsb=120.8800, bio=0.0038

  [Backward Policy Training]
    Epoch  1/10: total=3.2526, vae=1.0934, dsb=2.1525, bio=0.0135
    Epoch  2/10: total=2.7948, vae=1.0920, dsb=1.7007, bio=0.0042
    Epoch  3/10: total=2.7384, vae=1.0911, dsb=1.6459, bio=0.0030
    Epoch  4/10: total=2.6589, vae=1.0913, dsb=1.5664, bio=0.0025
    Epoch  5/10: total=2.6429, vae=1.0918, dsb=1.5500, bio=0.0023
    Epoch  6/10: total=2.6248, vae=1.0912, dsb=1.5325, bio=0.0021
    Epoch  7/10: total=2.5662, vae=1.0909, dsb=1.4743, bio=0.0020
    Epoch  8/10: total=2.5618, vae=1.0913, dsb=1.4696, bio=0.0019
    Epoch  9/10: total=2.5042, vae=1.0897, dsb=1.4135, bio=0.0019
    Epoch 10/10: total=2.5429, vae=1.0913, dsb=1.4506, bio=0.0020

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=101.5109, vae=1.0943, dsb=100.4149, bio=0.0034
    Epoch  2/10: total=97.5396, vae=1.0918, dsb=96.4469, bio=0.0018
    Epoch  3/10: total=95.9175, vae=1.0926, dsb=94.8240, bio=0.0018
    Epoch  4/10: total=96.0084, vae=1.0917, dsb=94.9158, bio=0.0017
    Epoch  5/10: total=94.5191, vae=1.0914, dsb=93.4269, bio=0.0018
    Epoch  6/10: total=94.4838, vae=1.0915, dsb=93.3914, bio=0.0017
    Epoch  7/10: total=94.3845, vae=1.0922, dsb=93.2915, bio=0.0016
    Epoch  8/10: total=94.7224, vae=1.0914, dsb=93.6302, bio=0.0016
    Epoch  9/10: total=94.1248, vae=1.0920, dsb=93.0320, bio=0.0017
    Epoch 10/10: total=94.9016, vae=1.0914, dsb=93.8094, bio=0.0017

  [Backward Policy Training]
    Epoch  1/10: total=2.2572, vae=1.0907, dsb=1.1640, bio=0.0049
    Epoch  2/10: total=2.1970, vae=1.0902, dsb=1.1060, bio=0.0017
    Epoch  3/10: total=2.1477, vae=1.0895, dsb=1.0574, bio=0.0016
    Epoch  4/10: total=2.1452, vae=1.0897, dsb=1.0547, bio=0.0017
    Epoch  5/10: total=2.1291, vae=1.0893, dsb=1.0391, bio=0.0014
    Epoch  6/10: total=2.1382, vae=1.0895, dsb=1.0480, bio=0.0014
    Epoch  7/10: total=2.0951, vae=1.0888, dsb=1.0056, bio=0.0014
    Epoch  8/10: total=2.0801, vae=1.0893, dsb=0.9902, bio=0.0014
    Epoch  9/10: total=2.1003, vae=1.0892, dsb=1.0104, bio=0.0013
    Epoch 10/10: total=2.0909, vae=1.0888, dsb=1.0014, bio=0.0013

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=83.6636, vae=1.0917, dsb=82.5705, bio=0.0028
    Epoch  2/10: total=82.1176, vae=1.0908, dsb=81.0261, bio=0.0016
    Epoch  3/10: total=81.8488, vae=1.0902, dsb=80.7580, bio=0.0013
    Epoch  4/10: total=81.8509, vae=1.0903, dsb=80.7599, bio=0.0013
    Epoch  5/10: total=80.9620, vae=1.0900, dsb=79.8713, bio=0.0013
    Epoch  6/10: total=81.4182, vae=1.0895, dsb=80.3280, bio=0.0013
    Epoch  7/10: total=81.1552, vae=1.0902, dsb=80.0644, bio=0.0014
    Epoch  8/10: total=80.5974, vae=1.0899, dsb=79.5068, bio=0.0014
    Epoch  9/10: total=81.0300, vae=1.0889, dsb=79.9404, bio=0.0013
    Epoch 10/10: total=80.9092, vae=1.0893, dsb=79.8193, bio=0.0013

  [Backward Policy Training]
    Epoch  1/10: total=1.9703, vae=1.0893, dsb=0.8679, bio=0.0262
    Epoch  2/10: total=1.9402, vae=1.0893, dsb=0.8502, bio=0.0014
    Epoch  3/10: total=1.9071, vae=1.0893, dsb=0.8173, bio=0.0012
    Epoch  4/10: total=1.8811, vae=1.0896, dsb=0.7909, bio=0.0011
    Epoch  5/10: total=1.8950, vae=1.0885, dsb=0.8058, bio=0.0013
    Epoch  6/10: total=1.8658, vae=1.0877, dsb=0.7776, bio=0.0011
    Epoch  7/10: total=1.8886, vae=1.0882, dsb=0.7998, bio=0.0011
    Epoch  8/10: total=1.9147, vae=1.0896, dsb=0.8245, bio=0.0011
    Epoch  9/10: total=1.8720, vae=1.0890, dsb=0.7824, bio=0.0011
    Epoch 10/10: total=1.8669, vae=1.0889, dsb=0.7773, bio=0.0014

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=74.5000, vae=1.0918, dsb=73.4070, bio=0.0026
    Epoch  2/10: total=73.8941, vae=1.0897, dsb=72.8039, bio=0.0011
    Epoch  3/10: total=73.4876, vae=1.0896, dsb=72.3975, bio=0.0011
    Epoch  4/10: total=73.2197, vae=1.0897, dsb=72.1294, bio=0.0011
    Epoch  5/10: total=73.3419, vae=1.0894, dsb=72.2521, bio=0.0008
    Epoch  6/10: total=73.7215, vae=1.0892, dsb=72.6317, bio=0.0013
    Epoch  7/10: total=72.9821, vae=1.0894, dsb=71.8921, bio=0.0011
    Epoch  8/10: total=73.2271, vae=1.0891, dsb=72.1374, bio=0.0011
    Epoch  9/10: total=73.2985, vae=1.0886, dsb=72.2094, bio=0.0011
    Epoch 10/10: total=73.1437, vae=1.0885, dsb=72.0549, bio=0.0007

  [Backward Policy Training]
    Epoch  1/10: total=1.8117, vae=1.0903, dsb=0.6794, bio=0.0839
    Epoch  2/10: total=1.7780, vae=1.0884, dsb=0.6889, bio=0.0013
    Epoch  3/10: total=1.7436, vae=1.0884, dsb=0.6547, bio=0.0011
    Epoch  4/10: total=1.7543, vae=1.0886, dsb=0.6652, bio=0.0010
    Epoch  5/10: total=1.7501, vae=1.0886, dsb=0.6611, bio=0.0009
    Epoch  6/10: total=1.7586, vae=1.0885, dsb=0.6696, bio=0.0010
    Epoch  7/10: total=1.7494, vae=1.0890, dsb=0.6600, bio=0.0010
    Epoch  8/10: total=1.7610, vae=1.0883, dsb=0.6722, bio=0.0010
    Epoch  9/10: total=1.7479, vae=1.0883, dsb=0.6592, bio=0.0009
    Epoch 10/10: total=1.7354, vae=1.0888, dsb=0.6462, bio=0.0010

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=62.2953, vae=1.0907, dsb=61.2033, bio=0.0026
    Epoch  2/10: total=62.0821, vae=1.0903, dsb=60.9913, bio=0.0009
    Epoch  3/10: total=62.2570, vae=1.0901, dsb=61.1663, bio=0.0012
    Epoch  4/10: total=62.2921, vae=1.0895, dsb=61.2021, bio=0.0011
    Epoch  5/10: total=62.1964, vae=1.0888, dsb=61.1071, bio=0.0010
    Epoch  6/10: total=62.0676, vae=1.0889, dsb=60.9785, bio=0.0004
    Epoch  7/10: total=62.2045, vae=1.0890, dsb=61.1151, bio=0.0008
    Epoch  8/10: total=62.1902, vae=1.0879, dsb=61.1017, bio=0.0011
    Epoch  9/10: total=62.3197, vae=1.0888, dsb=61.2303, bio=0.0010
    Epoch 10/10: total=62.0444, vae=1.0878, dsb=60.9563, bio=0.0007

  [Backward Policy Training]
    Epoch  1/10: total=1.7596, vae=1.0899, dsb=0.6168, bio=0.1057
    Epoch  2/10: total=1.6646, vae=1.0885, dsb=0.5757, bio=0.0008
    Epoch  3/10: total=1.6839, vae=1.0882, dsb=0.5952, bio=0.0011
    Epoch  4/10: total=1.6729, vae=1.0878, dsb=0.5848, bio=0.0007
    Epoch  5/10: total=1.6858, vae=1.0885, dsb=0.5969, bio=0.0006
    Epoch  6/10: total=1.6669, vae=1.0871, dsb=0.5792, bio=0.0013
    Epoch  7/10: total=1.6654, vae=1.0870, dsb=0.5781, bio=0.0007
    Epoch  8/10: total=1.6829, vae=1.0882, dsb=0.5943, bio=0.0010
    Epoch  9/10: total=1.6829, vae=1.0871, dsb=0.5953, bio=0.0010
    Epoch 10/10: total=1.7015, vae=1.0862, dsb=0.6149, bio=0.0009

[Seed 44] Joint training (original) complete; models and history saved.

[Seed 44] Starting joint training (ablation)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=534.3184, vae=2.0314, dsb=532.2869, bio=0.0000
    Epoch  2/10: total=141.4668, vae=1.0857, dsb=140.3811, bio=0.0000
    Epoch  3/10: total=132.2119, vae=1.0834, dsb=131.1285, bio=0.0000
    Epoch  4/10: total=128.5100, vae=1.0825, dsb=127.4275, bio=0.0000
    Epoch  5/10: total=127.0329, vae=1.0815, dsb=125.9515, bio=0.0000
    Epoch  6/10: total=125.1327, vae=1.0810, dsb=124.0517, bio=0.0000
    Epoch  7/10: total=124.3819, vae=1.0817, dsb=123.3002, bio=0.0000
    Epoch  8/10: total=122.7178, vae=1.0813, dsb=121.6365, bio=0.0000
    Epoch  9/10: total=121.8700, vae=1.0816, dsb=120.7883, bio=0.0000
    Epoch 10/10: total=121.5035, vae=1.0816, dsb=120.4219, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=3.0858, vae=1.0809, dsb=2.0049, bio=0.0000
    Epoch  2/10: total=2.6588, vae=1.0811, dsb=1.5777, bio=0.0000
    Epoch  3/10: total=2.6041, vae=1.0806, dsb=1.5235, bio=0.0000
    Epoch  4/10: total=2.5318, vae=1.0811, dsb=1.4507, bio=0.0000
    Epoch  5/10: total=2.5199, vae=1.0818, dsb=1.4382, bio=0.0000
    Epoch  6/10: total=2.5043, vae=1.0814, dsb=1.4229, bio=0.0000
    Epoch  7/10: total=2.4507, vae=1.0812, dsb=1.3695, bio=0.0000
    Epoch  8/10: total=2.4467, vae=1.0817, dsb=1.3650, bio=0.0000
    Epoch  9/10: total=2.3923, vae=1.0802, dsb=1.3121, bio=0.0000
    Epoch 10/10: total=2.4275, vae=1.0816, dsb=1.3458, bio=0.0000

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=100.8443, vae=1.0816, dsb=99.7627, bio=0.0000
    Epoch  2/10: total=97.4871, vae=1.0809, dsb=96.4062, bio=0.0000
    Epoch  3/10: total=96.0100, vae=1.0818, dsb=94.9282, bio=0.0000
    Epoch  4/10: total=96.1067, vae=1.0811, dsb=95.0256, bio=0.0000
    Epoch  5/10: total=94.6827, vae=1.0810, dsb=93.6017, bio=0.0000
    Epoch  6/10: total=94.6252, vae=1.0812, dsb=93.5441, bio=0.0000
    Epoch  7/10: total=94.5925, vae=1.0820, dsb=93.5105, bio=0.0000
    Epoch  8/10: total=95.0189, vae=1.0814, dsb=93.9376, bio=0.0000
    Epoch  9/10: total=94.3303, vae=1.0820, dsb=93.2483, bio=0.0000
    Epoch 10/10: total=95.2017, vae=1.0815, dsb=94.1202, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=2.1548, vae=1.0805, dsb=1.0743, bio=0.0000
    Epoch  2/10: total=2.1068, vae=1.0813, dsb=1.0255, bio=0.0000
    Epoch  3/10: total=2.0622, vae=1.0808, dsb=0.9814, bio=0.0000
    Epoch  4/10: total=2.0610, vae=1.0809, dsb=0.9801, bio=0.0000
    Epoch  5/10: total=2.0476, vae=1.0808, dsb=0.9668, bio=0.0000
    Epoch  6/10: total=2.0556, vae=1.0810, dsb=0.9745, bio=0.0000
    Epoch  7/10: total=2.0157, vae=1.0804, dsb=0.9354, bio=0.0000
    Epoch  8/10: total=2.0017, vae=1.0808, dsb=0.9209, bio=0.0000
    Epoch  9/10: total=2.0217, vae=1.0808, dsb=0.9410, bio=0.0000
    Epoch 10/10: total=2.0142, vae=1.0805, dsb=0.9337, bio=0.0000

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=82.5017, vae=1.0808, dsb=81.4210, bio=0.0000
    Epoch  2/10: total=81.0981, vae=1.0809, dsb=80.0172, bio=0.0000
    Epoch  3/10: total=80.7748, vae=1.0807, dsb=79.6941, bio=0.0000
    Epoch  4/10: total=80.8330, vae=1.0810, dsb=79.7519, bio=0.0000
    Epoch  5/10: total=79.9661, vae=1.0807, dsb=78.8853, bio=0.0000
    Epoch  6/10: total=80.4014, vae=1.0804, dsb=79.3210, bio=0.0000
    Epoch  7/10: total=80.1454, vae=1.0811, dsb=79.0643, bio=0.0000
    Epoch  8/10: total=79.6216, vae=1.0809, dsb=78.5407, bio=0.0000
    Epoch  9/10: total=80.0612, vae=1.0801, dsb=78.9811, bio=0.0000
    Epoch 10/10: total=79.9536, vae=1.0806, dsb=78.8730, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.8744, vae=1.0799, dsb=0.7944, bio=0.0000
    Epoch  2/10: total=1.8629, vae=1.0811, dsb=0.7818, bio=0.0000
    Epoch  3/10: total=1.8327, vae=1.0811, dsb=0.7516, bio=0.0000
    Epoch  4/10: total=1.8091, vae=1.0815, dsb=0.7276, bio=0.0000
    Epoch  5/10: total=1.8227, vae=1.0805, dsb=0.7422, bio=0.0000
    Epoch  6/10: total=1.7957, vae=1.0798, dsb=0.7159, bio=0.0000
    Epoch  7/10: total=1.8179, vae=1.0803, dsb=0.7376, bio=0.0000
    Epoch  8/10: total=1.8429, vae=1.0817, dsb=0.7612, bio=0.0000
    Epoch  9/10: total=1.8031, vae=1.0812, dsb=0.7219, bio=0.0000
    Epoch 10/10: total=1.7984, vae=1.0811, dsb=0.7173, bio=0.0000

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=72.8674, vae=1.0811, dsb=71.7863, bio=0.0000
    Epoch  2/10: total=72.2664, vae=1.0804, dsb=71.1860, bio=0.0000
    Epoch  3/10: total=71.8806, vae=1.0806, dsb=70.8001, bio=0.0000
    Epoch  4/10: total=71.6048, vae=1.0809, dsb=70.5239, bio=0.0000
    Epoch  5/10: total=71.7934, vae=1.0808, dsb=70.7126, bio=0.0000
    Epoch  6/10: total=72.0644, vae=1.0809, dsb=70.9835, bio=0.0000
    Epoch  7/10: total=71.4245, vae=1.0811, dsb=70.3434, bio=0.0000
    Epoch  8/10: total=71.6224, vae=1.0809, dsb=70.5415, bio=0.0000
    Epoch  9/10: total=71.7057, vae=1.0804, dsb=70.6252, bio=0.0000
    Epoch 10/10: total=71.5741, vae=1.0804, dsb=70.4937, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.6844, vae=1.0812, dsb=0.6032, bio=0.0000
    Epoch  2/10: total=1.6954, vae=1.0807, dsb=0.6147, bio=0.0000
    Epoch  3/10: total=1.6646, vae=1.0807, dsb=0.5840, bio=0.0000
    Epoch  4/10: total=1.6753, vae=1.0809, dsb=0.5944, bio=0.0000
    Epoch  5/10: total=1.6717, vae=1.0809, dsb=0.5908, bio=0.0000
    Epoch  6/10: total=1.6804, vae=1.0810, dsb=0.5993, bio=0.0000
    Epoch  7/10: total=1.6721, vae=1.0815, dsb=0.5906, bio=0.0000
    Epoch  8/10: total=1.6835, vae=1.0809, dsb=0.6026, bio=0.0000
    Epoch  9/10: total=1.6717, vae=1.0809, dsb=0.5908, bio=0.0000
    Epoch 10/10: total=1.6606, vae=1.0815, dsb=0.5790, bio=0.0000

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=59.5167, vae=1.0806, dsb=58.4361, bio=0.0000
    Epoch  2/10: total=59.3319, vae=1.0814, dsb=58.2505, bio=0.0000
    Epoch  3/10: total=59.4765, vae=1.0816, dsb=58.3949, bio=0.0000
    Epoch  4/10: total=59.4795, vae=1.0810, dsb=58.3985, bio=0.0000
    Epoch  5/10: total=59.4372, vae=1.0806, dsb=58.3566, bio=0.0000
    Epoch  6/10: total=59.3037, vae=1.0809, dsb=58.2228, bio=0.0000
    Epoch  7/10: total=59.4468, vae=1.0811, dsb=58.3657, bio=0.0000
    Epoch  8/10: total=59.4204, vae=1.0801, dsb=58.3403, bio=0.0000
    Epoch  9/10: total=59.5990, vae=1.0811, dsb=58.5179, bio=0.0000
    Epoch 10/10: total=59.3103, vae=1.0801, dsb=58.2301, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.6326, vae=1.0811, dsb=0.5515, bio=0.0000
    Epoch  2/10: total=1.5956, vae=1.0810, dsb=0.5146, bio=0.0000
    Epoch  3/10: total=1.6138, vae=1.0810, dsb=0.5328, bio=0.0000
    Epoch  4/10: total=1.6042, vae=1.0806, dsb=0.5236, bio=0.0000
    Epoch  5/10: total=1.6165, vae=1.0815, dsb=0.5350, bio=0.0000
    Epoch  6/10: total=1.5990, vae=1.0803, dsb=0.5188, bio=0.0000
    Epoch  7/10: total=1.5981, vae=1.0802, dsb=0.5179, bio=0.0000
    Epoch  8/10: total=1.6143, vae=1.0815, dsb=0.5328, bio=0.0000
    Epoch  9/10: total=1.6140, vae=1.0806, dsb=0.5334, bio=0.0000
    Epoch 10/10: total=1.6314, vae=1.0797, dsb=0.5517, bio=0.0000

[Seed 44] Joint training (ablation) complete; models and history saved.

[Seed 44] Drift genes saved in /home/yyuan/ICB_TCE/iter_results/run_044

[Seed 44] run finished.

================================================================================
[Seed 45] Starting running whole pipeline...
================================================================================

[Seed 45] Starting VAE pre-training...

    Epoch [01/20], Beta: 0.000, Average Loss: 540.6283
    Epoch [02/20], Beta: 0.000, Average Loss: 304.3334
    Epoch [03/20], Beta: 0.000, Average Loss: 272.5789
    Epoch [04/20], Beta: 0.000, Average Loss: 253.6446
    Epoch [05/20], Beta: 0.100, Average Loss: 246.7971
    Epoch [06/20], Beta: 0.200, Average Loss: 245.3370
    Epoch [07/20], Beta: 0.300, Average Loss: 245.3817
    Epoch [08/20], Beta: 0.400, Average Loss: 246.0780
    Epoch [09/20], Beta: 0.500, Average Loss: 247.1558
    Epoch [10/20], Beta: 0.600, Average Loss: 248.3393
    Epoch [11/20], Beta: 0.700, Average Loss: 249.6406
    Epoch [12/20], Beta: 0.800, Average Loss: 250.8178
    Epoch [13/20], Beta: 0.900, Average Loss: 252.0380
    Epoch [14/20], Beta: 1.000, Average Loss: 253.6606
    Epoch [15/20], Beta: 1.000, Average Loss: 253.2155
    Epoch [16/20], Beta: 1.000, Average Loss: 252.7511
    Epoch [17/20], Beta: 1.000, Average Loss: 252.4012
    Epoch [18/20], Beta: 1.000, Average Loss: 252.0978
    Epoch [19/20], Beta: 1.000, Average Loss: 251.6896
    Epoch [20/20], Beta: 1.000, Average Loss: 251.4944

[Seed 45] VAE pre-training complete.

[Seed 45] Starting joint training (original)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=205.4546, vae=3.6846, dsb=185.6289, bio=32.2821
    Epoch  2/10: total=54.6189, vae=1.1055, dsb=53.4763, bio=0.0742
    Epoch  3/10: total=44.7612, vae=1.0995, dsb=43.6457, bio=0.0321
    Epoch  4/10: total=40.0568, vae=1.0966, dsb=38.9509, bio=0.0187
    Epoch  5/10: total=37.1948, vae=1.0949, dsb=36.0938, bio=0.0123
    Epoch  6/10: total=35.2510, vae=1.0954, dsb=34.1511, bio=0.0090
    Epoch  7/10: total=33.6948, vae=1.0941, dsb=32.5973, bio=0.0069
    Epoch  8/10: total=32.5657, vae=1.0938, dsb=31.4692, bio=0.0056
    Epoch  9/10: total=31.5949, vae=1.0939, dsb=30.4986, bio=0.0046
    Epoch 10/10: total=30.9070, vae=1.0937, dsb=29.8113, bio=0.0040

  [Backward Policy Training]
    Epoch  1/10: total=3.0015, vae=1.0942, dsb=1.9022, bio=0.0103
    Epoch  2/10: total=2.5079, vae=1.0936, dsb=1.4124, bio=0.0037
    Epoch  3/10: total=2.4368, vae=1.0919, dsb=1.3435, bio=0.0029
    Epoch  4/10: total=2.3471, vae=1.0913, dsb=1.2545, bio=0.0025
    Epoch  5/10: total=2.3060, vae=1.0915, dsb=1.2134, bio=0.0023
    Epoch  6/10: total=2.2770, vae=1.0921, dsb=1.1838, bio=0.0023
    Epoch  7/10: total=2.2441, vae=1.0908, dsb=1.1523, bio=0.0021
    Epoch  8/10: total=2.2164, vae=1.0917, dsb=1.1237, bio=0.0020
    Epoch  9/10: total=2.1911, vae=1.0913, dsb=1.0988, bio=0.0019
    Epoch 10/10: total=2.1802, vae=1.0909, dsb=1.0883, bio=0.0019

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=30.4351, vae=1.0946, dsb=29.3389, bio=0.0033
    Epoch  2/10: total=23.4818, vae=1.0925, dsb=22.3884, bio=0.0019
    Epoch  3/10: total=21.7917, vae=1.0917, dsb=20.6991, bio=0.0018
    Epoch  4/10: total=20.9118, vae=1.0917, dsb=19.8192, bio=0.0018
    Epoch  5/10: total=20.3346, vae=1.0919, dsb=19.2418, bio=0.0018
    Epoch  6/10: total=19.8904, vae=1.0918, dsb=18.7977, bio=0.0019
    Epoch  7/10: total=19.5495, vae=1.0911, dsb=18.4574, bio=0.0018
    Epoch  8/10: total=19.2486, vae=1.0913, dsb=18.1564, bio=0.0018
    Epoch  9/10: total=19.0210, vae=1.0922, dsb=17.9280, bio=0.0018
    Epoch 10/10: total=18.8885, vae=1.0905, dsb=17.7970, bio=0.0018

  [Backward Policy Training]
    Epoch  1/10: total=1.9976, vae=1.0923, dsb=0.9026, bio=0.0055
    Epoch  2/10: total=1.8609, vae=1.0911, dsb=0.7689, bio=0.0018
    Epoch  3/10: total=1.8231, vae=1.0899, dsb=0.7324, bio=0.0017
    Epoch  4/10: total=1.7967, vae=1.0898, dsb=0.7060, bio=0.0016
    Epoch  5/10: total=1.7663, vae=1.0909, dsb=0.6746, bio=0.0016
    Epoch  6/10: total=1.7661, vae=1.0907, dsb=0.6746, bio=0.0016
    Epoch  7/10: total=1.7613, vae=1.0900, dsb=0.6706, bio=0.0015
    Epoch  8/10: total=1.7372, vae=1.0901, dsb=0.6463, bio=0.0015
    Epoch  9/10: total=1.7255, vae=1.0903, dsb=0.6345, bio=0.0015
    Epoch 10/10: total=1.7174, vae=1.0900, dsb=0.6267, bio=0.0014

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=19.2135, vae=1.0923, dsb=18.1198, bio=0.0028
    Epoch  2/10: total=16.3023, vae=1.0910, dsb=15.2101, bio=0.0023
    Epoch  3/10: total=15.5717, vae=1.0901, dsb=14.4808, bio=0.0015
    Epoch  4/10: total=15.1500, vae=1.0908, dsb=14.0584, bio=0.0015
    Epoch  5/10: total=14.8968, vae=1.0901, dsb=13.8059, bio=0.0015
    Epoch  6/10: total=14.6949, vae=1.0907, dsb=13.6034, bio=0.0015
    Epoch  7/10: total=14.5836, vae=1.0912, dsb=13.4916, bio=0.0015
    Epoch  8/10: total=14.4349, vae=1.0909, dsb=13.3433, bio=0.0015
    Epoch  9/10: total=14.3548, vae=1.0902, dsb=13.2638, bio=0.0016
    Epoch 10/10: total=14.2822, vae=1.0897, dsb=13.1919, bio=0.0014

  [Backward Policy Training]
    Epoch  1/10: total=1.6422, vae=1.0901, dsb=0.5382, bio=0.0276
    Epoch  2/10: total=1.5625, vae=1.0904, dsb=0.4713, bio=0.0015
    Epoch  3/10: total=1.5579, vae=1.0895, dsb=0.4677, bio=0.0013
    Epoch  4/10: total=1.5421, vae=1.0897, dsb=0.4517, bio=0.0013
    Epoch  5/10: total=1.5283, vae=1.0897, dsb=0.4379, bio=0.0013
    Epoch  6/10: total=1.5290, vae=1.0897, dsb=0.4387, bio=0.0012
    Epoch  7/10: total=1.5134, vae=1.0891, dsb=0.4238, bio=0.0012
    Epoch  8/10: total=1.5106, vae=1.0902, dsb=0.4198, bio=0.0012
    Epoch  9/10: total=1.5100, vae=1.0891, dsb=0.4203, bio=0.0012
    Epoch 10/10: total=1.5030, vae=1.0901, dsb=0.4123, bio=0.0013

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=14.2032, vae=1.0918, dsb=13.1102, bio=0.0023
    Epoch  2/10: total=12.8162, vae=1.0900, dsb=11.7255, bio=0.0013
    Epoch  3/10: total=12.4791, vae=1.0901, dsb=11.3884, bio=0.0013
    Epoch  4/10: total=12.3371, vae=1.0899, dsb=11.2466, bio=0.0013
    Epoch  5/10: total=12.1826, vae=1.0896, dsb=11.0924, bio=0.0012
    Epoch  6/10: total=12.1227, vae=1.0891, dsb=11.0330, bio=0.0012
    Epoch  7/10: total=12.0729, vae=1.0897, dsb=10.9826, bio=0.0011
    Epoch  8/10: total=12.0182, vae=1.0895, dsb=10.9282, bio=0.0011
    Epoch  9/10: total=11.9549, vae=1.0895, dsb=10.8649, bio=0.0011
    Epoch 10/10: total=11.9352, vae=1.0891, dsb=10.8456, bio=0.0011

  [Backward Policy Training]
    Epoch  1/10: total=1.5008, vae=1.0905, dsb=0.3549, bio=0.1107
    Epoch  2/10: total=1.4123, vae=1.0902, dsb=0.3214, bio=0.0012
    Epoch  3/10: total=1.4004, vae=1.0894, dsb=0.3105, bio=0.0011
    Epoch  4/10: total=1.4087, vae=1.0900, dsb=0.3181, bio=0.0011
    Epoch  5/10: total=1.3982, vae=1.0891, dsb=0.3085, bio=0.0011
    Epoch  6/10: total=1.3863, vae=1.0891, dsb=0.2967, bio=0.0010
    Epoch  7/10: total=1.3823, vae=1.0893, dsb=0.2925, bio=0.0010
    Epoch  8/10: total=1.3856, vae=1.0890, dsb=0.2961, bio=0.0010
    Epoch  9/10: total=1.3885, vae=1.0880, dsb=0.3000, bio=0.0010
    Epoch 10/10: total=1.3831, vae=1.0891, dsb=0.2935, bio=0.0010

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=10.8692, vae=1.0912, dsb=9.7768, bio=0.0024
    Epoch  2/10: total=10.4467, vae=1.0891, dsb=9.3570, bio=0.0010
    Epoch  3/10: total=10.3539, vae=1.0889, dsb=9.2645, bio=0.0011
    Epoch  4/10: total=10.2538, vae=1.0899, dsb=9.1634, bio=0.0010
    Epoch  5/10: total=10.2544, vae=1.0899, dsb=9.1641, bio=0.0010
    Epoch  6/10: total=10.1915, vae=1.0896, dsb=9.1014, bio=0.0009
    Epoch  7/10: total=10.1908, vae=1.0893, dsb=9.1011, bio=0.0006
    Epoch  8/10: total=10.1589, vae=1.0890, dsb=9.0698, bio=0.0004
    Epoch  9/10: total=10.1768, vae=1.0895, dsb=9.0868, bio=0.0011
    Epoch 10/10: total=10.1380, vae=1.0888, dsb=9.0487, bio=0.0010

  [Backward Policy Training]
    Epoch  1/10: total=1.4371, vae=1.0912, dsb=0.2568, bio=0.1782
    Epoch  2/10: total=1.3263, vae=1.0893, dsb=0.2365, bio=0.0010
    Epoch  3/10: total=1.3231, vae=1.0897, dsb=0.2329, bio=0.0010
    Epoch  4/10: total=1.3262, vae=1.0894, dsb=0.2365, bio=0.0007
    Epoch  5/10: total=1.3235, vae=1.0893, dsb=0.2338, bio=0.0007
    Epoch  6/10: total=1.3297, vae=1.0897, dsb=0.2394, bio=0.0010
    Epoch  7/10: total=1.3182, vae=1.0900, dsb=0.2277, bio=0.0009
    Epoch  8/10: total=1.3178, vae=1.0891, dsb=0.2286, bio=0.0003
    Epoch  9/10: total=1.3182, vae=1.0883, dsb=0.2295, bio=0.0007
    Epoch 10/10: total=1.3149, vae=1.0896, dsb=0.2248, bio=0.0010

[Seed 45] Joint training (original) complete; models and history saved.

[Seed 45] Starting joint training (ablation)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=187.4233, vae=1.9996, dsb=185.4238, bio=0.0000
    Epoch  2/10: total=54.4163, vae=1.0859, dsb=53.3303, bio=0.0000
    Epoch  3/10: total=44.5415, vae=1.0838, dsb=43.4577, bio=0.0000
    Epoch  4/10: total=39.8256, vae=1.0825, dsb=38.7431, bio=0.0000
    Epoch  5/10: total=37.0107, vae=1.0816, dsb=35.9291, bio=0.0000
    Epoch  6/10: total=35.0983, vae=1.0825, dsb=34.0158, bio=0.0000
    Epoch  7/10: total=33.6181, vae=1.0817, dsb=32.5364, bio=0.0000
    Epoch  8/10: total=32.5455, vae=1.0816, dsb=31.4640, bio=0.0000
    Epoch  9/10: total=31.5700, vae=1.0820, dsb=30.4880, bio=0.0000
    Epoch 10/10: total=30.8661, vae=1.0820, dsb=29.7841, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=2.9514, vae=1.0817, dsb=1.8698, bio=0.0000
    Epoch  2/10: total=2.4763, vae=1.0828, dsb=1.3935, bio=0.0000
    Epoch  3/10: total=2.4066, vae=1.0815, dsb=1.3251, bio=0.0000
    Epoch  4/10: total=2.3183, vae=1.0812, dsb=1.2371, bio=0.0000
    Epoch  5/10: total=2.2779, vae=1.0816, dsb=1.1963, bio=0.0000
    Epoch  6/10: total=2.2489, vae=1.0822, dsb=1.1666, bio=0.0000
    Epoch  7/10: total=2.2165, vae=1.0812, dsb=1.1352, bio=0.0000
    Epoch  8/10: total=2.1898, vae=1.0823, dsb=1.1075, bio=0.0000
    Epoch  9/10: total=2.1648, vae=1.0819, dsb=1.0829, bio=0.0000
    Epoch 10/10: total=2.1543, vae=1.0816, dsb=1.0727, bio=0.0000

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=30.3399, vae=1.0826, dsb=29.2574, bio=0.0000
    Epoch  2/10: total=23.4309, vae=1.0817, dsb=22.3492, bio=0.0000
    Epoch  3/10: total=21.7372, vae=1.0810, dsb=20.6562, bio=0.0000
    Epoch  4/10: total=20.8159, vae=1.0813, dsb=19.7346, bio=0.0000
    Epoch  5/10: total=20.2374, vae=1.0816, dsb=19.1558, bio=0.0000
    Epoch  6/10: total=19.7921, vae=1.0816, dsb=18.7106, bio=0.0000
    Epoch  7/10: total=19.4316, vae=1.0810, dsb=18.3506, bio=0.0000
    Epoch  8/10: total=19.1174, vae=1.0813, dsb=18.0362, bio=0.0000
    Epoch  9/10: total=18.8984, vae=1.0823, dsb=17.8161, bio=0.0000
    Epoch 10/10: total=18.7781, vae=1.0807, dsb=17.6973, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.9590, vae=1.0819, dsb=0.8771, bio=0.0000
    Epoch  2/10: total=1.8259, vae=1.0822, dsb=0.7437, bio=0.0000
    Epoch  3/10: total=1.7886, vae=1.0811, dsb=0.7075, bio=0.0000
    Epoch  4/10: total=1.7628, vae=1.0812, dsb=0.6816, bio=0.0000
    Epoch  5/10: total=1.7333, vae=1.0822, dsb=0.6510, bio=0.0000
    Epoch  6/10: total=1.7333, vae=1.0821, dsb=0.6511, bio=0.0000
    Epoch  7/10: total=1.7283, vae=1.0816, dsb=0.6467, bio=0.0000
    Epoch  8/10: total=1.7045, vae=1.0817, dsb=0.6228, bio=0.0000
    Epoch  9/10: total=1.6932, vae=1.0818, dsb=0.6114, bio=0.0000
    Epoch 10/10: total=1.6853, vae=1.0816, dsb=0.6037, bio=0.0000

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=18.9899, vae=1.0813, dsb=17.9086, bio=0.0000
    Epoch  2/10: total=16.0789, vae=1.0813, dsb=14.9976, bio=0.0000
    Epoch  3/10: total=15.3667, vae=1.0807, dsb=14.2860, bio=0.0000
    Epoch  4/10: total=14.9434, vae=1.0815, dsb=13.8619, bio=0.0000
    Epoch  5/10: total=14.7107, vae=1.0809, dsb=13.6297, bio=0.0000
    Epoch  6/10: total=14.5238, vae=1.0816, dsb=13.4422, bio=0.0000
    Epoch  7/10: total=14.4079, vae=1.0822, dsb=13.3257, bio=0.0000
    Epoch  8/10: total=14.2847, vae=1.0820, dsb=13.2027, bio=0.0000
    Epoch  9/10: total=14.1953, vae=1.0814, dsb=13.1139, bio=0.0000
    Epoch 10/10: total=14.1449, vae=1.0810, dsb=13.0639, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.5956, vae=1.0809, dsb=0.5147, bio=0.0000
    Epoch  2/10: total=1.5312, vae=1.0822, dsb=0.4490, bio=0.0000
    Epoch  3/10: total=1.5262, vae=1.0814, dsb=0.4448, bio=0.0000
    Epoch  4/10: total=1.5113, vae=1.0817, dsb=0.4296, bio=0.0000
    Epoch  5/10: total=1.4985, vae=1.0816, dsb=0.4168, bio=0.0000
    Epoch  6/10: total=1.4992, vae=1.0817, dsb=0.4175, bio=0.0000
    Epoch  7/10: total=1.4847, vae=1.0811, dsb=0.4036, bio=0.0000
    Epoch  8/10: total=1.4829, vae=1.0822, dsb=0.4006, bio=0.0000
    Epoch  9/10: total=1.4830, vae=1.0812, dsb=0.4018, bio=0.0000
    Epoch 10/10: total=1.4767, vae=1.0821, dsb=0.3946, bio=0.0000

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=14.4057, vae=1.0812, dsb=13.3245, bio=0.0000
    Epoch  2/10: total=13.0412, vae=1.0810, dsb=11.9602, bio=0.0000
    Epoch  3/10: total=12.7079, vae=1.0813, dsb=11.6265, bio=0.0000
    Epoch  4/10: total=12.5618, vae=1.0814, dsb=11.4804, bio=0.0000
    Epoch  5/10: total=12.4061, vae=1.0812, dsb=11.3249, bio=0.0000
    Epoch  6/10: total=12.3580, vae=1.0808, dsb=11.2772, bio=0.0000
    Epoch  7/10: total=12.3108, vae=1.0815, dsb=11.2293, bio=0.0000
    Epoch  8/10: total=12.2470, vae=1.0814, dsb=11.1656, bio=0.0000
    Epoch  9/10: total=12.2012, vae=1.0815, dsb=11.1197, bio=0.0000
    Epoch 10/10: total=12.1747, vae=1.0812, dsb=11.0935, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.4285, vae=1.0816, dsb=0.3469, bio=0.0000
    Epoch  2/10: total=1.3965, vae=1.0823, dsb=0.3142, bio=0.0000
    Epoch  3/10: total=1.3856, vae=1.0816, dsb=0.3041, bio=0.0000
    Epoch  4/10: total=1.3943, vae=1.0822, dsb=0.3121, bio=0.0000
    Epoch  5/10: total=1.3838, vae=1.0813, dsb=0.3024, bio=0.0000
    Epoch  6/10: total=1.3721, vae=1.0815, dsb=0.2907, bio=0.0000
    Epoch  7/10: total=1.3686, vae=1.0818, dsb=0.2869, bio=0.0000
    Epoch  8/10: total=1.3721, vae=1.0814, dsb=0.2907, bio=0.0000
    Epoch  9/10: total=1.3750, vae=1.0804, dsb=0.2946, bio=0.0000
    Epoch 10/10: total=1.3696, vae=1.0815, dsb=0.2881, bio=0.0000

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=10.8946, vae=1.0813, dsb=9.8133, bio=0.0000
    Epoch  2/10: total=10.4232, vae=1.0804, dsb=9.3427, bio=0.0000
    Epoch  3/10: total=10.3354, vae=1.0806, dsb=9.2548, bio=0.0000
    Epoch  4/10: total=10.2153, vae=1.0818, dsb=9.1334, bio=0.0000
    Epoch  5/10: total=10.2239, vae=1.0820, dsb=9.1419, bio=0.0000
    Epoch  6/10: total=10.1547, vae=1.0818, dsb=9.0729, bio=0.0000
    Epoch  7/10: total=10.1485, vae=1.0816, dsb=9.0669, bio=0.0000
    Epoch  8/10: total=10.1212, vae=1.0813, dsb=9.0399, bio=0.0000
    Epoch  9/10: total=10.1337, vae=1.0820, dsb=9.0517, bio=0.0000
    Epoch 10/10: total=10.0945, vae=1.0813, dsb=9.0132, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.3302, vae=1.0823, dsb=0.2479, bio=0.0000
    Epoch  2/10: total=1.3093, vae=1.0817, dsb=0.2277, bio=0.0000
    Epoch  3/10: total=1.3062, vae=1.0822, dsb=0.2240, bio=0.0000
    Epoch  4/10: total=1.3091, vae=1.0819, dsb=0.2273, bio=0.0000
    Epoch  5/10: total=1.3062, vae=1.0819, dsb=0.2244, bio=0.0000
    Epoch  6/10: total=1.3123, vae=1.0824, dsb=0.2299, bio=0.0000
    Epoch  7/10: total=1.3007, vae=1.0826, dsb=0.2181, bio=0.0000
    Epoch  8/10: total=1.3004, vae=1.0816, dsb=0.2188, bio=0.0000
    Epoch  9/10: total=1.3006, vae=1.0810, dsb=0.2196, bio=0.0000
    Epoch 10/10: total=1.2971, vae=1.0823, dsb=0.2148, bio=0.0000

[Seed 45] Joint training (ablation) complete; models and history saved.

[Seed 45] Drift genes saved in /home/yyuan/ICB_TCE/iter_results/run_045

[Seed 45] run finished.

================================================================================
[Seed 46] Starting running whole pipeline...
================================================================================

[Seed 46] Starting VAE pre-training...

    Epoch [01/20], Beta: 0.000, Average Loss: 536.2425
    Epoch [02/20], Beta: 0.000, Average Loss: 308.7698
    Epoch [03/20], Beta: 0.000, Average Loss: 271.3571
    Epoch [04/20], Beta: 0.000, Average Loss: 252.2267
    Epoch [05/20], Beta: 0.100, Average Loss: 246.7366
    Epoch [06/20], Beta: 0.200, Average Loss: 245.1034
    Epoch [07/20], Beta: 0.300, Average Loss: 245.1811
    Epoch [08/20], Beta: 0.400, Average Loss: 245.9719
    Epoch [09/20], Beta: 0.500, Average Loss: 247.0574
    Epoch [10/20], Beta: 0.600, Average Loss: 248.2385
    Epoch [11/20], Beta: 0.700, Average Loss: 249.4335
    Epoch [12/20], Beta: 0.800, Average Loss: 250.6978
    Epoch [13/20], Beta: 0.900, Average Loss: 251.9168
    Epoch [14/20], Beta: 1.000, Average Loss: 253.4630
    Epoch [15/20], Beta: 1.000, Average Loss: 253.0677
    Epoch [16/20], Beta: 1.000, Average Loss: 252.6586
    Epoch [17/20], Beta: 1.000, Average Loss: 252.3072
    Epoch [18/20], Beta: 1.000, Average Loss: 251.9541
    Epoch [19/20], Beta: 1.000, Average Loss: 251.5683
    Epoch [20/20], Beta: 1.000, Average Loss: 251.3746

[Seed 46] VAE pre-training complete.

[Seed 46] Starting joint training (original)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=279.9940, vae=3.4030, dsb=266.5349, bio=20.1121
    Epoch  2/10: total=78.9901, vae=1.1084, dsb=77.8515, bio=0.0603
    Epoch  3/10: total=69.5985, vae=1.1045, dsb=68.4805, bio=0.0271
    Epoch  4/10: total=65.0115, vae=1.1032, dsb=63.9003, bio=0.0161
    Epoch  5/10: total=62.7055, vae=1.1023, dsb=61.5977, bio=0.0110
    Epoch  6/10: total=60.6727, vae=1.1022, dsb=59.5663, bio=0.0084
    Epoch  7/10: total=59.3779, vae=1.1016, dsb=58.2730, bio=0.0065
    Epoch  8/10: total=58.3865, vae=1.1006, dsb=57.2833, bio=0.0054
    Epoch  9/10: total=57.5869, vae=1.0996, dsb=56.4850, bio=0.0046
    Epoch 10/10: total=57.0731, vae=1.1006, dsb=55.9702, bio=0.0047

  [Backward Policy Training]
    Epoch  1/10: total=3.1667, vae=1.1012, dsb=2.0584, bio=0.0141
    Epoch  2/10: total=2.6526, vae=1.0998, dsb=1.5503, bio=0.0049
    Epoch  3/10: total=2.6082, vae=1.0995, dsb=1.5070, bio=0.0035
    Epoch  4/10: total=2.5219, vae=1.0986, dsb=1.4218, bio=0.0029
    Epoch  5/10: total=2.5285, vae=1.0984, dsb=1.4288, bio=0.0024
    Epoch  6/10: total=2.4807, vae=1.0979, dsb=1.3815, bio=0.0026
    Epoch  7/10: total=2.4474, vae=1.0982, dsb=1.3481, bio=0.0023
    Epoch  8/10: total=2.4114, vae=1.0988, dsb=1.3116, bio=0.0021
    Epoch  9/10: total=2.4128, vae=1.0977, dsb=1.3141, bio=0.0020
    Epoch 10/10: total=2.3717, vae=1.0981, dsb=1.2726, bio=0.0020

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=49.9397, vae=1.1004, dsb=48.8375, bio=0.0035
    Epoch  2/10: total=44.8501, vae=1.0997, dsb=43.7491, bio=0.0027
    Epoch  3/10: total=43.3165, vae=1.0980, dsb=42.2176, bio=0.0018
    Epoch  4/10: total=42.6474, vae=1.0988, dsb=41.5476, bio=0.0018
    Epoch  5/10: total=42.1815, vae=1.0992, dsb=41.0813, bio=0.0018
    Epoch  6/10: total=41.8867, vae=1.0987, dsb=40.7870, bio=0.0019
    Epoch  7/10: total=41.5502, vae=1.0979, dsb=40.4513, bio=0.0019
    Epoch  8/10: total=41.2228, vae=1.0992, dsb=40.1225, bio=0.0022
    Epoch  9/10: total=41.0839, vae=1.0980, dsb=39.9850, bio=0.0020
    Epoch 10/10: total=40.8844, vae=1.0993, dsb=39.7842, bio=0.0019

  [Backward Policy Training]
    Epoch  1/10: total=2.1188, vae=1.0991, dsb=1.0169, bio=0.0057
    Epoch  2/10: total=2.0058, vae=1.0985, dsb=0.9064, bio=0.0020
    Epoch  3/10: total=2.0096, vae=1.0970, dsb=0.9116, bio=0.0019
    Epoch  4/10: total=1.9656, vae=1.0969, dsb=0.8678, bio=0.0019
    Epoch  5/10: total=1.9357, vae=1.0973, dsb=0.8376, bio=0.0017
    Epoch  6/10: total=1.9420, vae=1.0971, dsb=0.8440, bio=0.0017
    Epoch  7/10: total=1.9287, vae=1.0978, dsb=0.8300, bio=0.0017
    Epoch  8/10: total=1.9366, vae=1.0974, dsb=0.8384, bio=0.0017
    Epoch  9/10: total=1.9405, vae=1.0967, dsb=0.8429, bio=0.0017
    Epoch 10/10: total=1.9379, vae=1.0964, dsb=0.8407, bio=0.0016

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=39.5919, vae=1.0999, dsb=38.4904, bio=0.0032
    Epoch  2/10: total=37.6546, vae=1.0986, dsb=36.5549, bio=0.0021
    Epoch  3/10: total=36.9795, vae=1.0983, dsb=35.8788, bio=0.0049
    Epoch  4/10: total=36.6910, vae=1.0978, dsb=35.5921, bio=0.0020
    Epoch  5/10: total=36.6226, vae=1.0989, dsb=35.5229, bio=0.0016
    Epoch  6/10: total=36.4499, vae=1.0986, dsb=35.3505, bio=0.0017
    Epoch  7/10: total=36.3589, vae=1.0976, dsb=35.2605, bio=0.0017
    Epoch  8/10: total=36.2819, vae=1.0992, dsb=35.1818, bio=0.0017
    Epoch  9/10: total=36.1835, vae=1.0976, dsb=35.0850, bio=0.0018
    Epoch 10/10: total=36.0662, vae=1.0978, dsb=34.9676, bio=0.0016

  [Backward Policy Training]
    Epoch  1/10: total=1.8370, vae=1.0983, dsb=0.7335, bio=0.0103
    Epoch  2/10: total=1.7607, vae=1.0967, dsb=0.6631, bio=0.0017
    Epoch  3/10: total=1.7545, vae=1.0982, dsb=0.6556, bio=0.0016
    Epoch  4/10: total=1.7374, vae=1.0970, dsb=0.6396, bio=0.0015
    Epoch  5/10: total=1.7086, vae=1.0968, dsb=0.6111, bio=0.0015
    Epoch  6/10: total=1.7350, vae=1.0971, dsb=0.6370, bio=0.0018
    Epoch  7/10: total=1.7220, vae=1.0965, dsb=0.6247, bio=0.0015
    Epoch  8/10: total=1.7336, vae=1.0963, dsb=0.6366, bio=0.0014
    Epoch  9/10: total=1.7025, vae=1.0964, dsb=0.6054, bio=0.0014
    Epoch 10/10: total=1.7106, vae=1.0957, dsb=0.6143, bio=0.0014

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=32.7823, vae=1.0995, dsb=31.6813, bio=0.0029
    Epoch  2/10: total=31.9998, vae=1.0981, dsb=30.9010, bio=0.0013
    Epoch  3/10: total=31.6617, vae=1.0976, dsb=30.5634, bio=0.0015
    Epoch  4/10: total=31.5923, vae=1.0970, dsb=30.4946, bio=0.0015
    Epoch  5/10: total=31.5571, vae=1.0968, dsb=30.4596, bio=0.0016
    Epoch  6/10: total=31.6159, vae=1.0969, dsb=30.5182, bio=0.0015
    Epoch  7/10: total=31.3567, vae=1.0965, dsb=30.2593, bio=0.0017
    Epoch  8/10: total=31.4623, vae=1.0967, dsb=30.3648, bio=0.0015
    Epoch  9/10: total=31.5411, vae=1.0972, dsb=30.4431, bio=0.0015
    Epoch 10/10: total=31.3846, vae=1.0966, dsb=30.2872, bio=0.0015

  [Backward Policy Training]
    Epoch  1/10: total=1.6436, vae=1.0979, dsb=0.5397, bio=0.0121
    Epoch  2/10: total=1.6153, vae=1.0966, dsb=0.5179, bio=0.0015
    Epoch  3/10: total=1.6300, vae=1.0968, dsb=0.5324, bio=0.0015
    Epoch  4/10: total=1.6080, vae=1.0959, dsb=0.5115, bio=0.0013
    Epoch  5/10: total=1.6229, vae=1.0965, dsb=0.5257, bio=0.0012
    Epoch  6/10: total=1.5971, vae=1.0959, dsb=0.5006, bio=0.0012
    Epoch  7/10: total=1.5995, vae=1.0961, dsb=0.5029, bio=0.0012
    Epoch  8/10: total=1.6048, vae=1.0965, dsb=0.5076, bio=0.0013
    Epoch  9/10: total=1.5992, vae=1.0964, dsb=0.5021, bio=0.0013
    Epoch 10/10: total=1.6080, vae=1.0961, dsb=0.5113, bio=0.0012

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=28.1105, vae=1.0984, dsb=27.0108, bio=0.0027
    Epoch  2/10: total=27.8741, vae=1.0978, dsb=26.7756, bio=0.0013
    Epoch  3/10: total=27.6459, vae=1.0981, dsb=26.5472, bio=0.0013
    Epoch  4/10: total=27.5699, vae=1.0972, dsb=26.4721, bio=0.0013
    Epoch  5/10: total=27.8479, vae=1.0971, dsb=26.7500, bio=0.0016
    Epoch  6/10: total=27.7413, vae=1.0971, dsb=26.6435, bio=0.0014
    Epoch  7/10: total=27.5319, vae=1.0970, dsb=26.4343, bio=0.0013
    Epoch  8/10: total=27.5879, vae=1.0966, dsb=26.4906, bio=0.0013
    Epoch  9/10: total=27.7947, vae=1.0956, dsb=26.6984, bio=0.0013
    Epoch 10/10: total=27.6851, vae=1.0961, dsb=26.5883, bio=0.0013

  [Backward Policy Training]
    Epoch  1/10: total=1.5641, vae=1.0973, dsb=0.4515, bio=0.0306
    Epoch  2/10: total=1.5472, vae=1.0960, dsb=0.4505, bio=0.0013
    Epoch  3/10: total=1.5534, vae=1.0960, dsb=0.4569, bio=0.0012
    Epoch  4/10: total=1.5391, vae=1.0960, dsb=0.4425, bio=0.0012
    Epoch  5/10: total=1.5432, vae=1.0960, dsb=0.4466, bio=0.0012
    Epoch  6/10: total=1.5426, vae=1.0953, dsb=0.4468, bio=0.0010
    Epoch  7/10: total=1.5414, vae=1.0962, dsb=0.4447, bio=0.0011
    Epoch  8/10: total=1.5468, vae=1.0959, dsb=0.4504, bio=0.0010
    Epoch  9/10: total=1.5497, vae=1.0959, dsb=0.4533, bio=0.0013
    Epoch 10/10: total=1.5373, vae=1.0967, dsb=0.4401, bio=0.0010

[Seed 46] Joint training (original) complete; models and history saved.

[Seed 46] Starting joint training (ablation)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=268.0183, vae=2.0238, dsb=265.9945, bio=0.0000
    Epoch  2/10: total=78.4450, vae=1.0922, dsb=77.3528, bio=0.0000
    Epoch  3/10: total=69.1656, vae=1.0904, dsb=68.0752, bio=0.0000
    Epoch  4/10: total=64.6312, vae=1.0899, dsb=63.5412, bio=0.0000
    Epoch  5/10: total=62.2182, vae=1.0894, dsb=61.1288, bio=0.0000
    Epoch  6/10: total=60.0510, vae=1.0895, dsb=58.9614, bio=0.0000
    Epoch  7/10: total=58.6473, vae=1.0893, dsb=57.5580, bio=0.0000
    Epoch  8/10: total=57.6640, vae=1.0885, dsb=56.5755, bio=0.0000
    Epoch  9/10: total=56.8699, vae=1.0879, dsb=55.7820, bio=0.0000
    Epoch 10/10: total=56.4688, vae=1.0890, dsb=55.3798, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=3.0594, vae=1.0888, dsb=1.9705, bio=0.0000
    Epoch  2/10: total=2.5630, vae=1.0890, dsb=1.4740, bio=0.0000
    Epoch  3/10: total=2.5170, vae=1.0891, dsb=1.4279, bio=0.0000
    Epoch  4/10: total=2.4328, vae=1.0885, dsb=1.3442, bio=0.0000
    Epoch  5/10: total=2.4384, vae=1.0885, dsb=1.3499, bio=0.0000
    Epoch  6/10: total=2.3949, vae=1.0882, dsb=1.3068, bio=0.0000
    Epoch  7/10: total=2.3649, vae=1.0886, dsb=1.2762, bio=0.0000
    Epoch  8/10: total=2.3317, vae=1.0892, dsb=1.2425, bio=0.0000
    Epoch  9/10: total=2.3337, vae=1.0883, dsb=1.2454, bio=0.0000
    Epoch 10/10: total=2.2942, vae=1.0888, dsb=1.2054, bio=0.0000

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=47.9526, vae=1.0884, dsb=46.8643, bio=0.0000
    Epoch  2/10: total=43.0685, vae=1.0886, dsb=41.9799, bio=0.0000
    Epoch  3/10: total=41.6306, vae=1.0873, dsb=40.5433, bio=0.0000
    Epoch  4/10: total=41.0629, vae=1.0883, dsb=39.9746, bio=0.0000
    Epoch  5/10: total=40.6628, vae=1.0887, dsb=39.5741, bio=0.0000
    Epoch  6/10: total=40.3863, vae=1.0883, dsb=39.2980, bio=0.0000
    Epoch  7/10: total=40.1148, vae=1.0876, dsb=39.0272, bio=0.0000
    Epoch  8/10: total=39.8097, vae=1.0889, dsb=38.7208, bio=0.0000
    Epoch  9/10: total=39.6803, vae=1.0878, dsb=38.5925, bio=0.0000
    Epoch 10/10: total=39.5168, vae=1.0893, dsb=38.4275, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=2.0347, vae=1.0886, dsb=0.9462, bio=0.0000
    Epoch  2/10: total=1.9311, vae=1.0893, dsb=0.8418, bio=0.0000
    Epoch  3/10: total=1.9344, vae=1.0879, dsb=0.8464, bio=0.0000
    Epoch  4/10: total=1.8944, vae=1.0881, dsb=0.8062, bio=0.0000
    Epoch  5/10: total=1.8676, vae=1.0884, dsb=0.7792, bio=0.0000
    Epoch  6/10: total=1.8743, vae=1.0883, dsb=0.7860, bio=0.0000
    Epoch  7/10: total=1.8630, vae=1.0892, dsb=0.7738, bio=0.0000
    Epoch  8/10: total=1.8714, vae=1.0887, dsb=0.7827, bio=0.0000
    Epoch  9/10: total=1.8760, vae=1.0881, dsb=0.7880, bio=0.0000
    Epoch 10/10: total=1.8737, vae=1.0878, dsb=0.7860, bio=0.0000

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=38.2595, vae=1.0885, dsb=37.1710, bio=0.0000
    Epoch  2/10: total=36.4906, vae=1.0885, dsb=35.4021, bio=0.0000
    Epoch  3/10: total=35.8773, vae=1.0885, dsb=34.7889, bio=0.0000
    Epoch  4/10: total=35.6123, vae=1.0880, dsb=34.5243, bio=0.0000
    Epoch  5/10: total=35.5729, vae=1.0893, dsb=34.4836, bio=0.0000
    Epoch  6/10: total=35.3982, vae=1.0890, dsb=34.3092, bio=0.0000
    Epoch  7/10: total=35.3208, vae=1.0881, dsb=34.2327, bio=0.0000
    Epoch  8/10: total=35.2360, vae=1.0898, dsb=34.1462, bio=0.0000
    Epoch  9/10: total=35.1785, vae=1.0883, dsb=34.0903, bio=0.0000
    Epoch 10/10: total=35.0816, vae=1.0884, dsb=33.9932, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.7754, vae=1.0880, dsb=0.6874, bio=0.0000
    Epoch  2/10: total=1.7098, vae=1.0882, dsb=0.6216, bio=0.0000
    Epoch  3/10: total=1.7059, vae=1.0897, dsb=0.6162, bio=0.0000
    Epoch  4/10: total=1.6905, vae=1.0887, dsb=0.6018, bio=0.0000
    Epoch  5/10: total=1.6638, vae=1.0885, dsb=0.5752, bio=0.0000
    Epoch  6/10: total=1.6892, vae=1.0889, dsb=0.6004, bio=0.0000
    Epoch  7/10: total=1.6772, vae=1.0883, dsb=0.5889, bio=0.0000
    Epoch  8/10: total=1.6885, vae=1.0882, dsb=0.6003, bio=0.0000
    Epoch  9/10: total=1.6591, vae=1.0882, dsb=0.5709, bio=0.0000
    Epoch 10/10: total=1.6672, vae=1.0875, dsb=0.5797, bio=0.0000

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=32.0222, vae=1.0886, dsb=30.9336, bio=0.0000
    Epoch  2/10: total=31.2586, vae=1.0885, dsb=30.1700, bio=0.0000
    Epoch  3/10: total=30.9124, vae=1.0883, dsb=29.8241, bio=0.0000
    Epoch  4/10: total=30.8825, vae=1.0879, dsb=29.7947, bio=0.0000
    Epoch  5/10: total=30.8420, vae=1.0878, dsb=29.7543, bio=0.0000
    Epoch  6/10: total=30.8867, vae=1.0879, dsb=29.7988, bio=0.0000
    Epoch  7/10: total=30.6563, vae=1.0876, dsb=29.5687, bio=0.0000
    Epoch  8/10: total=30.7504, vae=1.0879, dsb=29.6625, bio=0.0000
    Epoch  9/10: total=30.8152, vae=1.0884, dsb=29.7268, bio=0.0000
    Epoch 10/10: total=30.6739, vae=1.0879, dsb=29.5859, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.6071, vae=1.0887, dsb=0.5185, bio=0.0000
    Epoch  2/10: total=1.5860, vae=1.0885, dsb=0.4975, bio=0.0000
    Epoch  3/10: total=1.6009, vae=1.0888, dsb=0.5121, bio=0.0000
    Epoch  4/10: total=1.5798, vae=1.0880, dsb=0.4918, bio=0.0000
    Epoch  5/10: total=1.5948, vae=1.0887, dsb=0.5062, bio=0.0000
    Epoch  6/10: total=1.5697, vae=1.0881, dsb=0.4817, bio=0.0000
    Epoch  7/10: total=1.5722, vae=1.0882, dsb=0.4839, bio=0.0000
    Epoch  8/10: total=1.5770, vae=1.0886, dsb=0.4884, bio=0.0000
    Epoch  9/10: total=1.5718, vae=1.0886, dsb=0.4832, bio=0.0000
    Epoch 10/10: total=1.5803, vae=1.0884, dsb=0.4919, bio=0.0000

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=27.8746, vae=1.0880, dsb=26.7866, bio=0.0000
    Epoch  2/10: total=27.6731, vae=1.0885, dsb=26.5846, bio=0.0000
    Epoch  3/10: total=27.4543, vae=1.0889, dsb=26.3653, bio=0.0000
    Epoch  4/10: total=27.3810, vae=1.0884, dsb=26.2927, bio=0.0000
    Epoch  5/10: total=27.6642, vae=1.0885, dsb=26.5758, bio=0.0000
    Epoch  6/10: total=27.5541, vae=1.0886, dsb=26.4655, bio=0.0000
    Epoch  7/10: total=27.3529, vae=1.0885, dsb=26.2644, bio=0.0000
    Epoch  8/10: total=27.3976, vae=1.0882, dsb=26.3094, bio=0.0000
    Epoch  9/10: total=27.5993, vae=1.0873, dsb=26.5121, bio=0.0000
    Epoch 10/10: total=27.5062, vae=1.0878, dsb=26.4184, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.5177, vae=1.0885, dsb=0.4292, bio=0.0000
    Epoch  2/10: total=1.5163, vae=1.0882, dsb=0.4281, bio=0.0000
    Epoch  3/10: total=1.5227, vae=1.0883, dsb=0.4344, bio=0.0000
    Epoch  4/10: total=1.5084, vae=1.0883, dsb=0.4201, bio=0.0000
    Epoch  5/10: total=1.5130, vae=1.0884, dsb=0.4246, bio=0.0000
    Epoch  6/10: total=1.5122, vae=1.0878, dsb=0.4244, bio=0.0000
    Epoch  7/10: total=1.5112, vae=1.0886, dsb=0.4226, bio=0.0000
    Epoch  8/10: total=1.5165, vae=1.0884, dsb=0.4281, bio=0.0000
    Epoch  9/10: total=1.5190, vae=1.0883, dsb=0.4307, bio=0.0000
    Epoch 10/10: total=1.5072, vae=1.0893, dsb=0.4179, bio=0.0000

[Seed 46] Joint training (ablation) complete; models and history saved.

[Seed 46] Drift genes saved in /home/yyuan/ICB_TCE/iter_results/run_046

[Seed 46] run finished.

================================================================================
[Seed 47] Starting running whole pipeline...
================================================================================

[Seed 47] Starting VAE pre-training...

    Epoch [01/20], Beta: 0.000, Average Loss: 534.9263
    Epoch [02/20], Beta: 0.000, Average Loss: 310.2899
    Epoch [03/20], Beta: 0.000, Average Loss: 271.6891
    Epoch [04/20], Beta: 0.000, Average Loss: 250.7532
    Epoch [05/20], Beta: 0.100, Average Loss: 246.2651
    Epoch [06/20], Beta: 0.200, Average Loss: 245.5256
    Epoch [07/20], Beta: 0.300, Average Loss: 245.2315
    Epoch [08/20], Beta: 0.400, Average Loss: 245.6475
    Epoch [09/20], Beta: 0.500, Average Loss: 246.5607
    Epoch [10/20], Beta: 0.600, Average Loss: 247.6473
    Epoch [11/20], Beta: 0.700, Average Loss: 248.8954
    Epoch [12/20], Beta: 0.800, Average Loss: 250.1189
    Epoch [13/20], Beta: 0.900, Average Loss: 251.4541
    Epoch [14/20], Beta: 1.000, Average Loss: 252.6918
    Epoch [15/20], Beta: 1.000, Average Loss: 252.2742
    Epoch [16/20], Beta: 1.000, Average Loss: 251.9539
    Epoch [17/20], Beta: 1.000, Average Loss: 251.6829
    Epoch [18/20], Beta: 1.000, Average Loss: 251.3575
    Epoch [19/20], Beta: 1.000, Average Loss: 251.0958
    Epoch [20/20], Beta: 1.000, Average Loss: 250.7618

[Seed 47] VAE pre-training complete.

[Seed 47] Starting joint training (original)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=337.0301, vae=3.5359, dsb=315.5587, bio=35.8709
    Epoch  2/10: total=94.3247, vae=1.1046, dsb=93.1932, bio=0.0539
    Epoch  3/10: total=82.7275, vae=1.1007, dsb=81.6145, bio=0.0245
    Epoch  4/10: total=76.6497, vae=1.0987, dsb=75.5437, bio=0.0147
    Epoch  5/10: total=73.5168, vae=1.0973, dsb=72.4147, bio=0.0096
    Epoch  6/10: total=70.9716, vae=1.0974, dsb=69.8706, bio=0.0072
    Epoch  7/10: total=69.5785, vae=1.0965, dsb=68.4791, bio=0.0057
    Epoch  8/10: total=68.3773, vae=1.0962, dsb=67.2787, bio=0.0047
    Epoch  9/10: total=66.9879, vae=1.0963, dsb=65.8895, bio=0.0042
    Epoch 10/10: total=66.1307, vae=1.0956, dsb=65.0331, bio=0.0040

  [Backward Policy Training]
    Epoch  1/10: total=3.3381, vae=1.0967, dsb=2.2355, bio=0.0118
    Epoch  2/10: total=2.8064, vae=1.0956, dsb=1.7088, bio=0.0041
    Epoch  3/10: total=2.6753, vae=1.0946, dsb=1.5792, bio=0.0031
    Epoch  4/10: total=2.5893, vae=1.0942, dsb=1.4938, bio=0.0026
    Epoch  5/10: total=2.5982, vae=1.0935, dsb=1.5035, bio=0.0024
    Epoch  6/10: total=2.5437, vae=1.0940, dsb=1.4486, bio=0.0022
    Epoch  7/10: total=2.5369, vae=1.0939, dsb=1.4419, bio=0.0021
    Epoch  8/10: total=2.4986, vae=1.0932, dsb=1.4044, bio=0.0021
    Epoch  9/10: total=2.4630, vae=1.0932, dsb=1.3690, bio=0.0017
    Epoch 10/10: total=2.4494, vae=1.0942, dsb=1.3542, bio=0.0021

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=58.4443, vae=1.0961, dsb=57.3463, bio=0.0038
    Epoch  2/10: total=51.7335, vae=1.0947, dsb=50.6378, bio=0.0020
    Epoch  3/10: total=50.2568, vae=1.0946, dsb=49.1613, bio=0.0019
    Epoch  4/10: total=49.1841, vae=1.0940, dsb=48.0892, bio=0.0019
    Epoch  5/10: total=48.6192, vae=1.0950, dsb=47.5231, bio=0.0022
    Epoch  6/10: total=48.2694, vae=1.0943, dsb=47.1742, bio=0.0018
    Epoch  7/10: total=47.8829, vae=1.0935, dsb=46.7884, bio=0.0019
    Epoch  8/10: total=47.6429, vae=1.0938, dsb=46.5482, bio=0.0019
    Epoch  9/10: total=47.1820, vae=1.0942, dsb=46.0868, bio=0.0019
    Epoch 10/10: total=47.1210, vae=1.0937, dsb=46.0263, bio=0.0019

  [Backward Policy Training]
    Epoch  1/10: total=2.2349, vae=1.0944, dsb=1.1378, bio=0.0054
    Epoch  2/10: total=2.0643, vae=1.0929, dsb=0.9704, bio=0.0020
    Epoch  3/10: total=2.0872, vae=1.0930, dsb=0.9933, bio=0.0018
    Epoch  4/10: total=2.0095, vae=1.0924, dsb=0.9162, bio=0.0017
    Epoch  5/10: total=2.0324, vae=1.0922, dsb=0.9392, bio=0.0018
    Epoch  6/10: total=2.0377, vae=1.0912, dsb=0.9457, bio=0.0016
    Epoch  7/10: total=1.9751, vae=1.0919, dsb=0.8825, bio=0.0016
    Epoch  8/10: total=2.0034, vae=1.0928, dsb=0.9098, bio=0.0016
    Epoch  9/10: total=1.9728, vae=1.0915, dsb=0.8804, bio=0.0016
    Epoch 10/10: total=1.9737, vae=1.0920, dsb=0.8810, bio=0.0015

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=44.0418, vae=1.0948, dsb=42.9455, bio=0.0031
    Epoch  2/10: total=41.5952, vae=1.0931, dsb=40.5013, bio=0.0017
    Epoch  3/10: total=40.7685, vae=1.0931, dsb=39.6745, bio=0.0017
    Epoch  4/10: total=40.1804, vae=1.0933, dsb=39.0863, bio=0.0017
    Epoch  5/10: total=40.0593, vae=1.0931, dsb=38.9654, bio=0.0017
    Epoch  6/10: total=40.0852, vae=1.0928, dsb=38.9911, bio=0.0025
    Epoch  7/10: total=39.8787, vae=1.0923, dsb=38.7856, bio=0.0016
    Epoch  8/10: total=39.6467, vae=1.0924, dsb=38.5535, bio=0.0016
    Epoch  9/10: total=39.5342, vae=1.0925, dsb=38.4408, bio=0.0017
    Epoch 10/10: total=39.6866, vae=1.0925, dsb=38.5932, bio=0.0017

  [Backward Policy Training]
    Epoch  1/10: total=1.8691, vae=1.0926, dsb=0.7729, bio=0.0073
    Epoch  2/10: total=1.8170, vae=1.0913, dsb=0.7249, bio=0.0016
    Epoch  3/10: total=1.8065, vae=1.0919, dsb=0.7138, bio=0.0016
    Epoch  4/10: total=1.7987, vae=1.0916, dsb=0.7064, bio=0.0014
    Epoch  5/10: total=1.7952, vae=1.0922, dsb=0.7023, bio=0.0015
    Epoch  6/10: total=1.7749, vae=1.0917, dsb=0.6825, bio=0.0014
    Epoch  7/10: total=1.7661, vae=1.0913, dsb=0.6741, bio=0.0014
    Epoch  8/10: total=1.7849, vae=1.0915, dsb=0.6927, bio=0.0014
    Epoch  9/10: total=1.7540, vae=1.0923, dsb=0.6610, bio=0.0014
    Epoch 10/10: total=1.7674, vae=1.0922, dsb=0.6745, bio=0.0014

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=34.5099, vae=1.0939, dsb=33.4146, bio=0.0029
    Epoch  2/10: total=33.7051, vae=1.0942, dsb=32.6102, bio=0.0014
    Epoch  3/10: total=33.5151, vae=1.0922, dsb=32.4221, bio=0.0015
    Epoch  4/10: total=33.5062, vae=1.0930, dsb=32.4124, bio=0.0015
    Epoch  5/10: total=33.1564, vae=1.0924, dsb=32.0633, bio=0.0014
    Epoch  6/10: total=33.1500, vae=1.0929, dsb=32.0561, bio=0.0018
    Epoch  7/10: total=33.1770, vae=1.0923, dsb=32.0839, bio=0.0015
    Epoch  8/10: total=33.0537, vae=1.0923, dsb=31.9607, bio=0.0015
    Epoch  9/10: total=33.1392, vae=1.0921, dsb=32.0464, bio=0.0015
    Epoch 10/10: total=33.0252, vae=1.0929, dsb=31.9316, bio=0.0015

  [Backward Policy Training]
    Epoch  1/10: total=1.6830, vae=1.0925, dsb=0.5815, bio=0.0180
    Epoch  2/10: total=1.6602, vae=1.0911, dsb=0.5684, bio=0.0014
    Epoch  3/10: total=1.6562, vae=1.0915, dsb=0.5641, bio=0.0013
    Epoch  4/10: total=1.6397, vae=1.0913, dsb=0.5477, bio=0.0014
    Epoch  5/10: total=1.6399, vae=1.0909, dsb=0.5483, bio=0.0012
    Epoch  6/10: total=1.6504, vae=1.0917, dsb=0.5581, bio=0.0012
    Epoch  7/10: total=1.6499, vae=1.0917, dsb=0.5577, bio=0.0012
    Epoch  8/10: total=1.6379, vae=1.0914, dsb=0.5459, bio=0.0012
    Epoch  9/10: total=1.6305, vae=1.0913, dsb=0.5387, bio=0.0011
    Epoch 10/10: total=1.6317, vae=1.0915, dsb=0.5397, bio=0.0012

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=30.5358, vae=1.0935, dsb=29.4410, bio=0.0024
    Epoch  2/10: total=30.2890, vae=1.0929, dsb=29.1955, bio=0.0012
    Epoch  3/10: total=30.4674, vae=1.0919, dsb=29.3748, bio=0.0014
    Epoch  4/10: total=30.2492, vae=1.0925, dsb=29.1560, bio=0.0014
    Epoch  5/10: total=30.1788, vae=1.0924, dsb=29.0857, bio=0.0013
    Epoch  6/10: total=30.1003, vae=1.0926, dsb=29.0071, bio=0.0013
    Epoch  7/10: total=30.0497, vae=1.0911, dsb=28.9580, bio=0.0013
    Epoch  8/10: total=30.2395, vae=1.0914, dsb=29.1475, bio=0.0013
    Epoch  9/10: total=30.0806, vae=1.0913, dsb=28.9887, bio=0.0012
    Epoch 10/10: total=30.1589, vae=1.0917, dsb=29.0666, bio=0.0012

  [Backward Policy Training]
    Epoch  1/10: total=1.6307, vae=1.0924, dsb=0.4822, bio=0.1122
    Epoch  2/10: total=1.5825, vae=1.0909, dsb=0.4909, bio=0.0013
    Epoch  3/10: total=1.5641, vae=1.0918, dsb=0.4717, bio=0.0012
    Epoch  4/10: total=1.5581, vae=1.0915, dsb=0.4659, bio=0.0013
    Epoch  5/10: total=1.5673, vae=1.0917, dsb=0.4750, bio=0.0011
    Epoch  6/10: total=1.5783, vae=1.0908, dsb=0.4870, bio=0.0010
    Epoch  7/10: total=1.5805, vae=1.0911, dsb=0.4889, bio=0.0010
    Epoch  8/10: total=1.5674, vae=1.0914, dsb=0.4755, bio=0.0010
    Epoch  9/10: total=1.5656, vae=1.0907, dsb=0.4743, bio=0.0010
    Epoch 10/10: total=1.5699, vae=1.0920, dsb=0.4773, bio=0.0013

[Seed 47] Joint training (original) complete; models and history saved.

[Seed 47] Starting joint training (ablation)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=317.0551, vae=2.0049, dsb=315.0502, bio=0.0000
    Epoch  2/10: total=93.5093, vae=1.0875, dsb=92.4218, bio=0.0000
    Epoch  3/10: total=81.9338, vae=1.0864, dsb=80.8474, bio=0.0000
    Epoch  4/10: total=75.9498, vae=1.0854, dsb=74.8645, bio=0.0000
    Epoch  5/10: total=72.8443, vae=1.0844, dsb=71.7599, bio=0.0000
    Epoch  6/10: total=70.2341, vae=1.0848, dsb=69.1494, bio=0.0000
    Epoch  7/10: total=68.8004, vae=1.0842, dsb=67.7162, bio=0.0000
    Epoch  8/10: total=67.5500, vae=1.0841, dsb=66.4659, bio=0.0000
    Epoch  9/10: total=66.1450, vae=1.0844, dsb=65.0605, bio=0.0000
    Epoch 10/10: total=65.2980, vae=1.0839, dsb=64.2142, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=3.2202, vae=1.0844, dsb=2.1358, bio=0.0000
    Epoch  2/10: total=2.7220, vae=1.0847, dsb=1.6373, bio=0.0000
    Epoch  3/10: total=2.5969, vae=1.0841, dsb=1.5128, bio=0.0000
    Epoch  4/10: total=2.5143, vae=1.0840, dsb=1.4303, bio=0.0000
    Epoch  5/10: total=2.5256, vae=1.0834, dsb=1.4421, bio=0.0000
    Epoch  6/10: total=2.4732, vae=1.0841, dsb=1.3891, bio=0.0000
    Epoch  7/10: total=2.4684, vae=1.0843, dsb=1.3841, bio=0.0000
    Epoch  8/10: total=2.4323, vae=1.0836, dsb=1.3487, bio=0.0000
    Epoch  9/10: total=2.3985, vae=1.0836, dsb=1.3149, bio=0.0000
    Epoch 10/10: total=2.3868, vae=1.0848, dsb=1.3020, bio=0.0000

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=58.2040, vae=1.0834, dsb=57.1207, bio=0.0000
    Epoch  2/10: total=51.7178, vae=1.0837, dsb=50.6341, bio=0.0000
    Epoch  3/10: total=50.4083, vae=1.0838, dsb=49.3245, bio=0.0000
    Epoch  4/10: total=49.3612, vae=1.0834, dsb=48.2778, bio=0.0000
    Epoch  5/10: total=48.8834, vae=1.0844, dsb=47.7990, bio=0.0000
    Epoch  6/10: total=48.5367, vae=1.0839, dsb=47.4528, bio=0.0000
    Epoch  7/10: total=48.1892, vae=1.0833, dsb=47.1059, bio=0.0000
    Epoch  8/10: total=48.0213, vae=1.0836, dsb=46.9377, bio=0.0000
    Epoch  9/10: total=47.5611, vae=1.0841, dsb=46.4770, bio=0.0000
    Epoch 10/10: total=47.4719, vae=1.0837, dsb=46.3883, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=2.1724, vae=1.0837, dsb=1.0888, bio=0.0000
    Epoch  2/10: total=2.0097, vae=1.0838, dsb=0.9259, bio=0.0000
    Epoch  3/10: total=2.0324, vae=1.0841, dsb=0.9483, bio=0.0000
    Epoch  4/10: total=1.9575, vae=1.0836, dsb=0.8739, bio=0.0000
    Epoch  5/10: total=1.9795, vae=1.0834, dsb=0.8961, bio=0.0000
    Epoch  6/10: total=1.9848, vae=1.0825, dsb=0.9023, bio=0.0000
    Epoch  7/10: total=1.9239, vae=1.0832, dsb=0.8408, bio=0.0000
    Epoch  8/10: total=1.9515, vae=1.0842, dsb=0.8673, bio=0.0000
    Epoch  9/10: total=1.9216, vae=1.0829, dsb=0.8387, bio=0.0000
    Epoch 10/10: total=1.9223, vae=1.0834, dsb=0.8390, bio=0.0000

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=44.5944, vae=1.0834, dsb=43.5110, bio=0.0000
    Epoch  2/10: total=42.2416, vae=1.0831, dsb=41.1585, bio=0.0000
    Epoch  3/10: total=41.4483, vae=1.0833, dsb=40.3649, bio=0.0000
    Epoch  4/10: total=40.8065, vae=1.0836, dsb=39.7229, bio=0.0000
    Epoch  5/10: total=40.7552, vae=1.0835, dsb=39.6718, bio=0.0000
    Epoch  6/10: total=40.7959, vae=1.0832, dsb=39.7126, bio=0.0000
    Epoch  7/10: total=40.5979, vae=1.0829, dsb=39.5150, bio=0.0000
    Epoch  8/10: total=40.3618, vae=1.0830, dsb=39.2788, bio=0.0000
    Epoch  9/10: total=40.2635, vae=1.0832, dsb=39.1804, bio=0.0000
    Epoch 10/10: total=40.4519, vae=1.0832, dsb=39.3687, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.8117, vae=1.0831, dsb=0.7286, bio=0.0000
    Epoch  2/10: total=1.7651, vae=1.0829, dsb=0.6822, bio=0.0000
    Epoch  3/10: total=1.7552, vae=1.0834, dsb=0.6718, bio=0.0000
    Epoch  4/10: total=1.7472, vae=1.0832, dsb=0.6639, bio=0.0000
    Epoch  5/10: total=1.7449, vae=1.0840, dsb=0.6609, bio=0.0000
    Epoch  6/10: total=1.7259, vae=1.0836, dsb=0.6423, bio=0.0000
    Epoch  7/10: total=1.7175, vae=1.0831, dsb=0.6344, bio=0.0000
    Epoch  8/10: total=1.7368, vae=1.0834, dsb=0.6534, bio=0.0000
    Epoch  9/10: total=1.7064, vae=1.0840, dsb=0.6224, bio=0.0000
    Epoch 10/10: total=1.7205, vae=1.0841, dsb=0.6364, bio=0.0000

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=35.7736, vae=1.0830, dsb=34.6906, bio=0.0000
    Epoch  2/10: total=34.9665, vae=1.0847, dsb=33.8819, bio=0.0000
    Epoch  3/10: total=34.7295, vae=1.0830, dsb=33.6466, bio=0.0000
    Epoch  4/10: total=34.7577, vae=1.0839, dsb=33.6739, bio=0.0000
    Epoch  5/10: total=34.3927, vae=1.0833, dsb=33.3094, bio=0.0000
    Epoch  6/10: total=34.3834, vae=1.0839, dsb=33.2995, bio=0.0000
    Epoch  7/10: total=34.4299, vae=1.0834, dsb=33.3465, bio=0.0000
    Epoch  8/10: total=34.2973, vae=1.0835, dsb=33.2138, bio=0.0000
    Epoch  9/10: total=34.3341, vae=1.0834, dsb=33.2507, bio=0.0000
    Epoch 10/10: total=34.2621, vae=1.0842, dsb=33.1779, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.6417, vae=1.0835, dsb=0.5581, bio=0.0000
    Epoch  2/10: total=1.6271, vae=1.0830, dsb=0.5442, bio=0.0000
    Epoch  3/10: total=1.6226, vae=1.0834, dsb=0.5392, bio=0.0000
    Epoch  4/10: total=1.6059, vae=1.0833, dsb=0.5226, bio=0.0000
    Epoch  5/10: total=1.6062, vae=1.0830, dsb=0.5232, bio=0.0000
    Epoch  6/10: total=1.6161, vae=1.0838, dsb=0.5323, bio=0.0000
    Epoch  7/10: total=1.6157, vae=1.0838, dsb=0.5319, bio=0.0000
    Epoch  8/10: total=1.6030, vae=1.0835, dsb=0.5195, bio=0.0000
    Epoch  9/10: total=1.5956, vae=1.0834, dsb=0.5123, bio=0.0000
    Epoch 10/10: total=1.5965, vae=1.0836, dsb=0.5128, bio=0.0000

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=31.9887, vae=1.0830, dsb=30.9057, bio=0.0000
    Epoch  2/10: total=31.7037, vae=1.0839, dsb=30.6198, bio=0.0000
    Epoch  3/10: total=31.9101, vae=1.0831, dsb=30.8270, bio=0.0000
    Epoch  4/10: total=31.6680, vae=1.0839, dsb=30.5841, bio=0.0000
    Epoch  5/10: total=31.5636, vae=1.0840, dsb=30.4796, bio=0.0000
    Epoch  6/10: total=31.4820, vae=1.0843, dsb=30.3977, bio=0.0000
    Epoch  7/10: total=31.4430, vae=1.0828, dsb=30.3602, bio=0.0000
    Epoch  8/10: total=31.6715, vae=1.0832, dsb=30.5883, bio=0.0000
    Epoch  9/10: total=31.4636, vae=1.0833, dsb=30.3803, bio=0.0000
    Epoch 10/10: total=31.5424, vae=1.0838, dsb=30.4587, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.5367, vae=1.0835, dsb=0.4532, bio=0.0000
    Epoch  2/10: total=1.5440, vae=1.0829, dsb=0.4611, bio=0.0000
    Epoch  3/10: total=1.5263, vae=1.0840, dsb=0.4424, bio=0.0000
    Epoch  4/10: total=1.5200, vae=1.0836, dsb=0.4364, bio=0.0000
    Epoch  5/10: total=1.5295, vae=1.0840, dsb=0.4455, bio=0.0000
    Epoch  6/10: total=1.5403, vae=1.0831, dsb=0.4572, bio=0.0000
    Epoch  7/10: total=1.5424, vae=1.0834, dsb=0.4590, bio=0.0000
    Epoch  8/10: total=1.5294, vae=1.0838, dsb=0.4457, bio=0.0000
    Epoch  9/10: total=1.5274, vae=1.0831, dsb=0.4443, bio=0.0000
    Epoch 10/10: total=1.5316, vae=1.0843, dsb=0.4473, bio=0.0000

[Seed 47] Joint training (ablation) complete; models and history saved.

[Seed 47] Drift genes saved in /home/yyuan/ICB_TCE/iter_results/run_047

[Seed 47] run finished.

================================================================================
[Seed 48] Starting running whole pipeline...
================================================================================

[Seed 48] Starting VAE pre-training...

    Epoch [01/20], Beta: 0.000, Average Loss: 536.5891
    Epoch [02/20], Beta: 0.000, Average Loss: 306.4208
    Epoch [03/20], Beta: 0.000, Average Loss: 270.7234
    Epoch [04/20], Beta: 0.000, Average Loss: 251.6147
    Epoch [05/20], Beta: 0.100, Average Loss: 245.9545
    Epoch [06/20], Beta: 0.200, Average Loss: 244.6546
    Epoch [07/20], Beta: 0.300, Average Loss: 244.7549
    Epoch [08/20], Beta: 0.400, Average Loss: 245.5896
    Epoch [09/20], Beta: 0.500, Average Loss: 246.7343
    Epoch [10/20], Beta: 0.600, Average Loss: 247.9939
    Epoch [11/20], Beta: 0.700, Average Loss: 249.2206
    Epoch [12/20], Beta: 0.800, Average Loss: 250.5305
    Epoch [13/20], Beta: 0.900, Average Loss: 251.7672
    Epoch [14/20], Beta: 1.000, Average Loss: 253.3750
    Epoch [15/20], Beta: 1.000, Average Loss: 252.9530
    Epoch [16/20], Beta: 1.000, Average Loss: 252.6098
    Epoch [17/20], Beta: 1.000, Average Loss: 252.2101
    Epoch [18/20], Beta: 1.000, Average Loss: 251.8741
    Epoch [19/20], Beta: 1.000, Average Loss: 251.5386
    Epoch [20/20], Beta: 1.000, Average Loss: 251.3882

[Seed 48] VAE pre-training complete.

[Seed 48] Starting joint training (original)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=339.1787, vae=3.4108, dsb=319.0083, bio=33.5191
    Epoch  2/10: total=112.3616, vae=1.0982, dsb=111.2295, bio=0.0678
    Epoch  3/10: total=103.3881, vae=1.0931, dsb=102.2794, bio=0.0313
    Epoch  4/10: total=99.6557, vae=1.0910, dsb=98.5555, bio=0.0185
    Epoch  5/10: total=96.9147, vae=1.0905, dsb=95.8177, bio=0.0129
    Epoch  6/10: total=96.1598, vae=1.0892, dsb=95.0659, bio=0.0093
    Epoch  7/10: total=94.5800, vae=1.0886, dsb=93.4874, bio=0.0077
    Epoch  8/10: total=93.7096, vae=1.0892, dsb=92.6173, bio=0.0064
    Epoch  9/10: total=93.3582, vae=1.0890, dsb=92.2666, bio=0.0053
    Epoch 10/10: total=92.5841, vae=1.0872, dsb=91.4945, bio=0.0048

  [Backward Policy Training]
    Epoch  1/10: total=3.1186, vae=1.0887, dsb=2.0204, bio=0.0190
    Epoch  2/10: total=2.7617, vae=1.0879, dsb=1.6708, bio=0.0060
    Epoch  3/10: total=2.6120, vae=1.0869, dsb=1.5230, bio=0.0041
    Epoch  4/10: total=2.6086, vae=1.0868, dsb=1.5201, bio=0.0033
    Epoch  5/10: total=2.5318, vae=1.0868, dsb=1.4435, bio=0.0029
    Epoch  6/10: total=2.4957, vae=1.0878, dsb=1.4067, bio=0.0026
    Epoch  7/10: total=2.4928, vae=1.0855, dsb=1.4058, bio=0.0030
    Epoch  8/10: total=2.4856, vae=1.0856, dsb=1.3989, bio=0.0023
    Epoch  9/10: total=2.4679, vae=1.0857, dsb=1.3812, bio=0.0022
    Epoch 10/10: total=2.4575, vae=1.0852, dsb=1.3713, bio=0.0021

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=76.5120, vae=1.0883, dsb=75.4217, bio=0.0041
    Epoch  2/10: total=72.3322, vae=1.0877, dsb=71.2435, bio=0.0021
    Epoch  3/10: total=71.4305, vae=1.0871, dsb=70.3424, bio=0.0020
    Epoch  4/10: total=71.4303, vae=1.0864, dsb=70.3429, bio=0.0021
    Epoch  5/10: total=70.7940, vae=1.0869, dsb=69.7059, bio=0.0023
    Epoch  6/10: total=70.3065, vae=1.0865, dsb=69.2191, bio=0.0020
    Epoch  7/10: total=70.5306, vae=1.0861, dsb=69.4436, bio=0.0019
    Epoch  8/10: total=69.6987, vae=1.0858, dsb=68.6119, bio=0.0019
    Epoch  9/10: total=69.6174, vae=1.0856, dsb=68.5308, bio=0.0020
    Epoch 10/10: total=69.3839, vae=1.0865, dsb=68.2964, bio=0.0019

  [Backward Policy Training]
    Epoch  1/10: total=2.1600, vae=1.0873, dsb=1.0698, bio=0.0057
    Epoch  2/10: total=2.0476, vae=1.0849, dsb=0.9617, bio=0.0020
    Epoch  3/10: total=2.0181, vae=1.0844, dsb=0.9328, bio=0.0018
    Epoch  4/10: total=2.0118, vae=1.0849, dsb=0.9259, bio=0.0019
    Epoch  5/10: total=1.9790, vae=1.0848, dsb=0.8933, bio=0.0017
    Epoch  6/10: total=1.9863, vae=1.0851, dsb=0.9003, bio=0.0017
    Epoch  7/10: total=1.9964, vae=1.0849, dsb=0.9106, bio=0.0017
    Epoch  8/10: total=1.9555, vae=1.0844, dsb=0.8703, bio=0.0016
    Epoch  9/10: total=1.9824, vae=1.0858, dsb=0.8958, bio=0.0017
    Epoch 10/10: total=1.9554, vae=1.0846, dsb=0.8700, bio=0.0016

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=62.9631, vae=1.0882, dsb=61.8726, bio=0.0046
    Epoch  2/10: total=61.1509, vae=1.0871, dsb=60.0629, bio=0.0018
    Epoch  3/10: total=60.9167, vae=1.0852, dsb=59.8306, bio=0.0017
    Epoch  4/10: total=60.7215, vae=1.0855, dsb=59.6351, bio=0.0017
    Epoch  5/10: total=60.5491, vae=1.0856, dsb=59.4625, bio=0.0020
    Epoch  6/10: total=60.4349, vae=1.0846, dsb=59.3495, bio=0.0017
    Epoch  7/10: total=60.4112, vae=1.0849, dsb=59.3255, bio=0.0017
    Epoch  8/10: total=60.3322, vae=1.0851, dsb=59.2463, bio=0.0017
    Epoch  9/10: total=60.1290, vae=1.0851, dsb=59.0431, bio=0.0015
    Epoch 10/10: total=59.9846, vae=1.0850, dsb=58.8987, bio=0.0018

  [Backward Policy Training]
    Epoch  1/10: total=1.8727, vae=1.0852, dsb=0.7845, bio=0.0060
    Epoch  2/10: total=1.8075, vae=1.0854, dsb=0.7212, bio=0.0017
    Epoch  3/10: total=1.8020, vae=1.0845, dsb=0.7167, bio=0.0016
    Epoch  4/10: total=1.7961, vae=1.0845, dsb=0.7108, bio=0.0016
    Epoch  5/10: total=1.7740, vae=1.0839, dsb=0.6891, bio=0.0018
    Epoch  6/10: total=1.7646, vae=1.0838, dsb=0.6801, bio=0.0015
    Epoch  7/10: total=1.7768, vae=1.0846, dsb=0.6915, bio=0.0014
    Epoch  8/10: total=1.7549, vae=1.0837, dsb=0.6705, bio=0.0014
    Epoch  9/10: total=1.7627, vae=1.0842, dsb=0.6777, bio=0.0015
    Epoch 10/10: total=1.7579, vae=1.0845, dsb=0.6726, bio=0.0015

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=52.3384, vae=1.0871, dsb=51.2497, bio=0.0031
    Epoch  2/10: total=51.8283, vae=1.0853, dsb=50.7423, bio=0.0016
    Epoch  3/10: total=51.6593, vae=1.0848, dsb=50.5738, bio=0.0017
    Epoch  4/10: total=51.4848, vae=1.0847, dsb=50.3992, bio=0.0018
    Epoch  5/10: total=51.5774, vae=1.0849, dsb=50.4918, bio=0.0016
    Epoch  6/10: total=51.6229, vae=1.0848, dsb=50.5373, bio=0.0015
    Epoch  7/10: total=51.5751, vae=1.0843, dsb=50.4901, bio=0.0015
    Epoch  8/10: total=51.4159, vae=1.0846, dsb=50.3306, bio=0.0016
    Epoch  9/10: total=51.4029, vae=1.0851, dsb=50.3170, bio=0.0016
    Epoch 10/10: total=51.3456, vae=1.0853, dsb=50.2596, bio=0.0015

  [Backward Policy Training]
    Epoch  1/10: total=1.7166, vae=1.0851, dsb=0.6210, bio=0.0208
    Epoch  2/10: total=1.6580, vae=1.0843, dsb=0.5729, bio=0.0015
    Epoch  3/10: total=1.6588, vae=1.0845, dsb=0.5737, bio=0.0014
    Epoch  4/10: total=1.6494, vae=1.0839, dsb=0.5648, bio=0.0015
    Epoch  5/10: total=1.6592, vae=1.0845, dsb=0.5738, bio=0.0017
    Epoch  6/10: total=1.6616, vae=1.0835, dsb=0.5775, bio=0.0013
    Epoch  7/10: total=1.6355, vae=1.0830, dsb=0.5519, bio=0.0013
    Epoch  8/10: total=1.6580, vae=1.0833, dsb=0.5741, bio=0.0013
    Epoch  9/10: total=1.6508, vae=1.0834, dsb=0.5667, bio=0.0013
    Epoch 10/10: total=1.6480, vae=1.0831, dsb=0.5643, bio=0.0012

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=47.7762, vae=1.0865, dsb=46.6882, bio=0.0029
    Epoch  2/10: total=47.5251, vae=1.0851, dsb=46.4393, bio=0.0015
    Epoch  3/10: total=47.6319, vae=1.0854, dsb=46.5458, bio=0.0015
    Epoch  4/10: total=47.3886, vae=1.0841, dsb=46.3038, bio=0.0014
    Epoch  5/10: total=47.6494, vae=1.0844, dsb=46.5642, bio=0.0014
    Epoch  6/10: total=47.4657, vae=1.0846, dsb=46.3804, bio=0.0014
    Epoch  7/10: total=47.2027, vae=1.0837, dsb=46.1182, bio=0.0015
    Epoch  8/10: total=47.4739, vae=1.0836, dsb=46.3898, bio=0.0012
    Epoch  9/10: total=47.2940, vae=1.0841, dsb=46.2093, bio=0.0014
    Epoch 10/10: total=47.4054, vae=1.0840, dsb=46.3208, bio=0.0013

  [Backward Policy Training]
    Epoch  1/10: total=1.6562, vae=1.0841, dsb=0.5364, bio=0.0713
    Epoch  2/10: total=1.5947, vae=1.0836, dsb=0.5104, bio=0.0013
    Epoch  3/10: total=1.5930, vae=1.0839, dsb=0.5085, bio=0.0012
    Epoch  4/10: total=1.5885, vae=1.0838, dsb=0.5040, bio=0.0014
    Epoch  5/10: total=1.5774, vae=1.0832, dsb=0.4937, bio=0.0011
    Epoch  6/10: total=1.5803, vae=1.0828, dsb=0.4969, bio=0.0011
    Epoch  7/10: total=1.5698, vae=1.0844, dsb=0.4849, bio=0.0011
    Epoch  8/10: total=1.5800, vae=1.0843, dsb=0.4951, bio=0.0012
    Epoch  9/10: total=1.5759, vae=1.0837, dsb=0.4917, bio=0.0011
    Epoch 10/10: total=1.5808, vae=1.0829, dsb=0.4974, bio=0.0010

[Seed 48] Joint training (original) complete; models and history saved.

[Seed 48] Starting joint training (ablation)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=319.9825, vae=1.9913, dsb=317.9912, bio=0.0000
    Epoch  2/10: total=111.3801, vae=1.0802, dsb=110.2999, bio=0.0000
    Epoch  3/10: total=102.7689, vae=1.0789, dsb=101.6900, bio=0.0000
    Epoch  4/10: total=99.2980, vae=1.0779, dsb=98.2201, bio=0.0000
    Epoch  5/10: total=96.6660, vae=1.0779, dsb=95.5881, bio=0.0000
    Epoch  6/10: total=95.8826, vae=1.0767, dsb=94.8059, bio=0.0000
    Epoch  7/10: total=94.2597, vae=1.0765, dsb=93.1833, bio=0.0000
    Epoch  8/10: total=93.4220, vae=1.0772, dsb=92.3448, bio=0.0000
    Epoch  9/10: total=93.0902, vae=1.0774, dsb=92.0128, bio=0.0000
    Epoch 10/10: total=92.3522, vae=1.0758, dsb=91.2763, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=2.9967, vae=1.0761, dsb=1.9207, bio=0.0000
    Epoch  2/10: total=2.6553, vae=1.0770, dsb=1.5782, bio=0.0000
    Epoch  3/10: total=2.5134, vae=1.0765, dsb=1.4370, bio=0.0000
    Epoch  4/10: total=2.5117, vae=1.0767, dsb=1.4351, bio=0.0000
    Epoch  5/10: total=2.4385, vae=1.0769, dsb=1.3616, bio=0.0000
    Epoch  6/10: total=2.4040, vae=1.0780, dsb=1.3260, bio=0.0000
    Epoch  7/10: total=2.4012, vae=1.0759, dsb=1.3254, bio=0.0000
    Epoch  8/10: total=2.3950, vae=1.0760, dsb=1.3189, bio=0.0000
    Epoch  9/10: total=2.3801, vae=1.0763, dsb=1.3038, bio=0.0000
    Epoch 10/10: total=2.3711, vae=1.0759, dsb=1.2953, bio=0.0000

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=74.4871, vae=1.0762, dsb=73.4109, bio=0.0000
    Epoch  2/10: total=70.5968, vae=1.0769, dsb=69.5199, bio=0.0000
    Epoch  3/10: total=69.8509, vae=1.0764, dsb=68.7745, bio=0.0000
    Epoch  4/10: total=69.7929, vae=1.0759, dsb=68.7170, bio=0.0000
    Epoch  5/10: total=69.1600, vae=1.0765, dsb=68.0835, bio=0.0000
    Epoch  6/10: total=68.7261, vae=1.0763, dsb=67.6499, bio=0.0000
    Epoch  7/10: total=68.9769, vae=1.0759, dsb=67.9010, bio=0.0000
    Epoch  8/10: total=68.1767, vae=1.0757, dsb=67.1010, bio=0.0000
    Epoch  9/10: total=68.0834, vae=1.0756, dsb=67.0078, bio=0.0000
    Epoch 10/10: total=67.8692, vae=1.0765, dsb=66.7927, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=2.0697, vae=1.0767, dsb=0.9930, bio=0.0000
    Epoch  2/10: total=1.9673, vae=1.0759, dsb=0.8914, bio=0.0000
    Epoch  3/10: total=1.9405, vae=1.0756, dsb=0.8650, bio=0.0000
    Epoch  4/10: total=1.9342, vae=1.0762, dsb=0.8580, bio=0.0000
    Epoch  5/10: total=1.9044, vae=1.0761, dsb=0.8282, bio=0.0000
    Epoch  6/10: total=1.9119, vae=1.0765, dsb=0.8353, bio=0.0000
    Epoch  7/10: total=1.9212, vae=1.0764, dsb=0.8448, bio=0.0000
    Epoch  8/10: total=1.8829, vae=1.0758, dsb=0.8071, bio=0.0000
    Epoch  9/10: total=1.9072, vae=1.0773, dsb=0.8300, bio=0.0000
    Epoch 10/10: total=1.8819, vae=1.0761, dsb=0.8058, bio=0.0000

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=63.2037, vae=1.0760, dsb=62.1277, bio=0.0000
    Epoch  2/10: total=61.5969, vae=1.0770, dsb=60.5198, bio=0.0000
    Epoch  3/10: total=61.3999, vae=1.0755, dsb=60.3245, bio=0.0000
    Epoch  4/10: total=61.2298, vae=1.0759, dsb=60.1539, bio=0.0000
    Epoch  5/10: total=61.0737, vae=1.0761, dsb=59.9976, bio=0.0000
    Epoch  6/10: total=61.0240, vae=1.0751, dsb=59.9489, bio=0.0000
    Epoch  7/10: total=60.9412, vae=1.0755, dsb=59.8656, bio=0.0000
    Epoch  8/10: total=60.8975, vae=1.0757, dsb=59.8218, bio=0.0000
    Epoch  9/10: total=60.7097, vae=1.0758, dsb=59.6339, bio=0.0000
    Epoch 10/10: total=60.5457, vae=1.0758, dsb=59.4699, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.7920, vae=1.0757, dsb=0.7163, bio=0.0000
    Epoch  2/10: total=1.7385, vae=1.0770, dsb=0.6616, bio=0.0000
    Epoch  3/10: total=1.7356, vae=1.0763, dsb=0.6593, bio=0.0000
    Epoch  4/10: total=1.7313, vae=1.0763, dsb=0.6549, bio=0.0000
    Epoch  5/10: total=1.7109, vae=1.0758, dsb=0.6351, bio=0.0000
    Epoch  6/10: total=1.7033, vae=1.0757, dsb=0.6276, bio=0.0000
    Epoch  7/10: total=1.7146, vae=1.0765, dsb=0.6381, bio=0.0000
    Epoch  8/10: total=1.6943, vae=1.0756, dsb=0.6187, bio=0.0000
    Epoch  9/10: total=1.7028, vae=1.0761, dsb=0.6267, bio=0.0000
    Epoch 10/10: total=1.6986, vae=1.0766, dsb=0.6221, bio=0.0000

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=52.4939, vae=1.0763, dsb=51.4176, bio=0.0000
    Epoch  2/10: total=52.1346, vae=1.0758, dsb=51.0588, bio=0.0000
    Epoch  3/10: total=51.9264, vae=1.0757, dsb=50.8508, bio=0.0000
    Epoch  4/10: total=51.7946, vae=1.0757, dsb=50.7189, bio=0.0000
    Epoch  5/10: total=51.9683, vae=1.0761, dsb=50.8922, bio=0.0000
    Epoch  6/10: total=51.9771, vae=1.0760, dsb=50.9011, bio=0.0000
    Epoch  7/10: total=51.8945, vae=1.0756, dsb=50.8189, bio=0.0000
    Epoch  8/10: total=51.7715, vae=1.0760, dsb=50.6956, bio=0.0000
    Epoch  9/10: total=51.7590, vae=1.0765, dsb=50.6825, bio=0.0000
    Epoch 10/10: total=51.6787, vae=1.0767, dsb=50.6019, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.6546, vae=1.0761, dsb=0.5784, bio=0.0000
    Epoch  2/10: total=1.6103, vae=1.0763, dsb=0.5340, bio=0.0000
    Epoch  3/10: total=1.6123, vae=1.0766, dsb=0.5357, bio=0.0000
    Epoch  4/10: total=1.6038, vae=1.0760, dsb=0.5278, bio=0.0000
    Epoch  5/10: total=1.6138, vae=1.0767, dsb=0.5371, bio=0.0000
    Epoch  6/10: total=1.6163, vae=1.0757, dsb=0.5406, bio=0.0000
    Epoch  7/10: total=1.5914, vae=1.0752, dsb=0.5162, bio=0.0000
    Epoch  8/10: total=1.6133, vae=1.0755, dsb=0.5378, bio=0.0000
    Epoch  9/10: total=1.6060, vae=1.0757, dsb=0.5302, bio=0.0000
    Epoch 10/10: total=1.6035, vae=1.0754, dsb=0.5281, bio=0.0000

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=49.0189, vae=1.0760, dsb=47.9428, bio=0.0000
    Epoch  2/10: total=48.7577, vae=1.0760, dsb=47.6816, bio=0.0000
    Epoch  3/10: total=48.8635, vae=1.0766, dsb=47.7869, bio=0.0000
    Epoch  4/10: total=48.6299, vae=1.0756, dsb=47.5543, bio=0.0000
    Epoch  5/10: total=48.9329, vae=1.0761, dsb=47.8568, bio=0.0000
    Epoch  6/10: total=48.7160, vae=1.0764, dsb=47.6396, bio=0.0000
    Epoch  7/10: total=48.4456, vae=1.0755, dsb=47.3701, bio=0.0000
    Epoch  8/10: total=48.6912, vae=1.0755, dsb=47.6158, bio=0.0000
    Epoch  9/10: total=48.5339, vae=1.0761, dsb=47.4578, bio=0.0000
    Epoch 10/10: total=48.6624, vae=1.0760, dsb=47.5864, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.5759, vae=1.0753, dsb=0.5006, bio=0.0000
    Epoch  2/10: total=1.5526, vae=1.0759, dsb=0.4767, bio=0.0000
    Epoch  3/10: total=1.5514, vae=1.0763, dsb=0.4750, bio=0.0000
    Epoch  4/10: total=1.5468, vae=1.0761, dsb=0.4707, bio=0.0000
    Epoch  5/10: total=1.5365, vae=1.0756, dsb=0.4609, bio=0.0000
    Epoch  6/10: total=1.5398, vae=1.0753, dsb=0.4645, bio=0.0000
    Epoch  7/10: total=1.5299, vae=1.0768, dsb=0.4531, bio=0.0000
    Epoch  8/10: total=1.5394, vae=1.0767, dsb=0.4627, bio=0.0000
    Epoch  9/10: total=1.5359, vae=1.0762, dsb=0.4597, bio=0.0000
    Epoch 10/10: total=1.5403, vae=1.0754, dsb=0.4649, bio=0.0000

[Seed 48] Joint training (ablation) complete; models and history saved.

[Seed 48] Drift genes saved in /home/yyuan/ICB_TCE/iter_results/run_048

[Seed 48] run finished.

================================================================================
[Seed 49] Starting running whole pipeline...
================================================================================

[Seed 49] Starting VAE pre-training...

    Epoch [01/20], Beta: 0.000, Average Loss: 533.6175
    Epoch [02/20], Beta: 0.000, Average Loss: 303.0077
    Epoch [03/20], Beta: 0.000, Average Loss: 268.5555
    Epoch [04/20], Beta: 0.000, Average Loss: 249.4552
    Epoch [05/20], Beta: 0.100, Average Loss: 244.6273
    Epoch [06/20], Beta: 0.200, Average Loss: 244.0629
    Epoch [07/20], Beta: 0.300, Average Loss: 244.6187
    Epoch [08/20], Beta: 0.400, Average Loss: 245.4193
    Epoch [09/20], Beta: 0.500, Average Loss: 246.5680
    Epoch [10/20], Beta: 0.600, Average Loss: 247.8910
    Epoch [11/20], Beta: 0.700, Average Loss: 249.1932
    Epoch [12/20], Beta: 0.800, Average Loss: 250.4539
    Epoch [13/20], Beta: 0.900, Average Loss: 251.7164
    Epoch [14/20], Beta: 1.000, Average Loss: 253.3581
    Epoch [15/20], Beta: 1.000, Average Loss: 252.9313
    Epoch [16/20], Beta: 1.000, Average Loss: 252.5487
    Epoch [17/20], Beta: 1.000, Average Loss: 252.2480
    Epoch [18/20], Beta: 1.000, Average Loss: 251.8668
    Epoch [19/20], Beta: 1.000, Average Loss: 251.4974
    Epoch [20/20], Beta: 1.000, Average Loss: 251.3388

[Seed 49] VAE pre-training complete.

[Seed 49] Starting joint training (original)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=371.7070, vae=3.6635, dsb=351.4632, bio=33.1607
    Epoch  2/10: total=94.8103, vae=1.0954, dsb=93.6790, bio=0.0718
    Epoch  3/10: total=81.6799, vae=1.0902, dsb=80.5734, bio=0.0325
    Epoch  4/10: total=75.7785, vae=1.0885, dsb=74.6803, bio=0.0193
    Epoch  5/10: total=71.9333, vae=1.0876, dsb=70.8392, bio=0.0130
    Epoch  6/10: total=69.0860, vae=1.0866, dsb=67.9947, bio=0.0095
    Epoch  7/10: total=67.2801, vae=1.0867, dsb=66.1898, bio=0.0073
    Epoch  8/10: total=65.8502, vae=1.0853, dsb=64.7621, bio=0.0058
    Epoch  9/10: total=64.8808, vae=1.0855, dsb=63.7928, bio=0.0051
    Epoch 10/10: total=63.9814, vae=1.0862, dsb=62.8932, bio=0.0041

  [Backward Policy Training]
    Epoch  1/10: total=3.5089, vae=1.0855, dsb=2.4172, bio=0.0124
    Epoch  2/10: total=2.9037, vae=1.0844, dsb=1.8170, bio=0.0043
    Epoch  3/10: total=2.7360, vae=1.0848, dsb=1.6496, bio=0.0031
    Epoch  4/10: total=2.6832, vae=1.0840, dsb=1.5979, bio=0.0026
    Epoch  5/10: total=2.6263, vae=1.0840, dsb=1.5411, bio=0.0024
    Epoch  6/10: total=2.5692, vae=1.0844, dsb=1.4837, bio=0.0022
    Epoch  7/10: total=2.5480, vae=1.0832, dsb=1.4638, bio=0.0020
    Epoch  8/10: total=2.5366, vae=1.0832, dsb=1.4525, bio=0.0019
    Epoch  9/10: total=2.5227, vae=1.0836, dsb=1.4382, bio=0.0018
    Epoch 10/10: total=2.5080, vae=1.0830, dsb=1.4241, bio=0.0017

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=56.8262, vae=1.0858, dsb=55.7388, bio=0.0032
    Epoch  2/10: total=49.7622, vae=1.0852, dsb=48.6760, bio=0.0020
    Epoch  3/10: total=48.0228, vae=1.0845, dsb=46.9376, bio=0.0016
    Epoch  4/10: total=46.9671, vae=1.0840, dsb=45.8823, bio=0.0016
    Epoch  5/10: total=46.3729, vae=1.0845, dsb=45.2875, bio=0.0016
    Epoch  6/10: total=45.7729, vae=1.0833, dsb=44.6888, bio=0.0016
    Epoch  7/10: total=45.4063, vae=1.0835, dsb=44.3217, bio=0.0022
    Epoch  8/10: total=45.1620, vae=1.0837, dsb=44.0776, bio=0.0014
    Epoch  9/10: total=45.0749, vae=1.0832, dsb=43.9910, bio=0.0017
    Epoch 10/10: total=44.6276, vae=1.0833, dsb=43.5435, bio=0.0016

  [Backward Policy Training]
    Epoch  1/10: total=2.1998, vae=1.0835, dsb=1.1135, bio=0.0057
    Epoch  2/10: total=2.0755, vae=1.0829, dsb=0.9917, bio=0.0018
    Epoch  3/10: total=1.9939, vae=1.0821, dsb=0.9110, bio=0.0016
    Epoch  4/10: total=1.9669, vae=1.0831, dsb=0.8830, bio=0.0015
    Epoch  5/10: total=2.0134, vae=1.0822, dsb=0.9304, bio=0.0015
    Epoch  6/10: total=1.9543, vae=1.0826, dsb=0.8709, bio=0.0016
    Epoch  7/10: total=1.9811, vae=1.0819, dsb=0.8985, bio=0.0015
    Epoch  8/10: total=1.9360, vae=1.0822, dsb=0.8532, bio=0.0014
    Epoch  9/10: total=1.9382, vae=1.0813, dsb=0.8562, bio=0.0013
    Epoch 10/10: total=1.9494, vae=1.0827, dsb=0.8661, bio=0.0014

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=40.9301, vae=1.0847, dsb=39.8438, bio=0.0033
    Epoch  2/10: total=38.5171, vae=1.0833, dsb=37.4331, bio=0.0014
    Epoch  3/10: total=37.7584, vae=1.0837, dsb=36.6740, bio=0.0014
    Epoch  4/10: total=37.4511, vae=1.0823, dsb=36.3681, bio=0.0014
    Epoch  5/10: total=37.0498, vae=1.0824, dsb=35.9666, bio=0.0015
    Epoch  6/10: total=36.7772, vae=1.0829, dsb=35.6936, bio=0.0014
    Epoch  7/10: total=36.7571, vae=1.0823, dsb=35.6740, bio=0.0014
    Epoch  8/10: total=36.7891, vae=1.0823, dsb=35.7061, bio=0.0014
    Epoch  9/10: total=36.6458, vae=1.0828, dsb=35.5621, bio=0.0017
    Epoch 10/10: total=36.3209, vae=1.0826, dsb=35.2376, bio=0.0014

  [Backward Policy Training]
    Epoch  1/10: total=1.7970, vae=1.0834, dsb=0.6996, bio=0.0280
    Epoch  2/10: total=1.7202, vae=1.0824, dsb=0.6370, bio=0.0015
    Epoch  3/10: total=1.7178, vae=1.0812, dsb=0.6359, bio=0.0013
    Epoch  4/10: total=1.7064, vae=1.0822, dsb=0.6235, bio=0.0016
    Epoch  5/10: total=1.7052, vae=1.0814, dsb=0.6232, bio=0.0012
    Epoch  6/10: total=1.6832, vae=1.0817, dsb=0.6009, bio=0.0012
    Epoch  7/10: total=1.6745, vae=1.0816, dsb=0.5924, bio=0.0012
    Epoch  8/10: total=1.6837, vae=1.0818, dsb=0.6013, bio=0.0012
    Epoch  9/10: total=1.6879, vae=1.0815, dsb=0.6057, bio=0.0014
    Epoch 10/10: total=1.6733, vae=1.0813, dsb=0.5915, bio=0.0011

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=32.9899, vae=1.0847, dsb=31.9036, bio=0.0033
    Epoch  2/10: total=31.9453, vae=1.0837, dsb=30.8609, bio=0.0012
    Epoch  3/10: total=31.7077, vae=1.0830, dsb=30.6240, bio=0.0012
    Epoch  4/10: total=31.5347, vae=1.0829, dsb=30.4512, bio=0.0013
    Epoch  5/10: total=31.5245, vae=1.0822, dsb=30.4416, bio=0.0013
    Epoch  6/10: total=31.3185, vae=1.0815, dsb=30.2364, bio=0.0011
    Epoch  7/10: total=31.3909, vae=1.0823, dsb=30.3080, bio=0.0014
    Epoch  8/10: total=31.3199, vae=1.0818, dsb=30.2375, bio=0.0012
    Epoch  9/10: total=31.2927, vae=1.0822, dsb=30.2099, bio=0.0012
    Epoch 10/10: total=31.1498, vae=1.0823, dsb=30.0669, bio=0.0013

  [Backward Policy Training]
    Epoch  1/10: total=1.6343, vae=1.0823, dsb=0.5121, bio=0.0798
    Epoch  2/10: total=1.5732, vae=1.0810, dsb=0.4916, bio=0.0013
    Epoch  3/10: total=1.5650, vae=1.0815, dsb=0.4829, bio=0.0012
    Epoch  4/10: total=1.5600, vae=1.0813, dsb=0.4780, bio=0.0012
    Epoch  5/10: total=1.5643, vae=1.0813, dsb=0.4824, bio=0.0011
    Epoch  6/10: total=1.5621, vae=1.0809, dsb=0.4806, bio=0.0012
    Epoch  7/10: total=1.5544, vae=1.0805, dsb=0.4734, bio=0.0010
    Epoch  8/10: total=1.5421, vae=1.0804, dsb=0.4613, bio=0.0010
    Epoch  9/10: total=1.5266, vae=1.0797, dsb=0.4464, bio=0.0010
    Epoch 10/10: total=1.5358, vae=1.0805, dsb=0.4548, bio=0.0010

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=27.7114, vae=1.0836, dsb=26.6251, bio=0.0054
    Epoch  2/10: total=27.3329, vae=1.0830, dsb=26.2494, bio=0.0011
    Epoch  3/10: total=27.3012, vae=1.0819, dsb=26.2187, bio=0.0011
    Epoch  4/10: total=27.2790, vae=1.0816, dsb=26.1968, bio=0.0011
    Epoch  5/10: total=27.0436, vae=1.0827, dsb=25.9605, bio=0.0009
    Epoch  6/10: total=27.0617, vae=1.0822, dsb=25.9790, bio=0.0009
    Epoch  7/10: total=27.2234, vae=1.0818, dsb=26.1410, bio=0.0011
    Epoch  8/10: total=27.1381, vae=1.0817, dsb=26.0559, bio=0.0011
    Epoch  9/10: total=27.0333, vae=1.0813, dsb=25.9514, bio=0.0011
    Epoch 10/10: total=27.1925, vae=1.0814, dsb=26.1106, bio=0.0009

  [Backward Policy Training]
    Epoch  1/10: total=1.5543, vae=1.0826, dsb=0.4005, bio=0.1423
    Epoch  2/10: total=1.4716, vae=1.0811, dsb=0.3899, bio=0.0012
    Epoch  3/10: total=1.4687, vae=1.0802, dsb=0.3880, bio=0.0011
    Epoch  4/10: total=1.4728, vae=1.0806, dsb=0.3916, bio=0.0010
    Epoch  5/10: total=1.4796, vae=1.0802, dsb=0.3989, bio=0.0010
    Epoch  6/10: total=1.4718, vae=1.0802, dsb=0.3911, bio=0.0010
    Epoch  7/10: total=1.4633, vae=1.0804, dsb=0.3825, bio=0.0009
    Epoch  8/10: total=1.4674, vae=1.0812, dsb=0.3858, bio=0.0009
    Epoch  9/10: total=1.4646, vae=1.0801, dsb=0.3843, bio=0.0006
    Epoch 10/10: total=1.4689, vae=1.0804, dsb=0.3883, bio=0.0006

[Seed 49] Joint training (original) complete; models and history saved.

[Seed 49] Starting joint training (ablation)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=352.7398, vae=2.0088, dsb=350.7310, bio=0.0000
    Epoch  2/10: total=94.1441, vae=1.0778, dsb=93.0663, bio=0.0000
    Epoch  3/10: total=81.4112, vae=1.0759, dsb=80.3353, bio=0.0000
    Epoch  4/10: total=75.5250, vae=1.0752, dsb=74.4497, bio=0.0000
    Epoch  5/10: total=71.8084, vae=1.0747, dsb=70.7337, bio=0.0000
    Epoch  6/10: total=68.9415, vae=1.0740, dsb=67.8675, bio=0.0000
    Epoch  7/10: total=67.1559, vae=1.0744, dsb=66.0815, bio=0.0000
    Epoch  8/10: total=65.7368, vae=1.0734, dsb=64.6635, bio=0.0000
    Epoch  9/10: total=64.7572, vae=1.0738, dsb=63.6834, bio=0.0000
    Epoch 10/10: total=63.8322, vae=1.0748, dsb=62.7574, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=3.4146, vae=1.0733, dsb=2.3414, bio=0.0000
    Epoch  2/10: total=2.8217, vae=1.0737, dsb=1.7480, bio=0.0000
    Epoch  3/10: total=2.6590, vae=1.0745, dsb=1.5845, bio=0.0000
    Epoch  4/10: total=2.6072, vae=1.0739, dsb=1.5333, bio=0.0000
    Epoch  5/10: total=2.5530, vae=1.0741, dsb=1.4789, bio=0.0000
    Epoch  6/10: total=2.4971, vae=1.0747, dsb=1.4224, bio=0.0000
    Epoch  7/10: total=2.4746, vae=1.0736, dsb=1.4010, bio=0.0000
    Epoch  8/10: total=2.4653, vae=1.0737, dsb=1.3916, bio=0.0000
    Epoch  9/10: total=2.4528, vae=1.0742, dsb=1.3786, bio=0.0000
    Epoch 10/10: total=2.4371, vae=1.0737, dsb=1.3635, bio=0.0000

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=56.3478, vae=1.0737, dsb=55.2741, bio=0.0000
    Epoch  2/10: total=49.5144, vae=1.0741, dsb=48.4402, bio=0.0000
    Epoch  3/10: total=47.8124, vae=1.0738, dsb=46.7385, bio=0.0000
    Epoch  4/10: total=46.7752, vae=1.0736, dsb=45.7017, bio=0.0000
    Epoch  5/10: total=46.1649, vae=1.0742, dsb=45.0906, bio=0.0000
    Epoch  6/10: total=45.5198, vae=1.0731, dsb=44.4467, bio=0.0000
    Epoch  7/10: total=45.1422, vae=1.0732, dsb=44.0690, bio=0.0000
    Epoch  8/10: total=44.8863, vae=1.0737, dsb=43.8126, bio=0.0000
    Epoch  9/10: total=44.8088, vae=1.0733, dsb=43.7355, bio=0.0000
    Epoch 10/10: total=44.3695, vae=1.0735, dsb=43.2961, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=2.1348, vae=1.0732, dsb=1.0616, bio=0.0000
    Epoch  2/10: total=2.0164, vae=1.0738, dsb=0.9426, bio=0.0000
    Epoch  3/10: total=1.9374, vae=1.0733, dsb=0.8641, bio=0.0000
    Epoch  4/10: total=1.9124, vae=1.0743, dsb=0.8381, bio=0.0000
    Epoch  5/10: total=1.9581, vae=1.0736, dsb=0.8845, bio=0.0000
    Epoch  6/10: total=1.9013, vae=1.0738, dsb=0.8275, bio=0.0000
    Epoch  7/10: total=1.9288, vae=1.0734, dsb=0.8554, bio=0.0000
    Epoch  8/10: total=1.8862, vae=1.0737, dsb=0.8125, bio=0.0000
    Epoch  9/10: total=1.8895, vae=1.0728, dsb=0.8167, bio=0.0000
    Epoch 10/10: total=1.9003, vae=1.0744, dsb=0.8259, bio=0.0000

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=39.8671, vae=1.0736, dsb=38.7935, bio=0.0000
    Epoch  2/10: total=37.3802, vae=1.0736, dsb=36.3066, bio=0.0000
    Epoch  3/10: total=36.6467, vae=1.0742, dsb=35.5725, bio=0.0000
    Epoch  4/10: total=36.3519, vae=1.0729, dsb=35.2790, bio=0.0000
    Epoch  5/10: total=35.9502, vae=1.0730, dsb=34.8772, bio=0.0000
    Epoch  6/10: total=35.7013, vae=1.0737, dsb=34.6275, bio=0.0000
    Epoch  7/10: total=35.6741, vae=1.0732, dsb=34.6008, bio=0.0000
    Epoch  8/10: total=35.6978, vae=1.0733, dsb=34.6246, bio=0.0000
    Epoch  9/10: total=35.5236, vae=1.0738, dsb=34.4498, bio=0.0000
    Epoch 10/10: total=35.2262, vae=1.0737, dsb=34.1525, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.7369, vae=1.0739, dsb=0.6629, bio=0.0000
    Epoch  2/10: total=1.6818, vae=1.0742, dsb=0.6076, bio=0.0000
    Epoch  3/10: total=1.6811, vae=1.0730, dsb=0.6080, bio=0.0000
    Epoch  4/10: total=1.6715, vae=1.0742, dsb=0.5973, bio=0.0000
    Epoch  5/10: total=1.6713, vae=1.0735, dsb=0.5978, bio=0.0000
    Epoch  6/10: total=1.6502, vae=1.0738, dsb=0.5764, bio=0.0000
    Epoch  7/10: total=1.6425, vae=1.0737, dsb=0.5688, bio=0.0000
    Epoch  8/10: total=1.6515, vae=1.0741, dsb=0.5774, bio=0.0000
    Epoch  9/10: total=1.6566, vae=1.0738, dsb=0.5828, bio=0.0000
    Epoch 10/10: total=1.6427, vae=1.0738, dsb=0.5689, bio=0.0000

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=31.5261, vae=1.0740, dsb=30.4521, bio=0.0000
    Epoch  2/10: total=30.6165, vae=1.0743, dsb=29.5422, bio=0.0000
    Epoch  3/10: total=30.4057, vae=1.0740, dsb=29.3317, bio=0.0000
    Epoch  4/10: total=30.2705, vae=1.0741, dsb=29.1964, bio=0.0000
    Epoch  5/10: total=30.2522, vae=1.0735, dsb=29.1787, bio=0.0000
    Epoch  6/10: total=30.0748, vae=1.0728, dsb=29.0020, bio=0.0000
    Epoch  7/10: total=30.1487, vae=1.0738, dsb=29.0749, bio=0.0000
    Epoch  8/10: total=30.0867, vae=1.0734, dsb=29.0133, bio=0.0000
    Epoch  9/10: total=30.0640, vae=1.0738, dsb=28.9902, bio=0.0000
    Epoch 10/10: total=29.9285, vae=1.0740, dsb=28.8546, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.5593, vae=1.0733, dsb=0.4859, bio=0.0000
    Epoch  2/10: total=1.5432, vae=1.0732, dsb=0.4700, bio=0.0000
    Epoch  3/10: total=1.5372, vae=1.0738, dsb=0.4634, bio=0.0000
    Epoch  4/10: total=1.5337, vae=1.0740, dsb=0.4597, bio=0.0000
    Epoch  5/10: total=1.5389, vae=1.0740, dsb=0.4648, bio=0.0000
    Epoch  6/10: total=1.5375, vae=1.0737, dsb=0.4638, bio=0.0000
    Epoch  7/10: total=1.5307, vae=1.0734, dsb=0.4573, bio=0.0000
    Epoch  8/10: total=1.5192, vae=1.0734, dsb=0.4458, bio=0.0000
    Epoch  9/10: total=1.5046, vae=1.0729, dsb=0.4317, bio=0.0000
    Epoch 10/10: total=1.5137, vae=1.0737, dsb=0.4400, bio=0.0000

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=27.2178, vae=1.0731, dsb=26.1447, bio=0.0000
    Epoch  2/10: total=26.8934, vae=1.0739, dsb=25.8194, bio=0.0000
    Epoch  3/10: total=26.8687, vae=1.0731, dsb=25.7956, bio=0.0000
    Epoch  4/10: total=26.8588, vae=1.0731, dsb=25.7857, bio=0.0000
    Epoch  5/10: total=26.6406, vae=1.0743, dsb=25.5664, bio=0.0000
    Epoch  6/10: total=26.6672, vae=1.0740, dsb=25.5932, bio=0.0000
    Epoch  7/10: total=26.8398, vae=1.0739, dsb=25.7660, bio=0.0000
    Epoch  8/10: total=26.7226, vae=1.0737, dsb=25.6489, bio=0.0000
    Epoch  9/10: total=26.6370, vae=1.0734, dsb=25.5636, bio=0.0000
    Epoch 10/10: total=26.8221, vae=1.0735, dsb=25.7486, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.4643, vae=1.0738, dsb=0.3905, bio=0.0000
    Epoch  2/10: total=1.4546, vae=1.0735, dsb=0.3811, bio=0.0000
    Epoch  3/10: total=1.4524, vae=1.0729, dsb=0.3795, bio=0.0000
    Epoch  4/10: total=1.4570, vae=1.0736, dsb=0.3834, bio=0.0000
    Epoch  5/10: total=1.4637, vae=1.0732, dsb=0.3905, bio=0.0000
    Epoch  6/10: total=1.4559, vae=1.0733, dsb=0.3826, bio=0.0000
    Epoch  7/10: total=1.4476, vae=1.0736, dsb=0.3741, bio=0.0000
    Epoch  8/10: total=1.4520, vae=1.0745, dsb=0.3775, bio=0.0000
    Epoch  9/10: total=1.4494, vae=1.0733, dsb=0.3761, bio=0.0000
    Epoch 10/10: total=1.4535, vae=1.0738, dsb=0.3797, bio=0.0000

[Seed 49] Joint training (ablation) complete; models and history saved.

[Seed 49] Drift genes saved in /home/yyuan/ICB_TCE/iter_results/run_049

[Seed 49] run finished.

================================================================================
[Seed 50] Starting running whole pipeline...
================================================================================

[Seed 50] Starting VAE pre-training...

    Epoch [01/20], Beta: 0.000, Average Loss: 534.7871
    Epoch [02/20], Beta: 0.000, Average Loss: 309.5286
    Epoch [03/20], Beta: 0.000, Average Loss: 271.0775
    Epoch [04/20], Beta: 0.000, Average Loss: 249.3622
    Epoch [05/20], Beta: 0.100, Average Loss: 244.1369
    Epoch [06/20], Beta: 0.200, Average Loss: 243.3708
    Epoch [07/20], Beta: 0.300, Average Loss: 243.9782
    Epoch [08/20], Beta: 0.400, Average Loss: 244.9959
    Epoch [09/20], Beta: 0.500, Average Loss: 246.2372
    Epoch [10/20], Beta: 0.600, Average Loss: 247.5419
    Epoch [11/20], Beta: 0.700, Average Loss: 248.9296
    Epoch [12/20], Beta: 0.800, Average Loss: 250.2944
    Epoch [13/20], Beta: 0.900, Average Loss: 251.6618
    Epoch [14/20], Beta: 1.000, Average Loss: 253.2652
    Epoch [15/20], Beta: 1.000, Average Loss: 252.9003
    Epoch [16/20], Beta: 1.000, Average Loss: 252.4869
    Epoch [17/20], Beta: 1.000, Average Loss: 252.1485
    Epoch [18/20], Beta: 1.000, Average Loss: 251.8725
    Epoch [19/20], Beta: 1.000, Average Loss: 251.4908
    Epoch [20/20], Beta: 1.000, Average Loss: 251.2765

[Seed 50] VAE pre-training complete.

[Seed 50] Starting joint training (original)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=498.2017, vae=3.5345, dsb=482.8537, bio=23.6269
    Epoch  2/10: total=168.4916, vae=1.1025, dsb=167.3556, bio=0.0670
    Epoch  3/10: total=158.5978, vae=1.0960, dsb=157.4866, bio=0.0305
    Epoch  4/10: total=155.8319, vae=1.0951, dsb=154.7278, bio=0.0180
    Epoch  5/10: total=154.7498, vae=1.0939, dsb=153.6498, bio=0.0120
    Epoch  6/10: total=152.1210, vae=1.0935, dsb=151.0229, bio=0.0092
    Epoch  7/10: total=150.8598, vae=1.0930, dsb=149.7632, bio=0.0071
    Epoch  8/10: total=150.2479, vae=1.0924, dsb=149.1526, bio=0.0059
    Epoch  9/10: total=149.5533, vae=1.0923, dsb=148.4585, bio=0.0049
    Epoch 10/10: total=148.5184, vae=1.0919, dsb=147.4243, bio=0.0044

  [Backward Policy Training]
    Epoch  1/10: total=3.4080, vae=1.0923, dsb=2.3086, bio=0.0143
    Epoch  2/10: total=2.9114, vae=1.0923, dsb=1.8167, bio=0.0048
    Epoch  3/10: total=2.8267, vae=1.0909, dsb=1.7340, bio=0.0035
    Epoch  4/10: total=2.7922, vae=1.0908, dsb=1.6999, bio=0.0029
    Epoch  5/10: total=2.7597, vae=1.0902, dsb=1.6682, bio=0.0026
    Epoch  6/10: total=2.7220, vae=1.0897, dsb=1.6311, bio=0.0024
    Epoch  7/10: total=2.6931, vae=1.0908, dsb=1.6012, bio=0.0022
    Epoch  8/10: total=2.6918, vae=1.0901, dsb=1.6007, bio=0.0021
    Epoch  9/10: total=2.6972, vae=1.0900, dsb=1.6062, bio=0.0021
    Epoch 10/10: total=2.6316, vae=1.0903, dsb=1.5404, bio=0.0020

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=128.7625, vae=1.0937, dsb=127.6662, bio=0.0053
    Epoch  2/10: total=125.1122, vae=1.0912, dsb=124.0200, bio=0.0020
    Epoch  3/10: total=123.9452, vae=1.0911, dsb=122.8531, bio=0.0020
    Epoch  4/10: total=123.1135, vae=1.0903, dsb=122.0222, bio=0.0019
    Epoch  5/10: total=123.5347, vae=1.0903, dsb=122.4434, bio=0.0019
    Epoch  6/10: total=123.2114, vae=1.0909, dsb=122.1196, bio=0.0019
    Epoch  7/10: total=123.7644, vae=1.0909, dsb=122.6726, bio=0.0018
    Epoch  8/10: total=123.3102, vae=1.0899, dsb=122.2194, bio=0.0019
    Epoch  9/10: total=121.7734, vae=1.0897, dsb=120.6827, bio=0.0019
    Epoch 10/10: total=121.7251, vae=1.0901, dsb=120.6339, bio=0.0021

  [Backward Policy Training]
    Epoch  1/10: total=2.3584, vae=1.0897, dsb=1.2656, bio=0.0063
    Epoch  2/10: total=2.2560, vae=1.0882, dsb=1.1668, bio=0.0020
    Epoch  3/10: total=2.2337, vae=1.0887, dsb=1.1442, bio=0.0018
    Epoch  4/10: total=2.2167, vae=1.0889, dsb=1.1270, bio=0.0017
    Epoch  5/10: total=2.2243, vae=1.0888, dsb=1.1346, bio=0.0017
    Epoch  6/10: total=2.1976, vae=1.0884, dsb=1.1084, bio=0.0016
    Epoch  7/10: total=2.1728, vae=1.0885, dsb=1.0835, bio=0.0016
    Epoch  8/10: total=2.1912, vae=1.0880, dsb=1.1024, bio=0.0017
    Epoch  9/10: total=2.1456, vae=1.0880, dsb=1.0569, bio=0.0015
    Epoch 10/10: total=2.1431, vae=1.0875, dsb=1.0548, bio=0.0015

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=108.3646, vae=1.0919, dsb=107.2706, bio=0.0041
    Epoch  2/10: total=106.8170, vae=1.0902, dsb=105.7259, bio=0.0017
    Epoch  3/10: total=106.2908, vae=1.0908, dsb=105.1992, bio=0.0016
    Epoch  4/10: total=105.7985, vae=1.0893, dsb=104.7083, bio=0.0018
    Epoch  5/10: total=106.3761, vae=1.0888, dsb=105.2865, bio=0.0015
    Epoch  6/10: total=105.5596, vae=1.0894, dsb=104.4694, bio=0.0016
    Epoch  7/10: total=106.0626, vae=1.0888, dsb=104.9731, bio=0.0016
    Epoch  8/10: total=105.8624, vae=1.0889, dsb=104.7727, bio=0.0016
    Epoch  9/10: total=105.5626, vae=1.0887, dsb=104.4731, bio=0.0016
    Epoch 10/10: total=106.1369, vae=1.0891, dsb=105.0470, bio=0.0017

  [Backward Policy Training]
    Epoch  1/10: total=2.0726, vae=1.0890, dsb=0.9609, bio=0.0453
    Epoch  2/10: total=2.0017, vae=1.0883, dsb=0.9126, bio=0.0016
    Epoch  3/10: total=2.0121, vae=1.0876, dsb=0.9238, bio=0.0014
    Epoch  4/10: total=1.9953, vae=1.0884, dsb=0.9062, bio=0.0014
    Epoch  5/10: total=1.9668, vae=1.0887, dsb=0.8775, bio=0.0014
    Epoch  6/10: total=1.9917, vae=1.0873, dsb=0.9037, bio=0.0013
    Epoch  7/10: total=1.9918, vae=1.0880, dsb=0.9031, bio=0.0013
    Epoch  8/10: total=1.9563, vae=1.0886, dsb=0.8670, bio=0.0013
    Epoch  9/10: total=1.9641, vae=1.0867, dsb=0.8767, bio=0.0013
    Epoch 10/10: total=1.9882, vae=1.0880, dsb=0.8996, bio=0.0013

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=95.5027, vae=1.0892, dsb=94.4121, bio=0.0029
    Epoch  2/10: total=95.0997, vae=1.0896, dsb=94.0094, bio=0.0014
    Epoch  3/10: total=95.3857, vae=1.0886, dsb=94.2963, bio=0.0014
    Epoch  4/10: total=95.3464, vae=1.0881, dsb=94.2577, bio=0.0014
    Epoch  5/10: total=96.0587, vae=1.0887, dsb=94.9694, bio=0.0013
    Epoch  6/10: total=95.3082, vae=1.0880, dsb=94.2195, bio=0.0013
    Epoch  7/10: total=94.8250, vae=1.0884, dsb=93.7356, bio=0.0020
    Epoch  8/10: total=94.4662, vae=1.0882, dsb=93.3774, bio=0.0012
    Epoch  9/10: total=95.0365, vae=1.0874, dsb=93.9485, bio=0.0012
    Epoch 10/10: total=94.4157, vae=1.0883, dsb=93.3268, bio=0.0012

  [Backward Policy Training]
    Epoch  1/10: total=1.9447, vae=1.0880, dsb=0.7946, bio=0.1243
    Epoch  2/10: total=1.8501, vae=1.0881, dsb=0.7613, bio=0.0014
    Epoch  3/10: total=1.8425, vae=1.0877, dsb=0.7542, bio=0.0012
    Epoch  4/10: total=1.8636, vae=1.0874, dsb=0.7756, bio=0.0012
    Epoch  5/10: total=1.8373, vae=1.0879, dsb=0.7488, bio=0.0012
    Epoch  6/10: total=1.8556, vae=1.0874, dsb=0.7675, bio=0.0014
    Epoch  7/10: total=1.8089, vae=1.0872, dsb=0.7212, bio=0.0011
    Epoch  8/10: total=1.8190, vae=1.0875, dsb=0.7310, bio=0.0011
    Epoch  9/10: total=1.8369, vae=1.0879, dsb=0.7485, bio=0.0011
    Epoch 10/10: total=1.8066, vae=1.0878, dsb=0.7182, bio=0.0011

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=86.5679, vae=1.0918, dsb=85.4744, bio=0.0034
    Epoch  2/10: total=86.8448, vae=1.0880, dsb=85.7561, bio=0.0013
    Epoch  3/10: total=86.8930, vae=1.0883, dsb=85.8040, bio=0.0013
    Epoch  4/10: total=86.6816, vae=1.0874, dsb=85.5936, bio=0.0012
    Epoch  5/10: total=87.1177, vae=1.0875, dsb=86.0296, bio=0.0012
    Epoch  6/10: total=86.7230, vae=1.0889, dsb=85.6336, bio=0.0011
    Epoch  7/10: total=86.9326, vae=1.0875, dsb=85.8445, bio=0.0011
    Epoch  8/10: total=86.2066, vae=1.0877, dsb=85.1183, bio=0.0011
    Epoch  9/10: total=86.6918, vae=1.0881, dsb=85.6031, bio=0.0011
    Epoch 10/10: total=86.6987, vae=1.0875, dsb=85.6107, bio=0.0010

  [Backward Policy Training]
    Epoch  1/10: total=1.8865, vae=1.0892, dsb=0.6864, bio=0.2219
    Epoch  2/10: total=1.7513, vae=1.0878, dsb=0.6629, bio=0.0012
    Epoch  3/10: total=1.7641, vae=1.0872, dsb=0.6764, bio=0.0011
    Epoch  4/10: total=1.7462, vae=1.0881, dsb=0.6575, bio=0.0011
    Epoch  5/10: total=1.7605, vae=1.0881, dsb=0.6720, bio=0.0008
    Epoch  6/10: total=1.7728, vae=1.0875, dsb=0.6848, bio=0.0010
    Epoch  7/10: total=1.7501, vae=1.0874, dsb=0.6622, bio=0.0010
    Epoch  8/10: total=1.7424, vae=1.0861, dsb=0.6557, bio=0.0010
    Epoch  9/10: total=1.7685, vae=1.0869, dsb=0.6811, bio=0.0010
    Epoch 10/10: total=1.7627, vae=1.0865, dsb=0.6758, bio=0.0008

[Seed 50] Joint training (original) complete; models and history saved.

[Seed 50] Starting joint training (ablation)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=483.8893, vae=2.0175, dsb=481.8718, bio=0.0000
    Epoch  2/10: total=167.8752, vae=1.0847, dsb=166.7905, bio=0.0000
    Epoch  3/10: total=158.2000, vae=1.0817, dsb=157.1183, bio=0.0000
    Epoch  4/10: total=155.4506, vae=1.0817, dsb=154.3689, bio=0.0000
    Epoch  5/10: total=154.3865, vae=1.0810, dsb=153.3055, bio=0.0000
    Epoch  6/10: total=151.7874, vae=1.0808, dsb=150.7066, bio=0.0000
    Epoch  7/10: total=150.5350, vae=1.0806, dsb=149.4544, bio=0.0000
    Epoch  8/10: total=149.9261, vae=1.0803, dsb=148.8458, bio=0.0000
    Epoch  9/10: total=149.2396, vae=1.0805, dsb=148.1591, bio=0.0000
    Epoch 10/10: total=148.2348, vae=1.0804, dsb=147.1545, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=3.2384, vae=1.0799, dsb=2.1585, bio=0.0000
    Epoch  2/10: total=2.7719, vae=1.0814, dsb=1.6906, bio=0.0000
    Epoch  3/10: total=2.6953, vae=1.0804, dsb=1.6149, bio=0.0000
    Epoch  4/10: total=2.6644, vae=1.0805, dsb=1.5838, bio=0.0000
    Epoch  5/10: total=2.6337, vae=1.0802, dsb=1.5535, bio=0.0000
    Epoch  6/10: total=2.5992, vae=1.0798, dsb=1.5194, bio=0.0000
    Epoch  7/10: total=2.5725, vae=1.0810, dsb=1.4915, bio=0.0000
    Epoch  8/10: total=2.5733, vae=1.0804, dsb=1.4929, bio=0.0000
    Epoch  9/10: total=2.5779, vae=1.0804, dsb=1.4975, bio=0.0000
    Epoch 10/10: total=2.5157, vae=1.0807, dsb=1.4350, bio=0.0000

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=125.5132, vae=1.0805, dsb=124.4328, bio=0.0000
    Epoch  2/10: total=121.9322, vae=1.0802, dsb=120.8520, bio=0.0000
    Epoch  3/10: total=120.8605, vae=1.0804, dsb=119.7800, bio=0.0000
    Epoch  4/10: total=120.0789, vae=1.0798, dsb=118.9992, bio=0.0000
    Epoch  5/10: total=120.4598, vae=1.0799, dsb=119.3799, bio=0.0000
    Epoch  6/10: total=120.2258, vae=1.0806, dsb=119.1452, bio=0.0000
    Epoch  7/10: total=120.7875, vae=1.0808, dsb=119.7067, bio=0.0000
    Epoch  8/10: total=120.3605, vae=1.0799, dsb=119.2806, bio=0.0000
    Epoch  9/10: total=118.8630, vae=1.0799, dsb=117.7831, bio=0.0000
    Epoch 10/10: total=118.8621, vae=1.0801, dsb=117.7820, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=2.2189, vae=1.0793, dsb=1.1396, bio=0.0000
    Epoch  2/10: total=2.1338, vae=1.0793, dsb=1.0545, bio=0.0000
    Epoch  3/10: total=2.1163, vae=1.0799, dsb=1.0364, bio=0.0000
    Epoch  4/10: total=2.1024, vae=1.0802, dsb=1.0222, bio=0.0000
    Epoch  5/10: total=2.1103, vae=1.0802, dsb=1.0302, bio=0.0000
    Epoch  6/10: total=2.0870, vae=1.0799, dsb=1.0071, bio=0.0000
    Epoch  7/10: total=2.0639, vae=1.0800, dsb=0.9839, bio=0.0000
    Epoch  8/10: total=2.0805, vae=1.0795, dsb=1.0010, bio=0.0000
    Epoch  9/10: total=2.0381, vae=1.0796, dsb=0.9585, bio=0.0000
    Epoch 10/10: total=2.0368, vae=1.0792, dsb=0.9576, bio=0.0000

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=103.3846, vae=1.0801, dsb=102.3045, bio=0.0000
    Epoch  2/10: total=102.0842, vae=1.0806, dsb=101.0035, bio=0.0000
    Epoch  3/10: total=101.5748, vae=1.0814, dsb=100.4934, bio=0.0000
    Epoch  4/10: total=101.1250, vae=1.0800, dsb=100.0450, bio=0.0000
    Epoch  5/10: total=101.7031, vae=1.0796, dsb=100.6235, bio=0.0000
    Epoch  6/10: total=100.9795, vae=1.0803, dsb=99.8992, bio=0.0000
    Epoch  7/10: total=101.4021, vae=1.0798, dsb=100.3223, bio=0.0000
    Epoch  8/10: total=101.2464, vae=1.0800, dsb=100.1664, bio=0.0000
    Epoch  9/10: total=100.9900, vae=1.0799, dsb=99.9101, bio=0.0000
    Epoch 10/10: total=101.5590, vae=1.0804, dsb=100.4786, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.9335, vae=1.0797, dsb=0.8538, bio=0.0000
    Epoch  2/10: total=1.8931, vae=1.0800, dsb=0.8131, bio=0.0000
    Epoch  3/10: total=1.9043, vae=1.0795, dsb=0.8248, bio=0.0000
    Epoch  4/10: total=1.8906, vae=1.0804, dsb=0.8102, bio=0.0000
    Epoch  5/10: total=1.8653, vae=1.0806, dsb=0.7847, bio=0.0000
    Epoch  6/10: total=1.8890, vae=1.0793, dsb=0.8097, bio=0.0000
    Epoch  7/10: total=1.8898, vae=1.0801, dsb=0.8097, bio=0.0000
    Epoch  8/10: total=1.8574, vae=1.0807, dsb=0.7767, bio=0.0000
    Epoch  9/10: total=1.8649, vae=1.0788, dsb=0.7861, bio=0.0000
    Epoch 10/10: total=1.8874, vae=1.0801, dsb=0.8072, bio=0.0000

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=88.1942, vae=1.0787, dsb=87.1156, bio=0.0000
    Epoch  2/10: total=87.9245, vae=1.0806, dsb=86.8438, bio=0.0000
    Epoch  3/10: total=88.2367, vae=1.0799, dsb=87.1568, bio=0.0000
    Epoch  4/10: total=88.1818, vae=1.0795, dsb=87.1023, bio=0.0000
    Epoch  5/10: total=88.8191, vae=1.0803, dsb=87.7389, bio=0.0000
    Epoch  6/10: total=88.0728, vae=1.0797, dsb=86.9931, bio=0.0000
    Epoch  7/10: total=87.7734, vae=1.0800, dsb=86.6934, bio=0.0000
    Epoch  8/10: total=87.4320, vae=1.0801, dsb=86.3519, bio=0.0000
    Epoch  9/10: total=87.9486, vae=1.0793, dsb=86.8693, bio=0.0000
    Epoch 10/10: total=87.3028, vae=1.0804, dsb=86.2225, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.7890, vae=1.0789, dsb=0.7101, bio=0.0000
    Epoch  2/10: total=1.7612, vae=1.0802, dsb=0.6810, bio=0.0000
    Epoch  3/10: total=1.7552, vae=1.0799, dsb=0.6753, bio=0.0000
    Epoch  4/10: total=1.7750, vae=1.0796, dsb=0.6954, bio=0.0000
    Epoch  5/10: total=1.7515, vae=1.0802, dsb=0.6713, bio=0.0000
    Epoch  6/10: total=1.7684, vae=1.0797, dsb=0.6886, bio=0.0000
    Epoch  7/10: total=1.7261, vae=1.0796, dsb=0.6465, bio=0.0000
    Epoch  8/10: total=1.7359, vae=1.0799, dsb=0.6560, bio=0.0000
    Epoch  9/10: total=1.7524, vae=1.0803, dsb=0.6721, bio=0.0000
    Epoch 10/10: total=1.7247, vae=1.0803, dsb=0.6444, bio=0.0000

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=79.6705, vae=1.0809, dsb=78.5896, bio=0.0000
    Epoch  2/10: total=79.9527, vae=1.0791, dsb=78.8736, bio=0.0000
    Epoch  3/10: total=80.0295, vae=1.0800, dsb=78.9495, bio=0.0000
    Epoch  4/10: total=79.8178, vae=1.0794, dsb=78.7384, bio=0.0000
    Epoch  5/10: total=80.2481, vae=1.0795, dsb=79.1686, bio=0.0000
    Epoch  6/10: total=79.9061, vae=1.0810, dsb=78.8250, bio=0.0000
    Epoch  7/10: total=80.0725, vae=1.0798, dsb=78.9927, bio=0.0000
    Epoch  8/10: total=79.4512, vae=1.0800, dsb=78.3712, bio=0.0000
    Epoch  9/10: total=79.8880, vae=1.0804, dsb=78.8077, bio=0.0000
    Epoch 10/10: total=79.8833, vae=1.0799, dsb=78.8034, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.6967, vae=1.0804, dsb=0.6163, bio=0.0000
    Epoch  2/10: total=1.6757, vae=1.0801, dsb=0.5956, bio=0.0000
    Epoch  3/10: total=1.6880, vae=1.0796, dsb=0.6083, bio=0.0000
    Epoch  4/10: total=1.6723, vae=1.0807, dsb=0.5916, bio=0.0000
    Epoch  5/10: total=1.6852, vae=1.0807, dsb=0.6045, bio=0.0000
    Epoch  6/10: total=1.6969, vae=1.0803, dsb=0.6167, bio=0.0000
    Epoch  7/10: total=1.6761, vae=1.0803, dsb=0.5958, bio=0.0000
    Epoch  8/10: total=1.6691, vae=1.0791, dsb=0.5900, bio=0.0000
    Epoch  9/10: total=1.6937, vae=1.0799, dsb=0.6137, bio=0.0000
    Epoch 10/10: total=1.6885, vae=1.0796, dsb=0.6089, bio=0.0000

[Seed 50] Joint training (ablation) complete; models and history saved.

[Seed 50] Drift genes saved in /home/yyuan/ICB_TCE/iter_results/run_050

[Seed 50] run finished.

================================================================================
[Seed 51] Starting running whole pipeline...
================================================================================

[Seed 51] Starting VAE pre-training...

    Epoch [01/20], Beta: 0.000, Average Loss: 540.0608
    Epoch [02/20], Beta: 0.000, Average Loss: 306.7975
    Epoch [03/20], Beta: 0.000, Average Loss: 268.6654
    Epoch [04/20], Beta: 0.000, Average Loss: 248.2033
    Epoch [05/20], Beta: 0.100, Average Loss: 244.3999
    Epoch [06/20], Beta: 0.200, Average Loss: 244.5630
    Epoch [07/20], Beta: 0.300, Average Loss: 244.9727
    Epoch [08/20], Beta: 0.400, Average Loss: 245.6970
    Epoch [09/20], Beta: 0.500, Average Loss: 246.7818
    Epoch [10/20], Beta: 0.600, Average Loss: 248.0520
    Epoch [11/20], Beta: 0.700, Average Loss: 249.3583
    Epoch [12/20], Beta: 0.800, Average Loss: 250.6499
    Epoch [13/20], Beta: 0.900, Average Loss: 252.3325
    Epoch [14/20], Beta: 1.000, Average Loss: 253.9514
    Epoch [15/20], Beta: 1.000, Average Loss: 253.4906
    Epoch [16/20], Beta: 1.000, Average Loss: 253.0943
    Epoch [17/20], Beta: 1.000, Average Loss: 252.6799
    Epoch [18/20], Beta: 1.000, Average Loss: 252.2754
    Epoch [19/20], Beta: 1.000, Average Loss: 252.1131
    Epoch [20/20], Beta: 1.000, Average Loss: 251.9365

[Seed 51] VAE pre-training complete.

[Seed 51] Starting joint training (original)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=333.8271, vae=3.5011, dsb=316.0074, bio=28.6372
    Epoch  2/10: total=85.6396, vae=1.1009, dsb=84.4916, bio=0.0943
    Epoch  3/10: total=72.1631, vae=1.0956, dsb=71.0487, bio=0.0374
    Epoch  4/10: total=65.9742, vae=1.0935, dsb=64.8709, bio=0.0197
    Epoch  5/10: total=62.2377, vae=1.0915, dsb=61.1398, bio=0.0128
    Epoch  6/10: total=59.8565, vae=1.0917, dsb=58.7603, bio=0.0090
    Epoch  7/10: total=58.0449, vae=1.0907, dsb=56.9507, bio=0.0070
    Epoch  8/10: total=56.7193, vae=1.0905, dsb=55.6260, bio=0.0056
    Epoch  9/10: total=55.4015, vae=1.0908, dsb=54.3084, bio=0.0047
    Epoch 10/10: total=54.6324, vae=1.0908, dsb=53.5396, bio=0.0042

  [Backward Policy Training]
    Epoch  1/10: total=3.4694, vae=1.0915, dsb=2.3717, bio=0.0122
    Epoch  2/10: total=2.9165, vae=1.0893, dsb=1.8250, bio=0.0044
    Epoch  3/10: total=2.7898, vae=1.0897, dsb=1.6985, bio=0.0032
    Epoch  4/10: total=2.6940, vae=1.0885, dsb=1.6041, bio=0.0027
    Epoch  5/10: total=2.6226, vae=1.0884, dsb=1.5330, bio=0.0025
    Epoch  6/10: total=2.6030, vae=1.0881, dsb=1.5138, bio=0.0023
    Epoch  7/10: total=2.5455, vae=1.0883, dsb=1.4561, bio=0.0023
    Epoch  8/10: total=2.5449, vae=1.0882, dsb=1.4557, bio=0.0021
    Epoch  9/10: total=2.5352, vae=1.0881, dsb=1.4461, bio=0.0020
    Epoch 10/10: total=2.5427, vae=1.0889, dsb=1.4529, bio=0.0020

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=53.8635, vae=1.0902, dsb=52.7715, bio=0.0035
    Epoch  2/10: total=45.4438, vae=1.0890, dsb=44.3537, bio=0.0020
    Epoch  3/10: total=43.4949, vae=1.0887, dsb=42.4053, bio=0.0019
    Epoch  4/10: total=41.9907, vae=1.0887, dsb=40.9011, bio=0.0019
    Epoch  5/10: total=41.1948, vae=1.0887, dsb=40.1051, bio=0.0019
    Epoch  6/10: total=40.6571, vae=1.0887, dsb=39.5674, bio=0.0019
    Epoch  7/10: total=40.3367, vae=1.0886, dsb=39.2472, bio=0.0019
    Epoch  8/10: total=39.9187, vae=1.0884, dsb=38.8293, bio=0.0020
    Epoch  9/10: total=39.4896, vae=1.0886, dsb=38.4001, bio=0.0018
    Epoch 10/10: total=39.3143, vae=1.0885, dsb=38.2249, bio=0.0018

  [Backward Policy Training]
    Epoch  1/10: total=2.2893, vae=1.0900, dsb=1.1967, bio=0.0052
    Epoch  2/10: total=2.1226, vae=1.0870, dsb=1.0346, bio=0.0020
    Epoch  3/10: total=2.1119, vae=1.0871, dsb=1.0239, bio=0.0018
    Epoch  4/10: total=2.0815, vae=1.0863, dsb=0.9944, bio=0.0017
    Epoch  5/10: total=2.0452, vae=1.0865, dsb=0.9578, bio=0.0017
    Epoch  6/10: total=2.0473, vae=1.0867, dsb=0.9595, bio=0.0021
    Epoch  7/10: total=2.0302, vae=1.0874, dsb=0.9420, bio=0.0015
    Epoch  8/10: total=2.0113, vae=1.0861, dsb=0.9245, bio=0.0015
    Epoch  9/10: total=1.9954, vae=1.0872, dsb=0.9074, bio=0.0015
    Epoch 10/10: total=2.0141, vae=1.0863, dsb=0.9270, bio=0.0015

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=37.9448, vae=1.0889, dsb=36.8545, bio=0.0028
    Epoch  2/10: total=34.4148, vae=1.0862, dsb=33.3277, bio=0.0017
    Epoch  3/10: total=33.3989, vae=1.0879, dsb=32.3101, bio=0.0016
    Epoch  4/10: total=32.7724, vae=1.0888, dsb=31.6829, bio=0.0016
    Epoch  5/10: total=32.5554, vae=1.0875, dsb=31.4671, bio=0.0016
    Epoch  6/10: total=32.2792, vae=1.0874, dsb=31.1910, bio=0.0016
    Epoch  7/10: total=32.1017, vae=1.0871, dsb=31.0137, bio=0.0016
    Epoch  8/10: total=31.9137, vae=1.0875, dsb=30.8253, bio=0.0017
    Epoch  9/10: total=31.8776, vae=1.0872, dsb=30.7896, bio=0.0016
    Epoch 10/10: total=31.6769, vae=1.0877, dsb=30.5884, bio=0.0016

  [Backward Policy Training]
    Epoch  1/10: total=1.9120, vae=1.0877, dsb=0.8199, bio=0.0087
    Epoch  2/10: total=1.8331, vae=1.0865, dsb=0.7457, bio=0.0016
    Epoch  3/10: total=1.8312, vae=1.0860, dsb=0.7444, bio=0.0015
    Epoch  4/10: total=1.8179, vae=1.0857, dsb=0.7314, bio=0.0015
    Epoch  5/10: total=1.8118, vae=1.0862, dsb=0.7249, bio=0.0014
    Epoch  6/10: total=1.7946, vae=1.0862, dsb=0.7077, bio=0.0014
    Epoch  7/10: total=1.7805, vae=1.0858, dsb=0.6940, bio=0.0015
    Epoch  8/10: total=1.7835, vae=1.0854, dsb=0.6975, bio=0.0013
    Epoch  9/10: total=1.7700, vae=1.0862, dsb=0.6832, bio=0.0013
    Epoch 10/10: total=1.7788, vae=1.0856, dsb=0.6925, bio=0.0013

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=30.2179, vae=1.0884, dsb=29.1281, bio=0.0027
    Epoch  2/10: total=28.5923, vae=1.0872, dsb=27.5044, bio=0.0014
    Epoch  3/10: total=28.1141, vae=1.0880, dsb=27.0254, bio=0.0014
    Epoch  4/10: total=27.8749, vae=1.0872, dsb=26.7869, bio=0.0014
    Epoch  5/10: total=27.7928, vae=1.0874, dsb=26.7045, bio=0.0018
    Epoch  6/10: total=27.8047, vae=1.0870, dsb=26.7170, bio=0.0014
    Epoch  7/10: total=27.5852, vae=1.0862, dsb=26.4982, bio=0.0014
    Epoch  8/10: total=27.4428, vae=1.0870, dsb=26.3551, bio=0.0014
    Epoch  9/10: total=27.5158, vae=1.0859, dsb=26.4291, bio=0.0014
    Epoch 10/10: total=27.4823, vae=1.0871, dsb=26.3944, bio=0.0014

  [Backward Policy Training]
    Epoch  1/10: total=1.7186, vae=1.0874, dsb=0.6149, bio=0.0327
    Epoch  2/10: total=1.6750, vae=1.0866, dsb=0.5876, bio=0.0015
    Epoch  3/10: total=1.6623, vae=1.0866, dsb=0.5751, bio=0.0013
    Epoch  4/10: total=1.6541, vae=1.0854, dsb=0.5682, bio=0.0012
    Epoch  5/10: total=1.6490, vae=1.0862, dsb=0.5622, bio=0.0012
    Epoch  6/10: total=1.6415, vae=1.0858, dsb=0.5551, bio=0.0012
    Epoch  7/10: total=1.6462, vae=1.0857, dsb=0.5599, bio=0.0012
    Epoch  8/10: total=1.6470, vae=1.0855, dsb=0.5609, bio=0.0012
    Epoch  9/10: total=1.6354, vae=1.0865, dsb=0.5484, bio=0.0011
    Epoch 10/10: total=1.6504, vae=1.0855, dsb=0.5644, bio=0.0011

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=24.4716, vae=1.0887, dsb=23.3817, bio=0.0025
    Epoch  2/10: total=23.7153, vae=1.0867, dsb=22.6279, bio=0.0013
    Epoch  3/10: total=23.5236, vae=1.0866, dsb=22.4363, bio=0.0013
    Epoch  4/10: total=23.5803, vae=1.0864, dsb=22.4932, bio=0.0013
    Epoch  5/10: total=23.3330, vae=1.0862, dsb=22.2459, bio=0.0018
    Epoch  6/10: total=23.4517, vae=1.0860, dsb=22.3651, bio=0.0011
    Epoch  7/10: total=23.4116, vae=1.0874, dsb=22.3236, bio=0.0012
    Epoch  8/10: total=23.2853, vae=1.0866, dsb=22.1982, bio=0.0012
    Epoch  9/10: total=23.3416, vae=1.0861, dsb=22.2549, bio=0.0012
    Epoch 10/10: total=23.2589, vae=1.0853, dsb=22.1730, bio=0.0012

  [Backward Policy Training]
    Epoch  1/10: total=1.6308, vae=1.0879, dsb=0.4883, bio=0.1092
    Epoch  2/10: total=1.5655, vae=1.0857, dsb=0.4791, bio=0.0012
    Epoch  3/10: total=1.5614, vae=1.0862, dsb=0.4746, bio=0.0014
    Epoch  4/10: total=1.5604, vae=1.0850, dsb=0.4749, bio=0.0010
    Epoch  5/10: total=1.5550, vae=1.0852, dsb=0.4694, bio=0.0008
    Epoch  6/10: total=1.5507, vae=1.0858, dsb=0.4645, bio=0.0010
    Epoch  7/10: total=1.5630, vae=1.0860, dsb=0.4765, bio=0.0010
    Epoch  8/10: total=1.5621, vae=1.0860, dsb=0.4756, bio=0.0010
    Epoch  9/10: total=1.5516, vae=1.0852, dsb=0.4659, bio=0.0011
    Epoch 10/10: total=1.5497, vae=1.0853, dsb=0.4639, bio=0.0011

[Seed 51] Joint training (original) complete; models and history saved.

[Seed 51] Starting joint training (ablation)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=317.6499, vae=1.9642, dsb=315.6856, bio=0.0000
    Epoch  2/10: total=85.0117, vae=1.0823, dsb=83.9294, bio=0.0000
    Epoch  3/10: total=71.4240, vae=1.0806, dsb=70.3433, bio=0.0000
    Epoch  4/10: total=65.3078, vae=1.0799, dsb=64.2279, bio=0.0000
    Epoch  5/10: total=61.5451, vae=1.0785, dsb=60.4666, bio=0.0000
    Epoch  6/10: total=59.1412, vae=1.0790, dsb=58.0622, bio=0.0000
    Epoch  7/10: total=57.3769, vae=1.0784, dsb=56.2985, bio=0.0000
    Epoch  8/10: total=56.0715, vae=1.0785, dsb=54.9931, bio=0.0000
    Epoch  9/10: total=54.7315, vae=1.0790, dsb=53.6525, bio=0.0000
    Epoch 10/10: total=53.9718, vae=1.0792, dsb=52.8925, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=3.3538, vae=1.0790, dsb=2.2748, bio=0.0000
    Epoch  2/10: total=2.8410, vae=1.0785, dsb=1.7625, bio=0.0000
    Epoch  3/10: total=2.7194, vae=1.0793, dsb=1.6401, bio=0.0000
    Epoch  4/10: total=2.6245, vae=1.0784, dsb=1.5461, bio=0.0000
    Epoch  5/10: total=2.5529, vae=1.0785, dsb=1.4744, bio=0.0000
    Epoch  6/10: total=2.5320, vae=1.0783, dsb=1.4537, bio=0.0000
    Epoch  7/10: total=2.4758, vae=1.0786, dsb=1.3972, bio=0.0000
    Epoch  8/10: total=2.4770, vae=1.0787, dsb=1.3983, bio=0.0000
    Epoch  9/10: total=2.4668, vae=1.0787, dsb=1.3881, bio=0.0000
    Epoch 10/10: total=2.4768, vae=1.0795, dsb=1.3973, bio=0.0000

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=53.4441, vae=1.0782, dsb=52.3659, bio=0.0000
    Epoch  2/10: total=45.0999, vae=1.0782, dsb=44.0217, bio=0.0000
    Epoch  3/10: total=43.2043, vae=1.0780, dsb=42.1263, bio=0.0000
    Epoch  4/10: total=41.6964, vae=1.0782, dsb=40.6182, bio=0.0000
    Epoch  5/10: total=40.8880, vae=1.0784, dsb=39.8096, bio=0.0000
    Epoch  6/10: total=40.3852, vae=1.0785, dsb=39.3067, bio=0.0000
    Epoch  7/10: total=40.0845, vae=1.0784, dsb=39.0061, bio=0.0000
    Epoch  8/10: total=39.6929, vae=1.0783, dsb=38.6146, bio=0.0000
    Epoch  9/10: total=39.2346, vae=1.0786, dsb=38.1560, bio=0.0000
    Epoch 10/10: total=39.0596, vae=1.0786, dsb=37.9810, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=2.2063, vae=1.0795, dsb=1.1268, bio=0.0000
    Epoch  2/10: total=2.0523, vae=1.0781, dsb=0.9742, bio=0.0000
    Epoch  3/10: total=2.0438, vae=1.0784, dsb=0.9654, bio=0.0000
    Epoch  4/10: total=2.0152, vae=1.0775, dsb=0.9376, bio=0.0000
    Epoch  5/10: total=1.9796, vae=1.0778, dsb=0.9017, bio=0.0000
    Epoch  6/10: total=1.9824, vae=1.0781, dsb=0.9044, bio=0.0000
    Epoch  7/10: total=1.9659, vae=1.0789, dsb=0.8870, bio=0.0000
    Epoch  8/10: total=1.9477, vae=1.0776, dsb=0.8701, bio=0.0000
    Epoch  9/10: total=1.9327, vae=1.0787, dsb=0.8539, bio=0.0000
    Epoch 10/10: total=1.9501, vae=1.0779, dsb=0.8722, bio=0.0000

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=36.5689, vae=1.0778, dsb=35.4911, bio=0.0000
    Epoch  2/10: total=33.2478, vae=1.0766, dsb=32.1712, bio=0.0000
    Epoch  3/10: total=32.3267, vae=1.0783, dsb=31.2484, bio=0.0000
    Epoch  4/10: total=31.7701, vae=1.0792, dsb=30.6909, bio=0.0000
    Epoch  5/10: total=31.5352, vae=1.0781, dsb=30.4571, bio=0.0000
    Epoch  6/10: total=31.2981, vae=1.0781, dsb=30.2200, bio=0.0000
    Epoch  7/10: total=31.1323, vae=1.0778, dsb=30.0545, bio=0.0000
    Epoch  8/10: total=30.9875, vae=1.0783, dsb=29.9092, bio=0.0000
    Epoch  9/10: total=30.9069, vae=1.0781, dsb=29.8289, bio=0.0000
    Epoch 10/10: total=30.7683, vae=1.0787, dsb=29.6896, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.8309, vae=1.0784, dsb=0.7525, bio=0.0000
    Epoch  2/10: total=1.7598, vae=1.0783, dsb=0.6815, bio=0.0000
    Epoch  3/10: total=1.7588, vae=1.0779, dsb=0.6810, bio=0.0000
    Epoch  4/10: total=1.7473, vae=1.0776, dsb=0.6697, bio=0.0000
    Epoch  5/10: total=1.7418, vae=1.0781, dsb=0.6637, bio=0.0000
    Epoch  6/10: total=1.7263, vae=1.0782, dsb=0.6481, bio=0.0000
    Epoch  7/10: total=1.7132, vae=1.0777, dsb=0.6355, bio=0.0000
    Epoch  8/10: total=1.7168, vae=1.0775, dsb=0.6393, bio=0.0000
    Epoch  9/10: total=1.7041, vae=1.0783, dsb=0.6258, bio=0.0000
    Epoch 10/10: total=1.7129, vae=1.0777, dsb=0.6352, bio=0.0000

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=29.1444, vae=1.0779, dsb=28.0665, bio=0.0000
    Epoch  2/10: total=27.6846, vae=1.0779, dsb=26.6067, bio=0.0000
    Epoch  3/10: total=27.2325, vae=1.0791, dsb=26.1534, bio=0.0000
    Epoch  4/10: total=26.9765, vae=1.0784, dsb=25.8981, bio=0.0000
    Epoch  5/10: total=26.9370, vae=1.0786, dsb=25.8584, bio=0.0000
    Epoch  6/10: total=26.9401, vae=1.0784, dsb=25.8617, bio=0.0000
    Epoch  7/10: total=26.7350, vae=1.0777, dsb=25.6574, bio=0.0000
    Epoch  8/10: total=26.6043, vae=1.0785, dsb=25.5258, bio=0.0000
    Epoch  9/10: total=26.6653, vae=1.0775, dsb=25.5879, bio=0.0000
    Epoch 10/10: total=26.6591, vae=1.0788, dsb=25.5803, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.6308, vae=1.0783, dsb=0.5524, bio=0.0000
    Epoch  2/10: total=1.6063, vae=1.0786, dsb=0.5277, bio=0.0000
    Epoch  3/10: total=1.5950, vae=1.0789, dsb=0.5161, bio=0.0000
    Epoch  4/10: total=1.5872, vae=1.0776, dsb=0.5096, bio=0.0000
    Epoch  5/10: total=1.5826, vae=1.0785, dsb=0.5041, bio=0.0000
    Epoch  6/10: total=1.5757, vae=1.0781, dsb=0.4976, bio=0.0000
    Epoch  7/10: total=1.5805, vae=1.0780, dsb=0.5025, bio=0.0000
    Epoch  8/10: total=1.5813, vae=1.0778, dsb=0.5034, bio=0.0000
    Epoch  9/10: total=1.5709, vae=1.0788, dsb=0.4921, bio=0.0000
    Epoch 10/10: total=1.5852, vae=1.0779, dsb=0.5074, bio=0.0000

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=24.2811, vae=1.0783, dsb=23.2028, bio=0.0000
    Epoch  2/10: total=23.6827, vae=1.0778, dsb=22.6049, bio=0.0000
    Epoch  3/10: total=23.5092, vae=1.0780, dsb=22.4313, bio=0.0000
    Epoch  4/10: total=23.6154, vae=1.0780, dsb=22.5373, bio=0.0000
    Epoch  5/10: total=23.3804, vae=1.0779, dsb=22.3025, bio=0.0000
    Epoch  6/10: total=23.4824, vae=1.0777, dsb=22.4047, bio=0.0000
    Epoch  7/10: total=23.4744, vae=1.0794, dsb=22.3950, bio=0.0000
    Epoch  8/10: total=23.3465, vae=1.0786, dsb=22.2679, bio=0.0000
    Epoch  9/10: total=23.3798, vae=1.0781, dsb=22.3017, bio=0.0000
    Epoch 10/10: total=23.3186, vae=1.0774, dsb=22.2412, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.5165, vae=1.0791, dsb=0.4375, bio=0.0000
    Epoch  2/10: total=1.5088, vae=1.0780, dsb=0.4308, bio=0.0000
    Epoch  3/10: total=1.5055, vae=1.0784, dsb=0.4271, bio=0.0000
    Epoch  4/10: total=1.5049, vae=1.0775, dsb=0.4274, bio=0.0000
    Epoch  5/10: total=1.5001, vae=1.0776, dsb=0.4225, bio=0.0000
    Epoch  6/10: total=1.4959, vae=1.0782, dsb=0.4176, bio=0.0000
    Epoch  7/10: total=1.5080, vae=1.0785, dsb=0.4295, bio=0.0000
    Epoch  8/10: total=1.5070, vae=1.0785, dsb=0.4285, bio=0.0000
    Epoch  9/10: total=1.4971, vae=1.0777, dsb=0.4193, bio=0.0000
    Epoch 10/10: total=1.4955, vae=1.0778, dsb=0.4176, bio=0.0000

[Seed 51] Joint training (ablation) complete; models and history saved.

[Seed 51] Drift genes saved in /home/yyuan/ICB_TCE/iter_results/run_051

[Seed 51] run finished.

================================================================================
[Seed 52] Starting running whole pipeline...
================================================================================

[Seed 52] Starting VAE pre-training...

    Epoch [01/20], Beta: 0.000, Average Loss: 532.7151
    Epoch [02/20], Beta: 0.000, Average Loss: 303.6224
    Epoch [03/20], Beta: 0.000, Average Loss: 269.8182
    Epoch [04/20], Beta: 0.000, Average Loss: 249.8139
    Epoch [05/20], Beta: 0.100, Average Loss: 245.1619
    Epoch [06/20], Beta: 0.200, Average Loss: 244.8972
    Epoch [07/20], Beta: 0.300, Average Loss: 245.3540
    Epoch [08/20], Beta: 0.400, Average Loss: 246.2488
    Epoch [09/20], Beta: 0.500, Average Loss: 247.2860
    Epoch [10/20], Beta: 0.600, Average Loss: 248.4051
    Epoch [11/20], Beta: 0.700, Average Loss: 249.6004
    Epoch [12/20], Beta: 0.800, Average Loss: 250.8004
    Epoch [13/20], Beta: 0.900, Average Loss: 251.9603
    Epoch [14/20], Beta: 1.000, Average Loss: 253.5412
    Epoch [15/20], Beta: 1.000, Average Loss: 253.0775
    Epoch [16/20], Beta: 1.000, Average Loss: 252.6880
    Epoch [17/20], Beta: 1.000, Average Loss: 252.3444
    Epoch [18/20], Beta: 1.000, Average Loss: 252.0063
    Epoch [19/20], Beta: 1.000, Average Loss: 251.5950
    Epoch [20/20], Beta: 1.000, Average Loss: 251.4234

[Seed 52] VAE pre-training complete.

[Seed 52] Starting joint training (original)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=214.0197, vae=3.6951, dsb=194.3132, bio=32.0229
    Epoch  2/10: total=62.6414, vae=1.0951, dsb=61.4985, bio=0.0956
    Epoch  3/10: total=52.6097, vae=1.0907, dsb=51.4986, bio=0.0409
    Epoch  4/10: total=47.7843, vae=1.0894, dsb=46.6824, bio=0.0249
    Epoch  5/10: total=45.1770, vae=1.0887, dsb=44.0801, bio=0.0164
    Epoch  6/10: total=43.2239, vae=1.0882, dsb=42.1296, bio=0.0122
    Epoch  7/10: total=41.8218, vae=1.0883, dsb=40.7288, bio=0.0093
    Epoch  8/10: total=40.9824, vae=1.0870, dsb=39.8916, bio=0.0075
    Epoch  9/10: total=40.1378, vae=1.0871, dsb=39.0476, bio=0.0062
    Epoch 10/10: total=39.5375, vae=1.0866, dsb=38.4483, bio=0.0053

  [Backward Policy Training]
    Epoch  1/10: total=3.1264, vae=1.0887, dsb=2.0304, bio=0.0144
    Epoch  2/10: total=2.6192, vae=1.0858, dsb=1.5307, bio=0.0052
    Epoch  3/10: total=2.5424, vae=1.0859, dsb=1.4547, bio=0.0037
    Epoch  4/10: total=2.4308, vae=1.0856, dsb=1.3437, bio=0.0030
    Epoch  5/10: total=2.3948, vae=1.0862, dsb=1.3072, bio=0.0027
    Epoch  6/10: total=2.3584, vae=1.0858, dsb=1.2714, bio=0.0024
    Epoch  7/10: total=2.3137, vae=1.0854, dsb=1.2272, bio=0.0022
    Epoch  8/10: total=2.3135, vae=1.0848, dsb=1.2276, bio=0.0021
    Epoch  9/10: total=2.2600, vae=1.0848, dsb=1.1742, bio=0.0021
    Epoch 10/10: total=2.2901, vae=1.0844, dsb=1.2047, bio=0.0020

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=39.5559, vae=1.0878, dsb=38.4662, bio=0.0037
    Epoch  2/10: total=31.9874, vae=1.0854, dsb=30.9010, bio=0.0020
    Epoch  3/10: total=30.0741, vae=1.0861, dsb=28.9870, bio=0.0020
    Epoch  4/10: total=29.1749, vae=1.0852, dsb=28.0886, bio=0.0019
    Epoch  5/10: total=28.4399, vae=1.0857, dsb=27.3532, bio=0.0019
    Epoch  6/10: total=27.9609, vae=1.0855, dsb=26.8744, bio=0.0020
    Epoch  7/10: total=27.6860, vae=1.0848, dsb=26.6002, bio=0.0021
    Epoch  8/10: total=27.3198, vae=1.0847, dsb=26.2342, bio=0.0018
    Epoch  9/10: total=27.1821, vae=1.0852, dsb=26.0959, bio=0.0018
    Epoch 10/10: total=26.9842, vae=1.0845, dsb=25.8987, bio=0.0019

  [Backward Policy Training]
    Epoch  1/10: total=2.0739, vae=1.0860, dsb=0.9854, bio=0.0048
    Epoch  2/10: total=1.8729, vae=1.0842, dsb=0.7877, bio=0.0020
    Epoch  3/10: total=1.8560, vae=1.0839, dsb=0.7711, bio=0.0018
    Epoch  4/10: total=1.8304, vae=1.0840, dsb=0.7455, bio=0.0017
    Epoch  5/10: total=1.8310, vae=1.0844, dsb=0.7458, bio=0.0017
    Epoch  6/10: total=1.7821, vae=1.0838, dsb=0.6973, bio=0.0019
    Epoch  7/10: total=1.8037, vae=1.0835, dsb=0.7194, bio=0.0016
    Epoch  8/10: total=1.8018, vae=1.0831, dsb=0.7179, bio=0.0016
    Epoch  9/10: total=1.7816, vae=1.0833, dsb=0.6974, bio=0.0016
    Epoch 10/10: total=1.7735, vae=1.0829, dsb=0.6898, bio=0.0016

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=25.6987, vae=1.0869, dsb=24.6101, bio=0.0033
    Epoch  2/10: total=22.7529, vae=1.0848, dsb=21.6673, bio=0.0017
    Epoch  3/10: total=21.7191, vae=1.0849, dsb=20.6333, bio=0.0017
    Epoch  4/10: total=21.4879, vae=1.0848, dsb=20.4023, bio=0.0017
    Epoch  5/10: total=21.1885, vae=1.0848, dsb=20.1029, bio=0.0017
    Epoch  6/10: total=20.9486, vae=1.0837, dsb=19.8640, bio=0.0017
    Epoch  7/10: total=20.8549, vae=1.0845, dsb=19.7694, bio=0.0021
    Epoch  8/10: total=20.6436, vae=1.0836, dsb=19.5592, bio=0.0016
    Epoch  9/10: total=20.5788, vae=1.0844, dsb=19.4936, bio=0.0016
    Epoch 10/10: total=20.5071, vae=1.0849, dsb=19.4214, bio=0.0017

  [Backward Policy Training]
    Epoch  1/10: total=1.6704, vae=1.0851, dsb=0.5830, bio=0.0046
    Epoch  2/10: total=1.6176, vae=1.0833, dsb=0.5335, bio=0.0016
    Epoch  3/10: total=1.5980, vae=1.0833, dsb=0.5139, bio=0.0015
    Epoch  4/10: total=1.5770, vae=1.0830, dsb=0.4933, bio=0.0015
    Epoch  5/10: total=1.5796, vae=1.0833, dsb=0.4955, bio=0.0015
    Epoch  6/10: total=1.5689, vae=1.0828, dsb=0.4854, bio=0.0014
    Epoch  7/10: total=1.5640, vae=1.0832, dsb=0.4799, bio=0.0018
    Epoch  8/10: total=1.5556, vae=1.0824, dsb=0.4725, bio=0.0014
    Epoch  9/10: total=1.5584, vae=1.0830, dsb=0.4747, bio=0.0013
    Epoch 10/10: total=1.5464, vae=1.0825, dsb=0.4632, bio=0.0014

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=19.7807, vae=1.0858, dsb=18.6933, bio=0.0034
    Epoch  2/10: total=18.3152, vae=1.0850, dsb=17.2294, bio=0.0015
    Epoch  3/10: total=18.0317, vae=1.0836, dsb=16.9473, bio=0.0015
    Epoch  4/10: total=17.8663, vae=1.0835, dsb=16.7821, bio=0.0015
    Epoch  5/10: total=17.6942, vae=1.0835, dsb=16.6097, bio=0.0019
    Epoch  6/10: total=17.6026, vae=1.0833, dsb=16.5186, bio=0.0014
    Epoch  7/10: total=17.4666, vae=1.0839, dsb=16.3820, bio=0.0015
    Epoch  8/10: total=17.4423, vae=1.0844, dsb=16.3571, bio=0.0015
    Epoch  9/10: total=17.4333, vae=1.0839, dsb=16.3487, bio=0.0015
    Epoch 10/10: total=17.3521, vae=1.0848, dsb=16.2665, bio=0.0015

  [Backward Policy Training]
    Epoch  1/10: total=1.4863, vae=1.0837, dsb=0.3958, bio=0.0135
    Epoch  2/10: total=1.4670, vae=1.0825, dsb=0.3838, bio=0.0014
    Epoch  3/10: total=1.4483, vae=1.0834, dsb=0.3643, bio=0.0013
    Epoch  4/10: total=1.4399, vae=1.0831, dsb=0.3560, bio=0.0018
    Epoch  5/10: total=1.4416, vae=1.0831, dsb=0.3579, bio=0.0013
    Epoch  6/10: total=1.4298, vae=1.0822, dsb=0.3470, bio=0.0012
    Epoch  7/10: total=1.4182, vae=1.0826, dsb=0.3350, bio=0.0012
    Epoch  8/10: total=1.4394, vae=1.0832, dsb=0.3554, bio=0.0015
    Epoch  9/10: total=1.4118, vae=1.0825, dsb=0.3288, bio=0.0012
    Epoch 10/10: total=1.4246, vae=1.0832, dsb=0.3409, bio=0.0012

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=16.1030, vae=1.0847, dsb=15.0170, bio=0.0027
    Epoch  2/10: total=15.6139, vae=1.0851, dsb=14.5281, bio=0.0014
    Epoch  3/10: total=15.5729, vae=1.0848, dsb=14.4875, bio=0.0013
    Epoch  4/10: total=15.4790, vae=1.0837, dsb=14.3945, bio=0.0016
    Epoch  5/10: total=15.4664, vae=1.0835, dsb=14.3822, bio=0.0013
    Epoch  6/10: total=15.4022, vae=1.0833, dsb=14.3182, bio=0.0013
    Epoch  7/10: total=15.3702, vae=1.0831, dsb=14.2865, bio=0.0014
    Epoch  8/10: total=15.3950, vae=1.0833, dsb=14.3110, bio=0.0014
    Epoch  9/10: total=15.3788, vae=1.0838, dsb=14.2939, bio=0.0023
    Epoch 10/10: total=15.4027, vae=1.0832, dsb=14.3189, bio=0.0013

  [Backward Policy Training]
    Epoch  1/10: total=1.3685, vae=1.0832, dsb=0.2761, bio=0.0184
    Epoch  2/10: total=1.3541, vae=1.0826, dsb=0.2708, bio=0.0012
    Epoch  3/10: total=1.3589, vae=1.0827, dsb=0.2756, bio=0.0012
    Epoch  4/10: total=1.3513, vae=1.0840, dsb=0.2666, bio=0.0013
    Epoch  5/10: total=1.3459, vae=1.0835, dsb=0.2618, bio=0.0011
    Epoch  6/10: total=1.3454, vae=1.0831, dsb=0.2617, bio=0.0011
    Epoch  7/10: total=1.3508, vae=1.0823, dsb=0.2679, bio=0.0011
    Epoch  8/10: total=1.3463, vae=1.0823, dsb=0.2634, bio=0.0011
    Epoch  9/10: total=1.3458, vae=1.0825, dsb=0.2626, bio=0.0015
    Epoch 10/10: total=1.3422, vae=1.0823, dsb=0.2593, bio=0.0011

[Seed 52] Joint training (original) complete; models and history saved.

[Seed 52] Starting joint training (ablation)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=196.1546, vae=1.9799, dsb=194.1747, bio=0.0000
    Epoch  2/10: total=62.3595, vae=1.0782, dsb=61.2812, bio=0.0000
    Epoch  3/10: total=52.4504, vae=1.0763, dsb=51.3741, bio=0.0000
    Epoch  4/10: total=47.7039, vae=1.0759, dsb=46.6280, bio=0.0000
    Epoch  5/10: total=45.0959, vae=1.0757, dsb=44.0202, bio=0.0000
    Epoch  6/10: total=43.1464, vae=1.0756, dsb=42.0708, bio=0.0000
    Epoch  7/10: total=41.7382, vae=1.0760, dsb=40.6622, bio=0.0000
    Epoch  8/10: total=40.9023, vae=1.0750, dsb=39.8273, bio=0.0000
    Epoch  9/10: total=40.0627, vae=1.0753, dsb=38.9874, bio=0.0000
    Epoch 10/10: total=39.4650, vae=1.0751, dsb=38.3900, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=3.0534, vae=1.0759, dsb=1.9775, bio=0.0000
    Epoch  2/10: total=2.5669, vae=1.0750, dsb=1.4919, bio=0.0000
    Epoch  3/10: total=2.4931, vae=1.0755, dsb=1.4177, bio=0.0000
    Epoch  4/10: total=2.3839, vae=1.0754, dsb=1.3085, bio=0.0000
    Epoch  5/10: total=2.3493, vae=1.0762, dsb=1.2731, bio=0.0000
    Epoch  6/10: total=2.3151, vae=1.0760, dsb=1.2392, bio=0.0000
    Epoch  7/10: total=2.2703, vae=1.0757, dsb=1.1946, bio=0.0000
    Epoch  8/10: total=2.2704, vae=1.0752, dsb=1.1952, bio=0.0000
    Epoch  9/10: total=2.2180, vae=1.0753, dsb=1.1427, bio=0.0000
    Epoch 10/10: total=2.2470, vae=1.0750, dsb=1.1720, bio=0.0000

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=38.8024, vae=1.0758, dsb=37.7266, bio=0.0000
    Epoch  2/10: total=31.3011, vae=1.0745, dsb=30.2266, bio=0.0000
    Epoch  3/10: total=29.4438, vae=1.0754, dsb=28.3685, bio=0.0000
    Epoch  4/10: total=28.5702, vae=1.0746, dsb=27.4956, bio=0.0000
    Epoch  5/10: total=27.8524, vae=1.0752, dsb=26.7772, bio=0.0000
    Epoch  6/10: total=27.3870, vae=1.0751, dsb=26.3119, bio=0.0000
    Epoch  7/10: total=27.1072, vae=1.0745, dsb=26.0327, bio=0.0000
    Epoch  8/10: total=26.7367, vae=1.0745, dsb=25.6621, bio=0.0000
    Epoch  9/10: total=26.5943, vae=1.0751, dsb=25.5193, bio=0.0000
    Epoch 10/10: total=26.3911, vae=1.0744, dsb=25.3167, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=2.0147, vae=1.0755, dsb=0.9392, bio=0.0000
    Epoch  2/10: total=1.8249, vae=1.0750, dsb=0.7498, bio=0.0000
    Epoch  3/10: total=1.8081, vae=1.0750, dsb=0.7331, bio=0.0000
    Epoch  4/10: total=1.7820, vae=1.0752, dsb=0.7068, bio=0.0000
    Epoch  5/10: total=1.7828, vae=1.0756, dsb=0.7072, bio=0.0000
    Epoch  6/10: total=1.7356, vae=1.0750, dsb=0.6607, bio=0.0000
    Epoch  7/10: total=1.7562, vae=1.0749, dsb=0.6814, bio=0.0000
    Epoch  8/10: total=1.7545, vae=1.0745, dsb=0.6800, bio=0.0000
    Epoch  9/10: total=1.7353, vae=1.0747, dsb=0.6606, bio=0.0000
    Epoch 10/10: total=1.7271, vae=1.0744, dsb=0.6528, bio=0.0000

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=25.5696, vae=1.0755, dsb=24.4940, bio=0.0000
    Epoch  2/10: total=22.7491, vae=1.0746, dsb=21.6745, bio=0.0000
    Epoch  3/10: total=21.7838, vae=1.0750, dsb=20.7088, bio=0.0000
    Epoch  4/10: total=21.5615, vae=1.0750, dsb=20.4866, bio=0.0000
    Epoch  5/10: total=21.2875, vae=1.0751, dsb=20.2124, bio=0.0000
    Epoch  6/10: total=21.0680, vae=1.0741, dsb=19.9939, bio=0.0000
    Epoch  7/10: total=20.9835, vae=1.0748, dsb=19.9087, bio=0.0000
    Epoch  8/10: total=20.7882, vae=1.0740, dsb=19.7141, bio=0.0000
    Epoch  9/10: total=20.7436, vae=1.0749, dsb=19.6687, bio=0.0000
    Epoch 10/10: total=20.6627, vae=1.0755, dsb=19.5872, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.6300, vae=1.0753, dsb=0.5547, bio=0.0000
    Epoch  2/10: total=1.5813, vae=1.0748, dsb=0.5066, bio=0.0000
    Epoch  3/10: total=1.5629, vae=1.0749, dsb=0.4880, bio=0.0000
    Epoch  4/10: total=1.5435, vae=1.0747, dsb=0.4689, bio=0.0000
    Epoch  5/10: total=1.5462, vae=1.0750, dsb=0.4713, bio=0.0000
    Epoch  6/10: total=1.5368, vae=1.0745, dsb=0.4622, bio=0.0000
    Epoch  7/10: total=1.5320, vae=1.0748, dsb=0.4572, bio=0.0000
    Epoch  8/10: total=1.5250, vae=1.0743, dsb=0.4507, bio=0.0000
    Epoch  9/10: total=1.5276, vae=1.0749, dsb=0.4527, bio=0.0000
    Epoch 10/10: total=1.5157, vae=1.0744, dsb=0.4413, bio=0.0000

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=19.9222, vae=1.0747, dsb=18.8475, bio=0.0000
    Epoch  2/10: total=18.5546, vae=1.0755, dsb=17.4792, bio=0.0000
    Epoch  3/10: total=18.2808, vae=1.0742, dsb=17.2066, bio=0.0000
    Epoch  4/10: total=18.1330, vae=1.0742, dsb=17.0589, bio=0.0000
    Epoch  5/10: total=17.9680, vae=1.0742, dsb=16.8938, bio=0.0000
    Epoch  6/10: total=17.8825, vae=1.0741, dsb=16.8084, bio=0.0000
    Epoch  7/10: total=17.7813, vae=1.0748, dsb=16.7065, bio=0.0000
    Epoch  8/10: total=17.7481, vae=1.0753, dsb=16.6728, bio=0.0000
    Epoch  9/10: total=17.7317, vae=1.0748, dsb=16.6569, bio=0.0000
    Epoch 10/10: total=17.6579, vae=1.0758, dsb=16.5821, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.4545, vae=1.0744, dsb=0.3801, bio=0.0000
    Epoch  2/10: total=1.4425, vae=1.0744, dsb=0.3681, bio=0.0000
    Epoch  3/10: total=1.4248, vae=1.0753, dsb=0.3495, bio=0.0000
    Epoch  4/10: total=1.4162, vae=1.0749, dsb=0.3412, bio=0.0000
    Epoch  5/10: total=1.4185, vae=1.0752, dsb=0.3433, bio=0.0000
    Epoch  6/10: total=1.4074, vae=1.0743, dsb=0.3331, bio=0.0000
    Epoch  7/10: total=1.3960, vae=1.0747, dsb=0.3212, bio=0.0000
    Epoch  8/10: total=1.4162, vae=1.0753, dsb=0.3409, bio=0.0000
    Epoch  9/10: total=1.3897, vae=1.0747, dsb=0.3150, bio=0.0000
    Epoch 10/10: total=1.4022, vae=1.0754, dsb=0.3269, bio=0.0000

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=16.2070, vae=1.0741, dsb=15.1329, bio=0.0000
    Epoch  2/10: total=15.7722, vae=1.0757, dsb=14.6965, bio=0.0000
    Epoch  3/10: total=15.7349, vae=1.0757, dsb=14.6593, bio=0.0000
    Epoch  4/10: total=15.6636, vae=1.0747, dsb=14.5889, bio=0.0000
    Epoch  5/10: total=15.6330, vae=1.0747, dsb=14.5583, bio=0.0000
    Epoch  6/10: total=15.5731, vae=1.0746, dsb=14.4985, bio=0.0000
    Epoch  7/10: total=15.5432, vae=1.0744, dsb=14.4688, bio=0.0000
    Epoch  8/10: total=15.5607, vae=1.0747, dsb=14.4860, bio=0.0000
    Epoch  9/10: total=15.5589, vae=1.0751, dsb=14.4838, bio=0.0000
    Epoch 10/10: total=15.5771, vae=1.0747, dsb=14.5024, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.3371, vae=1.0744, dsb=0.2627, bio=0.0000
    Epoch  2/10: total=1.3324, vae=1.0748, dsb=0.2576, bio=0.0000
    Epoch  3/10: total=1.3374, vae=1.0749, dsb=0.2625, bio=0.0000
    Epoch  4/10: total=1.3299, vae=1.0763, dsb=0.2536, bio=0.0000
    Epoch  5/10: total=1.3249, vae=1.0758, dsb=0.2491, bio=0.0000
    Epoch  6/10: total=1.3245, vae=1.0755, dsb=0.2490, bio=0.0000
    Epoch  7/10: total=1.3299, vae=1.0747, dsb=0.2552, bio=0.0000
    Epoch  8/10: total=1.3254, vae=1.0747, dsb=0.2507, bio=0.0000
    Epoch  9/10: total=1.3251, vae=1.0749, dsb=0.2502, bio=0.0000
    Epoch 10/10: total=1.3215, vae=1.0748, dsb=0.2467, bio=0.0000

[Seed 52] Joint training (ablation) complete; models and history saved.

[Seed 52] Drift genes saved in /home/yyuan/ICB_TCE/iter_results/run_052

[Seed 52] run finished.

================================================================================
[Seed 53] Starting running whole pipeline...
================================================================================

[Seed 53] Starting VAE pre-training...

    Epoch [01/20], Beta: 0.000, Average Loss: 532.2725
    Epoch [02/20], Beta: 0.000, Average Loss: 308.6706
    Epoch [03/20], Beta: 0.000, Average Loss: 270.1375
    Epoch [04/20], Beta: 0.000, Average Loss: 248.9784
    Epoch [05/20], Beta: 0.100, Average Loss: 244.2368
    Epoch [06/20], Beta: 0.200, Average Loss: 243.6863
    Epoch [07/20], Beta: 0.300, Average Loss: 244.2220
    Epoch [08/20], Beta: 0.400, Average Loss: 245.1997
    Epoch [09/20], Beta: 0.500, Average Loss: 246.3662
    Epoch [10/20], Beta: 0.600, Average Loss: 247.6087
    Epoch [11/20], Beta: 0.700, Average Loss: 248.9390
    Epoch [12/20], Beta: 0.800, Average Loss: 250.2389
    Epoch [13/20], Beta: 0.900, Average Loss: 251.5200
    Epoch [14/20], Beta: 1.000, Average Loss: 253.1389
    Epoch [15/20], Beta: 1.000, Average Loss: 252.7191
    Epoch [16/20], Beta: 1.000, Average Loss: 252.3495
    Epoch [17/20], Beta: 1.000, Average Loss: 251.9697
    Epoch [18/20], Beta: 1.000, Average Loss: 251.6561
    Epoch [19/20], Beta: 1.000, Average Loss: 251.2516
    Epoch [20/20], Beta: 1.000, Average Loss: 251.0896

[Seed 53] VAE pre-training complete.

[Seed 53] Starting joint training (original)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=312.9846, vae=3.6441, dsb=284.9536, bio=48.7738
    Epoch  2/10: total=89.3136, vae=1.1055, dsb=88.1706, bio=0.0749
    Epoch  3/10: total=78.0729, vae=1.1011, dsb=76.9555, bio=0.0326
    Epoch  4/10: total=72.8229, vae=1.1002, dsb=71.7135, bio=0.0185
    Epoch  5/10: total=69.5584, vae=1.0990, dsb=68.4531, bio=0.0126
    Epoch  6/10: total=67.5519, vae=1.0995, dsb=66.4478, bio=0.0091
    Epoch  7/10: total=66.2019, vae=1.0979, dsb=65.1005, bio=0.0070
    Epoch  8/10: total=65.0142, vae=1.0983, dsb=63.9130, bio=0.0057
    Epoch  9/10: total=64.2284, vae=1.0982, dsb=63.1277, bio=0.0049
    Epoch 10/10: total=63.4708, vae=1.0975, dsb=62.3713, bio=0.0041

  [Backward Policy Training]
    Epoch  1/10: total=3.3334, vae=1.0987, dsb=2.2287, bio=0.0119
    Epoch  2/10: total=2.7775, vae=1.0961, dsb=1.6793, bio=0.0042
    Epoch  3/10: total=2.6247, vae=1.0968, dsb=1.5264, bio=0.0031
    Epoch  4/10: total=2.5783, vae=1.0957, dsb=1.4812, bio=0.0026
    Epoch  5/10: total=2.5520, vae=1.0960, dsb=1.4549, bio=0.0024
    Epoch  6/10: total=2.5022, vae=1.0950, dsb=1.4061, bio=0.0022
    Epoch  7/10: total=2.4931, vae=1.0945, dsb=1.3976, bio=0.0021
    Epoch  8/10: total=2.4250, vae=1.0954, dsb=1.3286, bio=0.0020
    Epoch  9/10: total=2.4473, vae=1.0942, dsb=1.3521, bio=0.0019
    Epoch 10/10: total=2.3976, vae=1.0953, dsb=1.3014, bio=0.0019

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=59.8648, vae=1.0980, dsb=58.7649, bio=0.0038
    Epoch  2/10: total=53.6990, vae=1.0964, dsb=52.6017, bio=0.0020
    Epoch  3/10: total=52.2325, vae=1.0960, dsb=51.1356, bio=0.0018
    Epoch  4/10: total=51.0587, vae=1.0970, dsb=49.9608, bio=0.0019
    Epoch  5/10: total=50.4626, vae=1.0961, dsb=49.3656, bio=0.0019
    Epoch  6/10: total=50.1782, vae=1.0963, dsb=49.0811, bio=0.0016
    Epoch  7/10: total=49.5671, vae=1.0955, dsb=48.4707, bio=0.0018
    Epoch  8/10: total=49.7151, vae=1.0947, dsb=48.6194, bio=0.0019
    Epoch  9/10: total=49.2418, vae=1.0957, dsb=48.1452, bio=0.0019
    Epoch 10/10: total=48.9659, vae=1.0952, dsb=47.8698, bio=0.0018

  [Backward Policy Training]
    Epoch  1/10: total=2.2031, vae=1.0959, dsb=1.1045, bio=0.0054
    Epoch  2/10: total=2.0385, vae=1.0944, dsb=0.9432, bio=0.0019
    Epoch  3/10: total=1.9971, vae=1.0938, dsb=0.9024, bio=0.0018
    Epoch  4/10: total=1.9871, vae=1.0942, dsb=0.8921, bio=0.0017
    Epoch  5/10: total=1.9887, vae=1.0936, dsb=0.8943, bio=0.0016
    Epoch  6/10: total=1.9609, vae=1.0944, dsb=0.8657, bio=0.0016
    Epoch  7/10: total=1.9548, vae=1.0940, dsb=0.8600, bio=0.0016
    Epoch  8/10: total=1.9530, vae=1.0934, dsb=0.8588, bio=0.0016
    Epoch  9/10: total=1.9271, vae=1.0933, dsb=0.8330, bio=0.0015
    Epoch 10/10: total=1.9421, vae=1.0933, dsb=0.8481, bio=0.0015

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=44.8123, vae=1.0978, dsb=43.7128, bio=0.0035
    Epoch  2/10: total=42.1100, vae=1.0953, dsb=41.0139, bio=0.0016
    Epoch  3/10: total=41.4939, vae=1.0946, dsb=40.3986, bio=0.0016
    Epoch  4/10: total=41.3434, vae=1.0940, dsb=40.2487, bio=0.0015
    Epoch  5/10: total=41.0660, vae=1.0945, dsb=39.9705, bio=0.0018
    Epoch  6/10: total=40.7189, vae=1.0948, dsb=39.6234, bio=0.0016
    Epoch  7/10: total=40.7439, vae=1.0947, dsb=39.6483, bio=0.0016
    Epoch  8/10: total=40.6060, vae=1.0943, dsb=39.5109, bio=0.0017
    Epoch  9/10: total=40.3493, vae=1.0940, dsb=39.2544, bio=0.0016
    Epoch 10/10: total=40.2636, vae=1.0946, dsb=39.1683, bio=0.0015

  [Backward Policy Training]
    Epoch  1/10: total=1.8136, vae=1.0946, dsb=0.7146, bio=0.0088
    Epoch  2/10: total=1.7773, vae=1.0925, dsb=0.6841, bio=0.0015
    Epoch  3/10: total=1.7534, vae=1.0936, dsb=0.6592, bio=0.0014
    Epoch  4/10: total=1.7520, vae=1.0942, dsb=0.6570, bio=0.0016
    Epoch  5/10: total=1.7333, vae=1.0928, dsb=0.6398, bio=0.0013
    Epoch  6/10: total=1.7146, vae=1.0938, dsb=0.6201, bio=0.0013
    Epoch  7/10: total=1.7135, vae=1.0927, dsb=0.6202, bio=0.0013
    Epoch  8/10: total=1.7133, vae=1.0933, dsb=0.6194, bio=0.0013
    Epoch  9/10: total=1.7210, vae=1.0938, dsb=0.6266, bio=0.0012
    Epoch 10/10: total=1.6864, vae=1.0934, dsb=0.5913, bio=0.0034

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=36.6085, vae=1.0965, dsb=35.5107, bio=0.0026
    Epoch  2/10: total=35.4408, vae=1.0949, dsb=34.3453, bio=0.0013
    Epoch  3/10: total=35.2874, vae=1.0943, dsb=34.1923, bio=0.0014
    Epoch  4/10: total=35.0883, vae=1.0941, dsb=33.9935, bio=0.0014
    Epoch  5/10: total=34.8783, vae=1.0947, dsb=33.7828, bio=0.0015
    Epoch  6/10: total=34.8210, vae=1.0940, dsb=33.7262, bio=0.0014
    Epoch  7/10: total=34.7441, vae=1.0930, dsb=33.6505, bio=0.0013
    Epoch  8/10: total=34.9303, vae=1.0932, dsb=33.8364, bio=0.0013
    Epoch  9/10: total=34.9283, vae=1.0938, dsb=33.8339, bio=0.0013
    Epoch 10/10: total=34.7280, vae=1.0942, dsb=33.6330, bio=0.0016

  [Backward Policy Training]
    Epoch  1/10: total=1.6590, vae=1.0943, dsb=0.5363, bio=0.0568
    Epoch  2/10: total=1.6019, vae=1.0935, dsb=0.5078, bio=0.0013
    Epoch  3/10: total=1.6047, vae=1.0930, dsb=0.5111, bio=0.0012
    Epoch  4/10: total=1.5987, vae=1.0934, dsb=0.5047, bio=0.0011
    Epoch  5/10: total=1.6043, vae=1.0937, dsb=0.5101, bio=0.0011
    Epoch  6/10: total=1.5930, vae=1.0927, dsb=0.4996, bio=0.0014
    Epoch  7/10: total=1.5915, vae=1.0928, dsb=0.4981, bio=0.0011
    Epoch  8/10: total=1.5842, vae=1.0924, dsb=0.4913, bio=0.0011
    Epoch  9/10: total=1.5983, vae=1.0929, dsb=0.5049, bio=0.0011
    Epoch 10/10: total=1.5908, vae=1.0932, dsb=0.4971, bio=0.0011

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=30.4706, vae=1.0957, dsb=29.3736, bio=0.0025
    Epoch  2/10: total=30.2647, vae=1.0945, dsb=29.1696, bio=0.0013
    Epoch  3/10: total=30.1076, vae=1.0939, dsb=29.0130, bio=0.0012
    Epoch  4/10: total=30.0728, vae=1.0935, dsb=28.9788, bio=0.0011
    Epoch  5/10: total=29.9625, vae=1.0930, dsb=28.8689, bio=0.0011
    Epoch  6/10: total=30.0694, vae=1.0933, dsb=28.9755, bio=0.0011
    Epoch  7/10: total=29.9462, vae=1.0933, dsb=28.8523, bio=0.0012
    Epoch  8/10: total=29.8706, vae=1.0921, dsb=28.7782, bio=0.0007
    Epoch  9/10: total=29.8828, vae=1.0926, dsb=28.7896, bio=0.0011
    Epoch 10/10: total=29.7356, vae=1.0926, dsb=28.6425, bio=0.0011

  [Backward Policy Training]
    Epoch  1/10: total=1.6054, vae=1.0942, dsb=0.4479, bio=0.1266
    Epoch  2/10: total=1.5337, vae=1.0924, dsb=0.4406, bio=0.0012
    Epoch  3/10: total=1.5195, vae=1.0922, dsb=0.4267, bio=0.0011
    Epoch  4/10: total=1.5250, vae=1.0929, dsb=0.4317, bio=0.0009
    Epoch  5/10: total=1.5091, vae=1.0921, dsb=0.4164, bio=0.0011
    Epoch  6/10: total=1.5118, vae=1.0922, dsb=0.4192, bio=0.0010
    Epoch  7/10: total=1.5106, vae=1.0921, dsb=0.4180, bio=0.0010
    Epoch  8/10: total=1.5152, vae=1.0924, dsb=0.4223, bio=0.0010
    Epoch  9/10: total=1.5177, vae=1.0925, dsb=0.4247, bio=0.0010
    Epoch 10/10: total=1.5083, vae=1.0924, dsb=0.4156, bio=0.0008

[Seed 53] Joint training (original) complete; models and history saved.

[Seed 53] Starting joint training (ablation)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=286.6679, vae=1.9810, dsb=284.6869, bio=0.0000
    Epoch  2/10: total=88.9496, vae=1.0888, dsb=87.8608, bio=0.0000
    Epoch  3/10: total=77.7889, vae=1.0871, dsb=76.7019, bio=0.0000
    Epoch  4/10: total=72.5036, vae=1.0870, dsb=71.4166, bio=0.0000
    Epoch  5/10: total=69.3073, vae=1.0862, dsb=68.2211, bio=0.0000
    Epoch  6/10: total=67.3224, vae=1.0869, dsb=66.2355, bio=0.0000
    Epoch  7/10: total=66.0056, vae=1.0856, dsb=64.9200, bio=0.0000
    Epoch  8/10: total=64.8290, vae=1.0863, dsb=63.7427, bio=0.0000
    Epoch  9/10: total=64.0501, vae=1.0863, dsb=62.9637, bio=0.0000
    Epoch 10/10: total=63.2878, vae=1.0860, dsb=62.2019, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=3.2410, vae=1.0861, dsb=2.1549, bio=0.0000
    Epoch  2/10: total=2.7072, vae=1.0852, dsb=1.6220, bio=0.0000
    Epoch  3/10: total=2.5598, vae=1.0863, dsb=1.4735, bio=0.0000
    Epoch  4/10: total=2.5154, vae=1.0855, dsb=1.4298, bio=0.0000
    Epoch  5/10: total=2.4901, vae=1.0861, dsb=1.4040, bio=0.0000
    Epoch  6/10: total=2.4413, vae=1.0853, dsb=1.3560, bio=0.0000
    Epoch  7/10: total=2.4330, vae=1.0848, dsb=1.3481, bio=0.0000
    Epoch  8/10: total=2.3670, vae=1.0858, dsb=1.2812, bio=0.0000
    Epoch  9/10: total=2.3875, vae=1.0848, dsb=1.3028, bio=0.0000
    Epoch 10/10: total=2.3404, vae=1.0859, dsb=1.2545, bio=0.0000

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=59.1894, vae=1.0858, dsb=58.1035, bio=0.0000
    Epoch  2/10: total=52.9732, vae=1.0855, dsb=51.8876, bio=0.0000
    Epoch  3/10: total=51.5636, vae=1.0854, dsb=50.4782, bio=0.0000
    Epoch  4/10: total=50.4825, vae=1.0865, dsb=49.3959, bio=0.0000
    Epoch  5/10: total=49.9096, vae=1.0857, dsb=48.8239, bio=0.0000
    Epoch  6/10: total=49.6925, vae=1.0859, dsb=48.6066, bio=0.0000
    Epoch  7/10: total=49.0824, vae=1.0854, dsb=47.9970, bio=0.0000
    Epoch  8/10: total=49.2042, vae=1.0847, dsb=48.1194, bio=0.0000
    Epoch  9/10: total=48.7754, vae=1.0858, dsb=47.6897, bio=0.0000
    Epoch 10/10: total=48.5191, vae=1.0853, dsb=47.4337, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=2.1169, vae=1.0857, dsb=1.0312, bio=0.0000
    Epoch  2/10: total=1.9667, vae=1.0854, dsb=0.8813, bio=0.0000
    Epoch  3/10: total=1.9271, vae=1.0850, dsb=0.8421, bio=0.0000
    Epoch  4/10: total=1.9191, vae=1.0855, dsb=0.8336, bio=0.0000
    Epoch  5/10: total=1.9210, vae=1.0850, dsb=0.8361, bio=0.0000
    Epoch  6/10: total=1.8958, vae=1.0858, dsb=0.8100, bio=0.0000
    Epoch  7/10: total=1.8909, vae=1.0854, dsb=0.8055, bio=0.0000
    Epoch  8/10: total=1.8901, vae=1.0848, dsb=0.8053, bio=0.0000
    Epoch  9/10: total=1.8661, vae=1.0850, dsb=0.7811, bio=0.0000
    Epoch 10/10: total=1.8812, vae=1.0849, dsb=0.7963, bio=0.0000

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=43.7628, vae=1.0860, dsb=42.6768, bio=0.0000
    Epoch  2/10: total=41.2303, vae=1.0856, dsb=40.1448, bio=0.0000
    Epoch  3/10: total=40.6806, vae=1.0850, dsb=39.5956, bio=0.0000
    Epoch  4/10: total=40.5301, vae=1.0846, dsb=39.4455, bio=0.0000
    Epoch  5/10: total=40.2860, vae=1.0852, dsb=39.2008, bio=0.0000
    Epoch  6/10: total=39.9792, vae=1.0856, dsb=38.8935, bio=0.0000
    Epoch  7/10: total=40.0187, vae=1.0856, dsb=38.9330, bio=0.0000
    Epoch  8/10: total=39.8633, vae=1.0853, dsb=38.7780, bio=0.0000
    Epoch  9/10: total=39.6135, vae=1.0850, dsb=38.5285, bio=0.0000
    Epoch 10/10: total=39.5403, vae=1.0857, dsb=38.4546, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.7459, vae=1.0853, dsb=0.6606, bio=0.0000
    Epoch  2/10: total=1.7165, vae=1.0842, dsb=0.6323, bio=0.0000
    Epoch  3/10: total=1.6952, vae=1.0854, dsb=0.6099, bio=0.0000
    Epoch  4/10: total=1.6943, vae=1.0861, dsb=0.6082, bio=0.0000
    Epoch  5/10: total=1.6773, vae=1.0847, dsb=0.5926, bio=0.0000
    Epoch  6/10: total=1.6601, vae=1.0858, dsb=0.5743, bio=0.0000
    Epoch  7/10: total=1.6595, vae=1.0847, dsb=0.5748, bio=0.0000
    Epoch  8/10: total=1.6599, vae=1.0853, dsb=0.5746, bio=0.0000
    Epoch  9/10: total=1.6676, vae=1.0859, dsb=0.5817, bio=0.0000
    Epoch 10/10: total=1.6340, vae=1.0856, dsb=0.5484, bio=0.0000

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=35.8171, vae=1.0858, dsb=34.7313, bio=0.0000
    Epoch  2/10: total=34.7615, vae=1.0857, dsb=33.6758, bio=0.0000
    Epoch  3/10: total=34.6039, vae=1.0855, dsb=33.5184, bio=0.0000
    Epoch  4/10: total=34.3920, vae=1.0853, dsb=33.3067, bio=0.0000
    Epoch  5/10: total=34.2283, vae=1.0860, dsb=33.1423, bio=0.0000
    Epoch  6/10: total=34.1313, vae=1.0855, dsb=33.0458, bio=0.0000
    Epoch  7/10: total=34.0765, vae=1.0845, dsb=32.9921, bio=0.0000
    Epoch  8/10: total=34.2594, vae=1.0848, dsb=33.1746, bio=0.0000
    Epoch  9/10: total=34.2477, vae=1.0855, dsb=33.1622, bio=0.0000
    Epoch 10/10: total=34.0460, vae=1.0859, dsb=32.9602, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.5725, vae=1.0853, dsb=0.4872, bio=0.0000
    Epoch  2/10: total=1.5458, vae=1.0855, dsb=0.4604, bio=0.0000
    Epoch  3/10: total=1.5496, vae=1.0852, dsb=0.4644, bio=0.0000
    Epoch  4/10: total=1.5441, vae=1.0857, dsb=0.4584, bio=0.0000
    Epoch  5/10: total=1.5500, vae=1.0860, dsb=0.4640, bio=0.0000
    Epoch  6/10: total=1.5395, vae=1.0850, dsb=0.4545, bio=0.0000
    Epoch  7/10: total=1.5382, vae=1.0853, dsb=0.4529, bio=0.0000
    Epoch  8/10: total=1.5317, vae=1.0849, dsb=0.4468, bio=0.0000
    Epoch  9/10: total=1.5448, vae=1.0854, dsb=0.4594, bio=0.0000
    Epoch 10/10: total=1.5380, vae=1.0858, dsb=0.4522, bio=0.0000

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=29.1875, vae=1.0856, dsb=28.1020, bio=0.0000
    Epoch  2/10: total=28.9974, vae=1.0858, dsb=27.9117, bio=0.0000
    Epoch  3/10: total=28.8060, vae=1.0855, dsb=27.7205, bio=0.0000
    Epoch  4/10: total=28.8089, vae=1.0853, dsb=27.7237, bio=0.0000
    Epoch  5/10: total=28.6838, vae=1.0849, dsb=27.5989, bio=0.0000
    Epoch  6/10: total=28.8313, vae=1.0853, dsb=27.7460, bio=0.0000
    Epoch  7/10: total=28.7042, vae=1.0854, dsb=27.6188, bio=0.0000
    Epoch  8/10: total=28.6474, vae=1.0842, dsb=27.5632, bio=0.0000
    Epoch  9/10: total=28.6551, vae=1.0849, dsb=27.5702, bio=0.0000
    Epoch 10/10: total=28.4835, vae=1.0849, dsb=27.3986, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.4882, vae=1.0853, dsb=0.4029, bio=0.0000
    Epoch  2/10: total=1.4821, vae=1.0848, dsb=0.3972, bio=0.0000
    Epoch  3/10: total=1.4696, vae=1.0848, dsb=0.3848, bio=0.0000
    Epoch  4/10: total=1.4753, vae=1.0855, dsb=0.3898, bio=0.0000
    Epoch  5/10: total=1.4602, vae=1.0849, dsb=0.3753, bio=0.0000
    Epoch  6/10: total=1.4633, vae=1.0850, dsb=0.3783, bio=0.0000
    Epoch  7/10: total=1.4620, vae=1.0851, dsb=0.3770, bio=0.0000
    Epoch  8/10: total=1.4667, vae=1.0854, dsb=0.3812, bio=0.0000
    Epoch  9/10: total=1.4692, vae=1.0856, dsb=0.3836, bio=0.0000
    Epoch 10/10: total=1.4604, vae=1.0855, dsb=0.3749, bio=0.0000

[Seed 53] Joint training (ablation) complete; models and history saved.

[Seed 53] Drift genes saved in /home/yyuan/ICB_TCE/iter_results/run_053

[Seed 53] run finished.

================================================================================
[Seed 54] Starting running whole pipeline...
================================================================================

[Seed 54] Starting VAE pre-training...

    Epoch [01/20], Beta: 0.000, Average Loss: 532.3365
    Epoch [02/20], Beta: 0.000, Average Loss: 302.6060
    Epoch [03/20], Beta: 0.000, Average Loss: 268.4784
    Epoch [04/20], Beta: 0.000, Average Loss: 250.5542
    Epoch [05/20], Beta: 0.100, Average Loss: 245.3409
    Epoch [06/20], Beta: 0.200, Average Loss: 244.1151
    Epoch [07/20], Beta: 0.300, Average Loss: 244.7600
    Epoch [08/20], Beta: 0.400, Average Loss: 245.8539
    Epoch [09/20], Beta: 0.500, Average Loss: 247.0686
    Epoch [10/20], Beta: 0.600, Average Loss: 248.2992
    Epoch [11/20], Beta: 0.700, Average Loss: 249.5876
    Epoch [12/20], Beta: 0.800, Average Loss: 250.8391
    Epoch [13/20], Beta: 0.900, Average Loss: 252.0914
    Epoch [14/20], Beta: 1.000, Average Loss: 253.6881
    Epoch [15/20], Beta: 1.000, Average Loss: 253.2399
    Epoch [16/20], Beta: 1.000, Average Loss: 252.8616
    Epoch [17/20], Beta: 1.000, Average Loss: 252.4790
    Epoch [18/20], Beta: 1.000, Average Loss: 252.1203
    Epoch [19/20], Beta: 1.000, Average Loss: 251.7182
    Epoch [20/20], Beta: 1.000, Average Loss: 251.5926

[Seed 54] VAE pre-training complete.

[Seed 54] Starting joint training (original)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=471.1729, vae=3.9549, dsb=428.3269, bio=77.7823
    Epoch  2/10: total=117.4528, vae=1.1155, dsb=116.3051, bio=0.0644
    Epoch  3/10: total=106.5076, vae=1.1129, dsb=105.3802, bio=0.0290
    Epoch  4/10: total=101.3915, vae=1.1108, dsb=100.2719, bio=0.0175
    Epoch  5/10: total=99.5848, vae=1.1085, dsb=98.4703, bio=0.0120
    Epoch  6/10: total=96.9529, vae=1.1082, dsb=95.8402, bio=0.0090
    Epoch  7/10: total=96.1198, vae=1.1088, dsb=95.0074, bio=0.0071
    Epoch  8/10: total=95.0980, vae=1.1087, dsb=93.9863, bio=0.0059
    Epoch  9/10: total=94.1729, vae=1.1074, dsb=93.0630, bio=0.0050
    Epoch 10/10: total=92.8259, vae=1.1077, dsb=91.7157, bio=0.0049

  [Backward Policy Training]
    Epoch  1/10: total=3.4139, vae=1.1092, dsb=2.2980, bio=0.0133
    Epoch  2/10: total=2.9119, vae=1.1072, dsb=1.8022, bio=0.0051
    Epoch  3/10: total=2.7504, vae=1.1059, dsb=1.6426, bio=0.0037
    Epoch  4/10: total=2.6899, vae=1.1067, dsb=1.5816, bio=0.0031
    Epoch  5/10: total=2.6527, vae=1.1071, dsb=1.5442, bio=0.0027
    Epoch  6/10: total=2.6214, vae=1.1053, dsb=1.5147, bio=0.0027
    Epoch  7/10: total=2.5634, vae=1.1070, dsb=1.4552, bio=0.0024
    Epoch  8/10: total=2.5700, vae=1.1068, dsb=1.4620, bio=0.0023
    Epoch  9/10: total=2.5142, vae=1.1054, dsb=1.4077, bio=0.0022
    Epoch 10/10: total=2.5164, vae=1.1049, dsb=1.4105, bio=0.0020

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=81.4158, vae=1.1083, dsb=80.3055, bio=0.0039
    Epoch  2/10: total=75.6805, vae=1.1074, dsb=74.5720, bio=0.0021
    Epoch  3/10: total=74.0398, vae=1.1062, dsb=72.9325, bio=0.0020
    Epoch  4/10: total=72.8577, vae=1.1075, dsb=71.7493, bio=0.0020
    Epoch  5/10: total=73.0736, vae=1.1072, dsb=71.9654, bio=0.0020
    Epoch  6/10: total=72.3005, vae=1.1058, dsb=71.1937, bio=0.0021
    Epoch  7/10: total=72.1764, vae=1.1066, dsb=71.0685, bio=0.0027
    Epoch  8/10: total=71.9129, vae=1.1056, dsb=70.8063, bio=0.0019
    Epoch  9/10: total=72.0922, vae=1.1057, dsb=70.9855, bio=0.0020
    Epoch 10/10: total=71.4227, vae=1.1058, dsb=70.3158, bio=0.0020

  [Backward Policy Training]
    Epoch  1/10: total=2.2345, vae=1.1062, dsb=1.1253, bio=0.0060
    Epoch  2/10: total=2.0989, vae=1.1046, dsb=0.9932, bio=0.0020
    Epoch  3/10: total=2.0856, vae=1.1046, dsb=0.9801, bio=0.0018
    Epoch  4/10: total=2.0676, vae=1.1050, dsb=0.9616, bio=0.0022
    Epoch  5/10: total=2.0139, vae=1.1049, dsb=0.9082, bio=0.0018
    Epoch  6/10: total=1.9930, vae=1.1044, dsb=0.8877, bio=0.0018
    Epoch  7/10: total=1.9951, vae=1.1052, dsb=0.8890, bio=0.0017
    Epoch  8/10: total=1.9954, vae=1.1042, dsb=0.8903, bio=0.0018
    Epoch  9/10: total=1.9854, vae=1.1049, dsb=0.8796, bio=0.0017
    Epoch 10/10: total=1.9722, vae=1.1040, dsb=0.8673, bio=0.0018

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=69.6056, vae=1.1073, dsb=68.4963, bio=0.0039
    Epoch  2/10: total=67.2114, vae=1.1060, dsb=66.1045, bio=0.0018
    Epoch  3/10: total=66.6766, vae=1.1045, dsb=65.5712, bio=0.0018
    Epoch  4/10: total=66.4240, vae=1.1055, dsb=65.3176, bio=0.0020
    Epoch  5/10: total=66.6704, vae=1.1054, dsb=65.5641, bio=0.0018
    Epoch  6/10: total=66.5179, vae=1.1053, dsb=65.4118, bio=0.0017
    Epoch  7/10: total=65.9736, vae=1.1049, dsb=64.8678, bio=0.0018
    Epoch  8/10: total=65.6554, vae=1.1044, dsb=64.5500, bio=0.0018
    Epoch  9/10: total=65.9197, vae=1.1043, dsb=64.8143, bio=0.0022
    Epoch 10/10: total=65.6852, vae=1.1042, dsb=64.5801, bio=0.0018

  [Backward Policy Training]
    Epoch  1/10: total=1.8596, vae=1.1050, dsb=0.7505, bio=0.0081
    Epoch  2/10: total=1.7800, vae=1.1043, dsb=0.6748, bio=0.0017
    Epoch  3/10: total=1.7628, vae=1.1042, dsb=0.6579, bio=0.0016
    Epoch  4/10: total=1.7567, vae=1.1033, dsb=0.6525, bio=0.0017
    Epoch  5/10: total=1.7704, vae=1.1042, dsb=0.6655, bio=0.0014
    Epoch  6/10: total=1.7519, vae=1.1040, dsb=0.6471, bio=0.0017
    Epoch  7/10: total=1.7379, vae=1.1031, dsb=0.6340, bio=0.0016
    Epoch  8/10: total=1.7420, vae=1.1032, dsb=0.6380, bio=0.0016
    Epoch  9/10: total=1.7400, vae=1.1038, dsb=0.6354, bio=0.0015
    Epoch 10/10: total=1.7305, vae=1.1031, dsb=0.6262, bio=0.0023

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=55.5483, vae=1.1053, dsb=54.4415, bio=0.0029
    Epoch  2/10: total=54.8729, vae=1.1048, dsb=53.7673, bio=0.0016
    Epoch  3/10: total=54.5587, vae=1.1043, dsb=53.4535, bio=0.0017
    Epoch  4/10: total=54.2223, vae=1.1045, dsb=53.1169, bio=0.0017
    Epoch  5/10: total=53.9640, vae=1.1046, dsb=52.8586, bio=0.0017
    Epoch  6/10: total=54.0229, vae=1.1042, dsb=52.9178, bio=0.0017
    Epoch  7/10: total=53.8627, vae=1.1035, dsb=52.7583, bio=0.0017
    Epoch  8/10: total=54.0467, vae=1.1055, dsb=52.9402, bio=0.0019
    Epoch  9/10: total=53.9276, vae=1.1040, dsb=52.8228, bio=0.0017
    Epoch 10/10: total=53.7879, vae=1.1044, dsb=52.6826, bio=0.0016

  [Backward Policy Training]
    Epoch  1/10: total=1.6854, vae=1.1052, dsb=0.5717, bio=0.0170
    Epoch  2/10: total=1.6352, vae=1.1034, dsb=0.5310, bio=0.0017
    Epoch  3/10: total=1.6414, vae=1.1029, dsb=0.5378, bio=0.0015
    Epoch  4/10: total=1.6443, vae=1.1039, dsb=0.5397, bio=0.0014
    Epoch  5/10: total=1.6197, vae=1.1034, dsb=0.5156, bio=0.0014
    Epoch  6/10: total=1.6179, vae=1.1032, dsb=0.5140, bio=0.0015
    Epoch  7/10: total=1.6115, vae=1.1032, dsb=0.5074, bio=0.0016
    Epoch  8/10: total=1.6196, vae=1.1024, dsb=0.5164, bio=0.0014
    Epoch  9/10: total=1.6015, vae=1.1034, dsb=0.4974, bio=0.0013
    Epoch 10/10: total=1.6153, vae=1.1026, dsb=0.5120, bio=0.0014

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=47.2630, vae=1.1064, dsb=46.1552, bio=0.0030
    Epoch  2/10: total=46.4951, vae=1.1045, dsb=45.3899, bio=0.0015
    Epoch  3/10: total=46.4620, vae=1.1046, dsb=45.3566, bio=0.0016
    Epoch  4/10: total=46.1537, vae=1.1031, dsb=45.0497, bio=0.0017
    Epoch  5/10: total=46.2586, vae=1.1047, dsb=45.1531, bio=0.0016
    Epoch  6/10: total=46.0649, vae=1.1034, dsb=44.9607, bio=0.0015
    Epoch  7/10: total=46.1393, vae=1.1040, dsb=45.0346, bio=0.0015
    Epoch  8/10: total=46.1007, vae=1.1039, dsb=44.9960, bio=0.0015
    Epoch  9/10: total=46.2070, vae=1.1034, dsb=45.1028, bio=0.0016
    Epoch 10/10: total=46.0257, vae=1.1041, dsb=44.9208, bio=0.0016

  [Backward Policy Training]
    Epoch  1/10: total=1.5863, vae=1.1043, dsb=0.4597, bio=0.0446
    Epoch  2/10: total=1.5525, vae=1.1036, dsb=0.4481, bio=0.0014
    Epoch  3/10: total=1.5472, vae=1.1038, dsb=0.4428, bio=0.0013
    Epoch  4/10: total=1.5494, vae=1.1035, dsb=0.4452, bio=0.0013
    Epoch  5/10: total=1.5514, vae=1.1034, dsb=0.4474, bio=0.0013
    Epoch  6/10: total=1.5530, vae=1.1031, dsb=0.4492, bio=0.0014
    Epoch  7/10: total=1.5468, vae=1.1035, dsb=0.4427, bio=0.0012
    Epoch  8/10: total=1.5491, vae=1.1028, dsb=0.4457, bio=0.0012
    Epoch  9/10: total=1.5476, vae=1.1038, dsb=0.4432, bio=0.0012
    Epoch 10/10: total=1.5584, vae=1.1033, dsb=0.4543, bio=0.0014

[Seed 54] Joint training (original) complete; models and history saved.

[Seed 54] Starting joint training (ablation)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=429.8187, vae=2.0368, dsb=427.7819, bio=0.0000
    Epoch  2/10: total=116.9097, vae=1.0992, dsb=115.8106, bio=0.0000
    Epoch  3/10: total=106.0000, vae=1.0989, dsb=104.9011, bio=0.0000
    Epoch  4/10: total=100.9548, vae=1.0976, dsb=99.8572, bio=0.0000
    Epoch  5/10: total=99.1126, vae=1.0957, dsb=98.0169, bio=0.0000
    Epoch  6/10: total=96.4742, vae=1.0957, dsb=95.3786, bio=0.0000
    Epoch  7/10: total=95.6752, vae=1.0965, dsb=94.5787, bio=0.0000
    Epoch  8/10: total=94.6866, vae=1.0967, dsb=93.5899, bio=0.0000
    Epoch  9/10: total=93.7893, vae=1.0956, dsb=92.6937, bio=0.0000
    Epoch 10/10: total=92.4578, vae=1.0960, dsb=91.3619, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=3.2639, vae=1.0964, dsb=2.1675, bio=0.0000
    Epoch  2/10: total=2.7949, vae=1.0963, dsb=1.6986, bio=0.0000
    Epoch  3/10: total=2.6414, vae=1.0953, dsb=1.5461, bio=0.0000
    Epoch  4/10: total=2.5859, vae=1.0965, dsb=1.4894, bio=0.0000
    Epoch  5/10: total=2.5527, vae=1.0971, dsb=1.4557, bio=0.0000
    Epoch  6/10: total=2.5258, vae=1.0953, dsb=1.4304, bio=0.0000
    Epoch  7/10: total=2.4714, vae=1.0972, dsb=1.3743, bio=0.0000
    Epoch  8/10: total=2.4791, vae=1.0971, dsb=1.3820, bio=0.0000
    Epoch  9/10: total=2.4277, vae=1.0958, dsb=1.3319, bio=0.0000
    Epoch 10/10: total=2.4302, vae=1.0953, dsb=1.3349, bio=0.0000

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=80.9178, vae=1.0961, dsb=79.8217, bio=0.0000
    Epoch  2/10: total=75.3618, vae=1.0963, dsb=74.2655, bio=0.0000
    Epoch  3/10: total=73.8735, vae=1.0954, dsb=72.7781, bio=0.0000
    Epoch  4/10: total=72.7066, vae=1.0968, dsb=71.6098, bio=0.0000
    Epoch  5/10: total=72.9409, vae=1.0967, dsb=71.8442, bio=0.0000
    Epoch  6/10: total=72.2221, vae=1.0954, dsb=71.1268, bio=0.0000
    Epoch  7/10: total=72.0651, vae=1.0962, dsb=70.9689, bio=0.0000
    Epoch  8/10: total=71.8848, vae=1.0954, dsb=70.7894, bio=0.0000
    Epoch  9/10: total=72.0726, vae=1.0955, dsb=70.9770, bio=0.0000
    Epoch 10/10: total=71.3611, vae=1.0958, dsb=70.2654, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=2.1442, vae=1.0956, dsb=1.0486, bio=0.0000
    Epoch  2/10: total=2.0333, vae=1.0956, dsb=0.9378, bio=0.0000
    Epoch  3/10: total=2.0232, vae=1.0956, dsb=0.9276, bio=0.0000
    Epoch  4/10: total=2.0075, vae=1.0961, dsb=0.9114, bio=0.0000
    Epoch  5/10: total=1.9577, vae=1.0961, dsb=0.8615, bio=0.0000
    Epoch  6/10: total=1.9382, vae=1.0956, dsb=0.8426, bio=0.0000
    Epoch  7/10: total=1.9403, vae=1.0965, dsb=0.8438, bio=0.0000
    Epoch  8/10: total=1.9407, vae=1.0955, dsb=0.8452, bio=0.0000
    Epoch  9/10: total=1.9312, vae=1.0963, dsb=0.8349, bio=0.0000
    Epoch 10/10: total=1.9177, vae=1.0954, dsb=0.8223, bio=0.0000

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=67.8218, vae=1.0956, dsb=66.7263, bio=0.0000
    Epoch  2/10: total=65.5897, vae=1.0958, dsb=64.4939, bio=0.0000
    Epoch  3/10: total=65.1278, vae=1.0946, dsb=64.0332, bio=0.0000
    Epoch  4/10: total=64.8887, vae=1.0957, dsb=63.7930, bio=0.0000
    Epoch  5/10: total=65.1609, vae=1.0958, dsb=64.0652, bio=0.0000
    Epoch  6/10: total=65.0120, vae=1.0957, dsb=63.9163, bio=0.0000
    Epoch  7/10: total=64.4290, vae=1.0954, dsb=63.3336, bio=0.0000
    Epoch  8/10: total=64.1605, vae=1.0950, dsb=63.0655, bio=0.0000
    Epoch  9/10: total=64.4617, vae=1.0947, dsb=63.3670, bio=0.0000
    Epoch 10/10: total=64.2658, vae=1.0949, dsb=63.1709, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.7849, vae=1.0953, dsb=0.6896, bio=0.0000
    Epoch  2/10: total=1.7178, vae=1.0958, dsb=0.6220, bio=0.0000
    Epoch  3/10: total=1.7033, vae=1.0958, dsb=0.6075, bio=0.0000
    Epoch  4/10: total=1.6988, vae=1.0949, dsb=0.6039, bio=0.0000
    Epoch  5/10: total=1.7125, vae=1.0959, dsb=0.6166, bio=0.0000
    Epoch  6/10: total=1.6949, vae=1.0958, dsb=0.5990, bio=0.0000
    Epoch  7/10: total=1.6816, vae=1.0949, dsb=0.5867, bio=0.0000
    Epoch  8/10: total=1.6859, vae=1.0950, dsb=0.5909, bio=0.0000
    Epoch  9/10: total=1.6842, vae=1.0957, dsb=0.5885, bio=0.0000
    Epoch 10/10: total=1.6746, vae=1.0949, dsb=0.5797, bio=0.0000

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=54.1450, vae=1.0945, dsb=53.0505, bio=0.0000
    Epoch  2/10: total=53.6517, vae=1.0952, dsb=52.5566, bio=0.0000
    Epoch  3/10: total=53.4441, vae=1.0950, dsb=52.3492, bio=0.0000
    Epoch  4/10: total=53.1395, vae=1.0954, dsb=52.0442, bio=0.0000
    Epoch  5/10: total=52.8953, vae=1.0956, dsb=51.7997, bio=0.0000
    Epoch  6/10: total=53.0091, vae=1.0953, dsb=51.9138, bio=0.0000
    Epoch  7/10: total=52.8466, vae=1.0946, dsb=51.7519, bio=0.0000
    Epoch  8/10: total=53.0045, vae=1.0966, dsb=51.9079, bio=0.0000
    Epoch  9/10: total=52.8847, vae=1.0952, dsb=51.7895, bio=0.0000
    Epoch 10/10: total=52.8017, vae=1.0957, dsb=51.7060, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.6188, vae=1.0960, dsb=0.5227, bio=0.0000
    Epoch  2/10: total=1.5839, vae=1.0951, dsb=0.4889, bio=0.0000
    Epoch  3/10: total=1.5922, vae=1.0949, dsb=0.4973, bio=0.0000
    Epoch  4/10: total=1.5963, vae=1.0959, dsb=0.5005, bio=0.0000
    Epoch  5/10: total=1.5742, vae=1.0955, dsb=0.4787, bio=0.0000
    Epoch  6/10: total=1.5727, vae=1.0953, dsb=0.4774, bio=0.0000
    Epoch  7/10: total=1.5676, vae=1.0952, dsb=0.4724, bio=0.0000
    Epoch  8/10: total=1.5754, vae=1.0945, dsb=0.4808, bio=0.0000
    Epoch  9/10: total=1.5589, vae=1.0956, dsb=0.4633, bio=0.0000
    Epoch 10/10: total=1.5727, vae=1.0948, dsb=0.4779, bio=0.0000

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=47.7778, vae=1.0958, dsb=46.6819, bio=0.0000
    Epoch  2/10: total=47.0864, vae=1.0952, dsb=45.9912, bio=0.0000
    Epoch  3/10: total=47.0752, vae=1.0958, dsb=45.9794, bio=0.0000
    Epoch  4/10: total=46.8030, vae=1.0944, dsb=45.7086, bio=0.0000
    Epoch  5/10: total=46.9378, vae=1.0960, dsb=45.8418, bio=0.0000
    Epoch  6/10: total=46.7378, vae=1.0949, dsb=45.6429, bio=0.0000
    Epoch  7/10: total=46.8500, vae=1.0955, dsb=45.7544, bio=0.0000
    Epoch  8/10: total=46.8319, vae=1.0955, dsb=45.7364, bio=0.0000
    Epoch  9/10: total=46.8839, vae=1.0950, dsb=45.7889, bio=0.0000
    Epoch 10/10: total=46.7230, vae=1.0957, dsb=45.6273, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.5237, vae=1.0953, dsb=0.4284, bio=0.0000
    Epoch  2/10: total=1.5157, vae=1.0957, dsb=0.4200, bio=0.0000
    Epoch  3/10: total=1.5121, vae=1.0960, dsb=0.4161, bio=0.0000
    Epoch  4/10: total=1.5143, vae=1.0957, dsb=0.4186, bio=0.0000
    Epoch  5/10: total=1.5170, vae=1.0956, dsb=0.4214, bio=0.0000
    Epoch  6/10: total=1.5187, vae=1.0954, dsb=0.4233, bio=0.0000
    Epoch  7/10: total=1.5132, vae=1.0958, dsb=0.4174, bio=0.0000
    Epoch  8/10: total=1.5152, vae=1.0951, dsb=0.4201, bio=0.0000
    Epoch  9/10: total=1.5140, vae=1.0961, dsb=0.4179, bio=0.0000
    Epoch 10/10: total=1.5248, vae=1.0957, dsb=0.4291, bio=0.0000

[Seed 54] Joint training (ablation) complete; models and history saved.

[Seed 54] Drift genes saved in /home/yyuan/ICB_TCE/iter_results/run_054

[Seed 54] run finished.

================================================================================
[Seed 55] Starting running whole pipeline...
================================================================================

[Seed 55] Starting VAE pre-training...

    Epoch [01/20], Beta: 0.000, Average Loss: 531.9504
    Epoch [02/20], Beta: 0.000, Average Loss: 311.1093
    Epoch [03/20], Beta: 0.000, Average Loss: 271.1262
    Epoch [04/20], Beta: 0.000, Average Loss: 251.0706
    Epoch [05/20], Beta: 0.100, Average Loss: 245.3161
    Epoch [06/20], Beta: 0.200, Average Loss: 244.5263
    Epoch [07/20], Beta: 0.300, Average Loss: 244.8853
    Epoch [08/20], Beta: 0.400, Average Loss: 245.7184
    Epoch [09/20], Beta: 0.500, Average Loss: 246.6898
    Epoch [10/20], Beta: 0.600, Average Loss: 247.8154
    Epoch [11/20], Beta: 0.700, Average Loss: 249.0554
    Epoch [12/20], Beta: 0.800, Average Loss: 250.2915
    Epoch [13/20], Beta: 0.900, Average Loss: 251.5314
    Epoch [14/20], Beta: 1.000, Average Loss: 253.1463
    Epoch [15/20], Beta: 1.000, Average Loss: 252.7083
    Epoch [16/20], Beta: 1.000, Average Loss: 252.3802
    Epoch [17/20], Beta: 1.000, Average Loss: 252.0012
    Epoch [18/20], Beta: 1.000, Average Loss: 251.6949
    Epoch [19/20], Beta: 1.000, Average Loss: 251.3308
    Epoch [20/20], Beta: 1.000, Average Loss: 251.1399

[Seed 55] VAE pre-training complete.

[Seed 55] Starting joint training (original)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=417.6467, vae=3.4572, dsb=399.8860, bio=28.6071
    Epoch  2/10: total=117.6287, vae=1.1059, dsb=116.4876, bio=0.0703
    Epoch  3/10: total=106.0935, vae=1.0992, dsb=104.9805, bio=0.0278
    Epoch  4/10: total=100.1358, vae=1.0975, dsb=99.0301, bio=0.0164
    Epoch  5/10: total=96.8566, vae=1.0960, dsb=95.7551, bio=0.0111
    Epoch  6/10: total=94.1816, vae=1.0950, dsb=93.0824, bio=0.0082
    Epoch  7/10: total=92.9086, vae=1.0951, dsb=91.8103, bio=0.0065
    Epoch  8/10: total=91.2683, vae=1.0951, dsb=90.1704, bio=0.0057
    Epoch  9/10: total=90.0500, vae=1.0940, dsb=88.9537, bio=0.0047
    Epoch 10/10: total=89.0625, vae=1.0939, dsb=87.9665, bio=0.0044

  [Backward Policy Training]
    Epoch  1/10: total=3.6355, vae=1.0953, dsb=2.5332, bio=0.0138
    Epoch  2/10: total=3.0288, vae=1.0941, dsb=1.9323, bio=0.0047
    Epoch  3/10: total=2.9556, vae=1.0928, dsb=1.8611, bio=0.0035
    Epoch  4/10: total=2.8245, vae=1.0928, dsb=1.7304, bio=0.0027
    Epoch  5/10: total=2.8020, vae=1.0925, dsb=1.7079, bio=0.0031
    Epoch  6/10: total=2.7637, vae=1.0914, dsb=1.6710, bio=0.0025
    Epoch  7/10: total=2.7016, vae=1.0917, dsb=1.6088, bio=0.0023
    Epoch  8/10: total=2.6970, vae=1.0919, dsb=1.6040, bio=0.0022
    Epoch  9/10: total=2.6943, vae=1.0919, dsb=1.6013, bio=0.0022
    Epoch 10/10: total=2.6116, vae=1.0912, dsb=1.5194, bio=0.0021

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=76.5158, vae=1.0943, dsb=75.4197, bio=0.0036
    Epoch  2/10: total=69.4402, vae=1.0932, dsb=68.3458, bio=0.0022
    Epoch  3/10: total=67.7434, vae=1.0929, dsb=66.6495, bio=0.0020
    Epoch  4/10: total=66.5215, vae=1.0927, dsb=65.4278, bio=0.0020
    Epoch  5/10: total=66.0364, vae=1.0922, dsb=64.9432, bio=0.0020
    Epoch  6/10: total=65.7267, vae=1.0927, dsb=64.6330, bio=0.0020
    Epoch  7/10: total=65.5123, vae=1.0926, dsb=64.4188, bio=0.0020
    Epoch  8/10: total=65.3838, vae=1.0929, dsb=64.2899, bio=0.0020
    Epoch  9/10: total=64.9672, vae=1.0920, dsb=63.8740, bio=0.0023
    Epoch 10/10: total=64.4859, vae=1.0920, dsb=63.3929, bio=0.0019

  [Backward Policy Training]
    Epoch  1/10: total=2.3794, vae=1.0922, dsb=1.2834, bio=0.0078
    Epoch  2/10: total=2.2416, vae=1.0910, dsb=1.1496, bio=0.0020
    Epoch  3/10: total=2.2149, vae=1.0908, dsb=1.1232, bio=0.0018
    Epoch  4/10: total=2.2231, vae=1.0905, dsb=1.1318, bio=0.0017
    Epoch  5/10: total=2.2181, vae=1.0917, dsb=1.1256, bio=0.0016
    Epoch  6/10: total=2.1633, vae=1.0909, dsb=1.0716, bio=0.0017
    Epoch  7/10: total=2.1426, vae=1.0906, dsb=1.0513, bio=0.0016
    Epoch  8/10: total=2.1482, vae=1.0906, dsb=1.0568, bio=0.0016
    Epoch  9/10: total=2.1434, vae=1.0910, dsb=1.0517, bio=0.0016
    Epoch 10/10: total=2.1219, vae=1.0904, dsb=1.0307, bio=0.0015

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=58.7514, vae=1.0933, dsb=57.6567, bio=0.0030
    Epoch  2/10: total=56.3305, vae=1.0921, dsb=55.2373, bio=0.0019
    Epoch  3/10: total=55.5161, vae=1.0912, dsb=54.4241, bio=0.0016
    Epoch  4/10: total=55.0914, vae=1.0908, dsb=53.9998, bio=0.0016
    Epoch  5/10: total=54.7761, vae=1.0913, dsb=53.6840, bio=0.0016
    Epoch  6/10: total=54.6450, vae=1.0919, dsb=53.5523, bio=0.0016
    Epoch  7/10: total=54.6828, vae=1.0906, dsb=53.5915, bio=0.0015
    Epoch  8/10: total=54.4165, vae=1.0910, dsb=53.3247, bio=0.0015
    Epoch  9/10: total=54.1630, vae=1.0905, dsb=53.0716, bio=0.0018
    Epoch 10/10: total=54.2336, vae=1.0904, dsb=53.1425, bio=0.0015

  [Backward Policy Training]
    Epoch  1/10: total=2.0174, vae=1.0917, dsb=0.9080, bio=0.0355
    Epoch  2/10: total=1.9291, vae=1.0904, dsb=0.8379, bio=0.0015
    Epoch  3/10: total=1.9244, vae=1.0897, dsb=0.8340, bio=0.0014
    Epoch  4/10: total=1.9022, vae=1.0895, dsb=0.8120, bio=0.0013
    Epoch  5/10: total=1.9162, vae=1.0900, dsb=0.8255, bio=0.0014
    Epoch  6/10: total=1.8983, vae=1.0899, dsb=0.8078, bio=0.0013
    Epoch  7/10: total=1.8937, vae=1.0901, dsb=0.8030, bio=0.0013
    Epoch  8/10: total=1.9094, vae=1.0894, dsb=0.8194, bio=0.0012
    Epoch  9/10: total=1.8826, vae=1.0903, dsb=0.7917, bio=0.0012
    Epoch 10/10: total=1.8844, vae=1.0892, dsb=0.7946, bio=0.0012

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=48.3116, vae=1.0935, dsb=47.2165, bio=0.0032
    Epoch  2/10: total=47.1094, vae=1.0909, dsb=46.0178, bio=0.0013
    Epoch  3/10: total=46.8863, vae=1.0905, dsb=45.7951, bio=0.0013
    Epoch  4/10: total=46.6135, vae=1.0909, dsb=45.5220, bio=0.0014
    Epoch  5/10: total=46.7478, vae=1.0906, dsb=45.6566, bio=0.0012
    Epoch  6/10: total=46.9038, vae=1.0901, dsb=45.8130, bio=0.0012
    Epoch  7/10: total=46.7741, vae=1.0904, dsb=45.6831, bio=0.0012
    Epoch  8/10: total=46.4976, vae=1.0900, dsb=45.4070, bio=0.0012
    Epoch  9/10: total=46.3841, vae=1.0899, dsb=45.2935, bio=0.0013
    Epoch 10/10: total=46.6532, vae=1.0908, dsb=45.5618, bio=0.0012

  [Backward Policy Training]
    Epoch  1/10: total=1.8635, vae=1.0912, dsb=0.6972, bio=0.1500
    Epoch  2/10: total=1.7855, vae=1.0896, dsb=0.6953, bio=0.0013
    Epoch  3/10: total=1.7764, vae=1.0901, dsb=0.6857, bio=0.0012
    Epoch  4/10: total=1.7616, vae=1.0895, dsb=0.6716, bio=0.0010
    Epoch  5/10: total=1.7924, vae=1.0904, dsb=0.7014, bio=0.0011
    Epoch  6/10: total=1.7822, vae=1.0892, dsb=0.6924, bio=0.0011
    Epoch  7/10: total=1.7471, vae=1.0890, dsb=0.6575, bio=0.0011
    Epoch  8/10: total=1.7611, vae=1.0899, dsb=0.6707, bio=0.0011
    Epoch  9/10: total=1.7618, vae=1.0890, dsb=0.6723, bio=0.0010
    Epoch 10/10: total=1.7792, vae=1.0898, dsb=0.6889, bio=0.0010

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=43.4469, vae=1.0925, dsb=42.3524, bio=0.0040
    Epoch  2/10: total=43.0829, vae=1.0903, dsb=41.9920, bio=0.0013
    Epoch  3/10: total=43.1099, vae=1.0900, dsb=42.0192, bio=0.0012
    Epoch  4/10: total=43.1680, vae=1.0903, dsb=42.0773, bio=0.0007
    Epoch  5/10: total=42.8521, vae=1.0898, dsb=41.7620, bio=0.0006
    Epoch  6/10: total=43.0480, vae=1.0896, dsb=41.9578, bio=0.0013
    Epoch  7/10: total=43.1694, vae=1.0900, dsb=42.0788, bio=0.0012
    Epoch  8/10: total=42.9585, vae=1.0896, dsb=41.8684, bio=0.0011
    Epoch  9/10: total=42.8922, vae=1.0897, dsb=41.8020, bio=0.0010
    Epoch 10/10: total=42.8216, vae=1.0891, dsb=41.7322, bio=0.0006

  [Backward Policy Training]
    Epoch  1/10: total=1.7726, vae=1.0910, dsb=0.6209, bio=0.1214
    Epoch  2/10: total=1.7060, vae=1.0903, dsb=0.6151, bio=0.0012
    Epoch  3/10: total=1.7090, vae=1.0902, dsb=0.6182, bio=0.0011
    Epoch  4/10: total=1.7102, vae=1.0890, dsb=0.6207, bio=0.0010
    Epoch  5/10: total=1.6941, vae=1.0892, dsb=0.6044, bio=0.0010
    Epoch  6/10: total=1.6892, vae=1.0889, dsb=0.6001, bio=0.0003
    Epoch  7/10: total=1.6937, vae=1.0880, dsb=0.6051, bio=0.0012
    Epoch  8/10: total=1.7087, vae=1.0900, dsb=0.6182, bio=0.0010
    Epoch  9/10: total=1.6965, vae=1.0887, dsb=0.6073, bio=0.0010
    Epoch 10/10: total=1.7022, vae=1.0887, dsb=0.6133, bio=0.0005

[Seed 55] Joint training (original) complete; models and history saved.

[Seed 55] Starting joint training (ablation)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=400.9410, vae=1.9604, dsb=398.9806, bio=0.0000
    Epoch  2/10: total=116.5867, vae=1.0863, dsb=115.5003, bio=0.0000
    Epoch  3/10: total=105.3045, vae=1.0840, dsb=104.2204, bio=0.0000
    Epoch  4/10: total=99.4924, vae=1.0838, dsb=98.4086, bio=0.0000
    Epoch  5/10: total=96.3103, vae=1.0829, dsb=95.2274, bio=0.0000
    Epoch  6/10: total=93.6379, vae=1.0823, dsb=92.5555, bio=0.0000
    Epoch  7/10: total=92.3794, vae=1.0826, dsb=91.2968, bio=0.0000
    Epoch  8/10: total=90.7777, vae=1.0830, dsb=89.6947, bio=0.0000
    Epoch  9/10: total=89.6114, vae=1.0822, dsb=88.5293, bio=0.0000
    Epoch 10/10: total=88.6690, vae=1.0823, dsb=87.5867, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=3.5001, vae=1.0826, dsb=2.4175, bio=0.0000
    Epoch  2/10: total=2.9418, vae=1.0830, dsb=1.8588, bio=0.0000
    Epoch  3/10: total=2.8736, vae=1.0822, dsb=1.7914, bio=0.0000
    Epoch  4/10: total=2.7485, vae=1.0826, dsb=1.6659, bio=0.0000
    Epoch  5/10: total=2.7257, vae=1.0826, dsb=1.6431, bio=0.0000
    Epoch  6/10: total=2.6894, vae=1.0817, dsb=1.6077, bio=0.0000
    Epoch  7/10: total=2.6285, vae=1.0821, dsb=1.5464, bio=0.0000
    Epoch  8/10: total=2.6247, vae=1.0824, dsb=1.5423, bio=0.0000
    Epoch  9/10: total=2.6219, vae=1.0824, dsb=1.5395, bio=0.0000
    Epoch 10/10: total=2.5427, vae=1.0819, dsb=1.4608, bio=0.0000

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=75.1299, vae=1.0824, dsb=74.0475, bio=0.0000
    Epoch  2/10: total=68.3965, vae=1.0826, dsb=67.3139, bio=0.0000
    Epoch  3/10: total=66.6710, vae=1.0824, dsb=65.5886, bio=0.0000
    Epoch  4/10: total=65.4369, vae=1.0823, dsb=64.3546, bio=0.0000
    Epoch  5/10: total=64.8903, vae=1.0820, dsb=63.8082, bio=0.0000
    Epoch  6/10: total=64.6526, vae=1.0826, dsb=63.5700, bio=0.0000
    Epoch  7/10: total=64.4247, vae=1.0826, dsb=63.3421, bio=0.0000
    Epoch  8/10: total=64.2892, vae=1.0831, dsb=63.2061, bio=0.0000
    Epoch  9/10: total=63.8797, vae=1.0822, dsb=62.7975, bio=0.0000
    Epoch 10/10: total=63.4076, vae=1.0824, dsb=62.3252, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=2.3017, vae=1.0819, dsb=1.2198, bio=0.0000
    Epoch  2/10: total=2.1718, vae=1.0820, dsb=1.0898, bio=0.0000
    Epoch  3/10: total=2.1483, vae=1.0821, dsb=1.0662, bio=0.0000
    Epoch  4/10: total=2.1573, vae=1.0818, dsb=1.0755, bio=0.0000
    Epoch  5/10: total=2.1542, vae=1.0831, dsb=1.0711, bio=0.0000
    Epoch  6/10: total=2.1020, vae=1.0824, dsb=1.0196, bio=0.0000
    Epoch  7/10: total=2.0829, vae=1.0821, dsb=1.0008, bio=0.0000
    Epoch  8/10: total=2.0887, vae=1.0822, dsb=1.0065, bio=0.0000
    Epoch  9/10: total=2.0852, vae=1.0826, dsb=1.0025, bio=0.0000
    Epoch 10/10: total=2.0638, vae=1.0821, dsb=0.9817, bio=0.0000

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=57.7558, vae=1.0823, dsb=56.6735, bio=0.0000
    Epoch  2/10: total=55.3057, vae=1.0824, dsb=54.2232, bio=0.0000
    Epoch  3/10: total=54.4794, vae=1.0819, dsb=53.3975, bio=0.0000
    Epoch  4/10: total=54.0713, vae=1.0815, dsb=52.9898, bio=0.0000
    Epoch  5/10: total=53.7643, vae=1.0822, dsb=52.6820, bio=0.0000
    Epoch  6/10: total=53.6540, vae=1.0829, dsb=52.5712, bio=0.0000
    Epoch  7/10: total=53.6748, vae=1.0816, dsb=52.5932, bio=0.0000
    Epoch  8/10: total=53.4553, vae=1.0821, dsb=52.3732, bio=0.0000
    Epoch  9/10: total=53.1772, vae=1.0818, dsb=52.0954, bio=0.0000
    Epoch 10/10: total=53.2619, vae=1.0817, dsb=52.1801, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.9280, vae=1.0822, dsb=0.8458, bio=0.0000
    Epoch  2/10: total=1.8624, vae=1.0821, dsb=0.7803, bio=0.0000
    Epoch  3/10: total=1.8577, vae=1.0815, dsb=0.7761, bio=0.0000
    Epoch  4/10: total=1.8368, vae=1.0814, dsb=0.7555, bio=0.0000
    Epoch  5/10: total=1.8500, vae=1.0819, dsb=0.7681, bio=0.0000
    Epoch  6/10: total=1.8324, vae=1.0820, dsb=0.7505, bio=0.0000
    Epoch  7/10: total=1.8285, vae=1.0822, dsb=0.7462, bio=0.0000
    Epoch  8/10: total=1.8436, vae=1.0815, dsb=0.7621, bio=0.0000
    Epoch  9/10: total=1.8189, vae=1.0825, dsb=0.7364, bio=0.0000
    Epoch 10/10: total=1.8201, vae=1.0815, dsb=0.7386, bio=0.0000

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=47.4294, vae=1.0827, dsb=46.3467, bio=0.0000
    Epoch  2/10: total=46.1501, vae=1.0819, dsb=45.0683, bio=0.0000
    Epoch  3/10: total=45.9395, vae=1.0818, dsb=44.8577, bio=0.0000
    Epoch  4/10: total=45.6571, vae=1.0823, dsb=44.5748, bio=0.0000
    Epoch  5/10: total=45.7830, vae=1.0822, dsb=44.7008, bio=0.0000
    Epoch  6/10: total=45.9462, vae=1.0819, dsb=44.8643, bio=0.0000
    Epoch  7/10: total=45.8184, vae=1.0822, dsb=44.7362, bio=0.0000
    Epoch  8/10: total=45.5213, vae=1.0819, dsb=44.4394, bio=0.0000
    Epoch  9/10: total=45.4537, vae=1.0819, dsb=44.3718, bio=0.0000
    Epoch 10/10: total=45.6462, vae=1.0829, dsb=44.5634, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.7294, vae=1.0821, dsb=0.6474, bio=0.0000
    Epoch  2/10: total=1.7256, vae=1.0816, dsb=0.6439, bio=0.0000
    Epoch  3/10: total=1.7167, vae=1.0824, dsb=0.6343, bio=0.0000
    Epoch  4/10: total=1.7019, vae=1.0818, dsb=0.6201, bio=0.0000
    Epoch  5/10: total=1.7316, vae=1.0829, dsb=0.6487, bio=0.0000
    Epoch  6/10: total=1.7220, vae=1.0818, dsb=0.6402, bio=0.0000
    Epoch  7/10: total=1.6884, vae=1.0817, dsb=0.6068, bio=0.0000
    Epoch  8/10: total=1.7019, vae=1.0826, dsb=0.6192, bio=0.0000
    Epoch  9/10: total=1.7029, vae=1.0819, dsb=0.6210, bio=0.0000
    Epoch 10/10: total=1.7187, vae=1.0828, dsb=0.6359, bio=0.0000

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=41.5994, vae=1.0826, dsb=40.5168, bio=0.0000
    Epoch  2/10: total=41.1670, vae=1.0815, dsb=40.0855, bio=0.0000
    Epoch  3/10: total=41.2135, vae=1.0814, dsb=40.1320, bio=0.0000
    Epoch  4/10: total=41.2556, vae=1.0818, dsb=40.1738, bio=0.0000
    Epoch  5/10: total=40.9613, vae=1.0816, dsb=39.8797, bio=0.0000
    Epoch  6/10: total=41.1190, vae=1.0815, dsb=40.0375, bio=0.0000
    Epoch  7/10: total=41.2501, vae=1.0820, dsb=40.1681, bio=0.0000
    Epoch  8/10: total=41.0309, vae=1.0816, dsb=39.9492, bio=0.0000
    Epoch  9/10: total=40.9686, vae=1.0818, dsb=39.8868, bio=0.0000
    Epoch 10/10: total=40.8996, vae=1.0812, dsb=39.8184, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.6465, vae=1.0819, dsb=0.5645, bio=0.0000
    Epoch  2/10: total=1.6406, vae=1.0826, dsb=0.5580, bio=0.0000
    Epoch  3/10: total=1.6433, vae=1.0828, dsb=0.5605, bio=0.0000
    Epoch  4/10: total=1.6441, vae=1.0817, dsb=0.5624, bio=0.0000
    Epoch  5/10: total=1.6287, vae=1.0820, dsb=0.5467, bio=0.0000
    Epoch  6/10: total=1.6245, vae=1.0818, dsb=0.5427, bio=0.0000
    Epoch  7/10: total=1.6283, vae=1.0812, dsb=0.5471, bio=0.0000
    Epoch  8/10: total=1.6430, vae=1.0832, dsb=0.5598, bio=0.0000
    Epoch  9/10: total=1.6308, vae=1.0820, dsb=0.5489, bio=0.0000
    Epoch 10/10: total=1.6367, vae=1.0819, dsb=0.5548, bio=0.0000

[Seed 55] Joint training (ablation) complete; models and history saved.

[Seed 55] Drift genes saved in /home/yyuan/ICB_TCE/iter_results/run_055

[Seed 55] run finished.

================================================================================
[Seed 56] Starting running whole pipeline...
================================================================================

[Seed 56] Starting VAE pre-training...

    Epoch [01/20], Beta: 0.000, Average Loss: 538.5213
    Epoch [02/20], Beta: 0.000, Average Loss: 302.3440
    Epoch [03/20], Beta: 0.000, Average Loss: 267.5190
    Epoch [04/20], Beta: 0.000, Average Loss: 249.0690
    Epoch [05/20], Beta: 0.100, Average Loss: 244.5468
    Epoch [06/20], Beta: 0.200, Average Loss: 243.1148
    Epoch [07/20], Beta: 0.300, Average Loss: 243.2795
    Epoch [08/20], Beta: 0.400, Average Loss: 244.1204
    Epoch [09/20], Beta: 0.500, Average Loss: 245.3747
    Epoch [10/20], Beta: 0.600, Average Loss: 246.7363
    Epoch [11/20], Beta: 0.700, Average Loss: 248.0660
    Epoch [12/20], Beta: 0.800, Average Loss: 249.4528
    Epoch [13/20], Beta: 0.900, Average Loss: 250.7833
    Epoch [14/20], Beta: 1.000, Average Loss: 252.4287
    Epoch [15/20], Beta: 1.000, Average Loss: 251.9972
    Epoch [16/20], Beta: 1.000, Average Loss: 251.6532
    Epoch [17/20], Beta: 1.000, Average Loss: 251.3427
    Epoch [18/20], Beta: 1.000, Average Loss: 251.0650
    Epoch [19/20], Beta: 1.000, Average Loss: 250.7272
    Epoch [20/20], Beta: 1.000, Average Loss: 250.6311

[Seed 56] VAE pre-training complete.

[Seed 56] Starting joint training (original)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=239.9843, vae=4.0168, dsb=214.9883, bio=41.9582
    Epoch  2/10: total=75.0859, vae=1.1024, dsb=73.9348, bio=0.0973
    Epoch  3/10: total=62.6900, vae=1.0945, dsb=61.5759, bio=0.0392
    Epoch  4/10: total=56.7741, vae=1.0937, dsb=55.6693, bio=0.0221
    Epoch  5/10: total=53.1879, vae=1.0921, dsb=52.0885, bio=0.0145
    Epoch  6/10: total=50.9603, vae=1.0923, dsb=49.8628, bio=0.0105
    Epoch  7/10: total=49.1197, vae=1.0909, dsb=48.0248, bio=0.0080
    Epoch  8/10: total=47.8269, vae=1.0916, dsb=46.7321, bio=0.0064
    Epoch  9/10: total=46.7173, vae=1.0910, dsb=45.6236, bio=0.0053
    Epoch 10/10: total=45.8688, vae=1.0908, dsb=44.7758, bio=0.0046

  [Backward Policy Training]
    Epoch  1/10: total=3.3084, vae=1.0920, dsb=2.2111, bio=0.0106
    Epoch  2/10: total=2.6870, vae=1.0893, dsb=1.5956, bio=0.0041
    Epoch  3/10: total=2.5959, vae=1.0898, dsb=1.5045, bio=0.0032
    Epoch  4/10: total=2.5198, vae=1.0891, dsb=1.4294, bio=0.0027
    Epoch  5/10: total=2.4762, vae=1.0890, dsb=1.3860, bio=0.0024
    Epoch  6/10: total=2.4392, vae=1.0885, dsb=1.3495, bio=0.0023
    Epoch  7/10: total=2.3876, vae=1.0883, dsb=1.2982, bio=0.0021
    Epoch  8/10: total=2.3857, vae=1.0880, dsb=1.2967, bio=0.0021
    Epoch  9/10: total=2.3797, vae=1.0887, dsb=1.2900, bio=0.0020
    Epoch 10/10: total=2.3446, vae=1.0878, dsb=1.2556, bio=0.0023

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=45.7564, vae=1.0912, dsb=44.6635, bio=0.0033
    Epoch  2/10: total=37.5416, vae=1.0896, dsb=36.4510, bio=0.0019
    Epoch  3/10: total=35.1711, vae=1.0895, dsb=34.0806, bio=0.0019
    Epoch  4/10: total=34.2094, vae=1.0889, dsb=33.1195, bio=0.0019
    Epoch  5/10: total=33.4303, vae=1.0892, dsb=32.3402, bio=0.0019
    Epoch  6/10: total=32.7458, vae=1.0885, dsb=31.6563, bio=0.0019
    Epoch  7/10: total=32.4470, vae=1.0891, dsb=31.3569, bio=0.0019
    Epoch  8/10: total=32.0949, vae=1.0884, dsb=31.0055, bio=0.0021
    Epoch  9/10: total=31.9912, vae=1.0875, dsb=30.9028, bio=0.0019
    Epoch 10/10: total=31.7261, vae=1.0884, dsb=30.6368, bio=0.0019

  [Backward Policy Training]
    Epoch  1/10: total=2.1401, vae=1.0888, dsb=1.0489, bio=0.0048
    Epoch  2/10: total=2.0032, vae=1.0879, dsb=0.9144, bio=0.0019
    Epoch  3/10: total=1.9417, vae=1.0875, dsb=0.8533, bio=0.0017
    Epoch  4/10: total=1.9063, vae=1.0875, dsb=0.8180, bio=0.0017
    Epoch  5/10: total=1.8954, vae=1.0871, dsb=0.8075, bio=0.0017
    Epoch  6/10: total=1.8467, vae=1.0870, dsb=0.7589, bio=0.0016
    Epoch  7/10: total=1.8537, vae=1.0868, dsb=0.7661, bio=0.0016
    Epoch  8/10: total=1.8626, vae=1.0872, dsb=0.7747, bio=0.0016
    Epoch  9/10: total=1.8390, vae=1.0869, dsb=0.7513, bio=0.0016
    Epoch 10/10: total=1.8498, vae=1.0871, dsb=0.7620, bio=0.0016

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=31.4030, vae=1.0889, dsb=30.3126, bio=0.0030
    Epoch  2/10: total=27.8722, vae=1.0882, dsb=26.7832, bio=0.0017
    Epoch  3/10: total=26.8127, vae=1.0885, dsb=25.7233, bio=0.0017
    Epoch  4/10: total=26.3340, vae=1.0880, dsb=25.2452, bio=0.0017
    Epoch  5/10: total=26.1306, vae=1.0884, dsb=25.0413, bio=0.0018
    Epoch  6/10: total=25.9015, vae=1.0878, dsb=24.8128, bio=0.0017
    Epoch  7/10: total=25.6643, vae=1.0874, dsb=24.5761, bio=0.0017
    Epoch  8/10: total=25.4888, vae=1.0872, dsb=24.4008, bio=0.0016
    Epoch  9/10: total=25.1323, vae=1.0878, dsb=24.0437, bio=0.0017
    Epoch 10/10: total=25.3062, vae=1.0877, dsb=24.2177, bio=0.0016

  [Backward Policy Training]
    Epoch  1/10: total=1.7374, vae=1.0881, dsb=0.6448, bio=0.0091
    Epoch  2/10: total=1.6766, vae=1.0866, dsb=0.5893, bio=0.0015
    Epoch  3/10: total=1.6671, vae=1.0861, dsb=0.5803, bio=0.0014
    Epoch  4/10: total=1.6533, vae=1.0858, dsb=0.5667, bio=0.0015
    Epoch  5/10: total=1.6404, vae=1.0859, dsb=0.5538, bio=0.0014
    Epoch  6/10: total=1.6380, vae=1.0857, dsb=0.5516, bio=0.0014
    Epoch  7/10: total=1.6417, vae=1.0866, dsb=0.5544, bio=0.0013
    Epoch  8/10: total=1.6229, vae=1.0866, dsb=0.5356, bio=0.0013
    Epoch  9/10: total=1.6304, vae=1.0860, dsb=0.5437, bio=0.0013
    Epoch 10/10: total=1.6013, vae=1.0862, dsb=0.5145, bio=0.0013

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=24.1800, vae=1.0886, dsb=23.0900, bio=0.0027
    Epoch  2/10: total=22.6549, vae=1.0870, dsb=21.5671, bio=0.0016
    Epoch  3/10: total=22.2668, vae=1.0876, dsb=21.1785, bio=0.0014
    Epoch  4/10: total=21.9386, vae=1.0874, dsb=20.8505, bio=0.0014
    Epoch  5/10: total=21.9459, vae=1.0872, dsb=20.8581, bio=0.0014
    Epoch  6/10: total=21.8341, vae=1.0867, dsb=20.7466, bio=0.0014
    Epoch  7/10: total=21.8255, vae=1.0877, dsb=20.7370, bio=0.0014
    Epoch  8/10: total=21.6526, vae=1.0864, dsb=20.5654, bio=0.0014
    Epoch  9/10: total=21.6160, vae=1.0872, dsb=20.5280, bio=0.0014
    Epoch 10/10: total=21.5975, vae=1.0875, dsb=20.5092, bio=0.0014

  [Backward Policy Training]
    Epoch  1/10: total=1.5388, vae=1.0874, dsb=0.4381, bio=0.0266
    Epoch  2/10: total=1.4895, vae=1.0861, dsb=0.4027, bio=0.0013
    Epoch  3/10: total=1.4945, vae=1.0858, dsb=0.4081, bio=0.0012
    Epoch  4/10: total=1.4914, vae=1.0861, dsb=0.4047, bio=0.0012
    Epoch  5/10: total=1.4705, vae=1.0860, dsb=0.3840, bio=0.0011
    Epoch  6/10: total=1.4821, vae=1.0861, dsb=0.3955, bio=0.0012
    Epoch  7/10: total=1.4697, vae=1.0859, dsb=0.3832, bio=0.0011
    Epoch  8/10: total=1.4674, vae=1.0860, dsb=0.3808, bio=0.0011
    Epoch  9/10: total=1.4703, vae=1.0862, dsb=0.3835, bio=0.0011
    Epoch 10/10: total=1.4652, vae=1.0865, dsb=0.3781, bio=0.0011

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=19.7520, vae=1.0886, dsb=18.6621, bio=0.0025
    Epoch  2/10: total=19.3434, vae=1.0888, dsb=18.2540, bio=0.0012
    Epoch  3/10: total=19.2456, vae=1.0875, dsb=18.1575, bio=0.0012
    Epoch  4/10: total=19.1596, vae=1.0874, dsb=18.0716, bio=0.0013
    Epoch  5/10: total=19.0231, vae=1.0870, dsb=17.9355, bio=0.0013
    Epoch  6/10: total=19.0949, vae=1.0864, dsb=18.0078, bio=0.0012
    Epoch  7/10: total=18.9604, vae=1.0864, dsb=17.8734, bio=0.0012
    Epoch  8/10: total=19.0981, vae=1.0867, dsb=18.0108, bio=0.0012
    Epoch  9/10: total=18.9147, vae=1.0865, dsb=17.8276, bio=0.0012
    Epoch 10/10: total=19.0202, vae=1.0863, dsb=17.9333, bio=0.0012

  [Backward Policy Training]
    Epoch  1/10: total=1.4375, vae=1.0867, dsb=0.3227, bio=0.0561
    Epoch  2/10: total=1.4033, vae=1.0861, dsb=0.3166, bio=0.0011
    Epoch  3/10: total=1.4007, vae=1.0862, dsb=0.3140, bio=0.0011
    Epoch  4/10: total=1.3935, vae=1.0852, dsb=0.3078, bio=0.0010
    Epoch  5/10: total=1.3945, vae=1.0855, dsb=0.3085, bio=0.0010
    Epoch  6/10: total=1.4010, vae=1.0851, dsb=0.3155, bio=0.0010
    Epoch  7/10: total=1.3958, vae=1.0861, dsb=0.3092, bio=0.0010
    Epoch  8/10: total=1.3951, vae=1.0851, dsb=0.3094, bio=0.0010
    Epoch  9/10: total=1.3989, vae=1.0865, dsb=0.3120, bio=0.0010
    Epoch 10/10: total=1.3937, vae=1.0847, dsb=0.3085, bio=0.0010

[Seed 56] Joint training (original) complete; models and history saved.

[Seed 56] Starting joint training (ablation)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=216.6544, vae=2.0264, dsb=214.6279, bio=0.0000
    Epoch  2/10: total=74.6743, vae=1.0823, dsb=73.5921, bio=0.0000
    Epoch  3/10: total=62.3589, vae=1.0791, dsb=61.2798, bio=0.0000
    Epoch  4/10: total=56.5481, vae=1.0797, dsb=55.4684, bio=0.0000
    Epoch  5/10: total=53.0328, vae=1.0790, dsb=51.9538, bio=0.0000
    Epoch  6/10: total=50.8535, vae=1.0795, dsb=49.7740, bio=0.0000
    Epoch  7/10: total=49.0107, vae=1.0785, dsb=47.9322, bio=0.0000
    Epoch  8/10: total=47.6648, vae=1.0794, dsb=46.5853, bio=0.0000
    Epoch  9/10: total=46.5182, vae=1.0792, dsb=45.4390, bio=0.0000
    Epoch 10/10: total=45.6451, vae=1.0791, dsb=44.5659, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=3.2366, vae=1.0796, dsb=2.1570, bio=0.0000
    Epoch  2/10: total=2.6364, vae=1.0785, dsb=1.5579, bio=0.0000
    Epoch  3/10: total=2.5485, vae=1.0793, dsb=1.4692, bio=0.0000
    Epoch  4/10: total=2.4755, vae=1.0790, dsb=1.3965, bio=0.0000
    Epoch  5/10: total=2.4331, vae=1.0791, dsb=1.3540, bio=0.0000
    Epoch  6/10: total=2.3951, vae=1.0788, dsb=1.3163, bio=0.0000
    Epoch  7/10: total=2.3443, vae=1.0787, dsb=1.2656, bio=0.0000
    Epoch  8/10: total=2.3421, vae=1.0784, dsb=1.2637, bio=0.0000
    Epoch  9/10: total=2.3366, vae=1.0792, dsb=1.2574, bio=0.0000
    Epoch 10/10: total=2.3019, vae=1.0785, dsb=1.2234, bio=0.0000

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=45.5600, vae=1.0791, dsb=44.4810, bio=0.0000
    Epoch  2/10: total=37.3517, vae=1.0788, dsb=36.2729, bio=0.0000
    Epoch  3/10: total=35.0566, vae=1.0789, dsb=33.9777, bio=0.0000
    Epoch  4/10: total=34.1185, vae=1.0785, dsb=33.0400, bio=0.0000
    Epoch  5/10: total=33.3449, vae=1.0788, dsb=32.2660, bio=0.0000
    Epoch  6/10: total=32.6407, vae=1.0783, dsb=31.5624, bio=0.0000
    Epoch  7/10: total=32.3516, vae=1.0789, dsb=31.2727, bio=0.0000
    Epoch  8/10: total=32.0350, vae=1.0782, dsb=30.9568, bio=0.0000
    Epoch  9/10: total=31.9085, vae=1.0775, dsb=30.8310, bio=0.0000
    Epoch 10/10: total=31.6480, vae=1.0784, dsb=30.5696, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=2.0785, vae=1.0782, dsb=1.0003, bio=0.0000
    Epoch  2/10: total=1.9479, vae=1.0790, dsb=0.8689, bio=0.0000
    Epoch  3/10: total=1.8930, vae=1.0787, dsb=0.8143, bio=0.0000
    Epoch  4/10: total=1.8593, vae=1.0788, dsb=0.7805, bio=0.0000
    Epoch  5/10: total=1.8507, vae=1.0784, dsb=0.7723, bio=0.0000
    Epoch  6/10: total=1.8045, vae=1.0784, dsb=0.7261, bio=0.0000
    Epoch  7/10: total=1.8121, vae=1.0782, dsb=0.7339, bio=0.0000
    Epoch  8/10: total=1.8207, vae=1.0788, dsb=0.7420, bio=0.0000
    Epoch  9/10: total=1.7990, vae=1.0785, dsb=0.7205, bio=0.0000
    Epoch 10/10: total=1.8108, vae=1.0786, dsb=0.7322, bio=0.0000

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=30.0828, vae=1.0778, dsb=29.0050, bio=0.0000
    Epoch  2/10: total=26.7976, vae=1.0784, dsb=25.7192, bio=0.0000
    Epoch  3/10: total=25.8240, vae=1.0789, dsb=24.7450, bio=0.0000
    Epoch  4/10: total=25.3547, vae=1.0785, dsb=24.2763, bio=0.0000
    Epoch  5/10: total=25.1524, vae=1.0789, dsb=24.0735, bio=0.0000
    Epoch  6/10: total=24.9487, vae=1.0785, dsb=23.8702, bio=0.0000
    Epoch  7/10: total=24.7262, vae=1.0781, dsb=23.6481, bio=0.0000
    Epoch  8/10: total=24.5537, vae=1.0780, dsb=23.4757, bio=0.0000
    Epoch  9/10: total=24.2347, vae=1.0786, dsb=23.1561, bio=0.0000
    Epoch 10/10: total=24.4199, vae=1.0785, dsb=23.3413, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.6968, vae=1.0788, dsb=0.6181, bio=0.0000
    Epoch  2/10: total=1.6422, vae=1.0782, dsb=0.5640, bio=0.0000
    Epoch  3/10: total=1.6334, vae=1.0778, dsb=0.5556, bio=0.0000
    Epoch  4/10: total=1.6199, vae=1.0776, dsb=0.5422, bio=0.0000
    Epoch  5/10: total=1.6068, vae=1.0779, dsb=0.5289, bio=0.0000
    Epoch  6/10: total=1.6041, vae=1.0777, dsb=0.5264, bio=0.0000
    Epoch  7/10: total=1.6079, vae=1.0786, dsb=0.5293, bio=0.0000
    Epoch  8/10: total=1.5890, vae=1.0787, dsb=0.5104, bio=0.0000
    Epoch  9/10: total=1.5959, vae=1.0781, dsb=0.5178, bio=0.0000
    Epoch 10/10: total=1.5679, vae=1.0783, dsb=0.4897, bio=0.0000

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=23.6480, vae=1.0780, dsb=22.5700, bio=0.0000
    Epoch  2/10: total=22.0080, vae=1.0777, dsb=20.9303, bio=0.0000
    Epoch  3/10: total=21.6273, vae=1.0786, dsb=20.5487, bio=0.0000
    Epoch  4/10: total=21.3126, vae=1.0785, dsb=20.2341, bio=0.0000
    Epoch  5/10: total=21.2734, vae=1.0783, dsb=20.1952, bio=0.0000
    Epoch  6/10: total=21.1684, vae=1.0779, dsb=20.0905, bio=0.0000
    Epoch  7/10: total=21.1892, vae=1.0790, dsb=20.1102, bio=0.0000
    Epoch  8/10: total=20.9911, vae=1.0778, dsb=19.9133, bio=0.0000
    Epoch  9/10: total=20.9723, vae=1.0787, dsb=19.8936, bio=0.0000
    Epoch 10/10: total=20.9409, vae=1.0790, dsb=19.8619, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.4948, vae=1.0784, dsb=0.4164, bio=0.0000
    Epoch  2/10: total=1.4580, vae=1.0780, dsb=0.3800, bio=0.0000
    Epoch  3/10: total=1.4627, vae=1.0780, dsb=0.3847, bio=0.0000
    Epoch  4/10: total=1.4595, vae=1.0782, dsb=0.3813, bio=0.0000
    Epoch  5/10: total=1.4399, vae=1.0782, dsb=0.3617, bio=0.0000
    Epoch  6/10: total=1.4509, vae=1.0784, dsb=0.3725, bio=0.0000
    Epoch  7/10: total=1.4391, vae=1.0783, dsb=0.3609, bio=0.0000
    Epoch  8/10: total=1.4371, vae=1.0784, dsb=0.3587, bio=0.0000
    Epoch  9/10: total=1.4398, vae=1.0786, dsb=0.3612, bio=0.0000
    Epoch 10/10: total=1.4352, vae=1.0790, dsb=0.3562, bio=0.0000

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=19.1258, vae=1.0782, dsb=18.0476, bio=0.0000
    Epoch  2/10: total=18.7288, vae=1.0797, dsb=17.6491, bio=0.0000
    Epoch  3/10: total=18.6277, vae=1.0787, dsb=17.5490, bio=0.0000
    Epoch  4/10: total=18.5565, vae=1.0789, dsb=17.4776, bio=0.0000
    Epoch  5/10: total=18.4358, vae=1.0785, dsb=17.3574, bio=0.0000
    Epoch  6/10: total=18.5198, vae=1.0781, dsb=17.4417, bio=0.0000
    Epoch  7/10: total=18.3579, vae=1.0781, dsb=17.2797, bio=0.0000
    Epoch  8/10: total=18.5328, vae=1.0785, dsb=17.4543, bio=0.0000
    Epoch  9/10: total=18.3405, vae=1.0784, dsb=17.2621, bio=0.0000
    Epoch 10/10: total=18.4481, vae=1.0782, dsb=17.3699, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.3802, vae=1.0780, dsb=0.3022, bio=0.0000
    Epoch  2/10: total=1.3750, vae=1.0785, dsb=0.2966, bio=0.0000
    Epoch  3/10: total=1.3725, vae=1.0786, dsb=0.2939, bio=0.0000
    Epoch  4/10: total=1.3656, vae=1.0778, dsb=0.2878, bio=0.0000
    Epoch  5/10: total=1.3666, vae=1.0781, dsb=0.2885, bio=0.0000
    Epoch  6/10: total=1.3728, vae=1.0778, dsb=0.2951, bio=0.0000
    Epoch  7/10: total=1.3679, vae=1.0789, dsb=0.2891, bio=0.0000
    Epoch  8/10: total=1.3675, vae=1.0779, dsb=0.2896, bio=0.0000
    Epoch  9/10: total=1.3714, vae=1.0793, dsb=0.2921, bio=0.0000
    Epoch 10/10: total=1.3665, vae=1.0776, dsb=0.2889, bio=0.0000

[Seed 56] Joint training (ablation) complete; models and history saved.

[Seed 56] Drift genes saved in /home/yyuan/ICB_TCE/iter_results/run_056

[Seed 56] run finished.

================================================================================
[Seed 57] Starting running whole pipeline...
================================================================================

[Seed 57] Starting VAE pre-training...

    Epoch [01/20], Beta: 0.000, Average Loss: 537.1890
    Epoch [02/20], Beta: 0.000, Average Loss: 314.8542
    Epoch [03/20], Beta: 0.000, Average Loss: 273.7354
    Epoch [04/20], Beta: 0.000, Average Loss: 254.4241
    Epoch [05/20], Beta: 0.100, Average Loss: 248.3432
    Epoch [06/20], Beta: 0.200, Average Loss: 245.7809
    Epoch [07/20], Beta: 0.300, Average Loss: 245.3813
    Epoch [08/20], Beta: 0.400, Average Loss: 246.0190
    Epoch [09/20], Beta: 0.500, Average Loss: 247.0824
    Epoch [10/20], Beta: 0.600, Average Loss: 248.2800
    Epoch [11/20], Beta: 0.700, Average Loss: 249.4466
    Epoch [12/20], Beta: 0.800, Average Loss: 250.7106
    Epoch [13/20], Beta: 0.900, Average Loss: 251.9495
    Epoch [14/20], Beta: 1.000, Average Loss: 253.1599
    Epoch [15/20], Beta: 1.000, Average Loss: 252.7481
    Epoch [16/20], Beta: 1.000, Average Loss: 252.3817
    Epoch [17/20], Beta: 1.000, Average Loss: 252.0855
    Epoch [18/20], Beta: 1.000, Average Loss: 251.7563
    Epoch [19/20], Beta: 1.000, Average Loss: 251.4621
    Epoch [20/20], Beta: 1.000, Average Loss: 251.1285

[Seed 57] VAE pre-training complete.

[Seed 57] Starting joint training (original)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=244.5632, vae=3.7959, dsb=217.3790, bio=46.7765
    Epoch  2/10: total=65.0743, vae=1.0975, dsb=63.9403, bio=0.0731
    Epoch  3/10: total=53.0027, vae=1.0933, dsb=51.8935, bio=0.0317
    Epoch  4/10: total=47.3895, vae=1.0918, dsb=46.2884, bio=0.0186
    Epoch  5/10: total=44.1803, vae=1.0908, dsb=43.0831, bio=0.0127
    Epoch  6/10: total=42.1562, vae=1.0902, dsb=41.0613, bio=0.0095
    Epoch  7/10: total=40.4084, vae=1.0892, dsb=39.3155, bio=0.0075
    Epoch  8/10: total=39.0747, vae=1.0898, dsb=37.9818, bio=0.0061
    Epoch  9/10: total=38.0463, vae=1.0896, dsb=36.9541, bio=0.0051
    Epoch 10/10: total=37.3080, vae=1.0888, dsb=36.2170, bio=0.0045

  [Backward Policy Training]
    Epoch  1/10: total=3.1613, vae=1.0898, dsb=2.0654, bio=0.0123
    Epoch  2/10: total=2.6241, vae=1.0883, dsb=1.5334, bio=0.0047
    Epoch  3/10: total=2.5402, vae=1.0876, dsb=1.4508, bio=0.0035
    Epoch  4/10: total=2.4552, vae=1.0878, dsb=1.3659, bio=0.0029
    Epoch  5/10: total=2.3940, vae=1.0879, dsb=1.3048, bio=0.0026
    Epoch  6/10: total=2.3549, vae=1.0871, dsb=1.2666, bio=0.0024
    Epoch  7/10: total=2.3243, vae=1.0870, dsb=1.2362, bio=0.0022
    Epoch  8/10: total=2.2924, vae=1.0867, dsb=1.2046, bio=0.0021
    Epoch  9/10: total=2.2712, vae=1.0867, dsb=1.1835, bio=0.0021
    Epoch 10/10: total=2.2720, vae=1.0860, dsb=1.1849, bio=0.0022

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=34.7594, vae=1.0898, dsb=33.6679, bio=0.0033
    Epoch  2/10: total=27.4966, vae=1.0878, dsb=26.4079, bio=0.0019
    Epoch  3/10: total=25.7617, vae=1.0880, dsb=24.6728, bio=0.0019
    Epoch  4/10: total=24.6292, vae=1.0879, dsb=23.5404, bio=0.0019
    Epoch  5/10: total=23.9471, vae=1.0870, dsb=22.8592, bio=0.0019
    Epoch  6/10: total=23.5427, vae=1.0872, dsb=22.4545, bio=0.0019
    Epoch  7/10: total=23.2071, vae=1.0868, dsb=22.1193, bio=0.0018
    Epoch  8/10: total=22.8839, vae=1.0869, dsb=21.7960, bio=0.0020
    Epoch  9/10: total=22.5948, vae=1.0868, dsb=21.5071, bio=0.0019
    Epoch 10/10: total=22.4402, vae=1.0865, dsb=21.3528, bio=0.0019

  [Backward Policy Training]
    Epoch  1/10: total=2.0320, vae=1.0866, dsb=0.9428, bio=0.0054
    Epoch  2/10: total=1.9010, vae=1.0860, dsb=0.8139, bio=0.0020
    Epoch  3/10: total=1.8611, vae=1.0856, dsb=0.7746, bio=0.0019
    Epoch  4/10: total=1.8352, vae=1.0852, dsb=0.7490, bio=0.0018
    Epoch  5/10: total=1.8254, vae=1.0856, dsb=0.7389, bio=0.0017
    Epoch  6/10: total=1.8241, vae=1.0857, dsb=0.7375, bio=0.0017
    Epoch  7/10: total=1.7942, vae=1.0852, dsb=0.7082, bio=0.0016
    Epoch  8/10: total=1.7963, vae=1.0857, dsb=0.7098, bio=0.0017
    Epoch  9/10: total=1.7829, vae=1.0853, dsb=0.6967, bio=0.0017
    Epoch 10/10: total=1.7741, vae=1.0854, dsb=0.6878, bio=0.0017

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=24.1969, vae=1.0888, dsb=23.1066, bio=0.0030
    Epoch  2/10: total=21.2196, vae=1.0871, dsb=20.1314, bio=0.0020
    Epoch  3/10: total=20.5056, vae=1.0864, dsb=19.4184, bio=0.0016
    Epoch  4/10: total=20.0077, vae=1.0862, dsb=18.9207, bio=0.0017
    Epoch  5/10: total=19.7407, vae=1.0870, dsb=18.6529, bio=0.0017
    Epoch  6/10: total=19.5639, vae=1.0871, dsb=18.4759, bio=0.0017
    Epoch  7/10: total=19.4022, vae=1.0867, dsb=18.3147, bio=0.0015
    Epoch  8/10: total=19.1877, vae=1.0858, dsb=18.1008, bio=0.0021
    Epoch  9/10: total=19.2203, vae=1.0869, dsb=18.1325, bio=0.0018
    Epoch 10/10: total=19.1379, vae=1.0866, dsb=18.0505, bio=0.0018

  [Backward Policy Training]
    Epoch  1/10: total=1.6992, vae=1.0873, dsb=0.6083, bio=0.0072
    Epoch  2/10: total=1.6367, vae=1.0861, dsb=0.5497, bio=0.0018
    Epoch  3/10: total=1.5989, vae=1.0851, dsb=0.5131, bio=0.0016
    Epoch  4/10: total=1.5972, vae=1.0852, dsb=0.5111, bio=0.0017
    Epoch  5/10: total=1.5750, vae=1.0855, dsb=0.4887, bio=0.0015
    Epoch  6/10: total=1.5843, vae=1.0854, dsb=0.4982, bio=0.0015
    Epoch  7/10: total=1.5794, vae=1.0853, dsb=0.4934, bio=0.0015
    Epoch  8/10: total=1.5711, vae=1.0852, dsb=0.4852, bio=0.0015
    Epoch  9/10: total=1.5641, vae=1.0848, dsb=0.4785, bio=0.0015
    Epoch 10/10: total=1.5519, vae=1.0849, dsb=0.4661, bio=0.0018

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=17.8643, vae=1.0885, dsb=16.7743, bio=0.0029
    Epoch  2/10: total=16.5388, vae=1.0863, dsb=15.4517, bio=0.0015
    Epoch  3/10: total=16.2008, vae=1.0866, dsb=15.1134, bio=0.0016
    Epoch  4/10: total=16.1207, vae=1.0851, dsb=15.0348, bio=0.0016
    Epoch  5/10: total=15.8923, vae=1.0864, dsb=14.8050, bio=0.0017
    Epoch  6/10: total=15.8510, vae=1.0851, dsb=14.7651, bio=0.0016
    Epoch  7/10: total=15.8063, vae=1.0871, dsb=14.7183, bio=0.0017
    Epoch  8/10: total=15.6939, vae=1.0871, dsb=14.6060, bio=0.0016
    Epoch  9/10: total=15.6503, vae=1.0857, dsb=14.5638, bio=0.0016
    Epoch 10/10: total=15.6441, vae=1.0860, dsb=14.5573, bio=0.0016

  [Backward Policy Training]
    Epoch  1/10: total=1.5019, vae=1.0869, dsb=0.4103, bio=0.0094
    Epoch  2/10: total=1.4695, vae=1.0848, dsb=0.3839, bio=0.0015
    Epoch  3/10: total=1.4661, vae=1.0858, dsb=0.3796, bio=0.0014
    Epoch  4/10: total=1.4584, vae=1.0841, dsb=0.3736, bio=0.0015
    Epoch  5/10: total=1.4559, vae=1.0840, dsb=0.3712, bio=0.0015
    Epoch  6/10: total=1.4509, vae=1.0849, dsb=0.3654, bio=0.0013
    Epoch  7/10: total=1.4395, vae=1.0841, dsb=0.3547, bio=0.0013
    Epoch  8/10: total=1.4419, vae=1.0848, dsb=0.3564, bio=0.0014
    Epoch  9/10: total=1.4515, vae=1.0841, dsb=0.3666, bio=0.0013
    Epoch 10/10: total=1.4472, vae=1.0843, dsb=0.3621, bio=0.0015

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=14.8187, vae=1.0873, dsb=13.7293, bio=0.0043
    Epoch  2/10: total=14.3426, vae=1.0856, dsb=13.2562, bio=0.0014
    Epoch  3/10: total=14.3057, vae=1.0852, dsb=13.2198, bio=0.0015
    Epoch  4/10: total=14.1435, vae=1.0864, dsb=13.0563, bio=0.0016
    Epoch  5/10: total=14.0971, vae=1.0856, dsb=13.0108, bio=0.0014
    Epoch  6/10: total=14.0442, vae=1.0853, dsb=12.9582, bio=0.0015
    Epoch  7/10: total=14.0922, vae=1.0860, dsb=13.0054, bio=0.0015
    Epoch  8/10: total=14.0147, vae=1.0854, dsb=12.9285, bio=0.0015
    Epoch  9/10: total=14.0209, vae=1.0855, dsb=12.9346, bio=0.0015
    Epoch 10/10: total=13.9936, vae=1.0859, dsb=12.9067, bio=0.0020

  [Backward Policy Training]
    Epoch  1/10: total=1.3975, vae=1.0857, dsb=0.3012, bio=0.0211
    Epoch  2/10: total=1.3709, vae=1.0842, dsb=0.2860, bio=0.0014
    Epoch  3/10: total=1.3835, vae=1.0841, dsb=0.2988, bio=0.0013
    Epoch  4/10: total=1.3738, vae=1.0840, dsb=0.2891, bio=0.0013
    Epoch  5/10: total=1.3714, vae=1.0840, dsb=0.2867, bio=0.0014
    Epoch  6/10: total=1.3765, vae=1.0842, dsb=0.2917, bio=0.0012
    Epoch  7/10: total=1.3640, vae=1.0842, dsb=0.2792, bio=0.0012
    Epoch  8/10: total=1.3689, vae=1.0829, dsb=0.2853, bio=0.0012
    Epoch  9/10: total=1.3659, vae=1.0841, dsb=0.2812, bio=0.0012
    Epoch 10/10: total=1.3740, vae=1.0840, dsb=0.2894, bio=0.0012

[Seed 57] Joint training (original) complete; models and history saved.

[Seed 57] Starting joint training (ablation)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=219.1983, vae=2.0318, dsb=217.1665, bio=0.0000
    Epoch  2/10: total=64.8488, vae=1.0809, dsb=63.7679, bio=0.0000
    Epoch  3/10: total=52.7966, vae=1.0794, dsb=51.7172, bio=0.0000
    Epoch  4/10: total=47.1907, vae=1.0788, dsb=46.1120, bio=0.0000
    Epoch  5/10: total=43.9462, vae=1.0781, dsb=42.8681, bio=0.0000
    Epoch  6/10: total=41.9154, vae=1.0777, dsb=40.8376, bio=0.0000
    Epoch  7/10: total=40.1668, vae=1.0770, dsb=39.0898, bio=0.0000
    Epoch  8/10: total=38.8126, vae=1.0778, dsb=37.7348, bio=0.0000
    Epoch  9/10: total=37.7712, vae=1.0778, dsb=36.6933, bio=0.0000
    Epoch 10/10: total=37.0080, vae=1.0773, dsb=35.9307, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=3.0973, vae=1.0773, dsb=2.0200, bio=0.0000
    Epoch  2/10: total=2.5738, vae=1.0775, dsb=1.4963, bio=0.0000
    Epoch  3/10: total=2.4901, vae=1.0771, dsb=1.4129, bio=0.0000
    Epoch  4/10: total=2.4067, vae=1.0776, dsb=1.3291, bio=0.0000
    Epoch  5/10: total=2.3442, vae=1.0779, dsb=1.2663, bio=0.0000
    Epoch  6/10: total=2.3049, vae=1.0773, dsb=1.2276, bio=0.0000
    Epoch  7/10: total=2.2715, vae=1.0772, dsb=1.1943, bio=0.0000
    Epoch  8/10: total=2.2396, vae=1.0772, dsb=1.1625, bio=0.0000
    Epoch  9/10: total=2.2191, vae=1.0772, dsb=1.1419, bio=0.0000
    Epoch 10/10: total=2.2174, vae=1.0767, dsb=1.1408, bio=0.0000

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=33.7777, vae=1.0779, dsb=32.6998, bio=0.0000
    Epoch  2/10: total=26.6339, vae=1.0769, dsb=25.5570, bio=0.0000
    Epoch  3/10: total=24.9679, vae=1.0774, dsb=23.8905, bio=0.0000
    Epoch  4/10: total=23.8657, vae=1.0774, dsb=22.7882, bio=0.0000
    Epoch  5/10: total=23.2184, vae=1.0767, dsb=22.1418, bio=0.0000
    Epoch  6/10: total=22.8398, vae=1.0769, dsb=21.7629, bio=0.0000
    Epoch  7/10: total=22.5094, vae=1.0766, dsb=21.4328, bio=0.0000
    Epoch  8/10: total=22.2403, vae=1.0768, dsb=21.1635, bio=0.0000
    Epoch  9/10: total=21.9556, vae=1.0767, dsb=20.8789, bio=0.0000
    Epoch 10/10: total=21.8071, vae=1.0765, dsb=20.7307, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.9960, vae=1.0763, dsb=0.9197, bio=0.0000
    Epoch  2/10: total=1.8704, vae=1.0770, dsb=0.7933, bio=0.0000
    Epoch  3/10: total=1.8310, vae=1.0767, dsb=0.7543, bio=0.0000
    Epoch  4/10: total=1.8047, vae=1.0764, dsb=0.7283, bio=0.0000
    Epoch  5/10: total=1.7949, vae=1.0768, dsb=0.7180, bio=0.0000
    Epoch  6/10: total=1.7944, vae=1.0770, dsb=0.7174, bio=0.0000
    Epoch  7/10: total=1.7645, vae=1.0765, dsb=0.6880, bio=0.0000
    Epoch  8/10: total=1.7668, vae=1.0772, dsb=0.6896, bio=0.0000
    Epoch  9/10: total=1.7538, vae=1.0767, dsb=0.6770, bio=0.0000
    Epoch 10/10: total=1.7455, vae=1.0769, dsb=0.6686, bio=0.0000

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=23.3770, vae=1.0776, dsb=22.2994, bio=0.0000
    Epoch  2/10: total=20.4156, vae=1.0770, dsb=19.3386, bio=0.0000
    Epoch  3/10: total=19.6688, vae=1.0765, dsb=18.5923, bio=0.0000
    Epoch  4/10: total=19.1900, vae=1.0764, dsb=18.1136, bio=0.0000
    Epoch  5/10: total=18.9246, vae=1.0773, dsb=17.8472, bio=0.0000
    Epoch  6/10: total=18.7289, vae=1.0776, dsb=17.6513, bio=0.0000
    Epoch  7/10: total=18.5834, vae=1.0772, dsb=17.5062, bio=0.0000
    Epoch  8/10: total=18.3827, vae=1.0764, dsb=17.3063, bio=0.0000
    Epoch  9/10: total=18.3968, vae=1.0775, dsb=17.3193, bio=0.0000
    Epoch 10/10: total=18.3200, vae=1.0772, dsb=17.2428, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.6597, vae=1.0773, dsb=0.5825, bio=0.0000
    Epoch  2/10: total=1.6034, vae=1.0775, dsb=0.5258, bio=0.0000
    Epoch  3/10: total=1.5675, vae=1.0766, dsb=0.4909, bio=0.0000
    Epoch  4/10: total=1.5664, vae=1.0768, dsb=0.4896, bio=0.0000
    Epoch  5/10: total=1.5452, vae=1.0773, dsb=0.4679, bio=0.0000
    Epoch  6/10: total=1.5539, vae=1.0771, dsb=0.4768, bio=0.0000
    Epoch  7/10: total=1.5497, vae=1.0771, dsb=0.4726, bio=0.0000
    Epoch  8/10: total=1.5417, vae=1.0770, dsb=0.4647, bio=0.0000
    Epoch  9/10: total=1.5351, vae=1.0767, dsb=0.4584, bio=0.0000
    Epoch 10/10: total=1.5236, vae=1.0767, dsb=0.4469, bio=0.0000

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=16.9782, vae=1.0775, dsb=15.9006, bio=0.0000
    Epoch  2/10: total=15.7094, vae=1.0767, dsb=14.6327, bio=0.0000
    Epoch  3/10: total=15.3697, vae=1.0772, dsb=14.2926, bio=0.0000
    Epoch  4/10: total=15.3030, vae=1.0758, dsb=14.2272, bio=0.0000
    Epoch  5/10: total=15.0675, vae=1.0773, dsb=13.9902, bio=0.0000
    Epoch  6/10: total=15.0484, vae=1.0759, dsb=13.9724, bio=0.0000
    Epoch  7/10: total=14.9939, vae=1.0781, dsb=13.9158, bio=0.0000
    Epoch  8/10: total=14.8833, vae=1.0781, dsb=13.8052, bio=0.0000
    Epoch  9/10: total=14.8506, vae=1.0767, dsb=13.7739, bio=0.0000
    Epoch 10/10: total=14.8414, vae=1.0771, dsb=13.7644, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.4731, vae=1.0777, dsb=0.3954, bio=0.0000
    Epoch  2/10: total=1.4459, vae=1.0767, dsb=0.3692, bio=0.0000
    Epoch  3/10: total=1.4430, vae=1.0778, dsb=0.3652, bio=0.0000
    Epoch  4/10: total=1.4356, vae=1.0761, dsb=0.3595, bio=0.0000
    Epoch  5/10: total=1.4335, vae=1.0761, dsb=0.3574, bio=0.0000
    Epoch  6/10: total=1.4289, vae=1.0771, dsb=0.3518, bio=0.0000
    Epoch  7/10: total=1.4178, vae=1.0763, dsb=0.3414, bio=0.0000
    Epoch  8/10: total=1.4204, vae=1.0770, dsb=0.3434, bio=0.0000
    Epoch  9/10: total=1.4295, vae=1.0765, dsb=0.3530, bio=0.0000
    Epoch 10/10: total=1.4253, vae=1.0765, dsb=0.3487, bio=0.0000

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=14.0758, vae=1.0766, dsb=12.9992, bio=0.0000
    Epoch  2/10: total=13.5669, vae=1.0763, dsb=12.4906, bio=0.0000
    Epoch  3/10: total=13.5218, vae=1.0761, dsb=12.4457, bio=0.0000
    Epoch  4/10: total=13.3824, vae=1.0774, dsb=12.3050, bio=0.0000
    Epoch  5/10: total=13.3399, vae=1.0768, dsb=12.2631, bio=0.0000
    Epoch  6/10: total=13.2781, vae=1.0766, dsb=12.2015, bio=0.0000
    Epoch  7/10: total=13.3207, vae=1.0774, dsb=12.2433, bio=0.0000
    Epoch  8/10: total=13.2523, vae=1.0768, dsb=12.1754, bio=0.0000
    Epoch  9/10: total=13.2525, vae=1.0770, dsb=12.1755, bio=0.0000
    Epoch 10/10: total=13.2201, vae=1.0774, dsb=12.1427, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.3628, vae=1.0768, dsb=0.2859, bio=0.0000
    Epoch  2/10: total=1.3476, vae=1.0763, dsb=0.2713, bio=0.0000
    Epoch  3/10: total=1.3602, vae=1.0764, dsb=0.2838, bio=0.0000
    Epoch  4/10: total=1.3508, vae=1.0765, dsb=0.2744, bio=0.0000
    Epoch  5/10: total=1.3483, vae=1.0765, dsb=0.2718, bio=0.0000
    Epoch  6/10: total=1.3535, vae=1.0769, dsb=0.2766, bio=0.0000
    Epoch  7/10: total=1.3414, vae=1.0769, dsb=0.2645, bio=0.0000
    Epoch  8/10: total=1.3463, vae=1.0757, dsb=0.2706, bio=0.0000
    Epoch  9/10: total=1.3435, vae=1.0769, dsb=0.2665, bio=0.0000
    Epoch 10/10: total=1.3517, vae=1.0769, dsb=0.2747, bio=0.0000

[Seed 57] Joint training (ablation) complete; models and history saved.

[Seed 57] Drift genes saved in /home/yyuan/ICB_TCE/iter_results/run_057

[Seed 57] run finished.

================================================================================
[Seed 58] Starting running whole pipeline...
================================================================================

[Seed 58] Starting VAE pre-training...

    Epoch [01/20], Beta: 0.000, Average Loss: 534.5664
    Epoch [02/20], Beta: 0.000, Average Loss: 305.2912
    Epoch [03/20], Beta: 0.000, Average Loss: 269.9313
    Epoch [04/20], Beta: 0.000, Average Loss: 250.5902
    Epoch [05/20], Beta: 0.100, Average Loss: 245.7915
    Epoch [06/20], Beta: 0.200, Average Loss: 244.3209
    Epoch [07/20], Beta: 0.300, Average Loss: 244.5058
    Epoch [08/20], Beta: 0.400, Average Loss: 245.3327
    Epoch [09/20], Beta: 0.500, Average Loss: 246.3643
    Epoch [10/20], Beta: 0.600, Average Loss: 247.5428
    Epoch [11/20], Beta: 0.700, Average Loss: 248.8325
    Epoch [12/20], Beta: 0.800, Average Loss: 250.1412
    Epoch [13/20], Beta: 0.900, Average Loss: 251.4453
    Epoch [14/20], Beta: 1.000, Average Loss: 253.0506
    Epoch [15/20], Beta: 1.000, Average Loss: 252.7216
    Epoch [16/20], Beta: 1.000, Average Loss: 252.3855
    Epoch [17/20], Beta: 1.000, Average Loss: 252.0164
    Epoch [18/20], Beta: 1.000, Average Loss: 251.7189
    Epoch [19/20], Beta: 1.000, Average Loss: 251.3273
    Epoch [20/20], Beta: 1.000, Average Loss: 251.1866

[Seed 58] VAE pre-training complete.

[Seed 58] Starting joint training (original)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=285.8004, vae=3.5667, dsb=267.6469, bio=29.1736
    Epoch  2/10: total=78.0720, vae=1.1010, dsb=76.9338, bio=0.0744
    Epoch  3/10: total=67.7937, vae=1.0962, dsb=66.6813, bio=0.0324
    Epoch  4/10: total=63.1816, vae=1.0947, dsb=62.0774, bio=0.0190
    Epoch  5/10: total=60.5300, vae=1.0923, dsb=59.4315, bio=0.0124
    Epoch  6/10: total=58.7189, vae=1.0919, dsb=57.6226, bio=0.0090
    Epoch  7/10: total=57.1102, vae=1.0922, dsb=56.0146, bio=0.0069
    Epoch  8/10: total=56.2892, vae=1.0906, dsb=55.1957, bio=0.0057
    Epoch  9/10: total=55.4432, vae=1.0913, dsb=54.3495, bio=0.0048
    Epoch 10/10: total=54.5672, vae=1.0915, dsb=53.4735, bio=0.0043

  [Backward Policy Training]
    Epoch  1/10: total=3.1009, vae=1.0920, dsb=2.0025, bio=0.0129
    Epoch  2/10: total=2.6255, vae=1.0915, dsb=1.5316, bio=0.0047
    Epoch  3/10: total=2.5002, vae=1.0898, dsb=1.4088, bio=0.0035
    Epoch  4/10: total=2.4260, vae=1.0891, dsb=1.3354, bio=0.0029
    Epoch  5/10: total=2.3680, vae=1.0897, dsb=1.2770, bio=0.0026
    Epoch  6/10: total=2.3194, vae=1.0898, dsb=1.2284, bio=0.0024
    Epoch  7/10: total=2.3118, vae=1.0894, dsb=1.2213, bio=0.0023
    Epoch  8/10: total=2.2731, vae=1.0894, dsb=1.1826, bio=0.0022
    Epoch  9/10: total=2.2672, vae=1.0885, dsb=1.1777, bio=0.0021
    Epoch 10/10: total=2.2633, vae=1.0887, dsb=1.1736, bio=0.0020

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=47.1698, vae=1.0919, dsb=46.0755, bio=0.0048
    Epoch  2/10: total=41.2918, vae=1.0894, dsb=40.2014, bio=0.0020
    Epoch  3/10: total=39.7530, vae=1.0894, dsb=38.6626, bio=0.0020
    Epoch  4/10: total=39.2968, vae=1.0902, dsb=38.2057, bio=0.0020
    Epoch  5/10: total=38.6084, vae=1.0892, dsb=37.5182, bio=0.0020
    Epoch  6/10: total=38.2619, vae=1.0890, dsb=37.1720, bio=0.0019
    Epoch  7/10: total=38.0292, vae=1.0896, dsb=36.9384, bio=0.0026
    Epoch  8/10: total=37.7599, vae=1.0883, dsb=36.6707, bio=0.0019
    Epoch  9/10: total=37.3769, vae=1.0889, dsb=36.2870, bio=0.0019
    Epoch 10/10: total=37.4187, vae=1.0889, dsb=36.3288, bio=0.0019

  [Backward Policy Training]
    Epoch  1/10: total=2.0204, vae=1.0895, dsb=0.9278, bio=0.0062
    Epoch  2/10: total=1.8911, vae=1.0880, dsb=0.8021, bio=0.0020
    Epoch  3/10: total=1.8698, vae=1.0880, dsb=0.7809, bio=0.0019
    Epoch  4/10: total=1.8411, vae=1.0877, dsb=0.7524, bio=0.0018
    Epoch  5/10: total=1.8549, vae=1.0880, dsb=0.7660, bio=0.0018
    Epoch  6/10: total=1.8357, vae=1.0877, dsb=0.7471, bio=0.0017
    Epoch  7/10: total=1.8229, vae=1.0876, dsb=0.7344, bio=0.0020
    Epoch  8/10: total=1.8067, vae=1.0880, dsb=0.7178, bio=0.0016
    Epoch  9/10: total=1.8056, vae=1.0880, dsb=0.7168, bio=0.0016
    Epoch 10/10: total=1.7823, vae=1.0870, dsb=0.6945, bio=0.0016

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=34.9969, vae=1.0899, dsb=33.9054, bio=0.0033
    Epoch  2/10: total=33.0234, vae=1.0894, dsb=31.9331, bio=0.0017
    Epoch  3/10: total=32.3330, vae=1.0888, dsb=31.2434, bio=0.0017
    Epoch  4/10: total=31.9539, vae=1.0887, dsb=30.8643, bio=0.0017
    Epoch  5/10: total=31.7753, vae=1.0889, dsb=30.6855, bio=0.0019
    Epoch  6/10: total=31.6402, vae=1.0881, dsb=30.5513, bio=0.0017
    Epoch  7/10: total=31.5191, vae=1.0876, dsb=30.4306, bio=0.0017
    Epoch  8/10: total=31.4522, vae=1.0886, dsb=30.3627, bio=0.0017
    Epoch  9/10: total=31.2838, vae=1.0879, dsb=30.1951, bio=0.0017
    Epoch 10/10: total=31.4426, vae=1.0882, dsb=30.3536, bio=0.0017

  [Backward Policy Training]
    Epoch  1/10: total=1.7097, vae=1.0883, dsb=0.6153, bio=0.0120
    Epoch  2/10: total=1.6530, vae=1.0875, dsb=0.5646, bio=0.0017
    Epoch  3/10: total=1.6500, vae=1.0874, dsb=0.5619, bio=0.0016
    Epoch  4/10: total=1.6444, vae=1.0869, dsb=0.5568, bio=0.0015
    Epoch  5/10: total=1.6123, vae=1.0873, dsb=0.5243, bio=0.0015
    Epoch  6/10: total=1.6156, vae=1.0871, dsb=0.5277, bio=0.0018
    Epoch  7/10: total=1.6256, vae=1.0867, dsb=0.5383, bio=0.0014
    Epoch  8/10: total=1.6128, vae=1.0866, dsb=0.5255, bio=0.0014
    Epoch  9/10: total=1.6083, vae=1.0868, dsb=0.5208, bio=0.0014
    Epoch 10/10: total=1.6046, vae=1.0870, dsb=0.5169, bio=0.0014

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=27.4322, vae=1.0898, dsb=26.3410, bio=0.0029
    Epoch  2/10: total=26.6172, vae=1.0883, dsb=25.5281, bio=0.0015
    Epoch  3/10: total=26.2397, vae=1.0877, dsb=25.1512, bio=0.0016
    Epoch  4/10: total=26.2500, vae=1.0872, dsb=25.1621, bio=0.0015
    Epoch  5/10: total=26.2105, vae=1.0871, dsb=25.1226, bio=0.0016
    Epoch  6/10: total=26.1043, vae=1.0876, dsb=25.0160, bio=0.0014
    Epoch  7/10: total=26.2400, vae=1.0873, dsb=25.1519, bio=0.0015
    Epoch  8/10: total=26.0854, vae=1.0874, dsb=24.9973, bio=0.0015
    Epoch  9/10: total=25.8978, vae=1.0876, dsb=24.8095, bio=0.0015
    Epoch 10/10: total=25.9474, vae=1.0870, dsb=24.8596, bio=0.0014

  [Backward Policy Training]
    Epoch  1/10: total=1.5731, vae=1.0885, dsb=0.4485, bio=0.0722
    Epoch  2/10: total=1.5143, vae=1.0874, dsb=0.4261, bio=0.0015
    Epoch  3/10: total=1.5004, vae=1.0869, dsb=0.4129, bio=0.0014
    Epoch  4/10: total=1.5096, vae=1.0866, dsb=0.4223, bio=0.0013
    Epoch  5/10: total=1.5005, vae=1.0864, dsb=0.4135, bio=0.0013
    Epoch  6/10: total=1.5015, vae=1.0860, dsb=0.4148, bio=0.0013
    Epoch  7/10: total=1.4977, vae=1.0861, dsb=0.4109, bio=0.0013
    Epoch  8/10: total=1.5049, vae=1.0872, dsb=0.4171, bio=0.0012
    Epoch  9/10: total=1.4849, vae=1.0866, dsb=0.3977, bio=0.0012
    Epoch 10/10: total=1.4948, vae=1.0864, dsb=0.4078, bio=0.0012

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=22.4059, vae=1.0897, dsb=21.3146, bio=0.0032
    Epoch  2/10: total=22.1609, vae=1.0876, dsb=21.0727, bio=0.0013
    Epoch  3/10: total=22.1970, vae=1.0881, dsb=21.1082, bio=0.0014
    Epoch  4/10: total=22.0273, vae=1.0877, dsb=20.9390, bio=0.0013
    Epoch  5/10: total=22.0146, vae=1.0881, dsb=20.9257, bio=0.0016
    Epoch  6/10: total=21.9343, vae=1.0869, dsb=20.8468, bio=0.0012
    Epoch  7/10: total=22.0423, vae=1.0873, dsb=20.9544, bio=0.0012
    Epoch  8/10: total=21.9720, vae=1.0862, dsb=20.8853, bio=0.0012
    Epoch  9/10: total=21.9596, vae=1.0874, dsb=20.8716, bio=0.0012
    Epoch 10/10: total=21.9386, vae=1.0880, dsb=20.8500, bio=0.0012

  [Backward Policy Training]
    Epoch  1/10: total=1.5100, vae=1.0873, dsb=0.3562, bio=0.1331
    Epoch  2/10: total=1.4305, vae=1.0868, dsb=0.3430, bio=0.0013
    Epoch  3/10: total=1.4429, vae=1.0871, dsb=0.3552, bio=0.0012
    Epoch  4/10: total=1.4390, vae=1.0868, dsb=0.3517, bio=0.0011
    Epoch  5/10: total=1.4319, vae=1.0864, dsb=0.3450, bio=0.0011
    Epoch  6/10: total=1.4350, vae=1.0859, dsb=0.3486, bio=0.0011
    Epoch  7/10: total=1.4435, vae=1.0862, dsb=0.3567, bio=0.0011
    Epoch  8/10: total=1.4351, vae=1.0865, dsb=0.3480, bio=0.0011
    Epoch  9/10: total=1.4445, vae=1.0861, dsb=0.3578, bio=0.0011
    Epoch 10/10: total=1.4290, vae=1.0862, dsb=0.3422, bio=0.0011

[Seed 58] Joint training (original) complete; models and history saved.

[Seed 58] Starting joint training (ablation)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=268.8511, vae=1.9857, dsb=266.8654, bio=0.0000
    Epoch  2/10: total=77.2202, vae=1.0828, dsb=76.1373, bio=0.0000
    Epoch  3/10: total=67.3457, vae=1.0816, dsb=66.2641, bio=0.0000
    Epoch  4/10: total=62.7782, vae=1.0812, dsb=61.6970, bio=0.0000
    Epoch  5/10: total=60.1511, vae=1.0793, dsb=59.0718, bio=0.0000
    Epoch  6/10: total=58.3228, vae=1.0791, dsb=57.2437, bio=0.0000
    Epoch  7/10: total=56.6508, vae=1.0797, dsb=55.5711, bio=0.0000
    Epoch  8/10: total=55.7433, vae=1.0785, dsb=54.6648, bio=0.0000
    Epoch  9/10: total=54.9000, vae=1.0794, dsb=53.8206, bio=0.0000
    Epoch 10/10: total=54.0470, vae=1.0800, dsb=52.9670, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=2.9752, vae=1.0796, dsb=1.8956, bio=0.0000
    Epoch  2/10: total=2.5511, vae=1.0806, dsb=1.4705, bio=0.0000
    Epoch  3/10: total=2.4314, vae=1.0794, dsb=1.3520, bio=0.0000
    Epoch  4/10: total=2.3590, vae=1.0791, dsb=1.2800, bio=0.0000
    Epoch  5/10: total=2.3019, vae=1.0798, dsb=1.2221, bio=0.0000
    Epoch  6/10: total=2.2542, vae=1.0801, dsb=1.1741, bio=0.0000
    Epoch  7/10: total=2.2477, vae=1.0799, dsb=1.1678, bio=0.0000
    Epoch  8/10: total=2.2117, vae=1.0799, dsb=1.1318, bio=0.0000
    Epoch  9/10: total=2.2087, vae=1.0792, dsb=1.1295, bio=0.0000
    Epoch 10/10: total=2.2045, vae=1.0795, dsb=1.1251, bio=0.0000

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=46.6779, vae=1.0790, dsb=45.5989, bio=0.0000
    Epoch  2/10: total=41.1165, vae=1.0787, dsb=40.0379, bio=0.0000
    Epoch  3/10: total=39.6531, vae=1.0788, dsb=38.5743, bio=0.0000
    Epoch  4/10: total=39.2156, vae=1.0798, dsb=38.1358, bio=0.0000
    Epoch  5/10: total=38.5546, vae=1.0790, dsb=37.4757, bio=0.0000
    Epoch  6/10: total=38.2366, vae=1.0788, dsb=37.1578, bio=0.0000
    Epoch  7/10: total=38.0300, vae=1.0794, dsb=36.9506, bio=0.0000
    Epoch  8/10: total=37.7659, vae=1.0784, dsb=36.6875, bio=0.0000
    Epoch  9/10: total=37.3780, vae=1.0790, dsb=36.2990, bio=0.0000
    Epoch 10/10: total=37.4296, vae=1.0791, dsb=36.3504, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.9853, vae=1.0792, dsb=0.9062, bio=0.0000
    Epoch  2/10: total=1.8650, vae=1.0790, dsb=0.7860, bio=0.0000
    Epoch  3/10: total=1.8465, vae=1.0792, dsb=0.7672, bio=0.0000
    Epoch  4/10: total=1.8190, vae=1.0790, dsb=0.7399, bio=0.0000
    Epoch  5/10: total=1.8340, vae=1.0794, dsb=0.7546, bio=0.0000
    Epoch  6/10: total=1.8147, vae=1.0791, dsb=0.7356, bio=0.0000
    Epoch  7/10: total=1.8025, vae=1.0790, dsb=0.7235, bio=0.0000
    Epoch  8/10: total=1.7859, vae=1.0795, dsb=0.7064, bio=0.0000
    Epoch  9/10: total=1.7850, vae=1.0795, dsb=0.7054, bio=0.0000
    Epoch 10/10: total=1.7616, vae=1.0786, dsb=0.6830, bio=0.0000

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=35.8508, vae=1.0787, dsb=34.7722, bio=0.0000
    Epoch  2/10: total=33.9168, vae=1.0796, dsb=32.8372, bio=0.0000
    Epoch  3/10: total=33.2254, vae=1.0793, dsb=32.1462, bio=0.0000
    Epoch  4/10: total=32.8281, vae=1.0793, dsb=31.7488, bio=0.0000
    Epoch  5/10: total=32.6506, vae=1.0795, dsb=31.5711, bio=0.0000
    Epoch  6/10: total=32.5054, vae=1.0789, dsb=31.4266, bio=0.0000
    Epoch  7/10: total=32.4038, vae=1.0785, dsb=31.3253, bio=0.0000
    Epoch  8/10: total=32.3218, vae=1.0796, dsb=31.2422, bio=0.0000
    Epoch  9/10: total=32.1428, vae=1.0788, dsb=31.0640, bio=0.0000
    Epoch 10/10: total=32.2947, vae=1.0792, dsb=31.2155, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.6808, vae=1.0789, dsb=0.6019, bio=0.0000
    Epoch  2/10: total=1.6330, vae=1.0791, dsb=0.5539, bio=0.0000
    Epoch  3/10: total=1.6305, vae=1.0792, dsb=0.5513, bio=0.0000
    Epoch  4/10: total=1.6258, vae=1.0788, dsb=0.5470, bio=0.0000
    Epoch  5/10: total=1.5931, vae=1.0792, dsb=0.5140, bio=0.0000
    Epoch  6/10: total=1.5970, vae=1.0790, dsb=0.5180, bio=0.0000
    Epoch  7/10: total=1.6072, vae=1.0787, dsb=0.5286, bio=0.0000
    Epoch  8/10: total=1.5947, vae=1.0786, dsb=0.5161, bio=0.0000
    Epoch  9/10: total=1.5905, vae=1.0789, dsb=0.5116, bio=0.0000
    Epoch 10/10: total=1.5865, vae=1.0790, dsb=0.5075, bio=0.0000

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=28.6253, vae=1.0789, dsb=27.5464, bio=0.0000
    Epoch  2/10: total=27.8569, vae=1.0790, dsb=26.7780, bio=0.0000
    Epoch  3/10: total=27.4676, vae=1.0788, dsb=26.3888, bio=0.0000
    Epoch  4/10: total=27.5031, vae=1.0784, dsb=26.4247, bio=0.0000
    Epoch  5/10: total=27.4400, vae=1.0784, dsb=26.3617, bio=0.0000
    Epoch  6/10: total=27.3130, vae=1.0791, dsb=26.2340, bio=0.0000
    Epoch  7/10: total=27.5233, vae=1.0788, dsb=26.4444, bio=0.0000
    Epoch  8/10: total=27.3395, vae=1.0790, dsb=26.2605, bio=0.0000
    Epoch  9/10: total=27.1508, vae=1.0793, dsb=26.0715, bio=0.0000
    Epoch 10/10: total=27.2051, vae=1.0788, dsb=26.1263, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.5074, vae=1.0795, dsb=0.4280, bio=0.0000
    Epoch  2/10: total=1.4892, vae=1.0794, dsb=0.4098, bio=0.0000
    Epoch  3/10: total=1.4770, vae=1.0789, dsb=0.3981, bio=0.0000
    Epoch  4/10: total=1.4874, vae=1.0788, dsb=0.4086, bio=0.0000
    Epoch  5/10: total=1.4787, vae=1.0786, dsb=0.4001, bio=0.0000
    Epoch  6/10: total=1.4804, vae=1.0782, dsb=0.4022, bio=0.0000
    Epoch  7/10: total=1.4767, vae=1.0784, dsb=0.3984, bio=0.0000
    Epoch  8/10: total=1.4848, vae=1.0795, dsb=0.4053, bio=0.0000
    Epoch  9/10: total=1.4648, vae=1.0789, dsb=0.3859, bio=0.0000
    Epoch 10/10: total=1.4752, vae=1.0787, dsb=0.3965, bio=0.0000

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=23.7553, vae=1.0786, dsb=22.6766, bio=0.0000
    Epoch  2/10: total=23.5229, vae=1.0785, dsb=22.4445, bio=0.0000
    Epoch  3/10: total=23.6087, vae=1.0794, dsb=22.5293, bio=0.0000
    Epoch  4/10: total=23.4201, vae=1.0793, dsb=22.3408, bio=0.0000
    Epoch  5/10: total=23.4141, vae=1.0798, dsb=22.3343, bio=0.0000
    Epoch  6/10: total=23.3375, vae=1.0789, dsb=22.2586, bio=0.0000
    Epoch  7/10: total=23.4600, vae=1.0792, dsb=22.3807, bio=0.0000
    Epoch  8/10: total=23.3748, vae=1.0782, dsb=22.2966, bio=0.0000
    Epoch  9/10: total=23.3911, vae=1.0794, dsb=22.3117, bio=0.0000
    Epoch 10/10: total=23.3498, vae=1.0802, dsb=22.2696, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.4254, vae=1.0784, dsb=0.3470, bio=0.0000
    Epoch  2/10: total=1.4151, vae=1.0790, dsb=0.3360, bio=0.0000
    Epoch  3/10: total=1.4288, vae=1.0795, dsb=0.3493, bio=0.0000
    Epoch  4/10: total=1.4248, vae=1.0792, dsb=0.3456, bio=0.0000
    Epoch  5/10: total=1.4179, vae=1.0788, dsb=0.3391, bio=0.0000
    Epoch  6/10: total=1.4214, vae=1.0785, dsb=0.3429, bio=0.0000
    Epoch  7/10: total=1.4304, vae=1.0788, dsb=0.3516, bio=0.0000
    Epoch  8/10: total=1.4219, vae=1.0792, dsb=0.3427, bio=0.0000
    Epoch  9/10: total=1.4316, vae=1.0788, dsb=0.3529, bio=0.0000
    Epoch 10/10: total=1.4158, vae=1.0789, dsb=0.3369, bio=0.0000

[Seed 58] Joint training (ablation) complete; models and history saved.

[Seed 58] Drift genes saved in /home/yyuan/ICB_TCE/iter_results/run_058

[Seed 58] run finished.

================================================================================
[Seed 59] Starting running whole pipeline...
================================================================================

[Seed 59] Starting VAE pre-training...

    Epoch [01/20], Beta: 0.000, Average Loss: 537.8349
    Epoch [02/20], Beta: 0.000, Average Loss: 306.9577
    Epoch [03/20], Beta: 0.000, Average Loss: 271.0113
    Epoch [04/20], Beta: 0.000, Average Loss: 250.4202
    Epoch [05/20], Beta: 0.100, Average Loss: 246.5782
    Epoch [06/20], Beta: 0.200, Average Loss: 245.5643
    Epoch [07/20], Beta: 0.300, Average Loss: 245.5611
    Epoch [08/20], Beta: 0.400, Average Loss: 246.1365
    Epoch [09/20], Beta: 0.500, Average Loss: 247.1158
    Epoch [10/20], Beta: 0.600, Average Loss: 248.1489
    Epoch [11/20], Beta: 0.700, Average Loss: 249.3446
    Epoch [12/20], Beta: 0.800, Average Loss: 250.6085
    Epoch [13/20], Beta: 0.900, Average Loss: 251.8310
    Epoch [14/20], Beta: 1.000, Average Loss: 253.4777
    Epoch [15/20], Beta: 1.000, Average Loss: 253.0354
    Epoch [16/20], Beta: 1.000, Average Loss: 252.6660
    Epoch [17/20], Beta: 1.000, Average Loss: 252.2999
    Epoch [18/20], Beta: 1.000, Average Loss: 252.0308
    Epoch [19/20], Beta: 1.000, Average Loss: 251.5892
    Epoch [20/20], Beta: 1.000, Average Loss: 251.4138

[Seed 59] VAE pre-training complete.

[Seed 59] Starting joint training (original)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=332.0744, vae=3.7787, dsb=312.9041, bio=30.7831
    Epoch  2/10: total=83.7030, vae=1.1091, dsb=82.5410, bio=0.1058
    Epoch  3/10: total=73.5891, vae=1.1035, dsb=72.4633, bio=0.0448
    Epoch  4/10: total=68.3834, vae=1.1012, dsb=67.2704, bio=0.0236
    Epoch  5/10: total=65.6728, vae=1.1000, dsb=64.5655, bio=0.0147
    Epoch  6/10: total=63.5381, vae=1.0997, dsb=62.4332, bio=0.0103
    Epoch  7/10: total=62.2315, vae=1.0991, dsb=61.1284, bio=0.0079
    Epoch  8/10: total=61.1600, vae=1.0985, dsb=60.0584, bio=0.0064
    Epoch  9/10: total=60.2627, vae=1.0980, dsb=59.1621, bio=0.0053
    Epoch 10/10: total=59.2772, vae=1.0986, dsb=58.1763, bio=0.0045

  [Backward Policy Training]
    Epoch  1/10: total=3.2028, vae=1.0998, dsb=2.0969, bio=0.0121
    Epoch  2/10: total=2.6608, vae=1.0967, dsb=1.5619, bio=0.0043
    Epoch  3/10: total=2.5659, vae=1.0969, dsb=1.4674, bio=0.0031
    Epoch  4/10: total=2.4646, vae=1.0969, dsb=1.3664, bio=0.0027
    Epoch  5/10: total=2.4632, vae=1.0966, dsb=1.3653, bio=0.0024
    Epoch  6/10: total=2.4264, vae=1.0964, dsb=1.3289, bio=0.0022
    Epoch  7/10: total=2.3929, vae=1.0969, dsb=1.2949, bio=0.0021
    Epoch  8/10: total=2.3579, vae=1.0965, dsb=1.2605, bio=0.0020
    Epoch  9/10: total=2.3607, vae=1.0957, dsb=1.2641, bio=0.0019
    Epoch 10/10: total=2.3440, vae=1.0955, dsb=1.2476, bio=0.0019

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=51.7040, vae=1.0977, dsb=50.6047, bio=0.0033
    Epoch  2/10: total=45.2549, vae=1.0975, dsb=44.1564, bio=0.0019
    Epoch  3/10: total=43.8375, vae=1.0967, dsb=42.7399, bio=0.0019
    Epoch  4/10: total=43.0640, vae=1.0970, dsb=41.9661, bio=0.0019
    Epoch  5/10: total=42.2485, vae=1.0967, dsb=41.1507, bio=0.0023
    Epoch  6/10: total=41.6447, vae=1.0961, dsb=40.5477, bio=0.0018
    Epoch  7/10: total=41.4321, vae=1.0949, dsb=40.3363, bio=0.0018
    Epoch  8/10: total=41.0264, vae=1.0963, dsb=39.9292, bio=0.0018
    Epoch  9/10: total=40.8267, vae=1.0962, dsb=39.7296, bio=0.0018
    Epoch 10/10: total=40.8681, vae=1.0959, dsb=39.7713, bio=0.0018

  [Backward Policy Training]
    Epoch  1/10: total=2.0662, vae=1.0962, dsb=0.9673, bio=0.0054
    Epoch  2/10: total=1.9205, vae=1.0943, dsb=0.8253, bio=0.0018
    Epoch  3/10: total=1.9251, vae=1.0954, dsb=0.8289, bio=0.0017
    Epoch  4/10: total=1.8870, vae=1.0937, dsb=0.7925, bio=0.0016
    Epoch  5/10: total=1.8703, vae=1.0943, dsb=0.7751, bio=0.0015
    Epoch  6/10: total=1.8356, vae=1.0943, dsb=0.7405, bio=0.0015
    Epoch  7/10: total=1.8456, vae=1.0948, dsb=0.7501, bio=0.0015
    Epoch  8/10: total=1.8329, vae=1.0951, dsb=0.7370, bio=0.0015
    Epoch  9/10: total=1.8313, vae=1.0949, dsb=0.7357, bio=0.0015
    Epoch 10/10: total=1.8146, vae=1.0942, dsb=0.7197, bio=0.0014

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=37.7333, vae=1.0964, dsb=36.6355, bio=0.0028
    Epoch  2/10: total=35.2255, vae=1.0955, dsb=34.1292, bio=0.0017
    Epoch  3/10: total=34.5196, vae=1.0948, dsb=33.4241, bio=0.0015
    Epoch  4/10: total=34.1293, vae=1.0952, dsb=33.0334, bio=0.0015
    Epoch  5/10: total=33.8690, vae=1.0952, dsb=32.7731, bio=0.0015
    Epoch  6/10: total=33.7660, vae=1.0947, dsb=32.6706, bio=0.0015
    Epoch  7/10: total=33.6505, vae=1.0954, dsb=32.5544, bio=0.0015
    Epoch  8/10: total=33.4734, vae=1.0951, dsb=32.3776, bio=0.0015
    Epoch  9/10: total=33.4251, vae=1.0945, dsb=32.3299, bio=0.0015
    Epoch 10/10: total=33.4052, vae=1.0943, dsb=32.3100, bio=0.0016

  [Backward Policy Training]
    Epoch  1/10: total=1.7331, vae=1.0944, dsb=0.6241, bio=0.0292
    Epoch  2/10: total=1.6700, vae=1.0941, dsb=0.5752, bio=0.0015
    Epoch  3/10: total=1.6537, vae=1.0937, dsb=0.5593, bio=0.0013
    Epoch  4/10: total=1.6493, vae=1.0936, dsb=0.5550, bio=0.0013
    Epoch  5/10: total=1.6398, vae=1.0949, dsb=0.5443, bio=0.0013
    Epoch  6/10: total=1.6346, vae=1.0941, dsb=0.5398, bio=0.0013
    Epoch  7/10: total=1.6274, vae=1.0935, dsb=0.5332, bio=0.0013
    Epoch  8/10: total=1.6212, vae=1.0936, dsb=0.5270, bio=0.0013
    Epoch  9/10: total=1.6174, vae=1.0938, dsb=0.5230, bio=0.0013
    Epoch 10/10: total=1.5976, vae=1.0938, dsb=0.5032, bio=0.0012

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=30.6127, vae=1.0968, dsb=29.5146, bio=0.0027
    Epoch  2/10: total=29.3501, vae=1.0951, dsb=28.2543, bio=0.0013
    Epoch  3/10: total=29.2229, vae=1.0944, dsb=28.1278, bio=0.0013
    Epoch  4/10: total=28.9880, vae=1.0941, dsb=27.8932, bio=0.0013
    Epoch  5/10: total=28.8385, vae=1.0944, dsb=27.7434, bio=0.0013
    Epoch  6/10: total=28.9707, vae=1.0944, dsb=27.8756, bio=0.0013
    Epoch  7/10: total=28.7307, vae=1.0952, dsb=27.6348, bio=0.0015
    Epoch  8/10: total=28.6835, vae=1.0949, dsb=27.5880, bio=0.0012
    Epoch  9/10: total=28.7063, vae=1.0944, dsb=27.6113, bio=0.0012
    Epoch 10/10: total=28.6117, vae=1.0941, dsb=27.5170, bio=0.0012

  [Backward Policy Training]
    Epoch  1/10: total=1.5898, vae=1.0958, dsb=0.4522, bio=0.0837
    Epoch  2/10: total=1.5169, vae=1.0935, dsb=0.4227, bio=0.0013
    Epoch  3/10: total=1.5095, vae=1.0935, dsb=0.4154, bio=0.0012
    Epoch  4/10: total=1.5036, vae=1.0935, dsb=0.4096, bio=0.0011
    Epoch  5/10: total=1.5060, vae=1.0928, dsb=0.4127, bio=0.0012
    Epoch  6/10: total=1.5004, vae=1.0937, dsb=0.4061, bio=0.0011
    Epoch  7/10: total=1.4883, vae=1.0929, dsb=0.3949, bio=0.0011
    Epoch  8/10: total=1.5005, vae=1.0936, dsb=0.4064, bio=0.0011
    Epoch  9/10: total=1.4999, vae=1.0930, dsb=0.4064, bio=0.0011
    Epoch 10/10: total=1.4930, vae=1.0930, dsb=0.3995, bio=0.0010

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=26.5610, vae=1.0956, dsb=25.4638, bio=0.0033
    Epoch  2/10: total=26.0442, vae=1.0949, dsb=24.9487, bio=0.0012
    Epoch  3/10: total=25.8717, vae=1.0940, dsb=24.7771, bio=0.0012
    Epoch  4/10: total=25.8369, vae=1.0950, dsb=24.7413, bio=0.0012
    Epoch  5/10: total=25.7911, vae=1.0939, dsb=24.6966, bio=0.0011
    Epoch  6/10: total=25.6925, vae=1.0951, dsb=24.5969, bio=0.0010
    Epoch  7/10: total=25.6735, vae=1.0941, dsb=24.5792, bio=0.0005
    Epoch  8/10: total=25.6894, vae=1.0936, dsb=24.5953, bio=0.0011
    Epoch  9/10: total=25.7411, vae=1.0933, dsb=24.6472, bio=0.0011
    Epoch 10/10: total=25.6919, vae=1.0934, dsb=24.5979, bio=0.0011

  [Backward Policy Training]
    Epoch  1/10: total=1.5019, vae=1.0947, dsb=0.3521, bio=0.1102
    Epoch  2/10: total=1.4335, vae=1.0934, dsb=0.3396, bio=0.0010
    Epoch  3/10: total=1.4374, vae=1.0924, dsb=0.3444, bio=0.0012
    Epoch  4/10: total=1.4223, vae=1.0922, dsb=0.3296, bio=0.0010
    Epoch  5/10: total=1.4188, vae=1.0930, dsb=0.3253, bio=0.0010
    Epoch  6/10: total=1.4302, vae=1.0934, dsb=0.3366, bio=0.0004
    Epoch  7/10: total=1.4228, vae=1.0922, dsb=0.3300, bio=0.0011
    Epoch  8/10: total=1.4131, vae=1.0923, dsb=0.3203, bio=0.0010
    Epoch  9/10: total=1.4238, vae=1.0927, dsb=0.3305, bio=0.0010
    Epoch 10/10: total=1.4145, vae=1.0927, dsb=0.3214, bio=0.0009

[Seed 59] Joint training (original) complete; models and history saved.

[Seed 59] Starting joint training (ablation)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=314.5626, vae=2.0307, dsb=312.5319, bio=0.0000
    Epoch  2/10: total=83.4293, vae=1.0903, dsb=82.3390, bio=0.0000
    Epoch  3/10: total=73.4491, vae=1.0882, dsb=72.3609, bio=0.0000
    Epoch  4/10: total=68.2890, vae=1.0874, dsb=67.2016, bio=0.0000
    Epoch  5/10: total=65.5970, vae=1.0868, dsb=64.5102, bio=0.0000
    Epoch  6/10: total=63.4535, vae=1.0870, dsb=62.3665, bio=0.0000
    Epoch  7/10: total=62.1177, vae=1.0867, dsb=61.0309, bio=0.0000
    Epoch  8/10: total=61.0349, vae=1.0863, dsb=59.9485, bio=0.0000
    Epoch  9/10: total=60.1639, vae=1.0861, dsb=59.0777, bio=0.0000
    Epoch 10/10: total=59.2187, vae=1.0869, dsb=58.1317, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=3.1053, vae=1.0872, dsb=2.0181, bio=0.0000
    Epoch  2/10: total=2.5861, vae=1.0857, dsb=1.5004, bio=0.0000
    Epoch  3/10: total=2.4953, vae=1.0863, dsb=1.4090, bio=0.0000
    Epoch  4/10: total=2.3982, vae=1.0866, dsb=1.3117, bio=0.0000
    Epoch  5/10: total=2.3962, vae=1.0866, dsb=1.3096, bio=0.0000
    Epoch  6/10: total=2.3589, vae=1.0864, dsb=1.2725, bio=0.0000
    Epoch  7/10: total=2.3268, vae=1.0871, dsb=1.2397, bio=0.0000
    Epoch  8/10: total=2.2921, vae=1.0867, dsb=1.2054, bio=0.0000
    Epoch  9/10: total=2.2933, vae=1.0860, dsb=1.2073, bio=0.0000
    Epoch 10/10: total=2.2756, vae=1.0860, dsb=1.1896, bio=0.0000

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=51.8622, vae=1.0854, dsb=50.7767, bio=0.0000
    Epoch  2/10: total=45.5714, vae=1.0866, dsb=44.4848, bio=0.0000
    Epoch  3/10: total=44.2678, vae=1.0860, dsb=43.1818, bio=0.0000
    Epoch  4/10: total=43.6031, vae=1.0865, dsb=42.5165, bio=0.0000
    Epoch  5/10: total=42.8405, vae=1.0862, dsb=41.7543, bio=0.0000
    Epoch  6/10: total=42.2797, vae=1.0859, dsb=41.1938, bio=0.0000
    Epoch  7/10: total=42.1044, vae=1.0849, dsb=41.0195, bio=0.0000
    Epoch  8/10: total=41.7113, vae=1.0863, dsb=40.6250, bio=0.0000
    Epoch  9/10: total=41.4999, vae=1.0863, dsb=40.4135, bio=0.0000
    Epoch 10/10: total=41.5434, vae=1.0860, dsb=40.4574, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.9777, vae=1.0859, dsb=0.8918, bio=0.0000
    Epoch  2/10: total=1.8494, vae=1.0853, dsb=0.7642, bio=0.0000
    Epoch  3/10: total=1.8544, vae=1.0865, dsb=0.7680, bio=0.0000
    Epoch  4/10: total=1.8193, vae=1.0849, dsb=0.7344, bio=0.0000
    Epoch  5/10: total=1.8042, vae=1.0856, dsb=0.7186, bio=0.0000
    Epoch  6/10: total=1.7718, vae=1.0856, dsb=0.6862, bio=0.0000
    Epoch  7/10: total=1.7818, vae=1.0861, dsb=0.6957, bio=0.0000
    Epoch  8/10: total=1.7699, vae=1.0865, dsb=0.6834, bio=0.0000
    Epoch  9/10: total=1.7685, vae=1.0864, dsb=0.6821, bio=0.0000
    Epoch 10/10: total=1.7526, vae=1.0857, dsb=0.6669, bio=0.0000

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=38.3500, vae=1.0854, dsb=37.2646, bio=0.0000
    Epoch  2/10: total=36.2019, vae=1.0859, dsb=35.1160, bio=0.0000
    Epoch  3/10: total=35.5512, vae=1.0854, dsb=34.4657, bio=0.0000
    Epoch  4/10: total=35.2047, vae=1.0859, dsb=34.1189, bio=0.0000
    Epoch  5/10: total=35.0001, vae=1.0859, dsb=33.9141, bio=0.0000
    Epoch  6/10: total=34.9160, vae=1.0855, dsb=33.8305, bio=0.0000
    Epoch  7/10: total=34.8130, vae=1.0863, dsb=33.7267, bio=0.0000
    Epoch  8/10: total=34.6272, vae=1.0860, dsb=33.5411, bio=0.0000
    Epoch  9/10: total=34.6012, vae=1.0856, dsb=33.5155, bio=0.0000
    Epoch 10/10: total=34.6059, vae=1.0855, dsb=33.5204, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.6705, vae=1.0851, dsb=0.5854, bio=0.0000
    Epoch  2/10: total=1.6268, vae=1.0858, dsb=0.5410, bio=0.0000
    Epoch  3/10: total=1.6128, vae=1.0855, dsb=0.5273, bio=0.0000
    Epoch  4/10: total=1.6091, vae=1.0854, dsb=0.5237, bio=0.0000
    Epoch  5/10: total=1.6003, vae=1.0867, dsb=0.5136, bio=0.0000
    Epoch  6/10: total=1.5954, vae=1.0861, dsb=0.5093, bio=0.0000
    Epoch  7/10: total=1.5886, vae=1.0855, dsb=0.5031, bio=0.0000
    Epoch  8/10: total=1.5829, vae=1.0857, dsb=0.4973, bio=0.0000
    Epoch  9/10: total=1.5789, vae=1.0859, dsb=0.4930, bio=0.0000
    Epoch 10/10: total=1.5601, vae=1.0860, dsb=0.4741, bio=0.0000

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=30.6866, vae=1.0862, dsb=29.6004, bio=0.0000
    Epoch  2/10: total=29.5277, vae=1.0857, dsb=28.4420, bio=0.0000
    Epoch  3/10: total=29.4461, vae=1.0854, dsb=28.3607, bio=0.0000
    Epoch  4/10: total=29.2803, vae=1.0854, dsb=28.1949, bio=0.0000
    Epoch  5/10: total=29.1063, vae=1.0858, dsb=28.0204, bio=0.0000
    Epoch  6/10: total=29.2422, vae=1.0859, dsb=28.1563, bio=0.0000
    Epoch  7/10: total=29.0307, vae=1.0867, dsb=27.9440, bio=0.0000
    Epoch  8/10: total=28.9858, vae=1.0867, dsb=27.8992, bio=0.0000
    Epoch  9/10: total=29.0144, vae=1.0862, dsb=27.9282, bio=0.0000
    Epoch 10/10: total=28.8991, vae=1.0860, dsb=27.8132, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.5059, vae=1.0867, dsb=0.4191, bio=0.0000
    Epoch  2/10: total=1.4792, vae=1.0856, dsb=0.3936, bio=0.0000
    Epoch  3/10: total=1.4731, vae=1.0857, dsb=0.3874, bio=0.0000
    Epoch  4/10: total=1.4682, vae=1.0858, dsb=0.3825, bio=0.0000
    Epoch  5/10: total=1.4709, vae=1.0852, dsb=0.3857, bio=0.0000
    Epoch  6/10: total=1.4656, vae=1.0862, dsb=0.3794, bio=0.0000
    Epoch  7/10: total=1.4549, vae=1.0854, dsb=0.3695, bio=0.0000
    Epoch  8/10: total=1.4667, vae=1.0862, dsb=0.3805, bio=0.0000
    Epoch  9/10: total=1.4666, vae=1.0857, dsb=0.3808, bio=0.0000
    Epoch 10/10: total=1.4604, vae=1.0858, dsb=0.3746, bio=0.0000

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=27.4987, vae=1.0852, dsb=26.4134, bio=0.0000
    Epoch  2/10: total=27.0678, vae=1.0860, dsb=25.9818, bio=0.0000
    Epoch  3/10: total=26.9609, vae=1.0853, dsb=25.8755, bio=0.0000
    Epoch  4/10: total=26.9198, vae=1.0866, dsb=25.8332, bio=0.0000
    Epoch  5/10: total=26.9024, vae=1.0858, dsb=25.8167, bio=0.0000
    Epoch  6/10: total=26.7794, vae=1.0870, dsb=25.6924, bio=0.0000
    Epoch  7/10: total=26.7720, vae=1.0860, dsb=25.6860, bio=0.0000
    Epoch  8/10: total=26.7853, vae=1.0857, dsb=25.6996, bio=0.0000
    Epoch  9/10: total=26.8607, vae=1.0855, dsb=25.7752, bio=0.0000
    Epoch 10/10: total=26.8208, vae=1.0856, dsb=25.7351, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.4147, vae=1.0859, dsb=0.3287, bio=0.0000
    Epoch  2/10: total=1.4057, vae=1.0859, dsb=0.3197, bio=0.0000
    Epoch  3/10: total=1.4106, vae=1.0852, dsb=0.3254, bio=0.0000
    Epoch  4/10: total=1.3969, vae=1.0851, dsb=0.3118, bio=0.0000
    Epoch  5/10: total=1.3939, vae=1.0859, dsb=0.3080, bio=0.0000
    Epoch  6/10: total=1.4058, vae=1.0863, dsb=0.3195, bio=0.0000
    Epoch  7/10: total=1.3986, vae=1.0855, dsb=0.3131, bio=0.0000
    Epoch  8/10: total=1.3893, vae=1.0856, dsb=0.3037, bio=0.0000
    Epoch  9/10: total=1.3999, vae=1.0860, dsb=0.3139, bio=0.0000
    Epoch 10/10: total=1.3912, vae=1.0860, dsb=0.3052, bio=0.0000

[Seed 59] Joint training (ablation) complete; models and history saved.

[Seed 59] Drift genes saved in /home/yyuan/ICB_TCE/iter_results/run_059

[Seed 59] run finished.

================================================================================
[Seed 60] Starting running whole pipeline...
================================================================================

[Seed 60] Starting VAE pre-training...

    Epoch [01/20], Beta: 0.000, Average Loss: 531.4947
    Epoch [02/20], Beta: 0.000, Average Loss: 307.7549
    Epoch [03/20], Beta: 0.000, Average Loss: 270.1386
    Epoch [04/20], Beta: 0.000, Average Loss: 251.2963
    Epoch [05/20], Beta: 0.100, Average Loss: 246.4170
    Epoch [06/20], Beta: 0.200, Average Loss: 245.0115
    Epoch [07/20], Beta: 0.300, Average Loss: 245.1567
    Epoch [08/20], Beta: 0.400, Average Loss: 245.9762
    Epoch [09/20], Beta: 0.500, Average Loss: 246.9937
    Epoch [10/20], Beta: 0.600, Average Loss: 248.0505
    Epoch [11/20], Beta: 0.700, Average Loss: 249.2810
    Epoch [12/20], Beta: 0.800, Average Loss: 250.5497
    Epoch [13/20], Beta: 0.900, Average Loss: 251.7608
    Epoch [14/20], Beta: 1.000, Average Loss: 253.4400
    Epoch [15/20], Beta: 1.000, Average Loss: 252.9665
    Epoch [16/20], Beta: 1.000, Average Loss: 252.6085
    Epoch [17/20], Beta: 1.000, Average Loss: 252.2314
    Epoch [18/20], Beta: 1.000, Average Loss: 251.9176
    Epoch [19/20], Beta: 1.000, Average Loss: 251.4864
    Epoch [20/20], Beta: 1.000, Average Loss: 251.2959

[Seed 60] VAE pre-training complete.

[Seed 60] Starting joint training (original)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=244.1994, vae=3.8106, dsb=214.8926, bio=50.9923
    Epoch  2/10: total=70.4392, vae=1.1179, dsb=69.2677, bio=0.1071
    Epoch  3/10: total=58.6679, vae=1.1129, dsb=57.5333, bio=0.0434
    Epoch  4/10: total=53.3072, vae=1.1106, dsb=52.1843, bio=0.0247
    Epoch  5/10: total=50.0601, vae=1.1092, dsb=48.9428, bio=0.0162
    Epoch  6/10: total=47.9642, vae=1.1090, dsb=46.8494, bio=0.0116
    Epoch  7/10: total=46.4409, vae=1.1082, dsb=45.3283, bio=0.0089
    Epoch  8/10: total=45.0954, vae=1.1084, dsb=43.9835, bio=0.0070
    Epoch  9/10: total=43.8090, vae=1.1089, dsb=42.6972, bio=0.0058
    Epoch 10/10: total=43.3216, vae=1.1083, dsb=42.2107, bio=0.0050

  [Backward Policy Training]
    Epoch  1/10: total=3.2249, vae=1.1102, dsb=2.1087, bio=0.0119
    Epoch  2/10: total=2.7585, vae=1.1072, dsb=1.6491, bio=0.0045
    Epoch  3/10: total=2.5898, vae=1.1063, dsb=1.4819, bio=0.0033
    Epoch  4/10: total=2.4833, vae=1.1067, dsb=1.3752, bio=0.0027
    Epoch  5/10: total=2.4521, vae=1.1065, dsb=1.3443, bio=0.0024
    Epoch  6/10: total=2.4500, vae=1.1061, dsb=1.3428, bio=0.0022
    Epoch  7/10: total=2.3705, vae=1.1053, dsb=1.2642, bio=0.0021
    Epoch  8/10: total=2.3998, vae=1.1055, dsb=1.2932, bio=0.0023
    Epoch  9/10: total=2.3443, vae=1.1062, dsb=1.2371, bio=0.0020
    Epoch 10/10: total=2.3294, vae=1.1056, dsb=1.2229, bio=0.0019

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=43.1417, vae=1.1069, dsb=42.0329, bio=0.0038
    Epoch  2/10: total=35.1391, vae=1.1061, dsb=34.0320, bio=0.0018
    Epoch  3/10: total=33.0443, vae=1.1062, dsb=31.9372, bio=0.0018
    Epoch  4/10: total=31.9667, vae=1.1063, dsb=30.8596, bio=0.0017
    Epoch  5/10: total=31.2146, vae=1.1063, dsb=30.1074, bio=0.0017
    Epoch  6/10: total=30.6775, vae=1.1057, dsb=29.5709, bio=0.0017
    Epoch  7/10: total=30.3223, vae=1.1057, dsb=29.2157, bio=0.0017
    Epoch  8/10: total=29.9827, vae=1.1058, dsb=28.8758, bio=0.0022
    Epoch  9/10: total=29.6768, vae=1.1059, dsb=28.5701, bio=0.0016
    Epoch 10/10: total=29.4774, vae=1.1052, dsb=28.3714, bio=0.0016

  [Backward Policy Training]
    Epoch  1/10: total=2.1243, vae=1.1055, dsb=1.0164, bio=0.0050
    Epoch  2/10: total=1.9963, vae=1.1051, dsb=0.8903, bio=0.0017
    Epoch  3/10: total=1.9424, vae=1.1055, dsb=0.8361, bio=0.0015
    Epoch  4/10: total=1.9138, vae=1.1044, dsb=0.8087, bio=0.0015
    Epoch  5/10: total=1.8927, vae=1.1040, dsb=0.7880, bio=0.0014
    Epoch  6/10: total=1.8838, vae=1.1041, dsb=0.7789, bio=0.0015
    Epoch  7/10: total=1.8602, vae=1.1035, dsb=0.7560, bio=0.0014
    Epoch  8/10: total=1.8454, vae=1.1040, dsb=0.7407, bio=0.0014
    Epoch  9/10: total=1.8645, vae=1.1037, dsb=0.7601, bio=0.0014
    Epoch 10/10: total=1.8288, vae=1.1045, dsb=0.7237, bio=0.0013

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=30.2722, vae=1.1066, dsb=29.1641, bio=0.0030
    Epoch  2/10: total=26.7153, vae=1.1055, dsb=25.6092, bio=0.0014
    Epoch  3/10: total=25.7557, vae=1.1057, dsb=24.6493, bio=0.0014
    Epoch  4/10: total=25.1367, vae=1.1043, dsb=24.0317, bio=0.0014
    Epoch  5/10: total=24.9989, vae=1.1046, dsb=23.8937, bio=0.0014
    Epoch  6/10: total=24.6297, vae=1.1050, dsb=23.5240, bio=0.0013
    Epoch  7/10: total=24.6772, vae=1.1039, dsb=23.5726, bio=0.0014
    Epoch  8/10: total=24.4730, vae=1.1046, dsb=23.3676, bio=0.0014
    Epoch  9/10: total=24.3087, vae=1.1046, dsb=23.2034, bio=0.0013
    Epoch 10/10: total=24.2354, vae=1.1050, dsb=23.1297, bio=0.0013

  [Backward Policy Training]
    Epoch  1/10: total=1.7907, vae=1.1048, dsb=0.6791, bio=0.0136
    Epoch  2/10: total=1.7165, vae=1.1038, dsb=0.6121, bio=0.0013
    Epoch  3/10: total=1.7013, vae=1.1036, dsb=0.5971, bio=0.0012
    Epoch  4/10: total=1.6743, vae=1.1028, dsb=0.5710, bio=0.0011
    Epoch  5/10: total=1.6772, vae=1.1038, dsb=0.5728, bio=0.0011
    Epoch  6/10: total=1.6498, vae=1.1038, dsb=0.5454, bio=0.0011
    Epoch  7/10: total=1.6598, vae=1.1029, dsb=0.5564, bio=0.0011
    Epoch  8/10: total=1.6618, vae=1.1029, dsb=0.5583, bio=0.0011
    Epoch  9/10: total=1.6514, vae=1.1036, dsb=0.5473, bio=0.0011
    Epoch 10/10: total=1.6594, vae=1.1024, dsb=0.5565, bio=0.0011

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=21.1908, vae=1.1055, dsb=20.0841, bio=0.0024
    Epoch  2/10: total=19.4846, vae=1.1043, dsb=18.3798, bio=0.0011
    Epoch  3/10: total=19.2176, vae=1.1049, dsb=18.1121, bio=0.0012
    Epoch  4/10: total=18.8941, vae=1.1042, dsb=17.7895, bio=0.0008
    Epoch  5/10: total=18.7649, vae=1.1033, dsb=17.6609, bio=0.0014
    Epoch  6/10: total=18.5789, vae=1.1045, dsb=17.4739, bio=0.0011
    Epoch  7/10: total=18.4934, vae=1.1045, dsb=17.3884, bio=0.0011
    Epoch  8/10: total=18.4850, vae=1.1034, dsb=17.3811, bio=0.0011
    Epoch  9/10: total=18.4951, vae=1.1036, dsb=17.3913, bio=0.0005
    Epoch 10/10: total=18.3912, vae=1.1035, dsb=17.2871, bio=0.0011

  [Backward Policy Training]
    Epoch  1/10: total=1.6082, vae=1.1045, dsb=0.4578, bio=0.0916
    Epoch  2/10: total=1.5421, vae=1.1033, dsb=0.4382, bio=0.0012
    Epoch  3/10: total=1.5200, vae=1.1036, dsb=0.4158, bio=0.0011
    Epoch  4/10: total=1.5271, vae=1.1024, dsb=0.4244, bio=0.0006
    Epoch  5/10: total=1.5198, vae=1.1028, dsb=0.4164, bio=0.0012
    Epoch  6/10: total=1.5162, vae=1.1024, dsb=0.4132, bio=0.0010
    Epoch  7/10: total=1.5197, vae=1.1036, dsb=0.4156, bio=0.0010
    Epoch  8/10: total=1.5042, vae=1.1025, dsb=0.4012, bio=0.0010
    Epoch  9/10: total=1.5012, vae=1.1024, dsb=0.3983, bio=0.0009
    Epoch 10/10: total=1.5002, vae=1.1032, dsb=0.3966, bio=0.0008

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=18.0598, vae=1.1063, dsb=16.9520, bio=0.0030
    Epoch  2/10: total=17.2425, vae=1.1046, dsb=16.1374, bio=0.0010
    Epoch  3/10: total=17.0543, vae=1.1046, dsb=15.9493, bio=0.0008
    Epoch  4/10: total=16.8799, vae=1.1035, dsb=15.7761, bio=0.0005
    Epoch  5/10: total=16.9336, vae=1.1031, dsb=15.8301, bio=0.0009
    Epoch  6/10: total=16.9354, vae=1.1031, dsb=15.8318, bio=0.0009
    Epoch  7/10: total=16.7955, vae=1.1030, dsb=15.6920, bio=0.0011
    Epoch  8/10: total=16.8165, vae=1.1026, dsb=15.7134, bio=0.0010
    Epoch  9/10: total=16.7583, vae=1.1022, dsb=15.6557, bio=0.0007
    Epoch 10/10: total=16.8215, vae=1.1034, dsb=15.7180, bio=0.0004

  [Backward Policy Training]
    Epoch  1/10: total=1.5288, vae=1.1045, dsb=0.3477, bio=0.1533
    Epoch  2/10: total=1.4380, vae=1.1027, dsb=0.3347, bio=0.0012
    Epoch  3/10: total=1.4360, vae=1.1024, dsb=0.3333, bio=0.0007
    Epoch  4/10: total=1.4195, vae=1.1020, dsb=0.3173, bio=0.0004
    Epoch  5/10: total=1.4296, vae=1.1021, dsb=0.3268, bio=0.0014
    Epoch  6/10: total=1.4310, vae=1.1020, dsb=0.3285, bio=0.0010
    Epoch  7/10: total=1.4214, vae=1.1020, dsb=0.3191, bio=0.0005
    Epoch  8/10: total=1.4247, vae=1.1027, dsb=0.3218, bio=0.0006
    Epoch  9/10: total=1.4213, vae=1.1017, dsb=0.3193, bio=0.0007
    Epoch 10/10: total=1.4193, vae=1.1011, dsb=0.3177, bio=0.0010

[Seed 60] Joint training (original) complete; models and history saved.

[Seed 60] Starting joint training (ablation)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=216.5802, vae=2.0040, dsb=214.5762, bio=0.0000
    Epoch  2/10: total=69.6816, vae=1.0999, dsb=68.5817, bio=0.0000
    Epoch  3/10: total=58.2349, vae=1.0981, dsb=57.1368, bio=0.0000
    Epoch  4/10: total=52.9357, vae=1.0970, dsb=51.8387, bio=0.0000
    Epoch  5/10: total=49.6727, vae=1.0962, dsb=48.5765, bio=0.0000
    Epoch  6/10: total=47.5279, vae=1.0963, dsb=46.4316, bio=0.0000
    Epoch  7/10: total=46.0108, vae=1.0959, dsb=44.9149, bio=0.0000
    Epoch  8/10: total=44.6581, vae=1.0964, dsb=43.5618, bio=0.0000
    Epoch  9/10: total=43.3746, vae=1.0970, dsb=42.2776, bio=0.0000
    Epoch 10/10: total=42.8926, vae=1.0967, dsb=41.7959, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=3.1250, vae=1.0973, dsb=2.0277, bio=0.0000
    Epoch  2/10: total=2.6870, vae=1.0961, dsb=1.5908, bio=0.0000
    Epoch  3/10: total=2.5255, vae=1.0957, dsb=1.4297, bio=0.0000
    Epoch  4/10: total=2.4244, vae=1.0964, dsb=1.3280, bio=0.0000
    Epoch  5/10: total=2.3943, vae=1.0964, dsb=1.2979, bio=0.0000
    Epoch  6/10: total=2.3936, vae=1.0962, dsb=1.2974, bio=0.0000
    Epoch  7/10: total=2.3173, vae=1.0956, dsb=1.2218, bio=0.0000
    Epoch  8/10: total=2.3457, vae=1.0958, dsb=1.2499, bio=0.0000
    Epoch  9/10: total=2.2906, vae=1.0967, dsb=1.1939, bio=0.0000
    Epoch 10/10: total=2.2771, vae=1.0962, dsb=1.1809, bio=0.0000

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=42.7379, vae=1.0949, dsb=41.6430, bio=0.0000
    Epoch  2/10: total=34.7545, vae=1.0953, dsb=33.6592, bio=0.0000
    Epoch  3/10: total=32.6580, vae=1.0956, dsb=31.5624, bio=0.0000
    Epoch  4/10: total=31.6145, vae=1.0958, dsb=30.5187, bio=0.0000
    Epoch  5/10: total=30.8619, vae=1.0960, dsb=29.7659, bio=0.0000
    Epoch  6/10: total=30.3509, vae=1.0955, dsb=29.2555, bio=0.0000
    Epoch  7/10: total=30.0232, vae=1.0955, dsb=28.9277, bio=0.0000
    Epoch  8/10: total=29.7161, vae=1.0957, dsb=28.6204, bio=0.0000
    Epoch  9/10: total=29.4491, vae=1.0959, dsb=28.3531, bio=0.0000
    Epoch 10/10: total=29.2796, vae=1.0953, dsb=28.1843, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=2.0692, vae=1.0951, dsb=0.9742, bio=0.0000
    Epoch  2/10: total=1.9502, vae=1.0963, dsb=0.8539, bio=0.0000
    Epoch  3/10: total=1.8991, vae=1.0968, dsb=0.8023, bio=0.0000
    Epoch  4/10: total=1.8723, vae=1.0957, dsb=0.7765, bio=0.0000
    Epoch  5/10: total=1.8539, vae=1.0954, dsb=0.7585, bio=0.0000
    Epoch  6/10: total=1.8453, vae=1.0956, dsb=0.7497, bio=0.0000
    Epoch  7/10: total=1.8224, vae=1.0951, dsb=0.7273, bio=0.0000
    Epoch  8/10: total=1.8092, vae=1.0956, dsb=0.7136, bio=0.0000
    Epoch  9/10: total=1.8269, vae=1.0953, dsb=0.7316, bio=0.0000
    Epoch 10/10: total=1.7931, vae=1.0962, dsb=0.6970, bio=0.0000

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=29.8622, vae=1.0955, dsb=28.7667, bio=0.0000
    Epoch  2/10: total=26.4897, vae=1.0958, dsb=25.3939, bio=0.0000
    Epoch  3/10: total=25.5710, vae=1.0963, dsb=24.4747, bio=0.0000
    Epoch  4/10: total=25.0225, vae=1.0950, dsb=23.9275, bio=0.0000
    Epoch  5/10: total=24.8862, vae=1.0953, dsb=23.7909, bio=0.0000
    Epoch  6/10: total=24.5173, vae=1.0959, dsb=23.4214, bio=0.0000
    Epoch  7/10: total=24.5619, vae=1.0948, dsb=23.4671, bio=0.0000
    Epoch  8/10: total=24.3875, vae=1.0956, dsb=23.2919, bio=0.0000
    Epoch  9/10: total=24.2486, vae=1.0956, dsb=23.1530, bio=0.0000
    Epoch 10/10: total=24.1657, vae=1.0962, dsb=23.0695, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.7352, vae=1.0955, dsb=0.6397, bio=0.0000
    Epoch  2/10: total=1.6722, vae=1.0956, dsb=0.5766, bio=0.0000
    Epoch  3/10: total=1.6578, vae=1.0954, dsb=0.5624, bio=0.0000
    Epoch  4/10: total=1.6322, vae=1.0948, dsb=0.5374, bio=0.0000
    Epoch  5/10: total=1.6358, vae=1.0958, dsb=0.5400, bio=0.0000
    Epoch  6/10: total=1.6096, vae=1.0958, dsb=0.5138, bio=0.0000
    Epoch  7/10: total=1.6195, vae=1.0950, dsb=0.5245, bio=0.0000
    Epoch  8/10: total=1.6216, vae=1.0950, dsb=0.5266, bio=0.0000
    Epoch  9/10: total=1.6109, vae=1.0958, dsb=0.5151, bio=0.0000
    Epoch 10/10: total=1.6191, vae=1.0946, dsb=0.5245, bio=0.0000

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=21.1897, vae=1.0952, dsb=20.0945, bio=0.0000
    Epoch  2/10: total=19.5409, vae=1.0952, dsb=18.4458, bio=0.0000
    Epoch  3/10: total=19.2977, vae=1.0961, dsb=18.2016, bio=0.0000
    Epoch  4/10: total=19.0001, vae=1.0955, dsb=17.9046, bio=0.0000
    Epoch  5/10: total=18.8796, vae=1.0948, dsb=17.7848, bio=0.0000
    Epoch  6/10: total=18.6977, vae=1.0961, dsb=17.6017, bio=0.0000
    Epoch  7/10: total=18.5754, vae=1.0962, dsb=17.4793, bio=0.0000
    Epoch  8/10: total=18.6028, vae=1.0951, dsb=17.5077, bio=0.0000
    Epoch  9/10: total=18.6198, vae=1.0954, dsb=17.5244, bio=0.0000
    Epoch 10/10: total=18.5222, vae=1.0954, dsb=17.4268, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.5251, vae=1.0955, dsb=0.4296, bio=0.0000
    Epoch  2/10: total=1.5060, vae=1.0954, dsb=0.4106, bio=0.0000
    Epoch  3/10: total=1.4850, vae=1.0960, dsb=0.3891, bio=0.0000
    Epoch  4/10: total=1.4918, vae=1.0947, dsb=0.3971, bio=0.0000
    Epoch  5/10: total=1.4850, vae=1.0954, dsb=0.3896, bio=0.0000
    Epoch  6/10: total=1.4816, vae=1.0951, dsb=0.3865, bio=0.0000
    Epoch  7/10: total=1.4856, vae=1.0963, dsb=0.3893, bio=0.0000
    Epoch  8/10: total=1.4708, vae=1.0953, dsb=0.3755, bio=0.0000
    Epoch  9/10: total=1.4680, vae=1.0953, dsb=0.3727, bio=0.0000
    Epoch 10/10: total=1.4673, vae=1.0962, dsb=0.3711, bio=0.0000

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=17.8919, vae=1.0961, dsb=16.7958, bio=0.0000
    Epoch  2/10: total=17.1391, vae=1.0959, dsb=16.0432, bio=0.0000
    Epoch  3/10: total=16.9610, vae=1.0961, dsb=15.8650, bio=0.0000
    Epoch  4/10: total=16.7973, vae=1.0953, dsb=15.7020, bio=0.0000
    Epoch  5/10: total=16.8454, vae=1.0951, dsb=15.7503, bio=0.0000
    Epoch  6/10: total=16.8684, vae=1.0953, dsb=15.7732, bio=0.0000
    Epoch  7/10: total=16.7235, vae=1.0952, dsb=15.6282, bio=0.0000
    Epoch  8/10: total=16.7511, vae=1.0948, dsb=15.6562, bio=0.0000
    Epoch  9/10: total=16.6909, vae=1.0945, dsb=15.5964, bio=0.0000
    Epoch 10/10: total=16.7748, vae=1.0957, dsb=15.6791, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.4142, vae=1.0957, dsb=0.3186, bio=0.0000
    Epoch  2/10: total=1.4022, vae=1.0951, dsb=0.3071, bio=0.0000
    Epoch  3/10: total=1.4010, vae=1.0951, dsb=0.3058, bio=0.0000
    Epoch  4/10: total=1.3858, vae=1.0950, dsb=0.2908, bio=0.0000
    Epoch  5/10: total=1.3956, vae=1.0953, dsb=0.3003, bio=0.0000
    Epoch  6/10: total=1.3973, vae=1.0952, dsb=0.3020, bio=0.0000
    Epoch  7/10: total=1.3883, vae=1.0953, dsb=0.2930, bio=0.0000
    Epoch  8/10: total=1.3918, vae=1.0960, dsb=0.2957, bio=0.0000
    Epoch  9/10: total=1.3884, vae=1.0952, dsb=0.2932, bio=0.0000
    Epoch 10/10: total=1.3868, vae=1.0947, dsb=0.2921, bio=0.0000

[Seed 60] Joint training (ablation) complete; models and history saved.

[Seed 60] Drift genes saved in /home/yyuan/ICB_TCE/iter_results/run_060

[Seed 60] run finished.

================================================================================
[Seed 61] Starting running whole pipeline...
================================================================================

[Seed 61] Starting VAE pre-training...

    Epoch [01/20], Beta: 0.000, Average Loss: 536.6008
    Epoch [02/20], Beta: 0.000, Average Loss: 306.2494
    Epoch [03/20], Beta: 0.000, Average Loss: 270.8529
    Epoch [04/20], Beta: 0.000, Average Loss: 249.7716
    Epoch [05/20], Beta: 0.100, Average Loss: 245.3231
    Epoch [06/20], Beta: 0.200, Average Loss: 244.5777
    Epoch [07/20], Beta: 0.300, Average Loss: 244.5979
    Epoch [08/20], Beta: 0.400, Average Loss: 245.3852
    Epoch [09/20], Beta: 0.500, Average Loss: 246.5367
    Epoch [10/20], Beta: 0.600, Average Loss: 247.8236
    Epoch [11/20], Beta: 0.700, Average Loss: 249.1513
    Epoch [12/20], Beta: 0.800, Average Loss: 250.4846
    Epoch [13/20], Beta: 0.900, Average Loss: 251.7656
    Epoch [14/20], Beta: 1.000, Average Loss: 253.4088
    Epoch [15/20], Beta: 1.000, Average Loss: 253.0242
    Epoch [16/20], Beta: 1.000, Average Loss: 252.6170
    Epoch [17/20], Beta: 1.000, Average Loss: 252.2732
    Epoch [18/20], Beta: 1.000, Average Loss: 251.9446
    Epoch [19/20], Beta: 1.000, Average Loss: 251.5883
    Epoch [20/20], Beta: 1.000, Average Loss: 251.4220

[Seed 61] VAE pre-training complete.

[Seed 61] Starting joint training (original)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=205.3126, vae=3.7141, dsb=184.6516, bio=33.8936
    Epoch  2/10: total=59.9944, vae=1.1061, dsb=58.8448, bio=0.0870
    Epoch  3/10: total=49.6530, vae=1.1013, dsb=48.5326, bio=0.0382
    Epoch  4/10: total=44.5323, vae=1.0989, dsb=43.4223, bio=0.0222
    Epoch  5/10: total=41.6277, vae=1.0982, dsb=40.5221, bio=0.0149
    Epoch  6/10: total=39.5394, vae=1.0968, dsb=38.4371, bio=0.0110
    Epoch  7/10: total=38.0728, vae=1.0967, dsb=36.9719, bio=0.0083
    Epoch  8/10: total=36.9311, vae=1.0963, dsb=35.8314, bio=0.0066
    Epoch  9/10: total=36.1222, vae=1.0963, dsb=35.0232, bio=0.0054
    Epoch 10/10: total=35.3179, vae=1.0960, dsb=34.2193, bio=0.0051

  [Backward Policy Training]
    Epoch  1/10: total=3.1638, vae=1.0977, dsb=2.0594, bio=0.0134
    Epoch  2/10: total=2.6441, vae=1.0957, dsb=1.5458, bio=0.0051
    Epoch  3/10: total=2.5240, vae=1.0949, dsb=1.4273, bio=0.0036
    Epoch  4/10: total=2.4361, vae=1.0953, dsb=1.3393, bio=0.0029
    Epoch  5/10: total=2.4084, vae=1.0954, dsb=1.3118, bio=0.0025
    Epoch  6/10: total=2.3428, vae=1.0951, dsb=1.2466, bio=0.0023
    Epoch  7/10: total=2.3331, vae=1.0940, dsb=1.2382, bio=0.0020
    Epoch  8/10: total=2.3029, vae=1.0945, dsb=1.2074, bio=0.0020
    Epoch  9/10: total=2.2993, vae=1.0938, dsb=1.2046, bio=0.0019
    Epoch 10/10: total=2.2652, vae=1.0938, dsb=1.1705, bio=0.0018

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=35.9670, vae=1.0979, dsb=34.8672, bio=0.0037
    Epoch  2/10: total=28.7110, vae=1.0954, dsb=27.6148, bio=0.0016
    Epoch  3/10: total=26.9675, vae=1.0950, dsb=25.8717, bio=0.0016
    Epoch  4/10: total=25.8268, vae=1.0941, dsb=24.7318, bio=0.0016
    Epoch  5/10: total=25.1239, vae=1.0946, dsb=24.0286, bio=0.0015
    Epoch  6/10: total=24.6452, vae=1.0945, dsb=23.5500, bio=0.0015
    Epoch  7/10: total=24.3142, vae=1.0945, dsb=23.2189, bio=0.0015
    Epoch  8/10: total=24.0079, vae=1.0942, dsb=22.9130, bio=0.0014
    Epoch  9/10: total=23.8320, vae=1.0949, dsb=22.7363, bio=0.0014
    Epoch 10/10: total=23.5093, vae=1.0944, dsb=22.4142, bio=0.0015

  [Backward Policy Training]
    Epoch  1/10: total=2.0818, vae=1.0950, dsb=0.9841, bio=0.0053
    Epoch  2/10: total=1.9300, vae=1.0937, dsb=0.8355, bio=0.0016
    Epoch  3/10: total=1.8915, vae=1.0928, dsb=0.7979, bio=0.0014
    Epoch  4/10: total=1.8676, vae=1.0931, dsb=0.7737, bio=0.0014
    Epoch  5/10: total=1.8248, vae=1.0925, dsb=0.7316, bio=0.0013
    Epoch  6/10: total=1.8230, vae=1.0927, dsb=0.7296, bio=0.0012
    Epoch  7/10: total=1.8181, vae=1.0938, dsb=0.7236, bio=0.0014
    Epoch  8/10: total=1.8042, vae=1.0927, dsb=0.7108, bio=0.0012
    Epoch  9/10: total=1.7954, vae=1.0926, dsb=0.7023, bio=0.0012
    Epoch 10/10: total=1.8074, vae=1.0928, dsb=0.7140, bio=0.0012

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=23.4990, vae=1.0954, dsb=22.4023, bio=0.0026
    Epoch  2/10: total=20.1299, vae=1.0939, dsb=19.0354, bio=0.0012
    Epoch  3/10: total=19.3912, vae=1.0944, dsb=18.2962, bio=0.0012
    Epoch  4/10: total=18.9592, vae=1.0931, dsb=17.8655, bio=0.0012
    Epoch  5/10: total=18.7190, vae=1.0934, dsb=17.6250, bio=0.0012
    Epoch  6/10: total=18.5013, vae=1.0929, dsb=17.4081, bio=0.0006
    Epoch  7/10: total=18.2776, vae=1.0945, dsb=17.1827, bio=0.0010
    Epoch  8/10: total=18.1680, vae=1.0933, dsb=17.0741, bio=0.0013
    Epoch  9/10: total=18.0377, vae=1.0932, dsb=16.9439, bio=0.0012
    Epoch 10/10: total=18.0038, vae=1.0930, dsb=16.9102, bio=0.0012

  [Backward Policy Training]
    Epoch  1/10: total=1.7249, vae=1.0931, dsb=0.6262, bio=0.0113
    Epoch  2/10: total=1.6641, vae=1.0931, dsb=0.5704, bio=0.0013
    Epoch  3/10: total=1.6296, vae=1.0936, dsb=0.5354, bio=0.0011
    Epoch  4/10: total=1.6257, vae=1.0928, dsb=0.5325, bio=0.0009
    Epoch  5/10: total=1.5906, vae=1.0916, dsb=0.4984, bio=0.0011
    Epoch  6/10: total=1.5952, vae=1.0920, dsb=0.5027, bio=0.0010
    Epoch  7/10: total=1.5830, vae=1.0915, dsb=0.4910, bio=0.0010
    Epoch  8/10: total=1.5862, vae=1.0926, dsb=0.4931, bio=0.0010
    Epoch  9/10: total=1.5810, vae=1.0925, dsb=0.4880, bio=0.0010
    Epoch 10/10: total=1.5794, vae=1.0929, dsb=0.4861, bio=0.0010

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=17.6321, vae=1.0943, dsb=16.5369, bio=0.0018
    Epoch  2/10: total=16.1135, vae=1.0935, dsb=15.0198, bio=0.0006
    Epoch  3/10: total=15.6961, vae=1.0932, dsb=14.6026, bio=0.0006
    Epoch  4/10: total=15.4587, vae=1.0932, dsb=14.3652, bio=0.0008
    Epoch  5/10: total=15.2677, vae=1.0923, dsb=14.1748, bio=0.0011
    Epoch  6/10: total=15.2884, vae=1.0922, dsb=14.1956, bio=0.0012
    Epoch  7/10: total=15.2151, vae=1.0931, dsb=14.1214, bio=0.0011
    Epoch  8/10: total=15.1554, vae=1.0922, dsb=14.0628, bio=0.0008
    Epoch  9/10: total=15.0727, vae=1.0924, dsb=13.9801, bio=0.0005
    Epoch 10/10: total=15.0079, vae=1.0917, dsb=13.9156, bio=0.0012

  [Backward Policy Training]
    Epoch  1/10: total=1.5899, vae=1.0936, dsb=0.4319, bio=0.1288
    Epoch  2/10: total=1.5005, vae=1.0940, dsb=0.4059, bio=0.0012
    Epoch  3/10: total=1.4810, vae=1.0925, dsb=0.3882, bio=0.0006
    Epoch  4/10: total=1.4647, vae=1.0921, dsb=0.3722, bio=0.0008
    Epoch  5/10: total=1.4709, vae=1.0912, dsb=0.3791, bio=0.0011
    Epoch  6/10: total=1.4635, vae=1.0919, dsb=0.3711, bio=0.0010
    Epoch  7/10: total=1.4667, vae=1.0911, dsb=0.3753, bio=0.0006
    Epoch  8/10: total=1.4571, vae=1.0920, dsb=0.3646, bio=0.0010
    Epoch  9/10: total=1.4506, vae=1.0912, dsb=0.3589, bio=0.0010
    Epoch 10/10: total=1.4466, vae=1.0918, dsb=0.3543, bio=0.0009

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=13.7506, vae=1.0943, dsb=12.6552, bio=0.0022
    Epoch  2/10: total=13.0481, vae=1.0930, dsb=11.9548, bio=0.0005
    Epoch  3/10: total=12.9421, vae=1.0916, dsb=11.8499, bio=0.0012
    Epoch  4/10: total=12.8249, vae=1.0922, dsb=11.7321, bio=0.0011
    Epoch  5/10: total=12.7374, vae=1.0924, dsb=11.6445, bio=0.0009
    Epoch  6/10: total=12.7634, vae=1.0928, dsb=11.6704, bio=0.0004
    Epoch  7/10: total=12.6860, vae=1.0922, dsb=11.5936, bio=0.0004
    Epoch  8/10: total=12.6852, vae=1.0923, dsb=11.5926, bio=0.0006
    Epoch  9/10: total=12.6598, vae=1.0919, dsb=11.5676, bio=0.0007
    Epoch 10/10: total=12.6672, vae=1.0918, dsb=11.5750, bio=0.0009

  [Backward Policy Training]
    Epoch  1/10: total=1.4934, vae=1.0938, dsb=0.3155, bio=0.1681
    Epoch  2/10: total=1.3867, vae=1.0922, dsb=0.2939, bio=0.0012
    Epoch  3/10: total=1.3904, vae=1.0919, dsb=0.2982, bio=0.0005
    Epoch  4/10: total=1.3790, vae=1.0914, dsb=0.2872, bio=0.0008
    Epoch  5/10: total=1.3869, vae=1.0908, dsb=0.2956, bio=0.0011
    Epoch  6/10: total=1.3771, vae=1.0915, dsb=0.2850, bio=0.0011
    Epoch  7/10: total=1.3843, vae=1.0914, dsb=0.2927, bio=0.0006
    Epoch  8/10: total=1.3801, vae=1.0909, dsb=0.2889, bio=0.0006
    Epoch  9/10: total=1.3735, vae=1.0912, dsb=0.2819, bio=0.0009
    Epoch 10/10: total=1.3754, vae=1.0914, dsb=0.2835, bio=0.0009

[Seed 61] Joint training (original) complete; models and history saved.

[Seed 61] Starting joint training (ablation)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=186.4919, vae=2.0155, dsb=184.4764, bio=0.0000
    Epoch  2/10: total=59.6613, vae=1.0884, dsb=58.5730, bio=0.0000
    Epoch  3/10: total=49.3077, vae=1.0868, dsb=48.2209, bio=0.0000
    Epoch  4/10: total=44.2389, vae=1.0856, dsb=43.1533, bio=0.0000
    Epoch  5/10: total=41.3783, vae=1.0854, dsb=40.2929, bio=0.0000
    Epoch  6/10: total=39.3362, vae=1.0843, dsb=38.2519, bio=0.0000
    Epoch  7/10: total=37.8461, vae=1.0846, dsb=36.7615, bio=0.0000
    Epoch  8/10: total=36.7148, vae=1.0845, dsb=35.6304, bio=0.0000
    Epoch  9/10: total=35.9082, vae=1.0847, dsb=34.8235, bio=0.0000
    Epoch 10/10: total=35.1272, vae=1.0846, dsb=34.0426, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=3.0835, vae=1.0852, dsb=1.9983, bio=0.0000
    Epoch  2/10: total=2.5794, vae=1.0849, dsb=1.4944, bio=0.0000
    Epoch  3/10: total=2.4631, vae=1.0845, dsb=1.3786, bio=0.0000
    Epoch  4/10: total=2.3775, vae=1.0852, dsb=1.2923, bio=0.0000
    Epoch  5/10: total=2.3512, vae=1.0854, dsb=1.2658, bio=0.0000
    Epoch  6/10: total=2.2874, vae=1.0853, dsb=1.2020, bio=0.0000
    Epoch  7/10: total=2.2789, vae=1.0843, dsb=1.1946, bio=0.0000
    Epoch  8/10: total=2.2489, vae=1.0850, dsb=1.1638, bio=0.0000
    Epoch  9/10: total=2.2440, vae=1.0844, dsb=1.1596, bio=0.0000
    Epoch 10/10: total=2.2111, vae=1.0845, dsb=1.1266, bio=0.0000

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=35.5598, vae=1.0851, dsb=34.4747, bio=0.0000
    Epoch  2/10: total=28.4996, vae=1.0846, dsb=27.4149, bio=0.0000
    Epoch  3/10: total=26.7745, vae=1.0846, dsb=25.6899, bio=0.0000
    Epoch  4/10: total=25.7221, vae=1.0837, dsb=24.6383, bio=0.0000
    Epoch  5/10: total=25.0560, vae=1.0844, dsb=23.9715, bio=0.0000
    Epoch  6/10: total=24.6257, vae=1.0845, dsb=23.5413, bio=0.0000
    Epoch  7/10: total=24.3078, vae=1.0846, dsb=23.2232, bio=0.0000
    Epoch  8/10: total=24.0257, vae=1.0843, dsb=22.9414, bio=0.0000
    Epoch  9/10: total=23.8646, vae=1.0851, dsb=22.7794, bio=0.0000
    Epoch 10/10: total=23.5341, vae=1.0847, dsb=22.4494, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=2.0261, vae=1.0846, dsb=0.9415, bio=0.0000
    Epoch  2/10: total=1.8830, vae=1.0849, dsb=0.7981, bio=0.0000
    Epoch  3/10: total=1.8454, vae=1.0842, dsb=0.7612, bio=0.0000
    Epoch  4/10: total=1.8225, vae=1.0846, dsb=0.7379, bio=0.0000
    Epoch  5/10: total=1.7815, vae=1.0841, dsb=0.6974, bio=0.0000
    Epoch  6/10: total=1.7787, vae=1.0843, dsb=0.6944, bio=0.0000
    Epoch  7/10: total=1.7731, vae=1.0855, dsb=0.6877, bio=0.0000
    Epoch  8/10: total=1.7599, vae=1.0844, dsb=0.6754, bio=0.0000
    Epoch  9/10: total=1.7507, vae=1.0844, dsb=0.6663, bio=0.0000
    Epoch 10/10: total=1.7612, vae=1.0846, dsb=0.6766, bio=0.0000

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=23.2454, vae=1.0846, dsb=22.1607, bio=0.0000
    Epoch  2/10: total=20.1081, vae=1.0843, dsb=19.0238, bio=0.0000
    Epoch  3/10: total=19.3562, vae=1.0850, dsb=18.2712, bio=0.0000
    Epoch  4/10: total=18.8958, vae=1.0838, dsb=17.8119, bio=0.0000
    Epoch  5/10: total=18.6477, vae=1.0843, dsb=17.5634, bio=0.0000
    Epoch  6/10: total=18.4388, vae=1.0838, dsb=17.3550, bio=0.0000
    Epoch  7/10: total=18.2357, vae=1.0856, dsb=17.1501, bio=0.0000
    Epoch  8/10: total=18.1288, vae=1.0845, dsb=17.0443, bio=0.0000
    Epoch  9/10: total=18.0029, vae=1.0844, dsb=16.9185, bio=0.0000
    Epoch 10/10: total=17.9876, vae=1.0843, dsb=16.9033, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.6701, vae=1.0838, dsb=0.5863, bio=0.0000
    Epoch  2/10: total=1.6162, vae=1.0850, dsb=0.5313, bio=0.0000
    Epoch  3/10: total=1.5839, vae=1.0856, dsb=0.4982, bio=0.0000
    Epoch  4/10: total=1.5814, vae=1.0849, dsb=0.4966, bio=0.0000
    Epoch  5/10: total=1.5486, vae=1.0838, dsb=0.4648, bio=0.0000
    Epoch  6/10: total=1.5539, vae=1.0842, dsb=0.4697, bio=0.0000
    Epoch  7/10: total=1.5426, vae=1.0837, dsb=0.4589, bio=0.0000
    Epoch  8/10: total=1.5457, vae=1.0849, dsb=0.4608, bio=0.0000
    Epoch  9/10: total=1.5415, vae=1.0848, dsb=0.4567, bio=0.0000
    Epoch 10/10: total=1.5397, vae=1.0851, dsb=0.4545, bio=0.0000

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=17.3434, vae=1.0842, dsb=16.2592, bio=0.0000
    Epoch  2/10: total=15.8974, vae=1.0847, dsb=14.8128, bio=0.0000
    Epoch  3/10: total=15.5191, vae=1.0846, dsb=14.4344, bio=0.0000
    Epoch  4/10: total=15.3027, vae=1.0848, dsb=14.2179, bio=0.0000
    Epoch  5/10: total=15.1257, vae=1.0841, dsb=14.0416, bio=0.0000
    Epoch  6/10: total=15.1562, vae=1.0841, dsb=14.0721, bio=0.0000
    Epoch  7/10: total=15.0882, vae=1.0850, dsb=14.0032, bio=0.0000
    Epoch  8/10: total=15.0545, vae=1.0842, dsb=13.9703, bio=0.0000
    Epoch  9/10: total=14.9827, vae=1.0845, dsb=13.8983, bio=0.0000
    Epoch 10/10: total=14.9164, vae=1.0840, dsb=13.8324, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.4750, vae=1.0845, dsb=0.3905, bio=0.0000
    Epoch  2/10: total=1.4536, vae=1.0861, dsb=0.3674, bio=0.0000
    Epoch  3/10: total=1.4360, vae=1.0848, dsb=0.3512, bio=0.0000
    Epoch  4/10: total=1.4209, vae=1.0846, dsb=0.3364, bio=0.0000
    Epoch  5/10: total=1.4262, vae=1.0838, dsb=0.3424, bio=0.0000
    Epoch  6/10: total=1.4197, vae=1.0845, dsb=0.3352, bio=0.0000
    Epoch  7/10: total=1.4226, vae=1.0836, dsb=0.3389, bio=0.0000
    Epoch  8/10: total=1.4136, vae=1.0847, dsb=0.3289, bio=0.0000
    Epoch  9/10: total=1.4073, vae=1.0840, dsb=0.3233, bio=0.0000
    Epoch 10/10: total=1.4038, vae=1.0847, dsb=0.3191, bio=0.0000

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=13.7718, vae=1.0843, dsb=12.6876, bio=0.0000
    Epoch  2/10: total=13.1849, vae=1.0845, dsb=12.1005, bio=0.0000
    Epoch  3/10: total=13.1128, vae=1.0835, dsb=12.0293, bio=0.0000
    Epoch  4/10: total=12.9918, vae=1.0843, dsb=11.9075, bio=0.0000
    Epoch  5/10: total=12.9363, vae=1.0846, dsb=11.8517, bio=0.0000
    Epoch  6/10: total=12.9754, vae=1.0850, dsb=11.8903, bio=0.0000
    Epoch  7/10: total=12.8968, vae=1.0846, dsb=11.8123, bio=0.0000
    Epoch  8/10: total=12.9036, vae=1.0848, dsb=11.8188, bio=0.0000
    Epoch  9/10: total=12.8818, vae=1.0845, dsb=11.7974, bio=0.0000
    Epoch 10/10: total=12.8894, vae=1.0843, dsb=11.8050, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.3607, vae=1.0851, dsb=0.2757, bio=0.0000
    Epoch  2/10: total=1.3416, vae=1.0848, dsb=0.2568, bio=0.0000
    Epoch  3/10: total=1.3458, vae=1.0847, dsb=0.2612, bio=0.0000
    Epoch  4/10: total=1.3354, vae=1.0844, dsb=0.2510, bio=0.0000
    Epoch  5/10: total=1.3427, vae=1.0839, dsb=0.2589, bio=0.0000
    Epoch  6/10: total=1.3342, vae=1.0847, dsb=0.2496, bio=0.0000
    Epoch  7/10: total=1.3409, vae=1.0845, dsb=0.2564, bio=0.0000
    Epoch  8/10: total=1.3372, vae=1.0842, dsb=0.2530, bio=0.0000
    Epoch  9/10: total=1.3316, vae=1.0846, dsb=0.2469, bio=0.0000
    Epoch 10/10: total=1.3332, vae=1.0849, dsb=0.2483, bio=0.0000

[Seed 61] Joint training (ablation) complete; models and history saved.

[Seed 61] Drift genes saved in /home/yyuan/ICB_TCE/iter_results/run_061

[Seed 61] run finished.

================================================================================
[Seed 62] Starting running whole pipeline...
================================================================================

[Seed 62] Starting VAE pre-training...

    Epoch [01/20], Beta: 0.000, Average Loss: 534.8516
    Epoch [02/20], Beta: 0.000, Average Loss: 307.1791
    Epoch [03/20], Beta: 0.000, Average Loss: 269.9353
    Epoch [04/20], Beta: 0.000, Average Loss: 249.8205
    Epoch [05/20], Beta: 0.100, Average Loss: 245.3079
    Epoch [06/20], Beta: 0.200, Average Loss: 244.8720
    Epoch [07/20], Beta: 0.300, Average Loss: 245.2403
    Epoch [08/20], Beta: 0.400, Average Loss: 245.8861
    Epoch [09/20], Beta: 0.500, Average Loss: 246.8599
    Epoch [10/20], Beta: 0.600, Average Loss: 248.0213
    Epoch [11/20], Beta: 0.700, Average Loss: 249.2785
    Epoch [12/20], Beta: 0.800, Average Loss: 250.5741
    Epoch [13/20], Beta: 0.900, Average Loss: 251.7965
    Epoch [14/20], Beta: 1.000, Average Loss: 253.3984
    Epoch [15/20], Beta: 1.000, Average Loss: 252.9614
    Epoch [16/20], Beta: 1.000, Average Loss: 252.5705
    Epoch [17/20], Beta: 1.000, Average Loss: 252.2200
    Epoch [18/20], Beta: 1.000, Average Loss: 251.9103
    Epoch [19/20], Beta: 1.000, Average Loss: 251.5506
    Epoch [20/20], Beta: 1.000, Average Loss: 251.3506

[Seed 62] VAE pre-training complete.

[Seed 62] Starting joint training (original)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=390.2175, vae=3.6488, dsb=372.0794, bio=28.9785
    Epoch  2/10: total=109.7044, vae=1.1054, dsb=108.5625, bio=0.0733
    Epoch  3/10: total=94.3163, vae=1.1014, dsb=93.1993, bio=0.0311
    Epoch  4/10: total=86.8794, vae=1.0996, dsb=85.7710, bio=0.0176
    Epoch  5/10: total=82.6123, vae=1.0980, dsb=81.5084, bio=0.0117
    Epoch  6/10: total=79.6610, vae=1.0978, dsb=78.5590, bio=0.0084
    Epoch  7/10: total=77.5409, vae=1.0966, dsb=76.4410, bio=0.0065
    Epoch  8/10: total=75.9525, vae=1.0958, dsb=74.8540, bio=0.0053
    Epoch  9/10: total=74.8609, vae=1.0966, dsb=73.7621, bio=0.0044
    Epoch 10/10: total=73.6179, vae=1.0963, dsb=72.5196, bio=0.0039

  [Backward Policy Training]
    Epoch  1/10: total=3.4903, vae=1.0979, dsb=2.3866, bio=0.0116
    Epoch  2/10: total=2.8812, vae=1.0966, dsb=1.7826, bio=0.0040
    Epoch  3/10: total=2.7411, vae=1.0955, dsb=1.6441, bio=0.0030
    Epoch  4/10: total=2.6528, vae=1.0950, dsb=1.5566, bio=0.0025
    Epoch  5/10: total=2.6566, vae=1.0952, dsb=1.5603, bio=0.0023
    Epoch  6/10: total=2.5897, vae=1.0943, dsb=1.4943, bio=0.0022
    Epoch  7/10: total=2.5120, vae=1.0938, dsb=1.4171, bio=0.0021
    Epoch  8/10: total=2.5075, vae=1.0931, dsb=1.4134, bio=0.0020
    Epoch  9/10: total=2.4838, vae=1.0929, dsb=1.3899, bio=0.0019
    Epoch 10/10: total=2.4824, vae=1.0940, dsb=1.3875, bio=0.0019

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=69.1309, vae=1.0961, dsb=68.0332, bio=0.0033
    Epoch  2/10: total=60.1582, vae=1.0947, dsb=59.0626, bio=0.0019
    Epoch  3/10: total=57.8887, vae=1.0940, dsb=56.7937, bio=0.0018
    Epoch  4/10: total=56.5245, vae=1.0951, dsb=55.4285, bio=0.0018
    Epoch  5/10: total=55.5494, vae=1.0945, dsb=54.4541, bio=0.0017
    Epoch  6/10: total=55.1953, vae=1.0948, dsb=54.0995, bio=0.0017
    Epoch  7/10: total=54.6527, vae=1.0947, dsb=53.5571, bio=0.0019
    Epoch  8/10: total=54.4872, vae=1.0943, dsb=53.3921, bio=0.0016
    Epoch  9/10: total=54.0876, vae=1.0929, dsb=52.9940, bio=0.0016
    Epoch 10/10: total=53.6408, vae=1.0940, dsb=52.5460, bio=0.0016

  [Backward Policy Training]
    Epoch  1/10: total=2.2390, vae=1.0936, dsb=1.1417, bio=0.0073
    Epoch  2/10: total=2.1184, vae=1.0925, dsb=1.0251, bio=0.0016
    Epoch  3/10: total=2.0955, vae=1.0924, dsb=1.0023, bio=0.0015
    Epoch  4/10: total=2.0298, vae=1.0930, dsb=0.9361, bio=0.0015
    Epoch  5/10: total=2.0049, vae=1.0925, dsb=0.9117, bio=0.0014
    Epoch  6/10: total=1.9966, vae=1.0924, dsb=0.9036, bio=0.0013
    Epoch  7/10: total=2.0186, vae=1.0924, dsb=0.9255, bio=0.0013
    Epoch  8/10: total=1.9661, vae=1.0918, dsb=0.8736, bio=0.0013
    Epoch  9/10: total=1.9606, vae=1.0920, dsb=0.8680, bio=0.0013
    Epoch 10/10: total=1.9618, vae=1.0922, dsb=0.8690, bio=0.0013

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=49.3347, vae=1.0941, dsb=48.2393, bio=0.0026
    Epoch  2/10: total=46.6028, vae=1.0932, dsb=45.5090, bio=0.0014
    Epoch  3/10: total=45.3463, vae=1.0924, dsb=44.2532, bio=0.0013
    Epoch  4/10: total=44.8160, vae=1.0928, dsb=43.7226, bio=0.0013
    Epoch  5/10: total=44.6870, vae=1.0929, dsb=43.5935, bio=0.0013
    Epoch  6/10: total=44.5589, vae=1.0923, dsb=43.4659, bio=0.0013
    Epoch  7/10: total=44.2784, vae=1.0921, dsb=43.1856, bio=0.0012
    Epoch  8/10: total=44.0052, vae=1.0931, dsb=42.9115, bio=0.0012
    Epoch  9/10: total=43.9012, vae=1.0920, dsb=42.8085, bio=0.0012
    Epoch 10/10: total=43.9606, vae=1.0919, dsb=42.8682, bio=0.0011

  [Backward Policy Training]
    Epoch  1/10: total=1.9117, vae=1.0933, dsb=0.7808, bio=0.0751
    Epoch  2/10: total=1.8080, vae=1.0923, dsb=0.7150, bio=0.0013
    Epoch  3/10: total=1.8026, vae=1.0925, dsb=0.7095, bio=0.0012
    Epoch  4/10: total=1.7818, vae=1.0913, dsb=0.6899, bio=0.0011
    Epoch  5/10: total=1.7623, vae=1.0924, dsb=0.6694, bio=0.0011
    Epoch  6/10: total=1.7432, vae=1.0916, dsb=0.6510, bio=0.0010
    Epoch  7/10: total=1.7683, vae=1.0923, dsb=0.6756, bio=0.0010
    Epoch  8/10: total=1.7349, vae=1.0922, dsb=0.6420, bio=0.0015
    Epoch  9/10: total=1.7349, vae=1.0913, dsb=0.6431, bio=0.0010
    Epoch 10/10: total=1.7276, vae=1.0911, dsb=0.6359, bio=0.0010

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=41.1303, vae=1.0944, dsb=40.0347, bio=0.0024
    Epoch  2/10: total=39.8052, vae=1.0926, dsb=38.7121, bio=0.0011
    Epoch  3/10: total=39.1938, vae=1.0926, dsb=38.1007, bio=0.0011
    Epoch  4/10: total=39.5141, vae=1.0917, dsb=38.4218, bio=0.0010
    Epoch  5/10: total=39.2617, vae=1.0921, dsb=38.1691, bio=0.0009
    Epoch  6/10: total=39.2420, vae=1.0924, dsb=38.1494, bio=0.0004
    Epoch  7/10: total=39.1609, vae=1.0914, dsb=38.0689, bio=0.0010
    Epoch  8/10: total=39.1260, vae=1.0918, dsb=38.0336, bio=0.0011
    Epoch  9/10: total=38.8697, vae=1.0918, dsb=37.7774, bio=0.0008
    Epoch 10/10: total=38.8556, vae=1.0918, dsb=37.7636, bio=0.0005

  [Backward Policy Training]
    Epoch  1/10: total=1.7222, vae=1.0929, dsb=0.5447, bio=0.1691
    Epoch  2/10: total=1.6084, vae=1.0917, dsb=0.5160, bio=0.0013
    Epoch  3/10: total=1.5794, vae=1.0927, dsb=0.4862, bio=0.0011
    Epoch  4/10: total=1.5797, vae=1.0915, dsb=0.4879, bio=0.0006
    Epoch  5/10: total=1.5869, vae=1.0917, dsb=0.4946, bio=0.0012
    Epoch  6/10: total=1.5677, vae=1.0909, dsb=0.4763, bio=0.0010
    Epoch  7/10: total=1.5779, vae=1.0921, dsb=0.4853, bio=0.0010
    Epoch  8/10: total=1.5611, vae=1.0909, dsb=0.4699, bio=0.0005
    Epoch  9/10: total=1.5738, vae=1.0909, dsb=0.4825, bio=0.0008
    Epoch 10/10: total=1.5534, vae=1.0908, dsb=0.4620, bio=0.0011

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=32.6866, vae=1.0934, dsb=31.5916, bio=0.0030
    Epoch  2/10: total=32.4266, vae=1.0927, dsb=31.3334, bio=0.0010
    Epoch  3/10: total=32.3217, vae=1.0925, dsb=31.2289, bio=0.0005
    Epoch  4/10: total=32.1177, vae=1.0917, dsb=31.0258, bio=0.0005
    Epoch  5/10: total=32.0810, vae=1.0912, dsb=30.9896, bio=0.0005
    Epoch  6/10: total=32.1448, vae=1.0920, dsb=31.0525, bio=0.0007
    Epoch  7/10: total=32.1312, vae=1.0913, dsb=31.0398, bio=0.0004
    Epoch  8/10: total=32.0448, vae=1.0917, dsb=30.9528, bio=0.0006
    Epoch  9/10: total=32.0311, vae=1.0916, dsb=30.9389, bio=0.0012
    Epoch 10/10: total=32.0071, vae=1.0914, dsb=30.9154, bio=0.0007

  [Backward Policy Training]
    Epoch  1/10: total=1.6392, vae=1.0928, dsb=0.4376, bio=0.2177
    Epoch  2/10: total=1.5230, vae=1.0912, dsb=0.4314, bio=0.0008
    Epoch  3/10: total=1.5136, vae=1.0909, dsb=0.4224, bio=0.0006
    Epoch  4/10: total=1.5141, vae=1.0908, dsb=0.4227, bio=0.0011
    Epoch  5/10: total=1.5138, vae=1.0915, dsb=0.4221, bio=0.0004
    Epoch  6/10: total=1.5092, vae=1.0905, dsb=0.4181, bio=0.0011
    Epoch  7/10: total=1.5003, vae=1.0909, dsb=0.4089, bio=0.0011
    Epoch  8/10: total=1.5108, vae=1.0913, dsb=0.4194, bio=0.0002
    Epoch  9/10: total=1.5163, vae=1.0910, dsb=0.4248, bio=0.0011
    Epoch 10/10: total=1.5062, vae=1.0897, dsb=0.4160, bio=0.0009

[Seed 62] Joint training (original) complete; models and history saved.

[Seed 62] Starting joint training (ablation)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=373.5038, vae=1.9975, dsb=371.5064, bio=0.0000
    Epoch  2/10: total=109.1662, vae=1.0878, dsb=108.0784, bio=0.0000
    Epoch  3/10: total=93.7534, vae=1.0867, dsb=92.6667, bio=0.0000
    Epoch  4/10: total=86.4433, vae=1.0859, dsb=85.3575, bio=0.0000
    Epoch  5/10: total=82.2070, vae=1.0849, dsb=81.1221, bio=0.0000
    Epoch  6/10: total=79.3541, vae=1.0851, dsb=78.2690, bio=0.0000
    Epoch  7/10: total=77.2417, vae=1.0842, dsb=76.1575, bio=0.0000
    Epoch  8/10: total=75.6812, vae=1.0837, dsb=74.5975, bio=0.0000
    Epoch  9/10: total=74.5996, vae=1.0848, dsb=73.5148, bio=0.0000
    Epoch 10/10: total=73.3955, vae=1.0847, dsb=72.3108, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=3.4003, vae=1.0847, dsb=2.3156, bio=0.0000
    Epoch  2/10: total=2.8126, vae=1.0855, dsb=1.7270, bio=0.0000
    Epoch  3/10: total=2.6765, vae=1.0849, dsb=1.5916, bio=0.0000
    Epoch  4/10: total=2.5908, vae=1.0847, dsb=1.5061, bio=0.0000
    Epoch  5/10: total=2.5951, vae=1.0852, dsb=1.5099, bio=0.0000
    Epoch  6/10: total=2.5307, vae=1.0845, dsb=1.4463, bio=0.0000
    Epoch  7/10: total=2.4562, vae=1.0841, dsb=1.3721, bio=0.0000
    Epoch  8/10: total=2.4520, vae=1.0836, dsb=1.3684, bio=0.0000
    Epoch  9/10: total=2.4301, vae=1.0835, dsb=1.3466, bio=0.0000
    Epoch 10/10: total=2.4289, vae=1.0846, dsb=1.3443, bio=0.0000

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=67.3506, vae=1.0840, dsb=66.2665, bio=0.0000
    Epoch  2/10: total=58.6943, vae=1.0841, dsb=57.6103, bio=0.0000
    Epoch  3/10: total=56.4568, vae=1.0836, dsb=55.3732, bio=0.0000
    Epoch  4/10: total=55.1367, vae=1.0849, dsb=54.0519, bio=0.0000
    Epoch  5/10: total=54.1758, vae=1.0844, dsb=53.0915, bio=0.0000
    Epoch  6/10: total=53.9305, vae=1.0849, dsb=52.8456, bio=0.0000
    Epoch  7/10: total=53.3839, vae=1.0847, dsb=52.2991, bio=0.0000
    Epoch  8/10: total=53.2669, vae=1.0846, dsb=52.1823, bio=0.0000
    Epoch  9/10: total=52.8532, vae=1.0833, dsb=51.7699, bio=0.0000
    Epoch 10/10: total=52.4211, vae=1.0845, dsb=51.3365, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=2.1498, vae=1.0836, dsb=1.0663, bio=0.0000
    Epoch  2/10: total=2.0417, vae=1.0836, dsb=0.9581, bio=0.0000
    Epoch  3/10: total=2.0216, vae=1.0837, dsb=0.9379, bio=0.0000
    Epoch  4/10: total=1.9593, vae=1.0844, dsb=0.8749, bio=0.0000
    Epoch  5/10: total=1.9358, vae=1.0840, dsb=0.8518, bio=0.0000
    Epoch  6/10: total=1.9272, vae=1.0839, dsb=0.8433, bio=0.0000
    Epoch  7/10: total=1.9478, vae=1.0840, dsb=0.8638, bio=0.0000
    Epoch  8/10: total=1.8985, vae=1.0835, dsb=0.8150, bio=0.0000
    Epoch  9/10: total=1.8936, vae=1.0838, dsb=0.8099, bio=0.0000
    Epoch 10/10: total=1.8947, vae=1.0839, dsb=0.8108, bio=0.0000

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=48.3773, vae=1.0834, dsb=47.2939, bio=0.0000
    Epoch  2/10: total=45.6120, vae=1.0837, dsb=44.5283, bio=0.0000
    Epoch  3/10: total=44.3891, vae=1.0832, dsb=43.3059, bio=0.0000
    Epoch  4/10: total=43.9410, vae=1.0837, dsb=42.8573, bio=0.0000
    Epoch  5/10: total=43.8034, vae=1.0840, dsb=42.7193, bio=0.0000
    Epoch  6/10: total=43.6948, vae=1.0835, dsb=42.6113, bio=0.0000
    Epoch  7/10: total=43.4116, vae=1.0835, dsb=42.3281, bio=0.0000
    Epoch  8/10: total=43.1852, vae=1.0846, dsb=42.1006, bio=0.0000
    Epoch  9/10: total=43.1167, vae=1.0837, dsb=42.0331, bio=0.0000
    Epoch 10/10: total=43.1214, vae=1.0835, dsb=42.0379, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.8125, vae=1.0839, dsb=0.7286, bio=0.0000
    Epoch  2/10: total=1.7525, vae=1.0841, dsb=0.6684, bio=0.0000
    Epoch  3/10: total=1.7473, vae=1.0844, dsb=0.6629, bio=0.0000
    Epoch  4/10: total=1.7270, vae=1.0834, dsb=0.6436, bio=0.0000
    Epoch  5/10: total=1.7085, vae=1.0845, dsb=0.6240, bio=0.0000
    Epoch  6/10: total=1.6906, vae=1.0837, dsb=0.6069, bio=0.0000
    Epoch  7/10: total=1.7139, vae=1.0845, dsb=0.6295, bio=0.0000
    Epoch  8/10: total=1.6826, vae=1.0844, dsb=0.5983, bio=0.0000
    Epoch  9/10: total=1.6835, vae=1.0834, dsb=0.6001, bio=0.0000
    Epoch 10/10: total=1.6769, vae=1.0835, dsb=0.5934, bio=0.0000

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=41.1298, vae=1.0842, dsb=40.0456, bio=0.0000
    Epoch  2/10: total=39.9015, vae=1.0836, dsb=38.8179, bio=0.0000
    Epoch  3/10: total=39.2721, vae=1.0839, dsb=38.1882, bio=0.0000
    Epoch  4/10: total=39.6308, vae=1.0835, dsb=38.5473, bio=0.0000
    Epoch  5/10: total=39.3596, vae=1.0840, dsb=38.2756, bio=0.0000
    Epoch  6/10: total=39.3330, vae=1.0845, dsb=38.2486, bio=0.0000
    Epoch  7/10: total=39.3238, vae=1.0836, dsb=38.2402, bio=0.0000
    Epoch  8/10: total=39.2530, vae=1.0841, dsb=38.1689, bio=0.0000
    Epoch  9/10: total=38.9665, vae=1.0841, dsb=37.8823, bio=0.0000
    Epoch 10/10: total=38.9927, vae=1.0841, dsb=37.9086, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.6019, vae=1.0838, dsb=0.5181, bio=0.0000
    Epoch  2/10: total=1.5756, vae=1.0839, dsb=0.4917, bio=0.0000
    Epoch  3/10: total=1.5489, vae=1.0850, dsb=0.4639, bio=0.0000
    Epoch  4/10: total=1.5500, vae=1.0839, dsb=0.4662, bio=0.0000
    Epoch  5/10: total=1.5571, vae=1.0843, dsb=0.4728, bio=0.0000
    Epoch  6/10: total=1.5386, vae=1.0835, dsb=0.4551, bio=0.0000
    Epoch  7/10: total=1.5492, vae=1.0847, dsb=0.4645, bio=0.0000
    Epoch  8/10: total=1.5331, vae=1.0836, dsb=0.4495, bio=0.0000
    Epoch  9/10: total=1.5455, vae=1.0837, dsb=0.4617, bio=0.0000
    Epoch 10/10: total=1.5254, vae=1.0838, dsb=0.4416, bio=0.0000

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=33.5778, vae=1.0836, dsb=32.4942, bio=0.0000
    Epoch  2/10: total=33.3261, vae=1.0843, dsb=32.2418, bio=0.0000
    Epoch  3/10: total=33.2595, vae=1.0844, dsb=32.1751, bio=0.0000
    Epoch  4/10: total=33.0341, vae=1.0838, dsb=31.9502, bio=0.0000
    Epoch  5/10: total=32.9898, vae=1.0835, dsb=31.9062, bio=0.0000
    Epoch  6/10: total=33.0765, vae=1.0844, dsb=31.9920, bio=0.0000
    Epoch  7/10: total=33.0270, vae=1.0838, dsb=31.9432, bio=0.0000
    Epoch  8/10: total=32.9603, vae=1.0842, dsb=31.8761, bio=0.0000
    Epoch  9/10: total=32.9605, vae=1.0843, dsb=31.8762, bio=0.0000
    Epoch 10/10: total=32.8894, vae=1.0841, dsb=31.8053, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.5076, vae=1.0840, dsb=0.4235, bio=0.0000
    Epoch  2/10: total=1.5013, vae=1.0838, dsb=0.4175, bio=0.0000
    Epoch  3/10: total=1.4924, vae=1.0837, dsb=0.4087, bio=0.0000
    Epoch  4/10: total=1.4928, vae=1.0838, dsb=0.4090, bio=0.0000
    Epoch  5/10: total=1.4935, vae=1.0845, dsb=0.4090, bio=0.0000
    Epoch  6/10: total=1.4884, vae=1.0837, dsb=0.4047, bio=0.0000
    Epoch  7/10: total=1.4797, vae=1.0841, dsb=0.3956, bio=0.0000
    Epoch  8/10: total=1.4906, vae=1.0845, dsb=0.4061, bio=0.0000
    Epoch  9/10: total=1.4959, vae=1.0844, dsb=0.4115, bio=0.0000
    Epoch 10/10: total=1.4859, vae=1.0832, dsb=0.4027, bio=0.0000

[Seed 62] Joint training (ablation) complete; models and history saved.

[Seed 62] Drift genes saved in /home/yyuan/ICB_TCE/iter_results/run_062

[Seed 62] run finished.

================================================================================
[Seed 63] Starting running whole pipeline...
================================================================================

[Seed 63] Starting VAE pre-training...

    Epoch [01/20], Beta: 0.000, Average Loss: 534.0382
    Epoch [02/20], Beta: 0.000, Average Loss: 304.7234
    Epoch [03/20], Beta: 0.000, Average Loss: 267.3191
    Epoch [04/20], Beta: 0.000, Average Loss: 247.7270
    Epoch [05/20], Beta: 0.100, Average Loss: 243.5501
    Epoch [06/20], Beta: 0.200, Average Loss: 243.1826
    Epoch [07/20], Beta: 0.300, Average Loss: 243.6977
    Epoch [08/20], Beta: 0.400, Average Loss: 244.6800
    Epoch [09/20], Beta: 0.500, Average Loss: 245.8281
    Epoch [10/20], Beta: 0.600, Average Loss: 247.1555
    Epoch [11/20], Beta: 0.700, Average Loss: 248.5906
    Epoch [12/20], Beta: 0.800, Average Loss: 249.9593
    Epoch [13/20], Beta: 0.900, Average Loss: 251.3015
    Epoch [14/20], Beta: 1.000, Average Loss: 252.9660
    Epoch [15/20], Beta: 1.000, Average Loss: 252.5773
    Epoch [16/20], Beta: 1.000, Average Loss: 252.1819
    Epoch [17/20], Beta: 1.000, Average Loss: 251.8573
    Epoch [18/20], Beta: 1.000, Average Loss: 251.5920
    Epoch [19/20], Beta: 1.000, Average Loss: 251.2411
    Epoch [20/20], Beta: 1.000, Average Loss: 251.0651

[Seed 63] VAE pre-training complete.

[Seed 63] Starting joint training (original)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=284.9238, vae=3.9666, dsb=255.7060, bio=50.5025
    Epoch  2/10: total=83.1220, vae=1.1138, dsb=81.9719, bio=0.0727
    Epoch  3/10: total=71.5275, vae=1.1072, dsb=70.4042, bio=0.0322
    Epoch  4/10: total=65.8035, vae=1.1060, dsb=64.6876, bio=0.0199
    Epoch  5/10: total=62.4665, vae=1.1051, dsb=61.3547, bio=0.0134
    Epoch  6/10: total=60.0205, vae=1.1037, dsb=58.9119, bio=0.0098
    Epoch  7/10: total=58.4819, vae=1.1031, dsb=57.3750, bio=0.0076
    Epoch  8/10: total=57.1561, vae=1.1020, dsb=56.0510, bio=0.0063
    Epoch  9/10: total=56.0522, vae=1.1020, dsb=54.9475, bio=0.0054
    Epoch 10/10: total=55.1875, vae=1.1023, dsb=54.0828, bio=0.0047

  [Backward Policy Training]
    Epoch  1/10: total=3.2620, vae=1.1032, dsb=2.1513, bio=0.0149
    Epoch  2/10: total=2.7628, vae=1.1016, dsb=1.6586, bio=0.0053
    Epoch  3/10: total=2.5930, vae=1.1010, dsb=1.4900, bio=0.0038
    Epoch  4/10: total=2.5443, vae=1.1010, dsb=1.4417, bio=0.0032
    Epoch  5/10: total=2.4876, vae=1.1009, dsb=1.3853, bio=0.0028
    Epoch  6/10: total=2.4609, vae=1.1006, dsb=1.3590, bio=0.0026
    Epoch  7/10: total=2.4549, vae=1.1005, dsb=1.3532, bio=0.0024
    Epoch  8/10: total=2.4289, vae=1.1001, dsb=1.3276, bio=0.0023
    Epoch  9/10: total=2.3821, vae=1.1007, dsb=1.2803, bio=0.0022
    Epoch 10/10: total=2.3627, vae=1.1005, dsb=1.2612, bio=0.0021

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=51.6926, vae=1.1026, dsb=50.5882, bio=0.0037
    Epoch  2/10: total=44.6849, vae=1.1011, dsb=43.5828, bio=0.0021
    Epoch  3/10: total=43.0014, vae=1.1007, dsb=41.8997, bio=0.0020
    Epoch  4/10: total=41.8121, vae=1.1012, dsb=40.7099, bio=0.0020
    Epoch  5/10: total=41.2227, vae=1.1008, dsb=40.1209, bio=0.0020
    Epoch  6/10: total=40.8672, vae=1.1006, dsb=39.7656, bio=0.0020
    Epoch  7/10: total=40.5429, vae=1.1008, dsb=39.4410, bio=0.0023
    Epoch  8/10: total=40.1313, vae=1.1012, dsb=39.0292, bio=0.0020
    Epoch  9/10: total=39.9722, vae=1.1009, dsb=38.8704, bio=0.0019
    Epoch 10/10: total=39.7092, vae=1.1002, dsb=38.6080, bio=0.0019

  [Backward Policy Training]
    Epoch  1/10: total=2.0783, vae=1.1015, dsb=0.9735, bio=0.0067
    Epoch  2/10: total=1.9767, vae=1.0996, dsb=0.8761, bio=0.0021
    Epoch  3/10: total=1.9526, vae=1.0993, dsb=0.8523, bio=0.0019
    Epoch  4/10: total=1.9015, vae=1.0999, dsb=0.8007, bio=0.0018
    Epoch  5/10: total=1.9078, vae=1.0996, dsb=0.8073, bio=0.0018
    Epoch  6/10: total=1.8848, vae=1.0985, dsb=0.7855, bio=0.0017
    Epoch  7/10: total=1.8775, vae=1.0989, dsb=0.7778, bio=0.0017
    Epoch  8/10: total=1.8872, vae=1.0987, dsb=0.7877, bio=0.0016
    Epoch  9/10: total=1.8526, vae=1.0985, dsb=0.7532, bio=0.0016
    Epoch 10/10: total=1.8494, vae=1.0981, dsb=0.7505, bio=0.0016

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=37.2074, vae=1.1018, dsb=36.1041, bio=0.0031
    Epoch  2/10: total=34.7217, vae=1.1003, dsb=33.6206, bio=0.0016
    Epoch  3/10: total=33.8281, vae=1.1001, dsb=32.7272, bio=0.0016
    Epoch  4/10: total=33.4403, vae=1.1006, dsb=32.3389, bio=0.0016
    Epoch  5/10: total=33.3704, vae=1.1009, dsb=32.2687, bio=0.0016
    Epoch  6/10: total=33.0187, vae=1.0999, dsb=31.9178, bio=0.0020
    Epoch  7/10: total=32.8882, vae=1.0992, dsb=31.7882, bio=0.0015
    Epoch  8/10: total=32.9880, vae=1.0996, dsb=31.8876, bio=0.0015
    Epoch  9/10: total=32.9060, vae=1.0993, dsb=31.8059, bio=0.0016
    Epoch 10/10: total=32.8229, vae=1.0997, dsb=31.7224, bio=0.0016

  [Backward Policy Training]
    Epoch  1/10: total=1.8242, vae=1.0999, dsb=0.7173, bio=0.0141
    Epoch  2/10: total=1.7434, vae=1.0987, dsb=0.6440, bio=0.0016
    Epoch  3/10: total=1.7250, vae=1.0985, dsb=0.6257, bio=0.0015
    Epoch  4/10: total=1.6920, vae=1.0991, dsb=0.5922, bio=0.0014
    Epoch  5/10: total=1.6922, vae=1.0983, dsb=0.5933, bio=0.0014
    Epoch  6/10: total=1.6843, vae=1.0993, dsb=0.5844, bio=0.0013
    Epoch  7/10: total=1.6746, vae=1.0986, dsb=0.5753, bio=0.0013
    Epoch  8/10: total=1.6854, vae=1.0989, dsb=0.5859, bio=0.0013
    Epoch  9/10: total=1.6744, vae=1.0982, dsb=0.5756, bio=0.0013
    Epoch 10/10: total=1.6805, vae=1.0990, dsb=0.5809, bio=0.0013

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=30.9396, vae=1.1018, dsb=29.8364, bio=0.0027
    Epoch  2/10: total=29.9499, vae=1.0996, dsb=28.8495, bio=0.0017
    Epoch  3/10: total=29.6617, vae=1.1002, dsb=28.5609, bio=0.0013
    Epoch  4/10: total=29.4075, vae=1.0990, dsb=28.3078, bio=0.0014
    Epoch  5/10: total=29.2209, vae=1.1004, dsb=28.1198, bio=0.0014
    Epoch  6/10: total=29.2105, vae=1.0986, dsb=28.1112, bio=0.0014
    Epoch  7/10: total=29.0407, vae=1.0978, dsb=27.9423, bio=0.0014
    Epoch  8/10: total=29.2376, vae=1.0997, dsb=28.1373, bio=0.0013
    Epoch  9/10: total=29.0297, vae=1.0988, dsb=27.9302, bio=0.0014
    Epoch 10/10: total=29.0757, vae=1.0987, dsb=27.9764, bio=0.0013

  [Backward Policy Training]
    Epoch  1/10: total=1.6265, vae=1.1000, dsb=0.5015, bio=0.0499
    Epoch  2/10: total=1.5942, vae=1.0981, dsb=0.4955, bio=0.0013
    Epoch  3/10: total=1.5772, vae=1.0990, dsb=0.4776, bio=0.0012
    Epoch  4/10: total=1.5733, vae=1.0979, dsb=0.4748, bio=0.0012
    Epoch  5/10: total=1.5634, vae=1.0985, dsb=0.4643, bio=0.0012
    Epoch  6/10: total=1.5627, vae=1.0979, dsb=0.4643, bio=0.0010
    Epoch  7/10: total=1.5619, vae=1.0987, dsb=0.4626, bio=0.0011
    Epoch  8/10: total=1.5652, vae=1.0983, dsb=0.4663, bio=0.0011
    Epoch  9/10: total=1.5656, vae=1.0990, dsb=0.4660, bio=0.0011
    Epoch 10/10: total=1.5508, vae=1.0991, dsb=0.4511, bio=0.0011

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=26.6070, vae=1.1009, dsb=25.5048, bio=0.0025
    Epoch  2/10: total=26.3461, vae=1.0982, dsb=25.2472, bio=0.0012
    Epoch  3/10: total=26.1621, vae=1.0993, dsb=25.0621, bio=0.0012
    Epoch  4/10: total=26.1987, vae=1.0993, dsb=25.0988, bio=0.0012
    Epoch  5/10: total=26.0961, vae=1.0988, dsb=24.9967, bio=0.0012
    Epoch  6/10: total=26.0328, vae=1.0985, dsb=24.9338, bio=0.0010
    Epoch  7/10: total=25.9984, vae=1.0981, dsb=24.8999, bio=0.0010
    Epoch  8/10: total=25.9930, vae=1.0980, dsb=24.8944, bio=0.0011
    Epoch  9/10: total=26.0538, vae=1.0981, dsb=24.9551, bio=0.0011
    Epoch 10/10: total=26.0642, vae=1.0976, dsb=24.9660, bio=0.0011

  [Backward Policy Training]
    Epoch  1/10: total=1.5780, vae=1.0991, dsb=0.4096, bio=0.1386
    Epoch  2/10: total=1.4942, vae=1.0986, dsb=0.3950, bio=0.0012
    Epoch  3/10: total=1.4944, vae=1.0984, dsb=0.3955, bio=0.0011
    Epoch  4/10: total=1.4827, vae=1.0983, dsb=0.3839, bio=0.0010
    Epoch  5/10: total=1.4879, vae=1.0977, dsb=0.3899, bio=0.0006
    Epoch  6/10: total=1.4949, vae=1.0981, dsb=0.3962, bio=0.0012
    Epoch  7/10: total=1.4956, vae=1.0974, dsb=0.3977, bio=0.0010
    Epoch  8/10: total=1.4888, vae=1.0990, dsb=0.3893, bio=0.0010
    Epoch  9/10: total=1.4839, vae=1.0974, dsb=0.3860, bio=0.0010
    Epoch 10/10: total=1.4910, vae=1.0974, dsb=0.3931, bio=0.0009

[Seed 63] Joint training (original) complete; models and history saved.

[Seed 63] Starting joint training (ablation)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=257.3977, vae=2.0384, dsb=255.3593, bio=0.0000
    Epoch  2/10: total=82.6987, vae=1.0948, dsb=81.6038, bio=0.0000
    Epoch  3/10: total=71.1476, vae=1.0920, dsb=70.0555, bio=0.0000
    Epoch  4/10: total=65.3850, vae=1.0922, dsb=64.2928, bio=0.0000
    Epoch  5/10: total=62.0255, vae=1.0920, dsb=60.9335, bio=0.0000
    Epoch  6/10: total=59.6123, vae=1.0910, dsb=58.5212, bio=0.0000
    Epoch  7/10: total=57.9953, vae=1.0908, dsb=56.9046, bio=0.0000
    Epoch  8/10: total=56.6167, vae=1.0901, dsb=55.5266, bio=0.0000
    Epoch  9/10: total=55.5302, vae=1.0904, dsb=54.4399, bio=0.0000
    Epoch 10/10: total=54.7165, vae=1.0909, dsb=53.6256, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=3.1621, vae=1.0905, dsb=2.0716, bio=0.0000
    Epoch  2/10: total=2.6974, vae=1.0905, dsb=1.6068, bio=0.0000
    Epoch  3/10: total=2.5359, vae=1.0905, dsb=1.4454, bio=0.0000
    Epoch  4/10: total=2.4870, vae=1.0908, dsb=1.3962, bio=0.0000
    Epoch  5/10: total=2.4322, vae=1.0909, dsb=1.3413, bio=0.0000
    Epoch  6/10: total=2.4064, vae=1.0908, dsb=1.3156, bio=0.0000
    Epoch  7/10: total=2.4033, vae=1.0908, dsb=1.3125, bio=0.0000
    Epoch  8/10: total=2.3804, vae=1.0906, dsb=1.2899, bio=0.0000
    Epoch  9/10: total=2.3345, vae=1.0912, dsb=1.2433, bio=0.0000
    Epoch 10/10: total=2.3163, vae=1.0910, dsb=1.2252, bio=0.0000

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=50.9490, vae=1.0903, dsb=49.8586, bio=0.0000
    Epoch  2/10: total=43.9824, vae=1.0903, dsb=42.8921, bio=0.0000
    Epoch  3/10: total=42.2436, vae=1.0902, dsb=41.1535, bio=0.0000
    Epoch  4/10: total=41.0052, vae=1.0908, dsb=39.9144, bio=0.0000
    Epoch  5/10: total=40.4435, vae=1.0905, dsb=39.3531, bio=0.0000
    Epoch  6/10: total=40.0456, vae=1.0903, dsb=38.9553, bio=0.0000
    Epoch  7/10: total=39.7713, vae=1.0906, dsb=38.6807, bio=0.0000
    Epoch  8/10: total=39.3647, vae=1.0910, dsb=38.2737, bio=0.0000
    Epoch  9/10: total=39.2153, vae=1.0908, dsb=38.1245, bio=0.0000
    Epoch 10/10: total=38.9460, vae=1.0903, dsb=37.8557, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=2.0406, vae=1.0910, dsb=0.9496, bio=0.0000
    Epoch  2/10: total=1.9460, vae=1.0905, dsb=0.8556, bio=0.0000
    Epoch  3/10: total=1.9236, vae=1.0904, dsb=0.8332, bio=0.0000
    Epoch  4/10: total=1.8750, vae=1.0911, dsb=0.7839, bio=0.0000
    Epoch  5/10: total=1.8818, vae=1.0908, dsb=0.7910, bio=0.0000
    Epoch  6/10: total=1.8601, vae=1.0898, dsb=0.7703, bio=0.0000
    Epoch  7/10: total=1.8532, vae=1.0902, dsb=0.7629, bio=0.0000
    Epoch  8/10: total=1.8624, vae=1.0901, dsb=0.7723, bio=0.0000
    Epoch  9/10: total=1.8286, vae=1.0900, dsb=0.7386, bio=0.0000
    Epoch 10/10: total=1.8264, vae=1.0896, dsb=0.7368, bio=0.0000

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=37.2563, vae=1.0906, dsb=36.1657, bio=0.0000
    Epoch  2/10: total=34.7265, vae=1.0905, dsb=33.6360, bio=0.0000
    Epoch  3/10: total=33.8454, vae=1.0904, dsb=32.7550, bio=0.0000
    Epoch  4/10: total=33.4394, vae=1.0911, dsb=32.3484, bio=0.0000
    Epoch  5/10: total=33.3873, vae=1.0915, dsb=32.2958, bio=0.0000
    Epoch  6/10: total=33.0014, vae=1.0904, dsb=31.9110, bio=0.0000
    Epoch  7/10: total=32.9416, vae=1.0900, dsb=31.8517, bio=0.0000
    Epoch  8/10: total=33.0253, vae=1.0904, dsb=31.9349, bio=0.0000
    Epoch  9/10: total=32.9392, vae=1.0902, dsb=31.8490, bio=0.0000
    Epoch 10/10: total=32.8858, vae=1.0906, dsb=31.7952, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.7849, vae=1.0904, dsb=0.6944, bio=0.0000
    Epoch  2/10: total=1.7180, vae=1.0903, dsb=0.6277, bio=0.0000
    Epoch  3/10: total=1.7015, vae=1.0902, dsb=0.6113, bio=0.0000
    Epoch  4/10: total=1.6708, vae=1.0909, dsb=0.5799, bio=0.0000
    Epoch  5/10: total=1.6719, vae=1.0901, dsb=0.5819, bio=0.0000
    Epoch  6/10: total=1.6645, vae=1.0912, dsb=0.5734, bio=0.0000
    Epoch  7/10: total=1.6558, vae=1.0905, dsb=0.5653, bio=0.0000
    Epoch  8/10: total=1.6670, vae=1.0908, dsb=0.5762, bio=0.0000
    Epoch  9/10: total=1.6567, vae=1.0901, dsb=0.5666, bio=0.0000
    Epoch 10/10: total=1.6632, vae=1.0910, dsb=0.5722, bio=0.0000

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=30.6159, vae=1.0911, dsb=29.5248, bio=0.0000
    Epoch  2/10: total=29.6909, vae=1.0902, dsb=28.6007, bio=0.0000
    Epoch  3/10: total=29.4395, vae=1.0912, dsb=28.3483, bio=0.0000
    Epoch  4/10: total=29.1818, vae=1.0901, dsb=28.0917, bio=0.0000
    Epoch  5/10: total=29.0495, vae=1.0916, dsb=27.9579, bio=0.0000
    Epoch  6/10: total=29.0353, vae=1.0899, dsb=27.9454, bio=0.0000
    Epoch  7/10: total=28.8725, vae=1.0891, dsb=27.7835, bio=0.0000
    Epoch  8/10: total=29.0833, vae=1.0910, dsb=27.9922, bio=0.0000
    Epoch  9/10: total=28.8939, vae=1.0902, dsb=27.8037, bio=0.0000
    Epoch 10/10: total=28.9351, vae=1.0902, dsb=27.8449, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.5857, vae=1.0909, dsb=0.4948, bio=0.0000
    Epoch  2/10: total=1.5802, vae=1.0900, dsb=0.4902, bio=0.0000
    Epoch  3/10: total=1.5640, vae=1.0910, dsb=0.4730, bio=0.0000
    Epoch  4/10: total=1.5606, vae=1.0900, dsb=0.4706, bio=0.0000
    Epoch  5/10: total=1.5511, vae=1.0906, dsb=0.4605, bio=0.0000
    Epoch  6/10: total=1.5511, vae=1.0900, dsb=0.4610, bio=0.0000
    Epoch  7/10: total=1.5507, vae=1.0910, dsb=0.4597, bio=0.0000
    Epoch  8/10: total=1.5544, vae=1.0905, dsb=0.4639, bio=0.0000
    Epoch  9/10: total=1.5551, vae=1.0912, dsb=0.4638, bio=0.0000
    Epoch 10/10: total=1.5405, vae=1.0914, dsb=0.4491, bio=0.0000

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=26.9488, vae=1.0905, dsb=25.8583, bio=0.0000
    Epoch  2/10: total=26.7500, vae=1.0892, dsb=25.6608, bio=0.0000
    Epoch  3/10: total=26.5614, vae=1.0906, dsb=25.4708, bio=0.0000
    Epoch  4/10: total=26.6089, vae=1.0908, dsb=25.5182, bio=0.0000
    Epoch  5/10: total=26.5123, vae=1.0904, dsb=25.4218, bio=0.0000
    Epoch  6/10: total=26.4417, vae=1.0903, dsb=25.3515, bio=0.0000
    Epoch  7/10: total=26.4107, vae=1.0900, dsb=25.3208, bio=0.0000
    Epoch  8/10: total=26.3994, vae=1.0901, dsb=25.3093, bio=0.0000
    Epoch  9/10: total=26.4661, vae=1.0902, dsb=25.3759, bio=0.0000
    Epoch 10/10: total=26.4788, vae=1.0898, dsb=25.3890, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.5032, vae=1.0901, dsb=0.4131, bio=0.0000
    Epoch  2/10: total=1.4894, vae=1.0907, dsb=0.3987, bio=0.0000
    Epoch  3/10: total=1.4897, vae=1.0906, dsb=0.3991, bio=0.0000
    Epoch  4/10: total=1.4778, vae=1.0907, dsb=0.3872, bio=0.0000
    Epoch  5/10: total=1.4830, vae=1.0900, dsb=0.3930, bio=0.0000
    Epoch  6/10: total=1.4899, vae=1.0905, dsb=0.3994, bio=0.0000
    Epoch  7/10: total=1.4909, vae=1.0899, dsb=0.4010, bio=0.0000
    Epoch  8/10: total=1.4840, vae=1.0914, dsb=0.3926, bio=0.0000
    Epoch  9/10: total=1.4790, vae=1.0899, dsb=0.3891, bio=0.0000
    Epoch 10/10: total=1.4860, vae=1.0899, dsb=0.3960, bio=0.0000

[Seed 63] Joint training (ablation) complete; models and history saved.

[Seed 63] Drift genes saved in /home/yyuan/ICB_TCE/iter_results/run_063

[Seed 63] run finished.

================================================================================
[Seed 64] Starting running whole pipeline...
================================================================================

[Seed 64] Starting VAE pre-training...

    Epoch [01/20], Beta: 0.000, Average Loss: 529.7690
    Epoch [02/20], Beta: 0.000, Average Loss: 316.6213
    Epoch [03/20], Beta: 0.000, Average Loss: 273.4319
    Epoch [04/20], Beta: 0.000, Average Loss: 251.3971
    Epoch [05/20], Beta: 0.100, Average Loss: 246.3571
    Epoch [06/20], Beta: 0.200, Average Loss: 244.9580
    Epoch [07/20], Beta: 0.300, Average Loss: 245.0805
    Epoch [08/20], Beta: 0.400, Average Loss: 245.8633
    Epoch [09/20], Beta: 0.500, Average Loss: 246.8539
    Epoch [10/20], Beta: 0.600, Average Loss: 248.0502
    Epoch [11/20], Beta: 0.700, Average Loss: 249.2920
    Epoch [12/20], Beta: 0.800, Average Loss: 250.5450
    Epoch [13/20], Beta: 0.900, Average Loss: 251.8556
    Epoch [14/20], Beta: 1.000, Average Loss: 253.4510
    Epoch [15/20], Beta: 1.000, Average Loss: 253.0098
    Epoch [16/20], Beta: 1.000, Average Loss: 252.6461
    Epoch [17/20], Beta: 1.000, Average Loss: 252.2761
    Epoch [18/20], Beta: 1.000, Average Loss: 251.9658
    Epoch [19/20], Beta: 1.000, Average Loss: 251.5369
    Epoch [20/20], Beta: 1.000, Average Loss: 251.4052

[Seed 64] VAE pre-training complete.

[Seed 64] Starting joint training (original)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=380.1290, vae=3.6051, dsb=364.0362, bio=24.9753
    Epoch  2/10: total=102.1793, vae=1.1085, dsb=101.0370, bio=0.0677
    Epoch  3/10: total=91.6129, vae=1.1031, dsb=90.4949, bio=0.0300
    Epoch  4/10: total=86.4377, vae=1.1017, dsb=85.3273, bio=0.0173
    Epoch  5/10: total=83.7127, vae=1.1009, dsb=82.6061, bio=0.0114
    Epoch  6/10: total=81.1980, vae=1.0998, dsb=80.0939, bio=0.0085
    Epoch  7/10: total=79.7615, vae=1.1001, dsb=78.6582, bio=0.0065
    Epoch  8/10: total=78.6688, vae=1.0992, dsb=77.5670, bio=0.0053
    Epoch  9/10: total=77.9430, vae=1.0992, dsb=76.8415, bio=0.0047
    Epoch 10/10: total=77.0383, vae=1.0987, dsb=75.9375, bio=0.0039

  [Backward Policy Training]
    Epoch  1/10: total=3.3752, vae=1.1000, dsb=2.2689, bio=0.0127
    Epoch  2/10: total=2.8206, vae=1.0979, dsb=1.7206, bio=0.0044
    Epoch  3/10: total=2.6510, vae=1.0976, dsb=1.5518, bio=0.0032
    Epoch  4/10: total=2.6463, vae=1.0977, dsb=1.5473, bio=0.0027
    Epoch  5/10: total=2.5614, vae=1.0963, dsb=1.4639, bio=0.0024
    Epoch  6/10: total=2.5391, vae=1.0968, dsb=1.4412, bio=0.0023
    Epoch  7/10: total=2.4691, vae=1.0964, dsb=1.3716, bio=0.0022
    Epoch  8/10: total=2.5169, vae=1.0969, dsb=1.4191, bio=0.0019
    Epoch  9/10: total=2.4639, vae=1.0964, dsb=1.3665, bio=0.0021
    Epoch 10/10: total=2.4957, vae=1.0967, dsb=1.3980, bio=0.0020

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=68.0362, vae=1.0997, dsb=66.9348, bio=0.0034
    Epoch  2/10: total=61.3137, vae=1.0974, dsb=60.2153, bio=0.0020
    Epoch  3/10: total=59.1106, vae=1.0979, dsb=58.0118, bio=0.0019
    Epoch  4/10: total=58.8009, vae=1.0976, dsb=57.7024, bio=0.0019
    Epoch  5/10: total=58.0943, vae=1.0968, dsb=56.9965, bio=0.0020
    Epoch  6/10: total=57.7321, vae=1.0970, dsb=56.6342, bio=0.0019
    Epoch  7/10: total=57.3755, vae=1.0973, dsb=56.2773, bio=0.0018
    Epoch  8/10: total=57.3710, vae=1.0967, dsb=56.2734, bio=0.0018
    Epoch  9/10: total=56.9489, vae=1.0972, dsb=55.8508, bio=0.0018
    Epoch 10/10: total=56.7944, vae=1.0968, dsb=55.6967, bio=0.0018

  [Backward Policy Training]
    Epoch  1/10: total=2.2060, vae=1.0967, dsb=1.1065, bio=0.0054
    Epoch  2/10: total=2.1025, vae=1.0964, dsb=1.0051, bio=0.0019
    Epoch  3/10: total=2.0348, vae=1.0961, dsb=0.9378, bio=0.0018
    Epoch  4/10: total=2.0432, vae=1.0957, dsb=0.9467, bio=0.0017
    Epoch  5/10: total=1.9974, vae=1.0952, dsb=0.9013, bio=0.0017
    Epoch  6/10: total=1.9803, vae=1.0954, dsb=0.8842, bio=0.0016
    Epoch  7/10: total=1.9946, vae=1.0956, dsb=0.8982, bio=0.0016
    Epoch  8/10: total=1.9539, vae=1.0950, dsb=0.8581, bio=0.0015
    Epoch  9/10: total=1.9727, vae=1.0948, dsb=0.8771, bio=0.0015
    Epoch 10/10: total=1.9521, vae=1.0951, dsb=0.8563, bio=0.0015

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=52.6277, vae=1.0982, dsb=51.5281, bio=0.0029
    Epoch  2/10: total=50.3652, vae=1.0963, dsb=49.2681, bio=0.0016
    Epoch  3/10: total=49.5360, vae=1.0968, dsb=48.4384, bio=0.0015
    Epoch  4/10: total=48.7938, vae=1.0953, dsb=47.6976, bio=0.0015
    Epoch  5/10: total=48.6276, vae=1.0961, dsb=47.5308, bio=0.0016
    Epoch  6/10: total=48.6208, vae=1.0960, dsb=47.5240, bio=0.0016
    Epoch  7/10: total=48.2801, vae=1.0965, dsb=47.1829, bio=0.0015
    Epoch  8/10: total=48.5616, vae=1.0955, dsb=47.4654, bio=0.0015
    Epoch  9/10: total=48.3166, vae=1.0954, dsb=47.2204, bio=0.0015
    Epoch 10/10: total=48.0371, vae=1.0961, dsb=46.9402, bio=0.0017

  [Backward Policy Training]
    Epoch  1/10: total=1.8271, vae=1.0965, dsb=0.7193, bio=0.0225
    Epoch  2/10: total=1.7694, vae=1.0958, dsb=0.6729, bio=0.0015
    Epoch  3/10: total=1.7484, vae=1.0954, dsb=0.6524, bio=0.0014
    Epoch  4/10: total=1.7487, vae=1.0945, dsb=0.6535, bio=0.0014
    Epoch  5/10: total=1.7525, vae=1.0948, dsb=0.6570, bio=0.0013
    Epoch  6/10: total=1.7134, vae=1.0955, dsb=0.6173, bio=0.0012
    Epoch  7/10: total=1.7269, vae=1.0951, dsb=0.6312, bio=0.0012
    Epoch  8/10: total=1.7241, vae=1.0940, dsb=0.6295, bio=0.0012
    Epoch  9/10: total=1.7214, vae=1.0952, dsb=0.6256, bio=0.0012
    Epoch 10/10: total=1.7060, vae=1.0945, dsb=0.6110, bio=0.0011

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=42.5227, vae=1.0971, dsb=41.4243, bio=0.0026
    Epoch  2/10: total=41.3300, vae=1.0971, dsb=40.2322, bio=0.0012
    Epoch  3/10: total=41.1841, vae=1.0951, dsb=40.0883, bio=0.0013
    Epoch  4/10: total=40.9127, vae=1.0954, dsb=39.8166, bio=0.0012
    Epoch  5/10: total=40.9379, vae=1.0959, dsb=39.8414, bio=0.0012
    Epoch  6/10: total=40.9391, vae=1.0944, dsb=39.8441, bio=0.0011
    Epoch  7/10: total=40.6700, vae=1.0953, dsb=39.5743, bio=0.0010
    Epoch  8/10: total=40.9310, vae=1.0948, dsb=39.8356, bio=0.0012
    Epoch  9/10: total=40.7780, vae=1.0952, dsb=39.6823, bio=0.0012
    Epoch 10/10: total=40.7965, vae=1.0954, dsb=39.7005, bio=0.0011

  [Backward Policy Training]
    Epoch  1/10: total=1.6911, vae=1.0952, dsb=0.5486, bio=0.0946
    Epoch  2/10: total=1.6098, vae=1.0949, dsb=0.5143, bio=0.0013
    Epoch  3/10: total=1.6035, vae=1.0951, dsb=0.5079, bio=0.0009
    Epoch  4/10: total=1.6144, vae=1.0953, dsb=0.5185, bio=0.0010
    Epoch  5/10: total=1.6160, vae=1.0944, dsb=0.5210, bio=0.0010
    Epoch  6/10: total=1.6057, vae=1.0945, dsb=0.5107, bio=0.0011
    Epoch  7/10: total=1.5931, vae=1.0943, dsb=0.4983, bio=0.0010
    Epoch  8/10: total=1.6087, vae=1.0944, dsb=0.5138, bio=0.0010
    Epoch  9/10: total=1.5970, vae=1.0946, dsb=0.5020, bio=0.0008
    Epoch 10/10: total=1.6041, vae=1.0944, dsb=0.5092, bio=0.0011

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=36.6161, vae=1.0962, dsb=35.5187, bio=0.0022
    Epoch  2/10: total=36.0503, vae=1.0964, dsb=34.9536, bio=0.0005
    Epoch  3/10: total=36.1518, vae=1.0945, dsb=35.0569, bio=0.0006
    Epoch  4/10: total=35.9984, vae=1.0955, dsb=34.9024, bio=0.0010
    Epoch  5/10: total=36.0635, vae=1.0948, dsb=34.9681, bio=0.0012
    Epoch  6/10: total=35.9585, vae=1.0954, dsb=34.8626, bio=0.0011
    Epoch  7/10: total=35.8729, vae=1.0946, dsb=34.7777, bio=0.0010
    Epoch  8/10: total=36.0187, vae=1.0946, dsb=34.9238, bio=0.0005
    Epoch  9/10: total=35.9535, vae=1.0943, dsb=34.8590, bio=0.0005
    Epoch 10/10: total=36.0572, vae=1.0944, dsb=34.9624, bio=0.0008

  [Backward Policy Training]
    Epoch  1/10: total=1.6058, vae=1.0961, dsb=0.4342, bio=0.1508
    Epoch  2/10: total=1.5069, vae=1.0943, dsb=0.4119, bio=0.0013
    Epoch  3/10: total=1.5268, vae=1.0941, dsb=0.4325, bio=0.0005
    Epoch  4/10: total=1.5135, vae=1.0942, dsb=0.4188, bio=0.0010
    Epoch  5/10: total=1.5067, vae=1.0949, dsb=0.4113, bio=0.0011
    Epoch  6/10: total=1.5116, vae=1.0938, dsb=0.4175, bio=0.0006
    Epoch  7/10: total=1.5179, vae=1.0934, dsb=0.4240, bio=0.0011
    Epoch  8/10: total=1.5248, vae=1.0934, dsb=0.4309, bio=0.0010
    Epoch  9/10: total=1.5108, vae=1.0942, dsb=0.4161, bio=0.0010
    Epoch 10/10: total=1.5201, vae=1.0940, dsb=0.4258, bio=0.0004

[Seed 64] Joint training (original) complete; models and history saved.

[Seed 64] Starting joint training (ablation)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=365.5934, vae=2.0070, dsb=363.5863, bio=0.0000
    Epoch  2/10: total=101.5752, vae=1.0911, dsb=100.4840, bio=0.0000
    Epoch  3/10: total=91.0957, vae=1.0885, dsb=90.0072, bio=0.0000
    Epoch  4/10: total=86.0225, vae=1.0881, dsb=84.9343, bio=0.0000
    Epoch  5/10: total=83.3382, vae=1.0879, dsb=82.2503, bio=0.0000
    Epoch  6/10: total=80.8531, vae=1.0871, dsb=79.7659, bio=0.0000
    Epoch  7/10: total=79.4874, vae=1.0878, dsb=78.3996, bio=0.0000
    Epoch  8/10: total=78.3781, vae=1.0871, dsb=77.2911, bio=0.0000
    Epoch  9/10: total=77.6649, vae=1.0874, dsb=76.5776, bio=0.0000
    Epoch 10/10: total=76.7681, vae=1.0873, dsb=75.6808, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=3.2964, vae=1.0868, dsb=2.2095, bio=0.0000
    Epoch  2/10: total=2.7593, vae=1.0870, dsb=1.6723, bio=0.0000
    Epoch  3/10: total=2.5953, vae=1.0872, dsb=1.5081, bio=0.0000
    Epoch  4/10: total=2.5895, vae=1.0876, dsb=1.5019, bio=0.0000
    Epoch  5/10: total=2.5040, vae=1.0864, dsb=1.4176, bio=0.0000
    Epoch  6/10: total=2.4801, vae=1.0871, dsb=1.3930, bio=0.0000
    Epoch  7/10: total=2.4106, vae=1.0867, dsb=1.3239, bio=0.0000
    Epoch  8/10: total=2.4583, vae=1.0873, dsb=1.3709, bio=0.0000
    Epoch  9/10: total=2.4056, vae=1.0870, dsb=1.3186, bio=0.0000
    Epoch 10/10: total=2.4382, vae=1.0873, dsb=1.3508, bio=0.0000

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=65.2993, vae=1.0876, dsb=64.2116, bio=0.0000
    Epoch  2/10: total=59.0796, vae=1.0866, dsb=57.9930, bio=0.0000
    Epoch  3/10: total=57.0086, vae=1.0873, dsb=55.9213, bio=0.0000
    Epoch  4/10: total=56.6519, vae=1.0871, dsb=55.5647, bio=0.0000
    Epoch  5/10: total=55.9861, vae=1.0864, dsb=54.8997, bio=0.0000
    Epoch  6/10: total=55.6189, vae=1.0868, dsb=54.5321, bio=0.0000
    Epoch  7/10: total=55.3046, vae=1.0872, dsb=54.2174, bio=0.0000
    Epoch  8/10: total=55.2804, vae=1.0866, dsb=54.1937, bio=0.0000
    Epoch  9/10: total=54.8327, vae=1.0872, dsb=53.7455, bio=0.0000
    Epoch 10/10: total=54.7261, vae=1.0869, dsb=53.6392, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=2.1367, vae=1.0864, dsb=1.0504, bio=0.0000
    Epoch  2/10: total=2.0414, vae=1.0874, dsb=0.9539, bio=0.0000
    Epoch  3/10: total=1.9764, vae=1.0873, dsb=0.8891, bio=0.0000
    Epoch  4/10: total=1.9840, vae=1.0869, dsb=0.8970, bio=0.0000
    Epoch  5/10: total=1.9395, vae=1.0865, dsb=0.8530, bio=0.0000
    Epoch  6/10: total=1.9224, vae=1.0868, dsb=0.8356, bio=0.0000
    Epoch  7/10: total=1.9360, vae=1.0870, dsb=0.8490, bio=0.0000
    Epoch  8/10: total=1.8969, vae=1.0865, dsb=0.8103, bio=0.0000
    Epoch  9/10: total=1.9141, vae=1.0864, dsb=0.8277, bio=0.0000
    Epoch 10/10: total=1.8948, vae=1.0866, dsb=0.8082, bio=0.0000

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=49.5544, vae=1.0871, dsb=48.4673, bio=0.0000
    Epoch  2/10: total=47.3691, vae=1.0865, dsb=46.2826, bio=0.0000
    Epoch  3/10: total=46.6203, vae=1.0872, dsb=45.5330, bio=0.0000
    Epoch  4/10: total=45.9526, vae=1.0860, dsb=44.8666, bio=0.0000
    Epoch  5/10: total=45.7841, vae=1.0867, dsb=44.6974, bio=0.0000
    Epoch  6/10: total=45.7779, vae=1.0867, dsb=44.6912, bio=0.0000
    Epoch  7/10: total=45.4494, vae=1.0874, dsb=44.3621, bio=0.0000
    Epoch  8/10: total=45.7138, vae=1.0864, dsb=44.6274, bio=0.0000
    Epoch  9/10: total=45.4541, vae=1.0864, dsb=44.3677, bio=0.0000
    Epoch 10/10: total=45.2270, vae=1.0871, dsb=44.1398, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.7682, vae=1.0873, dsb=0.6810, bio=0.0000
    Epoch  2/10: total=1.7252, vae=1.0874, dsb=0.6378, bio=0.0000
    Epoch  3/10: total=1.7057, vae=1.0871, dsb=0.6186, bio=0.0000
    Epoch  4/10: total=1.7063, vae=1.0862, dsb=0.6201, bio=0.0000
    Epoch  5/10: total=1.7110, vae=1.0867, dsb=0.6242, bio=0.0000
    Epoch  6/10: total=1.6733, vae=1.0873, dsb=0.5860, bio=0.0000
    Epoch  7/10: total=1.6865, vae=1.0871, dsb=0.5995, bio=0.0000
    Epoch  8/10: total=1.6831, vae=1.0860, dsb=0.5972, bio=0.0000
    Epoch  9/10: total=1.6805, vae=1.0872, dsb=0.5934, bio=0.0000
    Epoch 10/10: total=1.6658, vae=1.0864, dsb=0.5794, bio=0.0000

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=40.3829, vae=1.0866, dsb=39.2963, bio=0.0000
    Epoch  2/10: total=39.2395, vae=1.0880, dsb=38.1515, bio=0.0000
    Epoch  3/10: total=39.0795, vae=1.0862, dsb=37.9933, bio=0.0000
    Epoch  4/10: total=38.8131, vae=1.0867, dsb=37.7264, bio=0.0000
    Epoch  5/10: total=38.8745, vae=1.0873, dsb=37.7872, bio=0.0000
    Epoch  6/10: total=38.8424, vae=1.0859, dsb=37.7566, bio=0.0000
    Epoch  7/10: total=38.5845, vae=1.0869, dsb=37.4976, bio=0.0000
    Epoch  8/10: total=38.8292, vae=1.0866, dsb=37.7426, bio=0.0000
    Epoch  9/10: total=38.6699, vae=1.0870, dsb=37.5828, bio=0.0000
    Epoch 10/10: total=38.7162, vae=1.0873, dsb=37.6289, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.5996, vae=1.0860, dsb=0.5136, bio=0.0000
    Epoch  2/10: total=1.5687, vae=1.0869, dsb=0.4818, bio=0.0000
    Epoch  3/10: total=1.5637, vae=1.0871, dsb=0.4766, bio=0.0000
    Epoch  4/10: total=1.5745, vae=1.0875, dsb=0.4870, bio=0.0000
    Epoch  5/10: total=1.5764, vae=1.0867, dsb=0.4897, bio=0.0000
    Epoch  6/10: total=1.5668, vae=1.0868, dsb=0.4800, bio=0.0000
    Epoch  7/10: total=1.5552, vae=1.0866, dsb=0.4687, bio=0.0000
    Epoch  8/10: total=1.5708, vae=1.0867, dsb=0.4840, bio=0.0000
    Epoch  9/10: total=1.5600, vae=1.0869, dsb=0.4730, bio=0.0000
    Epoch 10/10: total=1.5668, vae=1.0868, dsb=0.4799, bio=0.0000

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=34.8966, vae=1.0859, dsb=33.8107, bio=0.0000
    Epoch  2/10: total=34.3690, vae=1.0876, dsb=33.2814, bio=0.0000
    Epoch  3/10: total=34.4722, vae=1.0862, dsb=33.3860, bio=0.0000
    Epoch  4/10: total=34.3376, vae=1.0874, dsb=33.2502, bio=0.0000
    Epoch  5/10: total=34.3750, vae=1.0869, dsb=33.2882, bio=0.0000
    Epoch  6/10: total=34.2992, vae=1.0874, dsb=33.2118, bio=0.0000
    Epoch  7/10: total=34.2279, vae=1.0867, dsb=33.1412, bio=0.0000
    Epoch  8/10: total=34.3472, vae=1.0868, dsb=33.2604, bio=0.0000
    Epoch  9/10: total=34.2888, vae=1.0866, dsb=33.2022, bio=0.0000
    Epoch 10/10: total=34.3784, vae=1.0868, dsb=33.2916, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.4924, vae=1.0871, dsb=0.4053, bio=0.0000
    Epoch  2/10: total=1.4713, vae=1.0866, dsb=0.3847, bio=0.0000
    Epoch  3/10: total=1.4911, vae=1.0864, dsb=0.4047, bio=0.0000
    Epoch  4/10: total=1.4784, vae=1.0867, dsb=0.3917, bio=0.0000
    Epoch  5/10: total=1.4720, vae=1.0875, dsb=0.3845, bio=0.0000
    Epoch  6/10: total=1.4769, vae=1.0863, dsb=0.3906, bio=0.0000
    Epoch  7/10: total=1.4829, vae=1.0861, dsb=0.3968, bio=0.0000
    Epoch  8/10: total=1.4897, vae=1.0861, dsb=0.4036, bio=0.0000
    Epoch  9/10: total=1.4764, vae=1.0869, dsb=0.3895, bio=0.0000
    Epoch 10/10: total=1.4852, vae=1.0868, dsb=0.3984, bio=0.0000

[Seed 64] Joint training (ablation) complete; models and history saved.

[Seed 64] Drift genes saved in /home/yyuan/ICB_TCE/iter_results/run_064

[Seed 64] run finished.

================================================================================
[Seed 65] Starting running whole pipeline...
================================================================================

[Seed 65] Starting VAE pre-training...

    Epoch [01/20], Beta: 0.000, Average Loss: 533.5101
    Epoch [02/20], Beta: 0.000, Average Loss: 310.0389
    Epoch [03/20], Beta: 0.000, Average Loss: 271.7550
    Epoch [04/20], Beta: 0.000, Average Loss: 251.4009
    Epoch [05/20], Beta: 0.100, Average Loss: 246.6401
    Epoch [06/20], Beta: 0.200, Average Loss: 245.8815
    Epoch [07/20], Beta: 0.300, Average Loss: 245.8660
    Epoch [08/20], Beta: 0.400, Average Loss: 246.4366
    Epoch [09/20], Beta: 0.500, Average Loss: 247.2712
    Epoch [10/20], Beta: 0.600, Average Loss: 248.2823
    Epoch [11/20], Beta: 0.700, Average Loss: 249.4505
    Epoch [12/20], Beta: 0.800, Average Loss: 250.6385
    Epoch [13/20], Beta: 0.900, Average Loss: 251.8969
    Epoch [14/20], Beta: 1.000, Average Loss: 253.5219
    Epoch [15/20], Beta: 1.000, Average Loss: 253.0615
    Epoch [16/20], Beta: 1.000, Average Loss: 252.6750
    Epoch [17/20], Beta: 1.000, Average Loss: 252.3134
    Epoch [18/20], Beta: 1.000, Average Loss: 252.0135
    Epoch [19/20], Beta: 1.000, Average Loss: 251.6100
    Epoch [20/20], Beta: 1.000, Average Loss: 251.4832

[Seed 65] VAE pre-training complete.

[Seed 65] Starting joint training (original)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=254.7469, vae=3.5315, dsb=237.9669, bio=26.4970
    Epoch  2/10: total=81.8550, vae=1.1068, dsb=80.7136, bio=0.0692
    Epoch  3/10: total=72.0589, vae=1.1022, dsb=70.9413, bio=0.0309
    Epoch  4/10: total=67.1198, vae=1.0992, dsb=66.0113, bio=0.0186
    Epoch  5/10: total=64.2002, vae=1.0985, dsb=63.0955, bio=0.0125
    Epoch  6/10: total=62.2061, vae=1.0980, dsb=61.1035, bio=0.0093
    Epoch  7/10: total=60.7721, vae=1.0972, dsb=59.6713, bio=0.0072
    Epoch  8/10: total=59.7015, vae=1.0982, dsb=58.6004, bio=0.0059
    Epoch  9/10: total=58.7549, vae=1.0965, dsb=57.6558, bio=0.0051
    Epoch 10/10: total=58.1730, vae=1.0970, dsb=57.0737, bio=0.0046

  [Backward Policy Training]
    Epoch  1/10: total=3.2373, vae=1.0971, dsb=2.1325, bio=0.0155
    Epoch  2/10: total=2.7489, vae=1.0957, dsb=1.6507, bio=0.0051
    Epoch  3/10: total=2.7058, vae=1.0950, dsb=1.6090, bio=0.0037
    Epoch  4/10: total=2.5993, vae=1.0945, dsb=1.5034, bio=0.0030
    Epoch  5/10: total=2.5580, vae=1.0945, dsb=1.4622, bio=0.0027
    Epoch  6/10: total=2.5135, vae=1.0951, dsb=1.4172, bio=0.0025
    Epoch  7/10: total=2.5159, vae=1.0940, dsb=1.4208, bio=0.0023
    Epoch  8/10: total=2.4550, vae=1.0942, dsb=1.3597, bio=0.0022
    Epoch  9/10: total=2.4671, vae=1.0934, dsb=1.3726, bio=0.0021
    Epoch 10/10: total=2.4645, vae=1.0937, dsb=1.3698, bio=0.0021

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=53.1218, vae=1.0961, dsb=52.0238, bio=0.0038
    Epoch  2/10: total=47.1287, vae=1.0956, dsb=46.0320, bio=0.0022
    Epoch  3/10: total=45.7846, vae=1.0956, dsb=44.6880, bio=0.0021
    Epoch  4/10: total=45.0534, vae=1.0954, dsb=43.9569, bio=0.0021
    Epoch  5/10: total=44.3762, vae=1.0948, dsb=43.2803, bio=0.0021
    Epoch  6/10: total=44.1847, vae=1.0949, dsb=43.0889, bio=0.0020
    Epoch  7/10: total=43.6031, vae=1.0952, dsb=42.5069, bio=0.0020
    Epoch  8/10: total=43.4776, vae=1.0945, dsb=42.3821, bio=0.0020
    Epoch  9/10: total=43.1797, vae=1.0948, dsb=42.0839, bio=0.0020
    Epoch 10/10: total=43.1744, vae=1.0941, dsb=42.0793, bio=0.0020

  [Backward Policy Training]
    Epoch  1/10: total=2.1931, vae=1.0945, dsb=1.0959, bio=0.0053
    Epoch  2/10: total=2.0829, vae=1.0935, dsb=0.9882, bio=0.0022
    Epoch  3/10: total=2.0257, vae=1.0940, dsb=0.9308, bio=0.0019
    Epoch  4/10: total=2.0494, vae=1.0934, dsb=0.9550, bio=0.0018
    Epoch  5/10: total=2.0118, vae=1.0938, dsb=0.9172, bio=0.0017
    Epoch  6/10: total=1.9993, vae=1.0937, dsb=0.9047, bio=0.0017
    Epoch  7/10: total=1.9951, vae=1.0930, dsb=0.9012, bio=0.0017
    Epoch  8/10: total=1.9727, vae=1.0932, dsb=0.8786, bio=0.0017
    Epoch  9/10: total=1.9764, vae=1.0930, dsb=0.8826, bio=0.0017
    Epoch 10/10: total=1.9485, vae=1.0931, dsb=0.8544, bio=0.0019

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=38.9005, vae=1.0945, dsb=37.8044, bio=0.0032
    Epoch  2/10: total=36.5280, vae=1.0945, dsb=35.4326, bio=0.0019
    Epoch  3/10: total=36.1474, vae=1.0940, dsb=35.0525, bio=0.0018
    Epoch  4/10: total=35.8608, vae=1.0931, dsb=34.7669, bio=0.0018
    Epoch  5/10: total=35.5913, vae=1.0931, dsb=34.4973, bio=0.0018
    Epoch  6/10: total=35.4362, vae=1.0930, dsb=34.3423, bio=0.0018
    Epoch  7/10: total=35.3191, vae=1.0936, dsb=34.2246, bio=0.0018
    Epoch  8/10: total=35.1509, vae=1.0942, dsb=34.0559, bio=0.0018
    Epoch  9/10: total=34.9772, vae=1.0946, dsb=33.8817, bio=0.0018
    Epoch 10/10: total=34.9889, vae=1.0945, dsb=33.8934, bio=0.0019

  [Backward Policy Training]
    Epoch  1/10: total=1.8638, vae=1.0939, dsb=0.7665, bio=0.0067
    Epoch  2/10: total=1.8123, vae=1.0927, dsb=0.7187, bio=0.0017
    Epoch  3/10: total=1.7884, vae=1.0936, dsb=0.6939, bio=0.0016
    Epoch  4/10: total=1.7714, vae=1.0929, dsb=0.6777, bio=0.0016
    Epoch  5/10: total=1.7812, vae=1.0934, dsb=0.6870, bio=0.0015
    Epoch  6/10: total=1.7723, vae=1.0921, dsb=0.6793, bio=0.0017
    Epoch  7/10: total=1.7808, vae=1.0929, dsb=0.6871, bio=0.0015
    Epoch  8/10: total=1.7638, vae=1.0920, dsb=0.6710, bio=0.0015
    Epoch  9/10: total=1.7584, vae=1.0926, dsb=0.6650, bio=0.0015
    Epoch 10/10: total=1.7540, vae=1.0939, dsb=0.6594, bio=0.0015

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=32.3202, vae=1.0953, dsb=31.2230, bio=0.0037
    Epoch  2/10: total=31.3156, vae=1.0947, dsb=30.2200, bio=0.0016
    Epoch  3/10: total=31.0018, vae=1.0933, dsb=29.9077, bio=0.0016
    Epoch  4/10: total=30.7734, vae=1.0932, dsb=29.6794, bio=0.0017
    Epoch  5/10: total=30.8108, vae=1.0934, dsb=29.7166, bio=0.0016
    Epoch  6/10: total=30.5993, vae=1.0930, dsb=29.5054, bio=0.0017
    Epoch  7/10: total=30.5863, vae=1.0936, dsb=29.4918, bio=0.0018
    Epoch  8/10: total=30.6162, vae=1.0920, dsb=29.5234, bio=0.0018
    Epoch  9/10: total=30.6232, vae=1.0934, dsb=29.5290, bio=0.0016
    Epoch 10/10: total=30.4825, vae=1.0926, dsb=29.3891, bio=0.0016

  [Backward Policy Training]
    Epoch  1/10: total=1.7311, vae=1.0938, dsb=0.6246, bio=0.0254
    Epoch  2/10: total=1.6922, vae=1.0933, dsb=0.5981, bio=0.0016
    Epoch  3/10: total=1.6689, vae=1.0924, dsb=0.5758, bio=0.0015
    Epoch  4/10: total=1.6786, vae=1.0927, dsb=0.5853, bio=0.0013
    Epoch  5/10: total=1.6731, vae=1.0928, dsb=0.5796, bio=0.0014
    Epoch  6/10: total=1.6721, vae=1.0923, dsb=0.5792, bio=0.0014
    Epoch  7/10: total=1.6611, vae=1.0924, dsb=0.5679, bio=0.0016
    Epoch  8/10: total=1.6670, vae=1.0931, dsb=0.5732, bio=0.0013
    Epoch  9/10: total=1.6707, vae=1.0922, dsb=0.5778, bio=0.0013
    Epoch 10/10: total=1.6581, vae=1.0921, dsb=0.5653, bio=0.0014

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=26.5416, vae=1.0946, dsb=25.4456, bio=0.0028
    Epoch  2/10: total=26.1960, vae=1.0943, dsb=25.1009, bio=0.0015
    Epoch  3/10: total=26.0343, vae=1.0928, dsb=24.9406, bio=0.0017
    Epoch  4/10: total=26.1481, vae=1.0936, dsb=25.0538, bio=0.0015
    Epoch  5/10: total=26.1427, vae=1.0932, dsb=25.0487, bio=0.0015
    Epoch  6/10: total=26.0146, vae=1.0932, dsb=24.9207, bio=0.0014
    Epoch  7/10: total=26.0470, vae=1.0925, dsb=24.9537, bio=0.0015
    Epoch  8/10: total=26.0213, vae=1.0933, dsb=24.9271, bio=0.0016
    Epoch  9/10: total=26.0233, vae=1.0943, dsb=24.9282, bio=0.0015
    Epoch 10/10: total=25.9465, vae=1.0921, dsb=24.8536, bio=0.0014

  [Backward Policy Training]
    Epoch  1/10: total=1.6427, vae=1.0934, dsb=0.5139, bio=0.0707
    Epoch  2/10: total=1.6059, vae=1.0923, dsb=0.5129, bio=0.0014
    Epoch  3/10: total=1.5766, vae=1.0923, dsb=0.4837, bio=0.0013
    Epoch  4/10: total=1.5826, vae=1.0927, dsb=0.4893, bio=0.0013
    Epoch  5/10: total=1.5827, vae=1.0916, dsb=0.4905, bio=0.0014
    Epoch  6/10: total=1.5760, vae=1.0918, dsb=0.4836, bio=0.0012
    Epoch  7/10: total=1.5719, vae=1.0921, dsb=0.4793, bio=0.0012
    Epoch  8/10: total=1.5871, vae=1.0917, dsb=0.4948, bio=0.0012
    Epoch  9/10: total=1.5700, vae=1.0921, dsb=0.4773, bio=0.0013
    Epoch 10/10: total=1.5744, vae=1.0917, dsb=0.4821, bio=0.0012

[Seed 65] Joint training (original) complete; models and history saved.

[Seed 65] Starting joint training (ablation)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=239.7237, vae=2.0035, dsb=237.7202, bio=0.0000
    Epoch  2/10: total=81.4451, vae=1.0878, dsb=80.3573, bio=0.0000
    Epoch  3/10: total=71.4920, vae=1.0868, dsb=70.4052, bio=0.0000
    Epoch  4/10: total=66.4133, vae=1.0853, dsb=65.3280, bio=0.0000
    Epoch  5/10: total=63.5838, vae=1.0852, dsb=62.4986, bio=0.0000
    Epoch  6/10: total=61.7137, vae=1.0851, dsb=60.6286, bio=0.0000
    Epoch  7/10: total=60.3361, vae=1.0847, dsb=59.2514, bio=0.0000
    Epoch  8/10: total=59.2393, vae=1.0859, dsb=58.1535, bio=0.0000
    Epoch  9/10: total=58.3066, vae=1.0846, dsb=57.2220, bio=0.0000
    Epoch 10/10: total=57.7688, vae=1.0854, dsb=56.6834, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=3.1315, vae=1.0846, dsb=2.0469, bio=0.0000
    Epoch  2/10: total=2.6724, vae=1.0847, dsb=1.5877, bio=0.0000
    Epoch  3/10: total=2.6346, vae=1.0845, dsb=1.5501, bio=0.0000
    Epoch  4/10: total=2.5308, vae=1.0842, dsb=1.4466, bio=0.0000
    Epoch  5/10: total=2.4911, vae=1.0844, dsb=1.4067, bio=0.0000
    Epoch  6/10: total=2.4481, vae=1.0851, dsb=1.3630, bio=0.0000
    Epoch  7/10: total=2.4517, vae=1.0843, dsb=1.3674, bio=0.0000
    Epoch  8/10: total=2.3928, vae=1.0845, dsb=1.3083, bio=0.0000
    Epoch  9/10: total=2.4046, vae=1.0837, dsb=1.3209, bio=0.0000
    Epoch 10/10: total=2.4027, vae=1.0841, dsb=1.3186, bio=0.0000

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=52.7413, vae=1.0838, dsb=51.6575, bio=0.0000
    Epoch  2/10: total=46.6963, vae=1.0845, dsb=45.6118, bio=0.0000
    Epoch  3/10: total=45.4098, vae=1.0847, dsb=44.3251, bio=0.0000
    Epoch  4/10: total=44.7229, vae=1.0846, dsb=43.6383, bio=0.0000
    Epoch  5/10: total=44.0582, vae=1.0843, dsb=42.9739, bio=0.0000
    Epoch  6/10: total=43.8757, vae=1.0845, dsb=42.7911, bio=0.0000
    Epoch  7/10: total=43.2785, vae=1.0849, dsb=42.1936, bio=0.0000
    Epoch  8/10: total=43.1273, vae=1.0842, dsb=42.0431, bio=0.0000
    Epoch  9/10: total=42.8363, vae=1.0846, dsb=41.7517, bio=0.0000
    Epoch 10/10: total=42.8272, vae=1.0841, dsb=41.7431, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=2.1279, vae=1.0841, dsb=1.0437, bio=0.0000
    Epoch  2/10: total=2.0302, vae=1.0843, dsb=0.9458, bio=0.0000
    Epoch  3/10: total=1.9757, vae=1.0851, dsb=0.8906, bio=0.0000
    Epoch  4/10: total=2.0002, vae=1.0846, dsb=0.9156, bio=0.0000
    Epoch  5/10: total=1.9645, vae=1.0850, dsb=0.8795, bio=0.0000
    Epoch  6/10: total=1.9524, vae=1.0851, dsb=0.8674, bio=0.0000
    Epoch  7/10: total=1.9488, vae=1.0843, dsb=0.8645, bio=0.0000
    Epoch  8/10: total=1.9274, vae=1.0846, dsb=0.8428, bio=0.0000
    Epoch  9/10: total=1.9308, vae=1.0843, dsb=0.8464, bio=0.0000
    Epoch 10/10: total=1.9036, vae=1.0845, dsb=0.8190, bio=0.0000

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=37.6791, vae=1.0832, dsb=36.5959, bio=0.0000
    Epoch  2/10: total=35.2999, vae=1.0844, dsb=34.2154, bio=0.0000
    Epoch  3/10: total=34.9333, vae=1.0841, dsb=33.8491, bio=0.0000
    Epoch  4/10: total=34.6119, vae=1.0834, dsb=33.5284, bio=0.0000
    Epoch  5/10: total=34.3491, vae=1.0835, dsb=33.2656, bio=0.0000
    Epoch  6/10: total=34.2090, vae=1.0835, dsb=33.1255, bio=0.0000
    Epoch  7/10: total=34.0717, vae=1.0841, dsb=32.9876, bio=0.0000
    Epoch  8/10: total=33.9399, vae=1.0847, dsb=32.8551, bio=0.0000
    Epoch  9/10: total=33.7765, vae=1.0852, dsb=32.6913, bio=0.0000
    Epoch 10/10: total=33.7644, vae=1.0852, dsb=32.6792, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.7926, vae=1.0842, dsb=0.7084, bio=0.0000
    Epoch  2/10: total=1.7475, vae=1.0842, dsb=0.6632, bio=0.0000
    Epoch  3/10: total=1.7262, vae=1.0852, dsb=0.6409, bio=0.0000
    Epoch  4/10: total=1.7102, vae=1.0846, dsb=0.6256, bio=0.0000
    Epoch  5/10: total=1.7202, vae=1.0852, dsb=0.6350, bio=0.0000
    Epoch  6/10: total=1.7122, vae=1.0839, dsb=0.6283, bio=0.0000
    Epoch  7/10: total=1.7202, vae=1.0847, dsb=0.6355, bio=0.0000
    Epoch  8/10: total=1.7042, vae=1.0838, dsb=0.6204, bio=0.0000
    Epoch  9/10: total=1.6995, vae=1.0845, dsb=0.6150, bio=0.0000
    Epoch 10/10: total=1.6953, vae=1.0858, dsb=0.6096, bio=0.0000

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=30.4046, vae=1.0840, dsb=29.3206, bio=0.0000
    Epoch  2/10: total=29.4846, vae=1.0852, dsb=28.3995, bio=0.0000
    Epoch  3/10: total=29.2077, vae=1.0840, dsb=28.1237, bio=0.0000
    Epoch  4/10: total=28.9636, vae=1.0841, dsb=27.8795, bio=0.0000
    Epoch  5/10: total=29.0320, vae=1.0844, dsb=27.9476, bio=0.0000
    Epoch  6/10: total=28.8215, vae=1.0840, dsb=27.7375, bio=0.0000
    Epoch  7/10: total=28.8274, vae=1.0846, dsb=27.7427, bio=0.0000
    Epoch  8/10: total=28.8357, vae=1.0832, dsb=27.7526, bio=0.0000
    Epoch  9/10: total=28.8529, vae=1.0847, dsb=27.7682, bio=0.0000
    Epoch 10/10: total=28.7314, vae=1.0839, dsb=27.6475, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.6635, vae=1.0845, dsb=0.5789, bio=0.0000
    Epoch  2/10: total=1.6400, vae=1.0851, dsb=0.5549, bio=0.0000
    Epoch  3/10: total=1.6177, vae=1.0843, dsb=0.5334, bio=0.0000
    Epoch  4/10: total=1.6270, vae=1.0846, dsb=0.5424, bio=0.0000
    Epoch  5/10: total=1.6221, vae=1.0849, dsb=0.5372, bio=0.0000
    Epoch  6/10: total=1.6208, vae=1.0843, dsb=0.5365, bio=0.0000
    Epoch  7/10: total=1.6102, vae=1.0845, dsb=0.5258, bio=0.0000
    Epoch  8/10: total=1.6161, vae=1.0852, dsb=0.5310, bio=0.0000
    Epoch  9/10: total=1.6193, vae=1.0843, dsb=0.5350, bio=0.0000
    Epoch 10/10: total=1.6079, vae=1.0843, dsb=0.5236, bio=0.0000

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=24.8973, vae=1.0841, dsb=23.8131, bio=0.0000
    Epoch  2/10: total=24.6430, vae=1.0851, dsb=23.5580, bio=0.0000
    Epoch  3/10: total=24.4930, vae=1.0838, dsb=23.4092, bio=0.0000
    Epoch  4/10: total=24.6046, vae=1.0849, dsb=23.5198, bio=0.0000
    Epoch  5/10: total=24.6235, vae=1.0846, dsb=23.5389, bio=0.0000
    Epoch  6/10: total=24.4997, vae=1.0847, dsb=23.4150, bio=0.0000
    Epoch  7/10: total=24.5114, vae=1.0841, dsb=23.4273, bio=0.0000
    Epoch  8/10: total=24.4948, vae=1.0849, dsb=23.4099, bio=0.0000
    Epoch  9/10: total=24.5019, vae=1.0860, dsb=23.4159, bio=0.0000
    Epoch 10/10: total=24.4410, vae=1.0839, dsb=23.3571, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.5548, vae=1.0843, dsb=0.4705, bio=0.0000
    Epoch  2/10: total=1.5545, vae=1.0843, dsb=0.4702, bio=0.0000
    Epoch  3/10: total=1.5274, vae=1.0844, dsb=0.4430, bio=0.0000
    Epoch  4/10: total=1.5337, vae=1.0849, dsb=0.4488, bio=0.0000
    Epoch  5/10: total=1.5336, vae=1.0838, dsb=0.4498, bio=0.0000
    Epoch  6/10: total=1.5278, vae=1.0841, dsb=0.4437, bio=0.0000
    Epoch  7/10: total=1.5242, vae=1.0844, dsb=0.4398, bio=0.0000
    Epoch  8/10: total=1.5384, vae=1.0841, dsb=0.4543, bio=0.0000
    Epoch  9/10: total=1.5222, vae=1.0844, dsb=0.4378, bio=0.0000
    Epoch 10/10: total=1.5265, vae=1.0842, dsb=0.4423, bio=0.0000

[Seed 65] Joint training (ablation) complete; models and history saved.

[Seed 65] Drift genes saved in /home/yyuan/ICB_TCE/iter_results/run_065

[Seed 65] run finished.

================================================================================
[Seed 66] Starting running whole pipeline...
================================================================================

[Seed 66] Starting VAE pre-training...

    Epoch [01/20], Beta: 0.000, Average Loss: 534.1279
    Epoch [02/20], Beta: 0.000, Average Loss: 315.4649
    Epoch [03/20], Beta: 0.000, Average Loss: 275.6069
    Epoch [04/20], Beta: 0.000, Average Loss: 252.5587
    Epoch [05/20], Beta: 0.100, Average Loss: 246.4793
    Epoch [06/20], Beta: 0.200, Average Loss: 245.1886
    Epoch [07/20], Beta: 0.300, Average Loss: 245.1051
    Epoch [08/20], Beta: 0.400, Average Loss: 245.8189
    Epoch [09/20], Beta: 0.500, Average Loss: 246.8962
    Epoch [10/20], Beta: 0.600, Average Loss: 248.0913
    Epoch [11/20], Beta: 0.700, Average Loss: 249.3951
    Epoch [12/20], Beta: 0.800, Average Loss: 250.6253
    Epoch [13/20], Beta: 0.900, Average Loss: 251.8550
    Epoch [14/20], Beta: 1.000, Average Loss: 253.0527
    Epoch [15/20], Beta: 1.000, Average Loss: 252.6867
    Epoch [16/20], Beta: 1.000, Average Loss: 252.2337
    Epoch [17/20], Beta: 1.000, Average Loss: 251.9526
    Epoch [18/20], Beta: 1.000, Average Loss: 251.6666
    Epoch [19/20], Beta: 1.000, Average Loss: 251.3619
    Epoch [20/20], Beta: 1.000, Average Loss: 251.0218

[Seed 66] VAE pre-training complete.

[Seed 66] Starting joint training (original)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=148.4456, vae=3.6692, dsb=126.6940, bio=36.1649
    Epoch  2/10: total=46.3713, vae=1.1046, dsb=45.2294, bio=0.0746
    Epoch  3/10: total=38.5088, vae=1.1012, dsb=37.3915, bio=0.0322
    Epoch  4/10: total=34.6818, vae=1.0993, dsb=33.5728, bio=0.0193
    Epoch  5/10: total=32.3494, vae=1.0984, dsb=31.2445, bio=0.0131
    Epoch  6/10: total=30.7879, vae=1.0982, dsb=29.6850, bio=0.0096
    Epoch  7/10: total=29.7068, vae=1.0965, dsb=28.6066, bio=0.0074
    Epoch  8/10: total=28.7765, vae=1.0974, dsb=27.6760, bio=0.0061
    Epoch  9/10: total=28.1563, vae=1.0965, dsb=27.0571, bio=0.0054
    Epoch 10/10: total=27.6461, vae=1.0961, dsb=26.5478, bio=0.0044

  [Backward Policy Training]
    Epoch  1/10: total=2.8000, vae=1.0971, dsb=1.6967, bio=0.0123
    Epoch  2/10: total=2.3931, vae=1.0955, dsb=1.2953, bio=0.0046
    Epoch  3/10: total=2.3123, vae=1.0957, dsb=1.2149, bio=0.0035
    Epoch  4/10: total=2.2388, vae=1.0947, dsb=1.1426, bio=0.0030
    Epoch  5/10: total=2.1961, vae=1.0953, dsb=1.0996, bio=0.0024
    Epoch  6/10: total=2.1745, vae=1.0944, dsb=1.0790, bio=0.0023
    Epoch  7/10: total=2.1498, vae=1.0945, dsb=1.0541, bio=0.0021
    Epoch  8/10: total=2.1213, vae=1.0944, dsb=1.0259, bio=0.0020
    Epoch  9/10: total=2.1139, vae=1.0946, dsb=1.0183, bio=0.0021
    Epoch 10/10: total=2.1027, vae=1.0943, dsb=1.0074, bio=0.0020

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=26.1197, vae=1.0970, dsb=25.0208, bio=0.0037
    Epoch  2/10: total=21.0999, vae=1.0955, dsb=20.0034, bio=0.0019
    Epoch  3/10: total=19.7590, vae=1.0953, dsb=18.6628, bio=0.0018
    Epoch  4/10: total=19.2201, vae=1.0958, dsb=18.1234, bio=0.0017
    Epoch  5/10: total=18.7497, vae=1.0961, dsb=17.6527, bio=0.0017
    Epoch  6/10: total=18.4563, vae=1.0954, dsb=17.3600, bio=0.0020
    Epoch  7/10: total=18.2043, vae=1.0949, dsb=17.1085, bio=0.0018
    Epoch  8/10: total=18.0447, vae=1.0945, dsb=16.9493, bio=0.0018
    Epoch  9/10: total=17.8691, vae=1.0939, dsb=16.7743, bio=0.0018
    Epoch 10/10: total=17.7569, vae=1.0940, dsb=16.6620, bio=0.0019

  [Backward Policy Training]
    Epoch  1/10: total=1.8833, vae=1.0955, dsb=0.7850, bio=0.0057
    Epoch  2/10: total=1.7478, vae=1.0935, dsb=0.6534, bio=0.0019
    Epoch  3/10: total=1.7311, vae=1.0939, dsb=0.6363, bio=0.0017
    Epoch  4/10: total=1.7022, vae=1.0932, dsb=0.6081, bio=0.0018
    Epoch  5/10: total=1.6954, vae=1.0930, dsb=0.6017, bio=0.0016
    Epoch  6/10: total=1.6914, vae=1.0925, dsb=0.5982, bio=0.0015
    Epoch  7/10: total=1.6831, vae=1.0936, dsb=0.5887, bio=0.0015
    Epoch  8/10: total=1.6810, vae=1.0927, dsb=0.5876, bio=0.0015
    Epoch  9/10: total=1.6533, vae=1.0932, dsb=0.5593, bio=0.0015
    Epoch 10/10: total=1.6459, vae=1.0929, dsb=0.5523, bio=0.0015

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=17.0444, vae=1.0951, dsb=15.9477, bio=0.0030
    Epoch  2/10: total=15.0910, vae=1.0945, dsb=13.9957, bio=0.0016
    Epoch  3/10: total=14.5717, vae=1.0939, dsb=13.4770, bio=0.0016
    Epoch  4/10: total=14.3715, vae=1.0944, dsb=13.2763, bio=0.0016
    Epoch  5/10: total=14.2111, vae=1.0941, dsb=13.1161, bio=0.0017
    Epoch  6/10: total=14.0115, vae=1.0937, dsb=12.9170, bio=0.0015
    Epoch  7/10: total=13.9322, vae=1.0936, dsb=12.8378, bio=0.0016
    Epoch  8/10: total=13.8464, vae=1.0939, dsb=12.7516, bio=0.0016
    Epoch  9/10: total=13.7789, vae=1.0933, dsb=12.6848, bio=0.0015
    Epoch 10/10: total=13.7257, vae=1.0935, dsb=12.6313, bio=0.0017

  [Backward Policy Training]
    Epoch  1/10: total=1.6075, vae=1.0943, dsb=0.4919, bio=0.0426
    Epoch  2/10: total=1.5181, vae=1.0926, dsb=0.4247, bio=0.0016
    Epoch  3/10: total=1.5118, vae=1.0927, dsb=0.4184, bio=0.0014
    Epoch  4/10: total=1.4984, vae=1.0925, dsb=0.4052, bio=0.0014
    Epoch  5/10: total=1.4919, vae=1.0929, dsb=0.3983, bio=0.0013
    Epoch  6/10: total=1.4815, vae=1.0930, dsb=0.3878, bio=0.0014
    Epoch  7/10: total=1.4893, vae=1.0923, dsb=0.3962, bio=0.0015
    Epoch  8/10: total=1.4877, vae=1.0920, dsb=0.3950, bio=0.0013
    Epoch  9/10: total=1.4826, vae=1.0917, dsb=0.3902, bio=0.0013
    Epoch 10/10: total=1.4774, vae=1.0924, dsb=0.3843, bio=0.0013

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=14.0452, vae=1.0951, dsb=12.9485, bio=0.0031
    Epoch  2/10: total=13.0914, vae=1.0942, dsb=11.9965, bio=0.0014
    Epoch  3/10: total=12.8619, vae=1.0937, dsb=11.7675, bio=0.0014
    Epoch  4/10: total=12.7738, vae=1.0927, dsb=11.6804, bio=0.0014
    Epoch  5/10: total=12.6575, vae=1.0929, dsb=11.5639, bio=0.0014
    Epoch  6/10: total=12.6164, vae=1.0933, dsb=11.5225, bio=0.0014
    Epoch  7/10: total=12.5569, vae=1.0922, dsb=11.4641, bio=0.0013
    Epoch  8/10: total=12.5002, vae=1.0931, dsb=11.4065, bio=0.0013
    Epoch  9/10: total=12.5462, vae=1.0922, dsb=11.4533, bio=0.0013
    Epoch 10/10: total=12.4732, vae=1.0937, dsb=11.3789, bio=0.0013

  [Backward Policy Training]
    Epoch  1/10: total=1.4604, vae=1.0942, dsb=0.3295, bio=0.0735
    Epoch  2/10: total=1.3958, vae=1.0919, dsb=0.3032, bio=0.0014
    Epoch  3/10: total=1.3918, vae=1.0921, dsb=0.2991, bio=0.0013
    Epoch  4/10: total=1.3871, vae=1.0925, dsb=0.2940, bio=0.0012
    Epoch  5/10: total=1.3805, vae=1.0917, dsb=0.2883, bio=0.0012
    Epoch  6/10: total=1.3778, vae=1.0924, dsb=0.2849, bio=0.0012
    Epoch  7/10: total=1.3765, vae=1.0919, dsb=0.2840, bio=0.0011
    Epoch  8/10: total=1.3800, vae=1.0918, dsb=0.2876, bio=0.0012
    Epoch  9/10: total=1.3749, vae=1.0925, dsb=0.2818, bio=0.0012
    Epoch 10/10: total=1.3708, vae=1.0915, dsb=0.2787, bio=0.0011

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=11.0635, vae=1.0955, dsb=9.9660, bio=0.0042
    Epoch  2/10: total=10.7273, vae=1.0932, dsb=9.6336, bio=0.0012
    Epoch  3/10: total=10.6906, vae=1.0936, dsb=9.5963, bio=0.0012
    Epoch  4/10: total=10.5900, vae=1.0931, dsb=9.4962, bio=0.0013
    Epoch  5/10: total=10.5547, vae=1.0926, dsb=9.4616, bio=0.0011
    Epoch  6/10: total=10.5998, vae=1.0932, dsb=9.5060, bio=0.0011
    Epoch  7/10: total=10.5329, vae=1.0926, dsb=9.4397, bio=0.0011
    Epoch  8/10: total=10.4759, vae=1.0920, dsb=9.3833, bio=0.0011
    Epoch  9/10: total=10.5202, vae=1.0921, dsb=9.4276, bio=0.0010
    Epoch 10/10: total=10.5089, vae=1.0921, dsb=9.4162, bio=0.0012

  [Backward Policy Training]
    Epoch  1/10: total=1.4119, vae=1.0941, dsb=0.2353, bio=0.1650
    Epoch  2/10: total=1.3250, vae=1.0922, dsb=0.2322, bio=0.0013
    Epoch  3/10: total=1.3278, vae=1.0921, dsb=0.2351, bio=0.0012
    Epoch  4/10: total=1.3180, vae=1.0921, dsb=0.2253, bio=0.0011
    Epoch  5/10: total=1.3206, vae=1.0917, dsb=0.2283, bio=0.0011
    Epoch  6/10: total=1.3196, vae=1.0911, dsb=0.2280, bio=0.0011
    Epoch  7/10: total=1.3187, vae=1.0917, dsb=0.2265, bio=0.0010
    Epoch  8/10: total=1.3159, vae=1.0913, dsb=0.2242, bio=0.0010
    Epoch  9/10: total=1.3165, vae=1.0910, dsb=0.2251, bio=0.0010
    Epoch 10/10: total=1.3161, vae=1.0915, dsb=0.2241, bio=0.0010

[Seed 66] Joint training (original) complete; models and history saved.

[Seed 66] Starting joint training (ablation)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=128.4585, vae=1.9743, dsb=126.4842, bio=0.0000
    Epoch  2/10: total=45.9787, vae=1.0877, dsb=44.8909, bio=0.0000
    Epoch  3/10: total=38.1548, vae=1.0870, dsb=37.0679, bio=0.0000
    Epoch  4/10: total=34.4311, vae=1.0860, dsb=33.3451, bio=0.0000
    Epoch  5/10: total=32.1520, vae=1.0855, dsb=31.0665, bio=0.0000
    Epoch  6/10: total=30.5965, vae=1.0857, dsb=29.5109, bio=0.0000
    Epoch  7/10: total=29.5480, vae=1.0843, dsb=28.4637, bio=0.0000
    Epoch  8/10: total=28.6036, vae=1.0855, dsb=27.5181, bio=0.0000
    Epoch  9/10: total=27.9938, vae=1.0848, dsb=26.9090, bio=0.0000
    Epoch 10/10: total=27.4865, vae=1.0847, dsb=26.4018, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=2.7509, vae=1.0850, dsb=1.6659, bio=0.0000
    Epoch  2/10: total=2.3606, vae=1.0849, dsb=1.2757, bio=0.0000
    Epoch  3/10: total=2.2839, vae=1.0854, dsb=1.1985, bio=0.0000
    Epoch  4/10: total=2.2116, vae=1.0848, dsb=1.1268, bio=0.0000
    Epoch  5/10: total=2.1691, vae=1.0855, dsb=1.0836, bio=0.0000
    Epoch  6/10: total=2.1467, vae=1.0848, dsb=1.0619, bio=0.0000
    Epoch  7/10: total=2.1219, vae=1.0850, dsb=1.0369, bio=0.0000
    Epoch  8/10: total=2.0934, vae=1.0850, dsb=1.0084, bio=0.0000
    Epoch  9/10: total=2.0858, vae=1.0852, dsb=1.0005, bio=0.0000
    Epoch 10/10: total=2.0746, vae=1.0848, dsb=0.9899, bio=0.0000

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=25.0968, vae=1.0844, dsb=24.0124, bio=0.0000
    Epoch  2/10: total=20.2400, vae=1.0847, dsb=19.1553, bio=0.0000
    Epoch  3/10: total=18.9806, vae=1.0848, dsb=17.8959, bio=0.0000
    Epoch  4/10: total=18.4384, vae=1.0854, dsb=17.3530, bio=0.0000
    Epoch  5/10: total=17.9847, vae=1.0858, dsb=16.8989, bio=0.0000
    Epoch  6/10: total=17.6658, vae=1.0852, dsb=16.5806, bio=0.0000
    Epoch  7/10: total=17.4341, vae=1.0848, dsb=16.3492, bio=0.0000
    Epoch  8/10: total=17.2581, vae=1.0846, dsb=16.1735, bio=0.0000
    Epoch  9/10: total=17.0923, vae=1.0841, dsb=16.0082, bio=0.0000
    Epoch 10/10: total=16.9840, vae=1.0842, dsb=15.8998, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.8420, vae=1.0854, dsb=0.7566, bio=0.0000
    Epoch  2/10: total=1.7147, vae=1.0846, dsb=0.6301, bio=0.0000
    Epoch  3/10: total=1.6973, vae=1.0852, dsb=0.6121, bio=0.0000
    Epoch  4/10: total=1.6679, vae=1.0844, dsb=0.5835, bio=0.0000
    Epoch  5/10: total=1.6613, vae=1.0844, dsb=0.5769, bio=0.0000
    Epoch  6/10: total=1.6576, vae=1.0840, dsb=0.5736, bio=0.0000
    Epoch  7/10: total=1.6491, vae=1.0851, dsb=0.5640, bio=0.0000
    Epoch  8/10: total=1.6469, vae=1.0842, dsb=0.5627, bio=0.0000
    Epoch  9/10: total=1.6200, vae=1.0848, dsb=0.5352, bio=0.0000
    Epoch 10/10: total=1.6128, vae=1.0846, dsb=0.5282, bio=0.0000

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=16.5773, vae=1.0842, dsb=15.4931, bio=0.0000
    Epoch  2/10: total=14.7125, vae=1.0847, dsb=13.6278, bio=0.0000
    Epoch  3/10: total=14.2232, vae=1.0845, dsb=13.1387, bio=0.0000
    Epoch  4/10: total=14.0304, vae=1.0851, dsb=12.9453, bio=0.0000
    Epoch  5/10: total=13.8944, vae=1.0850, dsb=12.8094, bio=0.0000
    Epoch  6/10: total=13.7053, vae=1.0847, dsb=12.6206, bio=0.0000
    Epoch  7/10: total=13.6330, vae=1.0847, dsb=12.5483, bio=0.0000
    Epoch  8/10: total=13.5582, vae=1.0851, dsb=12.4732, bio=0.0000
    Epoch  9/10: total=13.4898, vae=1.0846, dsb=12.4052, bio=0.0000
    Epoch 10/10: total=13.4522, vae=1.0847, dsb=12.3675, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.5411, vae=1.0850, dsb=0.4561, bio=0.0000
    Epoch  2/10: total=1.4782, vae=1.0843, dsb=0.3939, bio=0.0000
    Epoch  3/10: total=1.4739, vae=1.0845, dsb=0.3893, bio=0.0000
    Epoch  4/10: total=1.4616, vae=1.0845, dsb=0.3772, bio=0.0000
    Epoch  5/10: total=1.4559, vae=1.0850, dsb=0.3710, bio=0.0000
    Epoch  6/10: total=1.4465, vae=1.0849, dsb=0.3616, bio=0.0000
    Epoch  7/10: total=1.4545, vae=1.0845, dsb=0.3699, bio=0.0000
    Epoch  8/10: total=1.4532, vae=1.0842, dsb=0.3689, bio=0.0000
    Epoch  9/10: total=1.4482, vae=1.0840, dsb=0.3643, bio=0.0000
    Epoch 10/10: total=1.4437, vae=1.0848, dsb=0.3590, bio=0.0000

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=13.3749, vae=1.0847, dsb=12.2902, bio=0.0000
    Epoch  2/10: total=12.5485, vae=1.0850, dsb=11.4634, bio=0.0000
    Epoch  3/10: total=12.3637, vae=1.0847, dsb=11.2790, bio=0.0000
    Epoch  4/10: total=12.2864, vae=1.0839, dsb=11.2025, bio=0.0000
    Epoch  5/10: total=12.1871, vae=1.0841, dsb=11.1029, bio=0.0000
    Epoch  6/10: total=12.1676, vae=1.0848, dsb=11.0828, bio=0.0000
    Epoch  7/10: total=12.1204, vae=1.0837, dsb=11.0367, bio=0.0000
    Epoch  8/10: total=12.0657, vae=1.0847, dsb=10.9810, bio=0.0000
    Epoch  9/10: total=12.1198, vae=1.0839, dsb=11.0359, bio=0.0000
    Epoch 10/10: total=12.0558, vae=1.0855, dsb=10.9703, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.3941, vae=1.0851, dsb=0.3090, bio=0.0000
    Epoch  2/10: total=1.3685, vae=1.0840, dsb=0.2845, bio=0.0000
    Epoch  3/10: total=1.3655, vae=1.0844, dsb=0.2810, bio=0.0000
    Epoch  4/10: total=1.3614, vae=1.0849, dsb=0.2765, bio=0.0000
    Epoch  5/10: total=1.3555, vae=1.0843, dsb=0.2712, bio=0.0000
    Epoch  6/10: total=1.3529, vae=1.0850, dsb=0.2678, bio=0.0000
    Epoch  7/10: total=1.3514, vae=1.0847, dsb=0.2668, bio=0.0000
    Epoch  8/10: total=1.3550, vae=1.0847, dsb=0.2703, bio=0.0000
    Epoch  9/10: total=1.3498, vae=1.0855, dsb=0.2643, bio=0.0000
    Epoch 10/10: total=1.3459, vae=1.0846, dsb=0.2613, bio=0.0000

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=10.7850, vae=1.0851, dsb=9.6999, bio=0.0000
    Epoch  2/10: total=10.5163, vae=1.0843, dsb=9.4320, bio=0.0000
    Epoch  3/10: total=10.4847, vae=1.0849, dsb=9.3998, bio=0.0000
    Epoch  4/10: total=10.4045, vae=1.0847, dsb=9.3198, bio=0.0000
    Epoch  5/10: total=10.3689, vae=1.0844, dsb=9.2846, bio=0.0000
    Epoch  6/10: total=10.4240, vae=1.0851, dsb=9.3389, bio=0.0000
    Epoch  7/10: total=10.3518, vae=1.0846, dsb=9.2672, bio=0.0000
    Epoch  8/10: total=10.3020, vae=1.0840, dsb=9.2180, bio=0.0000
    Epoch  9/10: total=10.3482, vae=1.0842, dsb=9.2640, bio=0.0000
    Epoch 10/10: total=10.3425, vae=1.0842, dsb=9.2583, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.3027, vae=1.0852, dsb=0.2175, bio=0.0000
    Epoch  2/10: total=1.3004, vae=1.0847, dsb=0.2157, bio=0.0000
    Epoch  3/10: total=1.3037, vae=1.0848, dsb=0.2188, bio=0.0000
    Epoch  4/10: total=1.2945, vae=1.0850, dsb=0.2095, bio=0.0000
    Epoch  5/10: total=1.2970, vae=1.0847, dsb=0.2123, bio=0.0000
    Epoch  6/10: total=1.2964, vae=1.0843, dsb=0.2121, bio=0.0000
    Epoch  7/10: total=1.2957, vae=1.0850, dsb=0.2107, bio=0.0000
    Epoch  8/10: total=1.2930, vae=1.0846, dsb=0.2084, bio=0.0000
    Epoch  9/10: total=1.2934, vae=1.0842, dsb=0.2093, bio=0.0000
    Epoch 10/10: total=1.2931, vae=1.0848, dsb=0.2082, bio=0.0000

[Seed 66] Joint training (ablation) complete; models and history saved.

[Seed 66] Drift genes saved in /home/yyuan/ICB_TCE/iter_results/run_066

[Seed 66] run finished.

================================================================================
[Seed 67] Starting running whole pipeline...
================================================================================

[Seed 67] Starting VAE pre-training...

    Epoch [01/20], Beta: 0.000, Average Loss: 536.9400
    Epoch [02/20], Beta: 0.000, Average Loss: 308.9382
    Epoch [03/20], Beta: 0.000, Average Loss: 271.0890
    Epoch [04/20], Beta: 0.000, Average Loss: 251.7458
    Epoch [05/20], Beta: 0.100, Average Loss: 246.1663
    Epoch [06/20], Beta: 0.200, Average Loss: 244.4082
    Epoch [07/20], Beta: 0.300, Average Loss: 244.4790
    Epoch [08/20], Beta: 0.400, Average Loss: 245.2235
    Epoch [09/20], Beta: 0.500, Average Loss: 246.2672
    Epoch [10/20], Beta: 0.600, Average Loss: 247.5746
    Epoch [11/20], Beta: 0.700, Average Loss: 248.8777
    Epoch [12/20], Beta: 0.800, Average Loss: 250.2521
    Epoch [13/20], Beta: 0.900, Average Loss: 251.5089
    Epoch [14/20], Beta: 1.000, Average Loss: 253.1358
    Epoch [15/20], Beta: 1.000, Average Loss: 252.7446
    Epoch [16/20], Beta: 1.000, Average Loss: 252.3422
    Epoch [17/20], Beta: 1.000, Average Loss: 252.0418
    Epoch [18/20], Beta: 1.000, Average Loss: 251.7704
    Epoch [19/20], Beta: 1.000, Average Loss: 251.3687
    Epoch [20/20], Beta: 1.000, Average Loss: 251.1775

[Seed 67] VAE pre-training complete.

[Seed 67] Starting joint training (original)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=329.1126, vae=3.4649, dsb=309.7859, bio=31.7237
    Epoch  2/10: total=111.1490, vae=1.1067, dsb=110.0069, bio=0.0706
    Epoch  3/10: total=97.9572, vae=1.1001, dsb=96.8405, bio=0.0333
    Epoch  4/10: total=92.0358, vae=1.1001, dsb=90.9255, bio=0.0203
    Epoch  5/10: total=88.7283, vae=1.0985, dsb=87.6230, bio=0.0136
    Epoch  6/10: total=86.8071, vae=1.0979, dsb=85.7042, bio=0.0101
    Epoch  7/10: total=84.6840, vae=1.0986, dsb=83.5814, bio=0.0080
    Epoch  8/10: total=83.6312, vae=1.0973, dsb=82.5307, bio=0.0064
    Epoch  9/10: total=82.0763, vae=1.0970, dsb=80.9765, bio=0.0055
    Epoch 10/10: total=81.8067, vae=1.0968, dsb=80.7075, bio=0.0046

  [Backward Policy Training]
    Epoch  1/10: total=3.4898, vae=1.0984, dsb=2.3831, bio=0.0167
    Epoch  2/10: total=2.9617, vae=1.0975, dsb=1.8614, bio=0.0057
    Epoch  3/10: total=2.8522, vae=1.0956, dsb=1.7546, bio=0.0039
    Epoch  4/10: total=2.7720, vae=1.0963, dsb=1.6742, bio=0.0031
    Epoch  5/10: total=2.6881, vae=1.0960, dsb=1.5907, bio=0.0027
    Epoch  6/10: total=2.6371, vae=1.0951, dsb=1.5409, bio=0.0024
    Epoch  7/10: total=2.6385, vae=1.0960, dsb=1.5414, bio=0.0022
    Epoch  8/10: total=2.5897, vae=1.0960, dsb=1.4927, bio=0.0021
    Epoch  9/10: total=2.5686, vae=1.0944, dsb=1.4731, bio=0.0020
    Epoch 10/10: total=2.5448, vae=1.0952, dsb=1.4487, bio=0.0019

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=75.1217, vae=1.0979, dsb=74.0217, bio=0.0041
    Epoch  2/10: total=67.5477, vae=1.0972, dsb=66.4496, bio=0.0018
    Epoch  3/10: total=65.6421, vae=1.0962, dsb=64.5451, bio=0.0017
    Epoch  4/10: total=64.5114, vae=1.0963, dsb=63.4142, bio=0.0017
    Epoch  5/10: total=63.8088, vae=1.0960, dsb=62.7120, bio=0.0017
    Epoch  6/10: total=62.9372, vae=1.0957, dsb=61.8406, bio=0.0017
    Epoch  7/10: total=62.7395, vae=1.0960, dsb=61.6427, bio=0.0017
    Epoch  8/10: total=62.5804, vae=1.0958, dsb=61.4833, bio=0.0025
    Epoch  9/10: total=62.3654, vae=1.0960, dsb=61.2686, bio=0.0016
    Epoch 10/10: total=61.8633, vae=1.0955, dsb=60.7670, bio=0.0016

  [Backward Policy Training]
    Epoch  1/10: total=2.3197, vae=1.0958, dsb=1.2209, bio=0.0061
    Epoch  2/10: total=2.1797, vae=1.0938, dsb=1.0850, bio=0.0018
    Epoch  3/10: total=2.1553, vae=1.0946, dsb=1.0599, bio=0.0017
    Epoch  4/10: total=2.1331, vae=1.0951, dsb=1.0372, bio=0.0016
    Epoch  5/10: total=2.1071, vae=1.0935, dsb=1.0129, bio=0.0015
    Epoch  6/10: total=2.0844, vae=1.0944, dsb=0.9892, bio=0.0015
    Epoch  7/10: total=2.1080, vae=1.0934, dsb=1.0139, bio=0.0014
    Epoch  8/10: total=2.1046, vae=1.0941, dsb=1.0096, bio=0.0018
    Epoch  9/10: total=2.0778, vae=1.0943, dsb=0.9828, bio=0.0014
    Epoch 10/10: total=2.0617, vae=1.0934, dsb=0.9677, bio=0.0014

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=54.5774, vae=1.0964, dsb=53.4796, bio=0.0028
    Epoch  2/10: total=51.9477, vae=1.0946, dsb=50.8524, bio=0.0014
    Epoch  3/10: total=51.1348, vae=1.0947, dsb=50.0395, bio=0.0014
    Epoch  4/10: total=50.5249, vae=1.0954, dsb=49.4288, bio=0.0014
    Epoch  5/10: total=50.3069, vae=1.0953, dsb=49.2109, bio=0.0014
    Epoch  6/10: total=50.2515, vae=1.0955, dsb=49.1552, bio=0.0016
    Epoch  7/10: total=50.1085, vae=1.0952, dsb=49.0127, bio=0.0013
    Epoch  8/10: total=50.2037, vae=1.0943, dsb=49.1087, bio=0.0013
    Epoch  9/10: total=50.0718, vae=1.0943, dsb=48.9768, bio=0.0013
    Epoch 10/10: total=49.6164, vae=1.0948, dsb=48.5208, bio=0.0013

  [Backward Policy Training]
    Epoch  1/10: total=1.9536, vae=1.0956, dsb=0.8539, bio=0.0081
    Epoch  2/10: total=1.8678, vae=1.0938, dsb=0.7734, bio=0.0014
    Epoch  3/10: total=1.8681, vae=1.0936, dsb=0.7739, bio=0.0013
    Epoch  4/10: total=1.8490, vae=1.0928, dsb=0.7556, bio=0.0012
    Epoch  5/10: total=1.8512, vae=1.0935, dsb=0.7572, bio=0.0012
    Epoch  6/10: total=1.8252, vae=1.0930, dsb=0.7316, bio=0.0011
    Epoch  7/10: total=1.8265, vae=1.0944, dsb=0.7315, bio=0.0011
    Epoch  8/10: total=1.8347, vae=1.0937, dsb=0.7405, bio=0.0011
    Epoch  9/10: total=1.8125, vae=1.0932, dsb=0.7187, bio=0.0011
    Epoch 10/10: total=1.8111, vae=1.0938, dsb=0.7166, bio=0.0013

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=48.7836, vae=1.0965, dsb=47.6858, bio=0.0025
    Epoch  2/10: total=47.6662, vae=1.0948, dsb=46.5709, bio=0.0011
    Epoch  3/10: total=47.2996, vae=1.0946, dsb=46.2045, bio=0.0011
    Epoch  4/10: total=47.0720, vae=1.0939, dsb=45.9776, bio=0.0011
    Epoch  5/10: total=47.1457, vae=1.0935, dsb=46.0517, bio=0.0011
    Epoch  6/10: total=46.9507, vae=1.0942, dsb=45.8562, bio=0.0007
    Epoch  7/10: total=46.9606, vae=1.0936, dsb=45.8663, bio=0.0012
    Epoch  8/10: total=46.9180, vae=1.0944, dsb=45.8231, bio=0.0012
    Epoch  9/10: total=46.7895, vae=1.0943, dsb=45.6947, bio=0.0011
    Epoch 10/10: total=46.8809, vae=1.0934, dsb=45.7869, bio=0.0011

  [Backward Policy Training]
    Epoch  1/10: total=1.7498, vae=1.0946, dsb=0.6448, bio=0.0209
    Epoch  2/10: total=1.7128, vae=1.0934, dsb=0.6188, bio=0.0012
    Epoch  3/10: total=1.7093, vae=1.0928, dsb=0.6159, bio=0.0010
    Epoch  4/10: total=1.6808, vae=1.0933, dsb=0.5871, bio=0.0010
    Epoch  5/10: total=1.7056, vae=1.0920, dsb=0.6132, bio=0.0009
    Epoch  6/10: total=1.6898, vae=1.0935, dsb=0.5959, bio=0.0009
    Epoch  7/10: total=1.6876, vae=1.0932, dsb=0.5941, bio=0.0006
    Epoch  8/10: total=1.6962, vae=1.0930, dsb=0.6027, bio=0.0010
    Epoch  9/10: total=1.6786, vae=1.0931, dsb=0.5850, bio=0.0010
    Epoch 10/10: total=1.6934, vae=1.0931, dsb=0.5999, bio=0.0009

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=39.3427, vae=1.0950, dsb=38.2466, bio=0.0023
    Epoch  2/10: total=38.6887, vae=1.0947, dsb=37.5935, bio=0.0009
    Epoch  3/10: total=38.8395, vae=1.0942, dsb=37.7449, bio=0.0008
    Epoch  4/10: total=38.7110, vae=1.0937, dsb=37.6171, bio=0.0005
    Epoch  5/10: total=38.7264, vae=1.0939, dsb=37.6322, bio=0.0008
    Epoch  6/10: total=38.7926, vae=1.0942, dsb=37.6978, bio=0.0012
    Epoch  7/10: total=38.6072, vae=1.0938, dsb=37.5130, bio=0.0008
    Epoch  8/10: total=38.5972, vae=1.0927, dsb=37.5043, bio=0.0005
    Epoch  9/10: total=38.7513, vae=1.0923, dsb=37.6587, bio=0.0007
    Epoch 10/10: total=38.5987, vae=1.0935, dsb=37.5050, bio=0.0006

  [Backward Policy Training]
    Epoch  1/10: total=1.6867, vae=1.0948, dsb=0.5592, bio=0.0653
    Epoch  2/10: total=1.6101, vae=1.0930, dsb=0.5164, bio=0.0012
    Epoch  3/10: total=1.6023, vae=1.0938, dsb=0.5080, bio=0.0010
    Epoch  4/10: total=1.6008, vae=1.0926, dsb=0.5077, bio=0.0009
    Epoch  5/10: total=1.6201, vae=1.0928, dsb=0.5270, bio=0.0005
    Epoch  6/10: total=1.6065, vae=1.0938, dsb=0.5125, bio=0.0005
    Epoch  7/10: total=1.6024, vae=1.0924, dsb=0.5094, bio=0.0011
    Epoch  8/10: total=1.6050, vae=1.0922, dsb=0.5123, bio=0.0010
    Epoch  9/10: total=1.6199, vae=1.0923, dsb=0.5275, bio=0.0003
    Epoch 10/10: total=1.6149, vae=1.0928, dsb=0.5218, bio=0.0007

[Seed 67] Joint training (original) complete; models and history saved.

[Seed 67] Starting joint training (ablation)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=311.1477, vae=2.0064, dsb=309.1413, bio=0.0000
    Epoch  2/10: total=110.5279, vae=1.0903, dsb=109.4376, bio=0.0000
    Epoch  3/10: total=97.4028, vae=1.0863, dsb=96.3166, bio=0.0000
    Epoch  4/10: total=91.6821, vae=1.0871, dsb=90.5949, bio=0.0000
    Epoch  5/10: total=88.4108, vae=1.0859, dsb=87.3249, bio=0.0000
    Epoch  6/10: total=86.4432, vae=1.0855, dsb=85.3577, bio=0.0000
    Epoch  7/10: total=84.2846, vae=1.0865, dsb=83.1981, bio=0.0000
    Epoch  8/10: total=83.2051, vae=1.0856, dsb=82.1195, bio=0.0000
    Epoch  9/10: total=81.6329, vae=1.0855, dsb=80.5474, bio=0.0000
    Epoch 10/10: total=81.3619, vae=1.0855, dsb=80.2764, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=3.3702, vae=1.0857, dsb=2.2845, bio=0.0000
    Epoch  2/10: total=2.8714, vae=1.0867, dsb=1.7847, bio=0.0000
    Epoch  3/10: total=2.7663, vae=1.0853, dsb=1.6810, bio=0.0000
    Epoch  4/10: total=2.6880, vae=1.0862, dsb=1.6017, bio=0.0000
    Epoch  5/10: total=2.6097, vae=1.0861, dsb=1.5236, bio=0.0000
    Epoch  6/10: total=2.5624, vae=1.0853, dsb=1.4771, bio=0.0000
    Epoch  7/10: total=2.5635, vae=1.0863, dsb=1.4772, bio=0.0000
    Epoch  8/10: total=2.5186, vae=1.0864, dsb=1.4322, bio=0.0000
    Epoch  9/10: total=2.4993, vae=1.0849, dsb=1.4144, bio=0.0000
    Epoch 10/10: total=2.4755, vae=1.0857, dsb=1.3897, bio=0.0000

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=73.4409, vae=1.0857, dsb=72.3553, bio=0.0000
    Epoch  2/10: total=66.1902, vae=1.0863, dsb=65.1040, bio=0.0000
    Epoch  3/10: total=64.3987, vae=1.0854, dsb=63.3133, bio=0.0000
    Epoch  4/10: total=63.3288, vae=1.0857, dsb=62.2431, bio=0.0000
    Epoch  5/10: total=62.6605, vae=1.0855, dsb=61.5751, bio=0.0000
    Epoch  6/10: total=61.8687, vae=1.0854, dsb=60.7833, bio=0.0000
    Epoch  7/10: total=61.6929, vae=1.0858, dsb=60.6072, bio=0.0000
    Epoch  8/10: total=61.5522, vae=1.0856, dsb=60.4666, bio=0.0000
    Epoch  9/10: total=61.3412, vae=1.0859, dsb=60.2553, bio=0.0000
    Epoch 10/10: total=60.8187, vae=1.0855, dsb=59.7332, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=2.2037, vae=1.0853, dsb=1.1184, bio=0.0000
    Epoch  2/10: total=2.0786, vae=1.0848, dsb=0.9939, bio=0.0000
    Epoch  3/10: total=2.0569, vae=1.0857, dsb=0.9712, bio=0.0000
    Epoch  4/10: total=2.0357, vae=1.0864, dsb=0.9493, bio=0.0000
    Epoch  5/10: total=2.0122, vae=1.0847, dsb=0.9275, bio=0.0000
    Epoch  6/10: total=1.9915, vae=1.0857, dsb=0.9058, bio=0.0000
    Epoch  7/10: total=2.0133, vae=1.0847, dsb=0.9286, bio=0.0000
    Epoch  8/10: total=2.0101, vae=1.0854, dsb=0.9247, bio=0.0000
    Epoch  9/10: total=1.9854, vae=1.0858, dsb=0.8996, bio=0.0000
    Epoch 10/10: total=1.9702, vae=1.0848, dsb=0.8854, bio=0.0000

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=52.1853, vae=1.0854, dsb=51.0998, bio=0.0000
    Epoch  2/10: total=49.7267, vae=1.0848, dsb=48.6419, bio=0.0000
    Epoch  3/10: total=48.8634, vae=1.0850, dsb=47.7784, bio=0.0000
    Epoch  4/10: total=48.2633, vae=1.0859, dsb=47.1774, bio=0.0000
    Epoch  5/10: total=48.0624, vae=1.0858, dsb=46.9766, bio=0.0000
    Epoch  6/10: total=47.9896, vae=1.0860, dsb=46.9036, bio=0.0000
    Epoch  7/10: total=47.8893, vae=1.0859, dsb=46.8034, bio=0.0000
    Epoch  8/10: total=47.9628, vae=1.0851, dsb=46.8777, bio=0.0000
    Epoch  9/10: total=47.8586, vae=1.0851, dsb=46.7735, bio=0.0000
    Epoch 10/10: total=47.4000, vae=1.0857, dsb=46.3143, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.8673, vae=1.0861, dsb=0.7812, bio=0.0000
    Epoch  2/10: total=1.7956, vae=1.0854, dsb=0.7102, bio=0.0000
    Epoch  3/10: total=1.7977, vae=1.0853, dsb=0.7124, bio=0.0000
    Epoch  4/10: total=1.7809, vae=1.0846, dsb=0.6962, bio=0.0000
    Epoch  5/10: total=1.7841, vae=1.0853, dsb=0.6988, bio=0.0000
    Epoch  6/10: total=1.7600, vae=1.0849, dsb=0.6751, bio=0.0000
    Epoch  7/10: total=1.7614, vae=1.0864, dsb=0.6750, bio=0.0000
    Epoch  8/10: total=1.7696, vae=1.0856, dsb=0.6840, bio=0.0000
    Epoch  9/10: total=1.7487, vae=1.0852, dsb=0.6635, bio=0.0000
    Epoch 10/10: total=1.7476, vae=1.0858, dsb=0.6618, bio=0.0000

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=45.5575, vae=1.0853, dsb=44.4722, bio=0.0000
    Epoch  2/10: total=44.4028, vae=1.0855, dsb=43.3173, bio=0.0000
    Epoch  3/10: total=44.0200, vae=1.0855, dsb=42.9345, bio=0.0000
    Epoch  4/10: total=43.7803, vae=1.0850, dsb=42.6953, bio=0.0000
    Epoch  5/10: total=43.8040, vae=1.0846, dsb=42.7195, bio=0.0000
    Epoch  6/10: total=43.6453, vae=1.0853, dsb=42.5600, bio=0.0000
    Epoch  7/10: total=43.6289, vae=1.0850, dsb=42.5440, bio=0.0000
    Epoch  8/10: total=43.5756, vae=1.0858, dsb=42.4898, bio=0.0000
    Epoch  9/10: total=43.4678, vae=1.0856, dsb=42.3821, bio=0.0000
    Epoch 10/10: total=43.5301, vae=1.0849, dsb=42.4452, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.6766, vae=1.0857, dsb=0.5909, bio=0.0000
    Epoch  2/10: total=1.6509, vae=1.0855, dsb=0.5653, bio=0.0000
    Epoch  3/10: total=1.6468, vae=1.0849, dsb=0.5618, bio=0.0000
    Epoch  4/10: total=1.6204, vae=1.0855, dsb=0.5349, bio=0.0000
    Epoch  5/10: total=1.6430, vae=1.0843, dsb=0.5588, bio=0.0000
    Epoch  6/10: total=1.6284, vae=1.0857, dsb=0.5427, bio=0.0000
    Epoch  7/10: total=1.6263, vae=1.0854, dsb=0.5409, bio=0.0000
    Epoch  8/10: total=1.6343, vae=1.0854, dsb=0.5490, bio=0.0000
    Epoch  9/10: total=1.6179, vae=1.0855, dsb=0.5323, bio=0.0000
    Epoch 10/10: total=1.6319, vae=1.0855, dsb=0.5464, bio=0.0000

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=37.0175, vae=1.0846, dsb=35.9328, bio=0.0000
    Epoch  2/10: total=36.3509, vae=1.0858, dsb=35.2651, bio=0.0000
    Epoch  3/10: total=36.4983, vae=1.0854, dsb=35.4129, bio=0.0000
    Epoch  4/10: total=36.3365, vae=1.0852, dsb=35.2513, bio=0.0000
    Epoch  5/10: total=36.3394, vae=1.0855, dsb=35.2539, bio=0.0000
    Epoch  6/10: total=36.4273, vae=1.0860, dsb=35.3413, bio=0.0000
    Epoch  7/10: total=36.2557, vae=1.0856, dsb=35.1702, bio=0.0000
    Epoch  8/10: total=36.2325, vae=1.0846, dsb=35.1480, bio=0.0000
    Epoch  9/10: total=36.3936, vae=1.0842, dsb=35.3094, bio=0.0000
    Epoch 10/10: total=36.2484, vae=1.0855, dsb=35.1628, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.5902, vae=1.0859, dsb=0.5043, bio=0.0000
    Epoch  2/10: total=1.5501, vae=1.0853, dsb=0.4648, bio=0.0000
    Epoch  3/10: total=1.5430, vae=1.0862, dsb=0.4568, bio=0.0000
    Epoch  4/10: total=1.5418, vae=1.0850, dsb=0.4568, bio=0.0000
    Epoch  5/10: total=1.5598, vae=1.0852, dsb=0.4746, bio=0.0000
    Epoch  6/10: total=1.5474, vae=1.0862, dsb=0.4611, bio=0.0000
    Epoch  7/10: total=1.5433, vae=1.0850, dsb=0.4583, bio=0.0000
    Epoch  8/10: total=1.5458, vae=1.0848, dsb=0.4610, bio=0.0000
    Epoch  9/10: total=1.5598, vae=1.0848, dsb=0.4750, bio=0.0000
    Epoch 10/10: total=1.5551, vae=1.0854, dsb=0.4697, bio=0.0000

[Seed 67] Joint training (ablation) complete; models and history saved.

[Seed 67] Drift genes saved in /home/yyuan/ICB_TCE/iter_results/run_067

[Seed 67] run finished.

================================================================================
[Seed 68] Starting running whole pipeline...
================================================================================

[Seed 68] Starting VAE pre-training...

    Epoch [01/20], Beta: 0.000, Average Loss: 533.2496
    Epoch [02/20], Beta: 0.000, Average Loss: 307.5160
    Epoch [03/20], Beta: 0.000, Average Loss: 270.9660
    Epoch [04/20], Beta: 0.000, Average Loss: 249.3725
    Epoch [05/20], Beta: 0.100, Average Loss: 245.1345
    Epoch [06/20], Beta: 0.200, Average Loss: 244.6279
    Epoch [07/20], Beta: 0.300, Average Loss: 244.9699
    Epoch [08/20], Beta: 0.400, Average Loss: 245.8265
    Epoch [09/20], Beta: 0.500, Average Loss: 246.9568
    Epoch [10/20], Beta: 0.600, Average Loss: 248.1599
    Epoch [11/20], Beta: 0.700, Average Loss: 249.3712
    Epoch [12/20], Beta: 0.800, Average Loss: 250.6127
    Epoch [13/20], Beta: 0.900, Average Loss: 251.7945
    Epoch [14/20], Beta: 1.000, Average Loss: 253.4123
    Epoch [15/20], Beta: 1.000, Average Loss: 252.9651
    Epoch [16/20], Beta: 1.000, Average Loss: 252.5775
    Epoch [17/20], Beta: 1.000, Average Loss: 252.2101
    Epoch [18/20], Beta: 1.000, Average Loss: 251.8419
    Epoch [19/20], Beta: 1.000, Average Loss: 251.4919
    Epoch [20/20], Beta: 1.000, Average Loss: 251.2928

[Seed 68] VAE pre-training complete.

[Seed 68] Starting joint training (original)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=362.3789, vae=3.5276, dsb=338.8708, bio=39.9611
    Epoch  2/10: total=106.0094, vae=1.1001, dsb=104.8767, bio=0.0651
    Epoch  3/10: total=95.2636, vae=1.0974, dsb=94.1520, bio=0.0282
    Epoch  4/10: total=90.0118, vae=1.0945, dsb=88.9090, bio=0.0165
    Epoch  5/10: total=87.0248, vae=1.0943, dsb=85.9249, bio=0.0112
    Epoch  6/10: total=85.0551, vae=1.0927, dsb=83.9582, bio=0.0084
    Epoch  7/10: total=83.4215, vae=1.0916, dsb=82.3265, bio=0.0067
    Epoch  8/10: total=81.8536, vae=1.0929, dsb=80.7579, bio=0.0055
    Epoch  9/10: total=81.2740, vae=1.0911, dsb=80.1804, bio=0.0048
    Epoch 10/10: total=80.2194, vae=1.0919, dsb=79.1254, bio=0.0043

  [Backward Policy Training]
    Epoch  1/10: total=3.3692, vae=1.0922, dsb=2.2699, bio=0.0143
    Epoch  2/10: total=2.8443, vae=1.0915, dsb=1.7504, bio=0.0047
    Epoch  3/10: total=2.7035, vae=1.0900, dsb=1.6117, bio=0.0035
    Epoch  4/10: total=2.6016, vae=1.0898, dsb=1.5102, bio=0.0030
    Epoch  5/10: total=2.5989, vae=1.0903, dsb=1.5073, bio=0.0027
    Epoch  6/10: total=2.5674, vae=1.0910, dsb=1.4751, bio=0.0026
    Epoch  7/10: total=2.5190, vae=1.0896, dsb=1.4282, bio=0.0024
    Epoch  8/10: total=2.4892, vae=1.0892, dsb=1.3985, bio=0.0030
    Epoch  9/10: total=2.4958, vae=1.0887, dsb=1.4059, bio=0.0023
    Epoch 10/10: total=2.4814, vae=1.0888, dsb=1.3915, bio=0.0022

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=71.3359, vae=1.0922, dsb=70.2414, bio=0.0047
    Epoch  2/10: total=64.6759, vae=1.0910, dsb=63.5837, bio=0.0024
    Epoch  3/10: total=62.9994, vae=1.0912, dsb=61.9070, bio=0.0023
    Epoch  4/10: total=62.4670, vae=1.0901, dsb=61.3758, bio=0.0023
    Epoch  5/10: total=61.7381, vae=1.0908, dsb=60.6459, bio=0.0029
    Epoch  6/10: total=61.2049, vae=1.0908, dsb=60.1131, bio=0.0022
    Epoch  7/10: total=60.8645, vae=1.0898, dsb=59.7736, bio=0.0022
    Epoch  8/10: total=60.5203, vae=1.0908, dsb=59.4283, bio=0.0022
    Epoch  9/10: total=60.1972, vae=1.0899, dsb=59.1061, bio=0.0023
    Epoch 10/10: total=60.0456, vae=1.0900, dsb=58.9545, bio=0.0023

  [Backward Policy Training]
    Epoch  1/10: total=2.1972, vae=1.0901, dsb=1.1039, bio=0.0064
    Epoch  2/10: total=2.0886, vae=1.0895, dsb=0.9979, bio=0.0023
    Epoch  3/10: total=2.0497, vae=1.0891, dsb=0.9595, bio=0.0021
    Epoch  4/10: total=2.0131, vae=1.0882, dsb=0.9239, bio=0.0020
    Epoch  5/10: total=2.0254, vae=1.0891, dsb=0.9354, bio=0.0019
    Epoch  6/10: total=2.0016, vae=1.0890, dsb=0.9116, bio=0.0021
    Epoch  7/10: total=2.0024, vae=1.0887, dsb=0.9127, bio=0.0020
    Epoch  8/10: total=1.9948, vae=1.0883, dsb=0.9055, bio=0.0019
    Epoch  9/10: total=1.9709, vae=1.0878, dsb=0.8821, bio=0.0020
    Epoch 10/10: total=1.9827, vae=1.0882, dsb=0.8935, bio=0.0019

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=54.3257, vae=1.0926, dsb=53.2306, bio=0.0050
    Epoch  2/10: total=51.8960, vae=1.0901, dsb=50.8049, bio=0.0021
    Epoch  3/10: total=51.0265, vae=1.0889, dsb=49.9365, bio=0.0021
    Epoch  4/10: total=50.5783, vae=1.0896, dsb=49.4875, bio=0.0025
    Epoch  5/10: total=50.3814, vae=1.0892, dsb=49.2912, bio=0.0020
    Epoch  6/10: total=50.3298, vae=1.0891, dsb=49.2396, bio=0.0020
    Epoch  7/10: total=49.9917, vae=1.0894, dsb=48.9013, bio=0.0021
    Epoch  8/10: total=50.3058, vae=1.0891, dsb=49.2157, bio=0.0021
    Epoch  9/10: total=50.1310, vae=1.0896, dsb=49.0403, bio=0.0022
    Epoch 10/10: total=49.9115, vae=1.0895, dsb=48.8210, bio=0.0021

  [Backward Policy Training]
    Epoch  1/10: total=1.8889, vae=1.0895, dsb=0.7951, bio=0.0088
    Epoch  2/10: total=1.8442, vae=1.0880, dsb=0.7552, bio=0.0021
    Epoch  3/10: total=1.8037, vae=1.0884, dsb=0.7144, bio=0.0019
    Epoch  4/10: total=1.8034, vae=1.0877, dsb=0.7148, bio=0.0018
    Epoch  5/10: total=1.7555, vae=1.0882, dsb=0.6662, bio=0.0022
    Epoch  6/10: total=1.7975, vae=1.0887, dsb=0.7079, bio=0.0018
    Epoch  7/10: total=1.7380, vae=1.0877, dsb=0.6494, bio=0.0017
    Epoch  8/10: total=1.7713, vae=1.0879, dsb=0.6825, bio=0.0017
    Epoch  9/10: total=1.7551, vae=1.0873, dsb=0.6669, bio=0.0017
    Epoch 10/10: total=1.7774, vae=1.0881, dsb=0.6884, bio=0.0017

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=45.3153, vae=1.0904, dsb=44.2232, bio=0.0034
    Epoch  2/10: total=44.2493, vae=1.0894, dsb=43.1590, bio=0.0019
    Epoch  3/10: total=43.8261, vae=1.0890, dsb=42.7360, bio=0.0023
    Epoch  4/10: total=43.8700, vae=1.0892, dsb=42.7799, bio=0.0019
    Epoch  5/10: total=43.7443, vae=1.0889, dsb=42.6545, bio=0.0019
    Epoch  6/10: total=43.7154, vae=1.0889, dsb=42.6255, bio=0.0019
    Epoch  7/10: total=43.6621, vae=1.0894, dsb=42.5716, bio=0.0020
    Epoch  8/10: total=43.5784, vae=1.0888, dsb=42.4887, bio=0.0020
    Epoch  9/10: total=43.5630, vae=1.0881, dsb=42.4740, bio=0.0019
    Epoch 10/10: total=43.4715, vae=1.0889, dsb=42.3817, bio=0.0018

  [Backward Policy Training]
    Epoch  1/10: total=1.7011, vae=1.0895, dsb=0.5991, bio=0.0252
    Epoch  2/10: total=1.6493, vae=1.0878, dsb=0.5606, bio=0.0019
    Epoch  3/10: total=1.6468, vae=1.0875, dsb=0.5585, bio=0.0017
    Epoch  4/10: total=1.6363, vae=1.0881, dsb=0.5474, bio=0.0017
    Epoch  5/10: total=1.6336, vae=1.0885, dsb=0.5443, bio=0.0017
    Epoch  6/10: total=1.6236, vae=1.0882, dsb=0.5345, bio=0.0016
    Epoch  7/10: total=1.6274, vae=1.0877, dsb=0.5390, bio=0.0016
    Epoch  8/10: total=1.6228, vae=1.0875, dsb=0.5345, bio=0.0016
    Epoch  9/10: total=1.6262, vae=1.0878, dsb=0.5374, bio=0.0021
    Epoch 10/10: total=1.6362, vae=1.0873, dsb=0.5481, bio=0.0015

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=36.4916, vae=1.0897, dsb=35.4003, bio=0.0031
    Epoch  2/10: total=36.0242, vae=1.0890, dsb=34.9344, bio=0.0017
    Epoch  3/10: total=35.8228, vae=1.0889, dsb=34.7331, bio=0.0017
    Epoch  4/10: total=35.8209, vae=1.0884, dsb=34.7316, bio=0.0017
    Epoch  5/10: total=35.9234, vae=1.0891, dsb=34.8333, bio=0.0020
    Epoch  6/10: total=35.6973, vae=1.0883, dsb=34.6081, bio=0.0018
    Epoch  7/10: total=35.7058, vae=1.0886, dsb=34.6163, bio=0.0017
    Epoch  8/10: total=35.8258, vae=1.0881, dsb=34.7368, bio=0.0017
    Epoch  9/10: total=35.7478, vae=1.0882, dsb=34.6587, bio=0.0020
    Epoch 10/10: total=35.8027, vae=1.0878, dsb=34.7140, bio=0.0019

  [Backward Policy Training]
    Epoch  1/10: total=1.6135, vae=1.0886, dsb=0.5011, bio=0.0477
    Epoch  2/10: total=1.5690, vae=1.0878, dsb=0.4804, bio=0.0017
    Epoch  3/10: total=1.5644, vae=1.0879, dsb=0.4758, bio=0.0015
    Epoch  4/10: total=1.5743, vae=1.0871, dsb=0.4864, bio=0.0015
    Epoch  5/10: total=1.5611, vae=1.0872, dsb=0.4731, bio=0.0016
    Epoch  6/10: total=1.5689, vae=1.0873, dsb=0.4809, bio=0.0014
    Epoch  7/10: total=1.5738, vae=1.0883, dsb=0.4849, bio=0.0014
    Epoch  8/10: total=1.5778, vae=1.0880, dsb=0.4891, bio=0.0014
    Epoch  9/10: total=1.5567, vae=1.0879, dsb=0.4681, bio=0.0014
    Epoch 10/10: total=1.5728, vae=1.0876, dsb=0.4842, bio=0.0018

[Seed 68] Joint training (original) complete; models and history saved.

[Seed 68] Starting joint training (ablation)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=340.4044, vae=1.9760, dsb=338.4283, bio=0.0000
    Epoch  2/10: total=105.6067, vae=1.0835, dsb=104.5232, bio=0.0000
    Epoch  3/10: total=94.8439, vae=1.0831, dsb=93.7608, bio=0.0000
    Epoch  4/10: total=89.5680, vae=1.0810, dsb=88.4870, bio=0.0000
    Epoch  5/10: total=86.6016, vae=1.0812, dsb=85.5204, bio=0.0000
    Epoch  6/10: total=84.6488, vae=1.0799, dsb=83.5689, bio=0.0000
    Epoch  7/10: total=83.0475, vae=1.0792, dsb=81.9684, bio=0.0000
    Epoch  8/10: total=81.5743, vae=1.0807, dsb=80.4936, bio=0.0000
    Epoch  9/10: total=81.0234, vae=1.0793, dsb=79.9441, bio=0.0000
    Epoch 10/10: total=80.0193, vae=1.0804, dsb=78.9390, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=3.2410, vae=1.0797, dsb=2.1613, bio=0.0000
    Epoch  2/10: total=2.7383, vae=1.0806, dsb=1.6578, bio=0.0000
    Epoch  3/10: total=2.6062, vae=1.0795, dsb=1.5266, bio=0.0000
    Epoch  4/10: total=2.5119, vae=1.0796, dsb=1.4323, bio=0.0000
    Epoch  5/10: total=2.5137, vae=1.0802, dsb=1.4334, bio=0.0000
    Epoch  6/10: total=2.4866, vae=1.0811, dsb=1.4055, bio=0.0000
    Epoch  7/10: total=2.4420, vae=1.0799, dsb=1.3621, bio=0.0000
    Epoch  8/10: total=2.4151, vae=1.0795, dsb=1.3356, bio=0.0000
    Epoch  9/10: total=2.4215, vae=1.0791, dsb=1.3424, bio=0.0000
    Epoch 10/10: total=2.4070, vae=1.0793, dsb=1.3277, bio=0.0000

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=71.3852, vae=1.0794, dsb=70.3058, bio=0.0000
    Epoch  2/10: total=65.2149, vae=1.0800, dsb=64.1349, bio=0.0000
    Epoch  3/10: total=63.6247, vae=1.0803, dsb=62.5444, bio=0.0000
    Epoch  4/10: total=63.2094, vae=1.0793, dsb=62.1301, bio=0.0000
    Epoch  5/10: total=62.5715, vae=1.0799, dsb=61.4916, bio=0.0000
    Epoch  6/10: total=62.1479, vae=1.0803, dsb=61.0676, bio=0.0000
    Epoch  7/10: total=61.8520, vae=1.0794, dsb=60.7726, bio=0.0000
    Epoch  8/10: total=61.5323, vae=1.0804, dsb=60.4519, bio=0.0000
    Epoch  9/10: total=61.2004, vae=1.0796, dsb=60.1208, bio=0.0000
    Epoch 10/10: total=61.0772, vae=1.0798, dsb=59.9974, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=2.1306, vae=1.0795, dsb=1.0511, bio=0.0000
    Epoch  2/10: total=2.0356, vae=1.0803, dsb=0.9553, bio=0.0000
    Epoch  3/10: total=1.9981, vae=1.0800, dsb=0.9181, bio=0.0000
    Epoch  4/10: total=1.9625, vae=1.0792, dsb=0.8833, bio=0.0000
    Epoch  5/10: total=1.9762, vae=1.0801, dsb=0.8961, bio=0.0000
    Epoch  6/10: total=1.9528, vae=1.0802, dsb=0.8726, bio=0.0000
    Epoch  7/10: total=1.9533, vae=1.0799, dsb=0.8735, bio=0.0000
    Epoch  8/10: total=1.9461, vae=1.0796, dsb=0.8665, bio=0.0000
    Epoch  9/10: total=1.9229, vae=1.0790, dsb=0.8440, bio=0.0000
    Epoch 10/10: total=1.9346, vae=1.0795, dsb=0.8551, bio=0.0000

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=57.6044, vae=1.0802, dsb=56.5242, bio=0.0000
    Epoch  2/10: total=55.4397, vae=1.0798, dsb=54.3599, bio=0.0000
    Epoch  3/10: total=54.6160, vae=1.0788, dsb=53.5372, bio=0.0000
    Epoch  4/10: total=54.1529, vae=1.0797, dsb=53.0732, bio=0.0000
    Epoch  5/10: total=54.0210, vae=1.0794, dsb=52.9416, bio=0.0000
    Epoch  6/10: total=53.9920, vae=1.0795, dsb=52.9126, bio=0.0000
    Epoch  7/10: total=53.6866, vae=1.0798, dsb=52.6068, bio=0.0000
    Epoch  8/10: total=53.9447, vae=1.0795, dsb=52.8652, bio=0.0000
    Epoch  9/10: total=53.8294, vae=1.0801, dsb=52.7493, bio=0.0000
    Epoch 10/10: total=53.6250, vae=1.0800, dsb=52.5450, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.8343, vae=1.0797, dsb=0.7547, bio=0.0000
    Epoch  2/10: total=1.7986, vae=1.0793, dsb=0.7193, bio=0.0000
    Epoch  3/10: total=1.7616, vae=1.0798, dsb=0.6818, bio=0.0000
    Epoch  4/10: total=1.7624, vae=1.0792, dsb=0.6832, bio=0.0000
    Epoch  5/10: total=1.7164, vae=1.0797, dsb=0.6367, bio=0.0000
    Epoch  6/10: total=1.7593, vae=1.0803, dsb=0.6790, bio=0.0000
    Epoch  7/10: total=1.7010, vae=1.0793, dsb=0.6217, bio=0.0000
    Epoch  8/10: total=1.7351, vae=1.0795, dsb=0.6556, bio=0.0000
    Epoch  9/10: total=1.7191, vae=1.0790, dsb=0.6401, bio=0.0000
    Epoch 10/10: total=1.7416, vae=1.0798, dsb=0.6618, bio=0.0000

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=48.2160, vae=1.0793, dsb=47.1367, bio=0.0000
    Epoch  2/10: total=47.3623, vae=1.0795, dsb=46.2827, bio=0.0000
    Epoch  3/10: total=47.0251, vae=1.0795, dsb=45.9456, bio=0.0000
    Epoch  4/10: total=47.1086, vae=1.0798, dsb=46.0288, bio=0.0000
    Epoch  5/10: total=47.0141, vae=1.0797, dsb=45.9344, bio=0.0000
    Epoch  6/10: total=47.0214, vae=1.0798, dsb=45.9416, bio=0.0000
    Epoch  7/10: total=46.9735, vae=1.0804, dsb=45.8931, bio=0.0000
    Epoch  8/10: total=46.8735, vae=1.0797, dsb=45.7937, bio=0.0000
    Epoch  9/10: total=46.8779, vae=1.0792, dsb=45.7987, bio=0.0000
    Epoch 10/10: total=46.7739, vae=1.0800, dsb=45.6939, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.6392, vae=1.0801, dsb=0.5592, bio=0.0000
    Epoch  2/10: total=1.6060, vae=1.0795, dsb=0.5265, bio=0.0000
    Epoch  3/10: total=1.6051, vae=1.0791, dsb=0.5259, bio=0.0000
    Epoch  4/10: total=1.5955, vae=1.0799, dsb=0.5156, bio=0.0000
    Epoch  5/10: total=1.5929, vae=1.0804, dsb=0.5126, bio=0.0000
    Epoch  6/10: total=1.5844, vae=1.0801, dsb=0.5043, bio=0.0000
    Epoch  7/10: total=1.5886, vae=1.0796, dsb=0.5090, bio=0.0000
    Epoch  8/10: total=1.5848, vae=1.0794, dsb=0.5054, bio=0.0000
    Epoch  9/10: total=1.5879, vae=1.0798, dsb=0.5081, bio=0.0000
    Epoch 10/10: total=1.5979, vae=1.0793, dsb=0.5185, bio=0.0000

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=37.6663, vae=1.0789, dsb=36.5874, bio=0.0000
    Epoch  2/10: total=37.3415, vae=1.0794, dsb=36.2621, bio=0.0000
    Epoch  3/10: total=37.1806, vae=1.0795, dsb=36.1011, bio=0.0000
    Epoch  4/10: total=37.2089, vae=1.0793, dsb=36.1296, bio=0.0000
    Epoch  5/10: total=37.3334, vae=1.0800, dsb=36.2533, bio=0.0000
    Epoch  6/10: total=37.0723, vae=1.0795, dsb=35.9928, bio=0.0000
    Epoch  7/10: total=37.1218, vae=1.0799, dsb=36.0419, bio=0.0000
    Epoch  8/10: total=37.2466, vae=1.0795, dsb=36.1671, bio=0.0000
    Epoch  9/10: total=37.1658, vae=1.0796, dsb=36.0862, bio=0.0000
    Epoch 10/10: total=37.2664, vae=1.0792, dsb=36.1872, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.5532, vae=1.0796, dsb=0.4736, bio=0.0000
    Epoch  2/10: total=1.5369, vae=1.0797, dsb=0.4572, bio=0.0000
    Epoch  3/10: total=1.5336, vae=1.0798, dsb=0.4538, bio=0.0000
    Epoch  4/10: total=1.5441, vae=1.0791, dsb=0.4650, bio=0.0000
    Epoch  5/10: total=1.5318, vae=1.0793, dsb=0.4525, bio=0.0000
    Epoch  6/10: total=1.5401, vae=1.0795, dsb=0.4606, bio=0.0000
    Epoch  7/10: total=1.5452, vae=1.0805, dsb=0.4648, bio=0.0000
    Epoch  8/10: total=1.5495, vae=1.0802, dsb=0.4692, bio=0.0000
    Epoch  9/10: total=1.5286, vae=1.0801, dsb=0.4485, bio=0.0000
    Epoch 10/10: total=1.5448, vae=1.0798, dsb=0.4649, bio=0.0000

[Seed 68] Joint training (ablation) complete; models and history saved.

[Seed 68] Drift genes saved in /home/yyuan/ICB_TCE/iter_results/run_068

[Seed 68] run finished.

================================================================================
[Seed 69] Starting running whole pipeline...
================================================================================

[Seed 69] Starting VAE pre-training...

    Epoch [01/20], Beta: 0.000, Average Loss: 532.7824
    Epoch [02/20], Beta: 0.000, Average Loss: 309.8553
    Epoch [03/20], Beta: 0.000, Average Loss: 273.6747
    Epoch [04/20], Beta: 0.000, Average Loss: 252.6030
    Epoch [05/20], Beta: 0.100, Average Loss: 246.0856
    Epoch [06/20], Beta: 0.200, Average Loss: 244.5024
    Epoch [07/20], Beta: 0.300, Average Loss: 244.7473
    Epoch [08/20], Beta: 0.400, Average Loss: 245.7272
    Epoch [09/20], Beta: 0.500, Average Loss: 246.8961
    Epoch [10/20], Beta: 0.600, Average Loss: 248.1403
    Epoch [11/20], Beta: 0.700, Average Loss: 249.4061
    Epoch [12/20], Beta: 0.800, Average Loss: 250.6348
    Epoch [13/20], Beta: 0.900, Average Loss: 251.8684
    Epoch [14/20], Beta: 1.000, Average Loss: 253.5109
    Epoch [15/20], Beta: 1.000, Average Loss: 253.0613
    Epoch [16/20], Beta: 1.000, Average Loss: 252.6651
    Epoch [17/20], Beta: 1.000, Average Loss: 252.2616
    Epoch [18/20], Beta: 1.000, Average Loss: 251.9460
    Epoch [19/20], Beta: 1.000, Average Loss: 251.6251
    Epoch [20/20], Beta: 1.000, Average Loss: 251.4119

[Seed 69] VAE pre-training complete.

[Seed 69] Starting joint training (original)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=281.0181, vae=3.6270, dsb=256.4048, bio=41.9726
    Epoch  2/10: total=75.5668, vae=1.1085, dsb=74.4192, bio=0.0783
    Epoch  3/10: total=66.1803, vae=1.1031, dsb=65.0603, bio=0.0338
    Epoch  4/10: total=62.0110, vae=1.1012, dsb=60.8998, bio=0.0199
    Epoch  5/10: total=59.3989, vae=1.1001, dsb=58.2921, bio=0.0134
    Epoch  6/10: total=57.6289, vae=1.1000, dsb=56.5241, bio=0.0096
    Epoch  7/10: total=56.0717, vae=1.0993, dsb=54.9687, bio=0.0074
    Epoch  8/10: total=55.3170, vae=1.0982, dsb=54.2158, bio=0.0060
    Epoch  9/10: total=54.2046, vae=1.0995, dsb=53.1025, bio=0.0050
    Epoch 10/10: total=53.3843, vae=1.0990, dsb=52.2831, bio=0.0044

  [Backward Policy Training]
    Epoch  1/10: total=3.1502, vae=1.0987, dsb=2.0445, bio=0.0140
    Epoch  2/10: total=2.6720, vae=1.0973, dsb=1.5724, bio=0.0046
    Epoch  3/10: total=2.5596, vae=1.0970, dsb=1.4609, bio=0.0034
    Epoch  4/10: total=2.5070, vae=1.0975, dsb=1.4081, bio=0.0028
    Epoch  5/10: total=2.4724, vae=1.0955, dsb=1.3756, bio=0.0025
    Epoch  6/10: total=2.4026, vae=1.0963, dsb=1.3051, bio=0.0023
    Epoch  7/10: total=2.4021, vae=1.0958, dsb=1.3053, bio=0.0021
    Epoch  8/10: total=2.3732, vae=1.0960, dsb=1.2762, bio=0.0020
    Epoch  9/10: total=2.3888, vae=1.0954, dsb=1.2924, bio=0.0019
    Epoch 10/10: total=2.3439, vae=1.0958, dsb=1.2470, bio=0.0021

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=49.2699, vae=1.0984, dsb=48.1698, bio=0.0034
    Epoch  2/10: total=43.4133, vae=1.0965, dsb=42.3159, bio=0.0018
    Epoch  3/10: total=41.9304, vae=1.0962, dsb=40.8333, bio=0.0018
    Epoch  4/10: total=41.2484, vae=1.0971, dsb=40.1505, bio=0.0017
    Epoch  5/10: total=40.6146, vae=1.0964, dsb=39.5173, bio=0.0017
    Epoch  6/10: total=40.2620, vae=1.0963, dsb=39.1649, bio=0.0017
    Epoch  7/10: total=40.0764, vae=1.0964, dsb=38.9791, bio=0.0017
    Epoch  8/10: total=39.8766, vae=1.0960, dsb=38.7799, bio=0.0015
    Epoch  9/10: total=39.7129, vae=1.0960, dsb=38.6160, bio=0.0018
    Epoch 10/10: total=39.4497, vae=1.0952, dsb=38.3537, bio=0.0016

  [Backward Policy Training]
    Epoch  1/10: total=2.1086, vae=1.0966, dsb=1.0089, bio=0.0061
    Epoch  2/10: total=1.9767, vae=1.0951, dsb=0.8807, bio=0.0017
    Epoch  3/10: total=1.9501, vae=1.0951, dsb=0.8542, bio=0.0016
    Epoch  4/10: total=1.9012, vae=1.0946, dsb=0.8059, bio=0.0015
    Epoch  5/10: total=1.8928, vae=1.0955, dsb=0.7966, bio=0.0015
    Epoch  6/10: total=1.9018, vae=1.0946, dsb=0.8066, bio=0.0014
    Epoch  7/10: total=1.8896, vae=1.0941, dsb=0.7948, bio=0.0014
    Epoch  8/10: total=1.8381, vae=1.0948, dsb=0.7425, bio=0.0015
    Epoch  9/10: total=1.8576, vae=1.0943, dsb=0.7626, bio=0.0014
    Epoch 10/10: total=1.8621, vae=1.0936, dsb=0.7678, bio=0.0014

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=37.9725, vae=1.0972, dsb=36.8739, bio=0.0028
    Epoch  2/10: total=35.4318, vae=1.0957, dsb=34.3354, bio=0.0015
    Epoch  3/10: total=34.7365, vae=1.0954, dsb=33.6403, bio=0.0015
    Epoch  4/10: total=34.2543, vae=1.0953, dsb=33.1583, bio=0.0014
    Epoch  5/10: total=34.3024, vae=1.0956, dsb=33.2061, bio=0.0014
    Epoch  6/10: total=34.2197, vae=1.0954, dsb=33.1235, bio=0.0016
    Epoch  7/10: total=34.0404, vae=1.0955, dsb=32.9442, bio=0.0014
    Epoch  8/10: total=33.6306, vae=1.0947, dsb=32.5353, bio=0.0013
    Epoch  9/10: total=33.5495, vae=1.0948, dsb=32.4541, bio=0.0013
    Epoch 10/10: total=33.6596, vae=1.0943, dsb=32.5646, bio=0.0013

  [Backward Policy Training]
    Epoch  1/10: total=1.7775, vae=1.0951, dsb=0.6537, bio=0.0574
    Epoch  2/10: total=1.6977, vae=1.0944, dsb=0.6026, bio=0.0014
    Epoch  3/10: total=1.6820, vae=1.0946, dsb=0.5867, bio=0.0013
    Epoch  4/10: total=1.6577, vae=1.0943, dsb=0.5628, bio=0.0013
    Epoch  5/10: total=1.6566, vae=1.0940, dsb=0.5619, bio=0.0012
    Epoch  6/10: total=1.6580, vae=1.0939, dsb=0.5636, bio=0.0012
    Epoch  7/10: total=1.6408, vae=1.0936, dsb=0.5465, bio=0.0012
    Epoch  8/10: total=1.6335, vae=1.0932, dsb=0.5397, bio=0.0012
    Epoch  9/10: total=1.6326, vae=1.0931, dsb=0.5388, bio=0.0013
    Epoch 10/10: total=1.6254, vae=1.0935, dsb=0.5314, bio=0.0011

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=29.2911, vae=1.0964, dsb=28.1926, bio=0.0040
    Epoch  2/10: total=28.0368, vae=1.0950, dsb=26.9412, bio=0.0012
    Epoch  3/10: total=28.0995, vae=1.0950, dsb=27.0038, bio=0.0012
    Epoch  4/10: total=27.9984, vae=1.0949, dsb=26.9029, bio=0.0012
    Epoch  5/10: total=27.8265, vae=1.0941, dsb=26.7318, bio=0.0012
    Epoch  6/10: total=27.6923, vae=1.0939, dsb=26.5978, bio=0.0012
    Epoch  7/10: total=27.6564, vae=1.0935, dsb=26.5624, bio=0.0011
    Epoch  8/10: total=27.6297, vae=1.0944, dsb=26.5347, bio=0.0012
    Epoch  9/10: total=27.6888, vae=1.0942, dsb=26.5940, bio=0.0011
    Epoch 10/10: total=27.5810, vae=1.0944, dsb=26.4860, bio=0.0011

  [Backward Policy Training]
    Epoch  1/10: total=1.6065, vae=1.0950, dsb=0.4716, bio=0.0797
    Epoch  2/10: total=1.5490, vae=1.0940, dsb=0.4544, bio=0.0013
    Epoch  3/10: total=1.5176, vae=1.0942, dsb=0.4229, bio=0.0011
    Epoch  4/10: total=1.5332, vae=1.0943, dsb=0.4384, bio=0.0011
    Epoch  5/10: total=1.5150, vae=1.0930, dsb=0.4214, bio=0.0011
    Epoch  6/10: total=1.5201, vae=1.0939, dsb=0.4257, bio=0.0010
    Epoch  7/10: total=1.5131, vae=1.0931, dsb=0.4194, bio=0.0010
    Epoch  8/10: total=1.4930, vae=1.0931, dsb=0.3995, bio=0.0010
    Epoch  9/10: total=1.5138, vae=1.0915, dsb=0.4218, bio=0.0010
    Epoch 10/10: total=1.5034, vae=1.0922, dsb=0.4108, bio=0.0010

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=24.5664, vae=1.0959, dsb=23.4683, bio=0.0044
    Epoch  2/10: total=24.3055, vae=1.0946, dsb=23.2103, bio=0.0011
    Epoch  3/10: total=24.3163, vae=1.0943, dsb=23.2214, bio=0.0011
    Epoch  4/10: total=24.1577, vae=1.0947, dsb=23.0626, bio=0.0010
    Epoch  5/10: total=24.1551, vae=1.0935, dsb=23.0614, bio=0.0005
    Epoch  6/10: total=24.0945, vae=1.0937, dsb=23.0003, bio=0.0010
    Epoch  7/10: total=24.0760, vae=1.0941, dsb=22.9814, bio=0.0012
    Epoch  8/10: total=24.1482, vae=1.0937, dsb=23.0539, bio=0.0011
    Epoch  9/10: total=24.0192, vae=1.0940, dsb=22.9246, bio=0.0010
    Epoch 10/10: total=24.1358, vae=1.0934, dsb=23.0419, bio=0.0010

  [Backward Policy Training]
    Epoch  1/10: total=1.5261, vae=1.0946, dsb=0.3555, bio=0.1519
    Epoch  2/10: total=1.4307, vae=1.0936, dsb=0.3367, bio=0.0007
    Epoch  3/10: total=1.4352, vae=1.0932, dsb=0.3414, bio=0.0012
    Epoch  4/10: total=1.4241, vae=1.0925, dsb=0.3311, bio=0.0010
    Epoch  5/10: total=1.4286, vae=1.0928, dsb=0.3353, bio=0.0010
    Epoch  6/10: total=1.4295, vae=1.0927, dsb=0.3365, bio=0.0006
    Epoch  7/10: total=1.4287, vae=1.0919, dsb=0.3362, bio=0.0010
    Epoch  8/10: total=1.4303, vae=1.0931, dsb=0.3368, bio=0.0009
    Epoch  9/10: total=1.4330, vae=1.0932, dsb=0.3394, bio=0.0008
    Epoch 10/10: total=1.4273, vae=1.0924, dsb=0.3344, bio=0.0010

[Seed 69] Joint training (original) complete; models and history saved.

[Seed 69] Starting joint training (ablation)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=257.9116, vae=2.0175, dsb=255.8940, bio=0.0000
    Epoch  2/10: total=75.0804, vae=1.0898, dsb=73.9906, bio=0.0000
    Epoch  3/10: total=65.6850, vae=1.0881, dsb=64.5970, bio=0.0000
    Epoch  4/10: total=61.4653, vae=1.0876, dsb=60.3777, bio=0.0000
    Epoch  5/10: total=58.8472, vae=1.0870, dsb=57.7601, bio=0.0000
    Epoch  6/10: total=57.1650, vae=1.0873, dsb=56.0777, bio=0.0000
    Epoch  7/10: total=55.6388, vae=1.0869, dsb=54.5519, bio=0.0000
    Epoch  8/10: total=54.8947, vae=1.0861, dsb=53.8085, bio=0.0000
    Epoch  9/10: total=53.8348, vae=1.0877, dsb=52.7471, bio=0.0000
    Epoch 10/10: total=53.0197, vae=1.0874, dsb=51.9322, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=3.0254, vae=1.0863, dsb=1.9390, bio=0.0000
    Epoch  2/10: total=2.5598, vae=1.0864, dsb=1.4734, bio=0.0000
    Epoch  3/10: total=2.4535, vae=1.0866, dsb=1.3669, bio=0.0000
    Epoch  4/10: total=2.4069, vae=1.0874, dsb=1.3195, bio=0.0000
    Epoch  5/10: total=2.3776, vae=1.0856, dsb=1.2920, bio=0.0000
    Epoch  6/10: total=2.3138, vae=1.0865, dsb=1.2272, bio=0.0000
    Epoch  7/10: total=2.3149, vae=1.0861, dsb=1.2288, bio=0.0000
    Epoch  8/10: total=2.2877, vae=1.0864, dsb=1.2013, bio=0.0000
    Epoch  9/10: total=2.3032, vae=1.0859, dsb=1.2174, bio=0.0000
    Epoch 10/10: total=2.2604, vae=1.0862, dsb=1.1742, bio=0.0000

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=48.2459, vae=1.0862, dsb=47.1598, bio=0.0000
    Epoch  2/10: total=42.5309, vae=1.0856, dsb=41.4453, bio=0.0000
    Epoch  3/10: total=41.1945, vae=1.0856, dsb=40.1089, bio=0.0000
    Epoch  4/10: total=40.5522, vae=1.0867, dsb=39.4656, bio=0.0000
    Epoch  5/10: total=39.9397, vae=1.0861, dsb=38.8535, bio=0.0000
    Epoch  6/10: total=39.6418, vae=1.0861, dsb=38.5558, bio=0.0000
    Epoch  7/10: total=39.4809, vae=1.0864, dsb=38.3945, bio=0.0000
    Epoch  8/10: total=39.3004, vae=1.0860, dsb=38.2144, bio=0.0000
    Epoch  9/10: total=39.1597, vae=1.0861, dsb=38.0737, bio=0.0000
    Epoch 10/10: total=38.8620, vae=1.0856, dsb=37.7764, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=2.0218, vae=1.0863, dsb=0.9355, bio=0.0000
    Epoch  2/10: total=1.9079, vae=1.0862, dsb=0.8218, bio=0.0000
    Epoch  3/10: total=1.8847, vae=1.0862, dsb=0.7984, bio=0.0000
    Epoch  4/10: total=1.8410, vae=1.0859, dsb=0.7551, bio=0.0000
    Epoch  5/10: total=1.8345, vae=1.0868, dsb=0.7476, bio=0.0000
    Epoch  6/10: total=1.8428, vae=1.0860, dsb=0.7568, bio=0.0000
    Epoch  7/10: total=1.8325, vae=1.0856, dsb=0.7470, bio=0.0000
    Epoch  8/10: total=1.7841, vae=1.0863, dsb=0.6978, bio=0.0000
    Epoch  9/10: total=1.8034, vae=1.0860, dsb=0.7174, bio=0.0000
    Epoch 10/10: total=1.8087, vae=1.0854, dsb=0.7233, bio=0.0000

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=37.0189, vae=1.0862, dsb=35.9327, bio=0.0000
    Epoch  2/10: total=34.7968, vae=1.0861, dsb=33.7107, bio=0.0000
    Epoch  3/10: total=34.1777, vae=1.0860, dsb=33.0917, bio=0.0000
    Epoch  4/10: total=33.7356, vae=1.0860, dsb=32.6496, bio=0.0000
    Epoch  5/10: total=33.8345, vae=1.0865, dsb=32.7480, bio=0.0000
    Epoch  6/10: total=33.7922, vae=1.0863, dsb=32.7058, bio=0.0000
    Epoch  7/10: total=33.6387, vae=1.0866, dsb=32.5521, bio=0.0000
    Epoch  8/10: total=33.2345, vae=1.0858, dsb=32.1486, bio=0.0000
    Epoch  9/10: total=33.1493, vae=1.0861, dsb=32.0632, bio=0.0000
    Epoch 10/10: total=33.2871, vae=1.0857, dsb=32.2013, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.6910, vae=1.0857, dsb=0.6053, bio=0.0000
    Epoch  2/10: total=1.6470, vae=1.0862, dsb=0.5608, bio=0.0000
    Epoch  3/10: total=1.6344, vae=1.0864, dsb=0.5480, bio=0.0000
    Epoch  4/10: total=1.6124, vae=1.0863, dsb=0.5261, bio=0.0000
    Epoch  5/10: total=1.6121, vae=1.0861, dsb=0.5260, bio=0.0000
    Epoch  6/10: total=1.6141, vae=1.0860, dsb=0.5281, bio=0.0000
    Epoch  7/10: total=1.5980, vae=1.0859, dsb=0.5120, bio=0.0000
    Epoch  8/10: total=1.5913, vae=1.0856, dsb=0.5057, bio=0.0000
    Epoch  9/10: total=1.5899, vae=1.0856, dsb=0.5043, bio=0.0000
    Epoch 10/10: total=1.5833, vae=1.0861, dsb=0.4972, bio=0.0000

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=29.4653, vae=1.0861, dsb=28.3792, bio=0.0000
    Epoch  2/10: total=28.3295, vae=1.0859, dsb=27.2436, bio=0.0000
    Epoch  3/10: total=28.4525, vae=1.0861, dsb=27.3664, bio=0.0000
    Epoch  4/10: total=28.3500, vae=1.0861, dsb=27.2639, bio=0.0000
    Epoch  5/10: total=28.1769, vae=1.0853, dsb=27.0915, bio=0.0000
    Epoch  6/10: total=28.0639, vae=1.0853, dsb=26.9786, bio=0.0000
    Epoch  7/10: total=27.9928, vae=1.0850, dsb=26.9078, bio=0.0000
    Epoch  8/10: total=28.0092, vae=1.0863, dsb=26.9229, bio=0.0000
    Epoch  9/10: total=28.0927, vae=1.0860, dsb=27.0066, bio=0.0000
    Epoch 10/10: total=27.9566, vae=1.0863, dsb=26.8704, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.5282, vae=1.0859, dsb=0.4423, bio=0.0000
    Epoch  2/10: total=1.5142, vae=1.0860, dsb=0.4281, bio=0.0000
    Epoch  3/10: total=1.4851, vae=1.0866, dsb=0.3986, bio=0.0000
    Epoch  4/10: total=1.5008, vae=1.0868, dsb=0.4140, bio=0.0000
    Epoch  5/10: total=1.4841, vae=1.0856, dsb=0.3985, bio=0.0000
    Epoch  6/10: total=1.4899, vae=1.0866, dsb=0.4033, bio=0.0000
    Epoch  7/10: total=1.4834, vae=1.0859, dsb=0.3975, bio=0.0000
    Epoch  8/10: total=1.4645, vae=1.0860, dsb=0.3785, bio=0.0000
    Epoch  9/10: total=1.4848, vae=1.0845, dsb=0.4003, bio=0.0000
    Epoch 10/10: total=1.4753, vae=1.0852, dsb=0.3901, bio=0.0000

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=25.2319, vae=1.0859, dsb=24.1460, bio=0.0000
    Epoch  2/10: total=25.0334, vae=1.0859, dsb=23.9476, bio=0.0000
    Epoch  3/10: total=25.0545, vae=1.0858, dsb=23.9688, bio=0.0000
    Epoch  4/10: total=24.8764, vae=1.0862, dsb=23.7902, bio=0.0000
    Epoch  5/10: total=24.9082, vae=1.0853, dsb=23.8229, bio=0.0000
    Epoch  6/10: total=24.8568, vae=1.0857, dsb=23.7711, bio=0.0000
    Epoch  7/10: total=24.8327, vae=1.0862, dsb=23.7464, bio=0.0000
    Epoch  8/10: total=24.9260, vae=1.0859, dsb=23.8401, bio=0.0000
    Epoch  9/10: total=24.7865, vae=1.0863, dsb=23.7002, bio=0.0000
    Epoch 10/10: total=24.9027, vae=1.0857, dsb=23.8170, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.4245, vae=1.0858, dsb=0.3387, bio=0.0000
    Epoch  2/10: total=1.4080, vae=1.0861, dsb=0.3220, bio=0.0000
    Epoch  3/10: total=1.4130, vae=1.0862, dsb=0.3268, bio=0.0000
    Epoch  4/10: total=1.4029, vae=1.0856, dsb=0.3173, bio=0.0000
    Epoch  5/10: total=1.4077, vae=1.0859, dsb=0.3217, bio=0.0000
    Epoch  6/10: total=1.4091, vae=1.0858, dsb=0.3232, bio=0.0000
    Epoch  7/10: total=1.4087, vae=1.0853, dsb=0.3234, bio=0.0000
    Epoch  8/10: total=1.4104, vae=1.0864, dsb=0.3240, bio=0.0000
    Epoch  9/10: total=1.4135, vae=1.0865, dsb=0.3269, bio=0.0000
    Epoch 10/10: total=1.4080, vae=1.0860, dsb=0.3221, bio=0.0000

[Seed 69] Joint training (ablation) complete; models and history saved.

[Seed 69] Drift genes saved in /home/yyuan/ICB_TCE/iter_results/run_069

[Seed 69] run finished.

================================================================================
[Seed 70] Starting running whole pipeline...
================================================================================

[Seed 70] Starting VAE pre-training...

    Epoch [01/20], Beta: 0.000, Average Loss: 540.2377
    Epoch [02/20], Beta: 0.000, Average Loss: 306.0583
    Epoch [03/20], Beta: 0.000, Average Loss: 271.5853
    Epoch [04/20], Beta: 0.000, Average Loss: 252.1961
    Epoch [05/20], Beta: 0.100, Average Loss: 246.7613
    Epoch [06/20], Beta: 0.200, Average Loss: 245.1421
    Epoch [07/20], Beta: 0.300, Average Loss: 245.0156
    Epoch [08/20], Beta: 0.400, Average Loss: 245.7228
    Epoch [09/20], Beta: 0.500, Average Loss: 246.8003
    Epoch [10/20], Beta: 0.600, Average Loss: 248.0072
    Epoch [11/20], Beta: 0.700, Average Loss: 249.2987
    Epoch [12/20], Beta: 0.800, Average Loss: 250.5561
    Epoch [13/20], Beta: 0.900, Average Loss: 251.8469
    Epoch [14/20], Beta: 1.000, Average Loss: 253.0789
    Epoch [15/20], Beta: 1.000, Average Loss: 252.6754
    Epoch [16/20], Beta: 1.000, Average Loss: 252.2866
    Epoch [17/20], Beta: 1.000, Average Loss: 251.9479
    Epoch [18/20], Beta: 1.000, Average Loss: 251.6960
    Epoch [19/20], Beta: 1.000, Average Loss: 251.3867
    Epoch [20/20], Beta: 1.000, Average Loss: 251.0526

[Seed 70] VAE pre-training complete.

[Seed 70] Starting joint training (original)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=337.5472, vae=3.6714, dsb=320.9386, bio=25.8745
    Epoch  2/10: total=99.1873, vae=1.1075, dsb=98.0430, bio=0.0737
    Epoch  3/10: total=85.9158, vae=1.1044, dsb=84.7956, bio=0.0317
    Epoch  4/10: total=79.7928, vae=1.1015, dsb=78.6822, bio=0.0182
    Epoch  5/10: total=76.0695, vae=1.1014, dsb=74.9619, bio=0.0123
    Epoch  6/10: total=73.2519, vae=1.1012, dsb=72.1462, bio=0.0091
    Epoch  7/10: total=71.3195, vae=1.1016, dsb=70.2143, bio=0.0072
    Epoch  8/10: total=70.1137, vae=1.0995, dsb=69.0113, bio=0.0058
    Epoch  9/10: total=68.8811, vae=1.1003, dsb=67.7783, bio=0.0049
    Epoch 10/10: total=67.8861, vae=1.0999, dsb=66.7840, bio=0.0043

  [Backward Policy Training]
    Epoch  1/10: total=3.3994, vae=1.1009, dsb=2.2912, bio=0.0146
    Epoch  2/10: total=2.8819, vae=1.0992, dsb=1.7804, bio=0.0044
    Epoch  3/10: total=2.7123, vae=1.0987, dsb=1.6120, bio=0.0031
    Epoch  4/10: total=2.6423, vae=1.0991, dsb=1.5418, bio=0.0026
    Epoch  5/10: total=2.5701, vae=1.0978, dsb=1.4711, bio=0.0023
    Epoch  6/10: total=2.5620, vae=1.0978, dsb=1.4629, bio=0.0025
    Epoch  7/10: total=2.5073, vae=1.0978, dsb=1.4085, bio=0.0021
    Epoch  8/10: total=2.5013, vae=1.0973, dsb=1.4029, bio=0.0020
    Epoch  9/10: total=2.4676, vae=1.0983, dsb=1.3684, bio=0.0019
    Epoch 10/10: total=2.4587, vae=1.0972, dsb=1.3605, bio=0.0019

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=60.0010, vae=1.0999, dsb=58.8994, bio=0.0035
    Epoch  2/10: total=53.0093, vae=1.0990, dsb=51.9094, bio=0.0020
    Epoch  3/10: total=50.9649, vae=1.0984, dsb=49.8656, bio=0.0019
    Epoch  4/10: total=50.3718, vae=1.0983, dsb=49.2726, bio=0.0018
    Epoch  5/10: total=49.3778, vae=1.0980, dsb=48.2790, bio=0.0017
    Epoch  6/10: total=49.0935, vae=1.0975, dsb=47.9950, bio=0.0018
    Epoch  7/10: total=48.4835, vae=1.0974, dsb=47.3851, bio=0.0018
    Epoch  8/10: total=48.3567, vae=1.0972, dsb=47.2586, bio=0.0018
    Epoch  9/10: total=48.1538, vae=1.0970, dsb=47.0559, bio=0.0018
    Epoch 10/10: total=47.7477, vae=1.0970, dsb=46.6499, bio=0.0018

  [Backward Policy Training]
    Epoch  1/10: total=2.2544, vae=1.0981, dsb=1.1528, bio=0.0070
    Epoch  2/10: total=2.0911, vae=1.0966, dsb=0.9935, bio=0.0018
    Epoch  3/10: total=2.0785, vae=1.0969, dsb=0.9808, bio=0.0016
    Epoch  4/10: total=2.0280, vae=1.0969, dsb=0.9302, bio=0.0016
    Epoch  5/10: total=2.0448, vae=1.0970, dsb=0.9470, bio=0.0015
    Epoch  6/10: total=1.9832, vae=1.0960, dsb=0.8864, bio=0.0016
    Epoch  7/10: total=2.0197, vae=1.0951, dsb=0.9238, bio=0.0015
    Epoch  8/10: total=2.0058, vae=1.0959, dsb=0.9092, bio=0.0015
    Epoch  9/10: total=1.9912, vae=1.0956, dsb=0.8949, bio=0.0014
    Epoch 10/10: total=1.9734, vae=1.0959, dsb=0.8767, bio=0.0014

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=43.1056, vae=1.0989, dsb=42.0051, bio=0.0032
    Epoch  2/10: total=40.5633, vae=1.0970, dsb=39.4656, bio=0.0016
    Epoch  3/10: total=39.7477, vae=1.0964, dsb=38.6505, bio=0.0015
    Epoch  4/10: total=39.4470, vae=1.0963, dsb=38.3499, bio=0.0015
    Epoch  5/10: total=39.1616, vae=1.0970, dsb=38.0639, bio=0.0015
    Epoch  6/10: total=38.8143, vae=1.0968, dsb=37.7167, bio=0.0015
    Epoch  7/10: total=38.7360, vae=1.0961, dsb=37.6392, bio=0.0015
    Epoch  8/10: total=38.5787, vae=1.0970, dsb=37.4809, bio=0.0015
    Epoch  9/10: total=38.5899, vae=1.0970, dsb=37.4922, bio=0.0015
    Epoch 10/10: total=38.4362, vae=1.0963, dsb=37.3392, bio=0.0014

  [Backward Policy Training]
    Epoch  1/10: total=1.8780, vae=1.0967, dsb=0.7494, bio=0.0639
    Epoch  2/10: total=1.7802, vae=1.0952, dsb=0.6843, bio=0.0015
    Epoch  3/10: total=1.7711, vae=1.0952, dsb=0.6752, bio=0.0013
    Epoch  4/10: total=1.7777, vae=1.0957, dsb=0.6814, bio=0.0013
    Epoch  5/10: total=1.7499, vae=1.0954, dsb=0.6538, bio=0.0012
    Epoch  6/10: total=1.7395, vae=1.0954, dsb=0.6435, bio=0.0013
    Epoch  7/10: total=1.7316, vae=1.0956, dsb=0.6352, bio=0.0015
    Epoch  8/10: total=1.7258, vae=1.0947, dsb=0.6306, bio=0.0012
    Epoch  9/10: total=1.7291, vae=1.0958, dsb=0.6327, bio=0.0012
    Epoch 10/10: total=1.7411, vae=1.0953, dsb=0.6452, bio=0.0012

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=34.8535, vae=1.0990, dsb=33.7527, bio=0.0037
    Epoch  2/10: total=33.5152, vae=1.0966, dsb=32.4180, bio=0.0013
    Epoch  3/10: total=33.4292, vae=1.0965, dsb=32.3321, bio=0.0013
    Epoch  4/10: total=33.0636, vae=1.0963, dsb=31.9666, bio=0.0013
    Epoch  5/10: total=33.1515, vae=1.0964, dsb=32.0545, bio=0.0014
    Epoch  6/10: total=33.1067, vae=1.0958, dsb=32.0104, bio=0.0012
    Epoch  7/10: total=33.0709, vae=1.0953, dsb=31.9751, bio=0.0012
    Epoch  8/10: total=32.9746, vae=1.0959, dsb=31.8780, bio=0.0013
    Epoch  9/10: total=32.7886, vae=1.0957, dsb=31.6923, bio=0.0011
    Epoch 10/10: total=33.0218, vae=1.0952, dsb=31.9261, bio=0.0011

  [Backward Policy Training]
    Epoch  1/10: total=1.7086, vae=1.0967, dsb=0.5591, bio=0.1056
    Epoch  2/10: total=1.6391, vae=1.0957, dsb=0.5428, bio=0.0013
    Epoch  3/10: total=1.6124, vae=1.0952, dsb=0.5167, bio=0.0011
    Epoch  4/10: total=1.6105, vae=1.0953, dsb=0.5147, bio=0.0011
    Epoch  5/10: total=1.6158, vae=1.0951, dsb=0.5202, bio=0.0011
    Epoch  6/10: total=1.6143, vae=1.0948, dsb=0.5189, bio=0.0010
    Epoch  7/10: total=1.6043, vae=1.0941, dsb=0.5097, bio=0.0010
    Epoch  8/10: total=1.6082, vae=1.0946, dsb=0.5132, bio=0.0010
    Epoch  9/10: total=1.6071, vae=1.0936, dsb=0.5129, bio=0.0010
    Epoch 10/10: total=1.6122, vae=1.0949, dsb=0.5168, bio=0.0010

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=30.6361, vae=1.0974, dsb=29.5364, bio=0.0046
    Epoch  2/10: total=30.2180, vae=1.0967, dsb=29.1207, bio=0.0012
    Epoch  3/10: total=30.1922, vae=1.0959, dsb=29.0957, bio=0.0011
    Epoch  4/10: total=30.2210, vae=1.0958, dsb=29.1247, bio=0.0011
    Epoch  5/10: total=29.9538, vae=1.0956, dsb=28.8577, bio=0.0011
    Epoch  6/10: total=30.0613, vae=1.0957, dsb=28.9653, bio=0.0008
    Epoch  7/10: total=30.0373, vae=1.0951, dsb=28.9416, bio=0.0010
    Epoch  8/10: total=29.9632, vae=1.0944, dsb=28.8683, bio=0.0011
    Epoch  9/10: total=30.0121, vae=1.0954, dsb=28.9162, bio=0.0010
    Epoch 10/10: total=30.0723, vae=1.0959, dsb=28.9759, bio=0.0010

  [Backward Policy Training]
    Epoch  1/10: total=1.6331, vae=1.0969, dsb=0.4535, bio=0.1652
    Epoch  2/10: total=1.5668, vae=1.0942, dsb=0.4723, bio=0.0007
    Epoch  3/10: total=1.5564, vae=1.0951, dsb=0.4606, bio=0.0014
    Epoch  4/10: total=1.5535, vae=1.0951, dsb=0.4578, bio=0.0011
    Epoch  5/10: total=1.5405, vae=1.0939, dsb=0.4462, bio=0.0006
    Epoch  6/10: total=1.5563, vae=1.0944, dsb=0.4614, bio=0.0010
    Epoch  7/10: total=1.5497, vae=1.0933, dsb=0.4559, bio=0.0010
    Epoch  8/10: total=1.5464, vae=1.0928, dsb=0.4531, bio=0.0009
    Epoch  9/10: total=1.5337, vae=1.0938, dsb=0.4395, bio=0.0009
    Epoch 10/10: total=1.5450, vae=1.0940, dsb=0.4505, bio=0.0009

[Seed 70] Joint training (original) complete; models and history saved.

[Seed 70] Starting joint training (ablation)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=322.2550, vae=2.0070, dsb=320.2480, bio=0.0000
    Epoch  2/10: total=98.1902, vae=1.0909, dsb=97.0993, bio=0.0000
    Epoch  3/10: total=85.1075, vae=1.0905, dsb=84.0170, bio=0.0000
    Epoch  4/10: total=79.0597, vae=1.0885, dsb=77.9712, bio=0.0000
    Epoch  5/10: total=75.3798, vae=1.0887, dsb=74.2912, bio=0.0000
    Epoch  6/10: total=72.6839, vae=1.0887, dsb=71.5952, bio=0.0000
    Epoch  7/10: total=70.8721, vae=1.0894, dsb=69.7827, bio=0.0000
    Epoch  8/10: total=69.6686, vae=1.0875, dsb=68.5811, bio=0.0000
    Epoch  9/10: total=68.3906, vae=1.0886, dsb=67.3020, bio=0.0000
    Epoch 10/10: total=67.4090, vae=1.0885, dsb=66.3205, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=3.2966, vae=1.0880, dsb=2.2086, bio=0.0000
    Epoch  2/10: total=2.8006, vae=1.0883, dsb=1.7123, bio=0.0000
    Epoch  3/10: total=2.6385, vae=1.0882, dsb=1.5503, bio=0.0000
    Epoch  4/10: total=2.5741, vae=1.0889, dsb=1.4851, bio=0.0000
    Epoch  5/10: total=2.5060, vae=1.0878, dsb=1.4181, bio=0.0000
    Epoch  6/10: total=2.5000, vae=1.0880, dsb=1.4120, bio=0.0000
    Epoch  7/10: total=2.4480, vae=1.0881, dsb=1.3599, bio=0.0000
    Epoch  8/10: total=2.4428, vae=1.0878, dsb=1.3550, bio=0.0000
    Epoch  9/10: total=2.4090, vae=1.0888, dsb=1.3202, bio=0.0000
    Epoch 10/10: total=2.3992, vae=1.0878, dsb=1.3114, bio=0.0000

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=59.2444, vae=1.0878, dsb=58.1566, bio=0.0000
    Epoch  2/10: total=52.2138, vae=1.0882, dsb=51.1256, bio=0.0000
    Epoch  3/10: total=50.1259, vae=1.0879, dsb=49.0380, bio=0.0000
    Epoch  4/10: total=49.5666, vae=1.0880, dsb=48.4786, bio=0.0000
    Epoch  5/10: total=48.5881, vae=1.0878, dsb=47.5003, bio=0.0000
    Epoch  6/10: total=48.3841, vae=1.0875, dsb=47.2966, bio=0.0000
    Epoch  7/10: total=47.7658, vae=1.0876, dsb=46.6783, bio=0.0000
    Epoch  8/10: total=47.6605, vae=1.0875, dsb=46.5730, bio=0.0000
    Epoch  9/10: total=47.4815, vae=1.0873, dsb=46.3942, bio=0.0000
    Epoch 10/10: total=47.0915, vae=1.0874, dsb=46.0041, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=2.1774, vae=1.0880, dsb=1.0894, bio=0.0000
    Epoch  2/10: total=2.0249, vae=1.0877, dsb=0.9372, bio=0.0000
    Epoch  3/10: total=2.0129, vae=1.0881, dsb=0.9248, bio=0.0000
    Epoch  4/10: total=1.9648, vae=1.0882, dsb=0.8765, bio=0.0000
    Epoch  5/10: total=1.9817, vae=1.0885, dsb=0.8932, bio=0.0000
    Epoch  6/10: total=1.9237, vae=1.0874, dsb=0.8363, bio=0.0000
    Epoch  7/10: total=1.9603, vae=1.0868, dsb=0.8735, bio=0.0000
    Epoch  8/10: total=1.9480, vae=1.0877, dsb=0.8603, bio=0.0000
    Epoch  9/10: total=1.9350, vae=1.0873, dsb=0.8477, bio=0.0000
    Epoch 10/10: total=1.9175, vae=1.0878, dsb=0.8297, bio=0.0000

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=41.7699, vae=1.0874, dsb=40.6824, bio=0.0000
    Epoch  2/10: total=39.3532, vae=1.0874, dsb=38.2659, bio=0.0000
    Epoch  3/10: total=38.5715, vae=1.0871, dsb=37.4844, bio=0.0000
    Epoch  4/10: total=38.2572, vae=1.0872, dsb=37.1700, bio=0.0000
    Epoch  5/10: total=38.0334, vae=1.0879, dsb=36.9455, bio=0.0000
    Epoch  6/10: total=37.6963, vae=1.0879, dsb=36.6084, bio=0.0000
    Epoch  7/10: total=37.6742, vae=1.0873, dsb=36.5869, bio=0.0000
    Epoch  8/10: total=37.5225, vae=1.0883, dsb=36.4341, bio=0.0000
    Epoch  9/10: total=37.5025, vae=1.0884, dsb=36.4141, bio=0.0000
    Epoch 10/10: total=37.3728, vae=1.0878, dsb=36.2850, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.7995, vae=1.0874, dsb=0.7121, bio=0.0000
    Epoch  2/10: total=1.7382, vae=1.0871, dsb=0.6511, bio=0.0000
    Epoch  3/10: total=1.7298, vae=1.0872, dsb=0.6427, bio=0.0000
    Epoch  4/10: total=1.7364, vae=1.0878, dsb=0.6486, bio=0.0000
    Epoch  5/10: total=1.7098, vae=1.0877, dsb=0.6221, bio=0.0000
    Epoch  6/10: total=1.6997, vae=1.0876, dsb=0.6121, bio=0.0000
    Epoch  7/10: total=1.6917, vae=1.0880, dsb=0.6037, bio=0.0000
    Epoch  8/10: total=1.6870, vae=1.0871, dsb=0.5998, bio=0.0000
    Epoch  9/10: total=1.6908, vae=1.0884, dsb=0.6024, bio=0.0000
    Epoch 10/10: total=1.7022, vae=1.0879, dsb=0.6142, bio=0.0000

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=34.1017, vae=1.0881, dsb=33.0136, bio=0.0000
    Epoch  2/10: total=32.7885, vae=1.0875, dsb=31.7010, bio=0.0000
    Epoch  3/10: total=32.6855, vae=1.0876, dsb=31.5979, bio=0.0000
    Epoch  4/10: total=32.3168, vae=1.0875, dsb=31.2293, bio=0.0000
    Epoch  5/10: total=32.3962, vae=1.0878, dsb=31.3084, bio=0.0000
    Epoch  6/10: total=32.3321, vae=1.0874, dsb=31.2447, bio=0.0000
    Epoch  7/10: total=32.3103, vae=1.0870, dsb=31.2233, bio=0.0000
    Epoch  8/10: total=32.1845, vae=1.0877, dsb=31.0968, bio=0.0000
    Epoch  9/10: total=32.0201, vae=1.0878, dsb=30.9323, bio=0.0000
    Epoch 10/10: total=32.2483, vae=1.0872, dsb=31.1611, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.6181, vae=1.0878, dsb=0.5303, bio=0.0000
    Epoch  2/10: total=1.6010, vae=1.0880, dsb=0.5131, bio=0.0000
    Epoch  3/10: total=1.5753, vae=1.0877, dsb=0.4876, bio=0.0000
    Epoch  4/10: total=1.5734, vae=1.0879, dsb=0.4855, bio=0.0000
    Epoch  5/10: total=1.5785, vae=1.0878, dsb=0.4907, bio=0.0000
    Epoch  6/10: total=1.5770, vae=1.0877, dsb=0.4894, bio=0.0000
    Epoch  7/10: total=1.5675, vae=1.0871, dsb=0.4804, bio=0.0000
    Epoch  8/10: total=1.5713, vae=1.0876, dsb=0.4837, bio=0.0000
    Epoch  9/10: total=1.5697, vae=1.0867, dsb=0.4830, bio=0.0000
    Epoch 10/10: total=1.5751, vae=1.0881, dsb=0.4870, bio=0.0000

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=29.9905, vae=1.0875, dsb=28.9030, bio=0.0000
    Epoch  2/10: total=29.5468, vae=1.0880, dsb=28.4587, bio=0.0000
    Epoch  3/10: total=29.5339, vae=1.0874, dsb=28.4464, bio=0.0000
    Epoch  4/10: total=29.5275, vae=1.0876, dsb=28.4399, bio=0.0000
    Epoch  5/10: total=29.2641, vae=1.0876, dsb=28.1765, bio=0.0000
    Epoch  6/10: total=29.3580, vae=1.0877, dsb=28.2702, bio=0.0000
    Epoch  7/10: total=29.3491, vae=1.0874, dsb=28.2617, bio=0.0000
    Epoch  8/10: total=29.2678, vae=1.0867, dsb=28.1811, bio=0.0000
    Epoch  9/10: total=29.3110, vae=1.0878, dsb=28.2232, bio=0.0000
    Epoch 10/10: total=29.3628, vae=1.0884, dsb=28.2744, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.5129, vae=1.0882, dsb=0.4248, bio=0.0000
    Epoch  2/10: total=1.5285, vae=1.0869, dsb=0.4416, bio=0.0000
    Epoch  3/10: total=1.5184, vae=1.0882, dsb=0.4302, bio=0.0000
    Epoch  4/10: total=1.5155, vae=1.0884, dsb=0.4272, bio=0.0000
    Epoch  5/10: total=1.5034, vae=1.0871, dsb=0.4163, bio=0.0000
    Epoch  6/10: total=1.5186, vae=1.0878, dsb=0.4309, bio=0.0000
    Epoch  7/10: total=1.5121, vae=1.0867, dsb=0.4254, bio=0.0000
    Epoch  8/10: total=1.5091, vae=1.0862, dsb=0.4230, bio=0.0000
    Epoch  9/10: total=1.4969, vae=1.0873, dsb=0.4097, bio=0.0000
    Epoch 10/10: total=1.5077, vae=1.0876, dsb=0.4202, bio=0.0000

[Seed 70] Joint training (ablation) complete; models and history saved.

[Seed 70] Drift genes saved in /home/yyuan/ICB_TCE/iter_results/run_070

[Seed 70] run finished.

================================================================================
[Seed 71] Starting running whole pipeline...
================================================================================

[Seed 71] Starting VAE pre-training...

    Epoch [01/20], Beta: 0.000, Average Loss: 536.8441
    Epoch [02/20], Beta: 0.000, Average Loss: 306.1242
    Epoch [03/20], Beta: 0.000, Average Loss: 267.5481
    Epoch [04/20], Beta: 0.000, Average Loss: 247.0595
    Epoch [05/20], Beta: 0.100, Average Loss: 243.4260
    Epoch [06/20], Beta: 0.200, Average Loss: 243.2488
    Epoch [07/20], Beta: 0.300, Average Loss: 243.8454
    Epoch [08/20], Beta: 0.400, Average Loss: 244.8820
    Epoch [09/20], Beta: 0.500, Average Loss: 246.0771
    Epoch [10/20], Beta: 0.600, Average Loss: 247.3730
    Epoch [11/20], Beta: 0.700, Average Loss: 248.7143
    Epoch [12/20], Beta: 0.800, Average Loss: 250.0723
    Epoch [13/20], Beta: 0.900, Average Loss: 251.3861
    Epoch [14/20], Beta: 1.000, Average Loss: 253.0802
    Epoch [15/20], Beta: 1.000, Average Loss: 252.6670
    Epoch [16/20], Beta: 1.000, Average Loss: 252.2559
    Epoch [17/20], Beta: 1.000, Average Loss: 251.9722
    Epoch [18/20], Beta: 1.000, Average Loss: 251.6557
    Epoch [19/20], Beta: 1.000, Average Loss: 251.2877
    Epoch [20/20], Beta: 1.000, Average Loss: 251.1407

[Seed 71] VAE pre-training complete.

[Seed 71] Starting joint training (original)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=519.8017, vae=3.4084, dsb=503.1292, bio=26.5281
    Epoch  2/10: total=126.2181, vae=1.1040, dsb=125.0813, bio=0.0655
    Epoch  3/10: total=114.4009, vae=1.1008, dsb=113.2853, bio=0.0297
    Epoch  4/10: total=108.8725, vae=1.1002, dsb=107.7633, bio=0.0181
    Epoch  5/10: total=105.7427, vae=1.0981, dsb=104.6384, bio=0.0123
    Epoch  6/10: total=103.1045, vae=1.0982, dsb=102.0018, bio=0.0092
    Epoch  7/10: total=101.7394, vae=1.0981, dsb=100.6377, bio=0.0072
    Epoch  8/10: total=100.2033, vae=1.0972, dsb=99.1032, bio=0.0059
    Epoch  9/10: total=98.3674, vae=1.0979, dsb=97.2670, bio=0.0051
    Epoch 10/10: total=98.5263, vae=1.0978, dsb=97.4262, bio=0.0044

  [Backward Policy Training]
    Epoch  1/10: total=3.4966, vae=1.0987, dsb=2.3902, bio=0.0155
    Epoch  2/10: total=2.9756, vae=1.0968, dsb=1.8764, bio=0.0048
    Epoch  3/10: total=2.8447, vae=1.0956, dsb=1.7475, bio=0.0034
    Epoch  4/10: total=2.7310, vae=1.0958, dsb=1.6338, bio=0.0027
    Epoch  5/10: total=2.6958, vae=1.0954, dsb=1.5992, bio=0.0025
    Epoch  6/10: total=2.6463, vae=1.0957, dsb=1.5495, bio=0.0022
    Epoch  7/10: total=2.6546, vae=1.0951, dsb=1.5584, bio=0.0021
    Epoch  8/10: total=2.6061, vae=1.0950, dsb=1.5101, bio=0.0020
    Epoch  9/10: total=2.6311, vae=1.0951, dsb=1.5350, bio=0.0019
    Epoch 10/10: total=2.5870, vae=1.0946, dsb=1.4915, bio=0.0019

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=87.0284, vae=1.0975, dsb=85.9288, bio=0.0041
    Epoch  2/10: total=80.7748, vae=1.0962, dsb=79.6777, bio=0.0020
    Epoch  3/10: total=79.6700, vae=1.0947, dsb=78.5744, bio=0.0018
    Epoch  4/10: total=78.0132, vae=1.0964, dsb=76.9159, bio=0.0018
    Epoch  5/10: total=77.8275, vae=1.0960, dsb=76.7306, bio=0.0018
    Epoch  6/10: total=77.0618, vae=1.0955, dsb=75.9654, bio=0.0018
    Epoch  7/10: total=76.6153, vae=1.0956, dsb=75.5188, bio=0.0018
    Epoch  8/10: total=76.7323, vae=1.0956, dsb=75.6358, bio=0.0018
    Epoch  9/10: total=76.2806, vae=1.0951, dsb=75.1846, bio=0.0018
    Epoch 10/10: total=75.6631, vae=1.0941, dsb=74.5679, bio=0.0023

  [Backward Policy Training]
    Epoch  1/10: total=2.3338, vae=1.0964, dsb=1.2346, bio=0.0056
    Epoch  2/10: total=2.2398, vae=1.0945, dsb=1.1444, bio=0.0018
    Epoch  3/10: total=2.1643, vae=1.0937, dsb=1.0697, bio=0.0016
    Epoch  4/10: total=2.1791, vae=1.0935, dsb=1.0848, bio=0.0016
    Epoch  5/10: total=2.0999, vae=1.0937, dsb=1.0054, bio=0.0015
    Epoch  6/10: total=2.1357, vae=1.0937, dsb=1.0413, bio=0.0015
    Epoch  7/10: total=2.0977, vae=1.0936, dsb=1.0034, bio=0.0015
    Epoch  8/10: total=2.0995, vae=1.0936, dsb=1.0052, bio=0.0015
    Epoch  9/10: total=2.0925, vae=1.0936, dsb=0.9982, bio=0.0014
    Epoch 10/10: total=2.0734, vae=1.0933, dsb=0.9794, bio=0.0014

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=73.7233, vae=1.0962, dsb=72.6256, bio=0.0031
    Epoch  2/10: total=71.4459, vae=1.0947, dsb=70.3505, bio=0.0016
    Epoch  3/10: total=70.1079, vae=1.0946, dsb=69.0125, bio=0.0015
    Epoch  4/10: total=69.8775, vae=1.0941, dsb=68.7827, bio=0.0015
    Epoch  5/10: total=69.6793, vae=1.0942, dsb=68.5843, bio=0.0015
    Epoch  6/10: total=69.2852, vae=1.0939, dsb=68.1905, bio=0.0015
    Epoch  7/10: total=69.2415, vae=1.0953, dsb=68.1453, bio=0.0018
    Epoch  8/10: total=69.3951, vae=1.0947, dsb=68.2997, bio=0.0014
    Epoch  9/10: total=69.2259, vae=1.0942, dsb=68.1309, bio=0.0014
    Epoch 10/10: total=68.8799, vae=1.0939, dsb=67.7852, bio=0.0014

  [Backward Policy Training]
    Epoch  1/10: total=1.9937, vae=1.0949, dsb=0.8893, bio=0.0189
    Epoch  2/10: total=1.9089, vae=1.0930, dsb=0.8152, bio=0.0015
    Epoch  3/10: total=1.9032, vae=1.0933, dsb=0.8093, bio=0.0013
    Epoch  4/10: total=1.9023, vae=1.0929, dsb=0.8087, bio=0.0013
    Epoch  5/10: total=1.8792, vae=1.0936, dsb=0.7850, bio=0.0013
    Epoch  6/10: total=1.8811, vae=1.0931, dsb=0.7873, bio=0.0013
    Epoch  7/10: total=1.9036, vae=1.0922, dsb=0.8107, bio=0.0012
    Epoch  8/10: total=1.8935, vae=1.0926, dsb=0.8003, bio=0.0012
    Epoch  9/10: total=1.8704, vae=1.0925, dsb=0.7773, bio=0.0012
    Epoch 10/10: total=1.8674, vae=1.0930, dsb=0.7738, bio=0.0012

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=57.4401, vae=1.0956, dsb=56.3432, bio=0.0027
    Epoch  2/10: total=56.6011, vae=1.0952, dsb=55.5052, bio=0.0013
    Epoch  3/10: total=56.6886, vae=1.0946, dsb=55.5934, bio=0.0014
    Epoch  4/10: total=56.4880, vae=1.0940, dsb=55.3934, bio=0.0013
    Epoch  5/10: total=56.1507, vae=1.0935, dsb=55.0566, bio=0.0013
    Epoch  6/10: total=56.1726, vae=1.0930, dsb=55.0790, bio=0.0013
    Epoch  7/10: total=56.0106, vae=1.0936, dsb=54.9164, bio=0.0012
    Epoch  8/10: total=55.8603, vae=1.0932, dsb=54.7664, bio=0.0012
    Epoch  9/10: total=56.1406, vae=1.0931, dsb=55.0469, bio=0.0013
    Epoch 10/10: total=55.7478, vae=1.0929, dsb=54.6544, bio=0.0011

  [Backward Policy Training]
    Epoch  1/10: total=1.8677, vae=1.0945, dsb=0.7275, bio=0.0915
    Epoch  2/10: total=1.7699, vae=1.0920, dsb=0.6772, bio=0.0013
    Epoch  3/10: total=1.7708, vae=1.0930, dsb=0.6772, bio=0.0012
    Epoch  4/10: total=1.7898, vae=1.0924, dsb=0.6968, bio=0.0011
    Epoch  5/10: total=1.7652, vae=1.0929, dsb=0.6718, bio=0.0011
    Epoch  6/10: total=1.7801, vae=1.0919, dsb=0.6877, bio=0.0011
    Epoch  7/10: total=1.7652, vae=1.0916, dsb=0.6730, bio=0.0011
    Epoch  8/10: total=1.7486, vae=1.0926, dsb=0.6554, bio=0.0011
    Epoch  9/10: total=1.7813, vae=1.0926, dsb=0.6882, bio=0.0010
    Epoch 10/10: total=1.7845, vae=1.0928, dsb=0.6912, bio=0.0011

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=51.1763, vae=1.0952, dsb=50.0792, bio=0.0039
    Epoch  2/10: total=50.8657, vae=1.0940, dsb=49.7710, bio=0.0012
    Epoch  3/10: total=50.6608, vae=1.0940, dsb=49.5663, bio=0.0011
    Epoch  4/10: total=50.7594, vae=1.0931, dsb=49.6657, bio=0.0012
    Epoch  5/10: total=50.5713, vae=1.0928, dsb=49.4779, bio=0.0011
    Epoch  6/10: total=50.5853, vae=1.0927, dsb=49.4921, bio=0.0011
    Epoch  7/10: total=50.7507, vae=1.0925, dsb=49.6580, bio=0.0005
    Epoch  8/10: total=50.3972, vae=1.0924, dsb=49.3042, bio=0.0012
    Epoch  9/10: total=50.6898, vae=1.0928, dsb=49.5965, bio=0.0011
    Epoch 10/10: total=50.5976, vae=1.0922, dsb=49.5049, bio=0.0010

  [Backward Policy Training]
    Epoch  1/10: total=1.7954, vae=1.0943, dsb=0.6174, bio=0.1672
    Epoch  2/10: total=1.6874, vae=1.0926, dsb=0.5940, bio=0.0017
    Epoch  3/10: total=1.6710, vae=1.0917, dsb=0.5787, bio=0.0011
    Epoch  4/10: total=1.6883, vae=1.0919, dsb=0.5958, bio=0.0010
    Epoch  5/10: total=1.6814, vae=1.0924, dsb=0.5885, bio=0.0010
    Epoch  6/10: total=1.6800, vae=1.0918, dsb=0.5878, bio=0.0009
    Epoch  7/10: total=1.6797, vae=1.0915, dsb=0.5877, bio=0.0010
    Epoch  8/10: total=1.6985, vae=1.0917, dsb=0.6063, bio=0.0010
    Epoch  9/10: total=1.6649, vae=1.0913, dsb=0.5732, bio=0.0009
    Epoch 10/10: total=1.6856, vae=1.0916, dsb=0.5935, bio=0.0009

[Seed 71] Joint training (original) complete; models and history saved.

[Seed 71] Starting joint training (ablation)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=504.3023, vae=1.9751, dsb=502.3271, bio=0.0000
    Epoch  2/10: total=125.5509, vae=1.0890, dsb=124.4619, bio=0.0000
    Epoch  3/10: total=113.6366, vae=1.0875, dsb=112.5491, bio=0.0000
    Epoch  4/10: total=108.1041, vae=1.0874, dsb=107.0168, bio=0.0000
    Epoch  5/10: total=105.0690, vae=1.0855, dsb=103.9835, bio=0.0000
    Epoch  6/10: total=102.3812, vae=1.0858, dsb=101.2953, bio=0.0000
    Epoch  7/10: total=101.0152, vae=1.0860, dsb=99.9291, bio=0.0000
    Epoch  8/10: total=99.4746, vae=1.0853, dsb=98.3893, bio=0.0000
    Epoch  9/10: total=97.6818, vae=1.0863, dsb=96.5954, bio=0.0000
    Epoch 10/10: total=97.8857, vae=1.0865, dsb=96.7992, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=3.3558, vae=1.0860, dsb=2.2698, bio=0.0000
    Epoch  2/10: total=2.8728, vae=1.0859, dsb=1.7869, bio=0.0000
    Epoch  3/10: total=2.7503, vae=1.0852, dsb=1.6651, bio=0.0000
    Epoch  4/10: total=2.6421, vae=1.0857, dsb=1.5564, bio=0.0000
    Epoch  5/10: total=2.6087, vae=1.0855, dsb=1.5231, bio=0.0000
    Epoch  6/10: total=2.5623, vae=1.0860, dsb=1.4763, bio=0.0000
    Epoch  7/10: total=2.5703, vae=1.0855, dsb=1.4848, bio=0.0000
    Epoch  8/10: total=2.5241, vae=1.0855, dsb=1.4386, bio=0.0000
    Epoch  9/10: total=2.5484, vae=1.0857, dsb=1.4627, bio=0.0000
    Epoch 10/10: total=2.5057, vae=1.0853, dsb=1.4204, bio=0.0000

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=85.6047, vae=1.0851, dsb=84.5196, bio=0.0000
    Epoch  2/10: total=79.3764, vae=1.0854, dsb=78.2910, bio=0.0000
    Epoch  3/10: total=78.2638, vae=1.0843, dsb=77.1796, bio=0.0000
    Epoch  4/10: total=76.7163, vae=1.0861, dsb=75.6302, bio=0.0000
    Epoch  5/10: total=76.6010, vae=1.0859, dsb=75.5151, bio=0.0000
    Epoch  6/10: total=75.8259, vae=1.0855, dsb=74.7404, bio=0.0000
    Epoch  7/10: total=75.4190, vae=1.0857, dsb=74.3334, bio=0.0000
    Epoch  8/10: total=75.6009, vae=1.0857, dsb=74.5152, bio=0.0000
    Epoch  9/10: total=75.1812, vae=1.0853, dsb=74.0959, bio=0.0000
    Epoch 10/10: total=74.5915, vae=1.0843, dsb=73.5072, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=2.2364, vae=1.0859, dsb=1.1505, bio=0.0000
    Epoch  2/10: total=2.1544, vae=1.0856, dsb=1.0689, bio=0.0000
    Epoch  3/10: total=2.0845, vae=1.0850, dsb=0.9995, bio=0.0000
    Epoch  4/10: total=2.1001, vae=1.0849, dsb=1.0152, bio=0.0000
    Epoch  5/10: total=2.0264, vae=1.0852, dsb=0.9412, bio=0.0000
    Epoch  6/10: total=2.0614, vae=1.0853, dsb=0.9761, bio=0.0000
    Epoch  7/10: total=2.0249, vae=1.0851, dsb=0.9398, bio=0.0000
    Epoch  8/10: total=2.0276, vae=1.0852, dsb=0.9424, bio=0.0000
    Epoch  9/10: total=2.0212, vae=1.0852, dsb=0.9360, bio=0.0000
    Epoch 10/10: total=2.0032, vae=1.0851, dsb=0.9182, bio=0.0000

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=72.5689, vae=1.0853, dsb=71.4836, bio=0.0000
    Epoch  2/10: total=70.6106, vae=1.0852, dsb=69.5254, bio=0.0000
    Epoch  3/10: total=69.4110, vae=1.0853, dsb=68.3258, bio=0.0000
    Epoch  4/10: total=69.1787, vae=1.0848, dsb=68.0939, bio=0.0000
    Epoch  5/10: total=69.0695, vae=1.0851, dsb=67.9844, bio=0.0000
    Epoch  6/10: total=68.7095, vae=1.0848, dsb=67.6247, bio=0.0000
    Epoch  7/10: total=68.7057, vae=1.0863, dsb=67.6194, bio=0.0000
    Epoch  8/10: total=68.8644, vae=1.0858, dsb=67.7786, bio=0.0000
    Epoch  9/10: total=68.7211, vae=1.0854, dsb=67.6357, bio=0.0000
    Epoch 10/10: total=68.4133, vae=1.0853, dsb=67.3281, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.8908, vae=1.0857, dsb=0.8051, bio=0.0000
    Epoch  2/10: total=1.8271, vae=1.0848, dsb=0.7423, bio=0.0000
    Epoch  3/10: total=1.8239, vae=1.0852, dsb=0.7387, bio=0.0000
    Epoch  4/10: total=1.8243, vae=1.0849, dsb=0.7394, bio=0.0000
    Epoch  5/10: total=1.8031, vae=1.0856, dsb=0.7175, bio=0.0000
    Epoch  6/10: total=1.8059, vae=1.0852, dsb=0.7208, bio=0.0000
    Epoch  7/10: total=1.8278, vae=1.0844, dsb=0.7434, bio=0.0000
    Epoch  8/10: total=1.8184, vae=1.0848, dsb=0.7336, bio=0.0000
    Epoch  9/10: total=1.7966, vae=1.0848, dsb=0.7118, bio=0.0000
    Epoch 10/10: total=1.7937, vae=1.0853, dsb=0.7085, bio=0.0000

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=56.7910, vae=1.0851, dsb=55.7059, bio=0.0000
    Epoch  2/10: total=56.0363, vae=1.0861, dsb=54.9502, bio=0.0000
    Epoch  3/10: total=56.1639, vae=1.0857, dsb=55.0783, bio=0.0000
    Epoch  4/10: total=56.0043, vae=1.0854, dsb=54.9189, bio=0.0000
    Epoch  5/10: total=55.6087, vae=1.0850, dsb=54.5237, bio=0.0000
    Epoch  6/10: total=55.6549, vae=1.0847, dsb=54.5703, bio=0.0000
    Epoch  7/10: total=55.4737, vae=1.0853, dsb=54.3884, bio=0.0000
    Epoch  8/10: total=55.4156, vae=1.0851, dsb=54.3306, bio=0.0000
    Epoch  9/10: total=55.6676, vae=1.0850, dsb=54.5827, bio=0.0000
    Epoch 10/10: total=55.2755, vae=1.0849, dsb=54.1906, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.7458, vae=1.0854, dsb=0.6604, bio=0.0000
    Epoch  2/10: total=1.6998, vae=1.0842, dsb=0.6155, bio=0.0000
    Epoch  3/10: total=1.7027, vae=1.0854, dsb=0.6173, bio=0.0000
    Epoch  4/10: total=1.7214, vae=1.0849, dsb=0.6365, bio=0.0000
    Epoch  5/10: total=1.6987, vae=1.0854, dsb=0.6133, bio=0.0000
    Epoch  6/10: total=1.7133, vae=1.0845, dsb=0.6288, bio=0.0000
    Epoch  7/10: total=1.6998, vae=1.0843, dsb=0.6155, bio=0.0000
    Epoch  8/10: total=1.6846, vae=1.0854, dsb=0.5992, bio=0.0000
    Epoch  9/10: total=1.7155, vae=1.0855, dsb=0.6300, bio=0.0000
    Epoch 10/10: total=1.7191, vae=1.0858, dsb=0.6333, bio=0.0000

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=50.6356, vae=1.0848, dsb=49.5508, bio=0.0000
    Epoch  2/10: total=50.3670, vae=1.0853, dsb=49.2817, bio=0.0000
    Epoch  3/10: total=50.1973, vae=1.0854, dsb=49.1119, bio=0.0000
    Epoch  4/10: total=50.2912, vae=1.0848, dsb=49.2064, bio=0.0000
    Epoch  5/10: total=50.0993, vae=1.0848, dsb=49.0145, bio=0.0000
    Epoch  6/10: total=50.1474, vae=1.0848, dsb=49.0627, bio=0.0000
    Epoch  7/10: total=50.3013, vae=1.0847, dsb=49.2166, bio=0.0000
    Epoch  8/10: total=49.9800, vae=1.0848, dsb=48.8952, bio=0.0000
    Epoch  9/10: total=50.2724, vae=1.0852, dsb=49.1872, bio=0.0000
    Epoch 10/10: total=50.1996, vae=1.0846, dsb=49.1150, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.6415, vae=1.0855, dsb=0.5560, bio=0.0000
    Epoch  2/10: total=1.6205, vae=1.0852, dsb=0.5352, bio=0.0000
    Epoch  3/10: total=1.6059, vae=1.0845, dsb=0.5214, bio=0.0000
    Epoch  4/10: total=1.6230, vae=1.0849, dsb=0.5380, bio=0.0000
    Epoch  5/10: total=1.6164, vae=1.0855, dsb=0.5309, bio=0.0000
    Epoch  6/10: total=1.6152, vae=1.0849, dsb=0.5303, bio=0.0000
    Epoch  7/10: total=1.6154, vae=1.0849, dsb=0.5306, bio=0.0000
    Epoch  8/10: total=1.6329, vae=1.0851, dsb=0.5477, bio=0.0000
    Epoch  9/10: total=1.6020, vae=1.0847, dsb=0.5173, bio=0.0000
    Epoch 10/10: total=1.6213, vae=1.0851, dsb=0.5362, bio=0.0000

[Seed 71] Joint training (ablation) complete; models and history saved.

[Seed 71] Drift genes saved in /home/yyuan/ICB_TCE/iter_results/run_071

[Seed 71] run finished.

================================================================================
[Seed 72] Starting running whole pipeline...
================================================================================

[Seed 72] Starting VAE pre-training...

    Epoch [01/20], Beta: 0.000, Average Loss: 535.6795
    Epoch [02/20], Beta: 0.000, Average Loss: 311.2148
    Epoch [03/20], Beta: 0.000, Average Loss: 272.6352
    Epoch [04/20], Beta: 0.000, Average Loss: 251.5836
    Epoch [05/20], Beta: 0.100, Average Loss: 245.2594
    Epoch [06/20], Beta: 0.200, Average Loss: 244.2415
    Epoch [07/20], Beta: 0.300, Average Loss: 244.6296
    Epoch [08/20], Beta: 0.400, Average Loss: 245.6347
    Epoch [09/20], Beta: 0.500, Average Loss: 246.7931
    Epoch [10/20], Beta: 0.600, Average Loss: 248.0325
    Epoch [11/20], Beta: 0.700, Average Loss: 249.3741
    Epoch [12/20], Beta: 0.800, Average Loss: 250.6305
    Epoch [13/20], Beta: 0.900, Average Loss: 251.8656
    Epoch [14/20], Beta: 1.000, Average Loss: 253.4956
    Epoch [15/20], Beta: 1.000, Average Loss: 253.0557
    Epoch [16/20], Beta: 1.000, Average Loss: 252.6936
    Epoch [17/20], Beta: 1.000, Average Loss: 252.3878
    Epoch [18/20], Beta: 1.000, Average Loss: 252.0593
    Epoch [19/20], Beta: 1.000, Average Loss: 251.6173
    Epoch [20/20], Beta: 1.000, Average Loss: 251.4915

[Seed 72] VAE pre-training complete.

[Seed 72] Starting joint training (original)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=808.2117, vae=3.4860, dsb=782.9601, bio=43.5312
    Epoch  2/10: total=203.3137, vae=1.0991, dsb=202.1840, bio=0.0611
    Epoch  3/10: total=193.1740, vae=1.0949, dsb=192.0667, bio=0.0249
    Epoch  4/10: total=187.6003, vae=1.0931, dsb=186.4998, bio=0.0149
    Epoch  5/10: total=185.4290, vae=1.0920, dsb=184.3319, bio=0.0104
    Epoch  6/10: total=181.5221, vae=1.0905, dsb=180.4277, bio=0.0079
    Epoch  7/10: total=180.5944, vae=1.0910, dsb=179.5003, bio=0.0063
    Epoch  8/10: total=179.0524, vae=1.0907, dsb=177.9590, bio=0.0053
    Epoch  9/10: total=179.1387, vae=1.0909, dsb=178.0455, bio=0.0046
    Epoch 10/10: total=177.9053, vae=1.0903, dsb=176.8130, bio=0.0041

  [Backward Policy Training]
    Epoch  1/10: total=3.7078, vae=1.0916, dsb=2.6085, bio=0.0154
    Epoch  2/10: total=3.2671, vae=1.0899, dsb=2.1748, bio=0.0047
    Epoch  3/10: total=3.0323, vae=1.0892, dsb=1.9414, bio=0.0034
    Epoch  4/10: total=3.0009, vae=1.0889, dsb=1.9106, bio=0.0028
    Epoch  5/10: total=2.8853, vae=1.0883, dsb=1.7958, bio=0.0025
    Epoch  6/10: total=2.9538, vae=1.0889, dsb=1.8636, bio=0.0026
    Epoch  7/10: total=2.9054, vae=1.0885, dsb=1.8158, bio=0.0022
    Epoch  8/10: total=2.9129, vae=1.0876, dsb=1.8243, bio=0.0021
    Epoch  9/10: total=2.8124, vae=1.0880, dsb=1.7234, bio=0.0021
    Epoch 10/10: total=2.8711, vae=1.0882, dsb=1.7819, bio=0.0020

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=151.4474, vae=1.0905, dsb=150.3551, bio=0.0037
    Epoch  2/10: total=146.3808, vae=1.0901, dsb=145.2897, bio=0.0019
    Epoch  3/10: total=145.5218, vae=1.0898, dsb=144.4310, bio=0.0020
    Epoch  4/10: total=144.7851, vae=1.0888, dsb=143.6953, bio=0.0019
    Epoch  5/10: total=144.7989, vae=1.0882, dsb=143.7097, bio=0.0019
    Epoch  6/10: total=144.0227, vae=1.0885, dsb=142.9332, bio=0.0020
    Epoch  7/10: total=143.1801, vae=1.0890, dsb=142.0901, bio=0.0019
    Epoch  8/10: total=142.8841, vae=1.0885, dsb=141.7946, bio=0.0019
    Epoch  9/10: total=143.4658, vae=1.0888, dsb=142.3760, bio=0.0019
    Epoch 10/10: total=143.6530, vae=1.0880, dsb=142.5640, bio=0.0019

  [Backward Policy Training]
    Epoch  1/10: total=2.4324, vae=1.0890, dsb=1.3405, bio=0.0059
    Epoch  2/10: total=2.3815, vae=1.0868, dsb=1.2936, bio=0.0020
    Epoch  3/10: total=2.3760, vae=1.0870, dsb=1.2879, bio=0.0022
    Epoch  4/10: total=2.2780, vae=1.0876, dsb=1.1895, bio=0.0017
    Epoch  5/10: total=2.2826, vae=1.0869, dsb=1.1948, bio=0.0016
    Epoch  6/10: total=2.2808, vae=1.0875, dsb=1.1925, bio=0.0016
    Epoch  7/10: total=2.2996, vae=1.0873, dsb=1.2115, bio=0.0016
    Epoch  8/10: total=2.3318, vae=1.0870, dsb=1.2440, bio=0.0016
    Epoch  9/10: total=2.2667, vae=1.0868, dsb=1.1791, bio=0.0016
    Epoch 10/10: total=2.2629, vae=1.0872, dsb=1.1749, bio=0.0016

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=124.1564, vae=1.0889, dsb=123.0659, bio=0.0031
    Epoch  2/10: total=123.1399, vae=1.0883, dsb=122.0507, bio=0.0017
    Epoch  3/10: total=122.5462, vae=1.0883, dsb=121.4571, bio=0.0017
    Epoch  4/10: total=122.1395, vae=1.0880, dsb=121.0507, bio=0.0017
    Epoch  5/10: total=122.5123, vae=1.0880, dsb=121.4233, bio=0.0020
    Epoch  6/10: total=122.2724, vae=1.0876, dsb=121.1841, bio=0.0016
    Epoch  7/10: total=122.1239, vae=1.0881, dsb=121.0350, bio=0.0016
    Epoch  8/10: total=122.9322, vae=1.0877, dsb=121.8436, bio=0.0017
    Epoch  9/10: total=121.7177, vae=1.0867, dsb=120.6301, bio=0.0016
    Epoch 10/10: total=121.7319, vae=1.0867, dsb=120.6443, bio=0.0017

  [Backward Policy Training]
    Epoch  1/10: total=2.1475, vae=1.0875, dsb=1.0548, bio=0.0105
    Epoch  2/10: total=2.1035, vae=1.0870, dsb=1.0158, bio=0.0016
    Epoch  3/10: total=2.0514, vae=1.0863, dsb=0.9644, bio=0.0014
    Epoch  4/10: total=2.0591, vae=1.0871, dsb=0.9713, bio=0.0015
    Epoch  5/10: total=2.0672, vae=1.0862, dsb=0.9803, bio=0.0014
    Epoch  6/10: total=2.0747, vae=1.0860, dsb=0.9880, bio=0.0013
    Epoch  7/10: total=2.0841, vae=1.0869, dsb=0.9966, bio=0.0013
    Epoch  8/10: total=2.0581, vae=1.0869, dsb=0.9706, bio=0.0013
    Epoch  9/10: total=2.0381, vae=1.0858, dsb=0.9517, bio=0.0013
    Epoch 10/10: total=2.0560, vae=1.0861, dsb=0.9693, bio=0.0012

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=108.2744, vae=1.0885, dsb=107.1846, bio=0.0025
    Epoch  2/10: total=108.7179, vae=1.0873, dsb=107.6298, bio=0.0016
    Epoch  3/10: total=108.4264, vae=1.0861, dsb=107.3396, bio=0.0014
    Epoch  4/10: total=108.9743, vae=1.0873, dsb=107.8864, bio=0.0014
    Epoch  5/10: total=108.3644, vae=1.0864, dsb=107.2773, bio=0.0014
    Epoch  6/10: total=108.4056, vae=1.0873, dsb=107.3176, bio=0.0013
    Epoch  7/10: total=108.8850, vae=1.0865, dsb=107.7979, bio=0.0013
    Epoch  8/10: total=108.5027, vae=1.0871, dsb=107.4150, bio=0.0013
    Epoch  9/10: total=107.7878, vae=1.0861, dsb=106.7009, bio=0.0014
    Epoch 10/10: total=108.1138, vae=1.0863, dsb=107.0270, bio=0.0012

  [Backward Policy Training]
    Epoch  1/10: total=1.9863, vae=1.0876, dsb=0.8626, bio=0.0722
    Epoch  2/10: total=1.9487, vae=1.0861, dsb=0.8619, bio=0.0013
    Epoch  3/10: total=1.9429, vae=1.0862, dsb=0.8561, bio=0.0012
    Epoch  4/10: total=1.9581, vae=1.0871, dsb=0.8704, bio=0.0011
    Epoch  5/10: total=1.9319, vae=1.0855, dsb=0.8459, bio=0.0011
    Epoch  6/10: total=1.9632, vae=1.0863, dsb=0.8764, bio=0.0011
    Epoch  7/10: total=1.9320, vae=1.0862, dsb=0.8453, bio=0.0011
    Epoch  8/10: total=1.9429, vae=1.0864, dsb=0.8560, bio=0.0011
    Epoch  9/10: total=1.9047, vae=1.0859, dsb=0.8181, bio=0.0013
    Epoch 10/10: total=1.9046, vae=1.0866, dsb=0.8175, bio=0.0010

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=92.3501, vae=1.0891, dsb=91.2596, bio=0.0027
    Epoch  2/10: total=91.9937, vae=1.0867, dsb=90.9065, bio=0.0011
    Epoch  3/10: total=91.9704, vae=1.0871, dsb=90.8827, bio=0.0012
    Epoch  4/10: total=92.0070, vae=1.0860, dsb=90.9205, bio=0.0009
    Epoch  5/10: total=92.0404, vae=1.0869, dsb=90.9529, bio=0.0011
    Epoch  6/10: total=91.6717, vae=1.0867, dsb=90.5845, bio=0.0011
    Epoch  7/10: total=91.5121, vae=1.0860, dsb=90.4257, bio=0.0010
    Epoch  8/10: total=91.5742, vae=1.0862, dsb=90.4874, bio=0.0010
    Epoch  9/10: total=92.1503, vae=1.0855, dsb=91.0645, bio=0.0006
    Epoch 10/10: total=92.1427, vae=1.0853, dsb=91.0570, bio=0.0009

  [Backward Policy Training]
    Epoch  1/10: total=1.8896, vae=1.0869, dsb=0.7359, bio=0.1337
    Epoch  2/10: total=1.8238, vae=1.0864, dsb=0.7367, bio=0.0012
    Epoch  3/10: total=1.8291, vae=1.0851, dsb=0.7434, bio=0.0011
    Epoch  4/10: total=1.8369, vae=1.0850, dsb=0.7514, bio=0.0010
    Epoch  5/10: total=1.8104, vae=1.0856, dsb=0.7245, bio=0.0006
    Epoch  6/10: total=1.8021, vae=1.0858, dsb=0.7157, bio=0.0014
    Epoch  7/10: total=1.8238, vae=1.0856, dsb=0.7377, bio=0.0010
    Epoch  8/10: total=1.8562, vae=1.0854, dsb=0.7703, bio=0.0010
    Epoch  9/10: total=1.8000, vae=1.0855, dsb=0.7141, bio=0.0007
    Epoch 10/10: total=1.8150, vae=1.0856, dsb=0.7289, bio=0.0010

[Seed 72] Joint training (original) complete; models and history saved.

[Seed 72] Starting joint training (ablation)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=783.7065, vae=2.0008, dsb=781.7057, bio=0.0000
    Epoch  2/10: total=202.3283, vae=1.0822, dsb=201.2461, bio=0.0000
    Epoch  3/10: total=191.9266, vae=1.0811, dsb=190.8455, bio=0.0000
    Epoch  4/10: total=186.3939, vae=1.0802, dsb=185.3137, bio=0.0000
    Epoch  5/10: total=184.2571, vae=1.0794, dsb=183.1777, bio=0.0000
    Epoch  6/10: total=180.3962, vae=1.0781, dsb=179.3181, bio=0.0000
    Epoch  7/10: total=179.5326, vae=1.0789, dsb=178.4537, bio=0.0000
    Epoch  8/10: total=177.9677, vae=1.0788, dsb=176.8889, bio=0.0000
    Epoch  9/10: total=178.1079, vae=1.0792, dsb=177.0287, bio=0.0000
    Epoch 10/10: total=176.9280, vae=1.0788, dsb=175.8491, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=3.5134, vae=1.0790, dsb=2.4344, bio=0.0000
    Epoch  2/10: total=3.0939, vae=1.0790, dsb=2.0149, bio=0.0000
    Epoch  3/10: total=2.8745, vae=1.0787, dsb=1.7958, bio=0.0000
    Epoch  4/10: total=2.8454, vae=1.0788, dsb=1.7667, bio=0.0000
    Epoch  5/10: total=2.7319, vae=1.0783, dsb=1.6536, bio=0.0000
    Epoch  6/10: total=2.7944, vae=1.0791, dsb=1.7154, bio=0.0000
    Epoch  7/10: total=2.7481, vae=1.0789, dsb=1.6692, bio=0.0000
    Epoch  8/10: total=2.7548, vae=1.0781, dsb=1.6767, bio=0.0000
    Epoch  9/10: total=2.6612, vae=1.0787, dsb=1.5825, bio=0.0000
    Epoch 10/10: total=2.7164, vae=1.0789, dsb=1.6375, bio=0.0000

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=149.1031, vae=1.0785, dsb=148.0246, bio=0.0000
    Epoch  2/10: total=144.1842, vae=1.0792, dsb=143.1050, bio=0.0000
    Epoch  3/10: total=143.3213, vae=1.0793, dsb=142.2420, bio=0.0000
    Epoch  4/10: total=142.7569, vae=1.0784, dsb=141.6785, bio=0.0000
    Epoch  5/10: total=142.7934, vae=1.0779, dsb=141.7155, bio=0.0000
    Epoch  6/10: total=142.1080, vae=1.0783, dsb=141.0297, bio=0.0000
    Epoch  7/10: total=141.2501, vae=1.0790, dsb=140.1711, bio=0.0000
    Epoch  8/10: total=140.8873, vae=1.0785, dsb=139.8088, bio=0.0000
    Epoch  9/10: total=141.4369, vae=1.0789, dsb=140.3580, bio=0.0000
    Epoch 10/10: total=141.6619, vae=1.0782, dsb=140.5836, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=2.3272, vae=1.0784, dsb=1.2489, bio=0.0000
    Epoch  2/10: total=2.2857, vae=1.0780, dsb=1.2077, bio=0.0000
    Epoch  3/10: total=2.2812, vae=1.0783, dsb=1.2029, bio=0.0000
    Epoch  4/10: total=2.1900, vae=1.0790, dsb=1.1109, bio=0.0000
    Epoch  5/10: total=2.1963, vae=1.0784, dsb=1.1179, bio=0.0000
    Epoch  6/10: total=2.1965, vae=1.0790, dsb=1.1175, bio=0.0000
    Epoch  7/10: total=2.2160, vae=1.0788, dsb=1.1372, bio=0.0000
    Epoch  8/10: total=2.2482, vae=1.0786, dsb=1.1696, bio=0.0000
    Epoch  9/10: total=2.1868, vae=1.0784, dsb=1.1085, bio=0.0000
    Epoch 10/10: total=2.1844, vae=1.0787, dsb=1.1056, bio=0.0000

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=119.9708, vae=1.0779, dsb=118.8930, bio=0.0000
    Epoch  2/10: total=118.8264, vae=1.0785, dsb=117.7479, bio=0.0000
    Epoch  3/10: total=118.2934, vae=1.0787, dsb=117.2147, bio=0.0000
    Epoch  4/10: total=117.9157, vae=1.0786, dsb=116.8370, bio=0.0000
    Epoch  5/10: total=118.1801, vae=1.0786, dsb=117.1015, bio=0.0000
    Epoch  6/10: total=117.9546, vae=1.0784, dsb=116.8762, bio=0.0000
    Epoch  7/10: total=117.8699, vae=1.0790, dsb=116.7909, bio=0.0000
    Epoch  8/10: total=118.6547, vae=1.0787, dsb=117.5760, bio=0.0000
    Epoch  9/10: total=117.5340, vae=1.0777, dsb=116.4563, bio=0.0000
    Epoch 10/10: total=117.5362, vae=1.0778, dsb=116.4584, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=2.0528, vae=1.0782, dsb=0.9746, bio=0.0000
    Epoch  2/10: total=2.0197, vae=1.0787, dsb=0.9410, bio=0.0000
    Epoch  3/10: total=1.9717, vae=1.0781, dsb=0.8936, bio=0.0000
    Epoch  4/10: total=1.9793, vae=1.0789, dsb=0.9004, bio=0.0000
    Epoch  5/10: total=1.9880, vae=1.0782, dsb=0.9098, bio=0.0000
    Epoch  6/10: total=1.9947, vae=1.0780, dsb=0.9167, bio=0.0000
    Epoch  7/10: total=2.0044, vae=1.0789, dsb=0.9255, bio=0.0000
    Epoch  8/10: total=1.9796, vae=1.0790, dsb=0.9006, bio=0.0000
    Epoch  9/10: total=1.9595, vae=1.0779, dsb=0.8816, bio=0.0000
    Epoch 10/10: total=1.9766, vae=1.0782, dsb=0.8984, bio=0.0000

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=102.3087, vae=1.0779, dsb=101.2308, bio=0.0000
    Epoch  2/10: total=102.7467, vae=1.0780, dsb=101.6687, bio=0.0000
    Epoch  3/10: total=102.3688, vae=1.0772, dsb=101.2916, bio=0.0000
    Epoch  4/10: total=102.9846, vae=1.0785, dsb=101.9061, bio=0.0000
    Epoch  5/10: total=102.3903, vae=1.0778, dsb=101.3125, bio=0.0000
    Epoch  6/10: total=102.4075, vae=1.0788, dsb=101.3287, bio=0.0000
    Epoch  7/10: total=102.8453, vae=1.0780, dsb=101.7673, bio=0.0000
    Epoch  8/10: total=102.5293, vae=1.0788, dsb=101.4505, bio=0.0000
    Epoch  9/10: total=101.8196, vae=1.0778, dsb=100.7418, bio=0.0000
    Epoch 10/10: total=102.1087, vae=1.0781, dsb=101.0306, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.8618, vae=1.0787, dsb=0.7831, bio=0.0000
    Epoch  2/10: total=1.8628, vae=1.0782, dsb=0.7846, bio=0.0000
    Epoch  3/10: total=1.8580, vae=1.0783, dsb=0.7797, bio=0.0000
    Epoch  4/10: total=1.8730, vae=1.0793, dsb=0.7936, bio=0.0000
    Epoch  5/10: total=1.8490, vae=1.0778, dsb=0.7712, bio=0.0000
    Epoch  6/10: total=1.8789, vae=1.0785, dsb=0.8004, bio=0.0000
    Epoch  7/10: total=1.8504, vae=1.0785, dsb=0.7719, bio=0.0000
    Epoch  8/10: total=1.8609, vae=1.0787, dsb=0.7822, bio=0.0000
    Epoch  9/10: total=1.8250, vae=1.0783, dsb=0.7467, bio=0.0000
    Epoch 10/10: total=1.8253, vae=1.0791, dsb=0.7463, bio=0.0000

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=87.2176, vae=1.0783, dsb=86.1393, bio=0.0000
    Epoch  2/10: total=86.8110, vae=1.0776, dsb=85.7333, bio=0.0000
    Epoch  3/10: total=86.8093, vae=1.0786, dsb=85.7308, bio=0.0000
    Epoch  4/10: total=86.8638, vae=1.0777, dsb=85.7860, bio=0.0000
    Epoch  5/10: total=86.9320, vae=1.0788, dsb=85.8531, bio=0.0000
    Epoch  6/10: total=86.5752, vae=1.0787, dsb=85.4965, bio=0.0000
    Epoch  7/10: total=86.3989, vae=1.0780, dsb=85.3209, bio=0.0000
    Epoch  8/10: total=86.4421, vae=1.0783, dsb=85.3638, bio=0.0000
    Epoch  9/10: total=86.9651, vae=1.0776, dsb=85.8874, bio=0.0000
    Epoch 10/10: total=86.9241, vae=1.0775, dsb=85.8465, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.7518, vae=1.0782, dsb=0.6736, bio=0.0000
    Epoch  2/10: total=1.7545, vae=1.0787, dsb=0.6758, bio=0.0000
    Epoch  3/10: total=1.7601, vae=1.0776, dsb=0.6826, bio=0.0000
    Epoch  4/10: total=1.7681, vae=1.0775, dsb=0.6906, bio=0.0000
    Epoch  5/10: total=1.7437, vae=1.0782, dsb=0.6655, bio=0.0000
    Epoch  6/10: total=1.7363, vae=1.0785, dsb=0.6577, bio=0.0000
    Epoch  7/10: total=1.7566, vae=1.0784, dsb=0.6782, bio=0.0000
    Epoch  8/10: total=1.7874, vae=1.0783, dsb=0.7091, bio=0.0000
    Epoch  9/10: total=1.7347, vae=1.0785, dsb=0.6562, bio=0.0000
    Epoch 10/10: total=1.7487, vae=1.0787, dsb=0.6700, bio=0.0000

[Seed 72] Joint training (ablation) complete; models and history saved.

[Seed 72] Drift genes saved in /home/yyuan/ICB_TCE/iter_results/run_072

[Seed 72] run finished.

================================================================================
[Seed 73] Starting running whole pipeline...
================================================================================

[Seed 73] Starting VAE pre-training...

    Epoch [01/20], Beta: 0.000, Average Loss: 533.3591
    Epoch [02/20], Beta: 0.000, Average Loss: 303.4594
    Epoch [03/20], Beta: 0.000, Average Loss: 270.5693
    Epoch [04/20], Beta: 0.000, Average Loss: 251.7298
    Epoch [05/20], Beta: 0.100, Average Loss: 246.8835
    Epoch [06/20], Beta: 0.200, Average Loss: 245.4141
    Epoch [07/20], Beta: 0.300, Average Loss: 245.3654
    Epoch [08/20], Beta: 0.400, Average Loss: 245.9271
    Epoch [09/20], Beta: 0.500, Average Loss: 246.9654
    Epoch [10/20], Beta: 0.600, Average Loss: 248.1736
    Epoch [11/20], Beta: 0.700, Average Loss: 249.3342
    Epoch [12/20], Beta: 0.800, Average Loss: 250.5679
    Epoch [13/20], Beta: 0.900, Average Loss: 251.8039
    Epoch [14/20], Beta: 1.000, Average Loss: 253.0061
    Epoch [15/20], Beta: 1.000, Average Loss: 252.5380
    Epoch [16/20], Beta: 1.000, Average Loss: 252.1706
    Epoch [17/20], Beta: 1.000, Average Loss: 251.8394
    Epoch [18/20], Beta: 1.000, Average Loss: 251.5592
    Epoch [19/20], Beta: 1.000, Average Loss: 251.2169
    Epoch [20/20], Beta: 1.000, Average Loss: 250.8983

[Seed 73] VAE pre-training complete.

[Seed 73] Starting joint training (original)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=226.7930, vae=3.6543, dsb=206.9229, bio=32.4315
    Epoch  2/10: total=57.0950, vae=1.0951, dsb=55.9610, bio=0.0778
    Epoch  3/10: total=47.8655, vae=1.0905, dsb=46.7597, bio=0.0308
    Epoch  4/10: total=43.5460, vae=1.0887, dsb=42.4484, bio=0.0178
    Epoch  5/10: total=40.7787, vae=1.0882, dsb=39.6846, bio=0.0118
    Epoch  6/10: total=38.9378, vae=1.0883, dsb=37.8451, bio=0.0088
    Epoch  7/10: total=37.6642, vae=1.0873, dsb=36.5735, bio=0.0068
    Epoch  8/10: total=36.6434, vae=1.0870, dsb=35.5536, bio=0.0056
    Epoch  9/10: total=35.7712, vae=1.0858, dsb=34.6830, bio=0.0047
    Epoch 10/10: total=35.1333, vae=1.0858, dsb=34.0454, bio=0.0042

  [Backward Policy Training]
    Epoch  1/10: total=2.9077, vae=1.0869, dsb=1.8137, bio=0.0142
    Epoch  2/10: total=2.4776, vae=1.0853, dsb=1.3899, bio=0.0047
    Epoch  3/10: total=2.3538, vae=1.0862, dsb=1.2659, bio=0.0035
    Epoch  4/10: total=2.2998, vae=1.0853, dsb=1.2130, bio=0.0030
    Epoch  5/10: total=2.2532, vae=1.0850, dsb=1.1669, bio=0.0027
    Epoch  6/10: total=2.2505, vae=1.0836, dsb=1.1656, bio=0.0025
    Epoch  7/10: total=2.2190, vae=1.0851, dsb=1.1328, bio=0.0024
    Epoch  8/10: total=2.1725, vae=1.0835, dsb=1.0877, bio=0.0027
    Epoch  9/10: total=2.1534, vae=1.0836, dsb=1.0687, bio=0.0023
    Epoch 10/10: total=2.1795, vae=1.0832, dsb=1.0952, bio=0.0022

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=31.7851, vae=1.0876, dsb=30.6949, bio=0.0053
    Epoch  2/10: total=26.4671, vae=1.0854, dsb=25.3805, bio=0.0023
    Epoch  3/10: total=25.1300, vae=1.0860, dsb=24.0429, bio=0.0022
    Epoch  4/10: total=24.4305, vae=1.0856, dsb=23.3438, bio=0.0022
    Epoch  5/10: total=23.9293, vae=1.0847, dsb=22.8435, bio=0.0021
    Epoch  6/10: total=23.6924, vae=1.0850, dsb=22.6063, bio=0.0022
    Epoch  7/10: total=23.4374, vae=1.0851, dsb=22.3512, bio=0.0022
    Epoch  8/10: total=23.0675, vae=1.0848, dsb=21.9816, bio=0.0022
    Epoch  9/10: total=22.9976, vae=1.0850, dsb=21.9115, bio=0.0022
    Epoch 10/10: total=22.7658, vae=1.0844, dsb=21.6803, bio=0.0022

  [Backward Policy Training]
    Epoch  1/10: total=1.9041, vae=1.0863, dsb=0.8142, bio=0.0072
    Epoch  2/10: total=1.8248, vae=1.0836, dsb=0.7401, bio=0.0023
    Epoch  3/10: total=1.7888, vae=1.0833, dsb=0.7044, bio=0.0021
    Epoch  4/10: total=1.7687, vae=1.0831, dsb=0.6847, bio=0.0020
    Epoch  5/10: total=1.7545, vae=1.0822, dsb=0.6712, bio=0.0020
    Epoch  6/10: total=1.7399, vae=1.0831, dsb=0.6558, bio=0.0019
    Epoch  7/10: total=1.7466, vae=1.0836, dsb=0.6620, bio=0.0019
    Epoch  8/10: total=1.7308, vae=1.0830, dsb=0.6471, bio=0.0015
    Epoch  9/10: total=1.7220, vae=1.0828, dsb=0.6381, bio=0.0021
    Epoch 10/10: total=1.6981, vae=1.0831, dsb=0.6140, bio=0.0019

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=21.4807, vae=1.0863, dsb=20.3927, bio=0.0034
    Epoch  2/10: total=19.4380, vae=1.0842, dsb=18.3529, bio=0.0020
    Epoch  3/10: total=18.9739, vae=1.0841, dsb=17.8888, bio=0.0019
    Epoch  4/10: total=18.6827, vae=1.0828, dsb=17.5988, bio=0.0020
    Epoch  5/10: total=18.4558, vae=1.0836, dsb=17.3713, bio=0.0019
    Epoch  6/10: total=18.3344, vae=1.0830, dsb=17.2504, bio=0.0020
    Epoch  7/10: total=18.1793, vae=1.0841, dsb=17.0941, bio=0.0020
    Epoch  8/10: total=18.0503, vae=1.0834, dsb=16.9657, bio=0.0023
    Epoch  9/10: total=17.9818, vae=1.0843, dsb=16.8965, bio=0.0020
    Epoch 10/10: total=17.9477, vae=1.0825, dsb=16.8642, bio=0.0020

  [Backward Policy Training]
    Epoch  1/10: total=1.6453, vae=1.0842, dsb=0.5572, bio=0.0079
    Epoch  2/10: total=1.5813, vae=1.0831, dsb=0.4973, bio=0.0020
    Epoch  3/10: total=1.5757, vae=1.0833, dsb=0.4915, bio=0.0018
    Epoch  4/10: total=1.5578, vae=1.0834, dsb=0.4735, bio=0.0018
    Epoch  5/10: total=1.5510, vae=1.0825, dsb=0.4678, bio=0.0012
    Epoch  6/10: total=1.5469, vae=1.0829, dsb=0.4630, bio=0.0020
    Epoch  7/10: total=1.5279, vae=1.0820, dsb=0.4451, bio=0.0017
    Epoch  8/10: total=1.5359, vae=1.0820, dsb=0.4530, bio=0.0017
    Epoch  9/10: total=1.5305, vae=1.0816, dsb=0.4480, bio=0.0017
    Epoch 10/10: total=1.5247, vae=1.0824, dsb=0.4416, bio=0.0016

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=17.5249, vae=1.0852, dsb=16.4382, bio=0.0032
    Epoch  2/10: total=16.7765, vae=1.0837, dsb=15.6920, bio=0.0016
    Epoch  3/10: total=16.5910, vae=1.0844, dsb=15.5057, bio=0.0020
    Epoch  4/10: total=16.5208, vae=1.0838, dsb=15.4360, bio=0.0018
    Epoch  5/10: total=16.4163, vae=1.0837, dsb=15.3317, bio=0.0018
    Epoch  6/10: total=16.4004, vae=1.0837, dsb=15.3158, bio=0.0018
    Epoch  7/10: total=16.3236, vae=1.0831, dsb=15.2395, bio=0.0018
    Epoch  8/10: total=16.3602, vae=1.0831, dsb=15.2762, bio=0.0018
    Epoch  9/10: total=16.2328, vae=1.0835, dsb=15.1483, bio=0.0021
    Epoch 10/10: total=16.2874, vae=1.0830, dsb=15.2035, bio=0.0018

  [Backward Policy Training]
    Epoch  1/10: total=1.4631, vae=1.0831, dsb=0.3693, bio=0.0214
    Epoch  2/10: total=1.4405, vae=1.0822, dsb=0.3574, bio=0.0018
    Epoch  3/10: total=1.4276, vae=1.0816, dsb=0.3452, bio=0.0016
    Epoch  4/10: total=1.4322, vae=1.0820, dsb=0.3494, bio=0.0015
    Epoch  5/10: total=1.4241, vae=1.0824, dsb=0.3409, bio=0.0015
    Epoch  6/10: total=1.4200, vae=1.0821, dsb=0.3371, bio=0.0015
    Epoch  7/10: total=1.4211, vae=1.0820, dsb=0.3383, bio=0.0015
    Epoch  8/10: total=1.4272, vae=1.0820, dsb=0.3444, bio=0.0015
    Epoch  9/10: total=1.4172, vae=1.0824, dsb=0.3340, bio=0.0015
    Epoch 10/10: total=1.4045, vae=1.0819, dsb=0.3218, bio=0.0015

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=14.2191, vae=1.0851, dsb=13.1324, bio=0.0031
    Epoch  2/10: total=13.9016, vae=1.0830, dsb=12.8177, bio=0.0016
    Epoch  3/10: total=13.8189, vae=1.0838, dsb=12.7343, bio=0.0016
    Epoch  4/10: total=13.8424, vae=1.0830, dsb=12.7586, bio=0.0017
    Epoch  5/10: total=13.7678, vae=1.0827, dsb=12.6843, bio=0.0016
    Epoch  6/10: total=13.7183, vae=1.0831, dsb=12.6344, bio=0.0016
    Epoch  7/10: total=13.7049, vae=1.0826, dsb=12.6215, bio=0.0016
    Epoch  8/10: total=13.7127, vae=1.0834, dsb=12.6285, bio=0.0017
    Epoch  9/10: total=13.7148, vae=1.0824, dsb=12.6316, bio=0.0016
    Epoch 10/10: total=13.7406, vae=1.0829, dsb=12.6569, bio=0.0016

  [Backward Policy Training]
    Epoch  1/10: total=1.4202, vae=1.0829, dsb=0.3076, bio=0.0593
    Epoch  2/10: total=1.3838, vae=1.0821, dsb=0.3008, bio=0.0016
    Epoch  3/10: total=1.3860, vae=1.0817, dsb=0.3034, bio=0.0018
    Epoch  4/10: total=1.3761, vae=1.0817, dsb=0.2936, bio=0.0015
    Epoch  5/10: total=1.3745, vae=1.0824, dsb=0.2913, bio=0.0014
    Epoch  6/10: total=1.3750, vae=1.0815, dsb=0.2928, bio=0.0013
    Epoch  7/10: total=1.3713, vae=1.0829, dsb=0.2877, bio=0.0013
    Epoch  8/10: total=1.3646, vae=1.0821, dsb=0.2819, bio=0.0013
    Epoch  9/10: total=1.3685, vae=1.0816, dsb=0.2863, bio=0.0014
    Epoch 10/10: total=1.3734, vae=1.0817, dsb=0.2911, bio=0.0013

[Seed 73] Joint training (original) complete; models and history saved.

[Seed 73] Starting joint training (ablation)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=208.5530, vae=2.0357, dsb=206.5172, bio=0.0000
    Epoch  2/10: total=56.4614, vae=1.0774, dsb=55.3840, bio=0.0000
    Epoch  3/10: total=47.3162, vae=1.0761, dsb=46.2401, bio=0.0000
    Epoch  4/10: total=43.0632, vae=1.0753, dsb=41.9879, bio=0.0000
    Epoch  5/10: total=40.3754, vae=1.0752, dsb=39.3002, bio=0.0000
    Epoch  6/10: total=38.5649, vae=1.0757, dsb=37.4892, bio=0.0000
    Epoch  7/10: total=37.2799, vae=1.0750, dsb=36.2049, bio=0.0000
    Epoch  8/10: total=36.2541, vae=1.0750, dsb=35.1791, bio=0.0000
    Epoch  9/10: total=35.3602, vae=1.0741, dsb=34.2861, bio=0.0000
    Epoch 10/10: total=34.7546, vae=1.0743, dsb=33.6803, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=2.8308, vae=1.0742, dsb=1.7566, bio=0.0000
    Epoch  2/10: total=2.4235, vae=1.0744, dsb=1.3491, bio=0.0000
    Epoch  3/10: total=2.3078, vae=1.0757, dsb=1.2321, bio=0.0000
    Epoch  4/10: total=2.2566, vae=1.0752, dsb=1.1815, bio=0.0000
    Epoch  5/10: total=2.2131, vae=1.0751, dsb=1.1380, bio=0.0000
    Epoch  6/10: total=2.2113, vae=1.0739, dsb=1.1375, bio=0.0000
    Epoch  7/10: total=2.1795, vae=1.0754, dsb=1.1041, bio=0.0000
    Epoch  8/10: total=2.1326, vae=1.0739, dsb=1.0587, bio=0.0000
    Epoch  9/10: total=2.1127, vae=1.0742, dsb=1.0385, bio=0.0000
    Epoch 10/10: total=2.1376, vae=1.0739, dsb=1.0637, bio=0.0000

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=31.2089, vae=1.0746, dsb=30.1343, bio=0.0000
    Epoch  2/10: total=26.1965, vae=1.0745, dsb=25.1220, bio=0.0000
    Epoch  3/10: total=24.9925, vae=1.0753, dsb=23.9172, bio=0.0000
    Epoch  4/10: total=24.3776, vae=1.0750, dsb=23.3026, bio=0.0000
    Epoch  5/10: total=23.9095, vae=1.0742, dsb=22.8353, bio=0.0000
    Epoch  6/10: total=23.6849, vae=1.0746, dsb=22.6104, bio=0.0000
    Epoch  7/10: total=23.4690, vae=1.0748, dsb=22.3942, bio=0.0000
    Epoch  8/10: total=23.1156, vae=1.0746, dsb=22.0411, bio=0.0000
    Epoch  9/10: total=23.0647, vae=1.0749, dsb=21.9898, bio=0.0000
    Epoch 10/10: total=22.8526, vae=1.0743, dsb=21.7783, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.8324, vae=1.0753, dsb=0.7571, bio=0.0000
    Epoch  2/10: total=1.7619, vae=1.0743, dsb=0.6876, bio=0.0000
    Epoch  3/10: total=1.7267, vae=1.0743, dsb=0.6524, bio=0.0000
    Epoch  4/10: total=1.7086, vae=1.0742, dsb=0.6344, bio=0.0000
    Epoch  5/10: total=1.6955, vae=1.0734, dsb=0.6220, bio=0.0000
    Epoch  6/10: total=1.6818, vae=1.0744, dsb=0.6075, bio=0.0000
    Epoch  7/10: total=1.6877, vae=1.0749, dsb=0.6128, bio=0.0000
    Epoch  8/10: total=1.6734, vae=1.0743, dsb=0.5991, bio=0.0000
    Epoch  9/10: total=1.6646, vae=1.0742, dsb=0.5904, bio=0.0000
    Epoch 10/10: total=1.6423, vae=1.0746, dsb=0.5677, bio=0.0000

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=21.0129, vae=1.0749, dsb=19.9380, bio=0.0000
    Epoch  2/10: total=19.2758, vae=1.0740, dsb=18.2018, bio=0.0000
    Epoch  3/10: total=18.8917, vae=1.0741, dsb=17.8176, bio=0.0000
    Epoch  4/10: total=18.6580, vae=1.0729, dsb=17.5850, bio=0.0000
    Epoch  5/10: total=18.4530, vae=1.0738, dsb=17.3792, bio=0.0000
    Epoch  6/10: total=18.3629, vae=1.0734, dsb=17.2895, bio=0.0000
    Epoch  7/10: total=18.2382, vae=1.0745, dsb=17.1637, bio=0.0000
    Epoch  8/10: total=18.1060, vae=1.0739, dsb=17.0321, bio=0.0000
    Epoch  9/10: total=18.0521, vae=1.0749, dsb=16.9773, bio=0.0000
    Epoch 10/10: total=18.0301, vae=1.0731, dsb=16.9570, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.5825, vae=1.0740, dsb=0.5085, bio=0.0000
    Epoch  2/10: total=1.5304, vae=1.0745, dsb=0.4559, bio=0.0000
    Epoch  3/10: total=1.5268, vae=1.0748, dsb=0.4521, bio=0.0000
    Epoch  4/10: total=1.5113, vae=1.0751, dsb=0.4362, bio=0.0000
    Epoch  5/10: total=1.5057, vae=1.0741, dsb=0.4316, bio=0.0000
    Epoch  6/10: total=1.5025, vae=1.0746, dsb=0.4279, bio=0.0000
    Epoch  7/10: total=1.4852, vae=1.0737, dsb=0.4114, bio=0.0000
    Epoch  8/10: total=1.4928, vae=1.0738, dsb=0.4190, bio=0.0000
    Epoch  9/10: total=1.4879, vae=1.0734, dsb=0.4145, bio=0.0000
    Epoch 10/10: total=1.4823, vae=1.0742, dsb=0.4081, bio=0.0000

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=17.1736, vae=1.0743, dsb=16.0993, bio=0.0000
    Epoch  2/10: total=16.4998, vae=1.0740, dsb=15.4258, bio=0.0000
    Epoch  3/10: total=16.3393, vae=1.0750, dsb=15.2643, bio=0.0000
    Epoch  4/10: total=16.2933, vae=1.0747, dsb=15.2186, bio=0.0000
    Epoch  5/10: total=16.1980, vae=1.0746, dsb=15.1234, bio=0.0000
    Epoch  6/10: total=16.1892, vae=1.0746, dsb=15.1146, bio=0.0000
    Epoch  7/10: total=16.1215, vae=1.0742, dsb=15.0473, bio=0.0000
    Epoch  8/10: total=16.1672, vae=1.0741, dsb=15.0931, bio=0.0000
    Epoch  9/10: total=16.0528, vae=1.0745, dsb=14.9783, bio=0.0000
    Epoch 10/10: total=16.0935, vae=1.0742, dsb=15.0193, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.4067, vae=1.0739, dsb=0.3328, bio=0.0000
    Epoch  2/10: total=1.3972, vae=1.0740, dsb=0.3233, bio=0.0000
    Epoch  3/10: total=1.3860, vae=1.0735, dsb=0.3126, bio=0.0000
    Epoch  4/10: total=1.3913, vae=1.0739, dsb=0.3174, bio=0.0000
    Epoch  5/10: total=1.3842, vae=1.0744, dsb=0.3098, bio=0.0000
    Epoch  6/10: total=1.3808, vae=1.0740, dsb=0.3068, bio=0.0000
    Epoch  7/10: total=1.3820, vae=1.0740, dsb=0.3080, bio=0.0000
    Epoch  8/10: total=1.3882, vae=1.0741, dsb=0.3141, bio=0.0000
    Epoch  9/10: total=1.3787, vae=1.0744, dsb=0.3043, bio=0.0000
    Epoch 10/10: total=1.3668, vae=1.0740, dsb=0.2928, bio=0.0000

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=14.2560, vae=1.0746, dsb=13.1814, bio=0.0000
    Epoch  2/10: total=14.0107, vae=1.0736, dsb=12.9371, bio=0.0000
    Epoch  3/10: total=13.9446, vae=1.0747, dsb=12.8698, bio=0.0000
    Epoch  4/10: total=13.9823, vae=1.0742, dsb=12.9081, bio=0.0000
    Epoch  5/10: total=13.9009, vae=1.0739, dsb=12.8269, bio=0.0000
    Epoch  6/10: total=13.8500, vae=1.0745, dsb=12.7755, bio=0.0000
    Epoch  7/10: total=13.8393, vae=1.0740, dsb=12.7653, bio=0.0000
    Epoch  8/10: total=13.8561, vae=1.0749, dsb=12.7812, bio=0.0000
    Epoch  9/10: total=13.8633, vae=1.0740, dsb=12.7892, bio=0.0000
    Epoch 10/10: total=13.8855, vae=1.0745, dsb=12.8110, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.3540, vae=1.0738, dsb=0.2801, bio=0.0000
    Epoch  2/10: total=1.3490, vae=1.0741, dsb=0.2749, bio=0.0000
    Epoch  3/10: total=1.3515, vae=1.0737, dsb=0.2778, bio=0.0000
    Epoch  4/10: total=1.3424, vae=1.0738, dsb=0.2686, bio=0.0000
    Epoch  5/10: total=1.3412, vae=1.0746, dsb=0.2667, bio=0.0000
    Epoch  6/10: total=1.3416, vae=1.0737, dsb=0.2679, bio=0.0000
    Epoch  7/10: total=1.3385, vae=1.0750, dsb=0.2634, bio=0.0000
    Epoch  8/10: total=1.3322, vae=1.0743, dsb=0.2579, bio=0.0000
    Epoch  9/10: total=1.3356, vae=1.0738, dsb=0.2618, bio=0.0000
    Epoch 10/10: total=1.3406, vae=1.0739, dsb=0.2667, bio=0.0000

[Seed 73] Joint training (ablation) complete; models and history saved.

[Seed 73] Drift genes saved in /home/yyuan/ICB_TCE/iter_results/run_073

[Seed 73] run finished.

================================================================================
[Seed 74] Starting running whole pipeline...
================================================================================

[Seed 74] Starting VAE pre-training...

    Epoch [01/20], Beta: 0.000, Average Loss: 535.7040
    Epoch [02/20], Beta: 0.000, Average Loss: 301.4851
    Epoch [03/20], Beta: 0.000, Average Loss: 267.4735
    Epoch [04/20], Beta: 0.000, Average Loss: 248.7229
    Epoch [05/20], Beta: 0.100, Average Loss: 244.7757
    Epoch [06/20], Beta: 0.200, Average Loss: 244.3974
    Epoch [07/20], Beta: 0.300, Average Loss: 244.6933
    Epoch [08/20], Beta: 0.400, Average Loss: 245.6666
    Epoch [09/20], Beta: 0.500, Average Loss: 246.8339
    Epoch [10/20], Beta: 0.600, Average Loss: 248.1048
    Epoch [11/20], Beta: 0.700, Average Loss: 249.3153
    Epoch [12/20], Beta: 0.800, Average Loss: 250.5391
    Epoch [13/20], Beta: 0.900, Average Loss: 251.8226
    Epoch [14/20], Beta: 1.000, Average Loss: 253.4249
    Epoch [15/20], Beta: 1.000, Average Loss: 252.9685
    Epoch [16/20], Beta: 1.000, Average Loss: 252.6235
    Epoch [17/20], Beta: 1.000, Average Loss: 252.2072
    Epoch [18/20], Beta: 1.000, Average Loss: 251.9022
    Epoch [19/20], Beta: 1.000, Average Loss: 251.5250
    Epoch [20/20], Beta: 1.000, Average Loss: 251.3265

[Seed 74] VAE pre-training complete.

[Seed 74] Starting joint training (original)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=309.4246, vae=3.7386, dsb=289.4608, bio=32.4504
    Epoch  2/10: total=101.9999, vae=1.0986, dsb=100.8627, bio=0.0772
    Epoch  3/10: total=89.4483, vae=1.0938, dsb=88.3375, bio=0.0339
    Epoch  4/10: total=83.4405, vae=1.0920, dsb=82.3387, bio=0.0195
    Epoch  5/10: total=79.7780, vae=1.0911, dsb=78.6801, bio=0.0135
    Epoch  6/10: total=77.3987, vae=1.0907, dsb=76.3030, bio=0.0100
    Epoch  7/10: total=75.4716, vae=1.0907, dsb=74.3771, bio=0.0077
    Epoch  8/10: total=74.0957, vae=1.0898, dsb=73.0028, bio=0.0062
    Epoch  9/10: total=73.0431, vae=1.0895, dsb=71.9509, bio=0.0053
    Epoch 10/10: total=72.3045, vae=1.0901, dsb=71.2121, bio=0.0045

  [Backward Policy Training]
    Epoch  1/10: total=3.5160, vae=1.0912, dsb=2.4181, bio=0.0134
    Epoch  2/10: total=2.8796, vae=1.0884, dsb=1.7888, bio=0.0048
    Epoch  3/10: total=2.7465, vae=1.0879, dsb=1.6569, bio=0.0035
    Epoch  4/10: total=2.7141, vae=1.0884, dsb=1.6243, bio=0.0029
    Epoch  5/10: total=2.6522, vae=1.0874, dsb=1.5635, bio=0.0025
    Epoch  6/10: total=2.5792, vae=1.0880, dsb=1.4901, bio=0.0023
    Epoch  7/10: total=2.5403, vae=1.0872, dsb=1.4521, bio=0.0021
    Epoch  8/10: total=2.5211, vae=1.0873, dsb=1.4328, bio=0.0020
    Epoch  9/10: total=2.4631, vae=1.0874, dsb=1.3747, bio=0.0019
    Epoch 10/10: total=2.5102, vae=1.0868, dsb=1.4225, bio=0.0018

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=68.2057, vae=1.0910, dsb=67.1123, bio=0.0048
    Epoch  2/10: total=59.6671, vae=1.0883, dsb=58.5779, bio=0.0018
    Epoch  3/10: total=57.9203, vae=1.0881, dsb=56.8314, bio=0.0017
    Epoch  4/10: total=56.9069, vae=1.0887, dsb=55.8174, bio=0.0018
    Epoch  5/10: total=56.4521, vae=1.0873, dsb=55.3639, bio=0.0017
    Epoch  6/10: total=55.4389, vae=1.0874, dsb=54.3507, bio=0.0017
    Epoch  7/10: total=55.1374, vae=1.0877, dsb=54.0488, bio=0.0017
    Epoch  8/10: total=54.8149, vae=1.0875, dsb=53.7266, bio=0.0016
    Epoch  9/10: total=54.2638, vae=1.0881, dsb=53.1748, bio=0.0019
    Epoch 10/10: total=54.4268, vae=1.0868, dsb=53.3392, bio=0.0017

  [Backward Policy Training]
    Epoch  1/10: total=2.2333, vae=1.0875, dsb=1.1434, bio=0.0048
    Epoch  2/10: total=2.1260, vae=1.0862, dsb=1.0389, bio=0.0018
    Epoch  3/10: total=2.0531, vae=1.0856, dsb=0.9667, bio=0.0017
    Epoch  4/10: total=2.0461, vae=1.0860, dsb=0.9593, bio=0.0016
    Epoch  5/10: total=1.9867, vae=1.0856, dsb=0.9004, bio=0.0016
    Epoch  6/10: total=1.9693, vae=1.0855, dsb=0.8830, bio=0.0015
    Epoch  7/10: total=2.0051, vae=1.0858, dsb=0.9185, bio=0.0016
    Epoch  8/10: total=2.0226, vae=1.0859, dsb=0.9359, bio=0.0015
    Epoch  9/10: total=1.9874, vae=1.0853, dsb=0.9014, bio=0.0014
    Epoch 10/10: total=1.9539, vae=1.0861, dsb=0.8671, bio=0.0014

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=53.1899, vae=1.0893, dsb=52.0991, bio=0.0030
    Epoch  2/10: total=50.0624, vae=1.0866, dsb=48.9751, bio=0.0015
    Epoch  3/10: total=48.9198, vae=1.0868, dsb=47.8323, bio=0.0015
    Epoch  4/10: total=48.3207, vae=1.0862, dsb=47.2337, bio=0.0015
    Epoch  5/10: total=47.9935, vae=1.0867, dsb=46.9060, bio=0.0015
    Epoch  6/10: total=47.4520, vae=1.0867, dsb=46.3645, bio=0.0015
    Epoch  7/10: total=47.3849, vae=1.0850, dsb=46.2991, bio=0.0016
    Epoch  8/10: total=47.4986, vae=1.0865, dsb=46.4115, bio=0.0014
    Epoch  9/10: total=47.2553, vae=1.0867, dsb=46.1677, bio=0.0017
    Epoch 10/10: total=46.8254, vae=1.0863, dsb=45.7383, bio=0.0015

  [Backward Policy Training]
    Epoch  1/10: total=1.8619, vae=1.0867, dsb=0.7715, bio=0.0073
    Epoch  2/10: total=1.8002, vae=1.0860, dsb=0.7133, bio=0.0017
    Epoch  3/10: total=1.7650, vae=1.0856, dsb=0.6787, bio=0.0014
    Epoch  4/10: total=1.7573, vae=1.0859, dsb=0.6707, bio=0.0013
    Epoch  5/10: total=1.7562, vae=1.0857, dsb=0.6698, bio=0.0013
    Epoch  6/10: total=1.7247, vae=1.0850, dsb=0.6390, bio=0.0013
    Epoch  7/10: total=1.7483, vae=1.0856, dsb=0.6621, bio=0.0012
    Epoch  8/10: total=1.7257, vae=1.0857, dsb=0.6384, bio=0.0034
    Epoch  9/10: total=1.7526, vae=1.0852, dsb=0.6661, bio=0.0025
    Epoch 10/10: total=1.7309, vae=1.0852, dsb=0.6450, bio=0.0012

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=42.2319, vae=1.0878, dsb=41.1426, bio=0.0031
    Epoch  2/10: total=40.5373, vae=1.0861, dsb=39.4504, bio=0.0014
    Epoch  3/10: total=39.9899, vae=1.0859, dsb=38.9033, bio=0.0014
    Epoch  4/10: total=39.9757, vae=1.0868, dsb=38.8882, bio=0.0013
    Epoch  5/10: total=39.9741, vae=1.0859, dsb=38.8875, bio=0.0014
    Epoch  6/10: total=39.6939, vae=1.0854, dsb=38.6078, bio=0.0013
    Epoch  7/10: total=39.6653, vae=1.0857, dsb=38.5789, bio=0.0015
    Epoch  8/10: total=39.8103, vae=1.0857, dsb=38.7239, bio=0.0013
    Epoch  9/10: total=39.6250, vae=1.0860, dsb=38.5384, bio=0.0013
    Epoch 10/10: total=39.4802, vae=1.0853, dsb=38.3942, bio=0.0013

  [Backward Policy Training]
    Epoch  1/10: total=1.6854, vae=1.0868, dsb=0.5700, bio=0.0571
    Epoch  2/10: total=1.6200, vae=1.0849, dsb=0.5344, bio=0.0014
    Epoch  3/10: total=1.6132, vae=1.0849, dsb=0.5277, bio=0.0012
    Epoch  4/10: total=1.6075, vae=1.0837, dsb=0.5233, bio=0.0011
    Epoch  5/10: total=1.6001, vae=1.0845, dsb=0.5150, bio=0.0011
    Epoch  6/10: total=1.5948, vae=1.0850, dsb=0.5092, bio=0.0011
    Epoch  7/10: total=1.6141, vae=1.0843, dsb=0.5293, bio=0.0011
    Epoch  8/10: total=1.5863, vae=1.0851, dsb=0.5007, bio=0.0010
    Epoch  9/10: total=1.5781, vae=1.0846, dsb=0.4930, bio=0.0010
    Epoch 10/10: total=1.5805, vae=1.0846, dsb=0.4954, bio=0.0010

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=35.1553, vae=1.0874, dsb=34.0663, bio=0.0032
    Epoch  2/10: total=34.7850, vae=1.0859, dsb=33.6985, bio=0.0011
    Epoch  3/10: total=34.4542, vae=1.0858, dsb=33.3678, bio=0.0011
    Epoch  4/10: total=34.4076, vae=1.0860, dsb=33.3210, bio=0.0012
    Epoch  5/10: total=34.4771, vae=1.0861, dsb=33.3904, bio=0.0012
    Epoch  6/10: total=34.0883, vae=1.0860, dsb=33.0017, bio=0.0012
    Epoch  7/10: total=34.1063, vae=1.0858, dsb=33.0198, bio=0.0012
    Epoch  8/10: total=34.1528, vae=1.0851, dsb=33.0664, bio=0.0026
    Epoch  9/10: total=34.2163, vae=1.0850, dsb=33.1307, bio=0.0011
    Epoch 10/10: total=34.1166, vae=1.0853, dsb=33.0308, bio=0.0011

  [Backward Policy Training]
    Epoch  1/10: total=1.5851, vae=1.0860, dsb=0.4529, bio=0.0925
    Epoch  2/10: total=1.5458, vae=1.0851, dsb=0.4601, bio=0.0012
    Epoch  3/10: total=1.5381, vae=1.0848, dsb=0.4530, bio=0.0006
    Epoch  4/10: total=1.5305, vae=1.0845, dsb=0.4455, bio=0.0010
    Epoch  5/10: total=1.5424, vae=1.0846, dsb=0.4573, bio=0.0010
    Epoch  6/10: total=1.5236, vae=1.0849, dsb=0.4382, bio=0.0010
    Epoch  7/10: total=1.5220, vae=1.0843, dsb=0.4372, bio=0.0009
    Epoch  8/10: total=1.5309, vae=1.0850, dsb=0.4455, bio=0.0009
    Epoch  9/10: total=1.5333, vae=1.0839, dsb=0.4490, bio=0.0009
    Epoch 10/10: total=1.5230, vae=1.0855, dsb=0.4371, bio=0.0009

[Seed 74] Joint training (original) complete; models and history saved.

[Seed 74] Starting joint training (ablation)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=291.3459, vae=2.0720, dsb=289.2739, bio=0.0000
    Epoch  2/10: total=101.4703, vae=1.0817, dsb=100.3886, bio=0.0000
    Epoch  3/10: total=88.8273, vae=1.0797, dsb=87.7476, bio=0.0000
    Epoch  4/10: total=82.8322, vae=1.0788, dsb=81.7534, bio=0.0000
    Epoch  5/10: total=79.2494, vae=1.0783, dsb=78.1711, bio=0.0000
    Epoch  6/10: total=76.9609, vae=1.0782, dsb=75.8827, bio=0.0000
    Epoch  7/10: total=75.0200, vae=1.0785, dsb=73.9415, bio=0.0000
    Epoch  8/10: total=73.6703, vae=1.0779, dsb=72.5924, bio=0.0000
    Epoch  9/10: total=72.6682, vae=1.0779, dsb=71.5903, bio=0.0000
    Epoch 10/10: total=71.9915, vae=1.0787, dsb=70.9128, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=3.4027, vae=1.0788, dsb=2.3239, bio=0.0000
    Epoch  2/10: total=2.7872, vae=1.0776, dsb=1.7096, bio=0.0000
    Epoch  3/10: total=2.6550, vae=1.0775, dsb=1.5774, bio=0.0000
    Epoch  4/10: total=2.6248, vae=1.0784, dsb=1.5464, bio=0.0000
    Epoch  5/10: total=2.5648, vae=1.0776, dsb=1.4872, bio=0.0000
    Epoch  6/10: total=2.4970, vae=1.0783, dsb=1.4187, bio=0.0000
    Epoch  7/10: total=2.4592, vae=1.0776, dsb=1.3816, bio=0.0000
    Epoch  8/10: total=2.4413, vae=1.0779, dsb=1.3635, bio=0.0000
    Epoch  9/10: total=2.3864, vae=1.0780, dsb=1.3083, bio=0.0000
    Epoch 10/10: total=2.4318, vae=1.0775, dsb=1.3544, bio=0.0000

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=67.3536, vae=1.0779, dsb=66.2757, bio=0.0000
    Epoch  2/10: total=58.8980, vae=1.0776, dsb=57.8205, bio=0.0000
    Epoch  3/10: total=57.3100, vae=1.0775, dsb=56.2325, bio=0.0000
    Epoch  4/10: total=56.3952, vae=1.0783, dsb=55.3169, bio=0.0000
    Epoch  5/10: total=56.0350, vae=1.0770, dsb=54.9580, bio=0.0000
    Epoch  6/10: total=54.9555, vae=1.0772, dsb=53.8783, bio=0.0000
    Epoch  7/10: total=54.7447, vae=1.0775, dsb=53.6672, bio=0.0000
    Epoch  8/10: total=54.4746, vae=1.0774, dsb=53.3972, bio=0.0000
    Epoch  9/10: total=53.9249, vae=1.0781, dsb=52.8468, bio=0.0000
    Epoch 10/10: total=54.1192, vae=1.0769, dsb=53.0423, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=2.1516, vae=1.0771, dsb=1.0745, bio=0.0000
    Epoch  2/10: total=2.0568, vae=1.0772, dsb=0.9795, bio=0.0000
    Epoch  3/10: total=1.9861, vae=1.0768, dsb=0.9093, bio=0.0000
    Epoch  4/10: total=1.9805, vae=1.0773, dsb=0.9032, bio=0.0000
    Epoch  5/10: total=1.9242, vae=1.0769, dsb=0.8473, bio=0.0000
    Epoch  6/10: total=1.9075, vae=1.0770, dsb=0.8305, bio=0.0000
    Epoch  7/10: total=1.9422, vae=1.0772, dsb=0.8650, bio=0.0000
    Epoch  8/10: total=1.9596, vae=1.0775, dsb=0.8821, bio=0.0000
    Epoch  9/10: total=1.9262, vae=1.0768, dsb=0.8493, bio=0.0000
    Epoch 10/10: total=1.8938, vae=1.0777, dsb=0.8161, bio=0.0000

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=48.3969, vae=1.0784, dsb=47.3185, bio=0.0000
    Epoch  2/10: total=45.5370, vae=1.0767, dsb=44.4602, bio=0.0000
    Epoch  3/10: total=44.5948, vae=1.0772, dsb=43.5177, bio=0.0000
    Epoch  4/10: total=44.0751, vae=1.0767, dsb=42.9983, bio=0.0000
    Epoch  5/10: total=43.8164, vae=1.0773, dsb=42.7390, bio=0.0000
    Epoch  6/10: total=43.3111, vae=1.0775, dsb=42.2336, bio=0.0000
    Epoch  7/10: total=43.2795, vae=1.0757, dsb=42.2037, bio=0.0000
    Epoch  8/10: total=43.4081, vae=1.0772, dsb=42.3309, bio=0.0000
    Epoch  9/10: total=43.1801, vae=1.0776, dsb=42.1025, bio=0.0000
    Epoch 10/10: total=42.8204, vae=1.0773, dsb=41.7431, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.7765, vae=1.0773, dsb=0.6992, bio=0.0000
    Epoch  2/10: total=1.7242, vae=1.0776, dsb=0.6466, bio=0.0000
    Epoch  3/10: total=1.6926, vae=1.0775, dsb=0.6152, bio=0.0000
    Epoch  4/10: total=1.6856, vae=1.0778, dsb=0.6078, bio=0.0000
    Epoch  5/10: total=1.6851, vae=1.0777, dsb=0.6075, bio=0.0000
    Epoch  6/10: total=1.6568, vae=1.0770, dsb=0.5798, bio=0.0000
    Epoch  7/10: total=1.6783, vae=1.0776, dsb=0.6007, bio=0.0000
    Epoch  8/10: total=1.6570, vae=1.0778, dsb=0.5792, bio=0.0000
    Epoch  9/10: total=1.6820, vae=1.0773, dsb=0.6047, bio=0.0000
    Epoch 10/10: total=1.6635, vae=1.0774, dsb=0.5861, bio=0.0000

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=39.2737, vae=1.0768, dsb=38.1969, bio=0.0000
    Epoch  2/10: total=37.7801, vae=1.0769, dsb=36.7032, bio=0.0000
    Epoch  3/10: total=37.2576, vae=1.0770, dsb=36.1806, bio=0.0000
    Epoch  4/10: total=37.1826, vae=1.0780, dsb=36.1046, bio=0.0000
    Epoch  5/10: total=37.2229, vae=1.0772, dsb=36.1457, bio=0.0000
    Epoch  6/10: total=36.9769, vae=1.0767, dsb=35.9001, bio=0.0000
    Epoch  7/10: total=36.9639, vae=1.0771, dsb=35.8869, bio=0.0000
    Epoch  8/10: total=37.1570, vae=1.0773, dsb=36.0797, bio=0.0000
    Epoch  9/10: total=36.9378, vae=1.0777, dsb=35.8602, bio=0.0000
    Epoch 10/10: total=36.8158, vae=1.0770, dsb=35.7388, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.5808, vae=1.0778, dsb=0.5030, bio=0.0000
    Epoch  2/10: total=1.5481, vae=1.0769, dsb=0.4712, bio=0.0000
    Epoch  3/10: total=1.5427, vae=1.0771, dsb=0.4655, bio=0.0000
    Epoch  4/10: total=1.5375, vae=1.0759, dsb=0.4616, bio=0.0000
    Epoch  5/10: total=1.5315, vae=1.0768, dsb=0.4546, bio=0.0000
    Epoch  6/10: total=1.5269, vae=1.0773, dsb=0.4497, bio=0.0000
    Epoch  7/10: total=1.5445, vae=1.0767, dsb=0.4678, bio=0.0000
    Epoch  8/10: total=1.5200, vae=1.0775, dsb=0.4425, bio=0.0000
    Epoch  9/10: total=1.5126, vae=1.0770, dsb=0.4356, bio=0.0000
    Epoch 10/10: total=1.5150, vae=1.0771, dsb=0.4380, bio=0.0000

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=33.0488, vae=1.0770, dsb=31.9718, bio=0.0000
    Epoch  2/10: total=32.7078, vae=1.0770, dsb=31.6308, bio=0.0000
    Epoch  3/10: total=32.3876, vae=1.0770, dsb=31.3106, bio=0.0000
    Epoch  4/10: total=32.3744, vae=1.0773, dsb=31.2970, bio=0.0000
    Epoch  5/10: total=32.4553, vae=1.0776, dsb=31.3777, bio=0.0000
    Epoch  6/10: total=32.1025, vae=1.0777, dsb=31.0248, bio=0.0000
    Epoch  7/10: total=32.1213, vae=1.0776, dsb=31.0436, bio=0.0000
    Epoch  8/10: total=32.1062, vae=1.0771, dsb=31.0292, bio=0.0000
    Epoch  9/10: total=32.1968, vae=1.0770, dsb=31.1197, bio=0.0000
    Epoch 10/10: total=32.0920, vae=1.0773, dsb=31.0147, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.4739, vae=1.0771, dsb=0.3968, bio=0.0000
    Epoch  2/10: total=1.4826, vae=1.0774, dsb=0.4052, bio=0.0000
    Epoch  3/10: total=1.4766, vae=1.0771, dsb=0.3995, bio=0.0000
    Epoch  4/10: total=1.4699, vae=1.0771, dsb=0.3929, bio=0.0000
    Epoch  5/10: total=1.4808, vae=1.0772, dsb=0.4035, bio=0.0000
    Epoch  6/10: total=1.4639, vae=1.0775, dsb=0.3864, bio=0.0000
    Epoch  7/10: total=1.4625, vae=1.0769, dsb=0.3856, bio=0.0000
    Epoch  8/10: total=1.4711, vae=1.0776, dsb=0.3935, bio=0.0000
    Epoch  9/10: total=1.4730, vae=1.0765, dsb=0.3965, bio=0.0000
    Epoch 10/10: total=1.4642, vae=1.0783, dsb=0.3859, bio=0.0000

[Seed 74] Joint training (ablation) complete; models and history saved.

[Seed 74] Drift genes saved in /home/yyuan/ICB_TCE/iter_results/run_074

[Seed 74] run finished.

================================================================================
[Seed 75] Starting running whole pipeline...
================================================================================

[Seed 75] Starting VAE pre-training...

    Epoch [01/20], Beta: 0.000, Average Loss: 535.5734
    Epoch [02/20], Beta: 0.000, Average Loss: 309.8879
    Epoch [03/20], Beta: 0.000, Average Loss: 273.1974
    Epoch [04/20], Beta: 0.000, Average Loss: 251.7204
    Epoch [05/20], Beta: 0.100, Average Loss: 246.7841
    Epoch [06/20], Beta: 0.200, Average Loss: 245.2572
    Epoch [07/20], Beta: 0.300, Average Loss: 244.7386
    Epoch [08/20], Beta: 0.400, Average Loss: 245.2614
    Epoch [09/20], Beta: 0.500, Average Loss: 246.1994
    Epoch [10/20], Beta: 0.600, Average Loss: 247.4190
    Epoch [11/20], Beta: 0.700, Average Loss: 248.7737
    Epoch [12/20], Beta: 0.800, Average Loss: 250.0852
    Epoch [13/20], Beta: 0.900, Average Loss: 251.4139
    Epoch [14/20], Beta: 1.000, Average Loss: 252.7065
    Epoch [15/20], Beta: 1.000, Average Loss: 252.3344
    Epoch [16/20], Beta: 1.000, Average Loss: 251.9480
    Epoch [17/20], Beta: 1.000, Average Loss: 251.6543
    Epoch [18/20], Beta: 1.000, Average Loss: 251.3521
    Epoch [19/20], Beta: 1.000, Average Loss: 251.0904
    Epoch [20/20], Beta: 1.000, Average Loss: 250.7744

[Seed 75] VAE pre-training complete.

[Seed 75] Starting joint training (original)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=589.9005, vae=3.4487, dsb=576.2926, bio=20.3185
    Epoch  2/10: total=162.4369, vae=1.1153, dsb=161.2910, bio=0.0612
    Epoch  3/10: total=150.8727, vae=1.1112, dsb=149.7476, bio=0.0279
    Epoch  4/10: total=146.2388, vae=1.1091, dsb=145.1218, bio=0.0157
    Epoch  5/10: total=142.5676, vae=1.1077, dsb=141.4544, bio=0.0110
    Epoch  6/10: total=140.4511, vae=1.1065, dsb=139.3405, bio=0.0083
    Epoch  7/10: total=139.2647, vae=1.1055, dsb=138.1560, bio=0.0065
    Epoch  8/10: total=138.1787, vae=1.1055, dsb=137.0705, bio=0.0054
    Epoch  9/10: total=136.9766, vae=1.1055, dsb=135.8688, bio=0.0047
    Epoch 10/10: total=136.3224, vae=1.1054, dsb=135.2150, bio=0.0041

  [Backward Policy Training]
    Epoch  1/10: total=3.5688, vae=1.1063, dsb=2.4556, bio=0.0138
    Epoch  2/10: total=3.0746, vae=1.1061, dsb=1.9663, bio=0.0045
    Epoch  3/10: total=2.9085, vae=1.1055, dsb=1.8013, bio=0.0032
    Epoch  4/10: total=2.8757, vae=1.1041, dsb=1.7702, bio=0.0027
    Epoch  5/10: total=2.7800, vae=1.1033, dsb=1.6754, bio=0.0025
    Epoch  6/10: total=2.8257, vae=1.1037, dsb=1.7209, bio=0.0023
    Epoch  7/10: total=2.7541, vae=1.1036, dsb=1.6494, bio=0.0021
    Epoch  8/10: total=2.6953, vae=1.1025, dsb=1.5918, bio=0.0020
    Epoch  9/10: total=2.7232, vae=1.1026, dsb=1.6196, bio=0.0020
    Epoch 10/10: total=2.7172, vae=1.1040, dsb=1.6122, bio=0.0019

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=114.0122, vae=1.1059, dsb=112.9047, bio=0.0032
    Epoch  2/10: total=109.1101, vae=1.1049, dsb=108.0041, bio=0.0023
    Epoch  3/10: total=107.7589, vae=1.1046, dsb=106.6533, bio=0.0019
    Epoch  4/10: total=106.8280, vae=1.1040, dsb=105.7231, bio=0.0019
    Epoch  5/10: total=106.6485, vae=1.1043, dsb=105.5433, bio=0.0019
    Epoch  6/10: total=106.3814, vae=1.1039, dsb=105.2766, bio=0.0019
    Epoch  7/10: total=105.6716, vae=1.1037, dsb=104.5670, bio=0.0019
    Epoch  8/10: total=104.9833, vae=1.1030, dsb=103.8793, bio=0.0019
    Epoch  9/10: total=105.1566, vae=1.1029, dsb=104.0527, bio=0.0019
    Epoch 10/10: total=105.2904, vae=1.1035, dsb=104.1856, bio=0.0025

  [Backward Policy Training]
    Epoch  1/10: total=2.4354, vae=1.1045, dsb=1.3281, bio=0.0056
    Epoch  2/10: total=2.2946, vae=1.1020, dsb=1.1916, bio=0.0020
    Epoch  3/10: total=2.3332, vae=1.1030, dsb=1.2294, bio=0.0018
    Epoch  4/10: total=2.2725, vae=1.1014, dsb=1.1702, bio=0.0017
    Epoch  5/10: total=2.2410, vae=1.1018, dsb=1.1384, bio=0.0017
    Epoch  6/10: total=2.2136, vae=1.1016, dsb=1.1111, bio=0.0017
    Epoch  7/10: total=2.2405, vae=1.1024, dsb=1.1373, bio=0.0016
    Epoch  8/10: total=2.2186, vae=1.1024, dsb=1.1154, bio=0.0016
    Epoch  9/10: total=2.2145, vae=1.1020, dsb=1.1117, bio=0.0016
    Epoch 10/10: total=2.2180, vae=1.1010, dsb=1.1162, bio=0.0016

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=96.3911, vae=1.1038, dsb=95.2858, bio=0.0030
    Epoch  2/10: total=94.8867, vae=1.1032, dsb=93.7824, bio=0.0023
    Epoch  3/10: total=93.9411, vae=1.1028, dsb=92.8375, bio=0.0016
    Epoch  4/10: total=94.4596, vae=1.1032, dsb=93.3556, bio=0.0016
    Epoch  5/10: total=94.4589, vae=1.1021, dsb=93.3560, bio=0.0016
    Epoch  6/10: total=93.5327, vae=1.1028, dsb=92.4290, bio=0.0016
    Epoch  7/10: total=92.8666, vae=1.1025, dsb=91.7633, bio=0.0017
    Epoch  8/10: total=93.5521, vae=1.1021, dsb=92.4491, bio=0.0017
    Epoch  9/10: total=93.2333, vae=1.1020, dsb=92.1304, bio=0.0016
    Epoch 10/10: total=92.9003, vae=1.1018, dsb=91.7977, bio=0.0017

  [Backward Policy Training]
    Epoch  1/10: total=2.0866, vae=1.1025, dsb=0.9773, bio=0.0135
    Epoch  2/10: total=2.0374, vae=1.1012, dsb=0.9354, bio=0.0017
    Epoch  3/10: total=2.0344, vae=1.1021, dsb=0.9316, bio=0.0015
    Epoch  4/10: total=2.0309, vae=1.1013, dsb=0.9289, bio=0.0015
    Epoch  5/10: total=2.0209, vae=1.1012, dsb=0.9189, bio=0.0016
    Epoch  6/10: total=1.9853, vae=1.1013, dsb=0.8832, bio=0.0014
    Epoch  7/10: total=1.9675, vae=1.1016, dsb=0.8652, bio=0.0014
    Epoch  8/10: total=1.9759, vae=1.1006, dsb=0.8745, bio=0.0014
    Epoch  9/10: total=1.9470, vae=1.1013, dsb=0.8449, bio=0.0014
    Epoch 10/10: total=1.9622, vae=1.1009, dsb=0.8606, bio=0.0014

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=81.6968, vae=1.1040, dsb=80.5913, bio=0.0028
    Epoch  2/10: total=80.9346, vae=1.1026, dsb=79.8313, bio=0.0014
    Epoch  3/10: total=81.1023, vae=1.1013, dsb=80.0003, bio=0.0015
    Epoch  4/10: total=80.3667, vae=1.1022, dsb=79.2638, bio=0.0015
    Epoch  5/10: total=80.6863, vae=1.1020, dsb=79.5835, bio=0.0017
    Epoch  6/10: total=80.4915, vae=1.1010, dsb=79.3900, bio=0.0012
    Epoch  7/10: total=80.5842, vae=1.1019, dsb=79.4814, bio=0.0019
    Epoch  8/10: total=80.6743, vae=1.1011, dsb=79.5725, bio=0.0015
    Epoch  9/10: total=80.1144, vae=1.1017, dsb=79.0120, bio=0.0015
    Epoch 10/10: total=80.3770, vae=1.1013, dsb=79.2749, bio=0.0014

  [Backward Policy Training]
    Epoch  1/10: total=1.9128, vae=1.1031, dsb=0.7922, bio=0.0350
    Epoch  2/10: total=1.8865, vae=1.1003, dsb=0.7856, bio=0.0015
    Epoch  3/10: total=1.8632, vae=1.1018, dsb=0.7607, bio=0.0014
    Epoch  4/10: total=1.8775, vae=1.1004, dsb=0.7765, bio=0.0013
    Epoch  5/10: total=1.8506, vae=1.1020, dsb=0.7479, bio=0.0014
    Epoch  6/10: total=1.8707, vae=1.1011, dsb=0.7690, bio=0.0012
    Epoch  7/10: total=1.8578, vae=1.1010, dsb=0.7562, bio=0.0012
    Epoch  8/10: total=1.8568, vae=1.1003, dsb=0.7559, bio=0.0013
    Epoch  9/10: total=1.8521, vae=1.1011, dsb=0.7505, bio=0.0012
    Epoch 10/10: total=1.8601, vae=1.1004, dsb=0.7591, bio=0.0013

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=70.2409, vae=1.1036, dsb=69.1356, bio=0.0032
    Epoch  2/10: total=69.9445, vae=1.1015, dsb=68.8423, bio=0.0013
    Epoch  3/10: total=70.0255, vae=1.1019, dsb=68.9230, bio=0.0013
    Epoch  4/10: total=70.0085, vae=1.1022, dsb=68.9056, bio=0.0013
    Epoch  5/10: total=69.9505, vae=1.1020, dsb=68.8477, bio=0.0014
    Epoch  6/10: total=69.7231, vae=1.1013, dsb=68.6212, bio=0.0013
    Epoch  7/10: total=70.1662, vae=1.1003, dsb=69.0652, bio=0.0012
    Epoch  8/10: total=69.8338, vae=1.1016, dsb=68.7315, bio=0.0012
    Epoch  9/10: total=69.7757, vae=1.1012, dsb=68.6739, bio=0.0012
    Epoch 10/10: total=70.0567, vae=1.1005, dsb=68.9556, bio=0.0012

  [Backward Policy Training]
    Epoch  1/10: total=1.8602, vae=1.1029, dsb=0.7040, bio=0.1065
    Epoch  2/10: total=1.7878, vae=1.1008, dsb=0.6863, bio=0.0013
    Epoch  3/10: total=1.7768, vae=1.1021, dsb=0.6741, bio=0.0012
    Epoch  4/10: total=1.7721, vae=1.1007, dsb=0.6708, bio=0.0012
    Epoch  5/10: total=1.7888, vae=1.1006, dsb=0.6877, bio=0.0011
    Epoch  6/10: total=1.7600, vae=1.0996, dsb=0.6599, bio=0.0011
    Epoch  7/10: total=1.7738, vae=1.0999, dsb=0.6733, bio=0.0012
    Epoch  8/10: total=1.7785, vae=1.0997, dsb=0.6784, bio=0.0010
    Epoch  9/10: total=1.7474, vae=1.1009, dsb=0.6460, bio=0.0010
    Epoch 10/10: total=1.7653, vae=1.1000, dsb=0.6648, bio=0.0012

[Seed 75] Joint training (original) complete; models and history saved.

[Seed 75] Starting joint training (ablation)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=577.6670, vae=2.0248, dsb=575.6422, bio=0.0000
    Epoch  2/10: total=161.3939, vae=1.0965, dsb=160.2974, bio=0.0000
    Epoch  3/10: total=150.1051, vae=1.0963, dsb=149.0087, bio=0.0000
    Epoch  4/10: total=145.7100, vae=1.0958, dsb=144.6142, bio=0.0000
    Epoch  5/10: total=142.0152, vae=1.0950, dsb=140.9202, bio=0.0000
    Epoch  6/10: total=139.9073, vae=1.0940, dsb=138.8133, bio=0.0000
    Epoch  7/10: total=138.6768, vae=1.0934, dsb=137.5835, bio=0.0000
    Epoch  8/10: total=137.5274, vae=1.0936, dsb=136.4338, bio=0.0000
    Epoch  9/10: total=136.2978, vae=1.0939, dsb=135.2039, bio=0.0000
    Epoch 10/10: total=135.6697, vae=1.0940, dsb=134.5757, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=3.4117, vae=1.0938, dsb=2.3180, bio=0.0000
    Epoch  2/10: total=2.9484, vae=1.0953, dsb=1.8531, bio=0.0000
    Epoch  3/10: total=2.7929, vae=1.0952, dsb=1.6977, bio=0.0000
    Epoch  4/10: total=2.7631, vae=1.0941, dsb=1.6690, bio=0.0000
    Epoch  5/10: total=2.6732, vae=1.0936, dsb=1.5797, bio=0.0000
    Epoch  6/10: total=2.7176, vae=1.0941, dsb=1.6236, bio=0.0000
    Epoch  7/10: total=2.6503, vae=1.0941, dsb=1.5562, bio=0.0000
    Epoch  8/10: total=2.5941, vae=1.0930, dsb=1.5011, bio=0.0000
    Epoch  9/10: total=2.6219, vae=1.0932, dsb=1.5287, bio=0.0000
    Epoch 10/10: total=2.6142, vae=1.0948, dsb=1.5194, bio=0.0000

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=111.7179, vae=1.0936, dsb=110.6243, bio=0.0000
    Epoch  2/10: total=107.0756, vae=1.0942, dsb=105.9814, bio=0.0000
    Epoch  3/10: total=105.7666, vae=1.0942, dsb=104.6724, bio=0.0000
    Epoch  4/10: total=104.9346, vae=1.0936, dsb=103.8410, bio=0.0000
    Epoch  5/10: total=104.8002, vae=1.0941, dsb=103.7062, bio=0.0000
    Epoch  6/10: total=104.5622, vae=1.0938, dsb=103.4684, bio=0.0000
    Epoch  7/10: total=103.8238, vae=1.0937, dsb=102.7301, bio=0.0000
    Epoch  8/10: total=103.2043, vae=1.0930, dsb=102.1113, bio=0.0000
    Epoch  9/10: total=103.4198, vae=1.0930, dsb=102.3268, bio=0.0000
    Epoch 10/10: total=103.5946, vae=1.0936, dsb=102.5010, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=2.3264, vae=1.0940, dsb=1.2324, bio=0.0000
    Epoch  2/10: total=2.1984, vae=1.0931, dsb=1.1053, bio=0.0000
    Epoch  3/10: total=2.2369, vae=1.0941, dsb=1.1428, bio=0.0000
    Epoch  4/10: total=2.1824, vae=1.0927, dsb=1.0898, bio=0.0000
    Epoch  5/10: total=2.1532, vae=1.0930, dsb=1.0602, bio=0.0000
    Epoch  6/10: total=2.1278, vae=1.0930, dsb=1.0348, bio=0.0000
    Epoch  7/10: total=2.1550, vae=1.0938, dsb=1.0612, bio=0.0000
    Epoch  8/10: total=2.1348, vae=1.0939, dsb=1.0409, bio=0.0000
    Epoch  9/10: total=2.1314, vae=1.0934, dsb=1.0380, bio=0.0000
    Epoch 10/10: total=2.1361, vae=1.0925, dsb=1.0436, bio=0.0000

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=96.2269, vae=1.0925, dsb=95.1343, bio=0.0000
    Epoch  2/10: total=95.0418, vae=1.0933, dsb=93.9485, bio=0.0000
    Epoch  3/10: total=94.0780, vae=1.0932, dsb=92.9848, bio=0.0000
    Epoch  4/10: total=94.6846, vae=1.0937, dsb=93.5909, bio=0.0000
    Epoch  5/10: total=94.7762, vae=1.0926, dsb=93.6836, bio=0.0000
    Epoch  6/10: total=93.8639, vae=1.0935, dsb=92.7704, bio=0.0000
    Epoch  7/10: total=93.1401, vae=1.0932, dsb=92.0469, bio=0.0000
    Epoch  8/10: total=93.8884, vae=1.0929, dsb=92.7955, bio=0.0000
    Epoch  9/10: total=93.5402, vae=1.0929, dsb=92.4473, bio=0.0000
    Epoch 10/10: total=93.2562, vae=1.0927, dsb=92.1635, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.9897, vae=1.0928, dsb=0.8969, bio=0.0000
    Epoch  2/10: total=1.9540, vae=1.0928, dsb=0.8612, bio=0.0000
    Epoch  3/10: total=1.9540, vae=1.0938, dsb=0.8602, bio=0.0000
    Epoch  4/10: total=1.9516, vae=1.0930, dsb=0.8586, bio=0.0000
    Epoch  5/10: total=1.9431, vae=1.0929, dsb=0.8502, bio=0.0000
    Epoch  6/10: total=1.9113, vae=1.0932, dsb=0.8181, bio=0.0000
    Epoch  7/10: total=1.8951, vae=1.0935, dsb=0.8017, bio=0.0000
    Epoch  8/10: total=1.9028, vae=1.0926, dsb=0.8102, bio=0.0000
    Epoch  9/10: total=1.8768, vae=1.0933, dsb=0.7835, bio=0.0000
    Epoch 10/10: total=1.8918, vae=1.0930, dsb=0.7988, bio=0.0000

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=79.7457, vae=1.0933, dsb=78.6523, bio=0.0000
    Epoch  2/10: total=79.0464, vae=1.0932, dsb=77.9532, bio=0.0000
    Epoch  3/10: total=79.2628, vae=1.0923, dsb=78.1705, bio=0.0000
    Epoch  4/10: total=78.5568, vae=1.0934, dsb=77.4634, bio=0.0000
    Epoch  5/10: total=78.8703, vae=1.0931, dsb=77.7772, bio=0.0000
    Epoch  6/10: total=78.6868, vae=1.0923, dsb=77.5945, bio=0.0000
    Epoch  7/10: total=78.7274, vae=1.0933, dsb=77.6341, bio=0.0000
    Epoch  8/10: total=78.8971, vae=1.0926, dsb=77.8045, bio=0.0000
    Epoch  9/10: total=78.3284, vae=1.0932, dsb=77.2352, bio=0.0000
    Epoch 10/10: total=78.6191, vae=1.0928, dsb=77.5263, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.8218, vae=1.0939, dsb=0.7279, bio=0.0000
    Epoch  2/10: total=1.8154, vae=1.0922, dsb=0.7231, bio=0.0000
    Epoch  3/10: total=1.7946, vae=1.0939, dsb=0.7007, bio=0.0000
    Epoch  4/10: total=1.8086, vae=1.0925, dsb=0.7161, bio=0.0000
    Epoch  5/10: total=1.7836, vae=1.0943, dsb=0.6893, bio=0.0000
    Epoch  6/10: total=1.8037, vae=1.0935, dsb=0.7102, bio=0.0000
    Epoch  7/10: total=1.7924, vae=1.0935, dsb=0.6989, bio=0.0000
    Epoch  8/10: total=1.7914, vae=1.0928, dsb=0.6985, bio=0.0000
    Epoch  9/10: total=1.7874, vae=1.0937, dsb=0.6937, bio=0.0000
    Epoch 10/10: total=1.7952, vae=1.0930, dsb=0.7022, bio=0.0000

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=67.1856, vae=1.0934, dsb=66.0923, bio=0.0000
    Epoch  2/10: total=66.8641, vae=1.0925, dsb=65.7716, bio=0.0000
    Epoch  3/10: total=66.9107, vae=1.0931, dsb=65.8176, bio=0.0000
    Epoch  4/10: total=66.9210, vae=1.0935, dsb=65.8275, bio=0.0000
    Epoch  5/10: total=66.9091, vae=1.0937, dsb=65.8154, bio=0.0000
    Epoch  6/10: total=66.6400, vae=1.0931, dsb=65.5469, bio=0.0000
    Epoch  7/10: total=67.0830, vae=1.0922, dsb=65.9907, bio=0.0000
    Epoch  8/10: total=66.8376, vae=1.0936, dsb=65.7439, bio=0.0000
    Epoch  9/10: total=66.7239, vae=1.0933, dsb=65.6307, bio=0.0000
    Epoch 10/10: total=66.9878, vae=1.0926, dsb=65.8952, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.7341, vae=1.0939, dsb=0.6403, bio=0.0000
    Epoch  2/10: total=1.7171, vae=1.0932, dsb=0.6239, bio=0.0000
    Epoch  3/10: total=1.7073, vae=1.0945, dsb=0.6127, bio=0.0000
    Epoch  4/10: total=1.7034, vae=1.0935, dsb=0.6099, bio=0.0000
    Epoch  5/10: total=1.7189, vae=1.0934, dsb=0.6255, bio=0.0000
    Epoch  6/10: total=1.6924, vae=1.0926, dsb=0.5998, bio=0.0000
    Epoch  7/10: total=1.7052, vae=1.0929, dsb=0.6123, bio=0.0000
    Epoch  8/10: total=1.7097, vae=1.0928, dsb=0.6169, bio=0.0000
    Epoch  9/10: total=1.6812, vae=1.0940, dsb=0.5871, bio=0.0000
    Epoch 10/10: total=1.6975, vae=1.0932, dsb=0.6043, bio=0.0000

[Seed 75] Joint training (ablation) complete; models and history saved.

[Seed 75] Drift genes saved in /home/yyuan/ICB_TCE/iter_results/run_075

[Seed 75] run finished.

================================================================================
[Seed 76] Starting running whole pipeline...
================================================================================

[Seed 76] Starting VAE pre-training...

    Epoch [01/20], Beta: 0.000, Average Loss: 536.3694
    Epoch [02/20], Beta: 0.000, Average Loss: 309.4120
    Epoch [03/20], Beta: 0.000, Average Loss: 274.0987
    Epoch [04/20], Beta: 0.000, Average Loss: 252.3713
    Epoch [05/20], Beta: 0.100, Average Loss: 246.7794
    Epoch [06/20], Beta: 0.200, Average Loss: 245.7600
    Epoch [07/20], Beta: 0.300, Average Loss: 245.7502
    Epoch [08/20], Beta: 0.400, Average Loss: 246.3484
    Epoch [09/20], Beta: 0.500, Average Loss: 247.2752
    Epoch [10/20], Beta: 0.600, Average Loss: 248.3627
    Epoch [11/20], Beta: 0.700, Average Loss: 249.5407
    Epoch [12/20], Beta: 0.800, Average Loss: 250.8212
    Epoch [13/20], Beta: 0.900, Average Loss: 252.0310
    Epoch [14/20], Beta: 1.000, Average Loss: 253.6173
    Epoch [15/20], Beta: 1.000, Average Loss: 253.2124
    Epoch [16/20], Beta: 1.000, Average Loss: 252.7949
    Epoch [17/20], Beta: 1.000, Average Loss: 252.4735
    Epoch [18/20], Beta: 1.000, Average Loss: 252.1131
    Epoch [19/20], Beta: 1.000, Average Loss: 251.7179
    Epoch [20/20], Beta: 1.000, Average Loss: 251.5982

[Seed 76] VAE pre-training complete.

[Seed 76] Starting joint training (original)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=266.0264, vae=3.7610, dsb=243.6803, bio=37.1703
    Epoch  2/10: total=76.0749, vae=1.1048, dsb=74.9362, bio=0.0680
    Epoch  3/10: total=65.8752, vae=1.0994, dsb=64.7607, bio=0.0302
    Epoch  4/10: total=60.6813, vae=1.0977, dsb=59.5748, bio=0.0177
    Epoch  5/10: total=57.7364, vae=1.0964, dsb=56.6340, bio=0.0119
    Epoch  6/10: total=55.5649, vae=1.0950, dsb=54.4655, bio=0.0087
    Epoch  7/10: total=54.1304, vae=1.0954, dsb=53.0316, bio=0.0068
    Epoch  8/10: total=52.8684, vae=1.0944, dsb=51.7713, bio=0.0055
    Epoch  9/10: total=52.0057, vae=1.0944, dsb=50.9089, bio=0.0047
    Epoch 10/10: total=51.0694, vae=1.0939, dsb=49.9734, bio=0.0041

  [Backward Policy Training]
    Epoch  1/10: total=3.0251, vae=1.0949, dsb=1.9242, bio=0.0120
    Epoch  2/10: total=2.5321, vae=1.0930, dsb=1.4370, bio=0.0042
    Epoch  3/10: total=2.4261, vae=1.0923, dsb=1.3323, bio=0.0032
    Epoch  4/10: total=2.4080, vae=1.0926, dsb=1.3141, bio=0.0027
    Epoch  5/10: total=2.3614, vae=1.0924, dsb=1.2676, bio=0.0027
    Epoch  6/10: total=2.3015, vae=1.0918, dsb=1.2085, bio=0.0023
    Epoch  7/10: total=2.2764, vae=1.0916, dsb=1.1837, bio=0.0021
    Epoch  8/10: total=2.2407, vae=1.0917, dsb=1.1479, bio=0.0021
    Epoch  9/10: total=2.2485, vae=1.0915, dsb=1.1560, bio=0.0020
    Epoch 10/10: total=2.2370, vae=1.0921, dsb=1.1439, bio=0.0020

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=45.9689, vae=1.0939, dsb=44.8733, bio=0.0034
    Epoch  2/10: total=39.4131, vae=1.0923, dsb=38.3198, bio=0.0020
    Epoch  3/10: total=37.7412, vae=1.0927, dsb=36.6476, bio=0.0019
    Epoch  4/10: total=36.7873, vae=1.0924, dsb=35.6940, bio=0.0019
    Epoch  5/10: total=36.2264, vae=1.0922, dsb=35.1333, bio=0.0019
    Epoch  6/10: total=35.5355, vae=1.0930, dsb=34.4416, bio=0.0019
    Epoch  7/10: total=35.3512, vae=1.0921, dsb=34.2580, bio=0.0021
    Epoch  8/10: total=35.2764, vae=1.0930, dsb=34.1825, bio=0.0018
    Epoch  9/10: total=34.9391, vae=1.0915, dsb=33.8467, bio=0.0019
    Epoch 10/10: total=34.3779, vae=1.0923, dsb=33.2847, bio=0.0018

  [Backward Policy Training]
    Epoch  1/10: total=2.0133, vae=1.0921, dsb=0.9185, bio=0.0054
    Epoch  2/10: total=1.8803, vae=1.0907, dsb=0.7886, bio=0.0020
    Epoch  3/10: total=1.8328, vae=1.0900, dsb=0.7419, bio=0.0018
    Epoch  4/10: total=1.8310, vae=1.0905, dsb=0.7396, bio=0.0017
    Epoch  5/10: total=1.8059, vae=1.0896, dsb=0.7154, bio=0.0017
    Epoch  6/10: total=1.7792, vae=1.0902, dsb=0.6881, bio=0.0017
    Epoch  7/10: total=1.7779, vae=1.0907, dsb=0.6862, bio=0.0019
    Epoch  8/10: total=1.7741, vae=1.0892, dsb=0.6841, bio=0.0016
    Epoch  9/10: total=1.7521, vae=1.0911, dsb=0.6603, bio=0.0016
    Epoch 10/10: total=1.7522, vae=1.0909, dsb=0.6605, bio=0.0016

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=31.7339, vae=1.0930, dsb=30.6395, bio=0.0030
    Epoch  2/10: total=29.0253, vae=1.0914, dsb=27.9331, bio=0.0017
    Epoch  3/10: total=28.2156, vae=1.0914, dsb=27.1233, bio=0.0018
    Epoch  4/10: total=27.8907, vae=1.0907, dsb=26.7992, bio=0.0016
    Epoch  5/10: total=27.6880, vae=1.0919, dsb=26.5953, bio=0.0016
    Epoch  6/10: total=27.6571, vae=1.0909, dsb=26.5654, bio=0.0017
    Epoch  7/10: total=27.2761, vae=1.0912, dsb=26.1841, bio=0.0017
    Epoch  8/10: total=27.1987, vae=1.0905, dsb=26.1074, bio=0.0017
    Epoch  9/10: total=27.0231, vae=1.0917, dsb=25.9302, bio=0.0023
    Epoch 10/10: total=27.0486, vae=1.0914, dsb=25.9564, bio=0.0017

  [Backward Policy Training]
    Epoch  1/10: total=1.6710, vae=1.0910, dsb=0.5759, bio=0.0081
    Epoch  2/10: total=1.6069, vae=1.0908, dsb=0.5153, bio=0.0016
    Epoch  3/10: total=1.5904, vae=1.0895, dsb=0.5002, bio=0.0015
    Epoch  4/10: total=1.5823, vae=1.0899, dsb=0.4917, bio=0.0015
    Epoch  5/10: total=1.5698, vae=1.0895, dsb=0.4797, bio=0.0012
    Epoch  6/10: total=1.5668, vae=1.0902, dsb=0.4755, bio=0.0021
    Epoch  7/10: total=1.5560, vae=1.0897, dsb=0.4656, bio=0.0014
    Epoch  8/10: total=1.5447, vae=1.0901, dsb=0.4539, bio=0.0014
    Epoch  9/10: total=1.5410, vae=1.0899, dsb=0.4504, bio=0.0014
    Epoch 10/10: total=1.5510, vae=1.0890, dsb=0.4613, bio=0.0014

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=24.8429, vae=1.0922, dsb=23.7492, bio=0.0029
    Epoch  2/10: total=23.7014, vae=1.0912, dsb=22.6094, bio=0.0015
    Epoch  3/10: total=23.2625, vae=1.0904, dsb=22.1713, bio=0.0016
    Epoch  4/10: total=23.3909, vae=1.0907, dsb=22.2994, bio=0.0015
    Epoch  5/10: total=23.0521, vae=1.0908, dsb=21.9604, bio=0.0019
    Epoch  6/10: total=22.9163, vae=1.0905, dsb=21.8238, bio=0.0039
    Epoch  7/10: total=22.9417, vae=1.0908, dsb=21.8501, bio=0.0015
    Epoch  8/10: total=22.8413, vae=1.0910, dsb=21.7495, bio=0.0015
    Epoch  9/10: total=22.9447, vae=1.0902, dsb=21.8538, bio=0.0015
    Epoch 10/10: total=22.7935, vae=1.0898, dsb=21.7030, bio=0.0015

  [Backward Policy Training]
    Epoch  1/10: total=1.5238, vae=1.0911, dsb=0.4153, bio=0.0348
    Epoch  2/10: total=1.4723, vae=1.0895, dsb=0.3820, bio=0.0015
    Epoch  3/10: total=1.4550, vae=1.0894, dsb=0.3649, bio=0.0013
    Epoch  4/10: total=1.4708, vae=1.0899, dsb=0.3802, bio=0.0013
    Epoch  5/10: total=1.4493, vae=1.0891, dsb=0.3596, bio=0.0013
    Epoch  6/10: total=1.4484, vae=1.0888, dsb=0.3590, bio=0.0013
    Epoch  7/10: total=1.4395, vae=1.0893, dsb=0.3494, bio=0.0016
    Epoch  8/10: total=1.4434, vae=1.0895, dsb=0.3533, bio=0.0012
    Epoch  9/10: total=1.4449, vae=1.0897, dsb=0.3546, bio=0.0012
    Epoch 10/10: total=1.4536, vae=1.0901, dsb=0.3628, bio=0.0012

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=20.1352, vae=1.0911, dsb=19.0428, bio=0.0025
    Epoch  2/10: total=19.7548, vae=1.0895, dsb=18.6646, bio=0.0014
    Epoch  3/10: total=19.7227, vae=1.0888, dsb=18.6330, bio=0.0017
    Epoch  4/10: total=19.4086, vae=1.0900, dsb=18.3180, bio=0.0013
    Epoch  5/10: total=19.5437, vae=1.0908, dsb=18.4523, bio=0.0013
    Epoch  6/10: total=19.5878, vae=1.0896, dsb=18.4975, bio=0.0013
    Epoch  7/10: total=19.4344, vae=1.0906, dsb=18.3432, bio=0.0013
    Epoch  8/10: total=19.4725, vae=1.0897, dsb=18.3821, bio=0.0015
    Epoch  9/10: total=19.4229, vae=1.0892, dsb=18.3331, bio=0.0013
    Epoch 10/10: total=19.4177, vae=1.0902, dsb=18.3268, bio=0.0012

  [Backward Policy Training]
    Epoch  1/10: total=1.4499, vae=1.0902, dsb=0.3051, bio=0.1091
    Epoch  2/10: total=1.3894, vae=1.0899, dsb=0.2989, bio=0.0012
    Epoch  3/10: total=1.3904, vae=1.0894, dsb=0.3005, bio=0.0012
    Epoch  4/10: total=1.3886, vae=1.0892, dsb=0.2988, bio=0.0012
    Epoch  5/10: total=1.3816, vae=1.0890, dsb=0.2920, bio=0.0011
    Epoch  6/10: total=1.3792, vae=1.0896, dsb=0.2891, bio=0.0011
    Epoch  7/10: total=1.3819, vae=1.0892, dsb=0.2922, bio=0.0011
    Epoch  8/10: total=1.3805, vae=1.0893, dsb=0.2907, bio=0.0011
    Epoch  9/10: total=1.3814, vae=1.0890, dsb=0.2919, bio=0.0011
    Epoch 10/10: total=1.3910, vae=1.0890, dsb=0.3015, bio=0.0011

[Seed 76] Joint training (original) complete; models and history saved.

[Seed 76] Starting joint training (ablation)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=245.3648, vae=2.0253, dsb=243.3395, bio=0.0000
    Epoch  2/10: total=75.6548, vae=1.0860, dsb=74.5687, bio=0.0000
    Epoch  3/10: total=65.6567, vae=1.0843, dsb=64.5725, bio=0.0000
    Epoch  4/10: total=60.4885, vae=1.0840, dsb=59.4045, bio=0.0000
    Epoch  5/10: total=57.6092, vae=1.0833, dsb=56.5259, bio=0.0000
    Epoch  6/10: total=55.3648, vae=1.0823, dsb=54.2825, bio=0.0000
    Epoch  7/10: total=53.9113, vae=1.0830, dsb=52.8283, bio=0.0000
    Epoch  8/10: total=52.6219, vae=1.0823, dsb=51.5396, bio=0.0000
    Epoch  9/10: total=51.7288, vae=1.0827, dsb=50.6461, bio=0.0000
    Epoch 10/10: total=50.8118, vae=1.0824, dsb=49.7295, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=2.9304, vae=1.0825, dsb=1.8479, bio=0.0000
    Epoch  2/10: total=2.4763, vae=1.0821, dsb=1.3942, bio=0.0000
    Epoch  3/10: total=2.3727, vae=1.0818, dsb=1.2909, bio=0.0000
    Epoch  4/10: total=2.3577, vae=1.0824, dsb=1.2752, bio=0.0000
    Epoch  5/10: total=2.3142, vae=1.0825, dsb=1.2317, bio=0.0000
    Epoch  6/10: total=2.2586, vae=1.0821, dsb=1.1765, bio=0.0000
    Epoch  7/10: total=2.2362, vae=1.0821, dsb=1.1541, bio=0.0000
    Epoch  8/10: total=2.2024, vae=1.0823, dsb=1.1201, bio=0.0000
    Epoch  9/10: total=2.2103, vae=1.0821, dsb=1.1282, bio=0.0000
    Epoch 10/10: total=2.2005, vae=1.0829, dsb=1.1176, bio=0.0000

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=46.0594, vae=1.0821, dsb=44.9774, bio=0.0000
    Epoch  2/10: total=39.4480, vae=1.0816, dsb=38.3664, bio=0.0000
    Epoch  3/10: total=37.8819, vae=1.0821, dsb=36.7998, bio=0.0000
    Epoch  4/10: total=36.9666, vae=1.0819, dsb=35.8847, bio=0.0000
    Epoch  5/10: total=36.4344, vae=1.0818, dsb=35.3526, bio=0.0000
    Epoch  6/10: total=35.7323, vae=1.0827, dsb=34.6496, bio=0.0000
    Epoch  7/10: total=35.5608, vae=1.0820, dsb=34.4788, bio=0.0000
    Epoch  8/10: total=35.5351, vae=1.0829, dsb=34.4522, bio=0.0000
    Epoch  9/10: total=35.2195, vae=1.0815, dsb=34.1381, bio=0.0000
    Epoch 10/10: total=34.7004, vae=1.0823, dsb=33.6181, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.9513, vae=1.0816, dsb=0.8697, bio=0.0000
    Epoch  2/10: total=1.8322, vae=1.0816, dsb=0.7506, bio=0.0000
    Epoch  3/10: total=1.7879, vae=1.0811, dsb=0.7068, bio=0.0000
    Epoch  4/10: total=1.7882, vae=1.0818, dsb=0.7065, bio=0.0000
    Epoch  5/10: total=1.7657, vae=1.0809, dsb=0.6848, bio=0.0000
    Epoch  6/10: total=1.7406, vae=1.0816, dsb=0.6590, bio=0.0000
    Epoch  7/10: total=1.7396, vae=1.0820, dsb=0.6577, bio=0.0000
    Epoch  8/10: total=1.7370, vae=1.0807, dsb=0.6562, bio=0.0000
    Epoch  9/10: total=1.7163, vae=1.0826, dsb=0.6338, bio=0.0000
    Epoch 10/10: total=1.7164, vae=1.0825, dsb=0.6340, bio=0.0000

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=32.7647, vae=1.0818, dsb=31.6829, bio=0.0000
    Epoch  2/10: total=30.2425, vae=1.0814, dsb=29.1610, bio=0.0000
    Epoch  3/10: total=29.4809, vae=1.0817, dsb=28.3992, bio=0.0000
    Epoch  4/10: total=29.1954, vae=1.0811, dsb=28.1142, bio=0.0000
    Epoch  5/10: total=29.0359, vae=1.0825, dsb=27.9535, bio=0.0000
    Epoch  6/10: total=28.9931, vae=1.0815, dsb=27.9116, bio=0.0000
    Epoch  7/10: total=28.6174, vae=1.0818, dsb=27.5355, bio=0.0000
    Epoch  8/10: total=28.5378, vae=1.0812, dsb=27.4566, bio=0.0000
    Epoch  9/10: total=28.3659, vae=1.0825, dsb=27.2834, bio=0.0000
    Epoch 10/10: total=28.4108, vae=1.0823, dsb=27.3285, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.6325, vae=1.0816, dsb=0.5509, bio=0.0000
    Epoch  2/10: total=1.5729, vae=1.0825, dsb=0.4904, bio=0.0000
    Epoch  3/10: total=1.5572, vae=1.0813, dsb=0.4760, bio=0.0000
    Epoch  4/10: total=1.5502, vae=1.0818, dsb=0.4684, bio=0.0000
    Epoch  5/10: total=1.5384, vae=1.0814, dsb=0.4570, bio=0.0000
    Epoch  6/10: total=1.5346, vae=1.0821, dsb=0.4525, bio=0.0000
    Epoch  7/10: total=1.5248, vae=1.0817, dsb=0.4431, bio=0.0000
    Epoch  8/10: total=1.5138, vae=1.0821, dsb=0.4318, bio=0.0000
    Epoch  9/10: total=1.5102, vae=1.0819, dsb=0.4283, bio=0.0000
    Epoch 10/10: total=1.5199, vae=1.0811, dsb=0.4388, bio=0.0000

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=25.7626, vae=1.0815, dsb=24.6810, bio=0.0000
    Epoch  2/10: total=24.7362, vae=1.0818, dsb=23.6543, bio=0.0000
    Epoch  3/10: total=24.3031, vae=1.0814, dsb=23.2218, bio=0.0000
    Epoch  4/10: total=24.4932, vae=1.0818, dsb=23.4114, bio=0.0000
    Epoch  5/10: total=24.1359, vae=1.0819, dsb=23.0540, bio=0.0000
    Epoch  6/10: total=23.9874, vae=1.0818, dsb=22.9056, bio=0.0000
    Epoch  7/10: total=24.0536, vae=1.0822, dsb=22.9714, bio=0.0000
    Epoch  8/10: total=23.9624, vae=1.0824, dsb=22.8800, bio=0.0000
    Epoch  9/10: total=24.0690, vae=1.0817, dsb=22.9873, bio=0.0000
    Epoch 10/10: total=23.9072, vae=1.0813, dsb=22.8259, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.4746, vae=1.0822, dsb=0.3924, bio=0.0000
    Epoch  2/10: total=1.4419, vae=1.0816, dsb=0.3603, bio=0.0000
    Epoch  3/10: total=1.4254, vae=1.0816, dsb=0.3437, bio=0.0000
    Epoch  4/10: total=1.4411, vae=1.0822, dsb=0.3589, bio=0.0000
    Epoch  5/10: total=1.4201, vae=1.0813, dsb=0.3388, bio=0.0000
    Epoch  6/10: total=1.4193, vae=1.0811, dsb=0.3382, bio=0.0000
    Epoch  7/10: total=1.4105, vae=1.0816, dsb=0.3289, bio=0.0000
    Epoch  8/10: total=1.4147, vae=1.0819, dsb=0.3328, bio=0.0000
    Epoch  9/10: total=1.4158, vae=1.0820, dsb=0.3338, bio=0.0000
    Epoch 10/10: total=1.4242, vae=1.0825, dsb=0.3418, bio=0.0000

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=20.5959, vae=1.0810, dsb=19.5149, bio=0.0000
    Epoch  2/10: total=20.2651, vae=1.0806, dsb=19.1845, bio=0.0000
    Epoch  3/10: total=20.2099, vae=1.0803, dsb=19.1296, bio=0.0000
    Epoch  4/10: total=19.9312, vae=1.0817, dsb=18.8494, bio=0.0000
    Epoch  5/10: total=20.0562, vae=1.0826, dsb=18.9736, bio=0.0000
    Epoch  6/10: total=20.1003, vae=1.0815, dsb=19.0188, bio=0.0000
    Epoch  7/10: total=19.9592, vae=1.0826, dsb=18.8766, bio=0.0000
    Epoch  8/10: total=19.9746, vae=1.0817, dsb=18.8929, bio=0.0000
    Epoch  9/10: total=19.9406, vae=1.0813, dsb=18.8593, bio=0.0000
    Epoch 10/10: total=19.9419, vae=1.0825, dsb=18.8594, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.3633, vae=1.0814, dsb=0.2819, bio=0.0000
    Epoch  2/10: total=1.3583, vae=1.0822, dsb=0.2762, bio=0.0000
    Epoch  3/10: total=1.3595, vae=1.0817, dsb=0.2778, bio=0.0000
    Epoch  4/10: total=1.3576, vae=1.0816, dsb=0.2761, bio=0.0000
    Epoch  5/10: total=1.3510, vae=1.0814, dsb=0.2695, bio=0.0000
    Epoch  6/10: total=1.3487, vae=1.0821, dsb=0.2665, bio=0.0000
    Epoch  7/10: total=1.3513, vae=1.0817, dsb=0.2697, bio=0.0000
    Epoch  8/10: total=1.3499, vae=1.0818, dsb=0.2681, bio=0.0000
    Epoch  9/10: total=1.3508, vae=1.0816, dsb=0.2692, bio=0.0000
    Epoch 10/10: total=1.3602, vae=1.0816, dsb=0.2786, bio=0.0000

[Seed 76] Joint training (ablation) complete; models and history saved.

[Seed 76] Drift genes saved in /home/yyuan/ICB_TCE/iter_results/run_076

[Seed 76] run finished.

================================================================================
[Seed 77] Starting running whole pipeline...
================================================================================

[Seed 77] Starting VAE pre-training...

    Epoch [01/20], Beta: 0.000, Average Loss: 534.3790
    Epoch [02/20], Beta: 0.000, Average Loss: 304.0391
    Epoch [03/20], Beta: 0.000, Average Loss: 271.0676
    Epoch [04/20], Beta: 0.000, Average Loss: 251.6311
    Epoch [05/20], Beta: 0.100, Average Loss: 245.5376
    Epoch [06/20], Beta: 0.200, Average Loss: 244.7232
    Epoch [07/20], Beta: 0.300, Average Loss: 245.0047
    Epoch [08/20], Beta: 0.400, Average Loss: 245.7866
    Epoch [09/20], Beta: 0.500, Average Loss: 246.8942
    Epoch [10/20], Beta: 0.600, Average Loss: 248.1084
    Epoch [11/20], Beta: 0.700, Average Loss: 249.3848
    Epoch [12/20], Beta: 0.800, Average Loss: 250.6953
    Epoch [13/20], Beta: 0.900, Average Loss: 251.9092
    Epoch [14/20], Beta: 1.000, Average Loss: 253.5152
    Epoch [15/20], Beta: 1.000, Average Loss: 253.1043
    Epoch [16/20], Beta: 1.000, Average Loss: 252.7063
    Epoch [17/20], Beta: 1.000, Average Loss: 252.3705
    Epoch [18/20], Beta: 1.000, Average Loss: 251.9878
    Epoch [19/20], Beta: 1.000, Average Loss: 251.6518
    Epoch [20/20], Beta: 1.000, Average Loss: 251.4874

[Seed 77] VAE pre-training complete.

[Seed 77] Starting joint training (original)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=527.4166, vae=3.6860, dsb=504.1825, bio=39.0963
    Epoch  2/10: total=187.9174, vae=1.0948, dsb=186.7892, bio=0.0667
    Epoch  3/10: total=175.1006, vae=1.0897, dsb=173.9953, bio=0.0312
    Epoch  4/10: total=170.9202, vae=1.0878, dsb=169.8232, bio=0.0186
    Epoch  5/10: total=166.0436, vae=1.0870, dsb=164.9500, bio=0.0132
    Epoch  6/10: total=164.6094, vae=1.0862, dsb=163.5182, bio=0.0100
    Epoch  7/10: total=163.6066, vae=1.0854, dsb=162.5172, bio=0.0080
    Epoch  8/10: total=161.0238, vae=1.0841, dsb=159.9362, bio=0.0070
    Epoch  9/10: total=161.1578, vae=1.0849, dsb=160.0699, bio=0.0061
    Epoch 10/10: total=159.3019, vae=1.0838, dsb=158.2154, bio=0.0054

  [Backward Policy Training]
    Epoch  1/10: total=3.7353, vae=1.0852, dsb=2.6399, bio=0.0203
    Epoch  2/10: total=3.2163, vae=1.0842, dsb=2.1284, bio=0.0073
    Epoch  3/10: total=3.1125, vae=1.0832, dsb=2.0268, bio=0.0050
    Epoch  4/10: total=3.0212, vae=1.0832, dsb=1.9360, bio=0.0040
    Epoch  5/10: total=2.9732, vae=1.0825, dsb=1.8890, bio=0.0034
    Epoch  6/10: total=2.9425, vae=1.0826, dsb=1.8583, bio=0.0031
    Epoch  7/10: total=2.9064, vae=1.0824, dsb=1.8225, bio=0.0028
    Epoch  8/10: total=2.9397, vae=1.0824, dsb=1.8559, bio=0.0027
    Epoch  9/10: total=2.8187, vae=1.0824, dsb=1.7351, bio=0.0026
    Epoch 10/10: total=2.8533, vae=1.0816, dsb=1.7705, bio=0.0024

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=135.1819, vae=1.0851, dsb=134.0947, bio=0.0042
    Epoch  2/10: total=129.3072, vae=1.0830, dsb=128.2228, bio=0.0026
    Epoch  3/10: total=127.7825, vae=1.0829, dsb=126.6984, bio=0.0025
    Epoch  4/10: total=127.4446, vae=1.0837, dsb=126.3597, bio=0.0024
    Epoch  5/10: total=126.1703, vae=1.0839, dsb=125.0850, bio=0.0026
    Epoch  6/10: total=126.7073, vae=1.0828, dsb=125.6233, bio=0.0023
    Epoch  7/10: total=125.5812, vae=1.0825, dsb=124.4976, bio=0.0023
    Epoch  8/10: total=125.3311, vae=1.0831, dsb=124.2468, bio=0.0023
    Epoch  9/10: total=125.3806, vae=1.0829, dsb=124.2965, bio=0.0023
    Epoch 10/10: total=124.8840, vae=1.0825, dsb=123.8003, bio=0.0023

  [Backward Policy Training]
    Epoch  1/10: total=2.5313, vae=1.0828, dsb=1.4453, bio=0.0064
    Epoch  2/10: total=2.4697, vae=1.0821, dsb=1.3864, bio=0.0024
    Epoch  3/10: total=2.4020, vae=1.0811, dsb=1.3198, bio=0.0022
    Epoch  4/10: total=2.4050, vae=1.0813, dsb=1.3226, bio=0.0021
    Epoch  5/10: total=2.3952, vae=1.0818, dsb=1.3124, bio=0.0020
    Epoch  6/10: total=2.3781, vae=1.0809, dsb=1.2963, bio=0.0020
    Epoch  7/10: total=2.3507, vae=1.0808, dsb=1.2690, bio=0.0017
    Epoch  8/10: total=2.3810, vae=1.0813, dsb=1.2986, bio=0.0023
    Epoch  9/10: total=2.3440, vae=1.0815, dsb=1.2616, bio=0.0019
    Epoch 10/10: total=2.3536, vae=1.0805, dsb=1.2721, bio=0.0019

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=115.1347, vae=1.0840, dsb=114.0488, bio=0.0037
    Epoch  2/10: total=112.4670, vae=1.0825, dsb=111.3834, bio=0.0022
    Epoch  3/10: total=111.9911, vae=1.0821, dsb=110.9080, bio=0.0021
    Epoch  4/10: total=111.7414, vae=1.0830, dsb=110.6573, bio=0.0021
    Epoch  5/10: total=111.3221, vae=1.0819, dsb=110.2389, bio=0.0024
    Epoch  6/10: total=111.7360, vae=1.0818, dsb=110.6532, bio=0.0020
    Epoch  7/10: total=112.1512, vae=1.0821, dsb=111.0681, bio=0.0020
    Epoch  8/10: total=111.9775, vae=1.0812, dsb=110.8952, bio=0.0020
    Epoch  9/10: total=111.3329, vae=1.0816, dsb=110.2503, bio=0.0021
    Epoch 10/10: total=111.5839, vae=1.0820, dsb=110.5009, bio=0.0021

  [Backward Policy Training]
    Epoch  1/10: total=2.2342, vae=1.0820, dsb=1.1493, bio=0.0059
    Epoch  2/10: total=2.1852, vae=1.0810, dsb=1.1032, bio=0.0020
    Epoch  3/10: total=2.1404, vae=1.0799, dsb=1.0596, bio=0.0018
    Epoch  4/10: total=2.1864, vae=1.0805, dsb=1.1049, bio=0.0019
    Epoch  5/10: total=2.1421, vae=1.0811, dsb=1.0600, bio=0.0018
    Epoch  6/10: total=2.1585, vae=1.0803, dsb=1.0772, bio=0.0018
    Epoch  7/10: total=2.1614, vae=1.0801, dsb=1.0804, bio=0.0017
    Epoch  8/10: total=2.1198, vae=1.0809, dsb=1.0380, bio=0.0018
    Epoch  9/10: total=2.1389, vae=1.0813, dsb=1.0568, bio=0.0017
    Epoch 10/10: total=2.1128, vae=1.0798, dsb=1.0322, bio=0.0017

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=102.0124, vae=1.0830, dsb=100.9275, bio=0.0037
    Epoch  2/10: total=101.4216, vae=1.0817, dsb=100.3389, bio=0.0019
    Epoch  3/10: total=100.9374, vae=1.0809, dsb=99.8556, bio=0.0019
    Epoch  4/10: total=100.8831, vae=1.0823, dsb=99.7999, bio=0.0019
    Epoch  5/10: total=101.1996, vae=1.0821, dsb=100.1164, bio=0.0020
    Epoch  6/10: total=100.8523, vae=1.0812, dsb=99.7702, bio=0.0017
    Epoch  7/10: total=100.7488, vae=1.0805, dsb=99.6673, bio=0.0019
    Epoch  8/10: total=101.3621, vae=1.0811, dsb=100.2800, bio=0.0019
    Epoch  9/10: total=100.6244, vae=1.0806, dsb=99.5429, bio=0.0019
    Epoch 10/10: total=100.9133, vae=1.0808, dsb=99.8316, bio=0.0019

  [Backward Policy Training]
    Epoch  1/10: total=2.0348, vae=1.0818, dsb=0.9492, bio=0.0075
    Epoch  2/10: total=1.9797, vae=1.0801, dsb=0.8986, bio=0.0018
    Epoch  3/10: total=1.9927, vae=1.0812, dsb=0.9107, bio=0.0017
    Epoch  4/10: total=1.9688, vae=1.0802, dsb=0.8878, bio=0.0016
    Epoch  5/10: total=1.9675, vae=1.0809, dsb=0.8858, bio=0.0017
    Epoch  6/10: total=1.9556, vae=1.0799, dsb=0.8750, bio=0.0013
    Epoch  7/10: total=1.9777, vae=1.0809, dsb=0.8959, bio=0.0017
    Epoch  8/10: total=1.9881, vae=1.0805, dsb=0.9068, bio=0.0016
    Epoch  9/10: total=1.9724, vae=1.0796, dsb=0.8919, bio=0.0016
    Epoch 10/10: total=1.9633, vae=1.0800, dsb=0.8824, bio=0.0016

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=89.6255, vae=1.0829, dsb=88.5411, bio=0.0031
    Epoch  2/10: total=89.0704, vae=1.0811, dsb=87.9883, bio=0.0019
    Epoch  3/10: total=89.2098, vae=1.0820, dsb=88.1269, bio=0.0018
    Epoch  4/10: total=88.8566, vae=1.0812, dsb=87.7745, bio=0.0018
    Epoch  5/10: total=88.4893, vae=1.0810, dsb=87.4075, bio=0.0017
    Epoch  6/10: total=89.0779, vae=1.0808, dsb=87.9963, bio=0.0017
    Epoch  7/10: total=88.8916, vae=1.0816, dsb=87.8091, bio=0.0018
    Epoch  8/10: total=89.0783, vae=1.0806, dsb=87.9969, bio=0.0017
    Epoch  9/10: total=88.5941, vae=1.0809, dsb=87.5123, bio=0.0017
    Epoch 10/10: total=88.4557, vae=1.0812, dsb=87.3736, bio=0.0017

  [Backward Policy Training]
    Epoch  1/10: total=1.8898, vae=1.0811, dsb=0.8009, bio=0.0158
    Epoch  2/10: total=1.8628, vae=1.0801, dsb=0.7819, bio=0.0017
    Epoch  3/10: total=1.8506, vae=1.0807, dsb=0.7691, bio=0.0015
    Epoch  4/10: total=1.8904, vae=1.0799, dsb=0.8097, bio=0.0015
    Epoch  5/10: total=1.8537, vae=1.0797, dsb=0.7734, bio=0.0014
    Epoch  6/10: total=1.8483, vae=1.0801, dsb=0.7673, bio=0.0018
    Epoch  7/10: total=1.8760, vae=1.0802, dsb=0.7951, bio=0.0015
    Epoch  8/10: total=1.8751, vae=1.0804, dsb=0.7939, bio=0.0014
    Epoch  9/10: total=1.8810, vae=1.0799, dsb=0.8004, bio=0.0014
    Epoch 10/10: total=1.8614, vae=1.0799, dsb=0.7808, bio=0.0014

[Seed 77] Joint training (original) complete; models and history saved.

[Seed 77] Starting joint training (ablation)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=504.8644, vae=1.9897, dsb=502.8746, bio=0.0000
    Epoch  2/10: total=187.0942, vae=1.0759, dsb=186.0183, bio=0.0000
    Epoch  3/10: total=174.6056, vae=1.0745, dsb=173.5311, bio=0.0000
    Epoch  4/10: total=170.5359, vae=1.0738, dsb=169.4621, bio=0.0000
    Epoch  5/10: total=165.7797, vae=1.0736, dsb=164.7061, bio=0.0000
    Epoch  6/10: total=164.3267, vae=1.0734, dsb=163.2533, bio=0.0000
    Epoch  7/10: total=163.2428, vae=1.0729, dsb=162.1699, bio=0.0000
    Epoch  8/10: total=160.5315, vae=1.0720, dsb=159.4596, bio=0.0000
    Epoch  9/10: total=160.6143, vae=1.0730, dsb=159.5413, bio=0.0000
    Epoch 10/10: total=158.6578, vae=1.0721, dsb=157.5857, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=3.5124, vae=1.0723, dsb=2.4401, bio=0.0000
    Epoch  2/10: total=3.0411, vae=1.0731, dsb=1.9680, bio=0.0000
    Epoch  3/10: total=2.9413, vae=1.0725, dsb=1.8688, bio=0.0000
    Epoch  4/10: total=2.8573, vae=1.0728, dsb=1.7845, bio=0.0000
    Epoch  5/10: total=2.8135, vae=1.0723, dsb=1.7412, bio=0.0000
    Epoch  6/10: total=2.7867, vae=1.0725, dsb=1.7141, bio=0.0000
    Epoch  7/10: total=2.7532, vae=1.0725, dsb=1.6808, bio=0.0000
    Epoch  8/10: total=2.7846, vae=1.0726, dsb=1.7120, bio=0.0000
    Epoch  9/10: total=2.6718, vae=1.0726, dsb=1.5991, bio=0.0000
    Epoch 10/10: total=2.7035, vae=1.0718, dsb=1.6316, bio=0.0000

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=130.8335, vae=1.0727, dsb=129.7608, bio=0.0000
    Epoch  2/10: total=125.5318, vae=1.0718, dsb=124.4600, bio=0.0000
    Epoch  3/10: total=123.9946, vae=1.0718, dsb=122.9228, bio=0.0000
    Epoch  4/10: total=123.7331, vae=1.0727, dsb=122.6604, bio=0.0000
    Epoch  5/10: total=122.4839, vae=1.0731, dsb=121.4108, bio=0.0000
    Epoch  6/10: total=123.0558, vae=1.0722, dsb=121.9836, bio=0.0000
    Epoch  7/10: total=122.0320, vae=1.0719, dsb=120.9600, bio=0.0000
    Epoch  8/10: total=121.7709, vae=1.0726, dsb=120.6982, bio=0.0000
    Epoch  9/10: total=121.7223, vae=1.0725, dsb=120.6498, bio=0.0000
    Epoch 10/10: total=121.3331, vae=1.0722, dsb=120.2609, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=2.3916, vae=1.0720, dsb=1.3196, bio=0.0000
    Epoch  2/10: total=2.3431, vae=1.0727, dsb=1.2704, bio=0.0000
    Epoch  3/10: total=2.2816, vae=1.0719, dsb=1.2097, bio=0.0000
    Epoch  4/10: total=2.2868, vae=1.0723, dsb=1.2146, bio=0.0000
    Epoch  5/10: total=2.2795, vae=1.0728, dsb=1.2067, bio=0.0000
    Epoch  6/10: total=2.2639, vae=1.0720, dsb=1.1919, bio=0.0000
    Epoch  7/10: total=2.2390, vae=1.0719, dsb=1.1671, bio=0.0000
    Epoch  8/10: total=2.2675, vae=1.0725, dsb=1.1950, bio=0.0000
    Epoch  9/10: total=2.2333, vae=1.0727, dsb=1.1606, bio=0.0000
    Epoch 10/10: total=2.2431, vae=1.0718, dsb=1.1713, bio=0.0000

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=111.6085, vae=1.0724, dsb=110.5360, bio=0.0000
    Epoch  2/10: total=109.1275, vae=1.0722, dsb=108.0553, bio=0.0000
    Epoch  3/10: total=108.7195, vae=1.0720, dsb=107.6475, bio=0.0000
    Epoch  4/10: total=108.5440, vae=1.0730, dsb=107.4710, bio=0.0000
    Epoch  5/10: total=108.0485, vae=1.0720, dsb=106.9765, bio=0.0000
    Epoch  6/10: total=108.4727, vae=1.0721, dsb=107.4007, bio=0.0000
    Epoch  7/10: total=108.9787, vae=1.0724, dsb=107.9063, bio=0.0000
    Epoch  8/10: total=108.7173, vae=1.0715, dsb=107.6458, bio=0.0000
    Epoch  9/10: total=108.1481, vae=1.0720, dsb=107.0762, bio=0.0000
    Epoch 10/10: total=108.3915, vae=1.0724, dsb=107.3191, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=2.1017, vae=1.0719, dsb=1.0298, bio=0.0000
    Epoch  2/10: total=2.0605, vae=1.0724, dsb=0.9881, bio=0.0000
    Epoch  3/10: total=2.0209, vae=1.0713, dsb=0.9496, bio=0.0000
    Epoch  4/10: total=2.0628, vae=1.0721, dsb=0.9907, bio=0.0000
    Epoch  5/10: total=2.0228, vae=1.0728, dsb=0.9499, bio=0.0000
    Epoch  6/10: total=2.0371, vae=1.0720, dsb=0.9651, bio=0.0000
    Epoch  7/10: total=2.0409, vae=1.0718, dsb=0.9690, bio=0.0000
    Epoch  8/10: total=2.0030, vae=1.0725, dsb=0.9304, bio=0.0000
    Epoch  9/10: total=2.0204, vae=1.0730, dsb=0.9474, bio=0.0000
    Epoch 10/10: total=1.9970, vae=1.0716, dsb=0.9254, bio=0.0000

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=93.0811, vae=1.0719, dsb=92.0092, bio=0.0000
    Epoch  2/10: total=92.5407, vae=1.0720, dsb=91.4686, bio=0.0000
    Epoch  3/10: total=92.1124, vae=1.0714, dsb=91.0410, bio=0.0000
    Epoch  4/10: total=92.1227, vae=1.0729, dsb=91.0498, bio=0.0000
    Epoch  5/10: total=92.2985, vae=1.0728, dsb=91.2257, bio=0.0000
    Epoch  6/10: total=92.0882, vae=1.0719, dsb=91.0163, bio=0.0000
    Epoch  7/10: total=91.9363, vae=1.0714, dsb=90.8649, bio=0.0000
    Epoch  8/10: total=92.5137, vae=1.0720, dsb=91.4417, bio=0.0000
    Epoch  9/10: total=91.8025, vae=1.0715, dsb=90.7310, bio=0.0000
    Epoch 10/10: total=92.1405, vae=1.0717, dsb=91.0688, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.9242, vae=1.0723, dsb=0.8519, bio=0.0000
    Epoch  2/10: total=1.8807, vae=1.0720, dsb=0.8087, bio=0.0000
    Epoch  3/10: total=1.8930, vae=1.0731, dsb=0.8199, bio=0.0000
    Epoch  4/10: total=1.8722, vae=1.0722, dsb=0.8000, bio=0.0000
    Epoch  5/10: total=1.8713, vae=1.0728, dsb=0.7984, bio=0.0000
    Epoch  6/10: total=1.8603, vae=1.0719, dsb=0.7884, bio=0.0000
    Epoch  7/10: total=1.8817, vae=1.0731, dsb=0.8087, bio=0.0000
    Epoch  8/10: total=1.8909, vae=1.0726, dsb=0.8183, bio=0.0000
    Epoch  9/10: total=1.8768, vae=1.0717, dsb=0.8052, bio=0.0000
    Epoch 10/10: total=1.8686, vae=1.0721, dsb=0.7965, bio=0.0000

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=82.8589, vae=1.0721, dsb=81.7867, bio=0.0000
    Epoch  2/10: total=82.4042, vae=1.0717, dsb=81.3325, bio=0.0000
    Epoch  3/10: total=82.5544, vae=1.0730, dsb=81.4815, bio=0.0000
    Epoch  4/10: total=82.2584, vae=1.0723, dsb=81.1861, bio=0.0000
    Epoch  5/10: total=81.8723, vae=1.0722, dsb=80.8002, bio=0.0000
    Epoch  6/10: total=82.3982, vae=1.0720, dsb=81.3263, bio=0.0000
    Epoch  7/10: total=82.2411, vae=1.0728, dsb=81.1683, bio=0.0000
    Epoch  8/10: total=82.4162, vae=1.0718, dsb=81.3444, bio=0.0000
    Epoch  9/10: total=81.9980, vae=1.0722, dsb=80.9258, bio=0.0000
    Epoch 10/10: total=81.8744, vae=1.0726, dsb=80.8018, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.7820, vae=1.0721, dsb=0.7099, bio=0.0000
    Epoch  2/10: total=1.7655, vae=1.0721, dsb=0.6934, bio=0.0000
    Epoch  3/10: total=1.7549, vae=1.0729, dsb=0.6820, bio=0.0000
    Epoch  4/10: total=1.7905, vae=1.0720, dsb=0.7185, bio=0.0000
    Epoch  5/10: total=1.7573, vae=1.0718, dsb=0.6855, bio=0.0000
    Epoch  6/10: total=1.7525, vae=1.0723, dsb=0.6802, bio=0.0000
    Epoch  7/10: total=1.7772, vae=1.0725, dsb=0.7047, bio=0.0000
    Epoch  8/10: total=1.7767, vae=1.0727, dsb=0.7040, bio=0.0000
    Epoch  9/10: total=1.7820, vae=1.0722, dsb=0.7098, bio=0.0000
    Epoch 10/10: total=1.7644, vae=1.0722, dsb=0.6922, bio=0.0000

[Seed 77] Joint training (ablation) complete; models and history saved.

[Seed 77] Drift genes saved in /home/yyuan/ICB_TCE/iter_results/run_077

[Seed 77] run finished.

================================================================================
[Seed 78] Starting running whole pipeline...
================================================================================

[Seed 78] Starting VAE pre-training...

    Epoch [01/20], Beta: 0.000, Average Loss: 532.6721
    Epoch [02/20], Beta: 0.000, Average Loss: 303.3932
    Epoch [03/20], Beta: 0.000, Average Loss: 267.8333
    Epoch [04/20], Beta: 0.000, Average Loss: 248.7577
    Epoch [05/20], Beta: 0.100, Average Loss: 245.3615
    Epoch [06/20], Beta: 0.200, Average Loss: 244.8783
    Epoch [07/20], Beta: 0.300, Average Loss: 245.2985
    Epoch [08/20], Beta: 0.400, Average Loss: 246.0081
    Epoch [09/20], Beta: 0.500, Average Loss: 246.8802
    Epoch [10/20], Beta: 0.600, Average Loss: 247.9866
    Epoch [11/20], Beta: 0.700, Average Loss: 249.2571
    Epoch [12/20], Beta: 0.800, Average Loss: 250.4809
    Epoch [13/20], Beta: 0.900, Average Loss: 251.7369
    Epoch [14/20], Beta: 1.000, Average Loss: 253.3682
    Epoch [15/20], Beta: 1.000, Average Loss: 252.9225
    Epoch [16/20], Beta: 1.000, Average Loss: 252.5947
    Epoch [17/20], Beta: 1.000, Average Loss: 252.1736
    Epoch [18/20], Beta: 1.000, Average Loss: 251.8443
    Epoch [19/20], Beta: 1.000, Average Loss: 251.4670
    Epoch [20/20], Beta: 1.000, Average Loss: 251.2878

[Seed 78] VAE pre-training complete.

[Seed 78] Starting joint training (original)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=355.8777, vae=3.4922, dsb=336.2395, bio=32.2918
    Epoch  2/10: total=107.0573, vae=1.1062, dsb=105.9072, bio=0.0878
    Epoch  3/10: total=95.8623, vae=1.1016, dsb=94.7424, bio=0.0368
    Epoch  4/10: total=90.2998, vae=1.0998, dsb=89.1890, bio=0.0218
    Epoch  5/10: total=86.6873, vae=1.0986, dsb=85.5812, bio=0.0150
    Epoch  6/10: total=85.1372, vae=1.0979, dsb=84.0339, bio=0.0108
    Epoch  7/10: total=83.2098, vae=1.0982, dsb=82.1073, bio=0.0084
    Epoch  8/10: total=82.1915, vae=1.0975, dsb=81.0906, bio=0.0068
    Epoch  9/10: total=81.1492, vae=1.0970, dsb=80.0494, bio=0.0057
    Epoch 10/10: total=80.5231, vae=1.0974, dsb=79.4232, bio=0.0049

  [Backward Policy Training]
    Epoch  1/10: total=3.3648, vae=1.0987, dsb=2.2581, bio=0.0160
    Epoch  2/10: total=2.7547, vae=1.0972, dsb=1.6548, bio=0.0055
    Epoch  3/10: total=2.6498, vae=1.0958, dsb=1.5521, bio=0.0039
    Epoch  4/10: total=2.5946, vae=1.0956, dsb=1.4974, bio=0.0032
    Epoch  5/10: total=2.5489, vae=1.0965, dsb=1.4511, bio=0.0026
    Epoch  6/10: total=2.5008, vae=1.0958, dsb=1.4039, bio=0.0023
    Epoch  7/10: total=2.5077, vae=1.0947, dsb=1.4119, bio=0.0021
    Epoch  8/10: total=2.4324, vae=1.0951, dsb=1.3363, bio=0.0020
    Epoch  9/10: total=2.4624, vae=1.0951, dsb=1.3664, bio=0.0020
    Epoch 10/10: total=2.4268, vae=1.0951, dsb=1.3308, bio=0.0018

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=69.5612, vae=1.0983, dsb=68.4607, bio=0.0044
    Epoch  2/10: total=62.7237, vae=1.0960, dsb=61.6268, bio=0.0017
    Epoch  3/10: total=60.8528, vae=1.0950, dsb=59.7569, bio=0.0016
    Epoch  4/10: total=59.9207, vae=1.0954, dsb=58.8245, bio=0.0016
    Epoch  5/10: total=59.5238, vae=1.0954, dsb=58.4276, bio=0.0016
    Epoch  6/10: total=58.5025, vae=1.0950, dsb=57.4067, bio=0.0016
    Epoch  7/10: total=58.6800, vae=1.0951, dsb=57.5842, bio=0.0014
    Epoch  8/10: total=57.9751, vae=1.0951, dsb=56.8791, bio=0.0017
    Epoch  9/10: total=57.7299, vae=1.0951, dsb=56.6340, bio=0.0015
    Epoch 10/10: total=57.3197, vae=1.0959, dsb=56.2231, bio=0.0015

  [Backward Policy Training]
    Epoch  1/10: total=2.1924, vae=1.0954, dsb=1.0916, bio=0.0108
    Epoch  2/10: total=2.0455, vae=1.0941, dsb=0.9506, bio=0.0016
    Epoch  3/10: total=1.9940, vae=1.0933, dsb=0.9001, bio=0.0013
    Epoch  4/10: total=1.9679, vae=1.0929, dsb=0.8742, bio=0.0016
    Epoch  5/10: total=1.9568, vae=1.0930, dsb=0.8631, bio=0.0013
    Epoch  6/10: total=1.9523, vae=1.0935, dsb=0.8581, bio=0.0013
    Epoch  7/10: total=1.9455, vae=1.0938, dsb=0.8511, bio=0.0012
    Epoch  8/10: total=1.9336, vae=1.0940, dsb=0.8389, bio=0.0012
    Epoch  9/10: total=1.9287, vae=1.0930, dsb=0.8349, bio=0.0016
    Epoch 10/10: total=1.9140, vae=1.0931, dsb=0.8203, bio=0.0012

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=50.8174, vae=1.0951, dsb=49.7210, bio=0.0026
    Epoch  2/10: total=47.7591, vae=1.0946, dsb=46.6639, bio=0.0012
    Epoch  3/10: total=47.3149, vae=1.0938, dsb=46.2205, bio=0.0012
    Epoch  4/10: total=46.7036, vae=1.0947, dsb=45.6083, bio=0.0012
    Epoch  5/10: total=46.5978, vae=1.0942, dsb=45.5030, bio=0.0013
    Epoch  6/10: total=45.8719, vae=1.0943, dsb=44.7771, bio=0.0010
    Epoch  7/10: total=45.8416, vae=1.0937, dsb=44.7473, bio=0.0012
    Epoch  8/10: total=46.1837, vae=1.0943, dsb=45.0888, bio=0.0012
    Epoch  9/10: total=45.8347, vae=1.0935, dsb=44.7407, bio=0.0012
    Epoch 10/10: total=45.7139, vae=1.0941, dsb=44.6192, bio=0.0012

  [Backward Policy Training]
    Epoch  1/10: total=1.8169, vae=1.0939, dsb=0.7126, bio=0.0206
    Epoch  2/10: total=1.7457, vae=1.0933, dsb=0.6518, bio=0.0012
    Epoch  3/10: total=1.7115, vae=1.0928, dsb=0.6181, bio=0.0012
    Epoch  4/10: total=1.7316, vae=1.0942, dsb=0.6369, bio=0.0011
    Epoch  5/10: total=1.6995, vae=1.0936, dsb=0.6054, bio=0.0010
    Epoch  6/10: total=1.7017, vae=1.0930, dsb=0.6082, bio=0.0010
    Epoch  7/10: total=1.7044, vae=1.0929, dsb=0.6110, bio=0.0010
    Epoch  8/10: total=1.6994, vae=1.0926, dsb=0.6063, bio=0.0010
    Epoch  9/10: total=1.6706, vae=1.0925, dsb=0.5777, bio=0.0009
    Epoch 10/10: total=1.6672, vae=1.0924, dsb=0.5742, bio=0.0012

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=39.9342, vae=1.0957, dsb=38.8373, bio=0.0024
    Epoch  2/10: total=38.3987, vae=1.0936, dsb=37.3046, bio=0.0010
    Epoch  3/10: total=38.2549, vae=1.0941, dsb=37.1603, bio=0.0011
    Epoch  4/10: total=37.5794, vae=1.0934, dsb=36.4855, bio=0.0011
    Epoch  5/10: total=37.5951, vae=1.0936, dsb=36.5012, bio=0.0007
    Epoch  6/10: total=37.3304, vae=1.0933, dsb=36.2366, bio=0.0009
    Epoch  7/10: total=37.5224, vae=1.0932, dsb=36.4288, bio=0.0009
    Epoch  8/10: total=37.2119, vae=1.0924, dsb=36.1190, bio=0.0011
    Epoch  9/10: total=37.4501, vae=1.0936, dsb=36.3560, bio=0.0010
    Epoch 10/10: total=37.3476, vae=1.0932, dsb=36.2539, bio=0.0010

  [Backward Policy Training]
    Epoch  1/10: total=1.6660, vae=1.0932, dsb=0.5054, bio=0.1350
    Epoch  2/10: total=1.5648, vae=1.0931, dsb=0.4711, bio=0.0011
    Epoch  3/10: total=1.5603, vae=1.0925, dsb=0.4673, bio=0.0010
    Epoch  4/10: total=1.5412, vae=1.0926, dsb=0.4482, bio=0.0009
    Epoch  5/10: total=1.5441, vae=1.0929, dsb=0.4509, bio=0.0006
    Epoch  6/10: total=1.5386, vae=1.0936, dsb=0.4446, bio=0.0007
    Epoch  7/10: total=1.5449, vae=1.0920, dsb=0.4525, bio=0.0010
    Epoch  8/10: total=1.5272, vae=1.0923, dsb=0.4345, bio=0.0009
    Epoch  9/10: total=1.5338, vae=1.0929, dsb=0.4405, bio=0.0009
    Epoch 10/10: total=1.5269, vae=1.0922, dsb=0.4343, bio=0.0008

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=33.2806, vae=1.0949, dsb=32.1849, bio=0.0017
    Epoch  2/10: total=32.4618, vae=1.0937, dsb=31.3679, bio=0.0006
    Epoch  3/10: total=32.3182, vae=1.0938, dsb=31.2241, bio=0.0006
    Epoch  4/10: total=32.2473, vae=1.0924, dsb=31.1546, bio=0.0008
    Epoch  5/10: total=32.1031, vae=1.0933, dsb=31.0093, bio=0.0010
    Epoch  6/10: total=31.8223, vae=1.0932, dsb=30.7286, bio=0.0010
    Epoch  7/10: total=32.0723, vae=1.0934, dsb=30.9784, bio=0.0009
    Epoch  8/10: total=31.9102, vae=1.0921, dsb=30.8178, bio=0.0005
    Epoch  9/10: total=32.1405, vae=1.0925, dsb=31.0478, bio=0.0004
    Epoch 10/10: total=31.9143, vae=1.0927, dsb=30.8213, bio=0.0005

  [Backward Policy Training]
    Epoch  1/10: total=1.5969, vae=1.0929, dsb=0.4027, bio=0.2026
    Epoch  2/10: total=1.4791, vae=1.0925, dsb=0.3861, bio=0.0010
    Epoch  3/10: total=1.4899, vae=1.0927, dsb=0.3966, bio=0.0011
    Epoch  4/10: total=1.4844, vae=1.0915, dsb=0.3923, bio=0.0010
    Epoch  5/10: total=1.4707, vae=1.0922, dsb=0.3783, bio=0.0003
    Epoch  6/10: total=1.4690, vae=1.0919, dsb=0.3766, bio=0.0010
    Epoch  7/10: total=1.4878, vae=1.0924, dsb=0.3949, bio=0.0010
    Epoch  8/10: total=1.4668, vae=1.0920, dsb=0.3744, bio=0.0007
    Epoch  9/10: total=1.4744, vae=1.0920, dsb=0.3823, bio=0.0003
    Epoch 10/10: total=1.4689, vae=1.0920, dsb=0.3766, bio=0.0008

[Seed 78] Joint training (original) complete; models and history saved.

[Seed 78] Starting joint training (ablation)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=338.0063, vae=1.9919, dsb=336.0144, bio=0.0000
    Epoch  2/10: total=106.7746, vae=1.0887, dsb=105.6859, bio=0.0000
    Epoch  3/10: total=95.6048, vae=1.0873, dsb=94.5175, bio=0.0000
    Epoch  4/10: total=90.1020, vae=1.0866, dsb=89.0154, bio=0.0000
    Epoch  5/10: total=86.4659, vae=1.0857, dsb=85.3802, bio=0.0000
    Epoch  6/10: total=84.8798, vae=1.0853, dsb=83.7944, bio=0.0000
    Epoch  7/10: total=83.0170, vae=1.0859, dsb=81.9311, bio=0.0000
    Epoch  8/10: total=82.0742, vae=1.0854, dsb=80.9888, bio=0.0000
    Epoch  9/10: total=81.0863, vae=1.0851, dsb=80.0011, bio=0.0000
    Epoch 10/10: total=80.4677, vae=1.0858, dsb=79.3819, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=3.2642, vae=1.0858, dsb=2.1783, bio=0.0000
    Epoch  2/10: total=2.6860, vae=1.0860, dsb=1.6000, bio=0.0000
    Epoch  3/10: total=2.5853, vae=1.0852, dsb=1.5001, bio=0.0000
    Epoch  4/10: total=2.5336, vae=1.0853, dsb=1.4483, bio=0.0000
    Epoch  5/10: total=2.4886, vae=1.0865, dsb=1.4022, bio=0.0000
    Epoch  6/10: total=2.4429, vae=1.0859, dsb=1.3570, bio=0.0000
    Epoch  7/10: total=2.4501, vae=1.0849, dsb=1.3652, bio=0.0000
    Epoch  8/10: total=2.3768, vae=1.0855, dsb=1.2913, bio=0.0000
    Epoch  9/10: total=2.4063, vae=1.0855, dsb=1.3208, bio=0.0000
    Epoch 10/10: total=2.3730, vae=1.0857, dsb=1.2873, bio=0.0000

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=68.9500, vae=1.0849, dsb=67.8650, bio=0.0000
    Epoch  2/10: total=62.6295, vae=1.0852, dsb=61.5443, bio=0.0000
    Epoch  3/10: total=60.8798, vae=1.0843, dsb=59.7955, bio=0.0000
    Epoch  4/10: total=59.9823, vae=1.0849, dsb=58.8974, bio=0.0000
    Epoch  5/10: total=59.6355, vae=1.0850, dsb=58.5505, bio=0.0000
    Epoch  6/10: total=58.6755, vae=1.0848, dsb=57.5908, bio=0.0000
    Epoch  7/10: total=58.9057, vae=1.0851, dsb=57.8207, bio=0.0000
    Epoch  8/10: total=58.1819, vae=1.0852, dsb=57.0967, bio=0.0000
    Epoch  9/10: total=58.0076, vae=1.0853, dsb=56.9223, bio=0.0000
    Epoch 10/10: total=57.5813, vae=1.0861, dsb=56.4952, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=2.1150, vae=1.0850, dsb=1.0300, bio=0.0000
    Epoch  2/10: total=1.9836, vae=1.0851, dsb=0.8985, bio=0.0000
    Epoch  3/10: total=1.9355, vae=1.0844, dsb=0.8511, bio=0.0000
    Epoch  4/10: total=1.9114, vae=1.0841, dsb=0.8273, bio=0.0000
    Epoch  5/10: total=1.9020, vae=1.0845, dsb=0.8176, bio=0.0000
    Epoch  6/10: total=1.8976, vae=1.0850, dsb=0.8126, bio=0.0000
    Epoch  7/10: total=1.8912, vae=1.0854, dsb=0.8058, bio=0.0000
    Epoch  8/10: total=1.8795, vae=1.0856, dsb=0.7939, bio=0.0000
    Epoch  9/10: total=1.8750, vae=1.0845, dsb=0.7905, bio=0.0000
    Epoch 10/10: total=1.8612, vae=1.0847, dsb=0.7765, bio=0.0000

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=53.1503, vae=1.0842, dsb=52.0661, bio=0.0000
    Epoch  2/10: total=50.1688, vae=1.0849, dsb=49.0839, bio=0.0000
    Epoch  3/10: total=49.7477, vae=1.0843, dsb=48.6635, bio=0.0000
    Epoch  4/10: total=49.1304, vae=1.0854, dsb=48.0451, bio=0.0000
    Epoch  5/10: total=49.0966, vae=1.0849, dsb=48.0117, bio=0.0000
    Epoch  6/10: total=48.3781, vae=1.0851, dsb=47.2929, bio=0.0000
    Epoch  7/10: total=48.3106, vae=1.0847, dsb=47.2259, bio=0.0000
    Epoch  8/10: total=48.7348, vae=1.0853, dsb=47.6495, bio=0.0000
    Epoch  9/10: total=48.3717, vae=1.0846, dsb=47.2871, bio=0.0000
    Epoch 10/10: total=48.3066, vae=1.0852, dsb=47.2213, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.7632, vae=1.0847, dsb=0.6785, bio=0.0000
    Epoch  2/10: total=1.7095, vae=1.0851, dsb=0.6244, bio=0.0000
    Epoch  3/10: total=1.6785, vae=1.0848, dsb=0.5937, bio=0.0000
    Epoch  4/10: total=1.6985, vae=1.0861, dsb=0.6124, bio=0.0000
    Epoch  5/10: total=1.6684, vae=1.0858, dsb=0.5826, bio=0.0000
    Epoch  6/10: total=1.6708, vae=1.0850, dsb=0.5858, bio=0.0000
    Epoch  7/10: total=1.6737, vae=1.0851, dsb=0.5886, bio=0.0000
    Epoch  8/10: total=1.6696, vae=1.0848, dsb=0.5848, bio=0.0000
    Epoch  9/10: total=1.6409, vae=1.0845, dsb=0.5564, bio=0.0000
    Epoch 10/10: total=1.6380, vae=1.0846, dsb=0.5534, bio=0.0000

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=43.1241, vae=1.0853, dsb=42.0388, bio=0.0000
    Epoch  2/10: total=41.6239, vae=1.0845, dsb=40.5394, bio=0.0000
    Epoch  3/10: total=41.5330, vae=1.0853, dsb=40.4477, bio=0.0000
    Epoch  4/10: total=40.8766, vae=1.0848, dsb=39.7919, bio=0.0000
    Epoch  5/10: total=40.8844, vae=1.0851, dsb=39.7993, bio=0.0000
    Epoch  6/10: total=40.6314, vae=1.0850, dsb=39.5463, bio=0.0000
    Epoch  7/10: total=40.8697, vae=1.0850, dsb=39.7847, bio=0.0000
    Epoch  8/10: total=40.5542, vae=1.0844, dsb=39.4698, bio=0.0000
    Epoch  9/10: total=40.8380, vae=1.0856, dsb=39.7523, bio=0.0000
    Epoch 10/10: total=40.7383, vae=1.0853, dsb=39.6530, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.5755, vae=1.0842, dsb=0.4913, bio=0.0000
    Epoch  2/10: total=1.5474, vae=1.0854, dsb=0.4620, bio=0.0000
    Epoch  3/10: total=1.5444, vae=1.0848, dsb=0.4596, bio=0.0000
    Epoch  4/10: total=1.5259, vae=1.0850, dsb=0.4409, bio=0.0000
    Epoch  5/10: total=1.5299, vae=1.0852, dsb=0.4447, bio=0.0000
    Epoch  6/10: total=1.5249, vae=1.0861, dsb=0.4388, bio=0.0000
    Epoch  7/10: total=1.5315, vae=1.0845, dsb=0.4470, bio=0.0000
    Epoch  8/10: total=1.5139, vae=1.0848, dsb=0.4291, bio=0.0000
    Epoch  9/10: total=1.5213, vae=1.0854, dsb=0.4359, bio=0.0000
    Epoch 10/10: total=1.5148, vae=1.0848, dsb=0.4300, bio=0.0000

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=36.0809, vae=1.0850, dsb=34.9960, bio=0.0000
    Epoch  2/10: total=35.3072, vae=1.0853, dsb=34.2219, bio=0.0000
    Epoch  3/10: total=35.1965, vae=1.0857, dsb=34.1108, bio=0.0000
    Epoch  4/10: total=35.1038, vae=1.0844, dsb=34.0194, bio=0.0000
    Epoch  5/10: total=34.9587, vae=1.0856, dsb=33.8732, bio=0.0000
    Epoch  6/10: total=34.6525, vae=1.0855, dsb=33.5670, bio=0.0000
    Epoch  7/10: total=34.9363, vae=1.0858, dsb=33.8505, bio=0.0000
    Epoch  8/10: total=34.7907, vae=1.0845, dsb=33.7063, bio=0.0000
    Epoch  9/10: total=35.0180, vae=1.0850, dsb=33.9330, bio=0.0000
    Epoch 10/10: total=34.8043, vae=1.0852, dsb=33.7191, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.4876, vae=1.0841, dsb=0.4035, bio=0.0000
    Epoch  2/10: total=1.4733, vae=1.0849, dsb=0.3883, bio=0.0000
    Epoch  3/10: total=1.4851, vae=1.0854, dsb=0.3997, bio=0.0000
    Epoch  4/10: total=1.4799, vae=1.0842, dsb=0.3957, bio=0.0000
    Epoch  5/10: total=1.4661, vae=1.0849, dsb=0.3812, bio=0.0000
    Epoch  6/10: total=1.4643, vae=1.0848, dsb=0.3795, bio=0.0000
    Epoch  7/10: total=1.4842, vae=1.0853, dsb=0.3989, bio=0.0000
    Epoch  8/10: total=1.4623, vae=1.0850, dsb=0.3773, bio=0.0000
    Epoch  9/10: total=1.4705, vae=1.0851, dsb=0.3854, bio=0.0000
    Epoch 10/10: total=1.4649, vae=1.0852, dsb=0.3797, bio=0.0000

[Seed 78] Joint training (ablation) complete; models and history saved.

[Seed 78] Drift genes saved in /home/yyuan/ICB_TCE/iter_results/run_078

[Seed 78] run finished.

================================================================================
[Seed 79] Starting running whole pipeline...
================================================================================

[Seed 79] Starting VAE pre-training...

    Epoch [01/20], Beta: 0.000, Average Loss: 538.8233
    Epoch [02/20], Beta: 0.000, Average Loss: 307.9469
    Epoch [03/20], Beta: 0.000, Average Loss: 270.3771
    Epoch [04/20], Beta: 0.000, Average Loss: 251.0395
    Epoch [05/20], Beta: 0.100, Average Loss: 245.5456
    Epoch [06/20], Beta: 0.200, Average Loss: 244.9275
    Epoch [07/20], Beta: 0.300, Average Loss: 245.1763
    Epoch [08/20], Beta: 0.400, Average Loss: 246.0220
    Epoch [09/20], Beta: 0.500, Average Loss: 247.0990
    Epoch [10/20], Beta: 0.600, Average Loss: 248.2149
    Epoch [11/20], Beta: 0.700, Average Loss: 249.4247
    Epoch [12/20], Beta: 0.800, Average Loss: 250.6288
    Epoch [13/20], Beta: 0.900, Average Loss: 251.8225
    Epoch [14/20], Beta: 1.000, Average Loss: 253.4475
    Epoch [15/20], Beta: 1.000, Average Loss: 253.0321
    Epoch [16/20], Beta: 1.000, Average Loss: 252.6613
    Epoch [17/20], Beta: 1.000, Average Loss: 252.3129
    Epoch [18/20], Beta: 1.000, Average Loss: 251.9904
    Epoch [19/20], Beta: 1.000, Average Loss: 251.6109
    Epoch [20/20], Beta: 1.000, Average Loss: 251.4698

[Seed 79] VAE pre-training complete.

[Seed 79] Starting joint training (original)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=273.3475, vae=3.5030, dsb=258.1313, bio=23.4263
    Epoch  2/10: total=91.1433, vae=1.1015, dsb=89.9985, bio=0.0865
    Epoch  3/10: total=79.4669, vae=1.0947, dsb=78.3553, bio=0.0338
    Epoch  4/10: total=74.0435, vae=1.0923, dsb=72.9417, bio=0.0190
    Epoch  5/10: total=71.1011, vae=1.0920, dsb=70.0027, bio=0.0128
    Epoch  6/10: total=69.2978, vae=1.0907, dsb=68.2026, bio=0.0091
    Epoch  7/10: total=67.5424, vae=1.0902, dsb=66.4486, bio=0.0072
    Epoch  8/10: total=66.2749, vae=1.0894, dsb=65.1826, bio=0.0058
    Epoch  9/10: total=65.4106, vae=1.0895, dsb=64.3186, bio=0.0050
    Epoch 10/10: total=64.4522, vae=1.0887, dsb=63.3613, bio=0.0044

  [Backward Policy Training]
    Epoch  1/10: total=3.2850, vae=1.0905, dsb=2.1869, bio=0.0152
    Epoch  2/10: total=2.7690, vae=1.0894, dsb=1.6772, bio=0.0048
    Epoch  3/10: total=2.6467, vae=1.0880, dsb=1.5570, bio=0.0034
    Epoch  4/10: total=2.6128, vae=1.0885, dsb=1.5229, bio=0.0028
    Epoch  5/10: total=2.5727, vae=1.0877, dsb=1.4838, bio=0.0026
    Epoch  6/10: total=2.5345, vae=1.0884, dsb=1.4450, bio=0.0024
    Epoch  7/10: total=2.4939, vae=1.0883, dsb=1.4045, bio=0.0022
    Epoch  8/10: total=2.4712, vae=1.0874, dsb=1.3828, bio=0.0021
    Epoch  9/10: total=2.4709, vae=1.0875, dsb=1.3824, bio=0.0021
    Epoch 10/10: total=2.4360, vae=1.0872, dsb=1.3478, bio=0.0020

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=57.5631, vae=1.0894, dsb=56.4719, bio=0.0037
    Epoch  2/10: total=51.6226, vae=1.0883, dsb=50.5331, bio=0.0024
    Epoch  3/10: total=50.1587, vae=1.0881, dsb=49.0697, bio=0.0019
    Epoch  4/10: total=49.3634, vae=1.0873, dsb=48.2752, bio=0.0019
    Epoch  5/10: total=48.9048, vae=1.0877, dsb=47.8162, bio=0.0020
    Epoch  6/10: total=48.3799, vae=1.0874, dsb=47.2915, bio=0.0020
    Epoch  7/10: total=47.9349, vae=1.0878, dsb=46.8461, bio=0.0020
    Epoch  8/10: total=47.6977, vae=1.0882, dsb=46.6084, bio=0.0022
    Epoch  9/10: total=47.6979, vae=1.0876, dsb=46.6094, bio=0.0019
    Epoch 10/10: total=47.4972, vae=1.0876, dsb=46.4087, bio=0.0019

  [Backward Policy Training]
    Epoch  1/10: total=2.2239, vae=1.0876, dsb=1.1326, bio=0.0073
    Epoch  2/10: total=2.1198, vae=1.0860, dsb=1.0329, bio=0.0020
    Epoch  3/10: total=2.0551, vae=1.0862, dsb=0.9681, bio=0.0019
    Epoch  4/10: total=2.0577, vae=1.0861, dsb=0.9706, bio=0.0019
    Epoch  5/10: total=1.9774, vae=1.0864, dsb=0.8901, bio=0.0017
    Epoch  6/10: total=1.9942, vae=1.0864, dsb=0.9070, bio=0.0017
    Epoch  7/10: total=2.0404, vae=1.0864, dsb=0.9531, bio=0.0017
    Epoch  8/10: total=1.9783, vae=1.0858, dsb=0.8917, bio=0.0017
    Epoch  9/10: total=1.9935, vae=1.0867, dsb=0.9059, bio=0.0016
    Epoch 10/10: total=1.9880, vae=1.0853, dsb=0.9019, bio=0.0017

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=45.4131, vae=1.0886, dsb=44.3226, bio=0.0038
    Epoch  2/10: total=42.9180, vae=1.0878, dsb=41.8292, bio=0.0019
    Epoch  3/10: total=42.2866, vae=1.0868, dsb=41.1989, bio=0.0017
    Epoch  4/10: total=41.9831, vae=1.0865, dsb=40.8957, bio=0.0017
    Epoch  5/10: total=41.7762, vae=1.0862, dsb=40.6892, bio=0.0017
    Epoch  6/10: total=41.6273, vae=1.0873, dsb=40.5392, bio=0.0017
    Epoch  7/10: total=41.5176, vae=1.0865, dsb=40.4303, bio=0.0017
    Epoch  8/10: total=41.5129, vae=1.0859, dsb=40.4260, bio=0.0019
    Epoch  9/10: total=41.3153, vae=1.0870, dsb=40.2274, bio=0.0017
    Epoch 10/10: total=41.2459, vae=1.0860, dsb=40.1591, bio=0.0017

  [Backward Policy Training]
    Epoch  1/10: total=1.8784, vae=1.0869, dsb=0.7870, bio=0.0091
    Epoch  2/10: total=1.8137, vae=1.0861, dsb=0.7267, bio=0.0017
    Epoch  3/10: total=1.8139, vae=1.0856, dsb=0.7275, bio=0.0016
    Epoch  4/10: total=1.7853, vae=1.0858, dsb=0.6988, bio=0.0015
    Epoch  5/10: total=1.7862, vae=1.0853, dsb=0.7002, bio=0.0015
    Epoch  6/10: total=1.7722, vae=1.0856, dsb=0.6858, bio=0.0015
    Epoch  7/10: total=1.7658, vae=1.0855, dsb=0.6795, bio=0.0017
    Epoch  8/10: total=1.7804, vae=1.0854, dsb=0.6942, bio=0.0014
    Epoch  9/10: total=1.7783, vae=1.0858, dsb=0.6919, bio=0.0014
    Epoch 10/10: total=1.7704, vae=1.0856, dsb=0.6841, bio=0.0014

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=38.0730, vae=1.0879, dsb=36.9836, bio=0.0029
    Epoch  2/10: total=37.2121, vae=1.0873, dsb=36.1239, bio=0.0019
    Epoch  3/10: total=36.7604, vae=1.0869, dsb=35.6727, bio=0.0015
    Epoch  4/10: total=36.7203, vae=1.0859, dsb=35.6337, bio=0.0015
    Epoch  5/10: total=36.6165, vae=1.0870, dsb=35.5288, bio=0.0015
    Epoch  6/10: total=36.6130, vae=1.0861, dsb=35.5262, bio=0.0015
    Epoch  7/10: total=36.4383, vae=1.0862, dsb=35.3513, bio=0.0015
    Epoch  8/10: total=36.5292, vae=1.0854, dsb=35.4430, bio=0.0015
    Epoch  9/10: total=36.3664, vae=1.0862, dsb=35.2795, bio=0.0015
    Epoch 10/10: total=36.3867, vae=1.0853, dsb=35.3007, bio=0.0014

  [Backward Policy Training]
    Epoch  1/10: total=1.7212, vae=1.0869, dsb=0.6170, bio=0.0348
    Epoch  2/10: total=1.6765, vae=1.0846, dsb=0.5912, bio=0.0015
    Epoch  3/10: total=1.6755, vae=1.0865, dsb=0.5883, bio=0.0014
    Epoch  4/10: total=1.6621, vae=1.0851, dsb=0.5763, bio=0.0014
    Epoch  5/10: total=1.6523, vae=1.0855, dsb=0.5661, bio=0.0015
    Epoch  6/10: total=1.6413, vae=1.0848, dsb=0.5559, bio=0.0013
    Epoch  7/10: total=1.6533, vae=1.0851, dsb=0.5676, bio=0.0012
    Epoch  8/10: total=1.6351, vae=1.0852, dsb=0.5493, bio=0.0012
    Epoch  9/10: total=1.6377, vae=1.0840, dsb=0.5531, bio=0.0012
    Epoch 10/10: total=1.6395, vae=1.0849, dsb=0.5540, bio=0.0012

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=32.5272, vae=1.0874, dsb=31.4384, bio=0.0027
    Epoch  2/10: total=32.1252, vae=1.0870, dsb=31.0375, bio=0.0013
    Epoch  3/10: total=32.0744, vae=1.0864, dsb=30.9873, bio=0.0013
    Epoch  4/10: total=31.9418, vae=1.0862, dsb=30.8549, bio=0.0014
    Epoch  5/10: total=31.9335, vae=1.0859, dsb=30.8470, bio=0.0013
    Epoch  6/10: total=31.9021, vae=1.0856, dsb=30.8158, bio=0.0013
    Epoch  7/10: total=31.8053, vae=1.0854, dsb=30.7192, bio=0.0013
    Epoch  8/10: total=32.0700, vae=1.0855, dsb=30.9838, bio=0.0014
    Epoch  9/10: total=31.7599, vae=1.0858, dsb=30.6735, bio=0.0012
    Epoch 10/10: total=31.6934, vae=1.0855, dsb=30.6073, bio=0.0012

  [Backward Policy Training]
    Epoch  1/10: total=1.6660, vae=1.0865, dsb=0.5222, bio=0.1144
    Epoch  2/10: total=1.5830, vae=1.0847, dsb=0.4977, bio=0.0013
    Epoch  3/10: total=1.5739, vae=1.0846, dsb=0.4887, bio=0.0012
    Epoch  4/10: total=1.5903, vae=1.0851, dsb=0.5046, bio=0.0012
    Epoch  5/10: total=1.5920, vae=1.0851, dsb=0.5063, bio=0.0013
    Epoch  6/10: total=1.5840, vae=1.0849, dsb=0.4985, bio=0.0011
    Epoch  7/10: total=1.5707, vae=1.0842, dsb=0.4859, bio=0.0011
    Epoch  8/10: total=1.5774, vae=1.0851, dsb=0.4917, bio=0.0011
    Epoch  9/10: total=1.5641, vae=1.0852, dsb=0.4784, bio=0.0011
    Epoch 10/10: total=1.5832, vae=1.0851, dsb=0.4975, bio=0.0013

[Seed 79] Joint training (original) complete; models and history saved.

[Seed 79] Starting joint training (ablation)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=259.3743, vae=1.9787, dsb=257.3956, bio=0.0000
    Epoch  2/10: total=90.0356, vae=1.0814, dsb=88.9542, bio=0.0000
    Epoch  3/10: total=78.9342, vae=1.0795, dsb=77.8547, bio=0.0000
    Epoch  4/10: total=73.7712, vae=1.0786, dsb=72.6926, bio=0.0000
    Epoch  5/10: total=70.9146, vae=1.0789, dsb=69.8357, bio=0.0000
    Epoch  6/10: total=69.1525, vae=1.0779, dsb=68.0746, bio=0.0000
    Epoch  7/10: total=67.4062, vae=1.0778, dsb=66.3284, bio=0.0000
    Epoch  8/10: total=66.1878, vae=1.0773, dsb=65.1105, bio=0.0000
    Epoch  9/10: total=65.3550, vae=1.0777, dsb=64.2773, bio=0.0000
    Epoch 10/10: total=64.4277, vae=1.0772, dsb=63.3506, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=3.1870, vae=1.0777, dsb=2.1093, bio=0.0000
    Epoch  2/10: total=2.6865, vae=1.0784, dsb=1.6081, bio=0.0000
    Epoch  3/10: total=2.5624, vae=1.0775, dsb=1.4849, bio=0.0000
    Epoch  4/10: total=2.5241, vae=1.0782, dsb=1.4458, bio=0.0000
    Epoch  5/10: total=2.4843, vae=1.0775, dsb=1.4068, bio=0.0000
    Epoch  6/10: total=2.4473, vae=1.0784, dsb=1.3689, bio=0.0000
    Epoch  7/10: total=2.4102, vae=1.0785, dsb=1.3317, bio=0.0000
    Epoch  8/10: total=2.3873, vae=1.0776, dsb=1.3097, bio=0.0000
    Epoch  9/10: total=2.3890, vae=1.0779, dsb=1.3111, bio=0.0000
    Epoch 10/10: total=2.3552, vae=1.0777, dsb=1.2775, bio=0.0000

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=55.0997, vae=1.0772, dsb=54.0225, bio=0.0000
    Epoch  2/10: total=49.4520, vae=1.0773, dsb=48.3748, bio=0.0000
    Epoch  3/10: total=48.0147, vae=1.0773, dsb=46.9374, bio=0.0000
    Epoch  4/10: total=47.2928, vae=1.0766, dsb=46.2162, bio=0.0000
    Epoch  5/10: total=46.9087, vae=1.0772, dsb=45.8315, bio=0.0000
    Epoch  6/10: total=46.3784, vae=1.0771, dsb=45.3013, bio=0.0000
    Epoch  7/10: total=45.9330, vae=1.0776, dsb=44.8554, bio=0.0000
    Epoch  8/10: total=45.7154, vae=1.0781, dsb=44.6373, bio=0.0000
    Epoch  9/10: total=45.6686, vae=1.0775, dsb=44.5911, bio=0.0000
    Epoch 10/10: total=45.4950, vae=1.0776, dsb=44.4174, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=2.1233, vae=1.0770, dsb=1.0463, bio=0.0000
    Epoch  2/10: total=2.0273, vae=1.0769, dsb=0.9504, bio=0.0000
    Epoch  3/10: total=1.9678, vae=1.0772, dsb=0.8906, bio=0.0000
    Epoch  4/10: total=1.9704, vae=1.0772, dsb=0.8932, bio=0.0000
    Epoch  5/10: total=1.8952, vae=1.0777, dsb=0.8175, bio=0.0000
    Epoch  6/10: total=1.9117, vae=1.0776, dsb=0.8341, bio=0.0000
    Epoch  7/10: total=1.9552, vae=1.0778, dsb=0.8774, bio=0.0000
    Epoch  8/10: total=1.8967, vae=1.0771, dsb=0.8196, bio=0.0000
    Epoch  9/10: total=1.9112, vae=1.0781, dsb=0.8331, bio=0.0000
    Epoch 10/10: total=1.9058, vae=1.0768, dsb=0.8290, bio=0.0000

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=42.4582, vae=1.0768, dsb=41.3814, bio=0.0000
    Epoch  2/10: total=40.2536, vae=1.0777, dsb=39.1758, bio=0.0000
    Epoch  3/10: total=39.7232, vae=1.0769, dsb=38.6463, bio=0.0000
    Epoch  4/10: total=39.4377, vae=1.0769, dsb=38.3608, bio=0.0000
    Epoch  5/10: total=39.2538, vae=1.0766, dsb=38.1772, bio=0.0000
    Epoch  6/10: total=39.1141, vae=1.0778, dsb=38.0362, bio=0.0000
    Epoch  7/10: total=39.0470, vae=1.0771, dsb=37.9699, bio=0.0000
    Epoch  8/10: total=39.0059, vae=1.0765, dsb=37.9294, bio=0.0000
    Epoch  9/10: total=38.8110, vae=1.0778, dsb=37.7332, bio=0.0000
    Epoch 10/10: total=38.7896, vae=1.0768, dsb=37.7129, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.7838, vae=1.0771, dsb=0.7067, bio=0.0000
    Epoch  2/10: total=1.7302, vae=1.0777, dsb=0.6525, bio=0.0000
    Epoch  3/10: total=1.7304, vae=1.0772, dsb=0.6532, bio=0.0000
    Epoch  4/10: total=1.7038, vae=1.0776, dsb=0.6263, bio=0.0000
    Epoch  5/10: total=1.7047, vae=1.0771, dsb=0.6276, bio=0.0000
    Epoch  6/10: total=1.6923, vae=1.0774, dsb=0.6150, bio=0.0000
    Epoch  7/10: total=1.6866, vae=1.0774, dsb=0.6092, bio=0.0000
    Epoch  8/10: total=1.7002, vae=1.0774, dsb=0.6228, bio=0.0000
    Epoch  9/10: total=1.6985, vae=1.0777, dsb=0.6208, bio=0.0000
    Epoch 10/10: total=1.6914, vae=1.0776, dsb=0.6138, bio=0.0000

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=36.0891, vae=1.0772, dsb=35.0119, bio=0.0000
    Epoch  2/10: total=35.4119, vae=1.0777, dsb=34.3342, bio=0.0000
    Epoch  3/10: total=35.0003, vae=1.0778, dsb=33.9226, bio=0.0000
    Epoch  4/10: total=34.9996, vae=1.0769, dsb=33.9227, bio=0.0000
    Epoch  5/10: total=34.9122, vae=1.0781, dsb=33.8341, bio=0.0000
    Epoch  6/10: total=34.8998, vae=1.0773, dsb=33.8225, bio=0.0000
    Epoch  7/10: total=34.7574, vae=1.0775, dsb=33.6799, bio=0.0000
    Epoch  8/10: total=34.8443, vae=1.0767, dsb=33.7676, bio=0.0000
    Epoch  9/10: total=34.6918, vae=1.0776, dsb=33.6141, bio=0.0000
    Epoch 10/10: total=34.6993, vae=1.0768, dsb=33.6225, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.6219, vae=1.0779, dsb=0.5440, bio=0.0000
    Epoch  2/10: total=1.5997, vae=1.0765, dsb=0.5232, bio=0.0000
    Epoch  3/10: total=1.6000, vae=1.0785, dsb=0.5215, bio=0.0000
    Epoch  4/10: total=1.5884, vae=1.0772, dsb=0.5112, bio=0.0000
    Epoch  5/10: total=1.5801, vae=1.0775, dsb=0.5026, bio=0.0000
    Epoch  6/10: total=1.5707, vae=1.0771, dsb=0.4935, bio=0.0000
    Epoch  7/10: total=1.5816, vae=1.0774, dsb=0.5042, bio=0.0000
    Epoch  8/10: total=1.5651, vae=1.0774, dsb=0.4877, bio=0.0000
    Epoch  9/10: total=1.5677, vae=1.0763, dsb=0.4913, bio=0.0000
    Epoch 10/10: total=1.5694, vae=1.0772, dsb=0.4923, bio=0.0000

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=30.7483, vae=1.0769, dsb=29.6714, bio=0.0000
    Epoch  2/10: total=30.4424, vae=1.0778, dsb=29.3646, bio=0.0000
    Epoch  3/10: total=30.4262, vae=1.0775, dsb=29.3487, bio=0.0000
    Epoch  4/10: total=30.3096, vae=1.0776, dsb=29.2320, bio=0.0000
    Epoch  5/10: total=30.3156, vae=1.0775, dsb=29.2381, bio=0.0000
    Epoch  6/10: total=30.2960, vae=1.0773, dsb=29.2187, bio=0.0000
    Epoch  7/10: total=30.2020, vae=1.0773, dsb=29.1248, bio=0.0000
    Epoch  8/10: total=30.4581, vae=1.0774, dsb=29.3807, bio=0.0000
    Epoch  9/10: total=30.1898, vae=1.0778, dsb=29.1119, bio=0.0000
    Epoch 10/10: total=30.1214, vae=1.0775, dsb=29.0438, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.5420, vae=1.0776, dsb=0.4644, bio=0.0000
    Epoch  2/10: total=1.5211, vae=1.0769, dsb=0.4441, bio=0.0000
    Epoch  3/10: total=1.5134, vae=1.0768, dsb=0.4366, bio=0.0000
    Epoch  4/10: total=1.5295, vae=1.0775, dsb=0.4520, bio=0.0000
    Epoch  5/10: total=1.5313, vae=1.0774, dsb=0.4539, bio=0.0000
    Epoch  6/10: total=1.5243, vae=1.0774, dsb=0.4469, bio=0.0000
    Epoch  7/10: total=1.5117, vae=1.0767, dsb=0.4349, bio=0.0000
    Epoch  8/10: total=1.5184, vae=1.0777, dsb=0.4407, bio=0.0000
    Epoch  9/10: total=1.5062, vae=1.0777, dsb=0.4285, bio=0.0000
    Epoch 10/10: total=1.5242, vae=1.0776, dsb=0.4466, bio=0.0000

[Seed 79] Joint training (ablation) complete; models and history saved.

[Seed 79] Drift genes saved in /home/yyuan/ICB_TCE/iter_results/run_079

[Seed 79] run finished.

================================================================================
[Seed 80] Starting running whole pipeline...
================================================================================

[Seed 80] Starting VAE pre-training...

    Epoch [01/20], Beta: 0.000, Average Loss: 533.0359
    Epoch [02/20], Beta: 0.000, Average Loss: 312.9544
    Epoch [03/20], Beta: 0.000, Average Loss: 275.8075
    Epoch [04/20], Beta: 0.000, Average Loss: 254.4362
    Epoch [05/20], Beta: 0.100, Average Loss: 247.3467
    Epoch [06/20], Beta: 0.200, Average Loss: 245.9063
    Epoch [07/20], Beta: 0.300, Average Loss: 246.0527
    Epoch [08/20], Beta: 0.400, Average Loss: 246.8054
    Epoch [09/20], Beta: 0.500, Average Loss: 247.7191
    Epoch [10/20], Beta: 0.600, Average Loss: 248.7312
    Epoch [11/20], Beta: 0.700, Average Loss: 249.7953
    Epoch [12/20], Beta: 0.800, Average Loss: 250.9923
    Epoch [13/20], Beta: 0.900, Average Loss: 252.1005
    Epoch [14/20], Beta: 1.000, Average Loss: 253.6615
    Epoch [15/20], Beta: 1.000, Average Loss: 253.1715
    Epoch [16/20], Beta: 1.000, Average Loss: 252.7799
    Epoch [17/20], Beta: 1.000, Average Loss: 252.4293
    Epoch [18/20], Beta: 1.000, Average Loss: 252.0918
    Epoch [19/20], Beta: 1.000, Average Loss: 251.6879
    Epoch [20/20], Beta: 1.000, Average Loss: 251.5109

[Seed 80] VAE pre-training complete.

[Seed 80] Starting joint training (original)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=978.9234, vae=3.6247, dsb=955.4578, bio=39.6819
    Epoch  2/10: total=300.6165, vae=1.0897, dsb=299.4896, bio=0.0744
    Epoch  3/10: total=287.9470, vae=1.0858, dsb=286.8459, bio=0.0306
    Epoch  4/10: total=285.0092, vae=1.0833, dsb=283.9170, bio=0.0180
    Epoch  5/10: total=282.0764, vae=1.0832, dsb=280.9870, bio=0.0124
    Epoch  6/10: total=279.1150, vae=1.0812, dsb=278.0292, bio=0.0092
    Epoch  7/10: total=274.2989, vae=1.0818, dsb=273.2135, bio=0.0074
    Epoch  8/10: total=275.3907, vae=1.0816, dsb=274.3056, bio=0.0069
    Epoch  9/10: total=274.0766, vae=1.0819, dsb=272.9921, bio=0.0052
    Epoch 10/10: total=273.7344, vae=1.0807, dsb=272.6513, bio=0.0047

  [Backward Policy Training]
    Epoch  1/10: total=3.8519, vae=1.0825, dsb=2.7619, bio=0.0149
    Epoch  2/10: total=3.3631, vae=1.0806, dsb=2.2799, bio=0.0053
    Epoch  3/10: total=3.2651, vae=1.0802, dsb=2.1830, bio=0.0037
    Epoch  4/10: total=3.1431, vae=1.0795, dsb=2.0621, bio=0.0032
    Epoch  5/10: total=3.0378, vae=1.0798, dsb=1.9566, bio=0.0027
    Epoch  6/10: total=3.1043, vae=1.0797, dsb=2.0234, bio=0.0024
    Epoch  7/10: total=2.9967, vae=1.0798, dsb=1.9157, bio=0.0023
    Epoch  8/10: total=2.9762, vae=1.0792, dsb=1.8959, bio=0.0022
    Epoch  9/10: total=3.0236, vae=1.0789, dsb=1.9437, bio=0.0021
    Epoch 10/10: total=2.9998, vae=1.0790, dsb=1.9195, bio=0.0026

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=232.8805, vae=1.0812, dsb=231.7974, bio=0.0038
    Epoch  2/10: total=225.8977, vae=1.0806, dsb=224.8161, bio=0.0021
    Epoch  3/10: total=223.7199, vae=1.0804, dsb=222.6385, bio=0.0020
    Epoch  4/10: total=221.5574, vae=1.0812, dsb=220.4750, bio=0.0023
    Epoch  5/10: total=222.9214, vae=1.0796, dsb=221.8408, bio=0.0020
    Epoch  6/10: total=222.5965, vae=1.0794, dsb=221.5161, bio=0.0019
    Epoch  7/10: total=223.4634, vae=1.0793, dsb=222.3831, bio=0.0020
    Epoch  8/10: total=221.2486, vae=1.0794, dsb=220.1682, bio=0.0020
    Epoch  9/10: total=221.5695, vae=1.0789, dsb=220.4896, bio=0.0020
    Epoch 10/10: total=222.4049, vae=1.0791, dsb=221.3247, bio=0.0021

  [Backward Policy Training]
    Epoch  1/10: total=2.6493, vae=1.0798, dsb=1.5667, bio=0.0056
    Epoch  2/10: total=2.5391, vae=1.0788, dsb=1.4592, bio=0.0021
    Epoch  3/10: total=2.4730, vae=1.0782, dsb=1.3939, bio=0.0019
    Epoch  4/10: total=2.4570, vae=1.0785, dsb=1.3776, bio=0.0018
    Epoch  5/10: total=2.4603, vae=1.0788, dsb=1.3806, bio=0.0018
    Epoch  6/10: total=2.4242, vae=1.0775, dsb=1.3459, bio=0.0015
    Epoch  7/10: total=2.4155, vae=1.0773, dsb=1.3372, bio=0.0021
    Epoch  8/10: total=2.4185, vae=1.0772, dsb=1.3405, bio=0.0017
    Epoch  9/10: total=2.4023, vae=1.0777, dsb=1.3238, bio=0.0017
    Epoch 10/10: total=2.3895, vae=1.0778, dsb=1.3109, bio=0.0017

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=191.9108, vae=1.0800, dsb=190.8292, bio=0.0031
    Epoch  2/10: total=189.8265, vae=1.0797, dsb=188.7458, bio=0.0019
    Epoch  3/10: total=189.2177, vae=1.0799, dsb=188.1370, bio=0.0018
    Epoch  4/10: total=189.5933, vae=1.0785, dsb=188.5140, bio=0.0017
    Epoch  5/10: total=188.4591, vae=1.0792, dsb=187.3790, bio=0.0018
    Epoch  6/10: total=189.7019, vae=1.0783, dsb=188.6227, bio=0.0017
    Epoch  7/10: total=189.3932, vae=1.0782, dsb=188.3141, bio=0.0018
    Epoch  8/10: total=187.6507, vae=1.0784, dsb=186.5714, bio=0.0018
    Epoch  9/10: total=187.8212, vae=1.0785, dsb=186.7418, bio=0.0018
    Epoch 10/10: total=188.6399, vae=1.0781, dsb=187.5609, bio=0.0018

  [Backward Policy Training]
    Epoch  1/10: total=2.3443, vae=1.0789, dsb=1.2627, bio=0.0052
    Epoch  2/10: total=2.2501, vae=1.0783, dsb=1.1710, bio=0.0018
    Epoch  3/10: total=2.2220, vae=1.0770, dsb=1.1441, bio=0.0019
    Epoch  4/10: total=2.1800, vae=1.0773, dsb=1.1019, bio=0.0016
    Epoch  5/10: total=2.1667, vae=1.0775, dsb=1.0884, bio=0.0015
    Epoch  6/10: total=2.2189, vae=1.0772, dsb=1.1409, bio=0.0015
    Epoch  7/10: total=2.2149, vae=1.0774, dsb=1.1368, bio=0.0015
    Epoch  8/10: total=2.1797, vae=1.0775, dsb=1.1014, bio=0.0016
    Epoch  9/10: total=2.2123, vae=1.0768, dsb=1.1347, bio=0.0016
    Epoch 10/10: total=2.2214, vae=1.0774, dsb=1.1432, bio=0.0015

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=159.3456, vae=1.0800, dsb=158.2641, bio=0.0030
    Epoch  2/10: total=157.7482, vae=1.0789, dsb=156.6684, bio=0.0020
    Epoch  3/10: total=158.3060, vae=1.0777, dsb=157.2275, bio=0.0017
    Epoch  4/10: total=156.7284, vae=1.0786, dsb=155.6490, bio=0.0016
    Epoch  5/10: total=157.1008, vae=1.0777, dsb=156.0224, bio=0.0016
    Epoch  6/10: total=157.1169, vae=1.0787, dsb=156.0374, bio=0.0017
    Epoch  7/10: total=157.1018, vae=1.0784, dsb=156.0226, bio=0.0017
    Epoch  8/10: total=156.8558, vae=1.0775, dsb=155.7774, bio=0.0019
    Epoch  9/10: total=157.7679, vae=1.0783, dsb=156.6888, bio=0.0016
    Epoch 10/10: total=156.7784, vae=1.0785, dsb=155.6991, bio=0.0016

  [Backward Policy Training]
    Epoch  1/10: total=2.1128, vae=1.0775, dsb=1.0310, bio=0.0085
    Epoch  2/10: total=2.0831, vae=1.0766, dsb=1.0058, bio=0.0016
    Epoch  3/10: total=2.0555, vae=1.0764, dsb=0.9783, bio=0.0017
    Epoch  4/10: total=2.0764, vae=1.0776, dsb=0.9981, bio=0.0014
    Epoch  5/10: total=2.0646, vae=1.0768, dsb=0.9871, bio=0.0014
    Epoch  6/10: total=2.0787, vae=1.0769, dsb=1.0011, bio=0.0014
    Epoch  7/10: total=2.0417, vae=1.0773, dsb=0.9637, bio=0.0014
    Epoch  8/10: total=2.0537, vae=1.0773, dsb=0.9752, bio=0.0024
    Epoch  9/10: total=2.0657, vae=1.0767, dsb=0.9884, bio=0.0013
    Epoch 10/10: total=2.0330, vae=1.0772, dsb=0.9552, bio=0.0013

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=138.4286, vae=1.0794, dsb=137.3480, bio=0.0025
    Epoch  2/10: total=137.5126, vae=1.0780, dsb=136.4338, bio=0.0016
    Epoch  3/10: total=138.9905, vae=1.0776, dsb=137.9121, bio=0.0015
    Epoch  4/10: total=136.8289, vae=1.0779, dsb=135.7503, bio=0.0015
    Epoch  5/10: total=137.3788, vae=1.0780, dsb=136.3001, bio=0.0015
    Epoch  6/10: total=138.5485, vae=1.0771, dsb=137.4707, bio=0.0015
    Epoch  7/10: total=137.7744, vae=1.0774, dsb=136.6961, bio=0.0018
    Epoch  8/10: total=138.4760, vae=1.0779, dsb=137.3973, bio=0.0015
    Epoch  9/10: total=137.0757, vae=1.0776, dsb=135.9973, bio=0.0015
    Epoch 10/10: total=138.1564, vae=1.0771, dsb=137.0785, bio=0.0015

  [Backward Policy Training]
    Epoch  1/10: total=1.9555, vae=1.0790, dsb=0.8608, bio=0.0312
    Epoch  2/10: total=1.9102, vae=1.0770, dsb=0.8324, bio=0.0015
    Epoch  3/10: total=1.9417, vae=1.0773, dsb=0.8638, bio=0.0014
    Epoch  4/10: total=1.9581, vae=1.0770, dsb=0.8805, bio=0.0013
    Epoch  5/10: total=1.8979, vae=1.0774, dsb=0.8199, bio=0.0012
    Epoch  6/10: total=1.9336, vae=1.0759, dsb=0.8570, bio=0.0013
    Epoch  7/10: total=1.9402, vae=1.0764, dsb=0.8631, bio=0.0012
    Epoch  8/10: total=1.9302, vae=1.0757, dsb=0.8538, bio=0.0012
    Epoch  9/10: total=1.8913, vae=1.0759, dsb=0.8148, bio=0.0012
    Epoch 10/10: total=1.9158, vae=1.0766, dsb=0.8386, bio=0.0012

[Seed 80] Joint training (original) complete; models and history saved.

[Seed 80] Starting joint training (ablation)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=955.9857, vae=2.0068, dsb=953.9789, bio=0.0000
    Epoch  2/10: total=299.1485, vae=1.0723, dsb=298.0762, bio=0.0000
    Epoch  3/10: total=286.8018, vae=1.0716, dsb=285.7302, bio=0.0000
    Epoch  4/10: total=284.4135, vae=1.0700, dsb=283.3435, bio=0.0000
    Epoch  5/10: total=281.7238, vae=1.0703, dsb=280.6535, bio=0.0000
    Epoch  6/10: total=278.8437, vae=1.0687, dsb=277.7751, bio=0.0000
    Epoch  7/10: total=274.0078, vae=1.0695, dsb=272.9383, bio=0.0000
    Epoch  8/10: total=275.1061, vae=1.0696, dsb=274.0364, bio=0.0000
    Epoch  9/10: total=273.8095, vae=1.0701, dsb=272.7394, bio=0.0000
    Epoch 10/10: total=273.4076, vae=1.0692, dsb=272.3384, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=3.6289, vae=1.0698, dsb=2.5591, bio=0.0000
    Epoch  2/10: total=3.1724, vae=1.0696, dsb=2.1028, bio=0.0000
    Epoch  3/10: total=3.0828, vae=1.0697, dsb=2.0131, bio=0.0000
    Epoch  4/10: total=2.9695, vae=1.0692, dsb=1.9004, bio=0.0000
    Epoch  5/10: total=2.8723, vae=1.0698, dsb=1.8025, bio=0.0000
    Epoch  6/10: total=2.9328, vae=1.0698, dsb=1.8630, bio=0.0000
    Epoch  7/10: total=2.8341, vae=1.0700, dsb=1.7641, bio=0.0000
    Epoch  8/10: total=2.8153, vae=1.0695, dsb=1.7458, bio=0.0000
    Epoch  9/10: total=2.8582, vae=1.0693, dsb=1.7889, bio=0.0000
    Epoch 10/10: total=2.8374, vae=1.0695, dsb=1.7679, bio=0.0000

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=224.8048, vae=1.0687, dsb=223.7361, bio=0.0000
    Epoch  2/10: total=218.5057, vae=1.0695, dsb=217.4361, bio=0.0000
    Epoch  3/10: total=216.2989, vae=1.0695, dsb=215.2294, bio=0.0000
    Epoch  4/10: total=214.2625, vae=1.0704, dsb=213.1921, bio=0.0000
    Epoch  5/10: total=215.7636, vae=1.0691, dsb=214.6944, bio=0.0000
    Epoch  6/10: total=215.2471, vae=1.0690, dsb=214.1781, bio=0.0000
    Epoch  7/10: total=216.0994, vae=1.0690, dsb=215.0304, bio=0.0000
    Epoch  8/10: total=213.9846, vae=1.0692, dsb=212.9154, bio=0.0000
    Epoch  9/10: total=214.4203, vae=1.0687, dsb=213.3516, bio=0.0000
    Epoch 10/10: total=215.1297, vae=1.0690, dsb=214.0608, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=2.4746, vae=1.0691, dsb=1.4056, bio=0.0000
    Epoch  2/10: total=2.3823, vae=1.0697, dsb=1.3126, bio=0.0000
    Epoch  3/10: total=2.3228, vae=1.0692, dsb=1.2536, bio=0.0000
    Epoch  4/10: total=2.3089, vae=1.0696, dsb=1.2393, bio=0.0000
    Epoch  5/10: total=2.3134, vae=1.0700, dsb=1.2434, bio=0.0000
    Epoch  6/10: total=2.2795, vae=1.0687, dsb=1.2108, bio=0.0000
    Epoch  7/10: total=2.2708, vae=1.0685, dsb=1.2022, bio=0.0000
    Epoch  8/10: total=2.2749, vae=1.0686, dsb=1.2063, bio=0.0000
    Epoch  9/10: total=2.2600, vae=1.0691, dsb=1.1909, bio=0.0000
    Epoch 10/10: total=2.2478, vae=1.0691, dsb=1.1787, bio=0.0000

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=183.3531, vae=1.0687, dsb=182.2845, bio=0.0000
    Epoch  2/10: total=181.3090, vae=1.0696, dsb=180.2393, bio=0.0000
    Epoch  3/10: total=180.7462, vae=1.0699, dsb=179.6764, bio=0.0000
    Epoch  4/10: total=181.3182, vae=1.0687, dsb=180.2495, bio=0.0000
    Epoch  5/10: total=180.1074, vae=1.0695, dsb=179.0379, bio=0.0000
    Epoch  6/10: total=181.3752, vae=1.0686, dsb=180.3065, bio=0.0000
    Epoch  7/10: total=181.1851, vae=1.0686, dsb=180.1166, bio=0.0000
    Epoch  8/10: total=179.4144, vae=1.0689, dsb=178.3455, bio=0.0000
    Epoch  9/10: total=179.6949, vae=1.0691, dsb=178.6258, bio=0.0000
    Epoch 10/10: total=180.4672, vae=1.0687, dsb=179.3985, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=2.1565, vae=1.0693, dsb=1.0872, bio=0.0000
    Epoch  2/10: total=2.0778, vae=1.0697, dsb=1.0081, bio=0.0000
    Epoch  3/10: total=2.0545, vae=1.0686, dsb=0.9859, bio=0.0000
    Epoch  4/10: total=2.0191, vae=1.0691, dsb=0.9500, bio=0.0000
    Epoch  5/10: total=2.0072, vae=1.0692, dsb=0.9380, bio=0.0000
    Epoch  6/10: total=2.0535, vae=1.0690, dsb=0.9844, bio=0.0000
    Epoch  7/10: total=2.0498, vae=1.0693, dsb=0.9805, bio=0.0000
    Epoch  8/10: total=2.0195, vae=1.0693, dsb=0.9501, bio=0.0000
    Epoch  9/10: total=2.0488, vae=1.0687, dsb=0.9800, bio=0.0000
    Epoch 10/10: total=2.0566, vae=1.0693, dsb=0.9873, bio=0.0000

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=149.9527, vae=1.0690, dsb=148.8836, bio=0.0000
    Epoch  2/10: total=148.5385, vae=1.0693, dsb=147.4692, bio=0.0000
    Epoch  3/10: total=149.1081, vae=1.0684, dsb=148.0397, bio=0.0000
    Epoch  4/10: total=147.5079, vae=1.0694, dsb=146.4385, bio=0.0000
    Epoch  5/10: total=147.9672, vae=1.0686, dsb=146.8986, bio=0.0000
    Epoch  6/10: total=147.9718, vae=1.0696, dsb=146.9022, bio=0.0000
    Epoch  7/10: total=148.0167, vae=1.0694, dsb=146.9472, bio=0.0000
    Epoch  8/10: total=147.6730, vae=1.0685, dsb=146.6045, bio=0.0000
    Epoch  9/10: total=148.6233, vae=1.0694, dsb=147.5539, bio=0.0000
    Epoch 10/10: total=147.6470, vae=1.0696, dsb=146.5773, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.9506, vae=1.0683, dsb=0.8823, bio=0.0000
    Epoch  2/10: total=1.9309, vae=1.0684, dsb=0.8625, bio=0.0000
    Epoch  3/10: total=1.9074, vae=1.0684, dsb=0.8390, bio=0.0000
    Epoch  4/10: total=1.9261, vae=1.0696, dsb=0.8565, bio=0.0000
    Epoch  5/10: total=1.9162, vae=1.0688, dsb=0.8473, bio=0.0000
    Epoch  6/10: total=1.9282, vae=1.0689, dsb=0.8592, bio=0.0000
    Epoch  7/10: total=1.8969, vae=1.0693, dsb=0.8275, bio=0.0000
    Epoch  8/10: total=1.9061, vae=1.0693, dsb=0.8368, bio=0.0000
    Epoch  9/10: total=1.9172, vae=1.0688, dsb=0.8484, bio=0.0000
    Epoch 10/10: total=1.8888, vae=1.0693, dsb=0.8194, bio=0.0000

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=131.3717, vae=1.0688, dsb=130.3029, bio=0.0000
    Epoch  2/10: total=130.5505, vae=1.0687, dsb=129.4818, bio=0.0000
    Epoch  3/10: total=132.1367, vae=1.0686, dsb=131.0681, bio=0.0000
    Epoch  4/10: total=130.0283, vae=1.0690, dsb=128.9593, bio=0.0000
    Epoch  5/10: total=130.5831, vae=1.0693, dsb=129.5139, bio=0.0000
    Epoch  6/10: total=131.6374, vae=1.0684, dsb=130.5690, bio=0.0000
    Epoch  7/10: total=130.9999, vae=1.0689, dsb=129.9310, bio=0.0000
    Epoch  8/10: total=131.6238, vae=1.0694, dsb=130.5545, bio=0.0000
    Epoch  9/10: total=130.3454, vae=1.0692, dsb=129.2761, bio=0.0000
    Epoch 10/10: total=131.3313, vae=1.0688, dsb=130.2625, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.8127, vae=1.0702, dsb=0.7426, bio=0.0000
    Epoch  2/10: total=1.7884, vae=1.0690, dsb=0.7193, bio=0.0000
    Epoch  3/10: total=1.8174, vae=1.0695, dsb=0.7479, bio=0.0000
    Epoch  4/10: total=1.8319, vae=1.0692, dsb=0.7627, bio=0.0000
    Epoch  5/10: total=1.7792, vae=1.0697, dsb=0.7095, bio=0.0000
    Epoch  6/10: total=1.8112, vae=1.0682, dsb=0.7430, bio=0.0000
    Epoch  7/10: total=1.8171, vae=1.0687, dsb=0.7483, bio=0.0000
    Epoch  8/10: total=1.8081, vae=1.0680, dsb=0.7401, bio=0.0000
    Epoch  9/10: total=1.7743, vae=1.0683, dsb=0.7060, bio=0.0000
    Epoch 10/10: total=1.7959, vae=1.0689, dsb=0.7269, bio=0.0000

[Seed 80] Joint training (ablation) complete; models and history saved.

[Seed 80] Drift genes saved in /home/yyuan/ICB_TCE/iter_results/run_080

[Seed 80] run finished.

================================================================================
[Seed 81] Starting running whole pipeline...
================================================================================

[Seed 81] Starting VAE pre-training...

    Epoch [01/20], Beta: 0.000, Average Loss: 535.7239
    Epoch [02/20], Beta: 0.000, Average Loss: 307.2404
    Epoch [03/20], Beta: 0.000, Average Loss: 268.8170
    Epoch [04/20], Beta: 0.000, Average Loss: 250.2936
    Epoch [05/20], Beta: 0.100, Average Loss: 245.8147
    Epoch [06/20], Beta: 0.200, Average Loss: 244.9603
    Epoch [07/20], Beta: 0.300, Average Loss: 245.1441
    Epoch [08/20], Beta: 0.400, Average Loss: 245.9283
    Epoch [09/20], Beta: 0.500, Average Loss: 246.9041
    Epoch [10/20], Beta: 0.600, Average Loss: 248.1437
    Epoch [11/20], Beta: 0.700, Average Loss: 249.3469
    Epoch [12/20], Beta: 0.800, Average Loss: 250.6389
    Epoch [13/20], Beta: 0.900, Average Loss: 251.9197
    Epoch [14/20], Beta: 1.000, Average Loss: 253.4878
    Epoch [15/20], Beta: 1.000, Average Loss: 253.0770
    Epoch [16/20], Beta: 1.000, Average Loss: 252.6683
    Epoch [17/20], Beta: 1.000, Average Loss: 252.3167
    Epoch [18/20], Beta: 1.000, Average Loss: 251.9837
    Epoch [19/20], Beta: 1.000, Average Loss: 251.5963
    Epoch [20/20], Beta: 1.000, Average Loss: 251.4319

[Seed 81] VAE pre-training complete.

[Seed 81] Starting joint training (original)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=389.6981, vae=3.4525, dsb=373.9047, bio=24.6818
    Epoch  2/10: total=90.5513, vae=1.1074, dsb=89.4099, bio=0.0681
    Epoch  3/10: total=81.9213, vae=1.1010, dsb=80.8056, bio=0.0293
    Epoch  4/10: total=77.0804, vae=1.1001, dsb=75.9716, bio=0.0174
    Epoch  5/10: total=74.7537, vae=1.0997, dsb=73.6482, bio=0.0116
    Epoch  6/10: total=73.1592, vae=1.0987, dsb=72.0562, bio=0.0084
    Epoch  7/10: total=71.2538, vae=1.0979, dsb=70.1525, bio=0.0067
    Epoch  8/10: total=70.4311, vae=1.0974, dsb=69.3310, bio=0.0055
    Epoch  9/10: total=69.5109, vae=1.0964, dsb=68.4121, bio=0.0047
    Epoch 10/10: total=68.7532, vae=1.0961, dsb=67.6550, bio=0.0042

  [Backward Policy Training]
    Epoch  1/10: total=3.1660, vae=1.0982, dsb=2.0610, bio=0.0138
    Epoch  2/10: total=2.7370, vae=1.0961, dsb=1.6386, bio=0.0046
    Epoch  3/10: total=2.5777, vae=1.0960, dsb=1.4800, bio=0.0033
    Epoch  4/10: total=2.5161, vae=1.0956, dsb=1.4191, bio=0.0028
    Epoch  5/10: total=2.4956, vae=1.0951, dsb=1.3992, bio=0.0027
    Epoch  6/10: total=2.4537, vae=1.0950, dsb=1.3575, bio=0.0023
    Epoch  7/10: total=2.4456, vae=1.0949, dsb=1.3496, bio=0.0022
    Epoch  8/10: total=2.4371, vae=1.0935, dsb=1.3426, bio=0.0022
    Epoch  9/10: total=2.4178, vae=1.0951, dsb=1.3216, bio=0.0021
    Epoch 10/10: total=2.3571, vae=1.0947, dsb=1.2614, bio=0.0020

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=62.8650, vae=1.0968, dsb=61.7663, bio=0.0039
    Epoch  2/10: total=57.9125, vae=1.0964, dsb=56.8150, bio=0.0021
    Epoch  3/10: total=56.3615, vae=1.0969, dsb=55.2636, bio=0.0020
    Epoch  4/10: total=55.8436, vae=1.0953, dsb=54.7474, bio=0.0019
    Epoch  5/10: total=54.9817, vae=1.0947, dsb=53.8861, bio=0.0019
    Epoch  6/10: total=55.0709, vae=1.0957, dsb=53.9742, bio=0.0019
    Epoch  7/10: total=54.6498, vae=1.0954, dsb=53.5534, bio=0.0019
    Epoch  8/10: total=54.7115, vae=1.0954, dsb=53.6152, bio=0.0018
    Epoch  9/10: total=54.1790, vae=1.0945, dsb=53.0829, bio=0.0030
    Epoch 10/10: total=54.3828, vae=1.0948, dsb=53.2870, bio=0.0019

  [Backward Policy Training]
    Epoch  1/10: total=2.1502, vae=1.0960, dsb=1.0509, bio=0.0065
    Epoch  2/10: total=2.0359, vae=1.0936, dsb=0.9413, bio=0.0021
    Epoch  3/10: total=2.0296, vae=1.0931, dsb=0.9356, bio=0.0018
    Epoch  4/10: total=1.9722, vae=1.0939, dsb=0.8775, bio=0.0017
    Epoch  5/10: total=1.9865, vae=1.0938, dsb=0.8919, bio=0.0017
    Epoch  6/10: total=1.9528, vae=1.0930, dsb=0.8589, bio=0.0017
    Epoch  7/10: total=1.9382, vae=1.0932, dsb=0.8443, bio=0.0017
    Epoch  8/10: total=1.9595, vae=1.0947, dsb=0.8640, bio=0.0016
    Epoch  9/10: total=1.9123, vae=1.0927, dsb=0.8189, bio=0.0016
    Epoch 10/10: total=1.9348, vae=1.0933, dsb=0.8407, bio=0.0016

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=50.5241, vae=1.0951, dsb=49.4276, bio=0.0027
    Epoch  2/10: total=48.2948, vae=1.0954, dsb=47.1985, bio=0.0019
    Epoch  3/10: total=47.7256, vae=1.0943, dsb=46.6304, bio=0.0018
    Epoch  4/10: total=47.3406, vae=1.0941, dsb=46.2457, bio=0.0017
    Epoch  5/10: total=47.2390, vae=1.0937, dsb=46.1444, bio=0.0017
    Epoch  6/10: total=47.0638, vae=1.0939, dsb=45.9690, bio=0.0017
    Epoch  7/10: total=47.1262, vae=1.0936, dsb=46.0318, bio=0.0017
    Epoch  8/10: total=47.1886, vae=1.0944, dsb=46.0934, bio=0.0017
    Epoch  9/10: total=46.8524, vae=1.0946, dsb=45.7569, bio=0.0017
    Epoch 10/10: total=46.7493, vae=1.0942, dsb=45.6543, bio=0.0017

  [Backward Policy Training]
    Epoch  1/10: total=1.8522, vae=1.0940, dsb=0.7442, bio=0.0278
    Epoch  2/10: total=1.7906, vae=1.0932, dsb=0.6967, bio=0.0017
    Epoch  3/10: total=1.7929, vae=1.0937, dsb=0.6985, bio=0.0015
    Epoch  4/10: total=1.7504, vae=1.0929, dsb=0.6568, bio=0.0015
    Epoch  5/10: total=1.7634, vae=1.0923, dsb=0.6705, bio=0.0014
    Epoch  6/10: total=1.7615, vae=1.0934, dsb=0.6674, bio=0.0015
    Epoch  7/10: total=1.7513, vae=1.0934, dsb=0.6573, bio=0.0014
    Epoch  8/10: total=1.7585, vae=1.0927, dsb=0.6651, bio=0.0014
    Epoch  9/10: total=1.7541, vae=1.0917, dsb=0.6617, bio=0.0014
    Epoch 10/10: total=1.7422, vae=1.0926, dsb=0.6489, bio=0.0013

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=42.2321, vae=1.0947, dsb=41.1361, bio=0.0028
    Epoch  2/10: total=40.9941, vae=1.0948, dsb=39.8985, bio=0.0015
    Epoch  3/10: total=41.0722, vae=1.0946, dsb=39.9768, bio=0.0016
    Epoch  4/10: total=40.9545, vae=1.0933, dsb=39.8605, bio=0.0015
    Epoch  5/10: total=40.9361, vae=1.0923, dsb=39.8431, bio=0.0014
    Epoch  6/10: total=40.9914, vae=1.0934, dsb=39.8973, bio=0.0014
    Epoch  7/10: total=40.7434, vae=1.0924, dsb=39.6504, bio=0.0014
    Epoch  8/10: total=40.7089, vae=1.0926, dsb=39.6156, bio=0.0014
    Epoch  9/10: total=40.5600, vae=1.0938, dsb=39.4655, bio=0.0014
    Epoch 10/10: total=40.6597, vae=1.0928, dsb=39.5662, bio=0.0013

  [Backward Policy Training]
    Epoch  1/10: total=1.7301, vae=1.0943, dsb=0.5823, bio=0.1071
    Epoch  2/10: total=1.6491, vae=1.0934, dsb=0.5549, bio=0.0014
    Epoch  3/10: total=1.6685, vae=1.0922, dsb=0.5757, bio=0.0013
    Epoch  4/10: total=1.6556, vae=1.0920, dsb=0.5629, bio=0.0013
    Epoch  5/10: total=1.6299, vae=1.0919, dsb=0.5372, bio=0.0015
    Epoch  6/10: total=1.6330, vae=1.0918, dsb=0.5406, bio=0.0011
    Epoch  7/10: total=1.6199, vae=1.0922, dsb=0.5272, bio=0.0012
    Epoch  8/10: total=1.6283, vae=1.0923, dsb=0.5354, bio=0.0011
    Epoch  9/10: total=1.6201, vae=1.0927, dsb=0.5268, bio=0.0011
    Epoch 10/10: total=1.6173, vae=1.0932, dsb=0.5234, bio=0.0012

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=36.3214, vae=1.0957, dsb=35.2244, bio=0.0026
    Epoch  2/10: total=36.0591, vae=1.0946, dsb=34.9639, bio=0.0012
    Epoch  3/10: total=36.0011, vae=1.0937, dsb=34.9068, bio=0.0012
    Epoch  4/10: total=35.9005, vae=1.0926, dsb=34.8073, bio=0.0012
    Epoch  5/10: total=35.6445, vae=1.0933, dsb=34.5507, bio=0.0012
    Epoch  6/10: total=35.6309, vae=1.0928, dsb=34.5376, bio=0.0011
    Epoch  7/10: total=36.0334, vae=1.0931, dsb=34.9396, bio=0.0013
    Epoch  8/10: total=35.8887, vae=1.0937, dsb=34.7944, bio=0.0011
    Epoch  9/10: total=36.0479, vae=1.0931, dsb=34.9542, bio=0.0011
    Epoch 10/10: total=35.8425, vae=1.0927, dsb=34.7492, bio=0.0011

  [Backward Policy Training]
    Epoch  1/10: total=1.6520, vae=1.0941, dsb=0.4883, bio=0.1392
    Epoch  2/10: total=1.5686, vae=1.0929, dsb=0.4751, bio=0.0012
    Epoch  3/10: total=1.5728, vae=1.0929, dsb=0.4793, bio=0.0011
    Epoch  4/10: total=1.5803, vae=1.0922, dsb=0.4876, bio=0.0010
    Epoch  5/10: total=1.5761, vae=1.0926, dsb=0.4830, bio=0.0011
    Epoch  6/10: total=1.5608, vae=1.0930, dsb=0.4674, bio=0.0009
    Epoch  7/10: total=1.5805, vae=1.0928, dsb=0.4873, bio=0.0010
    Epoch  8/10: total=1.5771, vae=1.0931, dsb=0.4835, bio=0.0010
    Epoch  9/10: total=1.5698, vae=1.0922, dsb=0.4771, bio=0.0010
    Epoch 10/10: total=1.5759, vae=1.0928, dsb=0.4826, bio=0.0010

[Seed 81] Joint training (original) complete; models and history saved.

[Seed 81] Starting joint training (ablation)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=375.0785, vae=1.9737, dsb=373.1048, bio=0.0000
    Epoch  2/10: total=89.6641, vae=1.0896, dsb=88.5745, bio=0.0000
    Epoch  3/10: total=81.2247, vae=1.0864, dsb=80.1383, bio=0.0000
    Epoch  4/10: total=76.4351, vae=1.0864, dsb=75.3487, bio=0.0000
    Epoch  5/10: total=74.1818, vae=1.0865, dsb=73.0952, bio=0.0000
    Epoch  6/10: total=72.6309, vae=1.0860, dsb=71.5449, bio=0.0000
    Epoch  7/10: total=70.7623, vae=1.0855, dsb=69.6768, bio=0.0000
    Epoch  8/10: total=69.9953, vae=1.0853, dsb=68.9101, bio=0.0000
    Epoch  9/10: total=69.1156, vae=1.0846, dsb=68.0310, bio=0.0000
    Epoch 10/10: total=68.3904, vae=1.0845, dsb=67.3059, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=3.0670, vae=1.0854, dsb=1.9817, bio=0.0000
    Epoch  2/10: total=2.6632, vae=1.0851, dsb=1.5781, bio=0.0000
    Epoch  3/10: total=2.5116, vae=1.0855, dsb=1.4261, bio=0.0000
    Epoch  4/10: total=2.4521, vae=1.0854, dsb=1.3667, bio=0.0000
    Epoch  5/10: total=2.4308, vae=1.0850, dsb=1.3458, bio=0.0000
    Epoch  6/10: total=2.3915, vae=1.0851, dsb=1.3065, bio=0.0000
    Epoch  7/10: total=2.3838, vae=1.0852, dsb=1.2987, bio=0.0000
    Epoch  8/10: total=2.3759, vae=1.0838, dsb=1.2921, bio=0.0000
    Epoch  9/10: total=2.3576, vae=1.0856, dsb=1.2720, bio=0.0000
    Epoch 10/10: total=2.2979, vae=1.0853, dsb=1.2127, bio=0.0000

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=63.2074, vae=1.0846, dsb=62.1228, bio=0.0000
    Epoch  2/10: total=58.3183, vae=1.0855, dsb=57.2328, bio=0.0000
    Epoch  3/10: total=56.9115, vae=1.0862, dsb=55.8253, bio=0.0000
    Epoch  4/10: total=56.3983, vae=1.0847, dsb=55.3136, bio=0.0000
    Epoch  5/10: total=55.5318, vae=1.0842, dsb=54.4476, bio=0.0000
    Epoch  6/10: total=55.6164, vae=1.0854, dsb=54.5310, bio=0.0000
    Epoch  7/10: total=55.2130, vae=1.0851, dsb=54.1279, bio=0.0000
    Epoch  8/10: total=55.2930, vae=1.0852, dsb=54.2078, bio=0.0000
    Epoch  9/10: total=54.7255, vae=1.0845, dsb=53.6411, bio=0.0000
    Epoch 10/10: total=54.9171, vae=1.0849, dsb=53.8322, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=2.0766, vae=1.0851, dsb=0.9915, bio=0.0000
    Epoch  2/10: total=1.9733, vae=1.0845, dsb=0.8888, bio=0.0000
    Epoch  3/10: total=1.9693, vae=1.0842, dsb=0.8852, bio=0.0000
    Epoch  4/10: total=1.9151, vae=1.0851, dsb=0.8300, bio=0.0000
    Epoch  5/10: total=1.9294, vae=1.0850, dsb=0.8444, bio=0.0000
    Epoch  6/10: total=1.8967, vae=1.0844, dsb=0.8123, bio=0.0000
    Epoch  7/10: total=1.8827, vae=1.0846, dsb=0.7981, bio=0.0000
    Epoch  8/10: total=1.9041, vae=1.0861, dsb=0.8180, bio=0.0000
    Epoch  9/10: total=1.8587, vae=1.0841, dsb=0.7745, bio=0.0000
    Epoch 10/10: total=1.8795, vae=1.0848, dsb=0.7946, bio=0.0000

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=49.2485, vae=1.0839, dsb=48.1646, bio=0.0000
    Epoch  2/10: total=47.1524, vae=1.0856, dsb=46.0669, bio=0.0000
    Epoch  3/10: total=46.6264, vae=1.0848, dsb=45.5416, bio=0.0000
    Epoch  4/10: total=46.2805, vae=1.0847, dsb=45.1958, bio=0.0000
    Epoch  5/10: total=46.1822, vae=1.0844, dsb=45.0978, bio=0.0000
    Epoch  6/10: total=46.0100, vae=1.0846, dsb=44.9254, bio=0.0000
    Epoch  7/10: total=46.0833, vae=1.0845, dsb=44.9989, bio=0.0000
    Epoch  8/10: total=46.1507, vae=1.0853, dsb=45.0654, bio=0.0000
    Epoch  9/10: total=45.8605, vae=1.0857, dsb=44.7748, bio=0.0000
    Epoch 10/10: total=45.7010, vae=1.0854, dsb=44.6156, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.7667, vae=1.0845, dsb=0.6822, bio=0.0000
    Epoch  2/10: total=1.7260, vae=1.0848, dsb=0.6412, bio=0.0000
    Epoch  3/10: total=1.7286, vae=1.0854, dsb=0.6432, bio=0.0000
    Epoch  4/10: total=1.6883, vae=1.0846, dsb=0.6036, bio=0.0000
    Epoch  5/10: total=1.7010, vae=1.0842, dsb=0.6168, bio=0.0000
    Epoch  6/10: total=1.6996, vae=1.0853, dsb=0.6143, bio=0.0000
    Epoch  7/10: total=1.6903, vae=1.0853, dsb=0.6050, bio=0.0000
    Epoch  8/10: total=1.6969, vae=1.0847, dsb=0.6123, bio=0.0000
    Epoch  9/10: total=1.6929, vae=1.0837, dsb=0.6092, bio=0.0000
    Epoch 10/10: total=1.6818, vae=1.0846, dsb=0.5972, bio=0.0000

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=42.1398, vae=1.0837, dsb=41.0560, bio=0.0000
    Epoch  2/10: total=40.9954, vae=1.0854, dsb=39.9100, bio=0.0000
    Epoch  3/10: total=41.1069, vae=1.0856, dsb=40.0213, bio=0.0000
    Epoch  4/10: total=41.0058, vae=1.0846, dsb=39.9211, bio=0.0000
    Epoch  5/10: total=40.9888, vae=1.0836, dsb=39.9052, bio=0.0000
    Epoch  6/10: total=41.0415, vae=1.0848, dsb=39.9566, bio=0.0000
    Epoch  7/10: total=40.8009, vae=1.0839, dsb=39.7169, bio=0.0000
    Epoch  8/10: total=40.7559, vae=1.0843, dsb=39.6716, bio=0.0000
    Epoch  9/10: total=40.6111, vae=1.0855, dsb=39.5256, bio=0.0000
    Epoch 10/10: total=40.7031, vae=1.0847, dsb=39.6184, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.6026, vae=1.0850, dsb=0.5176, bio=0.0000
    Epoch  2/10: total=1.5796, vae=1.0853, dsb=0.4943, bio=0.0000
    Epoch  3/10: total=1.5986, vae=1.0843, dsb=0.5143, bio=0.0000
    Epoch  4/10: total=1.5879, vae=1.0841, dsb=0.5038, bio=0.0000
    Epoch  5/10: total=1.5647, vae=1.0841, dsb=0.4807, bio=0.0000
    Epoch  6/10: total=1.5684, vae=1.0841, dsb=0.4843, bio=0.0000
    Epoch  7/10: total=1.5567, vae=1.0844, dsb=0.4723, bio=0.0000
    Epoch  8/10: total=1.5647, vae=1.0846, dsb=0.4801, bio=0.0000
    Epoch  9/10: total=1.5573, vae=1.0850, dsb=0.4723, bio=0.0000
    Epoch 10/10: total=1.5552, vae=1.0855, dsb=0.4696, bio=0.0000

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=34.8441, vae=1.0853, dsb=33.7588, bio=0.0000
    Epoch  2/10: total=34.6441, vae=1.0856, dsb=33.5585, bio=0.0000
    Epoch  3/10: total=34.5766, vae=1.0850, dsb=33.4916, bio=0.0000
    Epoch  4/10: total=34.5224, vae=1.0843, dsb=33.4382, bio=0.0000
    Epoch  5/10: total=34.2492, vae=1.0851, dsb=33.1641, bio=0.0000
    Epoch  6/10: total=34.2470, vae=1.0846, dsb=33.1624, bio=0.0000
    Epoch  7/10: total=34.6402, vae=1.0850, dsb=33.5552, bio=0.0000
    Epoch  8/10: total=34.5105, vae=1.0857, dsb=33.4248, bio=0.0000
    Epoch  9/10: total=34.6939, vae=1.0851, dsb=33.6088, bio=0.0000
    Epoch 10/10: total=34.4703, vae=1.0848, dsb=33.3854, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.5136, vae=1.0852, dsb=0.4285, bio=0.0000
    Epoch  2/10: total=1.5028, vae=1.0851, dsb=0.4176, bio=0.0000
    Epoch  3/10: total=1.5074, vae=1.0852, dsb=0.4222, bio=0.0000
    Epoch  4/10: total=1.5148, vae=1.0846, dsb=0.4301, bio=0.0000
    Epoch  5/10: total=1.5110, vae=1.0849, dsb=0.4261, bio=0.0000
    Epoch  6/10: total=1.4976, vae=1.0854, dsb=0.4122, bio=0.0000
    Epoch  7/10: total=1.5157, vae=1.0853, dsb=0.4305, bio=0.0000
    Epoch  8/10: total=1.5128, vae=1.0856, dsb=0.4272, bio=0.0000
    Epoch  9/10: total=1.5061, vae=1.0847, dsb=0.4214, bio=0.0000
    Epoch 10/10: total=1.5119, vae=1.0853, dsb=0.4266, bio=0.0000

[Seed 81] Joint training (ablation) complete; models and history saved.

[Seed 81] Drift genes saved in /home/yyuan/ICB_TCE/iter_results/run_081

[Seed 81] run finished.

================================================================================
[Seed 82] Starting running whole pipeline...
================================================================================

[Seed 82] Starting VAE pre-training...

    Epoch [01/20], Beta: 0.000, Average Loss: 530.8463
    Epoch [02/20], Beta: 0.000, Average Loss: 304.3100
    Epoch [03/20], Beta: 0.000, Average Loss: 268.3029
    Epoch [04/20], Beta: 0.000, Average Loss: 248.8475
    Epoch [05/20], Beta: 0.100, Average Loss: 244.0397
    Epoch [06/20], Beta: 0.200, Average Loss: 243.6038
    Epoch [07/20], Beta: 0.300, Average Loss: 244.1733
    Epoch [08/20], Beta: 0.400, Average Loss: 245.1642
    Epoch [09/20], Beta: 0.500, Average Loss: 246.3056
    Epoch [10/20], Beta: 0.600, Average Loss: 247.5495
    Epoch [11/20], Beta: 0.700, Average Loss: 248.9071
    Epoch [12/20], Beta: 0.800, Average Loss: 250.2073
    Epoch [13/20], Beta: 0.900, Average Loss: 251.4795
    Epoch [14/20], Beta: 1.000, Average Loss: 253.1365
    Epoch [15/20], Beta: 1.000, Average Loss: 252.7028
    Epoch [16/20], Beta: 1.000, Average Loss: 252.3690
    Epoch [17/20], Beta: 1.000, Average Loss: 251.9982
    Epoch [18/20], Beta: 1.000, Average Loss: 251.6641
    Epoch [19/20], Beta: 1.000, Average Loss: 251.3502
    Epoch [20/20], Beta: 1.000, Average Loss: 251.1588

[Seed 82] VAE pre-training complete.

[Seed 82] Starting joint training (original)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=237.2641, vae=3.7308, dsb=212.5591, bio=41.9485
    Epoch  2/10: total=65.3495, vae=1.1043, dsb=64.1988, bio=0.0929
    Epoch  3/10: total=54.8827, vae=1.0996, dsb=53.7642, bio=0.0377
    Epoch  4/10: total=49.8502, vae=1.0975, dsb=48.7415, bio=0.0223
    Epoch  5/10: total=46.9597, vae=1.0972, dsb=45.8549, bio=0.0150
    Epoch  6/10: total=44.9006, vae=1.0970, dsb=43.7981, bio=0.0111
    Epoch  7/10: total=43.2719, vae=1.0959, dsb=42.1717, bio=0.0085
    Epoch  8/10: total=42.2198, vae=1.0956, dsb=41.1208, bio=0.0068
    Epoch  9/10: total=41.0302, vae=1.0953, dsb=39.9319, bio=0.0061
    Epoch 10/10: total=40.5052, vae=1.0945, dsb=39.4083, bio=0.0048

  [Backward Policy Training]
    Epoch  1/10: total=3.1342, vae=1.0957, dsb=2.0318, bio=0.0135
    Epoch  2/10: total=2.6010, vae=1.0931, dsb=1.5054, bio=0.0050
    Epoch  3/10: total=2.4622, vae=1.0939, dsb=1.3665, bio=0.0036
    Epoch  4/10: total=2.4405, vae=1.0936, dsb=1.3454, bio=0.0030
    Epoch  5/10: total=2.4003, vae=1.0927, dsb=1.3063, bio=0.0026
    Epoch  6/10: total=2.3601, vae=1.0927, dsb=1.2662, bio=0.0024
    Epoch  7/10: total=2.3485, vae=1.0926, dsb=1.2548, bio=0.0022
    Epoch  8/10: total=2.3151, vae=1.0921, dsb=1.2218, bio=0.0021
    Epoch  9/10: total=2.2873, vae=1.0926, dsb=1.1936, bio=0.0021
    Epoch 10/10: total=2.2861, vae=1.0925, dsb=1.1926, bio=0.0020

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=39.0140, vae=1.0956, dsb=37.9166, bio=0.0037
    Epoch  2/10: total=31.2152, vae=1.0933, dsb=30.1209, bio=0.0019
    Epoch  3/10: total=29.4876, vae=1.0935, dsb=28.3932, bio=0.0019
    Epoch  4/10: total=28.5784, vae=1.0930, dsb=27.4844, bio=0.0019
    Epoch  5/10: total=27.9707, vae=1.0931, dsb=26.8767, bio=0.0019
    Epoch  6/10: total=27.3748, vae=1.0931, dsb=26.2807, bio=0.0021
    Epoch  7/10: total=27.1274, vae=1.0930, dsb=26.0335, bio=0.0019
    Epoch  8/10: total=26.8656, vae=1.0931, dsb=25.7715, bio=0.0018
    Epoch  9/10: total=26.6583, vae=1.0926, dsb=25.5648, bio=0.0019
    Epoch 10/10: total=26.4617, vae=1.0923, dsb=25.3684, bio=0.0019

  [Backward Policy Training]
    Epoch  1/10: total=2.0254, vae=1.0928, dsb=0.9301, bio=0.0050
    Epoch  2/10: total=1.9078, vae=1.0917, dsb=0.8152, bio=0.0019
    Epoch  3/10: total=1.8846, vae=1.0915, dsb=0.7922, bio=0.0017
    Epoch  4/10: total=1.8480, vae=1.0916, dsb=0.7555, bio=0.0017
    Epoch  5/10: total=1.8297, vae=1.0912, dsb=0.7376, bio=0.0016
    Epoch  6/10: total=1.8202, vae=1.0917, dsb=0.7276, bio=0.0018
    Epoch  7/10: total=1.8121, vae=1.0916, dsb=0.7197, bio=0.0017
    Epoch  8/10: total=1.8021, vae=1.0915, dsb=0.7098, bio=0.0016
    Epoch  9/10: total=1.7920, vae=1.0910, dsb=0.7003, bio=0.0016
    Epoch 10/10: total=1.7973, vae=1.0912, dsb=0.7054, bio=0.0016

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=27.6988, vae=1.0938, dsb=26.6032, bio=0.0036
    Epoch  2/10: total=24.7963, vae=1.0928, dsb=23.7027, bio=0.0017
    Epoch  3/10: total=23.9578, vae=1.0928, dsb=22.8641, bio=0.0017
    Epoch  4/10: total=23.6280, vae=1.0925, dsb=22.5347, bio=0.0017
    Epoch  5/10: total=23.3465, vae=1.0927, dsb=22.2529, bio=0.0017
    Epoch  6/10: total=23.0907, vae=1.0924, dsb=21.9974, bio=0.0019
    Epoch  7/10: total=23.0564, vae=1.0919, dsb=21.9635, bio=0.0018
    Epoch  8/10: total=22.7927, vae=1.0932, dsb=21.6987, bio=0.0017
    Epoch  9/10: total=22.6302, vae=1.0916, dsb=21.5378, bio=0.0017
    Epoch 10/10: total=22.5656, vae=1.0926, dsb=21.4722, bio=0.0017

  [Backward Policy Training]
    Epoch  1/10: total=1.7189, vae=1.0929, dsb=0.6228, bio=0.0065
    Epoch  2/10: total=1.6570, vae=1.0913, dsb=0.5648, bio=0.0016
    Epoch  3/10: total=1.6240, vae=1.0912, dsb=0.5320, bio=0.0015
    Epoch  4/10: total=1.6117, vae=1.0910, dsb=0.5199, bio=0.0017
    Epoch  5/10: total=1.6055, vae=1.0920, dsb=0.5128, bio=0.0015
    Epoch  6/10: total=1.6037, vae=1.0908, dsb=0.5121, bio=0.0015
    Epoch  7/10: total=1.6003, vae=1.0911, dsb=0.5085, bio=0.0015
    Epoch  8/10: total=1.6066, vae=1.0906, dsb=0.5153, bio=0.0014
    Epoch  9/10: total=1.5876, vae=1.0903, dsb=0.4965, bio=0.0015
    Epoch 10/10: total=1.5778, vae=1.0911, dsb=0.4860, bio=0.0014

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=21.2791, vae=1.0940, dsb=20.1836, bio=0.0030
    Epoch  2/10: total=19.8976, vae=1.0920, dsb=18.8048, bio=0.0016
    Epoch  3/10: total=19.3394, vae=1.0916, dsb=18.2470, bio=0.0016
    Epoch  4/10: total=19.1115, vae=1.0917, dsb=18.0192, bio=0.0014
    Epoch  5/10: total=19.0148, vae=1.0917, dsb=17.9223, bio=0.0018
    Epoch  6/10: total=18.9332, vae=1.0907, dsb=17.8416, bio=0.0016
    Epoch  7/10: total=18.8671, vae=1.0911, dsb=17.7753, bio=0.0016
    Epoch  8/10: total=18.8115, vae=1.0907, dsb=17.7200, bio=0.0016
    Epoch  9/10: total=18.7656, vae=1.0918, dsb=17.6730, bio=0.0016
    Epoch 10/10: total=18.7247, vae=1.0907, dsb=17.6332, bio=0.0016

  [Backward Policy Training]
    Epoch  1/10: total=1.5446, vae=1.0927, dsb=0.4420, bio=0.0198
    Epoch  2/10: total=1.5016, vae=1.0901, dsb=0.4108, bio=0.0015
    Epoch  3/10: total=1.4877, vae=1.0904, dsb=0.3966, bio=0.0014
    Epoch  4/10: total=1.4702, vae=1.0904, dsb=0.3791, bio=0.0015
    Epoch  5/10: total=1.4852, vae=1.0899, dsb=0.3946, bio=0.0014
    Epoch  6/10: total=1.4737, vae=1.0912, dsb=0.3818, bio=0.0013
    Epoch  7/10: total=1.4781, vae=1.0907, dsb=0.3868, bio=0.0013
    Epoch  8/10: total=1.4706, vae=1.0906, dsb=0.3794, bio=0.0013
    Epoch  9/10: total=1.4669, vae=1.0898, dsb=0.3764, bio=0.0013
    Epoch 10/10: total=1.4758, vae=1.0907, dsb=0.3843, bio=0.0016

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=16.9150, vae=1.0938, dsb=15.8198, bio=0.0028
    Epoch  2/10: total=16.2826, vae=1.0919, dsb=15.1900, bio=0.0014
    Epoch  3/10: total=16.1252, vae=1.0919, dsb=15.0326, bio=0.0014
    Epoch  4/10: total=16.1786, vae=1.0904, dsb=15.0875, bio=0.0015
    Epoch  5/10: total=16.1522, vae=1.0910, dsb=15.0605, bio=0.0014
    Epoch  6/10: total=16.1609, vae=1.0917, dsb=15.0684, bio=0.0017
    Epoch  7/10: total=16.0373, vae=1.0915, dsb=14.9452, bio=0.0014
    Epoch  8/10: total=15.9946, vae=1.0912, dsb=14.9026, bio=0.0014
    Epoch  9/10: total=15.9968, vae=1.0908, dsb=14.9054, bio=0.0014
    Epoch 10/10: total=15.8961, vae=1.0897, dsb=14.8055, bio=0.0017

  [Backward Policy Training]
    Epoch  1/10: total=1.4620, vae=1.0912, dsb=0.3307, bio=0.0801
    Epoch  2/10: total=1.4080, vae=1.0901, dsb=0.3171, bio=0.0014
    Epoch  3/10: total=1.4031, vae=1.0903, dsb=0.3121, bio=0.0013
    Epoch  4/10: total=1.4017, vae=1.0903, dsb=0.3108, bio=0.0013
    Epoch  5/10: total=1.4082, vae=1.0900, dsb=0.3175, bio=0.0015
    Epoch  6/10: total=1.4018, vae=1.0897, dsb=0.3115, bio=0.0013
    Epoch  7/10: total=1.3949, vae=1.0909, dsb=0.3035, bio=0.0012
    Epoch  8/10: total=1.3980, vae=1.0893, dsb=0.3081, bio=0.0012
    Epoch  9/10: total=1.4044, vae=1.0904, dsb=0.3134, bio=0.0012
    Epoch 10/10: total=1.3921, vae=1.0900, dsb=0.3015, bio=0.0011

[Seed 82] Joint training (original) complete; models and history saved.

[Seed 82] Starting joint training (ablation)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=214.3676, vae=2.0468, dsb=212.3208, bio=0.0000
    Epoch  2/10: total=64.9390, vae=1.0867, dsb=63.8523, bio=0.0000
    Epoch  3/10: total=54.4536, vae=1.0851, dsb=53.3685, bio=0.0000
    Epoch  4/10: total=49.4769, vae=1.0839, dsb=48.3930, bio=0.0000
    Epoch  5/10: total=46.7062, vae=1.0841, dsb=45.6221, bio=0.0000
    Epoch  6/10: total=44.7068, vae=1.0843, dsb=43.6226, bio=0.0000
    Epoch  7/10: total=43.0993, vae=1.0835, dsb=42.0158, bio=0.0000
    Epoch  8/10: total=42.0806, vae=1.0835, dsb=40.9971, bio=0.0000
    Epoch  9/10: total=40.9359, vae=1.0834, dsb=39.8526, bio=0.0000
    Epoch 10/10: total=40.4296, vae=1.0830, dsb=39.3465, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=3.0828, vae=1.0829, dsb=1.9999, bio=0.0000
    Epoch  2/10: total=2.5694, vae=1.0823, dsb=1.4871, bio=0.0000
    Epoch  3/10: total=2.4324, vae=1.0835, dsb=1.3489, bio=0.0000
    Epoch  4/10: total=2.4111, vae=1.0835, dsb=1.3277, bio=0.0000
    Epoch  5/10: total=2.3694, vae=1.0828, dsb=1.2866, bio=0.0000
    Epoch  6/10: total=2.3307, vae=1.0829, dsb=1.2478, bio=0.0000
    Epoch  7/10: total=2.3186, vae=1.0829, dsb=1.2357, bio=0.0000
    Epoch  8/10: total=2.2836, vae=1.0826, dsb=1.2009, bio=0.0000
    Epoch  9/10: total=2.2552, vae=1.0831, dsb=1.1720, bio=0.0000
    Epoch 10/10: total=2.2532, vae=1.0832, dsb=1.1700, bio=0.0000

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=38.8625, vae=1.0837, dsb=37.7788, bio=0.0000
    Epoch  2/10: total=31.2554, vae=1.0825, dsb=30.1729, bio=0.0000
    Epoch  3/10: total=29.5160, vae=1.0829, dsb=28.4331, bio=0.0000
    Epoch  4/10: total=28.5805, vae=1.0825, dsb=27.4979, bio=0.0000
    Epoch  5/10: total=27.9701, vae=1.0828, dsb=26.8873, bio=0.0000
    Epoch  6/10: total=27.3498, vae=1.0828, dsb=26.2670, bio=0.0000
    Epoch  7/10: total=27.0962, vae=1.0829, dsb=26.0133, bio=0.0000
    Epoch  8/10: total=26.7902, vae=1.0831, dsb=25.7071, bio=0.0000
    Epoch  9/10: total=26.5932, vae=1.0826, dsb=25.5106, bio=0.0000
    Epoch 10/10: total=26.4042, vae=1.0824, dsb=25.3218, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=2.0156, vae=1.0826, dsb=0.9330, bio=0.0000
    Epoch  2/10: total=1.8990, vae=1.0827, dsb=0.8163, bio=0.0000
    Epoch  3/10: total=1.8750, vae=1.0827, dsb=0.7924, bio=0.0000
    Epoch  4/10: total=1.8384, vae=1.0829, dsb=0.7555, bio=0.0000
    Epoch  5/10: total=1.8202, vae=1.0825, dsb=0.7377, bio=0.0000
    Epoch  6/10: total=1.8101, vae=1.0831, dsb=0.7269, bio=0.0000
    Epoch  7/10: total=1.8025, vae=1.0831, dsb=0.7194, bio=0.0000
    Epoch  8/10: total=1.7921, vae=1.0830, dsb=0.7091, bio=0.0000
    Epoch  9/10: total=1.7815, vae=1.0825, dsb=0.6990, bio=0.0000
    Epoch 10/10: total=1.7871, vae=1.0827, dsb=0.7043, bio=0.0000

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=27.3669, vae=1.0826, dsb=26.2844, bio=0.0000
    Epoch  2/10: total=24.4300, vae=1.0828, dsb=23.3472, bio=0.0000
    Epoch  3/10: total=23.5559, vae=1.0830, dsb=22.4728, bio=0.0000
    Epoch  4/10: total=23.2378, vae=1.0829, dsb=22.1549, bio=0.0000
    Epoch  5/10: total=22.9527, vae=1.0832, dsb=21.8695, bio=0.0000
    Epoch  6/10: total=22.7076, vae=1.0829, dsb=21.6247, bio=0.0000
    Epoch  7/10: total=22.6775, vae=1.0826, dsb=21.5948, bio=0.0000
    Epoch  8/10: total=22.4092, vae=1.0838, dsb=21.3254, bio=0.0000
    Epoch  9/10: total=22.2450, vae=1.0823, dsb=21.1626, bio=0.0000
    Epoch 10/10: total=22.2132, vae=1.0834, dsb=21.1298, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.6812, vae=1.0834, dsb=0.5979, bio=0.0000
    Epoch  2/10: total=1.6260, vae=1.0829, dsb=0.5431, bio=0.0000
    Epoch  3/10: total=1.5948, vae=1.0829, dsb=0.5119, bio=0.0000
    Epoch  4/10: total=1.5840, vae=1.0829, dsb=0.5011, bio=0.0000
    Epoch  5/10: total=1.5784, vae=1.0838, dsb=0.4946, bio=0.0000
    Epoch  6/10: total=1.5775, vae=1.0827, dsb=0.4947, bio=0.0000
    Epoch  7/10: total=1.5748, vae=1.0831, dsb=0.4918, bio=0.0000
    Epoch  8/10: total=1.5816, vae=1.0826, dsb=0.4990, bio=0.0000
    Epoch  9/10: total=1.5636, vae=1.0823, dsb=0.4814, bio=0.0000
    Epoch 10/10: total=1.5549, vae=1.0830, dsb=0.4718, bio=0.0000

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=21.1990, vae=1.0832, dsb=20.1158, bio=0.0000
    Epoch  2/10: total=19.9984, vae=1.0825, dsb=18.9159, bio=0.0000
    Epoch  3/10: total=19.4957, vae=1.0823, dsb=18.4134, bio=0.0000
    Epoch  4/10: total=19.2766, vae=1.0825, dsb=18.1941, bio=0.0000
    Epoch  5/10: total=19.2001, vae=1.0827, dsb=18.1174, bio=0.0000
    Epoch  6/10: total=19.1296, vae=1.0820, dsb=18.0476, bio=0.0000
    Epoch  7/10: total=19.0749, vae=1.0824, dsb=17.9926, bio=0.0000
    Epoch  8/10: total=19.0265, vae=1.0820, dsb=17.9445, bio=0.0000
    Epoch  9/10: total=18.9666, vae=1.0832, dsb=17.8834, bio=0.0000
    Epoch 10/10: total=18.9501, vae=1.0822, dsb=17.8679, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.5151, vae=1.0837, dsb=0.4314, bio=0.0000
    Epoch  2/10: total=1.4824, vae=1.0821, dsb=0.4003, bio=0.0000
    Epoch  3/10: total=1.4690, vae=1.0826, dsb=0.3864, bio=0.0000
    Epoch  4/10: total=1.4517, vae=1.0825, dsb=0.3692, bio=0.0000
    Epoch  5/10: total=1.4667, vae=1.0822, dsb=0.3844, bio=0.0000
    Epoch  6/10: total=1.4552, vae=1.0835, dsb=0.3717, bio=0.0000
    Epoch  7/10: total=1.4596, vae=1.0831, dsb=0.3765, bio=0.0000
    Epoch  8/10: total=1.4523, vae=1.0830, dsb=0.3693, bio=0.0000
    Epoch  9/10: total=1.4486, vae=1.0823, dsb=0.3663, bio=0.0000
    Epoch 10/10: total=1.4567, vae=1.0831, dsb=0.3736, bio=0.0000

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=16.7184, vae=1.0831, dsb=15.6353, bio=0.0000
    Epoch  2/10: total=16.1438, vae=1.0827, dsb=15.0612, bio=0.0000
    Epoch  3/10: total=15.9984, vae=1.0829, dsb=14.9155, bio=0.0000
    Epoch  4/10: total=16.0537, vae=1.0816, dsb=14.9721, bio=0.0000
    Epoch  5/10: total=16.0419, vae=1.0824, dsb=14.9594, bio=0.0000
    Epoch  6/10: total=16.0544, vae=1.0833, dsb=14.9710, bio=0.0000
    Epoch  7/10: total=15.9392, vae=1.0832, dsb=14.8560, bio=0.0000
    Epoch  8/10: total=15.8873, vae=1.0830, dsb=14.8042, bio=0.0000
    Epoch  9/10: total=15.8856, vae=1.0826, dsb=14.8030, bio=0.0000
    Epoch 10/10: total=15.7977, vae=1.0816, dsb=14.7161, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.4029, vae=1.0822, dsb=0.3206, bio=0.0000
    Epoch  2/10: total=1.3907, vae=1.0825, dsb=0.3082, bio=0.0000
    Epoch  3/10: total=1.3864, vae=1.0828, dsb=0.3036, bio=0.0000
    Epoch  4/10: total=1.3857, vae=1.0829, dsb=0.3029, bio=0.0000
    Epoch  5/10: total=1.3923, vae=1.0826, dsb=0.3097, bio=0.0000
    Epoch  6/10: total=1.3865, vae=1.0826, dsb=0.3039, bio=0.0000
    Epoch  7/10: total=1.3799, vae=1.0838, dsb=0.2962, bio=0.0000
    Epoch  8/10: total=1.3831, vae=1.0823, dsb=0.3008, bio=0.0000
    Epoch  9/10: total=1.3896, vae=1.0834, dsb=0.3061, bio=0.0000
    Epoch 10/10: total=1.3777, vae=1.0830, dsb=0.2947, bio=0.0000

[Seed 82] Joint training (ablation) complete; models and history saved.

[Seed 82] Drift genes saved in /home/yyuan/ICB_TCE/iter_results/run_082

[Seed 82] run finished.

================================================================================
[Seed 83] Starting running whole pipeline...
================================================================================

[Seed 83] Starting VAE pre-training...

    Epoch [01/20], Beta: 0.000, Average Loss: 538.0328
    Epoch [02/20], Beta: 0.000, Average Loss: 314.1520
    Epoch [03/20], Beta: 0.000, Average Loss: 274.9079
    Epoch [04/20], Beta: 0.000, Average Loss: 252.5486
    Epoch [05/20], Beta: 0.100, Average Loss: 246.5376
    Epoch [06/20], Beta: 0.200, Average Loss: 245.2736
    Epoch [07/20], Beta: 0.300, Average Loss: 245.1624
    Epoch [08/20], Beta: 0.400, Average Loss: 245.6799
    Epoch [09/20], Beta: 0.500, Average Loss: 246.6221
    Epoch [10/20], Beta: 0.600, Average Loss: 247.7511
    Epoch [11/20], Beta: 0.700, Average Loss: 249.0110
    Epoch [12/20], Beta: 0.800, Average Loss: 250.2485
    Epoch [13/20], Beta: 0.900, Average Loss: 251.5285
    Epoch [14/20], Beta: 1.000, Average Loss: 252.7581
    Epoch [15/20], Beta: 1.000, Average Loss: 252.3198
    Epoch [16/20], Beta: 1.000, Average Loss: 252.0259
    Epoch [17/20], Beta: 1.000, Average Loss: 251.6900
    Epoch [18/20], Beta: 1.000, Average Loss: 251.4266
    Epoch [19/20], Beta: 1.000, Average Loss: 251.1343
    Epoch [20/20], Beta: 1.000, Average Loss: 250.8043

[Seed 83] VAE pre-training complete.

[Seed 83] Starting joint training (original)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=224.2976, vae=3.6833, dsb=207.5673, bio=26.0941
    Epoch  2/10: total=59.3551, vae=1.1064, dsb=58.2034, bio=0.0906
    Epoch  3/10: total=48.5029, vae=1.1009, dsb=47.3830, bio=0.0379
    Epoch  4/10: total=43.6337, vae=1.0979, dsb=42.5247, bio=0.0221
    Epoch  5/10: total=40.5933, vae=1.0969, dsb=39.4891, bio=0.0145
    Epoch  6/10: total=38.6470, vae=1.0962, dsb=37.5456, bio=0.0103
    Epoch  7/10: total=37.1606, vae=1.0966, dsb=36.0601, bio=0.0078
    Epoch  8/10: total=36.1499, vae=1.0964, dsb=35.0503, bio=0.0062
    Epoch  9/10: total=35.2060, vae=1.0953, dsb=34.1082, bio=0.0052
    Epoch 10/10: total=34.5176, vae=1.0966, dsb=33.4188, bio=0.0045

  [Backward Policy Training]
    Epoch  1/10: total=3.2525, vae=1.0972, dsb=2.1496, bio=0.0113
    Epoch  2/10: total=2.7045, vae=1.0947, dsb=1.6077, bio=0.0042
    Epoch  3/10: total=2.5669, vae=1.0949, dsb=1.4704, bio=0.0032
    Epoch  4/10: total=2.5024, vae=1.0949, dsb=1.4061, bio=0.0027
    Epoch  5/10: total=2.4322, vae=1.0937, dsb=1.3373, bio=0.0024
    Epoch  6/10: total=2.3595, vae=1.0938, dsb=1.2645, bio=0.0024
    Epoch  7/10: total=2.3464, vae=1.0935, dsb=1.2519, bio=0.0021
    Epoch  8/10: total=2.3585, vae=1.0932, dsb=1.2643, bio=0.0020
    Epoch  9/10: total=2.3383, vae=1.0942, dsb=1.2431, bio=0.0019
    Epoch 10/10: total=2.3030, vae=1.0931, dsb=1.2090, bio=0.0018

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=35.8936, vae=1.0957, dsb=34.7962, bio=0.0034
    Epoch  2/10: total=28.0292, vae=1.0944, dsb=26.9339, bio=0.0017
    Epoch  3/10: total=26.1440, vae=1.0946, dsb=25.0485, bio=0.0017
    Epoch  4/10: total=25.1815, vae=1.0950, dsb=24.0856, bio=0.0017
    Epoch  5/10: total=24.5224, vae=1.0942, dsb=23.4273, bio=0.0018
    Epoch  6/10: total=23.9584, vae=1.0944, dsb=22.8631, bio=0.0017
    Epoch  7/10: total=23.5371, vae=1.0932, dsb=22.4431, bio=0.0017
    Epoch  8/10: total=23.3503, vae=1.0933, dsb=22.2560, bio=0.0019
    Epoch  9/10: total=23.0245, vae=1.0934, dsb=21.9303, bio=0.0017
    Epoch 10/10: total=22.8846, vae=1.0932, dsb=21.7906, bio=0.0016

  [Backward Policy Training]
    Epoch  1/10: total=2.1270, vae=1.0935, dsb=1.0297, bio=0.0076
    Epoch  2/10: total=1.9705, vae=1.0927, dsb=0.8769, bio=0.0017
    Epoch  3/10: total=1.9178, vae=1.0928, dsb=0.8243, bio=0.0015
    Epoch  4/10: total=1.8922, vae=1.0924, dsb=0.7991, bio=0.0014
    Epoch  5/10: total=1.8875, vae=1.0927, dsb=0.7941, bio=0.0015
    Epoch  6/10: total=1.8568, vae=1.0917, dsb=0.7644, bio=0.0013
    Epoch  7/10: total=1.8763, vae=1.0917, dsb=0.7839, bio=0.0013
    Epoch  8/10: total=1.8414, vae=1.0915, dsb=0.7492, bio=0.0013
    Epoch  9/10: total=1.8291, vae=1.0924, dsb=0.7361, bio=0.0013
    Epoch 10/10: total=1.8284, vae=1.0915, dsb=0.7363, bio=0.0013

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=23.1860, vae=1.0944, dsb=22.0902, bio=0.0028
    Epoch  2/10: total=19.9922, vae=1.0929, dsb=18.8986, bio=0.0013
    Epoch  3/10: total=19.1531, vae=1.0930, dsb=18.0594, bio=0.0013
    Epoch  4/10: total=18.7327, vae=1.0930, dsb=17.6390, bio=0.0013
    Epoch  5/10: total=18.4786, vae=1.0927, dsb=17.3853, bio=0.0013
    Epoch  6/10: total=18.3004, vae=1.0920, dsb=17.2078, bio=0.0013
    Epoch  7/10: total=18.0196, vae=1.0926, dsb=16.9264, bio=0.0013
    Epoch  8/10: total=17.8954, vae=1.0918, dsb=16.8031, bio=0.0012
    Epoch  9/10: total=17.7711, vae=1.0922, dsb=16.6782, bio=0.0012
    Epoch 10/10: total=17.6675, vae=1.0914, dsb=16.5755, bio=0.0012

  [Backward Policy Training]
    Epoch  1/10: total=1.7633, vae=1.0931, dsb=0.6528, bio=0.0348
    Epoch  2/10: total=1.6760, vae=1.0914, dsb=0.5840, bio=0.0012
    Epoch  3/10: total=1.6341, vae=1.0918, dsb=0.5417, bio=0.0011
    Epoch  4/10: total=1.6515, vae=1.0913, dsb=0.5597, bio=0.0011
    Epoch  5/10: total=1.6230, vae=1.0908, dsb=0.5316, bio=0.0012
    Epoch  6/10: total=1.6103, vae=1.0909, dsb=0.5189, bio=0.0010
    Epoch  7/10: total=1.6038, vae=1.0916, dsb=0.5118, bio=0.0010
    Epoch  8/10: total=1.6054, vae=1.0916, dsb=0.5133, bio=0.0010
    Epoch  9/10: total=1.5994, vae=1.0916, dsb=0.5073, bio=0.0010
    Epoch 10/10: total=1.5908, vae=1.0913, dsb=0.4990, bio=0.0011

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=17.2909, vae=1.0943, dsb=16.1951, bio=0.0030
    Epoch  2/10: total=15.6572, vae=1.0919, dsb=14.5647, bio=0.0011
    Epoch  3/10: total=15.2614, vae=1.0917, dsb=14.1692, bio=0.0011
    Epoch  4/10: total=15.0322, vae=1.0916, dsb=13.9401, bio=0.0011
    Epoch  5/10: total=14.8560, vae=1.0919, dsb=13.7638, bio=0.0005
    Epoch  6/10: total=14.8523, vae=1.0915, dsb=13.7604, bio=0.0008
    Epoch  7/10: total=14.8244, vae=1.0905, dsb=13.7334, bio=0.0012
    Epoch  8/10: total=14.7273, vae=1.0914, dsb=13.6353, bio=0.0011
    Epoch  9/10: total=14.5645, vae=1.0921, dsb=13.4720, bio=0.0009
    Epoch 10/10: total=14.5838, vae=1.0918, dsb=13.4918, bio=0.0004

  [Backward Policy Training]
    Epoch  1/10: total=1.5671, vae=1.0927, dsb=0.4166, bio=0.1156
    Epoch  2/10: total=1.4696, vae=1.0913, dsb=0.3777, bio=0.0013
    Epoch  3/10: total=1.4700, vae=1.0913, dsb=0.3781, bio=0.0011
    Epoch  4/10: total=1.4594, vae=1.0921, dsb=0.3671, bio=0.0005
    Epoch  5/10: total=1.4609, vae=1.0908, dsb=0.3695, bio=0.0011
    Epoch  6/10: total=1.4572, vae=1.0911, dsb=0.3656, bio=0.0010
    Epoch  7/10: total=1.4516, vae=1.0903, dsb=0.3609, bio=0.0009
    Epoch  8/10: total=1.4531, vae=1.0912, dsb=0.3617, bio=0.0005
    Epoch  9/10: total=1.4516, vae=1.0911, dsb=0.3599, bio=0.0011
    Epoch 10/10: total=1.4437, vae=1.0918, dsb=0.3514, bio=0.0010

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=13.4711, vae=1.0932, dsb=12.3764, bio=0.0028
    Epoch  2/10: total=12.9046, vae=1.0918, dsb=11.8125, bio=0.0006
    Epoch  3/10: total=12.7462, vae=1.0924, dsb=11.6536, bio=0.0005
    Epoch  4/10: total=12.6842, vae=1.0911, dsb=11.5929, bio=0.0005
    Epoch  5/10: total=12.6138, vae=1.0915, dsb=11.5221, bio=0.0005
    Epoch  6/10: total=12.6007, vae=1.0914, dsb=11.5088, bio=0.0010
    Epoch  7/10: total=12.6065, vae=1.0907, dsb=11.5153, bio=0.0010
    Epoch  8/10: total=12.6106, vae=1.0910, dsb=11.5193, bio=0.0008
    Epoch  9/10: total=12.5996, vae=1.0902, dsb=11.5093, bio=0.0003
    Epoch 10/10: total=12.5628, vae=1.0904, dsb=11.4722, bio=0.0004

  [Backward Policy Training]
    Epoch  1/10: total=1.4858, vae=1.0924, dsb=0.3015, bio=0.1839
    Epoch  2/10: total=1.3865, vae=1.0911, dsb=0.2948, bio=0.0012
    Epoch  3/10: total=1.3796, vae=1.0909, dsb=0.2885, bio=0.0005
    Epoch  4/10: total=1.3880, vae=1.0913, dsb=0.2963, bio=0.0006
    Epoch  5/10: total=1.3771, vae=1.0900, dsb=0.2868, bio=0.0005
    Epoch  6/10: total=1.3804, vae=1.0904, dsb=0.2895, bio=0.0010
    Epoch  7/10: total=1.3751, vae=1.0897, dsb=0.2849, bio=0.0010
    Epoch  8/10: total=1.3814, vae=1.0903, dsb=0.2910, bio=0.0004
    Epoch  9/10: total=1.3765, vae=1.0904, dsb=0.2859, bio=0.0004
    Epoch 10/10: total=1.3683, vae=1.0901, dsb=0.2775, bio=0.0014

[Seed 83] Joint training (original) complete; models and history saved.

[Seed 83] Starting joint training (ablation)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=209.4000, vae=2.0567, dsb=207.3432, bio=0.0000
    Epoch  2/10: total=58.8617, vae=1.0881, dsb=57.7736, bio=0.0000
    Epoch  3/10: total=48.0499, vae=1.0864, dsb=46.9635, bio=0.0000
    Epoch  4/10: total=43.2298, vae=1.0846, dsb=42.1452, bio=0.0000
    Epoch  5/10: total=40.1753, vae=1.0840, dsb=39.0912, bio=0.0000
    Epoch  6/10: total=38.2712, vae=1.0837, dsb=37.1875, bio=0.0000
    Epoch  7/10: total=36.7957, vae=1.0844, dsb=35.7113, bio=0.0000
    Epoch  8/10: total=35.7741, vae=1.0844, dsb=34.6897, bio=0.0000
    Epoch  9/10: total=34.8472, vae=1.0836, dsb=33.7636, bio=0.0000
    Epoch 10/10: total=34.1940, vae=1.0851, dsb=33.1089, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=3.1905, vae=1.0850, dsb=2.1055, bio=0.0000
    Epoch  2/10: total=2.6659, vae=1.0841, dsb=1.5818, bio=0.0000
    Epoch  3/10: total=2.5286, vae=1.0846, dsb=1.4440, bio=0.0000
    Epoch  4/10: total=2.4651, vae=1.0849, dsb=1.3801, bio=0.0000
    Epoch  5/10: total=2.3952, vae=1.0839, dsb=1.3113, bio=0.0000
    Epoch  6/10: total=2.3219, vae=1.0840, dsb=1.2379, bio=0.0000
    Epoch  7/10: total=2.3099, vae=1.0839, dsb=1.2259, bio=0.0000
    Epoch  8/10: total=2.3221, vae=1.0838, dsb=1.2383, bio=0.0000
    Epoch  9/10: total=2.3032, vae=1.0849, dsb=1.2183, bio=0.0000
    Epoch 10/10: total=2.2693, vae=1.0839, dsb=1.1854, bio=0.0000

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=35.5084, vae=1.0838, dsb=34.4246, bio=0.0000
    Epoch  2/10: total=27.8741, vae=1.0837, dsb=26.7905, bio=0.0000
    Epoch  3/10: total=26.0052, vae=1.0842, dsb=24.9210, bio=0.0000
    Epoch  4/10: total=25.0546, vae=1.0847, dsb=23.9699, bio=0.0000
    Epoch  5/10: total=24.4063, vae=1.0841, dsb=23.3222, bio=0.0000
    Epoch  6/10: total=23.8503, vae=1.0844, dsb=22.7659, bio=0.0000
    Epoch  7/10: total=23.4331, vae=1.0833, dsb=22.3497, bio=0.0000
    Epoch  8/10: total=23.2662, vae=1.0835, dsb=22.1826, bio=0.0000
    Epoch  9/10: total=22.9195, vae=1.0837, dsb=21.8358, bio=0.0000
    Epoch 10/10: total=22.7826, vae=1.0837, dsb=21.6989, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=2.0662, vae=1.0836, dsb=0.9826, bio=0.0000
    Epoch  2/10: total=1.9212, vae=1.0839, dsb=0.8373, bio=0.0000
    Epoch  3/10: total=1.8715, vae=1.0842, dsb=0.7874, bio=0.0000
    Epoch  4/10: total=1.8481, vae=1.0838, dsb=0.7642, bio=0.0000
    Epoch  5/10: total=1.8448, vae=1.0842, dsb=0.7606, bio=0.0000
    Epoch  6/10: total=1.8163, vae=1.0834, dsb=0.7330, bio=0.0000
    Epoch  7/10: total=1.8361, vae=1.0834, dsb=0.7527, bio=0.0000
    Epoch  8/10: total=1.8041, vae=1.0833, dsb=0.7208, bio=0.0000
    Epoch  9/10: total=1.7922, vae=1.0841, dsb=0.7081, bio=0.0000
    Epoch 10/10: total=1.7935, vae=1.0833, dsb=0.7102, bio=0.0000

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=22.3162, vae=1.0835, dsb=21.2327, bio=0.0000
    Epoch  2/10: total=19.2523, vae=1.0834, dsb=18.1688, bio=0.0000
    Epoch  3/10: total=18.4266, vae=1.0838, dsb=17.3428, bio=0.0000
    Epoch  4/10: total=18.0329, vae=1.0839, dsb=16.9489, bio=0.0000
    Epoch  5/10: total=17.7967, vae=1.0837, dsb=16.7131, bio=0.0000
    Epoch  6/10: total=17.6265, vae=1.0832, dsb=16.5434, bio=0.0000
    Epoch  7/10: total=17.3708, vae=1.0838, dsb=16.2871, bio=0.0000
    Epoch  8/10: total=17.2402, vae=1.0830, dsb=16.1572, bio=0.0000
    Epoch  9/10: total=17.1453, vae=1.0837, dsb=16.0616, bio=0.0000
    Epoch 10/10: total=17.0230, vae=1.0829, dsb=15.9401, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.6939, vae=1.0839, dsb=0.6101, bio=0.0000
    Epoch  2/10: total=1.6321, vae=1.0833, dsb=0.5487, bio=0.0000
    Epoch  3/10: total=1.5939, vae=1.0839, dsb=0.5100, bio=0.0000
    Epoch  4/10: total=1.6108, vae=1.0834, dsb=0.5274, bio=0.0000
    Epoch  5/10: total=1.5836, vae=1.0828, dsb=0.5007, bio=0.0000
    Epoch  6/10: total=1.5729, vae=1.0832, dsb=0.4897, bio=0.0000
    Epoch  7/10: total=1.5671, vae=1.0838, dsb=0.4833, bio=0.0000
    Epoch  8/10: total=1.5697, vae=1.0839, dsb=0.4858, bio=0.0000
    Epoch  9/10: total=1.5643, vae=1.0840, dsb=0.4803, bio=0.0000
    Epoch 10/10: total=1.5565, vae=1.0836, dsb=0.4729, bio=0.0000

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=16.9388, vae=1.0841, dsb=15.8547, bio=0.0000
    Epoch  2/10: total=15.5015, vae=1.0830, dsb=14.4185, bio=0.0000
    Epoch  3/10: total=15.1636, vae=1.0831, dsb=14.0805, bio=0.0000
    Epoch  4/10: total=14.9573, vae=1.0832, dsb=13.8741, bio=0.0000
    Epoch  5/10: total=14.7949, vae=1.0836, dsb=13.7113, bio=0.0000
    Epoch  6/10: total=14.8222, vae=1.0834, dsb=13.7388, bio=0.0000
    Epoch  7/10: total=14.7884, vae=1.0825, dsb=13.7059, bio=0.0000
    Epoch  8/10: total=14.7096, vae=1.0835, dsb=13.6261, bio=0.0000
    Epoch  9/10: total=14.5484, vae=1.0841, dsb=13.4643, bio=0.0000
    Epoch 10/10: total=14.5844, vae=1.0839, dsb=13.5005, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.4814, vae=1.0835, dsb=0.3980, bio=0.0000
    Epoch  2/10: total=1.4437, vae=1.0834, dsb=0.3603, bio=0.0000
    Epoch  3/10: total=1.4447, vae=1.0837, dsb=0.3610, bio=0.0000
    Epoch  4/10: total=1.4345, vae=1.0845, dsb=0.3501, bio=0.0000
    Epoch  5/10: total=1.4362, vae=1.0835, dsb=0.3527, bio=0.0000
    Epoch  6/10: total=1.4329, vae=1.0838, dsb=0.3491, bio=0.0000
    Epoch  7/10: total=1.4272, vae=1.0830, dsb=0.3442, bio=0.0000
    Epoch  8/10: total=1.4291, vae=1.0840, dsb=0.3452, bio=0.0000
    Epoch  9/10: total=1.4271, vae=1.0841, dsb=0.3431, bio=0.0000
    Epoch 10/10: total=1.4193, vae=1.0848, dsb=0.3345, bio=0.0000

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=13.3224, vae=1.0833, dsb=12.2391, bio=0.0000
    Epoch  2/10: total=12.7861, vae=1.0833, dsb=11.7028, bio=0.0000
    Epoch  3/10: total=12.6477, vae=1.0843, dsb=11.5634, bio=0.0000
    Epoch  4/10: total=12.5815, vae=1.0832, dsb=11.4983, bio=0.0000
    Epoch  5/10: total=12.5176, vae=1.0837, dsb=11.4338, bio=0.0000
    Epoch  6/10: total=12.4985, vae=1.0838, dsb=11.4147, bio=0.0000
    Epoch  7/10: total=12.5116, vae=1.0832, dsb=11.4284, bio=0.0000
    Epoch  8/10: total=12.5022, vae=1.0835, dsb=11.4187, bio=0.0000
    Epoch  9/10: total=12.4946, vae=1.0827, dsb=11.4119, bio=0.0000
    Epoch 10/10: total=12.4675, vae=1.0830, dsb=11.3845, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.3613, vae=1.0835, dsb=0.2778, bio=0.0000
    Epoch  2/10: total=1.3555, vae=1.0838, dsb=0.2716, bio=0.0000
    Epoch  3/10: total=1.3493, vae=1.0837, dsb=0.2656, bio=0.0000
    Epoch  4/10: total=1.3573, vae=1.0844, dsb=0.2728, bio=0.0000
    Epoch  5/10: total=1.3469, vae=1.0832, dsb=0.2637, bio=0.0000
    Epoch  6/10: total=1.3501, vae=1.0837, dsb=0.2664, bio=0.0000
    Epoch  7/10: total=1.3450, vae=1.0832, dsb=0.2618, bio=0.0000
    Epoch  8/10: total=1.3513, vae=1.0837, dsb=0.2676, bio=0.0000
    Epoch  9/10: total=1.3468, vae=1.0839, dsb=0.2629, bio=0.0000
    Epoch 10/10: total=1.3386, vae=1.0837, dsb=0.2549, bio=0.0000

[Seed 83] Joint training (ablation) complete; models and history saved.

[Seed 83] Drift genes saved in /home/yyuan/ICB_TCE/iter_results/run_083

[Seed 83] run finished.

================================================================================
[Seed 84] Starting running whole pipeline...
================================================================================

[Seed 84] Starting VAE pre-training...

    Epoch [01/20], Beta: 0.000, Average Loss: 532.6909
    Epoch [02/20], Beta: 0.000, Average Loss: 309.0645
    Epoch [03/20], Beta: 0.000, Average Loss: 270.6216
    Epoch [04/20], Beta: 0.000, Average Loss: 249.9957
    Epoch [05/20], Beta: 0.100, Average Loss: 245.4774
    Epoch [06/20], Beta: 0.200, Average Loss: 244.9152
    Epoch [07/20], Beta: 0.300, Average Loss: 245.1696
    Epoch [08/20], Beta: 0.400, Average Loss: 245.9800
    Epoch [09/20], Beta: 0.500, Average Loss: 247.0984
    Epoch [10/20], Beta: 0.600, Average Loss: 248.2142
    Epoch [11/20], Beta: 0.700, Average Loss: 249.4761
    Epoch [12/20], Beta: 0.800, Average Loss: 250.6820
    Epoch [13/20], Beta: 0.900, Average Loss: 251.8877
    Epoch [14/20], Beta: 1.000, Average Loss: 253.4598
    Epoch [15/20], Beta: 1.000, Average Loss: 252.9965
    Epoch [16/20], Beta: 1.000, Average Loss: 252.5966
    Epoch [17/20], Beta: 1.000, Average Loss: 252.2211
    Epoch [18/20], Beta: 1.000, Average Loss: 251.9108
    Epoch [19/20], Beta: 1.000, Average Loss: 251.5171
    Epoch [20/20], Beta: 1.000, Average Loss: 251.3705

[Seed 84] VAE pre-training complete.

[Seed 84] Starting joint training (original)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=170.7373, vae=3.7572, dsb=152.0645, bio=29.8311
    Epoch  2/10: total=49.6716, vae=1.1090, dsb=48.5062, bio=0.1128
    Epoch  3/10: total=40.6382, vae=1.1028, dsb=39.5130, bio=0.0446
    Epoch  4/10: total=36.2228, vae=1.1000, dsb=35.1107, bio=0.0242
    Epoch  5/10: total=33.7391, vae=1.0988, dsb=32.6327, bio=0.0153
    Epoch  6/10: total=31.8835, vae=1.0985, dsb=30.7795, bio=0.0110
    Epoch  7/10: total=30.6913, vae=1.0975, dsb=29.5896, bio=0.0083
    Epoch  8/10: total=29.6038, vae=1.0971, dsb=28.5034, bio=0.0066
    Epoch  9/10: total=28.9012, vae=1.0968, dsb=27.8017, bio=0.0055
    Epoch 10/10: total=28.2209, vae=1.0969, dsb=27.1216, bio=0.0047

  [Backward Policy Training]
    Epoch  1/10: total=2.8855, vae=1.0974, dsb=1.7819, bio=0.0123
    Epoch  2/10: total=2.4344, vae=1.0963, dsb=1.3359, bio=0.0046
    Epoch  3/10: total=2.3080, vae=1.0965, dsb=1.2098, bio=0.0034
    Epoch  4/10: total=2.2398, vae=1.0953, dsb=1.1431, bio=0.0029
    Epoch  5/10: total=2.2255, vae=1.0951, dsb=1.1290, bio=0.0029
    Epoch  6/10: total=2.1884, vae=1.0958, dsb=1.0914, bio=0.0023
    Epoch  7/10: total=2.1724, vae=1.0951, dsb=1.0763, bio=0.0022
    Epoch  8/10: total=2.1737, vae=1.0953, dsb=1.0774, bio=0.0021
    Epoch  9/10: total=2.1408, vae=1.0948, dsb=1.0450, bio=0.0021
    Epoch 10/10: total=2.1460, vae=1.0948, dsb=1.0502, bio=0.0020

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=27.4550, vae=1.0975, dsb=26.3558, bio=0.0034
    Epoch  2/10: total=21.4999, vae=1.0962, dsb=20.4027, bio=0.0020
    Epoch  3/10: total=20.1183, vae=1.0952, dsb=19.0222, bio=0.0019
    Epoch  4/10: total=19.3168, vae=1.0963, dsb=18.2196, bio=0.0019
    Epoch  5/10: total=18.7233, vae=1.0956, dsb=17.6267, bio=0.0019
    Epoch  6/10: total=18.3734, vae=1.0948, dsb=17.2772, bio=0.0026
    Epoch  7/10: total=18.0961, vae=1.0956, dsb=16.9996, bio=0.0018
    Epoch  8/10: total=17.8588, vae=1.0954, dsb=16.7625, bio=0.0018
    Epoch  9/10: total=17.6996, vae=1.0946, dsb=16.6041, bio=0.0018
    Epoch 10/10: total=17.5409, vae=1.0953, dsb=16.4446, bio=0.0018

  [Backward Policy Training]
    Epoch  1/10: total=1.9532, vae=1.0955, dsb=0.8550, bio=0.0053
    Epoch  2/10: total=1.8229, vae=1.0941, dsb=0.7279, bio=0.0019
    Epoch  3/10: total=1.7925, vae=1.0940, dsb=0.6976, bio=0.0018
    Epoch  4/10: total=1.7587, vae=1.0933, dsb=0.6645, bio=0.0017
    Epoch  5/10: total=1.7388, vae=1.0936, dsb=0.6444, bio=0.0017
    Epoch  6/10: total=1.7234, vae=1.0935, dsb=0.6289, bio=0.0021
    Epoch  7/10: total=1.7190, vae=1.0937, dsb=0.6246, bio=0.0015
    Epoch  8/10: total=1.7030, vae=1.0934, dsb=0.6088, bio=0.0016
    Epoch  9/10: total=1.7094, vae=1.0931, dsb=0.6155, bio=0.0016
    Epoch 10/10: total=1.6996, vae=1.0935, dsb=0.6053, bio=0.0015

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=17.8153, vae=1.0964, dsb=16.7174, bio=0.0030
    Epoch  2/10: total=15.5793, vae=1.0947, dsb=14.4836, bio=0.0018
    Epoch  3/10: total=14.9419, vae=1.0946, dsb=13.8466, bio=0.0015
    Epoch  4/10: total=14.6490, vae=1.0941, dsb=13.5541, bio=0.0016
    Epoch  5/10: total=14.4031, vae=1.0950, dsb=13.3072, bio=0.0016
    Epoch  6/10: total=14.2721, vae=1.0945, dsb=13.1768, bio=0.0016
    Epoch  7/10: total=14.1414, vae=1.0947, dsb=13.0459, bio=0.0016
    Epoch  8/10: total=14.0684, vae=1.0944, dsb=12.9730, bio=0.0020
    Epoch  9/10: total=13.9311, vae=1.0940, dsb=12.8362, bio=0.0017
    Epoch 10/10: total=13.8858, vae=1.0946, dsb=12.7904, bio=0.0015

  [Backward Policy Training]
    Epoch  1/10: total=1.6155, vae=1.0943, dsb=0.5176, bio=0.0072
    Epoch  2/10: total=1.5720, vae=1.0935, dsb=0.4777, bio=0.0015
    Epoch  3/10: total=1.5416, vae=1.0939, dsb=0.4470, bio=0.0015
    Epoch  4/10: total=1.5219, vae=1.0926, dsb=0.4285, bio=0.0015
    Epoch  5/10: total=1.5280, vae=1.0928, dsb=0.4345, bio=0.0014
    Epoch  6/10: total=1.5231, vae=1.0932, dsb=0.4292, bio=0.0014
    Epoch  7/10: total=1.5171, vae=1.0931, dsb=0.4233, bio=0.0014
    Epoch  8/10: total=1.5165, vae=1.0926, dsb=0.4231, bio=0.0015
    Epoch  9/10: total=1.4985, vae=1.0929, dsb=0.4050, bio=0.0013
    Epoch 10/10: total=1.5085, vae=1.0931, dsb=0.4148, bio=0.0013

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=13.9866, vae=1.0955, dsb=12.8897, bio=0.0027
    Epoch  2/10: total=12.8122, vae=1.0940, dsb=11.7173, bio=0.0016
    Epoch  3/10: total=12.5435, vae=1.0939, dsb=11.4489, bio=0.0014
    Epoch  4/10: total=12.3699, vae=1.0934, dsb=11.2758, bio=0.0014
    Epoch  5/10: total=12.2522, vae=1.0939, dsb=11.1575, bio=0.0014
    Epoch  6/10: total=12.2117, vae=1.0938, dsb=11.1172, bio=0.0014
    Epoch  7/10: total=12.1584, vae=1.0945, dsb=11.0632, bio=0.0014
    Epoch  8/10: total=12.0847, vae=1.0953, dsb=10.9886, bio=0.0017
    Epoch  9/10: total=12.0922, vae=1.0934, dsb=10.9981, bio=0.0013
    Epoch 10/10: total=12.0601, vae=1.0936, dsb=10.9658, bio=0.0013

  [Backward Policy Training]
    Epoch  1/10: total=1.4626, vae=1.0941, dsb=0.3605, bio=0.0161
    Epoch  2/10: total=1.4208, vae=1.0929, dsb=0.3272, bio=0.0013
    Epoch  3/10: total=1.4123, vae=1.0926, dsb=0.3191, bio=0.0012
    Epoch  4/10: total=1.4129, vae=1.0935, dsb=0.3188, bio=0.0013
    Epoch  5/10: total=1.4058, vae=1.0935, dsb=0.3117, bio=0.0012
    Epoch  6/10: total=1.4025, vae=1.0916, dsb=0.3103, bio=0.0011
    Epoch  7/10: total=1.4022, vae=1.0930, dsb=0.3086, bio=0.0011
    Epoch  8/10: total=1.3981, vae=1.0926, dsb=0.3050, bio=0.0011
    Epoch  9/10: total=1.3915, vae=1.0929, dsb=0.2981, bio=0.0012
    Epoch 10/10: total=1.3857, vae=1.0922, dsb=0.2930, bio=0.0011

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=11.1162, vae=1.0960, dsb=10.0188, bio=0.0030
    Epoch  2/10: total=10.7012, vae=1.0940, dsb=9.6067, bio=0.0012
    Epoch  3/10: total=10.6039, vae=1.0941, dsb=9.5092, bio=0.0012
    Epoch  4/10: total=10.5698, vae=1.0926, dsb=9.4766, bio=0.0013
    Epoch  5/10: total=10.5399, vae=1.0939, dsb=9.4455, bio=0.0012
    Epoch  6/10: total=10.5166, vae=1.0932, dsb=9.4227, bio=0.0014
    Epoch  7/10: total=10.4963, vae=1.0934, dsb=9.4023, bio=0.0012
    Epoch  8/10: total=10.5102, vae=1.0933, dsb=9.4163, bio=0.0012
    Epoch  9/10: total=10.4884, vae=1.0926, dsb=9.3952, bio=0.0012
    Epoch 10/10: total=10.4838, vae=1.0927, dsb=9.3905, bio=0.0012

  [Backward Policy Training]
    Epoch  1/10: total=1.3721, vae=1.0939, dsb=0.2526, bio=0.0511
    Epoch  2/10: total=1.3492, vae=1.0935, dsb=0.2551, bio=0.0012
    Epoch  3/10: total=1.3437, vae=1.0927, dsb=0.2504, bio=0.0011
    Epoch  4/10: total=1.3307, vae=1.0917, dsb=0.2384, bio=0.0011
    Epoch  5/10: total=1.3367, vae=1.0925, dsb=0.2437, bio=0.0011
    Epoch  6/10: total=1.3347, vae=1.0932, dsb=0.2411, bio=0.0010
    Epoch  7/10: total=1.3286, vae=1.0926, dsb=0.2355, bio=0.0010
    Epoch  8/10: total=1.3283, vae=1.0920, dsb=0.2358, bio=0.0010
    Epoch  9/10: total=1.3355, vae=1.0921, dsb=0.2429, bio=0.0010
    Epoch 10/10: total=1.3298, vae=1.0918, dsb=0.2376, bio=0.0010

[Seed 84] Joint training (original) complete; models and history saved.

[Seed 84] Starting joint training (ablation)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=153.8758, vae=2.0576, dsb=151.8182, bio=0.0000
    Epoch  2/10: total=49.4015, vae=1.0890, dsb=48.3125, bio=0.0000
    Epoch  3/10: total=40.3912, vae=1.0875, dsb=39.3038, bio=0.0000
    Epoch  4/10: total=35.9778, vae=1.0863, dsb=34.8915, bio=0.0000
    Epoch  5/10: total=33.4945, vae=1.0857, dsb=32.4088, bio=0.0000
    Epoch  6/10: total=31.6217, vae=1.0858, dsb=30.5359, bio=0.0000
    Epoch  7/10: total=30.4493, vae=1.0851, dsb=29.3641, bio=0.0000
    Epoch  8/10: total=29.3933, vae=1.0850, dsb=28.3083, bio=0.0000
    Epoch  9/10: total=28.7007, vae=1.0849, dsb=27.6157, bio=0.0000
    Epoch 10/10: total=28.0067, vae=1.0854, dsb=26.9213, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=2.8326, vae=1.0852, dsb=1.7473, bio=0.0000
    Epoch  2/10: total=2.3978, vae=1.0855, dsb=1.3123, bio=0.0000
    Epoch  3/10: total=2.2765, vae=1.0861, dsb=1.1904, bio=0.0000
    Epoch  4/10: total=2.2098, vae=1.0853, dsb=1.1245, bio=0.0000
    Epoch  5/10: total=2.1957, vae=1.0850, dsb=1.1106, bio=0.0000
    Epoch  6/10: total=2.1579, vae=1.0861, dsb=1.0718, bio=0.0000
    Epoch  7/10: total=2.1421, vae=1.0854, dsb=1.0567, bio=0.0000
    Epoch  8/10: total=2.1431, vae=1.0858, dsb=1.0574, bio=0.0000
    Epoch  9/10: total=2.1106, vae=1.0854, dsb=1.0252, bio=0.0000
    Epoch 10/10: total=2.1169, vae=1.0854, dsb=1.0315, bio=0.0000

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=26.5935, vae=1.0854, dsb=25.5081, bio=0.0000
    Epoch  2/10: total=20.9866, vae=1.0853, dsb=19.9013, bio=0.0000
    Epoch  3/10: total=19.6478, vae=1.0846, dsb=18.5632, bio=0.0000
    Epoch  4/10: total=18.8815, vae=1.0858, dsb=17.7957, bio=0.0000
    Epoch  5/10: total=18.2893, vae=1.0853, dsb=17.2041, bio=0.0000
    Epoch  6/10: total=17.9587, vae=1.0844, dsb=16.8743, bio=0.0000
    Epoch  7/10: total=17.6798, vae=1.0854, dsb=16.5944, bio=0.0000
    Epoch  8/10: total=17.4691, vae=1.0854, dsb=16.3838, bio=0.0000
    Epoch  9/10: total=17.3002, vae=1.0846, dsb=16.2156, bio=0.0000
    Epoch 10/10: total=17.1508, vae=1.0854, dsb=16.0654, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.9065, vae=1.0853, dsb=0.8212, bio=0.0000
    Epoch  2/10: total=1.7819, vae=1.0851, dsb=0.6968, bio=0.0000
    Epoch  3/10: total=1.7505, vae=1.0852, dsb=0.6654, bio=0.0000
    Epoch  4/10: total=1.7183, vae=1.0846, dsb=0.6337, bio=0.0000
    Epoch  5/10: total=1.6989, vae=1.0849, dsb=0.6140, bio=0.0000
    Epoch  6/10: total=1.6833, vae=1.0847, dsb=0.5986, bio=0.0000
    Epoch  7/10: total=1.6792, vae=1.0852, dsb=0.5940, bio=0.0000
    Epoch  8/10: total=1.6643, vae=1.0849, dsb=0.5794, bio=0.0000
    Epoch  9/10: total=1.6703, vae=1.0847, dsb=0.5857, bio=0.0000
    Epoch 10/10: total=1.6612, vae=1.0851, dsb=0.5761, bio=0.0000

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=16.9882, vae=1.0852, dsb=15.9030, bio=0.0000
    Epoch  2/10: total=14.7663, vae=1.0849, dsb=13.6815, bio=0.0000
    Epoch  3/10: total=14.1225, vae=1.0850, dsb=13.0376, bio=0.0000
    Epoch  4/10: total=13.8421, vae=1.0846, dsb=12.7575, bio=0.0000
    Epoch  5/10: total=13.6065, vae=1.0857, dsb=12.5208, bio=0.0000
    Epoch  6/10: total=13.4742, vae=1.0852, dsb=12.3891, bio=0.0000
    Epoch  7/10: total=13.3722, vae=1.0854, dsb=12.2868, bio=0.0000
    Epoch  8/10: total=13.2946, vae=1.0852, dsb=12.2094, bio=0.0000
    Epoch  9/10: total=13.1756, vae=1.0848, dsb=12.0908, bio=0.0000
    Epoch 10/10: total=13.1448, vae=1.0855, dsb=12.0593, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.5630, vae=1.0848, dsb=0.4783, bio=0.0000
    Epoch  2/10: total=1.5255, vae=1.0853, dsb=0.4403, bio=0.0000
    Epoch  3/10: total=1.4978, vae=1.0857, dsb=0.4121, bio=0.0000
    Epoch  4/10: total=1.4798, vae=1.0846, dsb=0.3953, bio=0.0000
    Epoch  5/10: total=1.4858, vae=1.0847, dsb=0.4010, bio=0.0000
    Epoch  6/10: total=1.4813, vae=1.0852, dsb=0.3961, bio=0.0000
    Epoch  7/10: total=1.4757, vae=1.0852, dsb=0.3905, bio=0.0000
    Epoch  8/10: total=1.4748, vae=1.0847, dsb=0.3902, bio=0.0000
    Epoch  9/10: total=1.4586, vae=1.0850, dsb=0.3736, bio=0.0000
    Epoch 10/10: total=1.4674, vae=1.0852, dsb=0.3822, bio=0.0000

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=13.1232, vae=1.0848, dsb=12.0385, bio=0.0000
    Epoch  2/10: total=12.0636, vae=1.0848, dsb=10.9788, bio=0.0000
    Epoch  3/10: total=11.8488, vae=1.0850, dsb=10.7638, bio=0.0000
    Epoch  4/10: total=11.7049, vae=1.0846, dsb=10.6202, bio=0.0000
    Epoch  5/10: total=11.6083, vae=1.0851, dsb=10.5232, bio=0.0000
    Epoch  6/10: total=11.5872, vae=1.0851, dsb=10.5020, bio=0.0000
    Epoch  7/10: total=11.5328, vae=1.0858, dsb=10.4470, bio=0.0000
    Epoch  8/10: total=11.4754, vae=1.0865, dsb=10.3888, bio=0.0000
    Epoch  9/10: total=11.4916, vae=1.0849, dsb=10.4067, bio=0.0000
    Epoch 10/10: total=11.4694, vae=1.0851, dsb=10.3843, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.4040, vae=1.0852, dsb=0.3188, bio=0.0000
    Epoch  2/10: total=1.3759, vae=1.0851, dsb=0.2909, bio=0.0000
    Epoch  3/10: total=1.3693, vae=1.0849, dsb=0.2844, bio=0.0000
    Epoch  4/10: total=1.3704, vae=1.0857, dsb=0.2846, bio=0.0000
    Epoch  5/10: total=1.3642, vae=1.0859, dsb=0.2782, bio=0.0000
    Epoch  6/10: total=1.3612, vae=1.0840, dsb=0.2772, bio=0.0000
    Epoch  7/10: total=1.3613, vae=1.0855, dsb=0.2758, bio=0.0000
    Epoch  8/10: total=1.3578, vae=1.0851, dsb=0.2727, bio=0.0000
    Epoch  9/10: total=1.3519, vae=1.0853, dsb=0.2666, bio=0.0000
    Epoch 10/10: total=1.3467, vae=1.0847, dsb=0.2620, bio=0.0000

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=10.2686, vae=1.0854, dsb=9.1832, bio=0.0000
    Epoch  2/10: total=9.9456, vae=1.0850, dsb=8.8607, bio=0.0000
    Epoch  3/10: total=9.8806, vae=1.0854, dsb=8.7952, bio=0.0000
    Epoch  4/10: total=9.8504, vae=1.0841, dsb=8.7664, bio=0.0000
    Epoch  5/10: total=9.8296, vae=1.0855, dsb=8.7440, bio=0.0000
    Epoch  6/10: total=9.8049, vae=1.0850, dsb=8.7199, bio=0.0000
    Epoch  7/10: total=9.7941, vae=1.0852, dsb=8.7089, bio=0.0000
    Epoch  8/10: total=9.8137, vae=1.0852, dsb=8.7285, bio=0.0000
    Epoch  9/10: total=9.7951, vae=1.0845, dsb=8.7106, bio=0.0000
    Epoch 10/10: total=9.7952, vae=1.0848, dsb=8.7104, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.3084, vae=1.0853, dsb=0.2231, bio=0.0000
    Epoch  2/10: total=1.3136, vae=1.0859, dsb=0.2277, bio=0.0000
    Epoch  3/10: total=1.3093, vae=1.0853, dsb=0.2240, bio=0.0000
    Epoch  4/10: total=1.2979, vae=1.0845, dsb=0.2134, bio=0.0000
    Epoch  5/10: total=1.3038, vae=1.0852, dsb=0.2186, bio=0.0000
    Epoch  6/10: total=1.3025, vae=1.0859, dsb=0.2165, bio=0.0000
    Epoch  7/10: total=1.2969, vae=1.0854, dsb=0.2115, bio=0.0000
    Epoch  8/10: total=1.2969, vae=1.0848, dsb=0.2121, bio=0.0000
    Epoch  9/10: total=1.3038, vae=1.0851, dsb=0.2187, bio=0.0000
    Epoch 10/10: total=1.2989, vae=1.0849, dsb=0.2141, bio=0.0000

[Seed 84] Joint training (ablation) complete; models and history saved.

[Seed 84] Drift genes saved in /home/yyuan/ICB_TCE/iter_results/run_084

[Seed 84] run finished.

================================================================================
[Seed 85] Starting running whole pipeline...
================================================================================

[Seed 85] Starting VAE pre-training...

    Epoch [01/20], Beta: 0.000, Average Loss: 533.2124
    Epoch [02/20], Beta: 0.000, Average Loss: 307.4562
    Epoch [03/20], Beta: 0.000, Average Loss: 272.2908
    Epoch [04/20], Beta: 0.000, Average Loss: 251.9009
    Epoch [05/20], Beta: 0.100, Average Loss: 246.3736
    Epoch [06/20], Beta: 0.200, Average Loss: 245.2945
    Epoch [07/20], Beta: 0.300, Average Loss: 245.4625
    Epoch [08/20], Beta: 0.400, Average Loss: 246.0580
    Epoch [09/20], Beta: 0.500, Average Loss: 246.9520
    Epoch [10/20], Beta: 0.600, Average Loss: 247.9788
    Epoch [11/20], Beta: 0.700, Average Loss: 249.2374
    Epoch [12/20], Beta: 0.800, Average Loss: 250.4956
    Epoch [13/20], Beta: 0.900, Average Loss: 251.7081
    Epoch [14/20], Beta: 1.000, Average Loss: 253.3582
    Epoch [15/20], Beta: 1.000, Average Loss: 252.9439
    Epoch [16/20], Beta: 1.000, Average Loss: 252.5659
    Epoch [17/20], Beta: 1.000, Average Loss: 252.2372
    Epoch [18/20], Beta: 1.000, Average Loss: 251.8994
    Epoch [19/20], Beta: 1.000, Average Loss: 251.5536
    Epoch [20/20], Beta: 1.000, Average Loss: 251.3323

[Seed 85] VAE pre-training complete.

[Seed 85] Starting joint training (original)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=421.6249, vae=3.5730, dsb=400.5585, bio=34.9867
    Epoch  2/10: total=114.3755, vae=1.1101, dsb=113.2359, bio=0.0591
    Epoch  3/10: total=100.8282, vae=1.1064, dsb=99.7085, bio=0.0266
    Epoch  4/10: total=94.6986, vae=1.1035, dsb=93.5875, bio=0.0152
    Epoch  5/10: total=90.8827, vae=1.1025, dsb=89.7749, bio=0.0105
    Epoch  6/10: total=88.2528, vae=1.1017, dsb=87.1474, bio=0.0075
    Epoch  7/10: total=86.2187, vae=1.1021, dsb=85.1136, bio=0.0059
    Epoch  8/10: total=84.7925, vae=1.1024, dsb=83.6876, bio=0.0050
    Epoch  9/10: total=83.3822, vae=1.1007, dsb=82.2794, bio=0.0043
    Epoch 10/10: total=82.1520, vae=1.1018, dsb=81.0483, bio=0.0039

  [Backward Policy Training]
    Epoch  1/10: total=3.5065, vae=1.1024, dsb=2.3983, bio=0.0116
    Epoch  2/10: total=2.9911, vae=1.1001, dsb=1.8890, bio=0.0042
    Epoch  3/10: total=2.8417, vae=1.0997, dsb=1.7404, bio=0.0032
    Epoch  4/10: total=2.7659, vae=1.0992, dsb=1.6654, bio=0.0028
    Epoch  5/10: total=2.7047, vae=1.0998, dsb=1.6036, bio=0.0025
    Epoch  6/10: total=2.6615, vae=1.0987, dsb=1.5616, bio=0.0024
    Epoch  7/10: total=2.6220, vae=1.0980, dsb=1.5229, bio=0.0023
    Epoch  8/10: total=2.6319, vae=1.0991, dsb=1.5317, bio=0.0022
    Epoch  9/10: total=2.6089, vae=1.0988, dsb=1.5089, bio=0.0022
    Epoch 10/10: total=2.5703, vae=1.0989, dsb=1.4702, bio=0.0025

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=73.9656, vae=1.1017, dsb=72.8621, bio=0.0036
    Epoch  2/10: total=66.7056, vae=1.1000, dsb=65.6045, bio=0.0021
    Epoch  3/10: total=65.0689, vae=1.0999, dsb=63.9680, bio=0.0020
    Epoch  4/10: total=63.3991, vae=1.0992, dsb=62.2989, bio=0.0020
    Epoch  5/10: total=63.0764, vae=1.0997, dsb=61.9749, bio=0.0035
    Epoch  6/10: total=62.6865, vae=1.0994, dsb=61.5860, bio=0.0022
    Epoch  7/10: total=62.3222, vae=1.0991, dsb=61.2222, bio=0.0019
    Epoch  8/10: total=61.6174, vae=1.0988, dsb=60.5176, bio=0.0019
    Epoch  9/10: total=61.5106, vae=1.0992, dsb=60.4104, bio=0.0020
    Epoch 10/10: total=61.2708, vae=1.0993, dsb=60.1705, bio=0.0019

  [Backward Policy Training]
    Epoch  1/10: total=2.3187, vae=1.0984, dsb=1.2178, bio=0.0049
    Epoch  2/10: total=2.1589, vae=1.0982, dsb=1.0597, bio=0.0020
    Epoch  3/10: total=2.1595, vae=1.0977, dsb=1.0608, bio=0.0019
    Epoch  4/10: total=2.1157, vae=1.0973, dsb=1.0175, bio=0.0018
    Epoch  5/10: total=2.0773, vae=1.0978, dsb=0.9786, bio=0.0017
    Epoch  6/10: total=2.0714, vae=1.0977, dsb=0.9727, bio=0.0019
    Epoch  7/10: total=2.0673, vae=1.0978, dsb=0.9687, bio=0.0017
    Epoch  8/10: total=2.0449, vae=1.0970, dsb=0.9471, bio=0.0017
    Epoch  9/10: total=2.0610, vae=1.0981, dsb=0.9621, bio=0.0017
    Epoch 10/10: total=2.0594, vae=1.0975, dsb=0.9611, bio=0.0017

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=56.1910, vae=1.1003, dsb=55.0890, bio=0.0033
    Epoch  2/10: total=53.2003, vae=1.0980, dsb=52.1014, bio=0.0017
    Epoch  3/10: total=52.7888, vae=1.0986, dsb=51.6894, bio=0.0017
    Epoch  4/10: total=52.0569, vae=1.0986, dsb=50.9574, bio=0.0017
    Epoch  5/10: total=51.5873, vae=1.0991, dsb=50.4873, bio=0.0019
    Epoch  6/10: total=51.5463, vae=1.0990, dsb=50.4465, bio=0.0016
    Epoch  7/10: total=51.3792, vae=1.0993, dsb=50.2790, bio=0.0016
    Epoch  8/10: total=51.3819, vae=1.0980, dsb=50.2831, bio=0.0016
    Epoch  9/10: total=51.4076, vae=1.0982, dsb=50.3086, bio=0.0017
    Epoch 10/10: total=51.1066, vae=1.0983, dsb=50.0073, bio=0.0018

  [Backward Policy Training]
    Epoch  1/10: total=1.9424, vae=1.0987, dsb=0.8397, bio=0.0081
    Epoch  2/10: total=1.8680, vae=1.0975, dsb=0.7697, bio=0.0016
    Epoch  3/10: total=1.8568, vae=1.0965, dsb=0.7596, bio=0.0015
    Epoch  4/10: total=1.8437, vae=1.0978, dsb=0.7452, bio=0.0015
    Epoch  5/10: total=1.8310, vae=1.0977, dsb=0.7325, bio=0.0015
    Epoch  6/10: total=1.8167, vae=1.0964, dsb=0.7196, bio=0.0014
    Epoch  7/10: total=1.8210, vae=1.0979, dsb=0.7225, bio=0.0014
    Epoch  8/10: total=1.8166, vae=1.0965, dsb=0.7194, bio=0.0014
    Epoch  9/10: total=1.8278, vae=1.0968, dsb=0.7301, bio=0.0019
    Epoch 10/10: total=1.7923, vae=1.0972, dsb=0.6944, bio=0.0014

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=45.2632, vae=1.1009, dsb=44.1608, bio=0.0029
    Epoch  2/10: total=44.2517, vae=1.0979, dsb=43.1530, bio=0.0015
    Epoch  3/10: total=43.8532, vae=1.0977, dsb=42.7547, bio=0.0015
    Epoch  4/10: total=43.9409, vae=1.0976, dsb=42.8425, bio=0.0016
    Epoch  5/10: total=43.6855, vae=1.0977, dsb=42.5871, bio=0.0014
    Epoch  6/10: total=43.6239, vae=1.0984, dsb=42.5248, bio=0.0014
    Epoch  7/10: total=43.5236, vae=1.0976, dsb=42.4252, bio=0.0016
    Epoch  8/10: total=43.4575, vae=1.0968, dsb=42.3600, bio=0.0014
    Epoch  9/10: total=43.5146, vae=1.0980, dsb=42.4159, bio=0.0014
    Epoch 10/10: total=43.5830, vae=1.0976, dsb=42.4847, bio=0.0014

  [Backward Policy Training]
    Epoch  1/10: total=1.7226, vae=1.0971, dsb=0.6166, bio=0.0176
    Epoch  2/10: total=1.7124, vae=1.0970, dsb=0.6147, bio=0.0014
    Epoch  3/10: total=1.6709, vae=1.0966, dsb=0.5736, bio=0.0013
    Epoch  4/10: total=1.6833, vae=1.0957, dsb=0.5869, bio=0.0012
    Epoch  5/10: total=1.6763, vae=1.0976, dsb=0.5780, bio=0.0012
    Epoch  6/10: total=1.6760, vae=1.0962, dsb=0.5789, bio=0.0018
    Epoch  7/10: total=1.6695, vae=1.0973, dsb=0.5716, bio=0.0012
    Epoch  8/10: total=1.6730, vae=1.0966, dsb=0.5758, bio=0.0011
    Epoch  9/10: total=1.6718, vae=1.0965, dsb=0.5747, bio=0.0012
    Epoch 10/10: total=1.6734, vae=1.0959, dsb=0.5770, bio=0.0012

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=37.9970, vae=1.1004, dsb=36.8953, bio=0.0027
    Epoch  2/10: total=37.5763, vae=1.0981, dsb=36.4775, bio=0.0013
    Epoch  3/10: total=37.5200, vae=1.0975, dsb=36.4218, bio=0.0012
    Epoch  4/10: total=37.3921, vae=1.0976, dsb=36.2939, bio=0.0012
    Epoch  5/10: total=37.3869, vae=1.0971, dsb=36.2892, bio=0.0012
    Epoch  6/10: total=37.3207, vae=1.0975, dsb=36.2226, bio=0.0012
    Epoch  7/10: total=37.1684, vae=1.0974, dsb=36.0704, bio=0.0012
    Epoch  8/10: total=37.2731, vae=1.0973, dsb=36.1751, bio=0.0013
    Epoch  9/10: total=37.5944, vae=1.0975, dsb=36.4964, bio=0.0011
    Epoch 10/10: total=37.2546, vae=1.0964, dsb=36.1576, bio=0.0011

  [Backward Policy Training]
    Epoch  1/10: total=1.6551, vae=1.0981, dsb=0.5162, bio=0.0816
    Epoch  2/10: total=1.5956, vae=1.0968, dsb=0.4982, bio=0.0012
    Epoch  3/10: total=1.5985, vae=1.0965, dsb=0.5014, bio=0.0011
    Epoch  4/10: total=1.5983, vae=1.0955, dsb=0.5023, bio=0.0011
    Epoch  5/10: total=1.6062, vae=1.0972, dsb=0.5085, bio=0.0010
    Epoch  6/10: total=1.5987, vae=1.0961, dsb=0.5021, bio=0.0011
    Epoch  7/10: total=1.5996, vae=1.0964, dsb=0.5024, bio=0.0014
    Epoch  8/10: total=1.6018, vae=1.0967, dsb=0.5046, bio=0.0010
    Epoch  9/10: total=1.6019, vae=1.0950, dsb=0.5064, bio=0.0010
    Epoch 10/10: total=1.5907, vae=1.0959, dsb=0.4943, bio=0.0010

[Seed 85] Joint training (original) complete; models and history saved.

[Seed 85] Starting joint training (ablation)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=401.5605, vae=2.0395, dsb=399.5210, bio=0.0000
    Epoch  2/10: total=113.1104, vae=1.0930, dsb=112.0174, bio=0.0000
    Epoch  3/10: total=100.0553, vae=1.0920, dsb=98.9633, bio=0.0000
    Epoch  4/10: total=94.2947, vae=1.0901, dsb=93.2047, bio=0.0000
    Epoch  5/10: total=90.5552, vae=1.0896, dsb=89.4656, bio=0.0000
    Epoch  6/10: total=87.8623, vae=1.0891, dsb=86.7732, bio=0.0000
    Epoch  7/10: total=85.7880, vae=1.0898, dsb=84.6982, bio=0.0000
    Epoch  8/10: total=84.4707, vae=1.0904, dsb=83.3803, bio=0.0000
    Epoch  9/10: total=83.0752, vae=1.0890, dsb=81.9862, bio=0.0000
    Epoch 10/10: total=81.8355, vae=1.0903, dsb=80.7452, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=3.3981, vae=1.0900, dsb=2.3080, bio=0.0000
    Epoch  2/10: total=2.9181, vae=1.0893, dsb=1.8287, bio=0.0000
    Epoch  3/10: total=2.7726, vae=1.0894, dsb=1.6831, bio=0.0000
    Epoch  4/10: total=2.6994, vae=1.0891, dsb=1.6103, bio=0.0000
    Epoch  5/10: total=2.6402, vae=1.0900, dsb=1.5502, bio=0.0000
    Epoch  6/10: total=2.6012, vae=1.0891, dsb=1.5121, bio=0.0000
    Epoch  7/10: total=2.5622, vae=1.0885, dsb=1.4738, bio=0.0000
    Epoch  8/10: total=2.5719, vae=1.0897, dsb=1.4822, bio=0.0000
    Epoch  9/10: total=2.5501, vae=1.0895, dsb=1.4606, bio=0.0000
    Epoch 10/10: total=2.5146, vae=1.0897, dsb=1.4249, bio=0.0000

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=73.3066, vae=1.0898, dsb=72.2168, bio=0.0000
    Epoch  2/10: total=66.3205, vae=1.0893, dsb=65.2312, bio=0.0000
    Epoch  3/10: total=64.6554, vae=1.0894, dsb=63.5660, bio=0.0000
    Epoch  4/10: total=63.1001, vae=1.0889, dsb=62.0113, bio=0.0000
    Epoch  5/10: total=62.8839, vae=1.0894, dsb=61.7944, bio=0.0000
    Epoch  6/10: total=62.4149, vae=1.0893, dsb=61.3256, bio=0.0000
    Epoch  7/10: total=62.0902, vae=1.0891, dsb=61.0011, bio=0.0000
    Epoch  8/10: total=61.3786, vae=1.0888, dsb=60.2897, bio=0.0000
    Epoch  9/10: total=61.2348, vae=1.0892, dsb=60.1456, bio=0.0000
    Epoch 10/10: total=61.0754, vae=1.0895, dsb=59.9859, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=2.2438, vae=1.0884, dsb=1.1554, bio=0.0000
    Epoch  2/10: total=2.0962, vae=1.0894, dsb=1.0068, bio=0.0000
    Epoch  3/10: total=2.0975, vae=1.0890, dsb=1.0084, bio=0.0000
    Epoch  4/10: total=2.0577, vae=1.0888, dsb=0.9689, bio=0.0000
    Epoch  5/10: total=2.0228, vae=1.0893, dsb=0.9335, bio=0.0000
    Epoch  6/10: total=2.0174, vae=1.0893, dsb=0.9282, bio=0.0000
    Epoch  7/10: total=2.0161, vae=1.0894, dsb=0.9267, bio=0.0000
    Epoch  8/10: total=1.9943, vae=1.0887, dsb=0.9056, bio=0.0000
    Epoch  9/10: total=2.0106, vae=1.0897, dsb=0.9209, bio=0.0000
    Epoch 10/10: total=2.0097, vae=1.0892, dsb=0.9205, bio=0.0000

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=55.7556, vae=1.0894, dsb=54.6661, bio=0.0000
    Epoch  2/10: total=52.8942, vae=1.0883, dsb=51.8059, bio=0.0000
    Epoch  3/10: total=52.6000, vae=1.0891, dsb=51.5109, bio=0.0000
    Epoch  4/10: total=51.9376, vae=1.0892, dsb=50.8484, bio=0.0000
    Epoch  5/10: total=51.5240, vae=1.0897, dsb=50.4343, bio=0.0000
    Epoch  6/10: total=51.4820, vae=1.0897, dsb=50.3923, bio=0.0000
    Epoch  7/10: total=51.3772, vae=1.0901, dsb=50.2872, bio=0.0000
    Epoch  8/10: total=51.4287, vae=1.0889, dsb=50.3399, bio=0.0000
    Epoch  9/10: total=51.5052, vae=1.0890, dsb=50.4162, bio=0.0000
    Epoch 10/10: total=51.1357, vae=1.0891, dsb=50.0466, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.8817, vae=1.0892, dsb=0.7924, bio=0.0000
    Epoch  2/10: total=1.8169, vae=1.0892, dsb=0.7277, bio=0.0000
    Epoch  3/10: total=1.8080, vae=1.0884, dsb=0.7196, bio=0.0000
    Epoch  4/10: total=1.7965, vae=1.0897, dsb=0.7068, bio=0.0000
    Epoch  5/10: total=1.7844, vae=1.0897, dsb=0.6948, bio=0.0000
    Epoch  6/10: total=1.7719, vae=1.0884, dsb=0.6835, bio=0.0000
    Epoch  7/10: total=1.7771, vae=1.0900, dsb=0.6872, bio=0.0000
    Epoch  8/10: total=1.7740, vae=1.0886, dsb=0.6854, bio=0.0000
    Epoch  9/10: total=1.7852, vae=1.0889, dsb=0.6963, bio=0.0000
    Epoch 10/10: total=1.7520, vae=1.0894, dsb=0.6626, bio=0.0000

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=47.0991, vae=1.0900, dsb=46.0091, bio=0.0000
    Epoch  2/10: total=46.1649, vae=1.0887, dsb=45.0762, bio=0.0000
    Epoch  3/10: total=45.7865, vae=1.0888, dsb=44.6977, bio=0.0000
    Epoch  4/10: total=45.8607, vae=1.0887, dsb=44.7720, bio=0.0000
    Epoch  5/10: total=45.6463, vae=1.0889, dsb=44.5574, bio=0.0000
    Epoch  6/10: total=45.5513, vae=1.0897, dsb=44.4616, bio=0.0000
    Epoch  7/10: total=45.4561, vae=1.0889, dsb=44.3672, bio=0.0000
    Epoch  8/10: total=45.3869, vae=1.0883, dsb=44.2986, bio=0.0000
    Epoch  9/10: total=45.4398, vae=1.0894, dsb=44.3503, bio=0.0000
    Epoch 10/10: total=45.5131, vae=1.0891, dsb=44.4240, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.6749, vae=1.0881, dsb=0.5868, bio=0.0000
    Epoch  2/10: total=1.6760, vae=1.0891, dsb=0.5870, bio=0.0000
    Epoch  3/10: total=1.6353, vae=1.0888, dsb=0.5465, bio=0.0000
    Epoch  4/10: total=1.6480, vae=1.0879, dsb=0.5600, bio=0.0000
    Epoch  5/10: total=1.6409, vae=1.0899, dsb=0.5510, bio=0.0000
    Epoch  6/10: total=1.6414, vae=1.0885, dsb=0.5530, bio=0.0000
    Epoch  7/10: total=1.6349, vae=1.0897, dsb=0.5452, bio=0.0000
    Epoch  8/10: total=1.6386, vae=1.0890, dsb=0.5496, bio=0.0000
    Epoch  9/10: total=1.6375, vae=1.0889, dsb=0.5486, bio=0.0000
    Epoch 10/10: total=1.6395, vae=1.0883, dsb=0.5512, bio=0.0000

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=39.4056, vae=1.0902, dsb=38.3154, bio=0.0000
    Epoch  2/10: total=39.0572, vae=1.0892, dsb=37.9680, bio=0.0000
    Epoch  3/10: total=38.9767, vae=1.0891, dsb=37.8876, bio=0.0000
    Epoch  4/10: total=38.8968, vae=1.0892, dsb=37.8075, bio=0.0000
    Epoch  5/10: total=38.8785, vae=1.0889, dsb=37.7897, bio=0.0000
    Epoch  6/10: total=38.8177, vae=1.0893, dsb=37.7284, bio=0.0000
    Epoch  7/10: total=38.6535, vae=1.0893, dsb=37.5642, bio=0.0000
    Epoch  8/10: total=38.7399, vae=1.0893, dsb=37.6505, bio=0.0000
    Epoch  9/10: total=39.1058, vae=1.0896, dsb=38.0162, bio=0.0000
    Epoch 10/10: total=38.7615, vae=1.0886, dsb=37.6729, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.5824, vae=1.0892, dsb=0.4932, bio=0.0000
    Epoch  2/10: total=1.5648, vae=1.0890, dsb=0.4757, bio=0.0000
    Epoch  3/10: total=1.5679, vae=1.0889, dsb=0.4790, bio=0.0000
    Epoch  4/10: total=1.5685, vae=1.0880, dsb=0.4806, bio=0.0000
    Epoch  5/10: total=1.5766, vae=1.0897, dsb=0.4870, bio=0.0000
    Epoch  6/10: total=1.5692, vae=1.0886, dsb=0.4806, bio=0.0000
    Epoch  7/10: total=1.5700, vae=1.0891, dsb=0.4810, bio=0.0000
    Epoch  8/10: total=1.5729, vae=1.0894, dsb=0.4835, bio=0.0000
    Epoch  9/10: total=1.5731, vae=1.0878, dsb=0.4854, bio=0.0000
    Epoch 10/10: total=1.5625, vae=1.0887, dsb=0.4738, bio=0.0000

[Seed 85] Joint training (ablation) complete; models and history saved.

[Seed 85] Drift genes saved in /home/yyuan/ICB_TCE/iter_results/run_085

[Seed 85] run finished.

================================================================================
[Seed 86] Starting running whole pipeline...
================================================================================

[Seed 86] Starting VAE pre-training...

    Epoch [01/20], Beta: 0.000, Average Loss: 534.5407
    Epoch [02/20], Beta: 0.000, Average Loss: 306.3883
    Epoch [03/20], Beta: 0.000, Average Loss: 270.9086
    Epoch [04/20], Beta: 0.000, Average Loss: 251.5301
    Epoch [05/20], Beta: 0.100, Average Loss: 245.7916
    Epoch [06/20], Beta: 0.200, Average Loss: 244.8683
    Epoch [07/20], Beta: 0.300, Average Loss: 244.8991
    Epoch [08/20], Beta: 0.400, Average Loss: 245.6200
    Epoch [09/20], Beta: 0.500, Average Loss: 246.5335
    Epoch [10/20], Beta: 0.600, Average Loss: 247.6716
    Epoch [11/20], Beta: 0.700, Average Loss: 248.8925
    Epoch [12/20], Beta: 0.800, Average Loss: 250.1879
    Epoch [13/20], Beta: 0.900, Average Loss: 251.4721
    Epoch [14/20], Beta: 1.000, Average Loss: 253.0714
    Epoch [15/20], Beta: 1.000, Average Loss: 252.6790
    Epoch [16/20], Beta: 1.000, Average Loss: 252.3266
    Epoch [17/20], Beta: 1.000, Average Loss: 251.9486
    Epoch [18/20], Beta: 1.000, Average Loss: 251.6619
    Epoch [19/20], Beta: 1.000, Average Loss: 251.3214
    Epoch [20/20], Beta: 1.000, Average Loss: 251.1781

[Seed 86] VAE pre-training complete.

[Seed 86] Starting joint training (original)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=228.9773, vae=3.7039, dsb=205.6584, bio=39.2301
    Epoch  2/10: total=57.4910, vae=1.1020, dsb=56.3352, bio=0.1076
    Epoch  3/10: total=46.1923, vae=1.0954, dsb=45.0755, bio=0.0428
    Epoch  4/10: total=40.7287, vae=1.0932, dsb=39.6232, bio=0.0246
    Epoch  5/10: total=37.6737, vae=1.0914, dsb=36.5740, bio=0.0165
    Epoch  6/10: total=35.6480, vae=1.0919, dsb=34.5501, bio=0.0120
    Epoch  7/10: total=34.2114, vae=1.0917, dsb=33.1151, bio=0.0092
    Epoch  8/10: total=33.0228, vae=1.0912, dsb=31.9280, bio=0.0073
    Epoch  9/10: total=32.1237, vae=1.0892, dsb=31.0315, bio=0.0059
    Epoch 10/10: total=31.4181, vae=1.0898, dsb=30.3257, bio=0.0051

  [Backward Policy Training]
    Epoch  1/10: total=3.1037, vae=1.0908, dsb=2.0066, bio=0.0126
    Epoch  2/10: total=2.6192, vae=1.0896, dsb=1.5273, bio=0.0046
    Epoch  3/10: total=2.4914, vae=1.0893, dsb=1.4004, bio=0.0033
    Epoch  4/10: total=2.4089, vae=1.0889, dsb=1.3186, bio=0.0027
    Epoch  5/10: total=2.3485, vae=1.0879, dsb=1.2594, bio=0.0024
    Epoch  6/10: total=2.3493, vae=1.0877, dsb=1.2606, bio=0.0022
    Epoch  7/10: total=2.2981, vae=1.0878, dsb=1.2091, bio=0.0025
    Epoch  8/10: total=2.2677, vae=1.0879, dsb=1.1788, bio=0.0020
    Epoch  9/10: total=2.2750, vae=1.0878, dsb=1.1862, bio=0.0019
    Epoch 10/10: total=2.2181, vae=1.0880, dsb=1.1292, bio=0.0019

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=33.2870, vae=1.0897, dsb=32.1956, bio=0.0033
    Epoch  2/10: total=24.8078, vae=1.0891, dsb=23.7178, bio=0.0017
    Epoch  3/10: total=22.8985, vae=1.0883, dsb=21.8093, bio=0.0017
    Epoch  4/10: total=21.6901, vae=1.0891, dsb=20.6001, bio=0.0017
    Epoch  5/10: total=21.0655, vae=1.0887, dsb=19.9759, bio=0.0018
    Epoch  6/10: total=20.5817, vae=1.0883, dsb=19.4926, bio=0.0018
    Epoch  7/10: total=20.2135, vae=1.0878, dsb=19.1248, bio=0.0018
    Epoch  8/10: total=20.0347, vae=1.0884, dsb=18.9454, bio=0.0018
    Epoch  9/10: total=19.7064, vae=1.0880, dsb=18.6174, bio=0.0020
    Epoch 10/10: total=19.5049, vae=1.0877, dsb=18.4164, bio=0.0017

  [Backward Policy Training]
    Epoch  1/10: total=2.0110, vae=1.0889, dsb=0.9194, bio=0.0054
    Epoch  2/10: total=1.8926, vae=1.0877, dsb=0.8040, bio=0.0017
    Epoch  3/10: total=1.8541, vae=1.0867, dsb=0.7666, bio=0.0016
    Epoch  4/10: total=1.8310, vae=1.0866, dsb=0.7436, bio=0.0016
    Epoch  5/10: total=1.8030, vae=1.0866, dsb=0.7154, bio=0.0018
    Epoch  6/10: total=1.7796, vae=1.0861, dsb=0.6927, bio=0.0016
    Epoch  7/10: total=1.7776, vae=1.0868, dsb=0.6900, bio=0.0015
    Epoch  8/10: total=1.7603, vae=1.0867, dsb=0.6728, bio=0.0015
    Epoch  9/10: total=1.7687, vae=1.0863, dsb=0.6817, bio=0.0015
    Epoch 10/10: total=1.7420, vae=1.0866, dsb=0.6546, bio=0.0014

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=21.7950, vae=1.0886, dsb=20.7050, bio=0.0029
    Epoch  2/10: total=18.1019, vae=1.0872, dsb=17.0140, bio=0.0016
    Epoch  3/10: total=17.1568, vae=1.0874, dsb=16.0686, bio=0.0015
    Epoch  4/10: total=16.5919, vae=1.0869, dsb=15.5043, bio=0.0015
    Epoch  5/10: total=16.2268, vae=1.0870, dsb=15.1391, bio=0.0015
    Epoch  6/10: total=16.0057, vae=1.0876, dsb=14.9173, bio=0.0015
    Epoch  7/10: total=15.7730, vae=1.0871, dsb=14.6852, bio=0.0015
    Epoch  8/10: total=15.7288, vae=1.0868, dsb=14.6412, bio=0.0015
    Epoch  9/10: total=15.5525, vae=1.0859, dsb=14.4657, bio=0.0018
    Epoch 10/10: total=15.4804, vae=1.0858, dsb=14.3939, bio=0.0015

  [Backward Policy Training]
    Epoch  1/10: total=1.6845, vae=1.0877, dsb=0.5897, bio=0.0143
    Epoch  2/10: total=1.6196, vae=1.0861, dsb=0.5328, bio=0.0014
    Epoch  3/10: total=1.5877, vae=1.0858, dsb=0.5011, bio=0.0013
    Epoch  4/10: total=1.5776, vae=1.0857, dsb=0.4913, bio=0.0013
    Epoch  5/10: total=1.5592, vae=1.0854, dsb=0.4730, bio=0.0014
    Epoch  6/10: total=1.5690, vae=1.0863, dsb=0.4821, bio=0.0013
    Epoch  7/10: total=1.5489, vae=1.0847, dsb=0.4636, bio=0.0013
    Epoch  8/10: total=1.5467, vae=1.0852, dsb=0.4609, bio=0.0012
    Epoch  9/10: total=1.5429, vae=1.0851, dsb=0.4572, bio=0.0013
    Epoch 10/10: total=1.5264, vae=1.0853, dsb=0.4406, bio=0.0012

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=16.9217, vae=1.0886, dsb=15.8316, bio=0.0030
    Epoch  2/10: total=15.1496, vae=1.0867, dsb=14.0622, bio=0.0013
    Epoch  3/10: total=14.7213, vae=1.0861, dsb=13.6345, bio=0.0014
    Epoch  4/10: total=14.4262, vae=1.0864, dsb=13.3390, bio=0.0013
    Epoch  5/10: total=14.2288, vae=1.0856, dsb=13.1425, bio=0.0013
    Epoch  6/10: total=14.0556, vae=1.0859, dsb=12.9691, bio=0.0013
    Epoch  7/10: total=14.0261, vae=1.0861, dsb=12.9393, bio=0.0013
    Epoch  8/10: total=13.9479, vae=1.0860, dsb=12.8613, bio=0.0012
    Epoch  9/10: total=13.8629, vae=1.0854, dsb=12.7769, bio=0.0012
    Epoch 10/10: total=13.8357, vae=1.0871, dsb=12.7480, bio=0.0012

  [Backward Policy Training]
    Epoch  1/10: total=1.5203, vae=1.0868, dsb=0.3988, bio=0.0693
    Epoch  2/10: total=1.4395, vae=1.0850, dsb=0.3538, bio=0.0013
    Epoch  3/10: total=1.4457, vae=1.0861, dsb=0.3589, bio=0.0012
    Epoch  4/10: total=1.4372, vae=1.0855, dsb=0.3511, bio=0.0012
    Epoch  5/10: total=1.4259, vae=1.0849, dsb=0.3405, bio=0.0011
    Epoch  6/10: total=1.4295, vae=1.0857, dsb=0.3433, bio=0.0011
    Epoch  7/10: total=1.4173, vae=1.0848, dsb=0.3320, bio=0.0011
    Epoch  8/10: total=1.4189, vae=1.0845, dsb=0.3339, bio=0.0010
    Epoch  9/10: total=1.4126, vae=1.0844, dsb=0.3277, bio=0.0010
    Epoch 10/10: total=1.4111, vae=1.0844, dsb=0.3263, bio=0.0010

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=12.9869, vae=1.0882, dsb=11.8960, bio=0.0055
    Epoch  2/10: total=12.1792, vae=1.0868, dsb=11.0918, bio=0.0012
    Epoch  3/10: total=11.9989, vae=1.0866, dsb=10.9116, bio=0.0012
    Epoch  4/10: total=11.8819, vae=1.0858, dsb=10.7954, bio=0.0012
    Epoch  5/10: total=11.8374, vae=1.0867, dsb=10.7500, bio=0.0012
    Epoch  6/10: total=11.7824, vae=1.0858, dsb=10.6961, bio=0.0012
    Epoch  7/10: total=11.7638, vae=1.0862, dsb=10.6771, bio=0.0011
    Epoch  8/10: total=11.7373, vae=1.0857, dsb=10.6511, bio=0.0009
    Epoch  9/10: total=11.7482, vae=1.0861, dsb=10.6615, bio=0.0012
    Epoch 10/10: total=11.7054, vae=1.0853, dsb=10.6195, bio=0.0011

  [Backward Policy Training]
    Epoch  1/10: total=1.4020, vae=1.0865, dsb=0.2664, bio=0.0981
    Epoch  2/10: total=1.3412, vae=1.0859, dsb=0.2547, bio=0.0011
    Epoch  3/10: total=1.3293, vae=1.0850, dsb=0.2437, bio=0.0010
    Epoch  4/10: total=1.3323, vae=1.0842, dsb=0.2477, bio=0.0009
    Epoch  5/10: total=1.3314, vae=1.0856, dsb=0.2453, bio=0.0010
    Epoch  6/10: total=1.3223, vae=1.0838, dsb=0.2380, bio=0.0010
    Epoch  7/10: total=1.3203, vae=1.0844, dsb=0.2354, bio=0.0009
    Epoch  8/10: total=1.3257, vae=1.0853, dsb=0.2400, bio=0.0009
    Epoch  9/10: total=1.3238, vae=1.0841, dsb=0.2394, bio=0.0006
    Epoch 10/10: total=1.3196, vae=1.0853, dsb=0.2338, bio=0.0010

[Seed 86] Joint training (original) complete; models and history saved.

[Seed 86] Starting joint training (ablation)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=207.5224, vae=1.9888, dsb=205.5336, bio=0.0000
    Epoch  2/10: total=57.3260, vae=1.0819, dsb=56.2441, bio=0.0000
    Epoch  3/10: total=46.1102, vae=1.0800, dsb=45.0302, bio=0.0000
    Epoch  4/10: total=40.6939, vae=1.0796, dsb=39.6143, bio=0.0000
    Epoch  5/10: total=37.6396, vae=1.0785, dsb=36.5611, bio=0.0000
    Epoch  6/10: total=35.5881, vae=1.0794, dsb=34.5086, bio=0.0000
    Epoch  7/10: total=34.1254, vae=1.0795, dsb=33.0459, bio=0.0000
    Epoch  8/10: total=32.9318, vae=1.0793, dsb=31.8524, bio=0.0000
    Epoch  9/10: total=32.0536, vae=1.0777, dsb=30.9760, bio=0.0000
    Epoch 10/10: total=31.3635, vae=1.0784, dsb=30.2850, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=3.0386, vae=1.0785, dsb=1.9601, bio=0.0000
    Epoch  2/10: total=2.5741, vae=1.0788, dsb=1.4953, bio=0.0000
    Epoch  3/10: total=2.4461, vae=1.0789, dsb=1.3672, bio=0.0000
    Epoch  4/10: total=2.3634, vae=1.0788, dsb=1.2845, bio=0.0000
    Epoch  5/10: total=2.3024, vae=1.0780, dsb=1.2244, bio=0.0000
    Epoch  6/10: total=2.3038, vae=1.0780, dsb=1.2258, bio=0.0000
    Epoch  7/10: total=2.2535, vae=1.0781, dsb=1.1753, bio=0.0000
    Epoch  8/10: total=2.2243, vae=1.0785, dsb=1.1458, bio=0.0000
    Epoch  9/10: total=2.2307, vae=1.0785, dsb=1.1522, bio=0.0000
    Epoch 10/10: total=2.1751, vae=1.0787, dsb=1.0964, bio=0.0000

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=32.4817, vae=1.0779, dsb=31.4038, bio=0.0000
    Epoch  2/10: total=24.5556, vae=1.0783, dsb=23.4773, bio=0.0000
    Epoch  3/10: total=22.6532, vae=1.0777, dsb=21.5755, bio=0.0000
    Epoch  4/10: total=21.4266, vae=1.0787, dsb=20.3479, bio=0.0000
    Epoch  5/10: total=20.8230, vae=1.0784, dsb=19.7446, bio=0.0000
    Epoch  6/10: total=20.3086, vae=1.0781, dsb=19.2305, bio=0.0000
    Epoch  7/10: total=19.9308, vae=1.0778, dsb=18.8530, bio=0.0000
    Epoch  8/10: total=19.7245, vae=1.0784, dsb=18.6461, bio=0.0000
    Epoch  9/10: total=19.3878, vae=1.0781, dsb=18.3098, bio=0.0000
    Epoch 10/10: total=19.1733, vae=1.0780, dsb=18.0954, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.9724, vae=1.0785, dsb=0.8940, bio=0.0000
    Epoch  2/10: total=1.8559, vae=1.0787, dsb=0.7771, bio=0.0000
    Epoch  3/10: total=1.8168, vae=1.0779, dsb=0.7388, bio=0.0000
    Epoch  4/10: total=1.7945, vae=1.0779, dsb=0.7166, bio=0.0000
    Epoch  5/10: total=1.7675, vae=1.0780, dsb=0.6895, bio=0.0000
    Epoch  6/10: total=1.7445, vae=1.0776, dsb=0.6669, bio=0.0000
    Epoch  7/10: total=1.7426, vae=1.0784, dsb=0.6643, bio=0.0000
    Epoch  8/10: total=1.7259, vae=1.0782, dsb=0.6477, bio=0.0000
    Epoch  9/10: total=1.7343, vae=1.0780, dsb=0.6563, bio=0.0000
    Epoch 10/10: total=1.7093, vae=1.0783, dsb=0.6310, bio=0.0000

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=21.1064, vae=1.0778, dsb=20.0286, bio=0.0000
    Epoch  2/10: total=17.5050, vae=1.0775, dsb=16.4274, bio=0.0000
    Epoch  3/10: total=16.6215, vae=1.0780, dsb=15.5435, bio=0.0000
    Epoch  4/10: total=16.0905, vae=1.0776, dsb=15.0130, bio=0.0000
    Epoch  5/10: total=15.7675, vae=1.0778, dsb=14.6897, bio=0.0000
    Epoch  6/10: total=15.5505, vae=1.0784, dsb=14.4721, bio=0.0000
    Epoch  7/10: total=15.3459, vae=1.0780, dsb=14.2678, bio=0.0000
    Epoch  8/10: total=15.3116, vae=1.0778, dsb=14.2338, bio=0.0000
    Epoch  9/10: total=15.1456, vae=1.0770, dsb=14.0686, bio=0.0000
    Epoch 10/10: total=15.1017, vae=1.0769, dsb=14.0247, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.6424, vae=1.0785, dsb=0.5639, bio=0.0000
    Epoch  2/10: total=1.5843, vae=1.0779, dsb=0.5064, bio=0.0000
    Epoch  3/10: total=1.5525, vae=1.0778, dsb=0.4747, bio=0.0000
    Epoch  4/10: total=1.5414, vae=1.0776, dsb=0.4638, bio=0.0000
    Epoch  5/10: total=1.5239, vae=1.0775, dsb=0.4464, bio=0.0000
    Epoch  6/10: total=1.5330, vae=1.0785, dsb=0.4544, bio=0.0000
    Epoch  7/10: total=1.5135, vae=1.0769, dsb=0.4365, bio=0.0000
    Epoch  8/10: total=1.5112, vae=1.0776, dsb=0.4337, bio=0.0000
    Epoch  9/10: total=1.5076, vae=1.0775, dsb=0.4302, bio=0.0000
    Epoch 10/10: total=1.4915, vae=1.0778, dsb=0.4137, bio=0.0000

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=16.5817, vae=1.0779, dsb=15.5038, bio=0.0000
    Epoch  2/10: total=14.8377, vae=1.0776, dsb=13.7601, bio=0.0000
    Epoch  3/10: total=14.4280, vae=1.0772, dsb=13.3508, bio=0.0000
    Epoch  4/10: total=14.1569, vae=1.0777, dsb=13.0791, bio=0.0000
    Epoch  5/10: total=13.9860, vae=1.0770, dsb=12.9090, bio=0.0000
    Epoch  6/10: total=13.7990, vae=1.0774, dsb=12.7216, bio=0.0000
    Epoch  7/10: total=13.7561, vae=1.0777, dsb=12.6784, bio=0.0000
    Epoch  8/10: total=13.7070, vae=1.0778, dsb=12.6292, bio=0.0000
    Epoch  9/10: total=13.6157, vae=1.0772, dsb=12.5385, bio=0.0000
    Epoch 10/10: total=13.5979, vae=1.0790, dsb=12.5189, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.4407, vae=1.0779, dsb=0.3628, bio=0.0000
    Epoch  2/10: total=1.3990, vae=1.0773, dsb=0.3217, bio=0.0000
    Epoch  3/10: total=1.4046, vae=1.0786, dsb=0.3260, bio=0.0000
    Epoch  4/10: total=1.3971, vae=1.0780, dsb=0.3191, bio=0.0000
    Epoch  5/10: total=1.3869, vae=1.0776, dsb=0.3093, bio=0.0000
    Epoch  6/10: total=1.3899, vae=1.0785, dsb=0.3114, bio=0.0000
    Epoch  7/10: total=1.3785, vae=1.0777, dsb=0.3008, bio=0.0000
    Epoch  8/10: total=1.3802, vae=1.0776, dsb=0.3026, bio=0.0000
    Epoch  9/10: total=1.3745, vae=1.0775, dsb=0.2970, bio=0.0000
    Epoch 10/10: total=1.3731, vae=1.0776, dsb=0.2954, bio=0.0000

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=12.6315, vae=1.0782, dsb=11.5533, bio=0.0000
    Epoch  2/10: total=11.9658, vae=1.0779, dsb=10.8879, bio=0.0000
    Epoch  3/10: total=11.8389, vae=1.0780, dsb=10.7609, bio=0.0000
    Epoch  4/10: total=11.7431, vae=1.0774, dsb=10.6658, bio=0.0000
    Epoch  5/10: total=11.7082, vae=1.0784, dsb=10.6298, bio=0.0000
    Epoch  6/10: total=11.6682, vae=1.0776, dsb=10.5906, bio=0.0000
    Epoch  7/10: total=11.6595, vae=1.0781, dsb=10.5814, bio=0.0000
    Epoch  8/10: total=11.6406, vae=1.0777, dsb=10.5628, bio=0.0000
    Epoch  9/10: total=11.6671, vae=1.0782, dsb=10.5888, bio=0.0000
    Epoch 10/10: total=11.6118, vae=1.0776, dsb=10.5342, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.3169, vae=1.0777, dsb=0.2391, bio=0.0000
    Epoch  2/10: total=1.3091, vae=1.0784, dsb=0.2307, bio=0.0000
    Epoch  3/10: total=1.2993, vae=1.0779, dsb=0.2215, bio=0.0000
    Epoch  4/10: total=1.3027, vae=1.0773, dsb=0.2254, bio=0.0000
    Epoch  5/10: total=1.3029, vae=1.0788, dsb=0.2240, bio=0.0000
    Epoch  6/10: total=1.2943, vae=1.0771, dsb=0.2172, bio=0.0000
    Epoch  7/10: total=1.2930, vae=1.0778, dsb=0.2152, bio=0.0000
    Epoch  8/10: total=1.2986, vae=1.0787, dsb=0.2199, bio=0.0000
    Epoch  9/10: total=1.2974, vae=1.0776, dsb=0.2198, bio=0.0000
    Epoch 10/10: total=1.2937, vae=1.0789, dsb=0.2148, bio=0.0000

[Seed 86] Joint training (ablation) complete; models and history saved.

[Seed 86] Drift genes saved in /home/yyuan/ICB_TCE/iter_results/run_086

[Seed 86] run finished.

================================================================================
[Seed 87] Starting running whole pipeline...
================================================================================

[Seed 87] Starting VAE pre-training...

    Epoch [01/20], Beta: 0.000, Average Loss: 537.0593
    Epoch [02/20], Beta: 0.000, Average Loss: 307.1864
    Epoch [03/20], Beta: 0.000, Average Loss: 269.2989
    Epoch [04/20], Beta: 0.000, Average Loss: 249.2729
    Epoch [05/20], Beta: 0.100, Average Loss: 244.5770
    Epoch [06/20], Beta: 0.200, Average Loss: 243.8742
    Epoch [07/20], Beta: 0.300, Average Loss: 244.0486
    Epoch [08/20], Beta: 0.400, Average Loss: 245.0159
    Epoch [09/20], Beta: 0.500, Average Loss: 246.2230
    Epoch [10/20], Beta: 0.600, Average Loss: 247.5851
    Epoch [11/20], Beta: 0.700, Average Loss: 248.9584
    Epoch [12/20], Beta: 0.800, Average Loss: 250.2225
    Epoch [13/20], Beta: 0.900, Average Loss: 251.5287
    Epoch [14/20], Beta: 1.000, Average Loss: 253.1837
    Epoch [15/20], Beta: 1.000, Average Loss: 252.7877
    Epoch [16/20], Beta: 1.000, Average Loss: 252.4144
    Epoch [17/20], Beta: 1.000, Average Loss: 252.0702
    Epoch [18/20], Beta: 1.000, Average Loss: 251.7667
    Epoch [19/20], Beta: 1.000, Average Loss: 251.3930
    Epoch [20/20], Beta: 1.000, Average Loss: 251.2392

[Seed 87] VAE pre-training complete.

[Seed 87] Starting joint training (original)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=326.6278, vae=3.6148, dsb=307.6503, bio=30.7256
    Epoch  2/10: total=85.6518, vae=1.1117, dsb=84.5021, bio=0.0761
    Epoch  3/10: total=74.8582, vae=1.1069, dsb=73.7350, bio=0.0326
    Epoch  4/10: total=70.1923, vae=1.1055, dsb=69.0772, bio=0.0191
    Epoch  5/10: total=67.0516, vae=1.1045, dsb=65.9406, bio=0.0130
    Epoch  6/10: total=65.0892, vae=1.1037, dsb=63.9808, bio=0.0096
    Epoch  7/10: total=63.4073, vae=1.1032, dsb=62.3004, bio=0.0075
    Epoch  8/10: total=62.3668, vae=1.1016, dsb=61.2622, bio=0.0060
    Epoch  9/10: total=61.5540, vae=1.1031, dsb=60.4484, bio=0.0051
    Epoch 10/10: total=60.7695, vae=1.1017, dsb=59.6656, bio=0.0045

  [Backward Policy Training]
    Epoch  1/10: total=3.3296, vae=1.1027, dsb=2.2201, bio=0.0137
    Epoch  2/10: total=2.8117, vae=1.1018, dsb=1.7075, bio=0.0048
    Epoch  3/10: total=2.6629, vae=1.1011, dsb=1.5600, bio=0.0037
    Epoch  4/10: total=2.6427, vae=1.1012, dsb=1.5401, bio=0.0029
    Epoch  5/10: total=2.6073, vae=1.1004, dsb=1.5056, bio=0.0026
    Epoch  6/10: total=2.5134, vae=1.0998, dsb=1.4124, bio=0.0024
    Epoch  7/10: total=2.5337, vae=1.1005, dsb=1.4321, bio=0.0023
    Epoch  8/10: total=2.4798, vae=1.1008, dsb=1.3779, bio=0.0022
    Epoch  9/10: total=2.4717, vae=1.1000, dsb=1.3707, bio=0.0021
    Epoch 10/10: total=2.4556, vae=1.1000, dsb=1.3546, bio=0.0020

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=54.1192, vae=1.1032, dsb=53.0142, bio=0.0037
    Epoch  2/10: total=47.3500, vae=1.1022, dsb=46.2468, bio=0.0021
    Epoch  3/10: total=45.5109, vae=1.1008, dsb=44.4090, bio=0.0022
    Epoch  4/10: total=44.6615, vae=1.1009, dsb=43.5596, bio=0.0019
    Epoch  5/10: total=43.8012, vae=1.1001, dsb=42.7002, bio=0.0019
    Epoch  6/10: total=43.6107, vae=1.1007, dsb=42.5090, bio=0.0019
    Epoch  7/10: total=43.1618, vae=1.1007, dsb=42.0601, bio=0.0019
    Epoch  8/10: total=43.0175, vae=1.0996, dsb=41.9169, bio=0.0020
    Epoch  9/10: total=42.7166, vae=1.1001, dsb=41.6153, bio=0.0024
    Epoch 10/10: total=42.4496, vae=1.1004, dsb=41.3483, bio=0.0018

  [Backward Policy Training]
    Epoch  1/10: total=2.1614, vae=1.1005, dsb=1.0572, bio=0.0075
    Epoch  2/10: total=2.0536, vae=1.0993, dsb=0.9534, bio=0.0019
    Epoch  3/10: total=2.0139, vae=1.0999, dsb=0.9130, bio=0.0018
    Epoch  4/10: total=2.0019, vae=1.0993, dsb=0.9017, bio=0.0017
    Epoch  5/10: total=1.9736, vae=1.0994, dsb=0.8733, bio=0.0016
    Epoch  6/10: total=1.9448, vae=1.0988, dsb=0.8451, bio=0.0019
    Epoch  7/10: total=1.9718, vae=1.0983, dsb=0.8727, bio=0.0015
    Epoch  8/10: total=1.9525, vae=1.0993, dsb=0.8524, bio=0.0015
    Epoch  9/10: total=1.9288, vae=1.0994, dsb=0.8287, bio=0.0015
    Epoch 10/10: total=1.9244, vae=1.0986, dsb=0.8250, bio=0.0015

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=42.2032, vae=1.1012, dsb=41.1004, bio=0.0033
    Epoch  2/10: total=39.5811, vae=1.0998, dsb=38.4806, bio=0.0015
    Epoch  3/10: total=39.0286, vae=1.0994, dsb=37.9285, bio=0.0015
    Epoch  4/10: total=38.7799, vae=1.0986, dsb=37.6806, bio=0.0015
    Epoch  5/10: total=38.4732, vae=1.0988, dsb=37.3737, bio=0.0015
    Epoch  6/10: total=38.1564, vae=1.0986, dsb=37.0571, bio=0.0015
    Epoch  7/10: total=38.2248, vae=1.0982, dsb=37.1256, bio=0.0019
    Epoch  8/10: total=38.0153, vae=1.0982, dsb=36.9164, bio=0.0014
    Epoch  9/10: total=37.7945, vae=1.0985, dsb=36.6953, bio=0.0014
    Epoch 10/10: total=37.7208, vae=1.0981, dsb=36.6220, bio=0.0014

  [Backward Policy Training]
    Epoch  1/10: total=1.8750, vae=1.1000, dsb=0.7388, bio=0.0723
    Epoch  2/10: total=1.7735, vae=1.0983, dsb=0.6745, bio=0.0015
    Epoch  3/10: total=1.7781, vae=1.0984, dsb=0.6790, bio=0.0013
    Epoch  4/10: total=1.7538, vae=1.0979, dsb=0.6553, bio=0.0013
    Epoch  5/10: total=1.7446, vae=1.0983, dsb=0.6457, bio=0.0013
    Epoch  6/10: total=1.7355, vae=1.0988, dsb=0.6360, bio=0.0013
    Epoch  7/10: total=1.7443, vae=1.0984, dsb=0.6453, bio=0.0012
    Epoch  8/10: total=1.7243, vae=1.0979, dsb=0.6259, bio=0.0012
    Epoch  9/10: total=1.7272, vae=1.0991, dsb=0.6275, bio=0.0012
    Epoch 10/10: total=1.7075, vae=1.0984, dsb=0.6085, bio=0.0012

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=35.0815, vae=1.1005, dsb=33.9797, bio=0.0027
    Epoch  2/10: total=33.8970, vae=1.0999, dsb=32.7965, bio=0.0012
    Epoch  3/10: total=33.8162, vae=1.0990, dsb=32.7166, bio=0.0012
    Epoch  4/10: total=33.6274, vae=1.0993, dsb=32.5276, bio=0.0012
    Epoch  5/10: total=33.4933, vae=1.0983, dsb=32.3943, bio=0.0014
    Epoch  6/10: total=33.2935, vae=1.0971, dsb=32.1959, bio=0.0011
    Epoch  7/10: total=33.4000, vae=1.0978, dsb=32.3016, bio=0.0011
    Epoch  8/10: total=33.4164, vae=1.0981, dsb=32.3177, bio=0.0011
    Epoch  9/10: total=33.2809, vae=1.0978, dsb=32.1826, bio=0.0011
    Epoch 10/10: total=33.0334, vae=1.0972, dsb=31.9358, bio=0.0009

  [Backward Policy Training]
    Epoch  1/10: total=1.7344, vae=1.0983, dsb=0.5468, bio=0.1786
    Epoch  2/10: total=1.6242, vae=1.0979, dsb=0.5257, bio=0.0013
    Epoch  3/10: total=1.6216, vae=1.0978, dsb=0.5232, bio=0.0011
    Epoch  4/10: total=1.6020, vae=1.0980, dsb=0.5035, bio=0.0011
    Epoch  5/10: total=1.5890, vae=1.0971, dsb=0.4915, bio=0.0010
    Epoch  6/10: total=1.5945, vae=1.0974, dsb=0.4966, bio=0.0009
    Epoch  7/10: total=1.6119, vae=1.0987, dsb=0.5127, bio=0.0009
    Epoch  8/10: total=1.6156, vae=1.0979, dsb=0.5172, bio=0.0010
    Epoch  9/10: total=1.6050, vae=1.0981, dsb=0.5063, bio=0.0010
    Epoch 10/10: total=1.5932, vae=1.0971, dsb=0.4957, bio=0.0010

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=29.6189, vae=1.1004, dsb=28.5173, bio=0.0025
    Epoch  2/10: total=29.3313, vae=1.0995, dsb=28.2313, bio=0.0009
    Epoch  3/10: total=28.9434, vae=1.0980, dsb=27.8448, bio=0.0011
    Epoch  4/10: total=28.9288, vae=1.0975, dsb=27.8308, bio=0.0010
    Epoch  5/10: total=28.9046, vae=1.0985, dsb=27.8056, bio=0.0010
    Epoch  6/10: total=28.9731, vae=1.0982, dsb=27.8744, bio=0.0010
    Epoch  7/10: total=28.9438, vae=1.0971, dsb=27.8462, bio=0.0009
    Epoch  8/10: total=28.9521, vae=1.0979, dsb=27.8538, bio=0.0008
    Epoch  9/10: total=28.6597, vae=1.0974, dsb=27.5622, bio=0.0004
    Epoch 10/10: total=28.7764, vae=1.0973, dsb=27.6786, bio=0.0010

  [Backward Policy Training]
    Epoch  1/10: total=1.6544, vae=1.0997, dsb=0.4437, bio=0.2221
    Epoch  2/10: total=1.5145, vae=1.0964, dsb=0.4176, bio=0.0009
    Epoch  3/10: total=1.5268, vae=1.0985, dsb=0.4278, bio=0.0011
    Epoch  4/10: total=1.5187, vae=1.0982, dsb=0.4200, bio=0.0011
    Epoch  5/10: total=1.5282, vae=1.0980, dsb=0.4298, bio=0.0010
    Epoch  6/10: total=1.5310, vae=1.0972, dsb=0.4334, bio=0.0008
    Epoch  7/10: total=1.5146, vae=1.0969, dsb=0.4175, bio=0.0006
    Epoch  8/10: total=1.5154, vae=1.0970, dsb=0.4180, bio=0.0010
    Epoch  9/10: total=1.5074, vae=1.0968, dsb=0.4101, bio=0.0010
    Epoch 10/10: total=1.5206, vae=1.0970, dsb=0.4231, bio=0.0010

[Seed 87] Joint training (original) complete; models and history saved.

[Seed 87] Starting joint training (ablation)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=308.9955, vae=2.0412, dsb=306.9542, bio=0.0000
    Epoch  2/10: total=84.9914, vae=1.0936, dsb=83.8978, bio=0.0000
    Epoch  3/10: total=74.2167, vae=1.0921, dsb=73.1247, bio=0.0000
    Epoch  4/10: total=69.5085, vae=1.0919, dsb=68.4166, bio=0.0000
    Epoch  5/10: total=66.4540, vae=1.0913, dsb=65.3627, bio=0.0000
    Epoch  6/10: total=64.5610, vae=1.0909, dsb=63.4701, bio=0.0000
    Epoch  7/10: total=62.9157, vae=1.0908, dsb=61.8249, bio=0.0000
    Epoch  8/10: total=61.8797, vae=1.0895, dsb=60.7902, bio=0.0000
    Epoch  9/10: total=61.0761, vae=1.0912, dsb=59.9849, bio=0.0000
    Epoch 10/10: total=60.2811, vae=1.0900, dsb=59.1910, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=3.1903, vae=1.0903, dsb=2.1000, bio=0.0000
    Epoch  2/10: total=2.7120, vae=1.0908, dsb=1.6211, bio=0.0000
    Epoch  3/10: total=2.5680, vae=1.0906, dsb=1.4775, bio=0.0000
    Epoch  4/10: total=2.5477, vae=1.0909, dsb=1.4568, bio=0.0000
    Epoch  5/10: total=2.5151, vae=1.0904, dsb=1.4247, bio=0.0000
    Epoch  6/10: total=2.4277, vae=1.0899, dsb=1.3378, bio=0.0000
    Epoch  7/10: total=2.4484, vae=1.0907, dsb=1.3577, bio=0.0000
    Epoch  8/10: total=2.3966, vae=1.0910, dsb=1.3056, bio=0.0000
    Epoch  9/10: total=2.3877, vae=1.0904, dsb=1.2973, bio=0.0000
    Epoch 10/10: total=2.3717, vae=1.0904, dsb=1.2813, bio=0.0000

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=53.5270, vae=1.0908, dsb=52.4362, bio=0.0000
    Epoch  2/10: total=47.1581, vae=1.0913, dsb=46.0668, bio=0.0000
    Epoch  3/10: total=45.4619, vae=1.0901, dsb=44.3718, bio=0.0000
    Epoch  4/10: total=44.6869, vae=1.0905, dsb=43.5964, bio=0.0000
    Epoch  5/10: total=43.8998, vae=1.0898, dsb=42.8100, bio=0.0000
    Epoch  6/10: total=43.7466, vae=1.0905, dsb=42.6561, bio=0.0000
    Epoch  7/10: total=43.3236, vae=1.0907, dsb=42.2329, bio=0.0000
    Epoch  8/10: total=43.1786, vae=1.0897, dsb=42.0889, bio=0.0000
    Epoch  9/10: total=42.8692, vae=1.0904, dsb=41.7788, bio=0.0000
    Epoch 10/10: total=42.6330, vae=1.0907, dsb=41.5423, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=2.0771, vae=1.0903, dsb=0.9868, bio=0.0000
    Epoch  2/10: total=1.9843, vae=1.0902, dsb=0.8941, bio=0.0000
    Epoch  3/10: total=1.9479, vae=1.0911, dsb=0.8568, bio=0.0000
    Epoch  4/10: total=1.9378, vae=1.0906, dsb=0.8473, bio=0.0000
    Epoch  5/10: total=1.9116, vae=1.0908, dsb=0.8209, bio=0.0000
    Epoch  6/10: total=1.8835, vae=1.0901, dsb=0.7934, bio=0.0000
    Epoch  7/10: total=1.9104, vae=1.0898, dsb=0.8206, bio=0.0000
    Epoch  8/10: total=1.8919, vae=1.0909, dsb=0.8011, bio=0.0000
    Epoch  9/10: total=1.8686, vae=1.0909, dsb=0.7776, bio=0.0000
    Epoch 10/10: total=1.8646, vae=1.0902, dsb=0.7744, bio=0.0000

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=40.5380, vae=1.0901, dsb=39.4479, bio=0.0000
    Epoch  2/10: total=38.0333, vae=1.0902, dsb=36.9431, bio=0.0000
    Epoch  3/10: total=37.5372, vae=1.0901, dsb=36.4471, bio=0.0000
    Epoch  4/10: total=37.3488, vae=1.0894, dsb=36.2594, bio=0.0000
    Epoch  5/10: total=37.0192, vae=1.0896, dsb=35.9295, bio=0.0000
    Epoch  6/10: total=36.7118, vae=1.0896, dsb=35.6222, bio=0.0000
    Epoch  7/10: total=36.7905, vae=1.0893, dsb=35.7012, bio=0.0000
    Epoch  8/10: total=36.6119, vae=1.0894, dsb=35.5225, bio=0.0000
    Epoch  9/10: total=36.4301, vae=1.0899, dsb=35.3402, bio=0.0000
    Epoch 10/10: total=36.3670, vae=1.0896, dsb=35.2773, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.7636, vae=1.0906, dsb=0.6729, bio=0.0000
    Epoch  2/10: total=1.7061, vae=1.0900, dsb=0.6161, bio=0.0000
    Epoch  3/10: total=1.7114, vae=1.0902, dsb=0.6212, bio=0.0000
    Epoch  4/10: total=1.6887, vae=1.0898, dsb=0.5989, bio=0.0000
    Epoch  5/10: total=1.6803, vae=1.0902, dsb=0.5901, bio=0.0000
    Epoch  6/10: total=1.6720, vae=1.0908, dsb=0.5812, bio=0.0000
    Epoch  7/10: total=1.6811, vae=1.0904, dsb=0.5907, bio=0.0000
    Epoch  8/10: total=1.6626, vae=1.0900, dsb=0.5726, bio=0.0000
    Epoch  9/10: total=1.6657, vae=1.0913, dsb=0.5745, bio=0.0000
    Epoch 10/10: total=1.6469, vae=1.0905, dsb=0.5564, bio=0.0000

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=34.3335, vae=1.0902, dsb=33.2433, bio=0.0000
    Epoch  2/10: total=33.2894, vae=1.0907, dsb=32.1987, bio=0.0000
    Epoch  3/10: total=33.2345, vae=1.0902, dsb=32.1443, bio=0.0000
    Epoch  4/10: total=33.0781, vae=1.0908, dsb=31.9873, bio=0.0000
    Epoch  5/10: total=32.9659, vae=1.0900, dsb=31.8759, bio=0.0000
    Epoch  6/10: total=32.7804, vae=1.0889, dsb=31.6915, bio=0.0000
    Epoch  7/10: total=32.9173, vae=1.0898, dsb=31.8275, bio=0.0000
    Epoch  8/10: total=32.9132, vae=1.0902, dsb=31.8230, bio=0.0000
    Epoch  9/10: total=32.7994, vae=1.0899, dsb=31.7095, bio=0.0000
    Epoch 10/10: total=32.5435, vae=1.0893, dsb=31.4541, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.5792, vae=1.0893, dsb=0.4899, bio=0.0000
    Epoch  2/10: total=1.5628, vae=1.0899, dsb=0.4729, bio=0.0000
    Epoch  3/10: total=1.5616, vae=1.0900, dsb=0.4716, bio=0.0000
    Epoch  4/10: total=1.5445, vae=1.0903, dsb=0.4542, bio=0.0000
    Epoch  5/10: total=1.5326, vae=1.0894, dsb=0.4432, bio=0.0000
    Epoch  6/10: total=1.5376, vae=1.0897, dsb=0.4479, bio=0.0000
    Epoch  7/10: total=1.5550, vae=1.0911, dsb=0.4640, bio=0.0000
    Epoch  8/10: total=1.5583, vae=1.0904, dsb=0.4679, bio=0.0000
    Epoch  9/10: total=1.5481, vae=1.0906, dsb=0.4574, bio=0.0000
    Epoch 10/10: total=1.5377, vae=1.0896, dsb=0.4481, bio=0.0000

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=28.7608, vae=1.0901, dsb=27.6706, bio=0.0000
    Epoch  2/10: total=28.5298, vae=1.0907, dsb=27.4392, bio=0.0000
    Epoch  3/10: total=28.1623, vae=1.0897, dsb=27.0726, bio=0.0000
    Epoch  4/10: total=28.1381, vae=1.0895, dsb=27.0486, bio=0.0000
    Epoch  5/10: total=28.1321, vae=1.0906, dsb=27.0415, bio=0.0000
    Epoch  6/10: total=28.1950, vae=1.0905, dsb=27.1046, bio=0.0000
    Epoch  7/10: total=28.1947, vae=1.0894, dsb=27.1053, bio=0.0000
    Epoch  8/10: total=28.2019, vae=1.0903, dsb=27.1116, bio=0.0000
    Epoch  9/10: total=27.9143, vae=1.0898, dsb=26.8245, bio=0.0000
    Epoch 10/10: total=28.0295, vae=1.0899, dsb=26.9396, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.4861, vae=1.0907, dsb=0.3954, bio=0.0000
    Epoch  2/10: total=1.4618, vae=1.0887, dsb=0.3730, bio=0.0000
    Epoch  3/10: total=1.4740, vae=1.0910, dsb=0.3830, bio=0.0000
    Epoch  4/10: total=1.4667, vae=1.0907, dsb=0.3759, bio=0.0000
    Epoch  5/10: total=1.4763, vae=1.0906, dsb=0.3857, bio=0.0000
    Epoch  6/10: total=1.4784, vae=1.0898, dsb=0.3886, bio=0.0000
    Epoch  7/10: total=1.4632, vae=1.0896, dsb=0.3736, bio=0.0000
    Epoch  8/10: total=1.4642, vae=1.0899, dsb=0.3743, bio=0.0000
    Epoch  9/10: total=1.4568, vae=1.0898, dsb=0.3671, bio=0.0000
    Epoch 10/10: total=1.4690, vae=1.0900, dsb=0.3790, bio=0.0000

[Seed 87] Joint training (ablation) complete; models and history saved.

[Seed 87] Drift genes saved in /home/yyuan/ICB_TCE/iter_results/run_087

[Seed 87] run finished.

================================================================================
[Seed 88] Starting running whole pipeline...
================================================================================

[Seed 88] Starting VAE pre-training...

    Epoch [01/20], Beta: 0.000, Average Loss: 535.2403
    Epoch [02/20], Beta: 0.000, Average Loss: 302.8087
    Epoch [03/20], Beta: 0.000, Average Loss: 269.3768
    Epoch [04/20], Beta: 0.000, Average Loss: 251.7793
    Epoch [05/20], Beta: 0.100, Average Loss: 245.8843
    Epoch [06/20], Beta: 0.200, Average Loss: 244.4315
    Epoch [07/20], Beta: 0.300, Average Loss: 244.8390
    Epoch [08/20], Beta: 0.400, Average Loss: 245.7104
    Epoch [09/20], Beta: 0.500, Average Loss: 246.7223
    Epoch [10/20], Beta: 0.600, Average Loss: 247.8678
    Epoch [11/20], Beta: 0.700, Average Loss: 249.1334
    Epoch [12/20], Beta: 0.800, Average Loss: 250.4681
    Epoch [13/20], Beta: 0.900, Average Loss: 251.7055
    Epoch [14/20], Beta: 1.000, Average Loss: 253.3188
    Epoch [15/20], Beta: 1.000, Average Loss: 252.8515
    Epoch [16/20], Beta: 1.000, Average Loss: 252.4977
    Epoch [17/20], Beta: 1.000, Average Loss: 252.1205
    Epoch [18/20], Beta: 1.000, Average Loss: 251.8136
    Epoch [19/20], Beta: 1.000, Average Loss: 251.4356
    Epoch [20/20], Beta: 1.000, Average Loss: 251.2894

[Seed 88] VAE pre-training complete.

[Seed 88] Starting joint training (original)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=363.9885, vae=3.6528, dsb=341.1306, bio=38.4100
    Epoch  2/10: total=99.7352, vae=1.1045, dsb=98.5963, bio=0.0688
    Epoch  3/10: total=87.1643, vae=1.1004, dsb=86.0486, bio=0.0305
    Epoch  4/10: total=81.1776, vae=1.0994, dsb=80.0691, bio=0.0183
    Epoch  5/10: total=77.7185, vae=1.0982, dsb=76.6141, bio=0.0123
    Epoch  6/10: total=74.8775, vae=1.0959, dsb=73.7771, bio=0.0090
    Epoch  7/10: total=73.6534, vae=1.0969, dsb=72.5529, bio=0.0070
    Epoch  8/10: total=72.4156, vae=1.0958, dsb=71.3169, bio=0.0057
    Epoch  9/10: total=71.4004, vae=1.0958, dsb=70.3021, bio=0.0049
    Epoch 10/10: total=70.7584, vae=1.0954, dsb=69.6609, bio=0.0044

  [Backward Policy Training]
    Epoch  1/10: total=3.3988, vae=1.0965, dsb=2.2961, bio=0.0123
    Epoch  2/10: total=2.8952, vae=1.0947, dsb=1.7981, bio=0.0047
    Epoch  3/10: total=2.7203, vae=1.0941, dsb=1.6245, bio=0.0035
    Epoch  4/10: total=2.6627, vae=1.0952, dsb=1.5660, bio=0.0029
    Epoch  5/10: total=2.6112, vae=1.0939, dsb=1.5160, bio=0.0027
    Epoch  6/10: total=2.5774, vae=1.0937, dsb=1.4825, bio=0.0024
    Epoch  7/10: total=2.5662, vae=1.0937, dsb=1.4713, bio=0.0023
    Epoch  8/10: total=2.5339, vae=1.0935, dsb=1.4393, bio=0.0023
    Epoch  9/10: total=2.4669, vae=1.0938, dsb=1.3720, bio=0.0021
    Epoch 10/10: total=2.4483, vae=1.0934, dsb=1.3539, bio=0.0021

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=61.5417, vae=1.0960, dsb=60.4440, bio=0.0035
    Epoch  2/10: total=54.6737, vae=1.0946, dsb=53.5781, bio=0.0021
    Epoch  3/10: total=52.8938, vae=1.0953, dsb=51.7973, bio=0.0023
    Epoch  4/10: total=51.7511, vae=1.0948, dsb=50.6555, bio=0.0018
    Epoch  5/10: total=51.4314, vae=1.0947, dsb=50.3357, bio=0.0021
    Epoch  6/10: total=50.8544, vae=1.0941, dsb=49.7593, bio=0.0020
    Epoch  7/10: total=50.3988, vae=1.0943, dsb=49.3035, bio=0.0020
    Epoch  8/10: total=50.2219, vae=1.0944, dsb=49.1264, bio=0.0020
    Epoch  9/10: total=49.6286, vae=1.0936, dsb=48.5340, bio=0.0020
    Epoch 10/10: total=49.5488, vae=1.0933, dsb=48.4545, bio=0.0020

  [Backward Policy Training]
    Epoch  1/10: total=2.2101, vae=1.0944, dsb=1.1131, bio=0.0052
    Epoch  2/10: total=2.0999, vae=1.0924, dsb=1.0065, bio=0.0021
    Epoch  3/10: total=2.0475, vae=1.0925, dsb=0.9541, bio=0.0019
    Epoch  4/10: total=2.0227, vae=1.0932, dsb=0.9286, bio=0.0019
    Epoch  5/10: total=2.0145, vae=1.0927, dsb=0.9209, bio=0.0018
    Epoch  6/10: total=1.9988, vae=1.0928, dsb=0.9050, bio=0.0018
    Epoch  7/10: total=1.9895, vae=1.0926, dsb=0.8958, bio=0.0023
    Epoch  8/10: total=2.0140, vae=1.0922, dsb=0.9209, bio=0.0017
    Epoch  9/10: total=1.9776, vae=1.0922, dsb=0.8845, bio=0.0018
    Epoch 10/10: total=1.9711, vae=1.0927, dsb=0.8775, bio=0.0017

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=45.1561, vae=1.0957, dsb=44.0586, bio=0.0035
    Epoch  2/10: total=42.6777, vae=1.0930, dsb=41.5838, bio=0.0018
    Epoch  3/10: total=41.7271, vae=1.0939, dsb=40.6323, bio=0.0018
    Epoch  4/10: total=41.2860, vae=1.0940, dsb=40.1910, bio=0.0020
    Epoch  5/10: total=41.2233, vae=1.0939, dsb=40.1285, bio=0.0018
    Epoch  6/10: total=40.9948, vae=1.0943, dsb=39.8996, bio=0.0018
    Epoch  7/10: total=40.8692, vae=1.0935, dsb=39.7748, bio=0.0018
    Epoch  8/10: total=40.6327, vae=1.0931, dsb=39.5387, bio=0.0018
    Epoch  9/10: total=40.7443, vae=1.0929, dsb=39.6504, bio=0.0021
    Epoch 10/10: total=40.5369, vae=1.0931, dsb=39.4427, bio=0.0021

  [Backward Policy Training]
    Epoch  1/10: total=1.8871, vae=1.0950, dsb=0.7896, bio=0.0050
    Epoch  2/10: total=1.8074, vae=1.0927, dsb=0.7138, bio=0.0018
    Epoch  3/10: total=1.7823, vae=1.0920, dsb=0.6895, bio=0.0017
    Epoch  4/10: total=1.7683, vae=1.0924, dsb=0.6751, bio=0.0016
    Epoch  5/10: total=1.7814, vae=1.0916, dsb=0.6890, bio=0.0016
    Epoch  6/10: total=1.8028, vae=1.0921, dsb=0.7099, bio=0.0016
    Epoch  7/10: total=1.7592, vae=1.0926, dsb=0.6657, bio=0.0019
    Epoch  8/10: total=1.7634, vae=1.0927, dsb=0.6700, bio=0.0015
    Epoch  9/10: total=1.7583, vae=1.0915, dsb=0.6661, bio=0.0015
    Epoch 10/10: total=1.7642, vae=1.0923, dsb=0.6711, bio=0.0015

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=36.9059, vae=1.0947, dsb=35.8097, bio=0.0029
    Epoch  2/10: total=35.9131, vae=1.0934, dsb=34.8189, bio=0.0016
    Epoch  3/10: total=35.5049, vae=1.0930, dsb=34.4111, bio=0.0016
    Epoch  4/10: total=35.5423, vae=1.0922, dsb=34.4491, bio=0.0021
    Epoch  5/10: total=35.3393, vae=1.0923, dsb=34.2462, bio=0.0016
    Epoch  6/10: total=35.2401, vae=1.0931, dsb=34.1462, bio=0.0016
    Epoch  7/10: total=35.2074, vae=1.0923, dsb=34.1143, bio=0.0016
    Epoch  8/10: total=35.1967, vae=1.0925, dsb=34.1033, bio=0.0017
    Epoch  9/10: total=35.2199, vae=1.0930, dsb=34.1263, bio=0.0013
    Epoch 10/10: total=34.8884, vae=1.0929, dsb=33.7945, bio=0.0021

  [Backward Policy Training]
    Epoch  1/10: total=1.7042, vae=1.0947, dsb=0.6060, bio=0.0071
    Epoch  2/10: total=1.6463, vae=1.0921, dsb=0.5534, bio=0.0016
    Epoch  3/10: total=1.6632, vae=1.0917, dsb=0.5708, bio=0.0015
    Epoch  4/10: total=1.6408, vae=1.0915, dsb=0.5486, bio=0.0015
    Epoch  5/10: total=1.6496, vae=1.0912, dsb=0.5578, bio=0.0014
    Epoch  6/10: total=1.6510, vae=1.0918, dsb=0.5582, bio=0.0020
    Epoch  7/10: total=1.6416, vae=1.0908, dsb=0.5501, bio=0.0014
    Epoch  8/10: total=1.6386, vae=1.0917, dsb=0.5463, bio=0.0013
    Epoch  9/10: total=1.6325, vae=1.0915, dsb=0.5404, bio=0.0013
    Epoch 10/10: total=1.6215, vae=1.0923, dsb=0.5286, bio=0.0014

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=31.2677, vae=1.0949, dsb=30.1714, bio=0.0029
    Epoch  2/10: total=30.5866, vae=1.0927, dsb=29.4931, bio=0.0015
    Epoch  3/10: total=30.5990, vae=1.0931, dsb=29.5052, bio=0.0016
    Epoch  4/10: total=30.5501, vae=1.0920, dsb=29.4573, bio=0.0016
    Epoch  5/10: total=30.2974, vae=1.0933, dsb=29.2034, bio=0.0015
    Epoch  6/10: total=30.4378, vae=1.0924, dsb=29.3447, bio=0.0015
    Epoch  7/10: total=30.4012, vae=1.0920, dsb=29.3084, bio=0.0015
    Epoch  8/10: total=30.2335, vae=1.0928, dsb=29.1400, bio=0.0016
    Epoch  9/10: total=30.3086, vae=1.0918, dsb=29.2160, bio=0.0015
    Epoch 10/10: total=30.2864, vae=1.0925, dsb=29.1931, bio=0.0016

  [Backward Policy Training]
    Epoch  1/10: total=1.6017, vae=1.0921, dsb=0.4963, bio=0.0266
    Epoch  2/10: total=1.5818, vae=1.0919, dsb=0.4892, bio=0.0014
    Epoch  3/10: total=1.5931, vae=1.0913, dsb=0.5011, bio=0.0013
    Epoch  4/10: total=1.5634, vae=1.0910, dsb=0.4718, bio=0.0013
    Epoch  5/10: total=1.5805, vae=1.0924, dsb=0.4875, bio=0.0013
    Epoch  6/10: total=1.5718, vae=1.0911, dsb=0.4800, bio=0.0014
    Epoch  7/10: total=1.5720, vae=1.0913, dsb=0.4801, bio=0.0012
    Epoch  8/10: total=1.5503, vae=1.0916, dsb=0.4580, bio=0.0012
    Epoch  9/10: total=1.5679, vae=1.0910, dsb=0.4763, bio=0.0013
    Epoch 10/10: total=1.5760, vae=1.0916, dsb=0.4838, bio=0.0013

[Seed 88] Joint training (original) complete; models and history saved.

[Seed 88] Starting joint training (ablation)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=342.5711, vae=2.0184, dsb=340.5527, bio=0.0000
    Epoch  2/10: total=99.1022, vae=1.0879, dsb=98.0143, bio=0.0000
    Epoch  3/10: total=86.8787, vae=1.0863, dsb=85.7924, bio=0.0000
    Epoch  4/10: total=80.7616, vae=1.0861, dsb=79.6755, bio=0.0000
    Epoch  5/10: total=77.3026, vae=1.0852, dsb=76.2173, bio=0.0000
    Epoch  6/10: total=74.4815, vae=1.0833, dsb=73.3982, bio=0.0000
    Epoch  7/10: total=73.2388, vae=1.0846, dsb=72.1542, bio=0.0000
    Epoch  8/10: total=71.9397, vae=1.0838, dsb=70.8559, bio=0.0000
    Epoch  9/10: total=70.8885, vae=1.0840, dsb=69.8045, bio=0.0000
    Epoch 10/10: total=70.2078, vae=1.0838, dsb=69.1239, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=3.2852, vae=1.0842, dsb=2.2010, bio=0.0000
    Epoch  2/10: total=2.8082, vae=1.0839, dsb=1.7243, bio=0.0000
    Epoch  3/10: total=2.6431, vae=1.0837, dsb=1.5594, bio=0.0000
    Epoch  4/10: total=2.5880, vae=1.0851, dsb=1.5030, bio=0.0000
    Epoch  5/10: total=2.5377, vae=1.0839, dsb=1.4537, bio=0.0000
    Epoch  6/10: total=2.5032, vae=1.0839, dsb=1.4192, bio=0.0000
    Epoch  7/10: total=2.4919, vae=1.0840, dsb=1.4080, bio=0.0000
    Epoch  8/10: total=2.4601, vae=1.0839, dsb=1.3762, bio=0.0000
    Epoch  9/10: total=2.3968, vae=1.0843, dsb=1.3124, bio=0.0000
    Epoch 10/10: total=2.3785, vae=1.0840, dsb=1.2945, bio=0.0000

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=62.6285, vae=1.0839, dsb=61.5446, bio=0.0000
    Epoch  2/10: total=55.7597, vae=1.0836, dsb=54.6761, bio=0.0000
    Epoch  3/10: total=53.9263, vae=1.0846, dsb=52.8417, bio=0.0000
    Epoch  4/10: total=52.8577, vae=1.0842, dsb=51.7735, bio=0.0000
    Epoch  5/10: total=52.5564, vae=1.0843, dsb=51.4720, bio=0.0000
    Epoch  6/10: total=52.0205, vae=1.0837, dsb=50.9368, bio=0.0000
    Epoch  7/10: total=51.5693, vae=1.0840, dsb=50.4853, bio=0.0000
    Epoch  8/10: total=51.4528, vae=1.0842, dsb=50.3686, bio=0.0000
    Epoch  9/10: total=50.7989, vae=1.0834, dsb=49.7156, bio=0.0000
    Epoch 10/10: total=50.7573, vae=1.0831, dsb=49.6742, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=2.1271, vae=1.0839, dsb=1.0432, bio=0.0000
    Epoch  2/10: total=2.0281, vae=1.0833, dsb=0.9448, bio=0.0000
    Epoch  3/10: total=1.9796, vae=1.0835, dsb=0.8961, bio=0.0000
    Epoch  4/10: total=1.9562, vae=1.0843, dsb=0.8719, bio=0.0000
    Epoch  5/10: total=1.9493, vae=1.0839, dsb=0.8654, bio=0.0000
    Epoch  6/10: total=1.9347, vae=1.0841, dsb=0.8507, bio=0.0000
    Epoch  7/10: total=1.9245, vae=1.0837, dsb=0.8407, bio=0.0000
    Epoch  8/10: total=1.9484, vae=1.0835, dsb=0.8649, bio=0.0000
    Epoch  9/10: total=1.9142, vae=1.0836, dsb=0.8306, bio=0.0000
    Epoch 10/10: total=1.9072, vae=1.0841, dsb=0.8231, bio=0.0000

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=46.4305, vae=1.0838, dsb=45.3467, bio=0.0000
    Epoch  2/10: total=44.1571, vae=1.0829, dsb=43.0742, bio=0.0000
    Epoch  3/10: total=43.2558, vae=1.0839, dsb=42.1719, bio=0.0000
    Epoch  4/10: total=42.7742, vae=1.0841, dsb=41.6901, bio=0.0000
    Epoch  5/10: total=42.7987, vae=1.0841, dsb=41.7146, bio=0.0000
    Epoch  6/10: total=42.5624, vae=1.0846, dsb=41.4778, bio=0.0000
    Epoch  7/10: total=42.4574, vae=1.0838, dsb=41.3736, bio=0.0000
    Epoch  8/10: total=42.2309, vae=1.0835, dsb=41.1474, bio=0.0000
    Epoch  9/10: total=42.3694, vae=1.0832, dsb=41.2862, bio=0.0000
    Epoch 10/10: total=42.1550, vae=1.0836, dsb=41.0714, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.8155, vae=1.0847, dsb=0.7308, bio=0.0000
    Epoch  2/10: total=1.7482, vae=1.0842, dsb=0.6641, bio=0.0000
    Epoch  3/10: total=1.7252, vae=1.0835, dsb=0.6417, bio=0.0000
    Epoch  4/10: total=1.7124, vae=1.0841, dsb=0.6283, bio=0.0000
    Epoch  5/10: total=1.7264, vae=1.0834, dsb=0.6430, bio=0.0000
    Epoch  6/10: total=1.7470, vae=1.0838, dsb=0.6632, bio=0.0000
    Epoch  7/10: total=1.7054, vae=1.0843, dsb=0.6211, bio=0.0000
    Epoch  8/10: total=1.7103, vae=1.0846, dsb=0.6257, bio=0.0000
    Epoch  9/10: total=1.7047, vae=1.0834, dsb=0.6214, bio=0.0000
    Epoch 10/10: total=1.7106, vae=1.0842, dsb=0.6264, bio=0.0000

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=37.2878, vae=1.0840, dsb=36.2038, bio=0.0000
    Epoch  2/10: total=36.5696, vae=1.0838, dsb=35.4857, bio=0.0000
    Epoch  3/10: total=36.2111, vae=1.0836, dsb=35.1275, bio=0.0000
    Epoch  4/10: total=36.3546, vae=1.0828, dsb=35.2718, bio=0.0000
    Epoch  5/10: total=36.2124, vae=1.0831, dsb=35.1293, bio=0.0000
    Epoch  6/10: total=36.1144, vae=1.0839, dsb=35.0305, bio=0.0000
    Epoch  7/10: total=36.1013, vae=1.0832, dsb=35.0181, bio=0.0000
    Epoch  8/10: total=36.0899, vae=1.0835, dsb=35.0064, bio=0.0000
    Epoch  9/10: total=36.1305, vae=1.0840, dsb=35.0466, bio=0.0000
    Epoch 10/10: total=35.7776, vae=1.0839, dsb=34.6937, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.6382, vae=1.0852, dsb=0.5529, bio=0.0000
    Epoch  2/10: total=1.5914, vae=1.0840, dsb=0.5073, bio=0.0000
    Epoch  3/10: total=1.6085, vae=1.0837, dsb=0.5248, bio=0.0000
    Epoch  4/10: total=1.5882, vae=1.0835, dsb=0.5047, bio=0.0000
    Epoch  5/10: total=1.5970, vae=1.0832, dsb=0.5138, bio=0.0000
    Epoch  6/10: total=1.5986, vae=1.0839, dsb=0.5147, bio=0.0000
    Epoch  7/10: total=1.5910, vae=1.0830, dsb=0.5080, bio=0.0000
    Epoch  8/10: total=1.5883, vae=1.0838, dsb=0.5045, bio=0.0000
    Epoch  9/10: total=1.5827, vae=1.0837, dsb=0.4990, bio=0.0000
    Epoch 10/10: total=1.5727, vae=1.0845, dsb=0.4882, bio=0.0000

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=31.0440, vae=1.0841, dsb=29.9599, bio=0.0000
    Epoch  2/10: total=30.5617, vae=1.0835, dsb=29.4782, bio=0.0000
    Epoch  3/10: total=30.5952, vae=1.0841, dsb=29.5110, bio=0.0000
    Epoch  4/10: total=30.5863, vae=1.0832, dsb=29.5031, bio=0.0000
    Epoch  5/10: total=30.3091, vae=1.0846, dsb=29.2245, bio=0.0000
    Epoch  6/10: total=30.4696, vae=1.0837, dsb=29.3859, bio=0.0000
    Epoch  7/10: total=30.4606, vae=1.0834, dsb=29.3772, bio=0.0000
    Epoch  8/10: total=30.2899, vae=1.0842, dsb=29.2057, bio=0.0000
    Epoch  9/10: total=30.3599, vae=1.0832, dsb=29.2767, bio=0.0000
    Epoch 10/10: total=30.3626, vae=1.0839, dsb=29.2786, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.5332, vae=1.0834, dsb=0.4498, bio=0.0000
    Epoch  2/10: total=1.5308, vae=1.0839, dsb=0.4469, bio=0.0000
    Epoch  3/10: total=1.5428, vae=1.0834, dsb=0.4594, bio=0.0000
    Epoch  4/10: total=1.5157, vae=1.0832, dsb=0.4325, bio=0.0000
    Epoch  5/10: total=1.5328, vae=1.0846, dsb=0.4482, bio=0.0000
    Epoch  6/10: total=1.5247, vae=1.0834, dsb=0.4412, bio=0.0000
    Epoch  7/10: total=1.5255, vae=1.0837, dsb=0.4417, bio=0.0000
    Epoch  8/10: total=1.5048, vae=1.0840, dsb=0.4208, bio=0.0000
    Epoch  9/10: total=1.5219, vae=1.0834, dsb=0.4385, bio=0.0000
    Epoch 10/10: total=1.5301, vae=1.0841, dsb=0.4460, bio=0.0000

[Seed 88] Joint training (ablation) complete; models and history saved.

[Seed 88] Drift genes saved in /home/yyuan/ICB_TCE/iter_results/run_088

[Seed 88] run finished.

================================================================================
[Seed 89] Starting running whole pipeline...
================================================================================

[Seed 89] Starting VAE pre-training...

    Epoch [01/20], Beta: 0.000, Average Loss: 536.1386
    Epoch [02/20], Beta: 0.000, Average Loss: 308.8997
    Epoch [03/20], Beta: 0.000, Average Loss: 267.7002
    Epoch [04/20], Beta: 0.000, Average Loss: 249.0244
    Epoch [05/20], Beta: 0.100, Average Loss: 245.1710
    Epoch [06/20], Beta: 0.200, Average Loss: 244.9183
    Epoch [07/20], Beta: 0.300, Average Loss: 245.3283
    Epoch [08/20], Beta: 0.400, Average Loss: 246.0516
    Epoch [09/20], Beta: 0.500, Average Loss: 246.9997
    Epoch [10/20], Beta: 0.600, Average Loss: 248.1312
    Epoch [11/20], Beta: 0.700, Average Loss: 249.3656
    Epoch [12/20], Beta: 0.800, Average Loss: 250.5951
    Epoch [13/20], Beta: 0.900, Average Loss: 251.8314
    Epoch [14/20], Beta: 1.000, Average Loss: 253.4018
    Epoch [15/20], Beta: 1.000, Average Loss: 253.0018
    Epoch [16/20], Beta: 1.000, Average Loss: 252.6145
    Epoch [17/20], Beta: 1.000, Average Loss: 252.2779
    Epoch [18/20], Beta: 1.000, Average Loss: 251.9838
    Epoch [19/20], Beta: 1.000, Average Loss: 251.6206
    Epoch [20/20], Beta: 1.000, Average Loss: 251.4506

[Seed 89] VAE pre-training complete.

[Seed 89] Starting joint training (original)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=242.8455, vae=3.6485, dsb=221.3561, bio=35.6815
    Epoch  2/10: total=70.1983, vae=1.1059, dsb=69.0507, bio=0.0834
    Epoch  3/10: total=59.3392, vae=1.1016, dsb=58.2209, bio=0.0333
    Epoch  4/10: total=54.1111, vae=1.1002, dsb=53.0015, bio=0.0187
    Epoch  5/10: total=50.9382, vae=1.0988, dsb=49.8331, bio=0.0124
    Epoch  6/10: total=48.7642, vae=1.0985, dsb=47.6611, bio=0.0091
    Epoch  7/10: total=47.3886, vae=1.0979, dsb=46.2873, bio=0.0069
    Epoch  8/10: total=45.9172, vae=1.0978, dsb=44.8165, bio=0.0057
    Epoch  9/10: total=44.9465, vae=1.0981, dsb=43.8461, bio=0.0047
    Epoch 10/10: total=44.2758, vae=1.0978, dsb=43.1761, bio=0.0040

  [Backward Policy Training]
    Epoch  1/10: total=3.2085, vae=1.0985, dsb=2.1042, bio=0.0114
    Epoch  2/10: total=2.7407, vae=1.0961, dsb=1.6426, bio=0.0039
    Epoch  3/10: total=2.5956, vae=1.0958, dsb=1.4984, bio=0.0029
    Epoch  4/10: total=2.5149, vae=1.0953, dsb=1.4184, bio=0.0025
    Epoch  5/10: total=2.4835, vae=1.0965, dsb=1.3859, bio=0.0022
    Epoch  6/10: total=2.3928, vae=1.0957, dsb=1.2958, bio=0.0025
    Epoch  7/10: total=2.4026, vae=1.0950, dsb=1.3066, bio=0.0020
    Epoch  8/10: total=2.3690, vae=1.0948, dsb=1.2731, bio=0.0020
    Epoch  9/10: total=2.3346, vae=1.0948, dsb=1.2389, bio=0.0019
    Epoch 10/10: total=2.3619, vae=1.0941, dsb=1.2669, bio=0.0018

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=45.1371, vae=1.0971, dsb=44.0382, bio=0.0035
    Epoch  2/10: total=37.6021, vae=1.0960, dsb=36.5051, bio=0.0019
    Epoch  3/10: total=35.7188, vae=1.0955, dsb=34.6224, bio=0.0018
    Epoch  4/10: total=34.5890, vae=1.0954, dsb=33.4927, bio=0.0018
    Epoch  5/10: total=33.9123, vae=1.0960, dsb=32.8153, bio=0.0018
    Epoch  6/10: total=33.3640, vae=1.0942, dsb=32.2689, bio=0.0018
    Epoch  7/10: total=33.1412, vae=1.0948, dsb=32.0454, bio=0.0019
    Epoch  8/10: total=32.9633, vae=1.0954, dsb=31.8670, bio=0.0018
    Epoch  9/10: total=32.6324, vae=1.0948, dsb=31.5367, bio=0.0018
    Epoch 10/10: total=32.5365, vae=1.0956, dsb=31.4400, bio=0.0018

  [Backward Policy Training]
    Epoch  1/10: total=2.1122, vae=1.0963, dsb=1.0125, bio=0.0068
    Epoch  2/10: total=1.9798, vae=1.0939, dsb=0.8850, bio=0.0018
    Epoch  3/10: total=1.9349, vae=1.0945, dsb=0.8396, bio=0.0017
    Epoch  4/10: total=1.9187, vae=1.0932, dsb=0.8247, bio=0.0016
    Epoch  5/10: total=1.9223, vae=1.0933, dsb=0.8283, bio=0.0015
    Epoch  6/10: total=1.8866, vae=1.0934, dsb=0.7925, bio=0.0015
    Epoch  7/10: total=1.8661, vae=1.0943, dsb=0.7711, bio=0.0015
    Epoch  8/10: total=1.8578, vae=1.0931, dsb=0.7640, bio=0.0015
    Epoch  9/10: total=1.8894, vae=1.0930, dsb=0.7957, bio=0.0014
    Epoch 10/10: total=1.8735, vae=1.0937, dsb=0.7791, bio=0.0014

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=32.0978, vae=1.0960, dsb=31.0003, bio=0.0029
    Epoch  2/10: total=28.9238, vae=1.0951, dsb=27.8280, bio=0.0015
    Epoch  3/10: total=28.1901, vae=1.0951, dsb=27.0943, bio=0.0015
    Epoch  4/10: total=27.6264, vae=1.0939, dsb=26.5318, bio=0.0015
    Epoch  5/10: total=27.5366, vae=1.0942, dsb=26.4417, bio=0.0015
    Epoch  6/10: total=27.2735, vae=1.0946, dsb=26.1783, bio=0.0014
    Epoch  7/10: total=27.1180, vae=1.0937, dsb=26.0234, bio=0.0017
    Epoch  8/10: total=27.0050, vae=1.0939, dsb=25.9103, bio=0.0015
    Epoch  9/10: total=26.7749, vae=1.0930, dsb=25.6812, bio=0.0015
    Epoch 10/10: total=26.7026, vae=1.0936, dsb=25.6083, bio=0.0015

  [Backward Policy Training]
    Epoch  1/10: total=1.7909, vae=1.0951, dsb=0.6747, bio=0.0421
    Epoch  2/10: total=1.7045, vae=1.0927, dsb=0.6110, bio=0.0015
    Epoch  3/10: total=1.7124, vae=1.0928, dsb=0.6189, bio=0.0014
    Epoch  4/10: total=1.6909, vae=1.0933, dsb=0.5969, bio=0.0013
    Epoch  5/10: total=1.6665, vae=1.0932, dsb=0.5726, bio=0.0013
    Epoch  6/10: total=1.6558, vae=1.0929, dsb=0.5622, bio=0.0013
    Epoch  7/10: total=1.6570, vae=1.0929, dsb=0.5635, bio=0.0013
    Epoch  8/10: total=1.6539, vae=1.0919, dsb=0.5615, bio=0.0012
    Epoch  9/10: total=1.6373, vae=1.0921, dsb=0.5445, bio=0.0012
    Epoch 10/10: total=1.6502, vae=1.0919, dsb=0.5578, bio=0.0012

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=25.5317, vae=1.0954, dsb=24.4344, bio=0.0040
    Epoch  2/10: total=23.8361, vae=1.0940, dsb=22.7414, bio=0.0015
    Epoch  3/10: total=23.6014, vae=1.0938, dsb=22.5069, bio=0.0014
    Epoch  4/10: total=23.3435, vae=1.0933, dsb=22.2495, bio=0.0014
    Epoch  5/10: total=23.2720, vae=1.0944, dsb=22.1770, bio=0.0013
    Epoch  6/10: total=23.1561, vae=1.0922, dsb=22.0632, bio=0.0013
    Epoch  7/10: total=23.1772, vae=1.0933, dsb=22.0830, bio=0.0017
    Epoch  8/10: total=23.0713, vae=1.0936, dsb=21.9770, bio=0.0013
    Epoch  9/10: total=22.9262, vae=1.0934, dsb=21.8322, bio=0.0012
    Epoch 10/10: total=22.9437, vae=1.0923, dsb=21.8508, bio=0.0012

  [Backward Policy Training]
    Epoch  1/10: total=1.6294, vae=1.0935, dsb=0.4986, bio=0.0745
    Epoch  2/10: total=1.5566, vae=1.0920, dsb=0.4640, bio=0.0014
    Epoch  3/10: total=1.5483, vae=1.0931, dsb=0.4546, bio=0.0011
    Epoch  4/10: total=1.5523, vae=1.0921, dsb=0.4596, bio=0.0012
    Epoch  5/10: total=1.5420, vae=1.0930, dsb=0.4484, bio=0.0011
    Epoch  6/10: total=1.5388, vae=1.0924, dsb=0.4458, bio=0.0011
    Epoch  7/10: total=1.5431, vae=1.0927, dsb=0.4498, bio=0.0011
    Epoch  8/10: total=1.5230, vae=1.0922, dsb=0.4302, bio=0.0011
    Epoch  9/10: total=1.5302, vae=1.0930, dsb=0.4366, bio=0.0011
    Epoch 10/10: total=1.5295, vae=1.0917, dsb=0.4373, bio=0.0010

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=20.7361, vae=1.0951, dsb=19.6384, bio=0.0052
    Epoch  2/10: total=20.3086, vae=1.0934, dsb=19.2145, bio=0.0013
    Epoch  3/10: total=20.0685, vae=1.0932, dsb=18.9747, bio=0.0013
    Epoch  4/10: total=20.0632, vae=1.0940, dsb=18.9686, bio=0.0012
    Epoch  5/10: total=20.0422, vae=1.0933, dsb=18.9483, bio=0.0012
    Epoch  6/10: total=20.0143, vae=1.0932, dsb=18.9205, bio=0.0012
    Epoch  7/10: total=19.8458, vae=1.0932, dsb=18.7520, bio=0.0012
    Epoch  8/10: total=19.9057, vae=1.0935, dsb=18.8117, bio=0.0011
    Epoch  9/10: total=19.8805, vae=1.0930, dsb=18.7869, bio=0.0011
    Epoch 10/10: total=19.9808, vae=1.0923, dsb=18.8879, bio=0.0011

  [Backward Policy Training]
    Epoch  1/10: total=1.5407, vae=1.0939, dsb=0.3832, bio=0.1273
    Epoch  2/10: total=1.4606, vae=1.0933, dsb=0.3668, bio=0.0010
    Epoch  3/10: total=1.4584, vae=1.0925, dsb=0.3653, bio=0.0012
    Epoch  4/10: total=1.4497, vae=1.0931, dsb=0.3561, bio=0.0010
    Epoch  5/10: total=1.4604, vae=1.0927, dsb=0.3672, bio=0.0010
    Epoch  6/10: total=1.4518, vae=1.0934, dsb=0.3579, bio=0.0010
    Epoch  7/10: total=1.4559, vae=1.0916, dsb=0.3639, bio=0.0008
    Epoch  8/10: total=1.4584, vae=1.0915, dsb=0.3664, bio=0.0010
    Epoch  9/10: total=1.4571, vae=1.0924, dsb=0.3642, bio=0.0010
    Epoch 10/10: total=1.4511, vae=1.0909, dsb=0.3598, bio=0.0008

[Seed 89] Joint training (original) complete; models and history saved.

[Seed 89] Starting joint training (ablation)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=222.8629, vae=1.9822, dsb=220.8807, bio=0.0000
    Epoch  2/10: total=69.7112, vae=1.0888, dsb=68.6225, bio=0.0000
    Epoch  3/10: total=58.8692, vae=1.0871, dsb=57.7821, bio=0.0000
    Epoch  4/10: total=53.7403, vae=1.0867, dsb=52.6536, bio=0.0000
    Epoch  5/10: total=50.6922, vae=1.0856, dsb=49.6066, bio=0.0000
    Epoch  6/10: total=48.5880, vae=1.0856, dsb=47.5024, bio=0.0000
    Epoch  7/10: total=47.2229, vae=1.0853, dsb=46.1376, bio=0.0000
    Epoch  8/10: total=45.7876, vae=1.0855, dsb=44.7021, bio=0.0000
    Epoch  9/10: total=44.8645, vae=1.0861, dsb=43.7784, bio=0.0000
    Epoch 10/10: total=44.1599, vae=1.0860, dsb=43.0738, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=3.1485, vae=1.0859, dsb=2.0626, bio=0.0000
    Epoch  2/10: total=2.6937, vae=1.0851, dsb=1.6086, bio=0.0000
    Epoch  3/10: total=2.5553, vae=1.0854, dsb=1.4699, bio=0.0000
    Epoch  4/10: total=2.4797, vae=1.0851, dsb=1.3946, bio=0.0000
    Epoch  5/10: total=2.4502, vae=1.0865, dsb=1.3637, bio=0.0000
    Epoch  6/10: total=2.3623, vae=1.0859, dsb=1.2764, bio=0.0000
    Epoch  7/10: total=2.3742, vae=1.0854, dsb=1.2888, bio=0.0000
    Epoch  8/10: total=2.3416, vae=1.0853, dsb=1.2563, bio=0.0000
    Epoch  9/10: total=2.3082, vae=1.0854, dsb=1.2228, bio=0.0000
    Epoch 10/10: total=2.3369, vae=1.0847, dsb=1.2523, bio=0.0000

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=44.6698, vae=1.0849, dsb=43.5849, bio=0.0000
    Epoch  2/10: total=37.2949, vae=1.0852, dsb=36.2097, bio=0.0000
    Epoch  3/10: total=35.5036, vae=1.0849, dsb=34.4187, bio=0.0000
    Epoch  4/10: total=34.3675, vae=1.0850, dsb=33.2825, bio=0.0000
    Epoch  5/10: total=33.7520, vae=1.0857, dsb=32.6663, bio=0.0000
    Epoch  6/10: total=33.1939, vae=1.0841, dsb=32.1098, bio=0.0000
    Epoch  7/10: total=32.9959, vae=1.0848, dsb=31.9112, bio=0.0000
    Epoch  8/10: total=32.8125, vae=1.0855, dsb=31.7271, bio=0.0000
    Epoch  9/10: total=32.4993, vae=1.0850, dsb=31.4144, bio=0.0000
    Epoch 10/10: total=32.3696, vae=1.0859, dsb=31.2837, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=2.0849, vae=1.0857, dsb=0.9993, bio=0.0000
    Epoch  2/10: total=1.9574, vae=1.0850, dsb=0.8725, bio=0.0000
    Epoch  3/10: total=1.9139, vae=1.0858, dsb=0.8281, bio=0.0000
    Epoch  4/10: total=1.8968, vae=1.0845, dsb=0.8123, bio=0.0000
    Epoch  5/10: total=1.9004, vae=1.0847, dsb=0.8157, bio=0.0000
    Epoch  6/10: total=1.8656, vae=1.0849, dsb=0.7807, bio=0.0000
    Epoch  7/10: total=1.8459, vae=1.0859, dsb=0.7600, bio=0.0000
    Epoch  8/10: total=1.8383, vae=1.0847, dsb=0.7536, bio=0.0000
    Epoch  9/10: total=1.8695, vae=1.0848, dsb=0.7847, bio=0.0000
    Epoch 10/10: total=1.8539, vae=1.0855, dsb=0.7684, bio=0.0000

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=31.9113, vae=1.0852, dsb=30.8261, bio=0.0000
    Epoch  2/10: total=28.7646, vae=1.0855, dsb=27.6792, bio=0.0000
    Epoch  3/10: total=28.0486, vae=1.0857, dsb=26.9630, bio=0.0000
    Epoch  4/10: total=27.5189, vae=1.0847, dsb=26.4342, bio=0.0000
    Epoch  5/10: total=27.4455, vae=1.0851, dsb=26.3604, bio=0.0000
    Epoch  6/10: total=27.1628, vae=1.0855, dsb=26.0773, bio=0.0000
    Epoch  7/10: total=27.0159, vae=1.0849, dsb=25.9311, bio=0.0000
    Epoch  8/10: total=26.9215, vae=1.0852, dsb=25.8363, bio=0.0000
    Epoch  9/10: total=26.7018, vae=1.0843, dsb=25.6175, bio=0.0000
    Epoch 10/10: total=26.6136, vae=1.0850, dsb=25.5287, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.7545, vae=1.0859, dsb=0.6687, bio=0.0000
    Epoch  2/10: total=1.6904, vae=1.0846, dsb=0.6057, bio=0.0000
    Epoch  3/10: total=1.6976, vae=1.0849, dsb=0.6128, bio=0.0000
    Epoch  4/10: total=1.6758, vae=1.0855, dsb=0.5903, bio=0.0000
    Epoch  5/10: total=1.6511, vae=1.0855, dsb=0.5657, bio=0.0000
    Epoch  6/10: total=1.6402, vae=1.0851, dsb=0.5550, bio=0.0000
    Epoch  7/10: total=1.6416, vae=1.0854, dsb=0.5563, bio=0.0000
    Epoch  8/10: total=1.6388, vae=1.0844, dsb=0.5544, bio=0.0000
    Epoch  9/10: total=1.6219, vae=1.0848, dsb=0.5372, bio=0.0000
    Epoch 10/10: total=1.6353, vae=1.0846, dsb=0.5507, bio=0.0000

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=25.6401, vae=1.0851, dsb=24.5550, bio=0.0000
    Epoch  2/10: total=24.0064, vae=1.0850, dsb=22.9215, bio=0.0000
    Epoch  3/10: total=23.8271, vae=1.0849, dsb=22.7422, bio=0.0000
    Epoch  4/10: total=23.6155, vae=1.0846, dsb=22.5310, bio=0.0000
    Epoch  5/10: total=23.5311, vae=1.0857, dsb=22.4454, bio=0.0000
    Epoch  6/10: total=23.4201, vae=1.0837, dsb=22.3364, bio=0.0000
    Epoch  7/10: total=23.4670, vae=1.0849, dsb=22.3821, bio=0.0000
    Epoch  8/10: total=23.3918, vae=1.0853, dsb=22.3064, bio=0.0000
    Epoch  9/10: total=23.2473, vae=1.0852, dsb=22.1620, bio=0.0000
    Epoch 10/10: total=23.2701, vae=1.0842, dsb=22.1859, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.5654, vae=1.0844, dsb=0.4810, bio=0.0000
    Epoch  2/10: total=1.5344, vae=1.0841, dsb=0.4502, bio=0.0000
    Epoch  3/10: total=1.5280, vae=1.0855, dsb=0.4426, bio=0.0000
    Epoch  4/10: total=1.5334, vae=1.0848, dsb=0.4486, bio=0.0000
    Epoch  5/10: total=1.5238, vae=1.0857, dsb=0.4381, bio=0.0000
    Epoch  6/10: total=1.5214, vae=1.0852, dsb=0.4363, bio=0.0000
    Epoch  7/10: total=1.5266, vae=1.0857, dsb=0.4410, bio=0.0000
    Epoch  8/10: total=1.5073, vae=1.0851, dsb=0.4222, bio=0.0000
    Epoch  9/10: total=1.5150, vae=1.0861, dsb=0.4290, bio=0.0000
    Epoch 10/10: total=1.5151, vae=1.0849, dsb=0.4302, bio=0.0000

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=21.0301, vae=1.0848, dsb=19.9453, bio=0.0000
    Epoch  2/10: total=20.7028, vae=1.0844, dsb=19.6184, bio=0.0000
    Epoch  3/10: total=20.4515, vae=1.0845, dsb=19.3670, bio=0.0000
    Epoch  4/10: total=20.4722, vae=1.0855, dsb=19.3867, bio=0.0000
    Epoch  5/10: total=20.4589, vae=1.0850, dsb=19.3739, bio=0.0000
    Epoch  6/10: total=20.4376, vae=1.0850, dsb=19.3525, bio=0.0000
    Epoch  7/10: total=20.3006, vae=1.0851, dsb=19.2155, bio=0.0000
    Epoch  8/10: total=20.3537, vae=1.0855, dsb=19.2681, bio=0.0000
    Epoch  9/10: total=20.3140, vae=1.0853, dsb=19.2287, bio=0.0000
    Epoch 10/10: total=20.4133, vae=1.0846, dsb=19.3286, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.4544, vae=1.0848, dsb=0.3696, bio=0.0000
    Epoch  2/10: total=1.4399, vae=1.0855, dsb=0.3545, bio=0.0000
    Epoch  3/10: total=1.4382, vae=1.0849, dsb=0.3533, bio=0.0000
    Epoch  4/10: total=1.4302, vae=1.0859, dsb=0.3443, bio=0.0000
    Epoch  5/10: total=1.4412, vae=1.0856, dsb=0.3555, bio=0.0000
    Epoch  6/10: total=1.4328, vae=1.0864, dsb=0.3464, bio=0.0000
    Epoch  7/10: total=1.4370, vae=1.0847, dsb=0.3523, bio=0.0000
    Epoch  8/10: total=1.4396, vae=1.0848, dsb=0.3548, bio=0.0000
    Epoch  9/10: total=1.4390, vae=1.0857, dsb=0.3533, bio=0.0000
    Epoch 10/10: total=1.4327, vae=1.0841, dsb=0.3486, bio=0.0000

[Seed 89] Joint training (ablation) complete; models and history saved.

[Seed 89] Drift genes saved in /home/yyuan/ICB_TCE/iter_results/run_089

[Seed 89] run finished.

================================================================================
[Seed 90] Starting running whole pipeline...
================================================================================

[Seed 90] Starting VAE pre-training...

    Epoch [01/20], Beta: 0.000, Average Loss: 534.6821
    Epoch [02/20], Beta: 0.000, Average Loss: 308.0316
    Epoch [03/20], Beta: 0.000, Average Loss: 272.6187
    Epoch [04/20], Beta: 0.000, Average Loss: 251.6418
    Epoch [05/20], Beta: 0.100, Average Loss: 245.8648
    Epoch [06/20], Beta: 0.200, Average Loss: 244.7744
    Epoch [07/20], Beta: 0.300, Average Loss: 245.0977
    Epoch [08/20], Beta: 0.400, Average Loss: 245.8723
    Epoch [09/20], Beta: 0.500, Average Loss: 246.9530
    Epoch [10/20], Beta: 0.600, Average Loss: 248.1724
    Epoch [11/20], Beta: 0.700, Average Loss: 249.3766
    Epoch [12/20], Beta: 0.800, Average Loss: 250.6159
    Epoch [13/20], Beta: 0.900, Average Loss: 251.8505
    Epoch [14/20], Beta: 1.000, Average Loss: 253.4552
    Epoch [15/20], Beta: 1.000, Average Loss: 253.0176
    Epoch [16/20], Beta: 1.000, Average Loss: 252.6516
    Epoch [17/20], Beta: 1.000, Average Loss: 252.2767
    Epoch [18/20], Beta: 1.000, Average Loss: 251.9479
    Epoch [19/20], Beta: 1.000, Average Loss: 251.5832
    Epoch [20/20], Beta: 1.000, Average Loss: 251.4358

[Seed 90] VAE pre-training complete.

[Seed 90] Starting joint training (original)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=204.5547, vae=3.7084, dsb=184.9917, bio=31.7093
    Epoch  2/10: total=62.7381, vae=1.1073, dsb=61.5824, bio=0.0968
    Epoch  3/10: total=53.0295, vae=1.1023, dsb=51.9101, bio=0.0342
    Epoch  4/10: total=48.1501, vae=1.1018, dsb=47.0386, bio=0.0195
    Epoch  5/10: total=45.2716, vae=1.1006, dsb=44.1646, bio=0.0127
    Epoch  6/10: total=43.4845, vae=1.0987, dsb=42.3813, bio=0.0090
    Epoch  7/10: total=42.1506, vae=1.0991, dsb=41.0481, bio=0.0070
    Epoch  8/10: total=41.1430, vae=1.0992, dsb=40.0410, bio=0.0056
    Epoch  9/10: total=40.3347, vae=1.0990, dsb=39.2333, bio=0.0048
    Epoch 10/10: total=39.7222, vae=1.0983, dsb=38.6218, bio=0.0042

  [Backward Policy Training]
    Epoch  1/10: total=3.1795, vae=1.0993, dsb=2.0741, bio=0.0121
    Epoch  2/10: total=2.6451, vae=1.0966, dsb=1.5464, bio=0.0043
    Epoch  3/10: total=2.5559, vae=1.0973, dsb=1.4570, bio=0.0032
    Epoch  4/10: total=2.4523, vae=1.0973, dsb=1.3536, bio=0.0027
    Epoch  5/10: total=2.4011, vae=1.0964, dsb=1.3035, bio=0.0025
    Epoch  6/10: total=2.3778, vae=1.0961, dsb=1.2805, bio=0.0024
    Epoch  7/10: total=2.3447, vae=1.0959, dsb=1.2477, bio=0.0022
    Epoch  8/10: total=2.3478, vae=1.0959, dsb=1.2507, bio=0.0022
    Epoch  9/10: total=2.3132, vae=1.0959, dsb=1.2162, bio=0.0022
    Epoch 10/10: total=2.3187, vae=1.0961, dsb=1.2216, bio=0.0020

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=38.3469, vae=1.0988, dsb=37.2462, bio=0.0037
    Epoch  2/10: total=31.9689, vae=1.0973, dsb=30.8705, bio=0.0021
    Epoch  3/10: total=30.5049, vae=1.0973, dsb=29.4065, bio=0.0021
    Epoch  4/10: total=29.5356, vae=1.0971, dsb=28.4375, bio=0.0020
    Epoch  5/10: total=29.0906, vae=1.0961, dsb=27.9936, bio=0.0020
    Epoch  6/10: total=28.5158, vae=1.0969, dsb=27.4179, bio=0.0020
    Epoch  7/10: total=28.1910, vae=1.0972, dsb=27.0928, bio=0.0020
    Epoch  8/10: total=27.9883, vae=1.0963, dsb=26.8906, bio=0.0027
    Epoch  9/10: total=27.7185, vae=1.0962, dsb=26.6213, bio=0.0019
    Epoch 10/10: total=27.6094, vae=1.0963, dsb=26.5121, bio=0.0019

  [Backward Policy Training]
    Epoch  1/10: total=2.0338, vae=1.0958, dsb=0.9351, bio=0.0058
    Epoch  2/10: total=1.9342, vae=1.0951, dsb=0.8381, bio=0.0021
    Epoch  3/10: total=1.8916, vae=1.0958, dsb=0.7949, bio=0.0019
    Epoch  4/10: total=1.8948, vae=1.0952, dsb=0.7987, bio=0.0018
    Epoch  5/10: total=1.8589, vae=1.0951, dsb=0.7629, bio=0.0018
    Epoch  6/10: total=1.8296, vae=1.0961, dsb=0.7326, bio=0.0018
    Epoch  7/10: total=1.8246, vae=1.0948, dsb=0.7288, bio=0.0017
    Epoch  8/10: total=1.8257, vae=1.0945, dsb=0.7303, bio=0.0018
    Epoch  9/10: total=1.8369, vae=1.0949, dsb=0.7411, bio=0.0019
    Epoch 10/10: total=1.8163, vae=1.0942, dsb=0.7213, bio=0.0016

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=26.4719, vae=1.0971, dsb=25.3732, bio=0.0033
    Epoch  2/10: total=23.9642, vae=1.0965, dsb=22.8668, bio=0.0018
    Epoch  3/10: total=23.3910, vae=1.0963, dsb=22.2938, bio=0.0018
    Epoch  4/10: total=22.9833, vae=1.0955, dsb=21.8869, bio=0.0018
    Epoch  5/10: total=22.7016, vae=1.0951, dsb=21.6057, bio=0.0018
    Epoch  6/10: total=22.5362, vae=1.0956, dsb=21.4398, bio=0.0018
    Epoch  7/10: total=22.3396, vae=1.0953, dsb=21.2434, bio=0.0018
    Epoch  8/10: total=22.2456, vae=1.0960, dsb=21.1487, bio=0.0018
    Epoch  9/10: total=22.0836, vae=1.0960, dsb=20.9865, bio=0.0021
    Epoch 10/10: total=22.1030, vae=1.0946, dsb=21.0076, bio=0.0017

  [Backward Policy Training]
    Epoch  1/10: total=1.7141, vae=1.0953, dsb=0.6156, bio=0.0064
    Epoch  2/10: total=1.6420, vae=1.0944, dsb=0.5468, bio=0.0017
    Epoch  3/10: total=1.6260, vae=1.0941, dsb=0.5311, bio=0.0016
    Epoch  4/10: total=1.6245, vae=1.0941, dsb=0.5296, bio=0.0016
    Epoch  5/10: total=1.6001, vae=1.0942, dsb=0.5051, bio=0.0015
    Epoch  6/10: total=1.6096, vae=1.0945, dsb=0.5143, bio=0.0015
    Epoch  7/10: total=1.6056, vae=1.0944, dsb=0.5105, bio=0.0015
    Epoch  8/10: total=1.5931, vae=1.0942, dsb=0.4982, bio=0.0015
    Epoch  9/10: total=1.5927, vae=1.0938, dsb=0.4981, bio=0.0017
    Epoch 10/10: total=1.5896, vae=1.0944, dsb=0.4945, bio=0.0014

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=21.1875, vae=1.0974, dsb=20.0886, bio=0.0029
    Epoch  2/10: total=19.9700, vae=1.0953, dsb=18.8739, bio=0.0016
    Epoch  3/10: total=19.8371, vae=1.0957, dsb=18.7406, bio=0.0016
    Epoch  4/10: total=19.5376, vae=1.0960, dsb=18.4408, bio=0.0016
    Epoch  5/10: total=19.4824, vae=1.0952, dsb=18.3865, bio=0.0016
    Epoch  6/10: total=19.5179, vae=1.0945, dsb=18.4226, bio=0.0016
    Epoch  7/10: total=19.3419, vae=1.0951, dsb=18.2459, bio=0.0016
    Epoch  8/10: total=19.3701, vae=1.0949, dsb=18.2744, bio=0.0016
    Epoch  9/10: total=19.2948, vae=1.0952, dsb=18.1988, bio=0.0016
    Epoch 10/10: total=19.2833, vae=1.0947, dsb=18.1878, bio=0.0016

  [Backward Policy Training]
    Epoch  1/10: total=1.5496, vae=1.0955, dsb=0.4444, bio=0.0196
    Epoch  2/10: total=1.5146, vae=1.0947, dsb=0.4192, bio=0.0015
    Epoch  3/10: total=1.5113, vae=1.0946, dsb=0.4160, bio=0.0014
    Epoch  4/10: total=1.4975, vae=1.0940, dsb=0.4028, bio=0.0013
    Epoch  5/10: total=1.4876, vae=1.0939, dsb=0.3930, bio=0.0014
    Epoch  6/10: total=1.4945, vae=1.0940, dsb=0.3999, bio=0.0013
    Epoch  7/10: total=1.4894, vae=1.0936, dsb=0.3952, bio=0.0013
    Epoch  8/10: total=1.4824, vae=1.0939, dsb=0.3879, bio=0.0013
    Epoch  9/10: total=1.4806, vae=1.0942, dsb=0.3858, bio=0.0012
    Epoch 10/10: total=1.4966, vae=1.0947, dsb=0.4012, bio=0.0016

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=17.0219, vae=1.0969, dsb=15.9237, bio=0.0027
    Epoch  2/10: total=16.4728, vae=1.0955, dsb=15.3766, bio=0.0014
    Epoch  3/10: total=16.3881, vae=1.0955, dsb=15.2919, bio=0.0014
    Epoch  4/10: total=16.3974, vae=1.0947, dsb=15.3020, bio=0.0014
    Epoch  5/10: total=16.3226, vae=1.0942, dsb=15.2276, bio=0.0015
    Epoch  6/10: total=16.2665, vae=1.0951, dsb=15.1707, bio=0.0015
    Epoch  7/10: total=16.2928, vae=1.0941, dsb=15.1981, bio=0.0014
    Epoch  8/10: total=16.2706, vae=1.0945, dsb=15.1754, bio=0.0013
    Epoch  9/10: total=16.2080, vae=1.0953, dsb=15.1120, bio=0.0014
    Epoch 10/10: total=16.2540, vae=1.0939, dsb=15.1595, bio=0.0014

  [Backward Policy Training]
    Epoch  1/10: total=1.4703, vae=1.0946, dsb=0.3407, bio=0.0700
    Epoch  2/10: total=1.4167, vae=1.0946, dsb=0.3215, bio=0.0013
    Epoch  3/10: total=1.4081, vae=1.0942, dsb=0.3133, bio=0.0012
    Epoch  4/10: total=1.4114, vae=1.0937, dsb=0.3171, bio=0.0012
    Epoch  5/10: total=1.4115, vae=1.0940, dsb=0.3167, bio=0.0014
    Epoch  6/10: total=1.4073, vae=1.0941, dsb=0.3127, bio=0.0011
    Epoch  7/10: total=1.4053, vae=1.0938, dsb=0.3110, bio=0.0011
    Epoch  8/10: total=1.4125, vae=1.0936, dsb=0.3184, bio=0.0011
    Epoch  9/10: total=1.3963, vae=1.0942, dsb=0.3016, bio=0.0011
    Epoch 10/10: total=1.3984, vae=1.0934, dsb=0.3045, bio=0.0011

[Seed 90] Joint training (original) complete; models and history saved.

[Seed 90] Starting joint training (ablation)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=186.7911, vae=2.0325, dsb=184.7587, bio=0.0000
    Epoch  2/10: total=62.4062, vae=1.0895, dsb=61.3168, bio=0.0000
    Epoch  3/10: total=52.7521, vae=1.0882, dsb=51.6639, bio=0.0000
    Epoch  4/10: total=47.9534, vae=1.0886, dsb=46.8648, bio=0.0000
    Epoch  5/10: total=45.1033, vae=1.0878, dsb=44.0154, bio=0.0000
    Epoch  6/10: total=43.3099, vae=1.0861, dsb=42.2238, bio=0.0000
    Epoch  7/10: total=41.9865, vae=1.0868, dsb=40.8997, bio=0.0000
    Epoch  8/10: total=41.0097, vae=1.0871, dsb=39.9226, bio=0.0000
    Epoch  9/10: total=40.1716, vae=1.0872, dsb=39.0844, bio=0.0000
    Epoch 10/10: total=39.5345, vae=1.0867, dsb=38.4479, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=3.0801, vae=1.0869, dsb=1.9932, bio=0.0000
    Epoch  2/10: total=2.5711, vae=1.0857, dsb=1.4854, bio=0.0000
    Epoch  3/10: total=2.4862, vae=1.0870, dsb=1.3992, bio=0.0000
    Epoch  4/10: total=2.3870, vae=1.0872, dsb=1.2998, bio=0.0000
    Epoch  5/10: total=2.3387, vae=1.0865, dsb=1.2522, bio=0.0000
    Epoch  6/10: total=2.3170, vae=1.0864, dsb=1.2306, bio=0.0000
    Epoch  7/10: total=2.2848, vae=1.0863, dsb=1.1985, bio=0.0000
    Epoch  8/10: total=2.2876, vae=1.0863, dsb=1.2013, bio=0.0000
    Epoch  9/10: total=2.2542, vae=1.0864, dsb=1.1678, bio=0.0000
    Epoch 10/10: total=2.2587, vae=1.0868, dsb=1.1720, bio=0.0000

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=36.8606, vae=1.0867, dsb=35.7739, bio=0.0000
    Epoch  2/10: total=30.6744, vae=1.0864, dsb=29.5880, bio=0.0000
    Epoch  3/10: total=29.2788, vae=1.0866, dsb=28.1922, bio=0.0000
    Epoch  4/10: total=28.3652, vae=1.0865, dsb=27.2787, bio=0.0000
    Epoch  5/10: total=27.9438, vae=1.0856, dsb=26.8582, bio=0.0000
    Epoch  6/10: total=27.3949, vae=1.0865, dsb=26.3084, bio=0.0000
    Epoch  7/10: total=27.0937, vae=1.0869, dsb=26.0068, bio=0.0000
    Epoch  8/10: total=26.8883, vae=1.0860, dsb=25.8023, bio=0.0000
    Epoch  9/10: total=26.6319, vae=1.0862, dsb=25.5457, bio=0.0000
    Epoch 10/10: total=26.5383, vae=1.0863, dsb=25.4520, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.9570, vae=1.0854, dsb=0.8716, bio=0.0000
    Epoch  2/10: total=1.8635, vae=1.0860, dsb=0.7775, bio=0.0000
    Epoch  3/10: total=1.8247, vae=1.0870, dsb=0.7377, bio=0.0000
    Epoch  4/10: total=1.8289, vae=1.0864, dsb=0.7425, bio=0.0000
    Epoch  5/10: total=1.7961, vae=1.0864, dsb=0.7097, bio=0.0000
    Epoch  6/10: total=1.7690, vae=1.0874, dsb=0.6816, bio=0.0000
    Epoch  7/10: total=1.7654, vae=1.0862, dsb=0.6792, bio=0.0000
    Epoch  8/10: total=1.7672, vae=1.0859, dsb=0.6813, bio=0.0000
    Epoch  9/10: total=1.7781, vae=1.0864, dsb=0.6918, bio=0.0000
    Epoch 10/10: total=1.7590, vae=1.0857, dsb=0.6733, bio=0.0000

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=24.6236, vae=1.0855, dsb=23.5381, bio=0.0000
    Epoch  2/10: total=22.0226, vae=1.0864, dsb=20.9362, bio=0.0000
    Epoch  3/10: total=21.4691, vae=1.0865, dsb=20.3826, bio=0.0000
    Epoch  4/10: total=21.0858, vae=1.0859, dsb=19.9999, bio=0.0000
    Epoch  5/10: total=20.8407, vae=1.0855, dsb=19.7552, bio=0.0000
    Epoch  6/10: total=20.7111, vae=1.0861, dsb=19.6251, bio=0.0000
    Epoch  7/10: total=20.5219, vae=1.0859, dsb=19.4360, bio=0.0000
    Epoch  8/10: total=20.4549, vae=1.0866, dsb=19.3683, bio=0.0000
    Epoch  9/10: total=20.3049, vae=1.0866, dsb=19.2183, bio=0.0000
    Epoch 10/10: total=20.3183, vae=1.0853, dsb=19.2329, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.6535, vae=1.0857, dsb=0.5678, bio=0.0000
    Epoch  2/10: total=1.5895, vae=1.0859, dsb=0.5036, bio=0.0000
    Epoch  3/10: total=1.5751, vae=1.0858, dsb=0.4893, bio=0.0000
    Epoch  4/10: total=1.5748, vae=1.0859, dsb=0.4889, bio=0.0000
    Epoch  5/10: total=1.5524, vae=1.0860, dsb=0.4664, bio=0.0000
    Epoch  6/10: total=1.5617, vae=1.0863, dsb=0.4753, bio=0.0000
    Epoch  7/10: total=1.5580, vae=1.0862, dsb=0.4718, bio=0.0000
    Epoch  8/10: total=1.5465, vae=1.0861, dsb=0.4604, bio=0.0000
    Epoch  9/10: total=1.5456, vae=1.0857, dsb=0.4599, bio=0.0000
    Epoch 10/10: total=1.5430, vae=1.0864, dsb=0.4566, bio=0.0000

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=19.1430, vae=1.0866, dsb=18.0564, bio=0.0000
    Epoch  2/10: total=17.9358, vae=1.0858, dsb=16.8500, bio=0.0000
    Epoch  3/10: total=17.8130, vae=1.0866, dsb=16.7264, bio=0.0000
    Epoch  4/10: total=17.5366, vae=1.0869, dsb=16.4497, bio=0.0000
    Epoch  5/10: total=17.4804, vae=1.0862, dsb=16.3942, bio=0.0000
    Epoch  6/10: total=17.4844, vae=1.0856, dsb=16.3988, bio=0.0000
    Epoch  7/10: total=17.3371, vae=1.0863, dsb=16.2508, bio=0.0000
    Epoch  8/10: total=17.3539, vae=1.0861, dsb=16.2678, bio=0.0000
    Epoch  9/10: total=17.2755, vae=1.0865, dsb=16.1890, bio=0.0000
    Epoch 10/10: total=17.2928, vae=1.0861, dsb=16.2067, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.4885, vae=1.0865, dsb=0.4020, bio=0.0000
    Epoch  2/10: total=1.4644, vae=1.0866, dsb=0.3778, bio=0.0000
    Epoch  3/10: total=1.4610, vae=1.0867, dsb=0.3743, bio=0.0000
    Epoch  4/10: total=1.4485, vae=1.0861, dsb=0.3624, bio=0.0000
    Epoch  5/10: total=1.4396, vae=1.0860, dsb=0.3535, bio=0.0000
    Epoch  6/10: total=1.4459, vae=1.0862, dsb=0.3597, bio=0.0000
    Epoch  7/10: total=1.4411, vae=1.0858, dsb=0.3553, bio=0.0000
    Epoch  8/10: total=1.4349, vae=1.0862, dsb=0.3487, bio=0.0000
    Epoch  9/10: total=1.4334, vae=1.0865, dsb=0.3469, bio=0.0000
    Epoch 10/10: total=1.4477, vae=1.0869, dsb=0.3608, bio=0.0000

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=15.4826, vae=1.0864, dsb=14.3962, bio=0.0000
    Epoch  2/10: total=14.9668, vae=1.0863, dsb=13.8805, bio=0.0000
    Epoch  3/10: total=14.8890, vae=1.0866, dsb=13.8024, bio=0.0000
    Epoch  4/10: total=14.8770, vae=1.0861, dsb=13.7909, bio=0.0000
    Epoch  5/10: total=14.8163, vae=1.0857, dsb=13.7305, bio=0.0000
    Epoch  6/10: total=14.7677, vae=1.0867, dsb=13.6810, bio=0.0000
    Epoch  7/10: total=14.7903, vae=1.0859, dsb=13.7044, bio=0.0000
    Epoch  8/10: total=14.7742, vae=1.0863, dsb=13.6879, bio=0.0000
    Epoch  9/10: total=14.7135, vae=1.0872, dsb=13.6264, bio=0.0000
    Epoch 10/10: total=14.7497, vae=1.0859, dsb=13.6638, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.3932, vae=1.0858, dsb=0.3074, bio=0.0000
    Epoch  2/10: total=1.3764, vae=1.0868, dsb=0.2896, bio=0.0000
    Epoch  3/10: total=1.3690, vae=1.0864, dsb=0.2825, bio=0.0000
    Epoch  4/10: total=1.3724, vae=1.0861, dsb=0.2863, bio=0.0000
    Epoch  5/10: total=1.3724, vae=1.0864, dsb=0.2860, bio=0.0000
    Epoch  6/10: total=1.3688, vae=1.0865, dsb=0.2823, bio=0.0000
    Epoch  7/10: total=1.3669, vae=1.0862, dsb=0.2807, bio=0.0000
    Epoch  8/10: total=1.3738, vae=1.0861, dsb=0.2877, bio=0.0000
    Epoch  9/10: total=1.3587, vae=1.0867, dsb=0.2721, bio=0.0000
    Epoch 10/10: total=1.3608, vae=1.0859, dsb=0.2749, bio=0.0000

[Seed 90] Joint training (ablation) complete; models and history saved.

[Seed 90] Drift genes saved in /home/yyuan/ICB_TCE/iter_results/run_090

[Seed 90] run finished.

================================================================================
[Seed 91] Starting running whole pipeline...
================================================================================

[Seed 91] Starting VAE pre-training...

    Epoch [01/20], Beta: 0.000, Average Loss: 537.7359
    Epoch [02/20], Beta: 0.000, Average Loss: 306.7719
    Epoch [03/20], Beta: 0.000, Average Loss: 270.2734
    Epoch [04/20], Beta: 0.000, Average Loss: 249.7468
    Epoch [05/20], Beta: 0.100, Average Loss: 245.4634
    Epoch [06/20], Beta: 0.200, Average Loss: 245.0784
    Epoch [07/20], Beta: 0.300, Average Loss: 245.1332
    Epoch [08/20], Beta: 0.400, Average Loss: 245.6563
    Epoch [09/20], Beta: 0.500, Average Loss: 246.6246
    Epoch [10/20], Beta: 0.600, Average Loss: 247.8464
    Epoch [11/20], Beta: 0.700, Average Loss: 249.1201
    Epoch [12/20], Beta: 0.800, Average Loss: 250.4419
    Epoch [13/20], Beta: 0.900, Average Loss: 251.7147
    Epoch [14/20], Beta: 1.000, Average Loss: 253.3474
    Epoch [15/20], Beta: 1.000, Average Loss: 252.9129
    Epoch [16/20], Beta: 1.000, Average Loss: 252.5453
    Epoch [17/20], Beta: 1.000, Average Loss: 252.1600
    Epoch [18/20], Beta: 1.000, Average Loss: 251.8516
    Epoch [19/20], Beta: 1.000, Average Loss: 251.4936
    Epoch [20/20], Beta: 1.000, Average Loss: 251.3295

[Seed 91] VAE pre-training complete.

[Seed 91] Starting joint training (original)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=234.6177, vae=3.7134, dsb=216.4842, bio=28.8402
    Epoch  2/10: total=66.3034, vae=1.1115, dsb=65.1593, bio=0.0651
    Epoch  3/10: total=55.2170, vae=1.1058, dsb=54.0969, bio=0.0285
    Epoch  4/10: total=49.9776, vae=1.1032, dsb=48.8659, bio=0.0169
    Epoch  5/10: total=47.0027, vae=1.1022, dsb=45.8948, bio=0.0113
    Epoch  6/10: total=45.1842, vae=1.1002, dsb=44.0798, bio=0.0083
    Epoch  7/10: total=43.7355, vae=1.1006, dsb=42.6316, bio=0.0066
    Epoch  8/10: total=42.5886, vae=1.1014, dsb=41.4845, bio=0.0054
    Epoch  9/10: total=41.6374, vae=1.0996, dsb=40.5354, bio=0.0047
    Epoch 10/10: total=40.9675, vae=1.0994, dsb=39.8661, bio=0.0042

  [Backward Policy Training]
    Epoch  1/10: total=3.2007, vae=1.1009, dsb=2.0934, bio=0.0127
    Epoch  2/10: total=2.6404, vae=1.0995, dsb=1.5387, bio=0.0044
    Epoch  3/10: total=2.5109, vae=1.0996, dsb=1.4096, bio=0.0034
    Epoch  4/10: total=2.4151, vae=1.0987, dsb=1.3150, bio=0.0029
    Epoch  5/10: total=2.4153, vae=1.0988, dsb=1.3152, bio=0.0027
    Epoch  6/10: total=2.3505, vae=1.0984, dsb=1.2508, bio=0.0025
    Epoch  7/10: total=2.3269, vae=1.0982, dsb=1.2275, bio=0.0025
    Epoch  8/10: total=2.3330, vae=1.0986, dsb=1.2332, bio=0.0024
    Epoch  9/10: total=2.3031, vae=1.0988, dsb=1.2031, bio=0.0023
    Epoch 10/10: total=2.2870, vae=1.0983, dsb=1.1876, bio=0.0023

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=37.9214, vae=1.0995, dsb=36.8200, bio=0.0039
    Epoch  2/10: total=30.9043, vae=1.0992, dsb=29.8039, bio=0.0023
    Epoch  3/10: total=29.2254, vae=1.0986, dsb=28.1257, bio=0.0022
    Epoch  4/10: total=28.3773, vae=1.0983, dsb=27.2779, bio=0.0022
    Epoch  5/10: total=27.7102, vae=1.0982, dsb=26.6108, bio=0.0022
    Epoch  6/10: total=27.2287, vae=1.0989, dsb=26.1287, bio=0.0022
    Epoch  7/10: total=26.9699, vae=1.0991, dsb=25.8697, bio=0.0022
    Epoch  8/10: total=26.6490, vae=1.0988, dsb=25.5491, bio=0.0022
    Epoch  9/10: total=26.3549, vae=1.0986, dsb=25.2552, bio=0.0022
    Epoch 10/10: total=26.2538, vae=1.0978, dsb=25.1549, bio=0.0022

  [Backward Policy Training]
    Epoch  1/10: total=2.0596, vae=1.0990, dsb=0.9575, bio=0.0061
    Epoch  2/10: total=1.9404, vae=1.0973, dsb=0.8419, bio=0.0023
    Epoch  3/10: total=1.9166, vae=1.0966, dsb=0.8189, bio=0.0022
    Epoch  4/10: total=1.8751, vae=1.0968, dsb=0.7773, bio=0.0021
    Epoch  5/10: total=1.8573, vae=1.0964, dsb=0.7598, bio=0.0020
    Epoch  6/10: total=1.8473, vae=1.0971, dsb=0.7492, bio=0.0020
    Epoch  7/10: total=1.8487, vae=1.0968, dsb=0.7509, bio=0.0020
    Epoch  8/10: total=1.8118, vae=1.0960, dsb=0.7148, bio=0.0019
    Epoch  9/10: total=1.8097, vae=1.0970, dsb=0.7114, bio=0.0026
    Epoch 10/10: total=1.8152, vae=1.0974, dsb=0.7169, bio=0.0019

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=25.4091, vae=1.0996, dsb=24.3078, bio=0.0033
    Epoch  2/10: total=22.7968, vae=1.0988, dsb=21.6970, bio=0.0020
    Epoch  3/10: total=22.1690, vae=1.0977, dsb=21.0703, bio=0.0020
    Epoch  4/10: total=21.8314, vae=1.0976, dsb=20.7328, bio=0.0020
    Epoch  5/10: total=21.4974, vae=1.0975, dsb=20.3988, bio=0.0020
    Epoch  6/10: total=21.3156, vae=1.0985, dsb=20.2161, bio=0.0020
    Epoch  7/10: total=21.2212, vae=1.0978, dsb=20.1224, bio=0.0020
    Epoch  8/10: total=21.0797, vae=1.0969, dsb=19.9816, bio=0.0023
    Epoch  9/10: total=20.8627, vae=1.0970, dsb=19.7647, bio=0.0019
    Epoch 10/10: total=20.9049, vae=1.0977, dsb=19.8063, bio=0.0019

  [Backward Policy Training]
    Epoch  1/10: total=1.7498, vae=1.0983, dsb=0.6454, bio=0.0121
    Epoch  2/10: total=1.6667, vae=1.0970, dsb=0.5687, bio=0.0020
    Epoch  3/10: total=1.6746, vae=1.0966, dsb=0.5771, bio=0.0018
    Epoch  4/10: total=1.6376, vae=1.0961, dsb=0.5406, bio=0.0018
    Epoch  5/10: total=1.6328, vae=1.0960, dsb=0.5360, bio=0.0017
    Epoch  6/10: total=1.6364, vae=1.0956, dsb=0.5399, bio=0.0019
    Epoch  7/10: total=1.6184, vae=1.0965, dsb=0.5211, bio=0.0017
    Epoch  8/10: total=1.6362, vae=1.0966, dsb=0.5388, bio=0.0017
    Epoch  9/10: total=1.6186, vae=1.0964, dsb=0.5213, bio=0.0017
    Epoch 10/10: total=1.6147, vae=1.0959, dsb=0.5180, bio=0.0017

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=20.5187, vae=1.0996, dsb=19.4175, bio=0.0031
    Epoch  2/10: total=19.1645, vae=1.0973, dsb=18.0663, bio=0.0018
    Epoch  3/10: total=18.8962, vae=1.0973, dsb=17.7980, bio=0.0018
    Epoch  4/10: total=18.6700, vae=1.0973, dsb=17.5717, bio=0.0020
    Epoch  5/10: total=18.6654, vae=1.0977, dsb=17.5667, bio=0.0018
    Epoch  6/10: total=18.4916, vae=1.0969, dsb=17.3938, bio=0.0018
    Epoch  7/10: total=18.4490, vae=1.0975, dsb=17.3506, bio=0.0018
    Epoch  8/10: total=18.3897, vae=1.0977, dsb=17.2911, bio=0.0018
    Epoch  9/10: total=18.4219, vae=1.0970, dsb=17.3240, bio=0.0018
    Epoch 10/10: total=18.2544, vae=1.0962, dsb=17.1571, bio=0.0021

  [Backward Policy Training]
    Epoch  1/10: total=1.5551, vae=1.0971, dsb=0.4485, bio=0.0188
    Epoch  2/10: total=1.5192, vae=1.0963, dsb=0.4220, bio=0.0017
    Epoch  3/10: total=1.5218, vae=1.0964, dsb=0.4246, bio=0.0016
    Epoch  4/10: total=1.5032, vae=1.0972, dsb=0.4051, bio=0.0016
    Epoch  5/10: total=1.4977, vae=1.0952, dsb=0.4018, bio=0.0016
    Epoch  6/10: total=1.5070, vae=1.0965, dsb=0.4096, bio=0.0018
    Epoch  7/10: total=1.5030, vae=1.0956, dsb=0.4066, bio=0.0016
    Epoch  8/10: total=1.4935, vae=1.0953, dsb=0.3975, bio=0.0015
    Epoch  9/10: total=1.5113, vae=1.0958, dsb=0.4148, bio=0.0015
    Epoch 10/10: total=1.4947, vae=1.0953, dsb=0.3987, bio=0.0015

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=16.9187, vae=1.0987, dsb=15.8185, bio=0.0030
    Epoch  2/10: total=16.2762, vae=1.0967, dsb=15.1787, bio=0.0016
    Epoch  3/10: total=16.1389, vae=1.0971, dsb=15.0410, bio=0.0017
    Epoch  4/10: total=16.1796, vae=1.0971, dsb=15.0817, bio=0.0017
    Epoch  5/10: total=16.0835, vae=1.0974, dsb=14.9852, bio=0.0018
    Epoch  6/10: total=16.0609, vae=1.0968, dsb=14.9633, bio=0.0016
    Epoch  7/10: total=16.0203, vae=1.0966, dsb=14.9228, bio=0.0016
    Epoch  8/10: total=16.0091, vae=1.0956, dsb=14.9127, bio=0.0016
    Epoch  9/10: total=16.0549, vae=1.0966, dsb=14.9574, bio=0.0016
    Epoch 10/10: total=15.8682, vae=1.0964, dsb=14.7710, bio=0.0015

  [Backward Policy Training]
    Epoch  1/10: total=1.4646, vae=1.0973, dsb=0.3494, bio=0.0358
    Epoch  2/10: total=1.4467, vae=1.0965, dsb=0.3494, bio=0.0016
    Epoch  3/10: total=1.4256, vae=1.0965, dsb=0.3284, bio=0.0015
    Epoch  4/10: total=1.4238, vae=1.0962, dsb=0.3269, bio=0.0014
    Epoch  5/10: total=1.4233, vae=1.0949, dsb=0.3278, bio=0.0014
    Epoch  6/10: total=1.4220, vae=1.0962, dsb=0.3251, bio=0.0014
    Epoch  7/10: total=1.4233, vae=1.0955, dsb=0.3271, bio=0.0014
    Epoch  8/10: total=1.4201, vae=1.0953, dsb=0.3241, bio=0.0014
    Epoch  9/10: total=1.4236, vae=1.0957, dsb=0.3271, bio=0.0014
    Epoch 10/10: total=1.4107, vae=1.0949, dsb=0.3151, bio=0.0013

[Seed 91] Joint training (original) complete; models and history saved.

[Seed 91] Starting joint training (ablation)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=218.1251, vae=2.0278, dsb=216.0973, bio=0.0000
    Epoch  2/10: total=65.5234, vae=1.0924, dsb=64.4310, bio=0.0000
    Epoch  3/10: total=54.7981, vae=1.0907, dsb=53.7074, bio=0.0000
    Epoch  4/10: total=49.7129, vae=1.0895, dsb=48.6234, bio=0.0000
    Epoch  5/10: total=46.7532, vae=1.0891, dsb=45.6641, bio=0.0000
    Epoch  6/10: total=44.9502, vae=1.0875, dsb=43.8627, bio=0.0000
    Epoch  7/10: total=43.4662, vae=1.0882, dsb=42.3780, bio=0.0000
    Epoch  8/10: total=42.3346, vae=1.0893, dsb=41.2453, bio=0.0000
    Epoch  9/10: total=41.4231, vae=1.0878, dsb=40.3353, bio=0.0000
    Epoch 10/10: total=40.8035, vae=1.0878, dsb=39.7157, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=3.1045, vae=1.0885, dsb=2.0161, bio=0.0000
    Epoch  2/10: total=2.5722, vae=1.0886, dsb=1.4836, bio=0.0000
    Epoch  3/10: total=2.4510, vae=1.0892, dsb=1.3618, bio=0.0000
    Epoch  4/10: total=2.3580, vae=1.0885, dsb=1.2694, bio=0.0000
    Epoch  5/10: total=2.3574, vae=1.0888, dsb=1.2686, bio=0.0000
    Epoch  6/10: total=2.2935, vae=1.0885, dsb=1.2050, bio=0.0000
    Epoch  7/10: total=2.2706, vae=1.0884, dsb=1.1822, bio=0.0000
    Epoch  8/10: total=2.2760, vae=1.0889, dsb=1.1871, bio=0.0000
    Epoch  9/10: total=2.2470, vae=1.0893, dsb=1.1577, bio=0.0000
    Epoch 10/10: total=2.2327, vae=1.0888, dsb=1.1439, bio=0.0000

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=37.7571, vae=1.0874, dsb=36.6696, bio=0.0000
    Epoch  2/10: total=30.8001, vae=1.0882, dsb=29.7118, bio=0.0000
    Epoch  3/10: total=29.1856, vae=1.0878, dsb=28.0978, bio=0.0000
    Epoch  4/10: total=28.3354, vae=1.0877, dsb=27.2477, bio=0.0000
    Epoch  5/10: total=27.6773, vae=1.0878, dsb=26.5895, bio=0.0000
    Epoch  6/10: total=27.2033, vae=1.0885, dsb=26.1148, bio=0.0000
    Epoch  7/10: total=26.9506, vae=1.0889, dsb=25.8617, bio=0.0000
    Epoch  8/10: total=26.6536, vae=1.0886, dsb=25.5649, bio=0.0000
    Epoch  9/10: total=26.3784, vae=1.0885, dsb=25.2900, bio=0.0000
    Epoch 10/10: total=26.2824, vae=1.0877, dsb=25.1947, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=2.0067, vae=1.0882, dsb=0.9185, bio=0.0000
    Epoch  2/10: total=1.8923, vae=1.0881, dsb=0.8042, bio=0.0000
    Epoch  3/10: total=1.8682, vae=1.0876, dsb=0.7806, bio=0.0000
    Epoch  4/10: total=1.8275, vae=1.0878, dsb=0.7396, bio=0.0000
    Epoch  5/10: total=1.8102, vae=1.0876, dsb=0.7226, bio=0.0000
    Epoch  6/10: total=1.8007, vae=1.0883, dsb=0.7125, bio=0.0000
    Epoch  7/10: total=1.8016, vae=1.0880, dsb=0.7136, bio=0.0000
    Epoch  8/10: total=1.7668, vae=1.0874, dsb=0.6794, bio=0.0000
    Epoch  9/10: total=1.7646, vae=1.0882, dsb=0.6764, bio=0.0000
    Epoch 10/10: total=1.7702, vae=1.0888, dsb=0.6814, bio=0.0000

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=24.8953, vae=1.0882, dsb=23.8071, bio=0.0000
    Epoch  2/10: total=22.3781, vae=1.0888, dsb=21.2893, bio=0.0000
    Epoch  3/10: total=21.8161, vae=1.0880, dsb=20.7282, bio=0.0000
    Epoch  4/10: total=21.4759, vae=1.0880, dsb=20.3879, bio=0.0000
    Epoch  5/10: total=21.1662, vae=1.0880, dsb=20.0782, bio=0.0000
    Epoch  6/10: total=21.0025, vae=1.0890, dsb=19.9136, bio=0.0000
    Epoch  7/10: total=20.9025, vae=1.0884, dsb=19.8141, bio=0.0000
    Epoch  8/10: total=20.7599, vae=1.0874, dsb=19.6725, bio=0.0000
    Epoch  9/10: total=20.5636, vae=1.0877, dsb=19.4759, bio=0.0000
    Epoch 10/10: total=20.5987, vae=1.0884, dsb=19.5103, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.6975, vae=1.0886, dsb=0.6089, bio=0.0000
    Epoch  2/10: total=1.6235, vae=1.0883, dsb=0.5352, bio=0.0000
    Epoch  3/10: total=1.6309, vae=1.0881, dsb=0.5427, bio=0.0000
    Epoch  4/10: total=1.5957, vae=1.0877, dsb=0.5079, bio=0.0000
    Epoch  5/10: total=1.5913, vae=1.0877, dsb=0.5036, bio=0.0000
    Epoch  6/10: total=1.5944, vae=1.0872, dsb=0.5071, bio=0.0000
    Epoch  7/10: total=1.5777, vae=1.0882, dsb=0.4895, bio=0.0000
    Epoch  8/10: total=1.5945, vae=1.0884, dsb=0.5062, bio=0.0000
    Epoch  9/10: total=1.5776, vae=1.0883, dsb=0.4893, bio=0.0000
    Epoch 10/10: total=1.5744, vae=1.0877, dsb=0.4867, bio=0.0000

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=19.4159, vae=1.0885, dsb=18.3274, bio=0.0000
    Epoch  2/10: total=18.1115, vae=1.0877, dsb=17.0238, bio=0.0000
    Epoch  3/10: total=17.8317, vae=1.0880, dsb=16.7436, bio=0.0000
    Epoch  4/10: total=17.6418, vae=1.0882, dsb=16.5536, bio=0.0000
    Epoch  5/10: total=17.6248, vae=1.0887, dsb=16.5361, bio=0.0000
    Epoch  6/10: total=17.4848, vae=1.0879, dsb=16.3969, bio=0.0000
    Epoch  7/10: total=17.4336, vae=1.0885, dsb=16.3452, bio=0.0000
    Epoch  8/10: total=17.3846, vae=1.0888, dsb=16.2957, bio=0.0000
    Epoch  9/10: total=17.4280, vae=1.0882, dsb=16.3397, bio=0.0000
    Epoch 10/10: total=17.2941, vae=1.0875, dsb=16.2066, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.4967, vae=1.0878, dsb=0.4089, bio=0.0000
    Epoch  2/10: total=1.4710, vae=1.0882, dsb=0.3829, bio=0.0000
    Epoch  3/10: total=1.4729, vae=1.0884, dsb=0.3845, bio=0.0000
    Epoch  4/10: total=1.4549, vae=1.0892, dsb=0.3657, bio=0.0000
    Epoch  5/10: total=1.4495, vae=1.0872, dsb=0.3622, bio=0.0000
    Epoch  6/10: total=1.4579, vae=1.0886, dsb=0.3694, bio=0.0000
    Epoch  7/10: total=1.4540, vae=1.0877, dsb=0.3663, bio=0.0000
    Epoch  8/10: total=1.4455, vae=1.0875, dsb=0.3580, bio=0.0000
    Epoch  9/10: total=1.4620, vae=1.0880, dsb=0.3739, bio=0.0000
    Epoch 10/10: total=1.4466, vae=1.0875, dsb=0.3591, bio=0.0000

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=15.8285, vae=1.0881, dsb=14.7404, bio=0.0000
    Epoch  2/10: total=15.2941, vae=1.0874, dsb=14.2067, bio=0.0000
    Epoch  3/10: total=15.1731, vae=1.0882, dsb=14.0849, bio=0.0000
    Epoch  4/10: total=15.2305, vae=1.0883, dsb=14.1421, bio=0.0000
    Epoch  5/10: total=15.1577, vae=1.0887, dsb=14.0690, bio=0.0000
    Epoch  6/10: total=15.1408, vae=1.0883, dsb=14.0524, bio=0.0000
    Epoch  7/10: total=15.1038, vae=1.0881, dsb=14.0157, bio=0.0000
    Epoch  8/10: total=15.1068, vae=1.0872, dsb=14.0196, bio=0.0000
    Epoch  9/10: total=15.1429, vae=1.0882, dsb=14.0547, bio=0.0000
    Epoch 10/10: total=14.9811, vae=1.0880, dsb=13.8931, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.3968, vae=1.0883, dsb=0.3085, bio=0.0000
    Epoch  2/10: total=1.3981, vae=1.0885, dsb=0.3096, bio=0.0000
    Epoch  3/10: total=1.3792, vae=1.0887, dsb=0.2905, bio=0.0000
    Epoch  4/10: total=1.3779, vae=1.0884, dsb=0.2894, bio=0.0000
    Epoch  5/10: total=1.3774, vae=1.0872, dsb=0.2903, bio=0.0000
    Epoch  6/10: total=1.3764, vae=1.0886, dsb=0.2878, bio=0.0000
    Epoch  7/10: total=1.3779, vae=1.0879, dsb=0.2900, bio=0.0000
    Epoch  8/10: total=1.3750, vae=1.0878, dsb=0.2873, bio=0.0000
    Epoch  9/10: total=1.3784, vae=1.0882, dsb=0.2902, bio=0.0000
    Epoch 10/10: total=1.3664, vae=1.0874, dsb=0.2789, bio=0.0000

[Seed 91] Joint training (ablation) complete; models and history saved.

[Seed 91] Drift genes saved in /home/yyuan/ICB_TCE/iter_results/run_091

[Seed 91] run finished.

================================================================================
[Seed 92] Starting running whole pipeline...
================================================================================

[Seed 92] Starting VAE pre-training...

    Epoch [01/20], Beta: 0.000, Average Loss: 535.6848
    Epoch [02/20], Beta: 0.000, Average Loss: 307.6971
    Epoch [03/20], Beta: 0.000, Average Loss: 270.8121
    Epoch [04/20], Beta: 0.000, Average Loss: 250.6057
    Epoch [05/20], Beta: 0.100, Average Loss: 246.0053
    Epoch [06/20], Beta: 0.200, Average Loss: 244.6488
    Epoch [07/20], Beta: 0.300, Average Loss: 244.6249
    Epoch [08/20], Beta: 0.400, Average Loss: 245.3713
    Epoch [09/20], Beta: 0.500, Average Loss: 246.4099
    Epoch [10/20], Beta: 0.600, Average Loss: 247.6071
    Epoch [11/20], Beta: 0.700, Average Loss: 248.8672
    Epoch [12/20], Beta: 0.800, Average Loss: 250.1601
    Epoch [13/20], Beta: 0.900, Average Loss: 251.4131
    Epoch [14/20], Beta: 1.000, Average Loss: 253.0018
    Epoch [15/20], Beta: 1.000, Average Loss: 252.6499
    Epoch [16/20], Beta: 1.000, Average Loss: 252.2900
    Epoch [17/20], Beta: 1.000, Average Loss: 251.8957
    Epoch [18/20], Beta: 1.000, Average Loss: 251.6064
    Epoch [19/20], Beta: 1.000, Average Loss: 251.2592
    Epoch [20/20], Beta: 1.000, Average Loss: 251.0912

[Seed 92] VAE pre-training complete.

[Seed 92] Starting joint training (original)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=356.2707, vae=3.6449, dsb=337.4629, bio=30.3258
    Epoch  2/10: total=105.5642, vae=1.1052, dsb=104.4184, bio=0.0813
    Epoch  3/10: total=93.1340, vae=1.0988, dsb=92.0169, bio=0.0367
    Epoch  4/10: total=87.3822, vae=1.0965, dsb=86.2748, bio=0.0218
    Epoch  5/10: total=83.6956, vae=1.0968, dsb=82.5914, bio=0.0147
    Epoch  6/10: total=81.4734, vae=1.0948, dsb=80.3734, bio=0.0106
    Epoch  7/10: total=79.1937, vae=1.0945, dsb=78.0950, bio=0.0083
    Epoch  8/10: total=78.1370, vae=1.0942, dsb=77.0394, bio=0.0066
    Epoch  9/10: total=76.9879, vae=1.0934, dsb=75.8918, bio=0.0055
    Epoch 10/10: total=76.5424, vae=1.0942, dsb=75.4459, bio=0.0047

  [Backward Policy Training]
    Epoch  1/10: total=3.5348, vae=1.0947, dsb=2.4338, bio=0.0126
    Epoch  2/10: total=2.9345, vae=1.0932, dsb=1.8390, bio=0.0045
    Epoch  3/10: total=2.7919, vae=1.0926, dsb=1.6977, bio=0.0033
    Epoch  4/10: total=2.6986, vae=1.0924, dsb=1.6048, bio=0.0027
    Epoch  5/10: total=2.6936, vae=1.0917, dsb=1.6006, bio=0.0024
    Epoch  6/10: total=2.6232, vae=1.0919, dsb=1.5302, bio=0.0023
    Epoch  7/10: total=2.6088, vae=1.0916, dsb=1.5161, bio=0.0022
    Epoch  8/10: total=2.5772, vae=1.0912, dsb=1.4850, bio=0.0020
    Epoch  9/10: total=2.5573, vae=1.0916, dsb=1.4647, bio=0.0019
    Epoch 10/10: total=2.5294, vae=1.0916, dsb=1.4368, bio=0.0019

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=67.4662, vae=1.0950, dsb=66.3694, bio=0.0038
    Epoch  2/10: total=60.1960, vae=1.0927, dsb=59.1024, bio=0.0019
    Epoch  3/10: total=58.2236, vae=1.0923, dsb=57.1304, bio=0.0018
    Epoch  4/10: total=57.3599, vae=1.0925, dsb=56.2665, bio=0.0017
    Epoch  5/10: total=56.7564, vae=1.0920, dsb=55.6635, bio=0.0018
    Epoch  6/10: total=55.8343, vae=1.0920, dsb=54.7415, bio=0.0017
    Epoch  7/10: total=55.4161, vae=1.0918, dsb=54.3235, bio=0.0017
    Epoch  8/10: total=55.2396, vae=1.0922, dsb=54.1465, bio=0.0019
    Epoch  9/10: total=54.8822, vae=1.0915, dsb=53.7897, bio=0.0019
    Epoch 10/10: total=54.7093, vae=1.0913, dsb=53.6172, bio=0.0016

  [Backward Policy Training]
    Epoch  1/10: total=2.2660, vae=1.0918, dsb=1.1701, bio=0.0081
    Epoch  2/10: total=2.1378, vae=1.0912, dsb=1.0458, bio=0.0017
    Epoch  3/10: total=2.0737, vae=1.0910, dsb=0.9819, bio=0.0015
    Epoch  4/10: total=2.0610, vae=1.0907, dsb=0.9696, bio=0.0015
    Epoch  5/10: total=2.0659, vae=1.0906, dsb=0.9746, bio=0.0014
    Epoch  6/10: total=2.0153, vae=1.0899, dsb=0.9248, bio=0.0014
    Epoch  7/10: total=2.0160, vae=1.0891, dsb=0.9262, bio=0.0014
    Epoch  8/10: total=2.0054, vae=1.0909, dsb=0.9137, bio=0.0015
    Epoch  9/10: total=1.9937, vae=1.0905, dsb=0.9026, bio=0.0014
    Epoch 10/10: total=2.0114, vae=1.0902, dsb=0.9206, bio=0.0013

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=49.8744, vae=1.0929, dsb=48.7801, bio=0.0027
    Epoch  2/10: total=47.3000, vae=1.0918, dsb=46.2075, bio=0.0014
    Epoch  3/10: total=46.1718, vae=1.0905, dsb=45.0807, bio=0.0013
    Epoch  4/10: total=45.6421, vae=1.0909, dsb=44.5506, bio=0.0013
    Epoch  5/10: total=45.4455, vae=1.0907, dsb=44.3541, bio=0.0013
    Epoch  6/10: total=45.2933, vae=1.0904, dsb=44.2023, bio=0.0013
    Epoch  7/10: total=45.1575, vae=1.0905, dsb=44.0664, bio=0.0013
    Epoch  8/10: total=44.9030, vae=1.0905, dsb=43.8119, bio=0.0013
    Epoch  9/10: total=44.7920, vae=1.0900, dsb=43.7014, bio=0.0012
    Epoch 10/10: total=44.6375, vae=1.0899, dsb=43.5470, bio=0.0012

  [Backward Policy Training]
    Epoch  1/10: total=1.9711, vae=1.0909, dsb=0.8386, bio=0.0832
    Epoch  2/10: total=1.8211, vae=1.0907, dsb=0.7297, bio=0.0014
    Epoch  3/10: total=1.8261, vae=1.0893, dsb=0.7362, bio=0.0012
    Epoch  4/10: total=1.8152, vae=1.0901, dsb=0.7246, bio=0.0011
    Epoch  5/10: total=1.7960, vae=1.0890, dsb=0.7064, bio=0.0011
    Epoch  6/10: total=1.7983, vae=1.0896, dsb=0.7081, bio=0.0011
    Epoch  7/10: total=1.7865, vae=1.0891, dsb=0.6969, bio=0.0011
    Epoch  8/10: total=1.7873, vae=1.0889, dsb=0.6979, bio=0.0011
    Epoch  9/10: total=1.7728, vae=1.0892, dsb=0.6830, bio=0.0011
    Epoch 10/10: total=1.7741, vae=1.0897, dsb=0.6839, bio=0.0011

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=42.2707, vae=1.0908, dsb=41.1780, bio=0.0037
    Epoch  2/10: total=40.7669, vae=1.0909, dsb=39.6753, bio=0.0013
    Epoch  3/10: total=40.3660, vae=1.0902, dsb=39.2753, bio=0.0011
    Epoch  4/10: total=40.5555, vae=1.0898, dsb=39.4651, bio=0.0012
    Epoch  5/10: total=40.3145, vae=1.0906, dsb=39.2234, bio=0.0011
    Epoch  6/10: total=40.2376, vae=1.0898, dsb=39.1473, bio=0.0011
    Epoch  7/10: total=40.3496, vae=1.0895, dsb=39.2596, bio=0.0008
    Epoch  8/10: total=40.2161, vae=1.0899, dsb=39.1258, bio=0.0008
    Epoch  9/10: total=40.0430, vae=1.0896, dsb=38.9528, bio=0.0011
    Epoch 10/10: total=39.9464, vae=1.0897, dsb=38.8562, bio=0.0010

  [Backward Policy Training]
    Epoch  1/10: total=1.7857, vae=1.0904, dsb=0.6133, bio=0.1642
    Epoch  2/10: total=1.6623, vae=1.0893, dsb=0.5725, bio=0.0009
    Epoch  3/10: total=1.6585, vae=1.0891, dsb=0.5689, bio=0.0011
    Epoch  4/10: total=1.6449, vae=1.0896, dsb=0.5548, bio=0.0010
    Epoch  5/10: total=1.6575, vae=1.0887, dsb=0.5684, bio=0.0007
    Epoch  6/10: total=1.6241, vae=1.0883, dsb=0.5354, bio=0.0010
    Epoch  7/10: total=1.6261, vae=1.0886, dsb=0.5370, bio=0.0010
    Epoch  8/10: total=1.6374, vae=1.0879, dsb=0.5490, bio=0.0010
    Epoch  9/10: total=1.6380, vae=1.0882, dsb=0.5494, bio=0.0007
    Epoch 10/10: total=1.6432, vae=1.0890, dsb=0.5539, bio=0.0008

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=35.9745, vae=1.0923, dsb=34.8784, bio=0.0076
    Epoch  2/10: total=35.3955, vae=1.0901, dsb=34.3049, bio=0.0008
    Epoch  3/10: total=35.3758, vae=1.0899, dsb=34.2854, bio=0.0008
    Epoch  4/10: total=35.2259, vae=1.0899, dsb=34.1353, bio=0.0013
    Epoch  5/10: total=35.2509, vae=1.0896, dsb=34.1607, bio=0.0011
    Epoch  6/10: total=35.2690, vae=1.0889, dsb=34.1796, bio=0.0010
    Epoch  7/10: total=35.1749, vae=1.0899, dsb=34.0848, bio=0.0004
    Epoch  8/10: total=35.1963, vae=1.0894, dsb=34.1067, bio=0.0005
    Epoch  9/10: total=35.2781, vae=1.0892, dsb=34.1884, bio=0.0011
    Epoch 10/10: total=35.2136, vae=1.0889, dsb=34.1241, bio=0.0011

  [Backward Policy Training]
    Epoch  1/10: total=1.6535, vae=1.0907, dsb=0.4682, bio=0.1892
    Epoch  2/10: total=1.5549, vae=1.0897, dsb=0.4649, bio=0.0007
    Epoch  3/10: total=1.5501, vae=1.0896, dsb=0.4602, bio=0.0008
    Epoch  4/10: total=1.5443, vae=1.0884, dsb=0.4555, bio=0.0008
    Epoch  5/10: total=1.5314, vae=1.0896, dsb=0.4413, bio=0.0010
    Epoch  6/10: total=1.5382, vae=1.0878, dsb=0.4499, bio=0.0009
    Epoch  7/10: total=1.5531, vae=1.0891, dsb=0.4638, bio=0.0005
    Epoch  8/10: total=1.5328, vae=1.0885, dsb=0.4438, bio=0.0010
    Epoch  9/10: total=1.5364, vae=1.0885, dsb=0.4475, bio=0.0010
    Epoch 10/10: total=1.5296, vae=1.0887, dsb=0.4405, bio=0.0009

[Seed 92] Joint training (original) complete; models and history saved.

[Seed 92] Starting joint training (ablation)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=338.8737, vae=2.0176, dsb=336.8561, bio=0.0000
    Epoch  2/10: total=104.9422, vae=1.0862, dsb=103.8560, bio=0.0000
    Epoch  3/10: total=92.5799, vae=1.0836, dsb=91.4963, bio=0.0000
    Epoch  4/10: total=87.0927, vae=1.0830, dsb=86.0097, bio=0.0000
    Epoch  5/10: total=83.5136, vae=1.0839, dsb=82.4297, bio=0.0000
    Epoch  6/10: total=81.1761, vae=1.0822, dsb=80.0939, bio=0.0000
    Epoch  7/10: total=78.8572, vae=1.0823, dsb=77.7749, bio=0.0000
    Epoch  8/10: total=77.8020, vae=1.0823, dsb=76.7197, bio=0.0000
    Epoch  9/10: total=76.6285, vae=1.0816, dsb=75.5469, bio=0.0000
    Epoch 10/10: total=76.1566, vae=1.0827, dsb=75.0739, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=3.4114, vae=1.0825, dsb=2.3290, bio=0.0000
    Epoch  2/10: total=2.8497, vae=1.0824, dsb=1.7673, bio=0.0000
    Epoch  3/10: total=2.7112, vae=1.0821, dsb=1.6290, bio=0.0000
    Epoch  4/10: total=2.6208, vae=1.0822, dsb=1.5386, bio=0.0000
    Epoch  5/10: total=2.6175, vae=1.0817, dsb=1.5358, bio=0.0000
    Epoch  6/10: total=2.5500, vae=1.0820, dsb=1.4679, bio=0.0000
    Epoch  7/10: total=2.5365, vae=1.0820, dsb=1.4545, bio=0.0000
    Epoch  8/10: total=2.5054, vae=1.0817, dsb=1.4238, bio=0.0000
    Epoch  9/10: total=2.4857, vae=1.0821, dsb=1.4036, bio=0.0000
    Epoch 10/10: total=2.4577, vae=1.0822, dsb=1.3755, bio=0.0000

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=66.5856, vae=1.0823, dsb=65.5033, bio=0.0000
    Epoch  2/10: total=59.3470, vae=1.0818, dsb=58.2651, bio=0.0000
    Epoch  3/10: total=57.4102, vae=1.0818, dsb=56.3284, bio=0.0000
    Epoch  4/10: total=56.6126, vae=1.0821, dsb=55.5304, bio=0.0000
    Epoch  5/10: total=55.9859, vae=1.0818, dsb=54.9041, bio=0.0000
    Epoch  6/10: total=55.1288, vae=1.0819, dsb=54.0469, bio=0.0000
    Epoch  7/10: total=54.7017, vae=1.0818, dsb=53.6199, bio=0.0000
    Epoch  8/10: total=54.5257, vae=1.0821, dsb=53.4435, bio=0.0000
    Epoch  9/10: total=54.2179, vae=1.0818, dsb=53.1361, bio=0.0000
    Epoch 10/10: total=54.0480, vae=1.0816, dsb=52.9663, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=2.1952, vae=1.0818, dsb=1.1134, bio=0.0000
    Epoch  2/10: total=2.0749, vae=1.0823, dsb=0.9925, bio=0.0000
    Epoch  3/10: total=2.0146, vae=1.0821, dsb=0.9325, bio=0.0000
    Epoch  4/10: total=2.0031, vae=1.0820, dsb=0.9210, bio=0.0000
    Epoch  5/10: total=2.0095, vae=1.0820, dsb=0.9275, bio=0.0000
    Epoch  6/10: total=1.9601, vae=1.0813, dsb=0.8788, bio=0.0000
    Epoch  7/10: total=1.9604, vae=1.0807, dsb=0.8797, bio=0.0000
    Epoch  8/10: total=1.9497, vae=1.0824, dsb=0.8673, bio=0.0000
    Epoch  9/10: total=1.9385, vae=1.0823, dsb=0.8563, bio=0.0000
    Epoch 10/10: total=1.9554, vae=1.0821, dsb=0.8734, bio=0.0000

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=49.3253, vae=1.0819, dsb=48.2433, bio=0.0000
    Epoch  2/10: total=46.7534, vae=1.0822, dsb=45.6712, bio=0.0000
    Epoch  3/10: total=45.6068, vae=1.0811, dsb=44.5257, bio=0.0000
    Epoch  4/10: total=45.1060, vae=1.0817, dsb=44.0242, bio=0.0000
    Epoch  5/10: total=44.9703, vae=1.0816, dsb=43.8887, bio=0.0000
    Epoch  6/10: total=44.8046, vae=1.0815, dsb=43.7232, bio=0.0000
    Epoch  7/10: total=44.6799, vae=1.0817, dsb=43.5982, bio=0.0000
    Epoch  8/10: total=44.4555, vae=1.0818, dsb=43.3736, bio=0.0000
    Epoch  9/10: total=44.3588, vae=1.0814, dsb=43.2773, bio=0.0000
    Epoch 10/10: total=44.2222, vae=1.0815, dsb=43.1407, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.8669, vae=1.0814, dsb=0.7855, bio=0.0000
    Epoch  2/10: total=1.7669, vae=1.0825, dsb=0.6844, bio=0.0000
    Epoch  3/10: total=1.7734, vae=1.0813, dsb=0.6920, bio=0.0000
    Epoch  4/10: total=1.7642, vae=1.0822, dsb=0.6819, bio=0.0000
    Epoch  5/10: total=1.7463, vae=1.0812, dsb=0.6650, bio=0.0000
    Epoch  6/10: total=1.7480, vae=1.0820, dsb=0.6660, bio=0.0000
    Epoch  7/10: total=1.7372, vae=1.0815, dsb=0.6557, bio=0.0000
    Epoch  8/10: total=1.7372, vae=1.0814, dsb=0.6558, bio=0.0000
    Epoch  9/10: total=1.7229, vae=1.0819, dsb=0.6410, bio=0.0000
    Epoch 10/10: total=1.7246, vae=1.0825, dsb=0.6421, bio=0.0000

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=41.5920, vae=1.0806, dsb=40.5113, bio=0.0000
    Epoch  2/10: total=40.3075, vae=1.0819, dsb=39.2255, bio=0.0000
    Epoch  3/10: total=39.8794, vae=1.0817, dsb=38.7978, bio=0.0000
    Epoch  4/10: total=40.1417, vae=1.0814, dsb=39.0604, bio=0.0000
    Epoch  5/10: total=39.9456, vae=1.0824, dsb=38.8633, bio=0.0000
    Epoch  6/10: total=39.8694, vae=1.0816, dsb=38.7878, bio=0.0000
    Epoch  7/10: total=39.9865, vae=1.0814, dsb=38.9051, bio=0.0000
    Epoch  8/10: total=39.8192, vae=1.0819, dsb=38.7373, bio=0.0000
    Epoch  9/10: total=39.7381, vae=1.0818, dsb=38.6563, bio=0.0000
    Epoch 10/10: total=39.6326, vae=1.0819, dsb=38.5507, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.6378, vae=1.0813, dsb=0.5565, bio=0.0000
    Epoch  2/10: total=1.6022, vae=1.0817, dsb=0.5205, bio=0.0000
    Epoch  3/10: total=1.6004, vae=1.0818, dsb=0.5186, bio=0.0000
    Epoch  4/10: total=1.5888, vae=1.0824, dsb=0.5064, bio=0.0000
    Epoch  5/10: total=1.6010, vae=1.0815, dsb=0.5196, bio=0.0000
    Epoch  6/10: total=1.5704, vae=1.0813, dsb=0.4891, bio=0.0000
    Epoch  7/10: total=1.5724, vae=1.0817, dsb=0.4907, bio=0.0000
    Epoch  8/10: total=1.5830, vae=1.0809, dsb=0.5021, bio=0.0000
    Epoch  9/10: total=1.5841, vae=1.0814, dsb=0.5028, bio=0.0000
    Epoch 10/10: total=1.5886, vae=1.0822, dsb=0.5064, bio=0.0000

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=34.9275, vae=1.0823, dsb=33.8452, bio=0.0000
    Epoch  2/10: total=34.5248, vae=1.0815, dsb=33.4433, bio=0.0000
    Epoch  3/10: total=34.5000, vae=1.0815, dsb=33.4185, bio=0.0000
    Epoch  4/10: total=34.3633, vae=1.0817, dsb=33.2816, bio=0.0000
    Epoch  5/10: total=34.4590, vae=1.0816, dsb=33.3774, bio=0.0000
    Epoch  6/10: total=34.4501, vae=1.0810, dsb=33.3691, bio=0.0000
    Epoch  7/10: total=34.3621, vae=1.0821, dsb=33.2800, bio=0.0000
    Epoch  8/10: total=34.4000, vae=1.0818, dsb=33.3182, bio=0.0000
    Epoch  9/10: total=34.4779, vae=1.0816, dsb=33.3962, bio=0.0000
    Epoch 10/10: total=34.4119, vae=1.0815, dsb=33.3305, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.5069, vae=1.0821, dsb=0.4248, bio=0.0000
    Epoch  2/10: total=1.5064, vae=1.0825, dsb=0.4239, bio=0.0000
    Epoch  3/10: total=1.5028, vae=1.0826, dsb=0.4202, bio=0.0000
    Epoch  4/10: total=1.4977, vae=1.0815, dsb=0.4162, bio=0.0000
    Epoch  5/10: total=1.4864, vae=1.0829, dsb=0.4036, bio=0.0000
    Epoch  6/10: total=1.4932, vae=1.0811, dsb=0.4121, bio=0.0000
    Epoch  7/10: total=1.5078, vae=1.0823, dsb=0.4255, bio=0.0000
    Epoch  8/10: total=1.4890, vae=1.0820, dsb=0.4070, bio=0.0000
    Epoch  9/10: total=1.4930, vae=1.0821, dsb=0.4110, bio=0.0000
    Epoch 10/10: total=1.4867, vae=1.0822, dsb=0.4045, bio=0.0000

[Seed 92] Joint training (ablation) complete; models and history saved.

[Seed 92] Drift genes saved in /home/yyuan/ICB_TCE/iter_results/run_092

[Seed 92] run finished.

================================================================================
[Seed 93] Starting running whole pipeline...
================================================================================

[Seed 93] Starting VAE pre-training...

    Epoch [01/20], Beta: 0.000, Average Loss: 536.5083
    Epoch [02/20], Beta: 0.000, Average Loss: 303.4299
    Epoch [03/20], Beta: 0.000, Average Loss: 267.4891
    Epoch [04/20], Beta: 0.000, Average Loss: 248.8720
    Epoch [05/20], Beta: 0.100, Average Loss: 244.4655
    Epoch [06/20], Beta: 0.200, Average Loss: 243.8547
    Epoch [07/20], Beta: 0.300, Average Loss: 244.3791
    Epoch [08/20], Beta: 0.400, Average Loss: 245.1362
    Epoch [09/20], Beta: 0.500, Average Loss: 246.0871
    Epoch [10/20], Beta: 0.600, Average Loss: 247.2970
    Epoch [11/20], Beta: 0.700, Average Loss: 248.5682
    Epoch [12/20], Beta: 0.800, Average Loss: 249.8806
    Epoch [13/20], Beta: 0.900, Average Loss: 251.2092
    Epoch [14/20], Beta: 1.000, Average Loss: 252.8183
    Epoch [15/20], Beta: 1.000, Average Loss: 252.3923
    Epoch [16/20], Beta: 1.000, Average Loss: 252.0660
    Epoch [17/20], Beta: 1.000, Average Loss: 251.7513
    Epoch [18/20], Beta: 1.000, Average Loss: 251.4679
    Epoch [19/20], Beta: 1.000, Average Loss: 251.1099
    Epoch [20/20], Beta: 1.000, Average Loss: 250.9276

[Seed 93] VAE pre-training complete.

[Seed 93] Starting joint training (original)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=582.9378, vae=3.6111, dsb=561.8328, bio=34.9878
    Epoch  2/10: total=141.1519, vae=1.1030, dsb=140.0196, bio=0.0585
    Epoch  3/10: total=128.8531, vae=1.0975, dsb=127.7420, bio=0.0271
    Epoch  4/10: total=123.9077, vae=1.0964, dsb=122.8033, bio=0.0160
    Epoch  5/10: total=120.5230, vae=1.0954, dsb=119.4222, bio=0.0107
    Epoch  6/10: total=117.8631, vae=1.0945, dsb=116.7645, bio=0.0079
    Epoch  7/10: total=116.6549, vae=1.0947, dsb=115.5570, bio=0.0062
    Epoch  8/10: total=114.9857, vae=1.0929, dsb=113.8902, bio=0.0053
    Epoch  9/10: total=114.2491, vae=1.0934, dsb=113.1534, bio=0.0045
    Epoch 10/10: total=113.0868, vae=1.0933, dsb=111.9915, bio=0.0040

  [Backward Policy Training]
    Epoch  1/10: total=3.5520, vae=1.0938, dsb=2.4515, bio=0.0134
    Epoch  2/10: total=3.0729, vae=1.0928, dsb=1.9779, bio=0.0043
    Epoch  3/10: total=2.9297, vae=1.0918, dsb=1.8363, bio=0.0031
    Epoch  4/10: total=2.8495, vae=1.0917, dsb=1.7565, bio=0.0027
    Epoch  5/10: total=2.8209, vae=1.0922, dsb=1.7275, bio=0.0023
    Epoch  6/10: total=2.8071, vae=1.0917, dsb=1.7143, bio=0.0021
    Epoch  7/10: total=2.7541, vae=1.0910, dsb=1.6620, bio=0.0021
    Epoch  8/10: total=2.7530, vae=1.0914, dsb=1.6606, bio=0.0020
    Epoch  9/10: total=2.7485, vae=1.0898, dsb=1.6578, bio=0.0019
    Epoch 10/10: total=2.6619, vae=1.0910, dsb=1.5700, bio=0.0018

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=100.9308, vae=1.0938, dsb=99.8345, bio=0.0050
    Epoch  2/10: total=95.8738, vae=1.0930, dsb=94.7799, bio=0.0018
    Epoch  3/10: total=93.8103, vae=1.0926, dsb=92.7168, bio=0.0018
    Epoch  4/10: total=93.2542, vae=1.0925, dsb=92.1609, bio=0.0018
    Epoch  5/10: total=92.9377, vae=1.0938, dsb=91.8430, bio=0.0018
    Epoch  6/10: total=92.8456, vae=1.0910, dsb=91.7535, bio=0.0021
    Epoch  7/10: total=92.3022, vae=1.0913, dsb=91.2100, bio=0.0018
    Epoch  8/10: total=91.4549, vae=1.0912, dsb=90.3628, bio=0.0017
    Epoch  9/10: total=91.1683, vae=1.0909, dsb=90.0765, bio=0.0017
    Epoch 10/10: total=91.8483, vae=1.0909, dsb=90.7565, bio=0.0017

  [Backward Policy Training]
    Epoch  1/10: total=2.4071, vae=1.0914, dsb=1.3121, bio=0.0073
    Epoch  2/10: total=2.2840, vae=1.0908, dsb=1.1923, bio=0.0018
    Epoch  3/10: total=2.2454, vae=1.0910, dsb=1.1535, bio=0.0016
    Epoch  4/10: total=2.2682, vae=1.0896, dsb=1.1778, bio=0.0016
    Epoch  5/10: total=2.2331, vae=1.0891, dsb=1.1432, bio=0.0016
    Epoch  6/10: total=2.2180, vae=1.0902, dsb=1.1271, bio=0.0014
    Epoch  7/10: total=2.2242, vae=1.0894, dsb=1.1341, bio=0.0014
    Epoch  8/10: total=2.1814, vae=1.0899, dsb=1.0909, bio=0.0014
    Epoch  9/10: total=2.2252, vae=1.0899, dsb=1.1346, bio=0.0014
    Epoch 10/10: total=2.1781, vae=1.0900, dsb=1.0874, bio=0.0015

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=80.7206, vae=1.0924, dsb=79.6268, bio=0.0027
    Epoch  2/10: total=78.8328, vae=1.0907, dsb=77.7414, bio=0.0014
    Epoch  3/10: total=78.8336, vae=1.0907, dsb=77.7423, bio=0.0011
    Epoch  4/10: total=78.0698, vae=1.0910, dsb=76.9780, bio=0.0017
    Epoch  5/10: total=77.6627, vae=1.0898, dsb=76.5722, bio=0.0014
    Epoch  6/10: total=77.8389, vae=1.0911, dsb=76.7471, bio=0.0014
    Epoch  7/10: total=78.0815, vae=1.0901, dsb=76.9907, bio=0.0014
    Epoch  8/10: total=77.6886, vae=1.0908, dsb=76.5971, bio=0.0014
    Epoch  9/10: total=77.1560, vae=1.0902, dsb=76.0651, bio=0.0014
    Epoch 10/10: total=77.2114, vae=1.0894, dsb=76.1213, bio=0.0013

  [Backward Policy Training]
    Epoch  1/10: total=2.0797, vae=1.0903, dsb=0.9700, bio=0.0388
    Epoch  2/10: total=2.0245, vae=1.0895, dsb=0.9343, bio=0.0015
    Epoch  3/10: total=1.9832, vae=1.0889, dsb=0.8937, bio=0.0013
    Epoch  4/10: total=2.0065, vae=1.0896, dsb=0.9163, bio=0.0012
    Epoch  5/10: total=1.9810, vae=1.0885, dsb=0.8919, bio=0.0012
    Epoch  6/10: total=2.0020, vae=1.0889, dsb=0.9124, bio=0.0012
    Epoch  7/10: total=1.9739, vae=1.0889, dsb=0.8844, bio=0.0011
    Epoch  8/10: total=1.9997, vae=1.0894, dsb=0.9098, bio=0.0011
    Epoch  9/10: total=1.9594, vae=1.0888, dsb=0.8700, bio=0.0011
    Epoch 10/10: total=1.9842, vae=1.0888, dsb=0.8949, bio=0.0010

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=67.9719, vae=1.0914, dsb=66.8793, bio=0.0023
    Epoch  2/10: total=67.3603, vae=1.0899, dsb=66.2692, bio=0.0024
    Epoch  3/10: total=67.3714, vae=1.0899, dsb=66.2809, bio=0.0011
    Epoch  4/10: total=67.2589, vae=1.0897, dsb=66.1686, bio=0.0011
    Epoch  5/10: total=67.0526, vae=1.0894, dsb=65.9626, bio=0.0011
    Epoch  6/10: total=66.8777, vae=1.0889, dsb=65.7883, bio=0.0011
    Epoch  7/10: total=66.9250, vae=1.0900, dsb=65.8345, bio=0.0011
    Epoch  8/10: total=67.0884, vae=1.0890, dsb=65.9990, bio=0.0010
    Epoch  9/10: total=67.0034, vae=1.0894, dsb=65.9138, bio=0.0004
    Epoch 10/10: total=67.0988, vae=1.0888, dsb=66.0094, bio=0.0012

  [Backward Policy Training]
    Epoch  1/10: total=1.9526, vae=1.0902, dsb=0.7933, bio=0.1382
    Epoch  2/10: total=1.8473, vae=1.0899, dsb=0.7568, bio=0.0013
    Epoch  3/10: total=1.8404, vae=1.0876, dsb=0.7523, bio=0.0011
    Epoch  4/10: total=1.8454, vae=1.0894, dsb=0.7558, bio=0.0006
    Epoch  5/10: total=1.8215, vae=1.0893, dsb=0.7316, bio=0.0012
    Epoch  6/10: total=1.8322, vae=1.0884, dsb=0.7433, bio=0.0010
    Epoch  7/10: total=1.8425, vae=1.0892, dsb=0.7527, bio=0.0010
    Epoch  8/10: total=1.8265, vae=1.0889, dsb=0.7371, bio=0.0010
    Epoch  9/10: total=1.8285, vae=1.0890, dsb=0.7392, bio=0.0006
    Epoch 10/10: total=1.8292, vae=1.0895, dsb=0.7391, bio=0.0011

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=57.4291, vae=1.0915, dsb=56.3363, bio=0.0025
    Epoch  2/10: total=57.2153, vae=1.0901, dsb=56.1247, bio=0.0010
    Epoch  3/10: total=56.8822, vae=1.0894, dsb=55.7923, bio=0.0009
    Epoch  4/10: total=57.0659, vae=1.0894, dsb=55.9763, bio=0.0004
    Epoch  5/10: total=57.0892, vae=1.0886, dsb=56.0000, bio=0.0013
    Epoch  6/10: total=56.8750, vae=1.0885, dsb=55.7859, bio=0.0011
    Epoch  7/10: total=56.9520, vae=1.0898, dsb=55.8618, bio=0.0009
    Epoch  8/10: total=56.9814, vae=1.0890, dsb=55.8921, bio=0.0006
    Epoch  9/10: total=56.9701, vae=1.0887, dsb=55.8813, bio=0.0004
    Epoch 10/10: total=56.7844, vae=1.0887, dsb=55.6952, bio=0.0010

  [Backward Policy Training]
    Epoch  1/10: total=1.9042, vae=1.0898, dsb=0.7116, bio=0.2058
    Epoch  2/10: total=1.7998, vae=1.0891, dsb=0.7101, bio=0.0013
    Epoch  3/10: total=1.7670, vae=1.0889, dsb=0.6776, bio=0.0011
    Epoch  4/10: total=1.7933, vae=1.0887, dsb=0.7044, bio=0.0004
    Epoch  5/10: total=1.7894, vae=1.0885, dsb=0.7006, bio=0.0008
    Epoch  6/10: total=1.7596, vae=1.0883, dsb=0.6708, bio=0.0010
    Epoch  7/10: total=1.7798, vae=1.0886, dsb=0.6907, bio=0.0010
    Epoch  8/10: total=1.7728, vae=1.0875, dsb=0.6849, bio=0.0010
    Epoch  9/10: total=1.7923, vae=1.0878, dsb=0.7043, bio=0.0003
    Epoch 10/10: total=1.7646, vae=1.0880, dsb=0.6763, bio=0.0006

[Seed 93] Joint training (original) complete; models and history saved.

[Seed 93] Starting joint training (ablation)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=563.0654, vae=2.0512, dsb=561.0142, bio=0.0000
    Epoch  2/10: total=140.2780, vae=1.0855, dsb=139.1924, bio=0.0000
    Epoch  3/10: total=128.0478, vae=1.0831, dsb=126.9646, bio=0.0000
    Epoch  4/10: total=123.0872, vae=1.0831, dsb=122.0041, bio=0.0000
    Epoch  5/10: total=119.9693, vae=1.0825, dsb=118.8868, bio=0.0000
    Epoch  6/10: total=117.4555, vae=1.0819, dsb=116.3736, bio=0.0000
    Epoch  7/10: total=116.2270, vae=1.0824, dsb=115.1446, bio=0.0000
    Epoch  8/10: total=114.6071, vae=1.0809, dsb=113.5262, bio=0.0000
    Epoch  9/10: total=113.9143, vae=1.0817, dsb=112.8326, bio=0.0000
    Epoch 10/10: total=112.7652, vae=1.0818, dsb=111.6834, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=3.4331, vae=1.0813, dsb=2.3518, bio=0.0000
    Epoch  2/10: total=2.9792, vae=1.0820, dsb=1.8971, bio=0.0000
    Epoch  3/10: total=2.8385, vae=1.0815, dsb=1.7570, bio=0.0000
    Epoch  4/10: total=2.7598, vae=1.0816, dsb=1.6782, bio=0.0000
    Epoch  5/10: total=2.7327, vae=1.0824, dsb=1.6503, bio=0.0000
    Epoch  6/10: total=2.7193, vae=1.0820, dsb=1.6373, bio=0.0000
    Epoch  7/10: total=2.6690, vae=1.0814, dsb=1.5877, bio=0.0000
    Epoch  8/10: total=2.6687, vae=1.0818, dsb=1.5869, bio=0.0000
    Epoch  9/10: total=2.6640, vae=1.0803, dsb=1.5838, bio=0.0000
    Epoch 10/10: total=2.5823, vae=1.0815, dsb=1.5007, bio=0.0000

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=97.0684, vae=1.0815, dsb=95.9869, bio=0.0000
    Epoch  2/10: total=92.0689, vae=1.0820, dsb=90.9869, bio=0.0000
    Epoch  3/10: total=90.1706, vae=1.0818, dsb=89.0888, bio=0.0000
    Epoch  4/10: total=89.6855, vae=1.0819, dsb=88.6035, bio=0.0000
    Epoch  5/10: total=89.3888, vae=1.0834, dsb=88.3054, bio=0.0000
    Epoch  6/10: total=89.2876, vae=1.0807, dsb=88.2069, bio=0.0000
    Epoch  7/10: total=88.7930, vae=1.0813, dsb=87.7118, bio=0.0000
    Epoch  8/10: total=87.9881, vae=1.0813, dsb=86.9068, bio=0.0000
    Epoch  9/10: total=87.7287, vae=1.0810, dsb=86.6476, bio=0.0000
    Epoch 10/10: total=88.3246, vae=1.0812, dsb=87.2434, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=2.3195, vae=1.0811, dsb=1.2384, bio=0.0000
    Epoch  2/10: total=2.2086, vae=1.0817, dsb=1.1269, bio=0.0000
    Epoch  3/10: total=2.1751, vae=1.0821, dsb=1.0930, bio=0.0000
    Epoch  4/10: total=2.1988, vae=1.0808, dsb=1.1180, bio=0.0000
    Epoch  5/10: total=2.1667, vae=1.0804, dsb=1.0863, bio=0.0000
    Epoch  6/10: total=2.1521, vae=1.0815, dsb=1.0706, bio=0.0000
    Epoch  7/10: total=2.1583, vae=1.0808, dsb=1.0775, bio=0.0000
    Epoch  8/10: total=2.1170, vae=1.0813, dsb=1.0357, bio=0.0000
    Epoch  9/10: total=2.1589, vae=1.0814, dsb=1.0775, bio=0.0000
    Epoch 10/10: total=2.1127, vae=1.0814, dsb=1.0313, bio=0.0000

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=78.6526, vae=1.0812, dsb=77.5714, bio=0.0000
    Epoch  2/10: total=76.8078, vae=1.0809, dsb=75.7269, bio=0.0000
    Epoch  3/10: total=76.8329, vae=1.0813, dsb=75.7517, bio=0.0000
    Epoch  4/10: total=76.0958, vae=1.0817, dsb=75.0141, bio=0.0000
    Epoch  5/10: total=75.6619, vae=1.0806, dsb=74.5812, bio=0.0000
    Epoch  6/10: total=75.8877, vae=1.0820, dsb=74.8057, bio=0.0000
    Epoch  7/10: total=76.0587, vae=1.0811, dsb=74.9776, bio=0.0000
    Epoch  8/10: total=75.6740, vae=1.0819, dsb=74.5921, bio=0.0000
    Epoch  9/10: total=75.2040, vae=1.0814, dsb=74.1226, bio=0.0000
    Epoch 10/10: total=75.2524, vae=1.0806, dsb=74.1717, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.9799, vae=1.0809, dsb=0.8989, bio=0.0000
    Epoch  2/10: total=1.9505, vae=1.0812, dsb=0.8693, bio=0.0000
    Epoch  3/10: total=1.9126, vae=1.0806, dsb=0.8320, bio=0.0000
    Epoch  4/10: total=1.9360, vae=1.0815, dsb=0.8545, bio=0.0000
    Epoch  5/10: total=1.9118, vae=1.0805, dsb=0.8313, bio=0.0000
    Epoch  6/10: total=1.9329, vae=1.0808, dsb=0.8521, bio=0.0000
    Epoch  7/10: total=1.9064, vae=1.0809, dsb=0.8255, bio=0.0000
    Epoch  8/10: total=1.9316, vae=1.0813, dsb=0.8503, bio=0.0000
    Epoch  9/10: total=1.8930, vae=1.0808, dsb=0.8122, bio=0.0000
    Epoch 10/10: total=1.9168, vae=1.0808, dsb=0.8360, bio=0.0000

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=66.2391, vae=1.0809, dsb=65.1582, bio=0.0000
    Epoch  2/10: total=65.5732, vae=1.0806, dsb=64.4926, bio=0.0000
    Epoch  3/10: total=65.5851, vae=1.0810, dsb=64.5041, bio=0.0000
    Epoch  4/10: total=65.4496, vae=1.0810, dsb=64.3686, bio=0.0000
    Epoch  5/10: total=65.2541, vae=1.0809, dsb=64.1733, bio=0.0000
    Epoch  6/10: total=65.0966, vae=1.0804, dsb=64.0162, bio=0.0000
    Epoch  7/10: total=65.2369, vae=1.0817, dsb=64.1552, bio=0.0000
    Epoch  8/10: total=65.3410, vae=1.0807, dsb=64.2603, bio=0.0000
    Epoch  9/10: total=65.1924, vae=1.0812, dsb=64.1112, bio=0.0000
    Epoch 10/10: total=65.3026, vae=1.0809, dsb=64.2217, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.8132, vae=1.0810, dsb=0.7322, bio=0.0000
    Epoch  2/10: total=1.7808, vae=1.0819, dsb=0.6989, bio=0.0000
    Epoch  3/10: total=1.7745, vae=1.0797, dsb=0.6949, bio=0.0000
    Epoch  4/10: total=1.7795, vae=1.0814, dsb=0.6981, bio=0.0000
    Epoch  5/10: total=1.7571, vae=1.0815, dsb=0.6756, bio=0.0000
    Epoch  6/10: total=1.7672, vae=1.0807, dsb=0.6865, bio=0.0000
    Epoch  7/10: total=1.7776, vae=1.0815, dsb=0.6961, bio=0.0000
    Epoch  8/10: total=1.7619, vae=1.0812, dsb=0.6807, bio=0.0000
    Epoch  9/10: total=1.7638, vae=1.0813, dsb=0.6826, bio=0.0000
    Epoch 10/10: total=1.7649, vae=1.0820, dsb=0.6830, bio=0.0000

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=56.1646, vae=1.0810, dsb=55.0835, bio=0.0000
    Epoch  2/10: total=55.9712, vae=1.0811, dsb=54.8901, bio=0.0000
    Epoch  3/10: total=55.6785, vae=1.0810, dsb=54.5976, bio=0.0000
    Epoch  4/10: total=55.9102, vae=1.0813, dsb=54.8289, bio=0.0000
    Epoch  5/10: total=55.9243, vae=1.0806, dsb=54.8436, bio=0.0000
    Epoch  6/10: total=55.7142, vae=1.0807, dsb=54.6336, bio=0.0000
    Epoch  7/10: total=55.7467, vae=1.0820, dsb=54.6647, bio=0.0000
    Epoch  8/10: total=55.8313, vae=1.0813, dsb=54.7500, bio=0.0000
    Epoch  9/10: total=55.7607, vae=1.0810, dsb=54.6798, bio=0.0000
    Epoch 10/10: total=55.6038, vae=1.0811, dsb=54.5226, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.7402, vae=1.0809, dsb=0.6593, bio=0.0000
    Epoch  2/10: total=1.7402, vae=1.0814, dsb=0.6588, bio=0.0000
    Epoch  3/10: total=1.7091, vae=1.0813, dsb=0.6278, bio=0.0000
    Epoch  4/10: total=1.7348, vae=1.0811, dsb=0.6537, bio=0.0000
    Epoch  5/10: total=1.7309, vae=1.0811, dsb=0.6498, bio=0.0000
    Epoch  6/10: total=1.7033, vae=1.0812, dsb=0.6221, bio=0.0000
    Epoch  7/10: total=1.7220, vae=1.0815, dsb=0.6405, bio=0.0000
    Epoch  8/10: total=1.7159, vae=1.0804, dsb=0.6354, bio=0.0000
    Epoch  9/10: total=1.7347, vae=1.0808, dsb=0.6540, bio=0.0000
    Epoch 10/10: total=1.7082, vae=1.0812, dsb=0.6270, bio=0.0000

[Seed 93] Joint training (ablation) complete; models and history saved.

[Seed 93] Drift genes saved in /home/yyuan/ICB_TCE/iter_results/run_093

[Seed 93] run finished.

================================================================================
[Seed 94] Starting running whole pipeline...
================================================================================

[Seed 94] Starting VAE pre-training...

    Epoch [01/20], Beta: 0.000, Average Loss: 540.5311
    Epoch [02/20], Beta: 0.000, Average Loss: 310.2747
    Epoch [03/20], Beta: 0.000, Average Loss: 269.1234
    Epoch [04/20], Beta: 0.000, Average Loss: 249.0453
    Epoch [05/20], Beta: 0.100, Average Loss: 245.4888
    Epoch [06/20], Beta: 0.200, Average Loss: 244.7346
    Epoch [07/20], Beta: 0.300, Average Loss: 244.9534
    Epoch [08/20], Beta: 0.400, Average Loss: 245.6123
    Epoch [09/20], Beta: 0.500, Average Loss: 246.6441
    Epoch [10/20], Beta: 0.600, Average Loss: 247.8081
    Epoch [11/20], Beta: 0.700, Average Loss: 249.1102
    Epoch [12/20], Beta: 0.800, Average Loss: 250.4022
    Epoch [13/20], Beta: 0.900, Average Loss: 251.6643
    Epoch [14/20], Beta: 1.000, Average Loss: 253.2780
    Epoch [15/20], Beta: 1.000, Average Loss: 252.8820
    Epoch [16/20], Beta: 1.000, Average Loss: 252.5275
    Epoch [17/20], Beta: 1.000, Average Loss: 252.1497
    Epoch [18/20], Beta: 1.000, Average Loss: 251.8270
    Epoch [19/20], Beta: 1.000, Average Loss: 251.4845
    Epoch [20/20], Beta: 1.000, Average Loss: 251.3144

[Seed 94] VAE pre-training complete.

[Seed 94] Starting joint training (original)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=180.4328, vae=3.6632, dsb=147.8797, bio=57.7797
    Epoch  2/10: total=47.5709, vae=1.1062, dsb=46.4128, bio=0.1039
    Epoch  3/10: total=38.1809, vae=1.1002, dsb=37.0588, bio=0.0440
    Epoch  4/10: total=33.7508, vae=1.0977, dsb=32.6398, bio=0.0264
    Epoch  5/10: total=30.9361, vae=1.0970, dsb=29.8301, bio=0.0180
    Epoch  6/10: total=29.0335, vae=1.0968, dsb=27.9302, bio=0.0132
    Epoch  7/10: total=27.6636, vae=1.0957, dsb=26.5628, bio=0.0103
    Epoch  8/10: total=26.6163, vae=1.0964, dsb=25.5158, bio=0.0083
    Epoch  9/10: total=25.7969, vae=1.0954, dsb=24.6981, bio=0.0068
    Epoch 10/10: total=25.1563, vae=1.0953, dsb=24.0581, bio=0.0058

  [Backward Policy Training]
    Epoch  1/10: total=3.0064, vae=1.0951, dsb=1.9041, bio=0.0144
    Epoch  2/10: total=2.4876, vae=1.0954, dsb=1.3895, bio=0.0054
    Epoch  3/10: total=2.3618, vae=1.0941, dsb=1.2658, bio=0.0039
    Epoch  4/10: total=2.2981, vae=1.0938, dsb=1.2028, bio=0.0032
    Epoch  5/10: total=2.2714, vae=1.0933, dsb=1.1767, bio=0.0028
    Epoch  6/10: total=2.2198, vae=1.0933, dsb=1.1252, bio=0.0025
    Epoch  7/10: total=2.1935, vae=1.0930, dsb=1.0993, bio=0.0024
    Epoch  8/10: total=2.1700, vae=1.0929, dsb=1.0760, bio=0.0022
    Epoch  9/10: total=2.1579, vae=1.0933, dsb=1.0636, bio=0.0021
    Epoch 10/10: total=2.1740, vae=1.0930, dsb=1.0800, bio=0.0020

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=26.6599, vae=1.0955, dsb=25.5626, bio=0.0035
    Epoch  2/10: total=19.6226, vae=1.0947, dsb=18.5268, bio=0.0020
    Epoch  3/10: total=17.9379, vae=1.0939, dsb=16.8431, bio=0.0019
    Epoch  4/10: total=17.0251, vae=1.0940, dsb=15.9302, bio=0.0019
    Epoch  5/10: total=16.3782, vae=1.0935, dsb=15.2839, bio=0.0019
    Epoch  6/10: total=16.0160, vae=1.0932, dsb=14.9219, bio=0.0019
    Epoch  7/10: total=15.6478, vae=1.0930, dsb=14.5539, bio=0.0019
    Epoch  8/10: total=15.3604, vae=1.0928, dsb=14.2666, bio=0.0019
    Epoch  9/10: total=15.1792, vae=1.0917, dsb=14.0865, bio=0.0019
    Epoch 10/10: total=14.9753, vae=1.0931, dsb=13.8813, bio=0.0019

  [Backward Policy Training]
    Epoch  1/10: total=1.9261, vae=1.0928, dsb=0.8309, bio=0.0047
    Epoch  2/10: total=1.7958, vae=1.0929, dsb=0.7020, bio=0.0019
    Epoch  3/10: total=1.7509, vae=1.0908, dsb=0.6592, bio=0.0017
    Epoch  4/10: total=1.7229, vae=1.0918, dsb=0.6303, bio=0.0017
    Epoch  5/10: total=1.7350, vae=1.0924, dsb=0.6417, bio=0.0016
    Epoch  6/10: total=1.6967, vae=1.0911, dsb=0.6048, bio=0.0016
    Epoch  7/10: total=1.6848, vae=1.0909, dsb=0.5931, bio=0.0016
    Epoch  8/10: total=1.6812, vae=1.0919, dsb=0.5885, bio=0.0016
    Epoch  9/10: total=1.6749, vae=1.0911, dsb=0.5830, bio=0.0015
    Epoch 10/10: total=1.6569, vae=1.0915, dsb=0.5646, bio=0.0018

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=16.2405, vae=1.0946, dsb=15.1443, bio=0.0030
    Epoch  2/10: total=13.4614, vae=1.0926, dsb=12.3680, bio=0.0017
    Epoch  3/10: total=12.6931, vae=1.0928, dsb=11.5995, bio=0.0017
    Epoch  4/10: total=12.3264, vae=1.0924, dsb=11.2331, bio=0.0016
    Epoch  5/10: total=12.0447, vae=1.0924, dsb=10.9515, bio=0.0016
    Epoch  6/10: total=11.8557, vae=1.0930, dsb=10.7618, bio=0.0017
    Epoch  7/10: total=11.7272, vae=1.0930, dsb=10.6334, bio=0.0016
    Epoch  8/10: total=11.5684, vae=1.0932, dsb=10.4744, bio=0.0016
    Epoch  9/10: total=11.4753, vae=1.0930, dsb=10.3815, bio=0.0016
    Epoch 10/10: total=11.4081, vae=1.0917, dsb=10.3156, bio=0.0016

  [Backward Policy Training]
    Epoch  1/10: total=1.5662, vae=1.0925, dsb=0.4713, bio=0.0049
    Epoch  2/10: total=1.5031, vae=1.0912, dsb=0.4111, bio=0.0015
    Epoch  3/10: total=1.5018, vae=1.0913, dsb=0.4098, bio=0.0014
    Epoch  4/10: total=1.4916, vae=1.0915, dsb=0.3994, bio=0.0014
    Epoch  5/10: total=1.4736, vae=1.0911, dsb=0.3818, bio=0.0014
    Epoch  6/10: total=1.4779, vae=1.0904, dsb=0.3869, bio=0.0014
    Epoch  7/10: total=1.4674, vae=1.0914, dsb=0.3753, bio=0.0013
    Epoch  8/10: total=1.4545, vae=1.0902, dsb=0.3636, bio=0.0013
    Epoch  9/10: total=1.4586, vae=1.0914, dsb=0.3666, bio=0.0013
    Epoch 10/10: total=1.4580, vae=1.0912, dsb=0.3661, bio=0.0013

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=11.5792, vae=1.0938, dsb=10.4839, bio=0.0030
    Epoch  2/10: total=10.3006, vae=1.0922, dsb=9.2077, bio=0.0015
    Epoch  3/10: total=9.9627, vae=1.0920, dsb=8.8699, bio=0.0015
    Epoch  4/10: total=9.8016, vae=1.0917, dsb=8.7091, bio=0.0015
    Epoch  5/10: total=9.6835, vae=1.0914, dsb=8.5913, bio=0.0015
    Epoch  6/10: total=9.5748, vae=1.0927, dsb=8.4813, bio=0.0015
    Epoch  7/10: total=9.5378, vae=1.0923, dsb=8.4448, bio=0.0015
    Epoch  8/10: total=9.4646, vae=1.0920, dsb=8.3719, bio=0.0015
    Epoch  9/10: total=9.4561, vae=1.0913, dsb=8.3640, bio=0.0016
    Epoch 10/10: total=9.4034, vae=1.0919, dsb=8.3108, bio=0.0015

  [Backward Policy Training]
    Epoch  1/10: total=1.4058, vae=1.0917, dsb=0.3100, bio=0.0082
    Epoch  2/10: total=1.3713, vae=1.0903, dsb=0.2803, bio=0.0014
    Epoch  3/10: total=1.3648, vae=1.0907, dsb=0.2734, bio=0.0013
    Epoch  4/10: total=1.3575, vae=1.0909, dsb=0.2660, bio=0.0012
    Epoch  5/10: total=1.3528, vae=1.0906, dsb=0.2616, bio=0.0012
    Epoch  6/10: total=1.3500, vae=1.0898, dsb=0.2596, bio=0.0012
    Epoch  7/10: total=1.3459, vae=1.0909, dsb=0.2544, bio=0.0012
    Epoch  8/10: total=1.3440, vae=1.0913, dsb=0.2521, bio=0.0012
    Epoch  9/10: total=1.3456, vae=1.0912, dsb=0.2538, bio=0.0012
    Epoch 10/10: total=1.3405, vae=1.0899, dsb=0.2499, bio=0.0013

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=9.1221, vae=1.0925, dsb=8.0281, bio=0.0032
    Epoch  2/10: total=8.5928, vae=1.0925, dsb=7.4997, bio=0.0012
    Epoch  3/10: total=8.4604, vae=1.0929, dsb=7.3669, bio=0.0012
    Epoch  4/10: total=8.4276, vae=1.0918, dsb=7.3351, bio=0.0013
    Epoch  5/10: total=8.3627, vae=1.0914, dsb=7.2705, bio=0.0013
    Epoch  6/10: total=8.3772, vae=1.0917, dsb=7.2849, bio=0.0014
    Epoch  7/10: total=8.2900, vae=1.0908, dsb=7.1985, bio=0.0013
    Epoch  8/10: total=8.3064, vae=1.0913, dsb=7.2144, bio=0.0013
    Epoch  9/10: total=8.2853, vae=1.0916, dsb=7.1930, bio=0.0013
    Epoch 10/10: total=8.2661, vae=1.0913, dsb=7.1741, bio=0.0014

  [Backward Policy Training]
    Epoch  1/10: total=1.3106, vae=1.0917, dsb=0.2083, bio=0.0211
    Epoch  2/10: total=1.2923, vae=1.0909, dsb=0.2007, bio=0.0012
    Epoch  3/10: total=1.2914, vae=1.0904, dsb=0.2004, bio=0.0011
    Epoch  4/10: total=1.2850, vae=1.0899, dsb=0.1946, bio=0.0011
    Epoch  5/10: total=1.2775, vae=1.0901, dsb=0.1869, bio=0.0011
    Epoch  6/10: total=1.2874, vae=1.0905, dsb=0.1963, bio=0.0011
    Epoch  7/10: total=1.2762, vae=1.0903, dsb=0.1854, bio=0.0011
    Epoch  8/10: total=1.2789, vae=1.0907, dsb=0.1876, bio=0.0011
    Epoch  9/10: total=1.2736, vae=1.0898, dsb=0.1832, bio=0.0011
    Epoch 10/10: total=1.2825, vae=1.0897, dsb=0.1923, bio=0.0011

[Seed 94] Joint training (original) complete; models and history saved.

[Seed 94] Starting joint training (ablation)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=149.7604, vae=1.9975, dsb=147.7630, bio=0.0000
    Epoch  2/10: total=47.4241, vae=1.0882, dsb=46.3359, bio=0.0000
    Epoch  3/10: total=38.0297, vae=1.0855, dsb=36.9442, bio=0.0000
    Epoch  4/10: total=33.5291, vae=1.0842, dsb=32.4448, bio=0.0000
    Epoch  5/10: total=30.7658, vae=1.0840, dsb=29.6818, bio=0.0000
    Epoch  6/10: total=28.9503, vae=1.0841, dsb=27.8662, bio=0.0000
    Epoch  7/10: total=27.6271, vae=1.0833, dsb=26.5438, bio=0.0000
    Epoch  8/10: total=26.6069, vae=1.0843, dsb=25.5226, bio=0.0000
    Epoch  9/10: total=25.8072, vae=1.0836, dsb=24.7236, bio=0.0000
    Epoch 10/10: total=25.1787, vae=1.0837, dsb=24.0950, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=2.9412, vae=1.0828, dsb=1.8584, bio=0.0000
    Epoch  2/10: total=2.4425, vae=1.0845, dsb=1.3580, bio=0.0000
    Epoch  3/10: total=2.3196, vae=1.0836, dsb=1.2360, bio=0.0000
    Epoch  4/10: total=2.2579, vae=1.0835, dsb=1.1744, bio=0.0000
    Epoch  5/10: total=2.2323, vae=1.0833, dsb=1.1489, bio=0.0000
    Epoch  6/10: total=2.1814, vae=1.0835, dsb=1.0979, bio=0.0000
    Epoch  7/10: total=2.1555, vae=1.0833, dsb=1.0722, bio=0.0000
    Epoch  8/10: total=2.1331, vae=1.0833, dsb=1.0498, bio=0.0000
    Epoch  9/10: total=2.1220, vae=1.0838, dsb=1.0382, bio=0.0000
    Epoch 10/10: total=2.1387, vae=1.0836, dsb=1.0551, bio=0.0000

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=26.6295, vae=1.0834, dsb=25.5461, bio=0.0000
    Epoch  2/10: total=19.6113, vae=1.0839, dsb=18.5274, bio=0.0000
    Epoch  3/10: total=17.9525, vae=1.0833, dsb=16.8692, bio=0.0000
    Epoch  4/10: total=17.0476, vae=1.0835, dsb=15.9641, bio=0.0000
    Epoch  5/10: total=16.3815, vae=1.0831, dsb=15.2985, bio=0.0000
    Epoch  6/10: total=16.0134, vae=1.0829, dsb=14.9305, bio=0.0000
    Epoch  7/10: total=15.6389, vae=1.0828, dsb=14.5561, bio=0.0000
    Epoch  8/10: total=15.3536, vae=1.0827, dsb=14.2709, bio=0.0000
    Epoch  9/10: total=15.1971, vae=1.0818, dsb=14.1153, bio=0.0000
    Epoch 10/10: total=15.0181, vae=1.0832, dsb=13.9349, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.8884, vae=1.0827, dsb=0.8056, bio=0.0000
    Epoch  2/10: total=1.7681, vae=1.0840, dsb=0.6840, bio=0.0000
    Epoch  3/10: total=1.7253, vae=1.0821, dsb=0.6432, bio=0.0000
    Epoch  4/10: total=1.6992, vae=1.0832, dsb=0.6160, bio=0.0000
    Epoch  5/10: total=1.7118, vae=1.0839, dsb=0.6279, bio=0.0000
    Epoch  6/10: total=1.6744, vae=1.0826, dsb=0.5918, bio=0.0000
    Epoch  7/10: total=1.6626, vae=1.0825, dsb=0.5801, bio=0.0000
    Epoch  8/10: total=1.6596, vae=1.0834, dsb=0.5762, bio=0.0000
    Epoch  9/10: total=1.6532, vae=1.0828, dsb=0.5704, bio=0.0000
    Epoch 10/10: total=1.6362, vae=1.0831, dsb=0.5531, bio=0.0000

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=16.3188, vae=1.0833, dsb=15.2355, bio=0.0000
    Epoch  2/10: total=13.4571, vae=1.0827, dsb=12.3743, bio=0.0000
    Epoch  3/10: total=12.7162, vae=1.0832, dsb=11.6330, bio=0.0000
    Epoch  4/10: total=12.3498, vae=1.0830, dsb=11.2668, bio=0.0000
    Epoch  5/10: total=12.0737, vae=1.0830, dsb=10.9907, bio=0.0000
    Epoch  6/10: total=11.8799, vae=1.0837, dsb=10.7962, bio=0.0000
    Epoch  7/10: total=11.7472, vae=1.0836, dsb=10.6635, bio=0.0000
    Epoch  8/10: total=11.5961, vae=1.0839, dsb=10.5122, bio=0.0000
    Epoch  9/10: total=11.5049, vae=1.0838, dsb=10.4211, bio=0.0000
    Epoch 10/10: total=11.4460, vae=1.0825, dsb=10.3635, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.5403, vae=1.0832, dsb=0.4571, bio=0.0000
    Epoch  2/10: total=1.4818, vae=1.0830, dsb=0.3988, bio=0.0000
    Epoch  3/10: total=1.4821, vae=1.0832, dsb=0.3989, bio=0.0000
    Epoch  4/10: total=1.4725, vae=1.0835, dsb=0.3890, bio=0.0000
    Epoch  5/10: total=1.4553, vae=1.0831, dsb=0.3722, bio=0.0000
    Epoch  6/10: total=1.4600, vae=1.0825, dsb=0.3775, bio=0.0000
    Epoch  7/10: total=1.4494, vae=1.0835, dsb=0.3658, bio=0.0000
    Epoch  8/10: total=1.4371, vae=1.0823, dsb=0.3547, bio=0.0000
    Epoch  9/10: total=1.4408, vae=1.0836, dsb=0.3572, bio=0.0000
    Epoch 10/10: total=1.4403, vae=1.0834, dsb=0.3569, bio=0.0000

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=11.7202, vae=1.0833, dsb=10.6369, bio=0.0000
    Epoch  2/10: total=10.4833, vae=1.0830, dsb=9.4003, bio=0.0000
    Epoch  3/10: total=10.1368, vae=1.0830, dsb=9.0538, bio=0.0000
    Epoch  4/10: total=9.9958, vae=1.0828, dsb=8.9130, bio=0.0000
    Epoch  5/10: total=9.8687, vae=1.0825, dsb=8.7862, bio=0.0000
    Epoch  6/10: total=9.7555, vae=1.0839, dsb=8.6716, bio=0.0000
    Epoch  7/10: total=9.7164, vae=1.0835, dsb=8.6329, bio=0.0000
    Epoch  8/10: total=9.6331, vae=1.0833, dsb=8.5499, bio=0.0000
    Epoch  9/10: total=9.6359, vae=1.0826, dsb=8.5534, bio=0.0000
    Epoch 10/10: total=9.5856, vae=1.0833, dsb=8.5023, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.3886, vae=1.0830, dsb=0.3056, bio=0.0000
    Epoch  2/10: total=1.3606, vae=1.0826, dsb=0.2780, bio=0.0000
    Epoch  3/10: total=1.3552, vae=1.0831, dsb=0.2721, bio=0.0000
    Epoch  4/10: total=1.3485, vae=1.0834, dsb=0.2652, bio=0.0000
    Epoch  5/10: total=1.3441, vae=1.0831, dsb=0.2610, bio=0.0000
    Epoch  6/10: total=1.3416, vae=1.0823, dsb=0.2593, bio=0.0000
    Epoch  7/10: total=1.3376, vae=1.0835, dsb=0.2541, bio=0.0000
    Epoch  8/10: total=1.3355, vae=1.0839, dsb=0.2516, bio=0.0000
    Epoch  9/10: total=1.3373, vae=1.0840, dsb=0.2533, bio=0.0000
    Epoch 10/10: total=1.3319, vae=1.0828, dsb=0.2491, bio=0.0000

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=9.4052, vae=1.0823, dsb=8.3229, bio=0.0000
    Epoch  2/10: total=8.8182, vae=1.0835, dsb=7.7347, bio=0.0000
    Epoch  3/10: total=8.6852, vae=1.0841, dsb=7.6011, bio=0.0000
    Epoch  4/10: total=8.6505, vae=1.0832, dsb=7.5673, bio=0.0000
    Epoch  5/10: total=8.5867, vae=1.0829, dsb=7.5038, bio=0.0000
    Epoch  6/10: total=8.5960, vae=1.0833, dsb=7.5128, bio=0.0000
    Epoch  7/10: total=8.5140, vae=1.0824, dsb=7.4315, bio=0.0000
    Epoch  8/10: total=8.5277, vae=1.0830, dsb=7.4447, bio=0.0000
    Epoch  9/10: total=8.5080, vae=1.0834, dsb=7.4246, bio=0.0000
    Epoch 10/10: total=8.4875, vae=1.0831, dsb=7.4044, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.2918, vae=1.0831, dsb=0.2088, bio=0.0000
    Epoch  2/10: total=1.2838, vae=1.0834, dsb=0.2004, bio=0.0000
    Epoch  3/10: total=1.2830, vae=1.0831, dsb=0.1999, bio=0.0000
    Epoch  4/10: total=1.2765, vae=1.0827, dsb=0.1938, bio=0.0000
    Epoch  5/10: total=1.2689, vae=1.0831, dsb=0.1859, bio=0.0000
    Epoch  6/10: total=1.2788, vae=1.0835, dsb=0.1952, bio=0.0000
    Epoch  7/10: total=1.2677, vae=1.0835, dsb=0.1842, bio=0.0000
    Epoch  8/10: total=1.2704, vae=1.0839, dsb=0.1865, bio=0.0000
    Epoch  9/10: total=1.2652, vae=1.0832, dsb=0.1821, bio=0.0000
    Epoch 10/10: total=1.2744, vae=1.0830, dsb=0.1914, bio=0.0000

[Seed 94] Joint training (ablation) complete; models and history saved.

[Seed 94] Drift genes saved in /home/yyuan/ICB_TCE/iter_results/run_094

[Seed 94] run finished.

================================================================================
[Seed 95] Starting running whole pipeline...
================================================================================

[Seed 95] Starting VAE pre-training...

    Epoch [01/20], Beta: 0.000, Average Loss: 535.1729
    Epoch [02/20], Beta: 0.000, Average Loss: 305.5067
    Epoch [03/20], Beta: 0.000, Average Loss: 267.0512
    Epoch [04/20], Beta: 0.000, Average Loss: 249.3624
    Epoch [05/20], Beta: 0.100, Average Loss: 244.9939
    Epoch [06/20], Beta: 0.200, Average Loss: 243.8541
    Epoch [07/20], Beta: 0.300, Average Loss: 244.0893
    Epoch [08/20], Beta: 0.400, Average Loss: 244.9178
    Epoch [09/20], Beta: 0.500, Average Loss: 246.0869
    Epoch [10/20], Beta: 0.600, Average Loss: 247.3466
    Epoch [11/20], Beta: 0.700, Average Loss: 248.7008
    Epoch [12/20], Beta: 0.800, Average Loss: 250.0333
    Epoch [13/20], Beta: 0.900, Average Loss: 251.2618
    Epoch [14/20], Beta: 1.000, Average Loss: 252.9445
    Epoch [15/20], Beta: 1.000, Average Loss: 252.5280
    Epoch [16/20], Beta: 1.000, Average Loss: 252.1583
    Epoch [17/20], Beta: 1.000, Average Loss: 251.8502
    Epoch [18/20], Beta: 1.000, Average Loss: 251.4871
    Epoch [19/20], Beta: 1.000, Average Loss: 251.1412
    Epoch [20/20], Beta: 1.000, Average Loss: 250.9990

[Seed 95] VAE pre-training complete.

[Seed 95] Starting joint training (original)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=365.7398, vae=3.4981, dsb=345.7895, bio=32.9043
    Epoch  2/10: total=118.6632, vae=1.1003, dsb=117.5324, bio=0.0612
    Epoch  3/10: total=107.9810, vae=1.0974, dsb=106.8702, bio=0.0267
    Epoch  4/10: total=102.6693, vae=1.0949, dsb=101.5665, bio=0.0159
    Epoch  5/10: total=99.4121, vae=1.0941, dsb=98.3128, bio=0.0105
    Epoch  6/10: total=97.5000, vae=1.0937, dsb=96.4024, bio=0.0078
    Epoch  7/10: total=95.8348, vae=1.0936, dsb=94.7381, bio=0.0062
    Epoch  8/10: total=94.7148, vae=1.0936, dsb=93.6185, bio=0.0053
    Epoch  9/10: total=93.4641, vae=1.0920, dsb=92.3699, bio=0.0045
    Epoch 10/10: total=93.1450, vae=1.0929, dsb=92.0502, bio=0.0038

  [Backward Policy Training]
    Epoch  1/10: total=3.4931, vae=1.0932, dsb=2.3940, bio=0.0117
    Epoch  2/10: total=2.8942, vae=1.0914, dsb=1.8007, bio=0.0042
    Epoch  3/10: total=2.8067, vae=1.0907, dsb=1.7144, bio=0.0031
    Epoch  4/10: total=2.6976, vae=1.0913, dsb=1.6050, bio=0.0026
    Epoch  5/10: total=2.6565, vae=1.0911, dsb=1.5641, bio=0.0025
    Epoch  6/10: total=2.6162, vae=1.0912, dsb=1.5239, bio=0.0022
    Epoch  7/10: total=2.6272, vae=1.0902, dsb=1.5360, bio=0.0021
    Epoch  8/10: total=2.5771, vae=1.0902, dsb=1.4859, bio=0.0020
    Epoch  9/10: total=2.5444, vae=1.0912, dsb=1.4523, bio=0.0018
    Epoch 10/10: total=2.5904, vae=1.0902, dsb=1.4994, bio=0.0016

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=82.4304, vae=1.0927, dsb=81.3360, bio=0.0036
    Epoch  2/10: total=76.2472, vae=1.0919, dsb=75.1543, bio=0.0019
    Epoch  3/10: total=74.6296, vae=1.0905, dsb=73.5382, bio=0.0018
    Epoch  4/10: total=73.8950, vae=1.0905, dsb=72.8036, bio=0.0018
    Epoch  5/10: total=73.7666, vae=1.0912, dsb=72.6745, bio=0.0018
    Epoch  6/10: total=72.9876, vae=1.0903, dsb=71.8964, bio=0.0017
    Epoch  7/10: total=72.8927, vae=1.0907, dsb=71.8012, bio=0.0017
    Epoch  8/10: total=72.3921, vae=1.0901, dsb=71.3009, bio=0.0021
    Epoch  9/10: total=72.1623, vae=1.0897, dsb=71.0717, bio=0.0017
    Epoch 10/10: total=72.7701, vae=1.0900, dsb=71.6793, bio=0.0017

  [Backward Policy Training]
    Epoch  1/10: total=2.3191, vae=1.0905, dsb=1.2244, bio=0.0083
    Epoch  2/10: total=2.1806, vae=1.0892, dsb=1.0905, bio=0.0018
    Epoch  3/10: total=2.1435, vae=1.0890, dsb=1.0538, bio=0.0016
    Epoch  4/10: total=2.1236, vae=1.0899, dsb=1.0329, bio=0.0016
    Epoch  5/10: total=2.1266, vae=1.0897, dsb=1.0362, bio=0.0015
    Epoch  6/10: total=2.1145, vae=1.0886, dsb=1.0251, bio=0.0015
    Epoch  7/10: total=2.0716, vae=1.0886, dsb=0.9823, bio=0.0014
    Epoch  8/10: total=2.1068, vae=1.0892, dsb=1.0169, bio=0.0014
    Epoch  9/10: total=2.1110, vae=1.0881, dsb=1.0221, bio=0.0014
    Epoch 10/10: total=2.0805, vae=1.0894, dsb=0.9904, bio=0.0013

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=63.4372, vae=1.0910, dsb=62.3447, bio=0.0028
    Epoch  2/10: total=61.1075, vae=1.0890, dsb=60.0178, bio=0.0014
    Epoch  3/10: total=60.5978, vae=1.0903, dsb=59.5069, bio=0.0014
    Epoch  4/10: total=60.3682, vae=1.0899, dsb=59.2776, bio=0.0013
    Epoch  5/10: total=60.2751, vae=1.0895, dsb=59.1849, bio=0.0014
    Epoch  6/10: total=60.1682, vae=1.0886, dsb=59.0790, bio=0.0013
    Epoch  7/10: total=59.8205, vae=1.0896, dsb=58.7303, bio=0.0013
    Epoch  8/10: total=59.8594, vae=1.0889, dsb=58.7699, bio=0.0012
    Epoch  9/10: total=59.9157, vae=1.0886, dsb=58.8264, bio=0.0013
    Epoch 10/10: total=59.7021, vae=1.0893, dsb=58.6122, bio=0.0012

  [Backward Policy Training]
    Epoch  1/10: total=1.9669, vae=1.0904, dsb=0.8382, bio=0.0766
    Epoch  2/10: total=1.8857, vae=1.0889, dsb=0.7961, bio=0.0014
    Epoch  3/10: total=1.8693, vae=1.0881, dsb=0.7806, bio=0.0013
    Epoch  4/10: total=1.8663, vae=1.0881, dsb=0.7775, bio=0.0012
    Epoch  5/10: total=1.8514, vae=1.0880, dsb=0.7628, bio=0.0012
    Epoch  6/10: total=1.8427, vae=1.0881, dsb=0.7540, bio=0.0012
    Epoch  7/10: total=1.8710, vae=1.0881, dsb=0.7823, bio=0.0011
    Epoch  8/10: total=1.8007, vae=1.0881, dsb=0.7120, bio=0.0011
    Epoch  9/10: total=1.8343, vae=1.0890, dsb=0.7448, bio=0.0011
    Epoch 10/10: total=1.8344, vae=1.0886, dsb=0.7452, bio=0.0011

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=57.3298, vae=1.0898, dsb=56.2388, bio=0.0024
    Epoch  2/10: total=56.3387, vae=1.0895, dsb=55.2486, bio=0.0011
    Epoch  3/10: total=56.0198, vae=1.0889, dsb=54.9303, bio=0.0012
    Epoch  4/10: total=55.8985, vae=1.0894, dsb=54.8086, bio=0.0011
    Epoch  5/10: total=55.9376, vae=1.0887, dsb=54.8483, bio=0.0011
    Epoch  6/10: total=55.7951, vae=1.0884, dsb=54.7061, bio=0.0010
    Epoch  7/10: total=55.7586, vae=1.0883, dsb=54.6698, bio=0.0010
    Epoch  8/10: total=55.6451, vae=1.0885, dsb=54.5561, bio=0.0009
    Epoch  9/10: total=55.5966, vae=1.0888, dsb=54.5074, bio=0.0009
    Epoch 10/10: total=55.2913, vae=1.0886, dsb=54.2022, bio=0.0011

  [Backward Policy Training]
    Epoch  1/10: total=1.8079, vae=1.0895, dsb=0.6531, bio=0.1306
    Epoch  2/10: total=1.7275, vae=1.0890, dsb=0.6378, bio=0.0013
    Epoch  3/10: total=1.7228, vae=1.0886, dsb=0.6336, bio=0.0011
    Epoch  4/10: total=1.7576, vae=1.0882, dsb=0.6688, bio=0.0011
    Epoch  5/10: total=1.7251, vae=1.0884, dsb=0.6363, bio=0.0009
    Epoch  6/10: total=1.7552, vae=1.0878, dsb=0.6667, bio=0.0014
    Epoch  7/10: total=1.7087, vae=1.0879, dsb=0.6203, bio=0.0010
    Epoch  8/10: total=1.7154, vae=1.0879, dsb=0.6271, bio=0.0010
    Epoch  9/10: total=1.7272, vae=1.0886, dsb=0.6381, bio=0.0010
    Epoch 10/10: total=1.7422, vae=1.0881, dsb=0.6537, bio=0.0009

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=48.3208, vae=1.0902, dsb=47.2296, bio=0.0020
    Epoch  2/10: total=47.6703, vae=1.0890, dsb=46.5809, bio=0.0008
    Epoch  3/10: total=47.4331, vae=1.0882, dsb=46.3447, bio=0.0005
    Epoch  4/10: total=47.6613, vae=1.0882, dsb=46.5727, bio=0.0007
    Epoch  5/10: total=47.4705, vae=1.0887, dsb=46.3813, bio=0.0011
    Epoch  6/10: total=47.7566, vae=1.0876, dsb=46.6685, bio=0.0010
    Epoch  7/10: total=47.6608, vae=1.0877, dsb=46.5726, bio=0.0009
    Epoch  8/10: total=47.4413, vae=1.0879, dsb=46.3531, bio=0.0006
    Epoch  9/10: total=47.6015, vae=1.0877, dsb=46.5137, bio=0.0004
    Epoch 10/10: total=47.5015, vae=1.0886, dsb=46.4123, bio=0.0011

  [Backward Policy Training]
    Epoch  1/10: total=1.7561, vae=1.0885, dsb=0.5667, bio=0.2017
    Epoch  2/10: total=1.6520, vae=1.0881, dsb=0.5633, bio=0.0013
    Epoch  3/10: total=1.6230, vae=1.0879, dsb=0.5345, bio=0.0011
    Epoch  4/10: total=1.6410, vae=1.0882, dsb=0.5526, bio=0.0005
    Epoch  5/10: total=1.6322, vae=1.0873, dsb=0.5444, bio=0.0011
    Epoch  6/10: total=1.6341, vae=1.0885, dsb=0.5451, bio=0.0011
    Epoch  7/10: total=1.6378, vae=1.0873, dsb=0.5502, bio=0.0007
    Epoch  8/10: total=1.6050, vae=1.0868, dsb=0.5178, bio=0.0010
    Epoch  9/10: total=1.6424, vae=1.0868, dsb=0.5550, bio=0.0011
    Epoch 10/10: total=1.6293, vae=1.0870, dsb=0.5418, bio=0.0010

[Seed 95] Joint training (original) complete; models and history saved.

[Seed 95] Starting joint training (ablation)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=347.1099, vae=1.9807, dsb=345.1292, bio=0.0000
    Epoch  2/10: total=117.7328, vae=1.0840, dsb=116.6488, bio=0.0000
    Epoch  3/10: total=107.3828, vae=1.0836, dsb=106.2992, bio=0.0000
    Epoch  4/10: total=102.1343, vae=1.0818, dsb=101.0525, bio=0.0000
    Epoch  5/10: total=98.8576, vae=1.0813, dsb=97.7763, bio=0.0000
    Epoch  6/10: total=96.9857, vae=1.0812, dsb=95.9045, bio=0.0000
    Epoch  7/10: total=95.3728, vae=1.0813, dsb=94.2915, bio=0.0000
    Epoch  8/10: total=94.2755, vae=1.0815, dsb=93.1940, bio=0.0000
    Epoch  9/10: total=93.0593, vae=1.0802, dsb=91.9790, bio=0.0000
    Epoch 10/10: total=92.7178, vae=1.0814, dsb=91.6364, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=3.3392, vae=1.0807, dsb=2.2584, bio=0.0000
    Epoch  2/10: total=2.7930, vae=1.0805, dsb=1.7125, bio=0.0000
    Epoch  3/10: total=2.7112, vae=1.0802, dsb=1.6310, bio=0.0000
    Epoch  4/10: total=2.6059, vae=1.0811, dsb=1.5247, bio=0.0000
    Epoch  5/10: total=2.5658, vae=1.0812, dsb=1.4847, bio=0.0000
    Epoch  6/10: total=2.5238, vae=1.0814, dsb=1.4424, bio=0.0000
    Epoch  7/10: total=2.5333, vae=1.0806, dsb=1.4527, bio=0.0000
    Epoch  8/10: total=2.4858, vae=1.0806, dsb=1.4052, bio=0.0000
    Epoch  9/10: total=2.4533, vae=1.0817, dsb=1.3716, bio=0.0000
    Epoch 10/10: total=2.4991, vae=1.0809, dsb=1.4182, bio=0.0000

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=82.2759, vae=1.0805, dsb=81.1954, bio=0.0000
    Epoch  2/10: total=75.9941, vae=1.0811, dsb=74.9130, bio=0.0000
    Epoch  3/10: total=74.3988, vae=1.0800, dsb=73.3188, bio=0.0000
    Epoch  4/10: total=73.6614, vae=1.0802, dsb=72.5813, bio=0.0000
    Epoch  5/10: total=73.5945, vae=1.0810, dsb=72.5135, bio=0.0000
    Epoch  6/10: total=72.9225, vae=1.0802, dsb=71.8423, bio=0.0000
    Epoch  7/10: total=72.7542, vae=1.0807, dsb=71.6735, bio=0.0000
    Epoch  8/10: total=72.3238, vae=1.0802, dsb=71.2436, bio=0.0000
    Epoch  9/10: total=72.1207, vae=1.0801, dsb=71.0406, bio=0.0000
    Epoch 10/10: total=72.7181, vae=1.0804, dsb=71.6377, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=2.2334, vae=1.0803, dsb=1.1531, bio=0.0000
    Epoch  2/10: total=2.1118, vae=1.0803, dsb=1.0315, bio=0.0000
    Epoch  3/10: total=2.0775, vae=1.0802, dsb=0.9973, bio=0.0000
    Epoch  4/10: total=2.0580, vae=1.0811, dsb=0.9769, bio=0.0000
    Epoch  5/10: total=2.0614, vae=1.0811, dsb=0.9803, bio=0.0000
    Epoch  6/10: total=2.0505, vae=1.0801, dsb=0.9704, bio=0.0000
    Epoch  7/10: total=2.0095, vae=1.0801, dsb=0.9294, bio=0.0000
    Epoch  8/10: total=2.0429, vae=1.0806, dsb=0.9623, bio=0.0000
    Epoch  9/10: total=2.0472, vae=1.0798, dsb=0.9674, bio=0.0000
    Epoch 10/10: total=2.0175, vae=1.0810, dsb=0.9364, bio=0.0000

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=62.6254, vae=1.0803, dsb=61.5451, bio=0.0000
    Epoch  2/10: total=60.5526, vae=1.0795, dsb=59.4731, bio=0.0000
    Epoch  3/10: total=59.9853, vae=1.0810, dsb=58.9043, bio=0.0000
    Epoch  4/10: total=59.9189, vae=1.0808, dsb=58.8381, bio=0.0000
    Epoch  5/10: total=59.8059, vae=1.0805, dsb=58.7253, bio=0.0000
    Epoch  6/10: total=59.7817, vae=1.0797, dsb=58.7020, bio=0.0000
    Epoch  7/10: total=59.4025, vae=1.0808, dsb=58.3217, bio=0.0000
    Epoch  8/10: total=59.4629, vae=1.0802, dsb=58.3826, bio=0.0000
    Epoch  9/10: total=59.5135, vae=1.0802, dsb=58.4333, bio=0.0000
    Epoch 10/10: total=59.2750, vae=1.0809, dsb=58.1940, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.8505, vae=1.0810, dsb=0.7695, bio=0.0000
    Epoch  2/10: total=1.8126, vae=1.0806, dsb=0.7320, bio=0.0000
    Epoch  3/10: total=1.7982, vae=1.0799, dsb=0.7182, bio=0.0000
    Epoch  4/10: total=1.7963, vae=1.0800, dsb=0.7163, bio=0.0000
    Epoch  5/10: total=1.7831, vae=1.0800, dsb=0.7031, bio=0.0000
    Epoch  6/10: total=1.7756, vae=1.0801, dsb=0.6955, bio=0.0000
    Epoch  7/10: total=1.8020, vae=1.0802, dsb=0.7218, bio=0.0000
    Epoch  8/10: total=1.7364, vae=1.0802, dsb=0.6562, bio=0.0000
    Epoch  9/10: total=1.7676, vae=1.0811, dsb=0.6866, bio=0.0000
    Epoch 10/10: total=1.7682, vae=1.0808, dsb=0.6874, bio=0.0000

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=56.0873, vae=1.0796, dsb=55.0077, bio=0.0000
    Epoch  2/10: total=55.2660, vae=1.0806, dsb=54.1854, bio=0.0000
    Epoch  3/10: total=55.0158, vae=1.0802, dsb=53.9355, bio=0.0000
    Epoch  4/10: total=54.8648, vae=1.0811, dsb=53.7838, bio=0.0000
    Epoch  5/10: total=54.9939, vae=1.0805, dsb=53.9134, bio=0.0000
    Epoch  6/10: total=54.7382, vae=1.0803, dsb=53.6579, bio=0.0000
    Epoch  7/10: total=54.7498, vae=1.0802, dsb=53.6696, bio=0.0000
    Epoch  8/10: total=54.7254, vae=1.0806, dsb=53.6448, bio=0.0000
    Epoch  9/10: total=54.5952, vae=1.0808, dsb=53.5144, bio=0.0000
    Epoch 10/10: total=54.3739, vae=1.0808, dsb=53.2931, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.6773, vae=1.0802, dsb=0.5970, bio=0.0000
    Epoch  2/10: total=1.6639, vae=1.0811, dsb=0.5828, bio=0.0000
    Epoch  3/10: total=1.6597, vae=1.0808, dsb=0.5789, bio=0.0000
    Epoch  4/10: total=1.6927, vae=1.0804, dsb=0.6123, bio=0.0000
    Epoch  5/10: total=1.6626, vae=1.0806, dsb=0.5820, bio=0.0000
    Epoch  6/10: total=1.6908, vae=1.0802, dsb=0.6105, bio=0.0000
    Epoch  7/10: total=1.6477, vae=1.0803, dsb=0.5673, bio=0.0000
    Epoch  8/10: total=1.6542, vae=1.0803, dsb=0.5739, bio=0.0000
    Epoch  9/10: total=1.6652, vae=1.0811, dsb=0.5840, bio=0.0000
    Epoch 10/10: total=1.6791, vae=1.0806, dsb=0.5985, bio=0.0000

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=48.9141, vae=1.0804, dsb=47.8337, bio=0.0000
    Epoch  2/10: total=48.3876, vae=1.0804, dsb=47.3072, bio=0.0000
    Epoch  3/10: total=48.1336, vae=1.0801, dsb=47.0535, bio=0.0000
    Epoch  4/10: total=48.4321, vae=1.0803, dsb=47.3518, bio=0.0000
    Epoch  5/10: total=48.1269, vae=1.0809, dsb=47.0460, bio=0.0000
    Epoch  6/10: total=48.5183, vae=1.0798, dsb=47.4385, bio=0.0000
    Epoch  7/10: total=48.4116, vae=1.0800, dsb=47.3316, bio=0.0000
    Epoch  8/10: total=48.1550, vae=1.0802, dsb=47.0748, bio=0.0000
    Epoch  9/10: total=48.3140, vae=1.0801, dsb=47.2338, bio=0.0000
    Epoch 10/10: total=48.2385, vae=1.0812, dsb=47.1573, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.5963, vae=1.0795, dsb=0.5168, bio=0.0000
    Epoch  2/10: total=1.5953, vae=1.0805, dsb=0.5149, bio=0.0000
    Epoch  3/10: total=1.5686, vae=1.0805, dsb=0.4881, bio=0.0000
    Epoch  4/10: total=1.5860, vae=1.0809, dsb=0.5051, bio=0.0000
    Epoch  5/10: total=1.5779, vae=1.0802, dsb=0.4977, bio=0.0000
    Epoch  6/10: total=1.5799, vae=1.0815, dsb=0.4985, bio=0.0000
    Epoch  7/10: total=1.5834, vae=1.0803, dsb=0.5031, bio=0.0000
    Epoch  8/10: total=1.5526, vae=1.0799, dsb=0.4728, bio=0.0000
    Epoch  9/10: total=1.5879, vae=1.0801, dsb=0.5078, bio=0.0000
    Epoch 10/10: total=1.5756, vae=1.0804, dsb=0.4952, bio=0.0000

[Seed 95] Joint training (ablation) complete; models and history saved.

[Seed 95] Drift genes saved in /home/yyuan/ICB_TCE/iter_results/run_095

[Seed 95] run finished.

================================================================================
[Seed 96] Starting running whole pipeline...
================================================================================

[Seed 96] Starting VAE pre-training...

    Epoch [01/20], Beta: 0.000, Average Loss: 533.2706
    Epoch [02/20], Beta: 0.000, Average Loss: 307.3765
    Epoch [03/20], Beta: 0.000, Average Loss: 272.0086
    Epoch [04/20], Beta: 0.000, Average Loss: 251.2074
    Epoch [05/20], Beta: 0.100, Average Loss: 245.7033
    Epoch [06/20], Beta: 0.200, Average Loss: 244.8544
    Epoch [07/20], Beta: 0.300, Average Loss: 245.1395
    Epoch [08/20], Beta: 0.400, Average Loss: 245.8477
    Epoch [09/20], Beta: 0.500, Average Loss: 246.7326
    Epoch [10/20], Beta: 0.600, Average Loss: 247.7427
    Epoch [11/20], Beta: 0.700, Average Loss: 248.8109
    Epoch [12/20], Beta: 0.800, Average Loss: 250.0404
    Epoch [13/20], Beta: 0.900, Average Loss: 251.2180
    Epoch [14/20], Beta: 1.000, Average Loss: 252.8224
    Epoch [15/20], Beta: 1.000, Average Loss: 252.4094
    Epoch [16/20], Beta: 1.000, Average Loss: 252.0558
    Epoch [17/20], Beta: 1.000, Average Loss: 251.7115
    Epoch [18/20], Beta: 1.000, Average Loss: 251.4150
    Epoch [19/20], Beta: 1.000, Average Loss: 251.0588
    Epoch [20/20], Beta: 1.000, Average Loss: 250.8981

[Seed 96] VAE pre-training complete.

[Seed 96] Starting joint training (original)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=293.6697, vae=3.6213, dsb=275.0524, bio=29.9920
    Epoch  2/10: total=71.6678, vae=1.1089, dsb=70.5242, bio=0.0693
    Epoch  3/10: total=60.8596, vae=1.1038, dsb=59.7410, bio=0.0298
    Epoch  4/10: total=55.7254, vae=1.1010, dsb=54.6157, bio=0.0174
    Epoch  5/10: total=52.6296, vae=1.0997, dsb=51.5241, bio=0.0116
    Epoch  6/10: total=50.4317, vae=1.0991, dsb=49.3284, bio=0.0084
    Epoch  7/10: total=48.7370, vae=1.0991, dsb=47.6346, bio=0.0065
    Epoch  8/10: total=47.4156, vae=1.0976, dsb=46.3153, bio=0.0053
    Epoch  9/10: total=46.6691, vae=1.0980, dsb=45.5688, bio=0.0045
    Epoch 10/10: total=45.8874, vae=1.0983, dsb=44.7872, bio=0.0039

  [Backward Policy Training]
    Epoch  1/10: total=3.1449, vae=1.0986, dsb=2.0407, bio=0.0111
    Epoch  2/10: total=2.6991, vae=1.0966, dsb=1.6005, bio=0.0041
    Epoch  3/10: total=2.5358, vae=1.0967, dsb=1.4376, bio=0.0030
    Epoch  4/10: total=2.4954, vae=1.0957, dsb=1.3985, bio=0.0026
    Epoch  5/10: total=2.4320, vae=1.0963, dsb=1.3346, bio=0.0021
    Epoch  6/10: total=2.3722, vae=1.0952, dsb=1.2759, bio=0.0025
    Epoch  7/10: total=2.3250, vae=1.0957, dsb=1.2283, bio=0.0021
    Epoch  8/10: total=2.3265, vae=1.0958, dsb=1.2297, bio=0.0020
    Epoch  9/10: total=2.3219, vae=1.0955, dsb=1.2254, bio=0.0019
    Epoch 10/10: total=2.3055, vae=1.0953, dsb=1.2093, bio=0.0019

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=45.6491, vae=1.0975, dsb=44.5502, bio=0.0030
    Epoch  2/10: total=38.9021, vae=1.0960, dsb=37.8051, bio=0.0019
    Epoch  3/10: total=37.0703, vae=1.0962, dsb=35.9732, bio=0.0018
    Epoch  4/10: total=36.1057, vae=1.0953, dsb=35.0095, bio=0.0018
    Epoch  5/10: total=35.4707, vae=1.0960, dsb=34.3739, bio=0.0018
    Epoch  6/10: total=34.9803, vae=1.0956, dsb=33.8839, bio=0.0018
    Epoch  7/10: total=34.8023, vae=1.0959, dsb=33.7055, bio=0.0018
    Epoch  8/10: total=34.3418, vae=1.0957, dsb=33.2451, bio=0.0018
    Epoch  9/10: total=34.2516, vae=1.0956, dsb=33.1550, bio=0.0021
    Epoch 10/10: total=34.0776, vae=1.0951, dsb=32.9816, bio=0.0017

  [Backward Policy Training]
    Epoch  1/10: total=2.0629, vae=1.0950, dsb=0.9647, bio=0.0064
    Epoch  2/10: total=1.9302, vae=1.0943, dsb=0.8350, bio=0.0018
    Epoch  3/10: total=1.9222, vae=1.0936, dsb=0.8278, bio=0.0016
    Epoch  4/10: total=1.8664, vae=1.0943, dsb=0.7713, bio=0.0016
    Epoch  5/10: total=1.8574, vae=1.0938, dsb=0.7628, bio=0.0015
    Epoch  6/10: total=1.8420, vae=1.0939, dsb=0.7472, bio=0.0016
    Epoch  7/10: total=1.8281, vae=1.0943, dsb=0.7331, bio=0.0014
    Epoch  8/10: total=1.8362, vae=1.0931, dsb=0.7424, bio=0.0014
    Epoch  9/10: total=1.8402, vae=1.0940, dsb=0.7455, bio=0.0014
    Epoch 10/10: total=1.8250, vae=1.0934, dsb=0.7309, bio=0.0014

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=31.3584, vae=1.0972, dsb=30.2596, bio=0.0033
    Epoch  2/10: total=28.9152, vae=1.0954, dsb=27.8190, bio=0.0016
    Epoch  3/10: total=28.3466, vae=1.0953, dsb=27.2505, bio=0.0015
    Epoch  4/10: total=27.9094, vae=1.0955, dsb=26.8132, bio=0.0015
    Epoch  5/10: total=27.7213, vae=1.0945, dsb=26.6261, bio=0.0015
    Epoch  6/10: total=27.6428, vae=1.0951, dsb=26.5470, bio=0.0015
    Epoch  7/10: total=27.4687, vae=1.0941, dsb=26.3738, bio=0.0015
    Epoch  8/10: total=27.2974, vae=1.0938, dsb=26.2028, bio=0.0015
    Epoch  9/10: total=27.2209, vae=1.0941, dsb=26.1260, bio=0.0016
    Epoch 10/10: total=27.0980, vae=1.0947, dsb=26.0026, bio=0.0014

  [Backward Policy Training]
    Epoch  1/10: total=1.7754, vae=1.0944, dsb=0.6527, bio=0.0565
    Epoch  2/10: total=1.6914, vae=1.0945, dsb=0.5961, bio=0.0014
    Epoch  3/10: total=1.6733, vae=1.0937, dsb=0.5790, bio=0.0013
    Epoch  4/10: total=1.6581, vae=1.0933, dsb=0.5642, bio=0.0012
    Epoch  5/10: total=1.6670, vae=1.0932, dsb=0.5731, bio=0.0014
    Epoch  6/10: total=1.6513, vae=1.0945, dsb=0.5562, bio=0.0012
    Epoch  7/10: total=1.6521, vae=1.0930, dsb=0.5585, bio=0.0012
    Epoch  8/10: total=1.6303, vae=1.0928, dsb=0.5369, bio=0.0012
    Epoch  9/10: total=1.6290, vae=1.0924, dsb=0.5360, bio=0.0012
    Epoch 10/10: total=1.6481, vae=1.0930, dsb=0.5545, bio=0.0012

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=25.1349, vae=1.0953, dsb=24.0377, bio=0.0037
    Epoch  2/10: total=24.1108, vae=1.0944, dsb=23.0158, bio=0.0012
    Epoch  3/10: total=23.7588, vae=1.0945, dsb=22.6636, bio=0.0012
    Epoch  4/10: total=23.6085, vae=1.0942, dsb=22.5137, bio=0.0012
    Epoch  5/10: total=23.4711, vae=1.0938, dsb=22.3768, bio=0.0012
    Epoch  6/10: total=23.6009, vae=1.0940, dsb=22.5064, bio=0.0009
    Epoch  7/10: total=23.4138, vae=1.0935, dsb=22.3197, bio=0.0012
    Epoch  8/10: total=23.3338, vae=1.0942, dsb=22.2390, bio=0.0011
    Epoch  9/10: total=23.3162, vae=1.0933, dsb=22.2224, bio=0.0011
    Epoch 10/10: total=23.3333, vae=1.0939, dsb=22.2389, bio=0.0010

  [Backward Policy Training]
    Epoch  1/10: total=1.6533, vae=1.0944, dsb=0.4711, bio=0.1755
    Epoch  2/10: total=1.5399, vae=1.0935, dsb=0.4458, bio=0.0013
    Epoch  3/10: total=1.5323, vae=1.0932, dsb=0.4385, bio=0.0012
    Epoch  4/10: total=1.5280, vae=1.0932, dsb=0.4342, bio=0.0011
    Epoch  5/10: total=1.5180, vae=1.0924, dsb=0.4251, bio=0.0010
    Epoch  6/10: total=1.5141, vae=1.0913, dsb=0.4223, bio=0.0011
    Epoch  7/10: total=1.5179, vae=1.0922, dsb=0.4252, bio=0.0010
    Epoch  8/10: total=1.5002, vae=1.0925, dsb=0.4072, bio=0.0010
    Epoch  9/10: total=1.5181, vae=1.0918, dsb=0.4257, bio=0.0010
    Epoch 10/10: total=1.5143, vae=1.0925, dsb=0.4213, bio=0.0010

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=21.4188, vae=1.0961, dsb=20.3197, bio=0.0058
    Epoch  2/10: total=21.1002, vae=1.0936, dsb=20.0064, bio=0.0005
    Epoch  3/10: total=20.9006, vae=1.0940, dsb=19.8061, bio=0.0012
    Epoch  4/10: total=20.8407, vae=1.0944, dsb=19.7457, bio=0.0012
    Epoch  5/10: total=20.7785, vae=1.0935, dsb=19.6845, bio=0.0012
    Epoch  6/10: total=20.8097, vae=1.0934, dsb=19.7158, bio=0.0011
    Epoch  7/10: total=20.7829, vae=1.0931, dsb=19.6893, bio=0.0010
    Epoch  8/10: total=20.6725, vae=1.0934, dsb=19.5787, bio=0.0007
    Epoch  9/10: total=20.6789, vae=1.0930, dsb=19.5856, bio=0.0008
    Epoch 10/10: total=20.6900, vae=1.0937, dsb=19.5958, bio=0.0011

  [Backward Policy Training]
    Epoch  1/10: total=1.5509, vae=1.0940, dsb=0.3773, bio=0.1593
    Epoch  2/10: total=1.4717, vae=1.0926, dsb=0.3785, bio=0.0012
    Epoch  3/10: total=1.4570, vae=1.0921, dsb=0.3644, bio=0.0010
    Epoch  4/10: total=1.4658, vae=1.0924, dsb=0.3731, bio=0.0005
    Epoch  5/10: total=1.4691, vae=1.0931, dsb=0.3755, bio=0.0009
    Epoch  6/10: total=1.4721, vae=1.0928, dsb=0.3787, bio=0.0010
    Epoch  7/10: total=1.4543, vae=1.0918, dsb=0.3620, bio=0.0009
    Epoch  8/10: total=1.4534, vae=1.0915, dsb=0.3615, bio=0.0008
    Epoch  9/10: total=1.4656, vae=1.0914, dsb=0.3739, bio=0.0007
    Epoch 10/10: total=1.4503, vae=1.0917, dsb=0.3581, bio=0.0009

[Seed 96] Joint training (original) complete; models and history saved.

[Seed 96] Starting joint training (ablation)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=276.5434, vae=2.0056, dsb=274.5378, bio=0.0000
    Epoch  2/10: total=71.1363, vae=1.0891, dsb=70.0472, bio=0.0000
    Epoch  3/10: total=60.6174, vae=1.0882, dsb=59.5292, bio=0.0000
    Epoch  4/10: total=55.3546, vae=1.0869, dsb=54.2677, bio=0.0000
    Epoch  5/10: total=52.1341, vae=1.0863, dsb=51.0478, bio=0.0000
    Epoch  6/10: total=49.9727, vae=1.0863, dsb=48.8864, bio=0.0000
    Epoch  7/10: total=48.3143, vae=1.0867, dsb=47.2276, bio=0.0000
    Epoch  8/10: total=47.0317, vae=1.0856, dsb=45.9462, bio=0.0000
    Epoch  9/10: total=46.2373, vae=1.0862, dsb=45.1510, bio=0.0000
    Epoch 10/10: total=45.4708, vae=1.0868, dsb=44.3840, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=3.0599, vae=1.0858, dsb=1.9741, bio=0.0000
    Epoch  2/10: total=2.6358, vae=1.0858, dsb=1.5500, bio=0.0000
    Epoch  3/10: total=2.4857, vae=1.0863, dsb=1.3994, bio=0.0000
    Epoch  4/10: total=2.4476, vae=1.0857, dsb=1.3619, bio=0.0000
    Epoch  5/10: total=2.3866, vae=1.0865, dsb=1.3001, bio=0.0000
    Epoch  6/10: total=2.3284, vae=1.0855, dsb=1.2428, bio=0.0000
    Epoch  7/10: total=2.2811, vae=1.0862, dsb=1.1949, bio=0.0000
    Epoch  8/10: total=2.2828, vae=1.0863, dsb=1.1965, bio=0.0000
    Epoch  9/10: total=2.2779, vae=1.0862, dsb=1.1917, bio=0.0000
    Epoch 10/10: total=2.2618, vae=1.0861, dsb=1.1757, bio=0.0000

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=45.3280, vae=1.0855, dsb=44.2424, bio=0.0000
    Epoch  2/10: total=38.6821, vae=1.0854, dsb=37.5967, bio=0.0000
    Epoch  3/10: total=36.8986, vae=1.0858, dsb=35.8128, bio=0.0000
    Epoch  4/10: total=35.9298, vae=1.0851, dsb=34.8446, bio=0.0000
    Epoch  5/10: total=35.3160, vae=1.0859, dsb=34.2301, bio=0.0000
    Epoch  6/10: total=34.8321, vae=1.0856, dsb=33.7465, bio=0.0000
    Epoch  7/10: total=34.6751, vae=1.0860, dsb=33.5891, bio=0.0000
    Epoch  8/10: total=34.2314, vae=1.0859, dsb=33.1455, bio=0.0000
    Epoch  9/10: total=34.1530, vae=1.0858, dsb=33.0672, bio=0.0000
    Epoch 10/10: total=34.0015, vae=1.0855, dsb=32.9160, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=2.0161, vae=1.0849, dsb=0.9312, bio=0.0000
    Epoch  2/10: total=1.8893, vae=1.0855, dsb=0.8039, bio=0.0000
    Epoch  3/10: total=1.8830, vae=1.0850, dsb=0.7980, bio=0.0000
    Epoch  4/10: total=1.8281, vae=1.0858, dsb=0.7424, bio=0.0000
    Epoch  5/10: total=1.8212, vae=1.0852, dsb=0.7360, bio=0.0000
    Epoch  6/10: total=1.8073, vae=1.0855, dsb=0.7218, bio=0.0000
    Epoch  7/10: total=1.7948, vae=1.0859, dsb=0.7089, bio=0.0000
    Epoch  8/10: total=1.8030, vae=1.0847, dsb=0.7183, bio=0.0000
    Epoch  9/10: total=1.8076, vae=1.0858, dsb=0.7218, bio=0.0000
    Epoch 10/10: total=1.7934, vae=1.0852, dsb=0.7082, bio=0.0000

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=31.2011, vae=1.0861, dsb=30.1150, bio=0.0000
    Epoch  2/10: total=28.7206, vae=1.0859, dsb=27.6346, bio=0.0000
    Epoch  3/10: total=28.1097, vae=1.0861, dsb=27.0236, bio=0.0000
    Epoch  4/10: total=27.6677, vae=1.0863, dsb=26.5814, bio=0.0000
    Epoch  5/10: total=27.4482, vae=1.0855, dsb=26.3627, bio=0.0000
    Epoch  6/10: total=27.3794, vae=1.0861, dsb=26.2932, bio=0.0000
    Epoch  7/10: total=27.2088, vae=1.0853, dsb=26.1234, bio=0.0000
    Epoch  8/10: total=27.0437, vae=1.0851, dsb=25.9586, bio=0.0000
    Epoch  9/10: total=26.9889, vae=1.0855, dsb=25.9034, bio=0.0000
    Epoch 10/10: total=26.8648, vae=1.0862, dsb=25.7785, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.6989, vae=1.0850, dsb=0.6139, bio=0.0000
    Epoch  2/10: total=1.6474, vae=1.0863, dsb=0.5611, bio=0.0000
    Epoch  3/10: total=1.6305, vae=1.0857, dsb=0.5449, bio=0.0000
    Epoch  4/10: total=1.6158, vae=1.0853, dsb=0.5305, bio=0.0000
    Epoch  5/10: total=1.6247, vae=1.0852, dsb=0.5395, bio=0.0000
    Epoch  6/10: total=1.6103, vae=1.0867, dsb=0.5236, bio=0.0000
    Epoch  7/10: total=1.6109, vae=1.0853, dsb=0.5255, bio=0.0000
    Epoch  8/10: total=1.5900, vae=1.0852, dsb=0.5049, bio=0.0000
    Epoch  9/10: total=1.5894, vae=1.0849, dsb=0.5045, bio=0.0000
    Epoch 10/10: total=1.6074, vae=1.0856, dsb=0.5218, bio=0.0000

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=24.7939, vae=1.0852, dsb=23.7087, bio=0.0000
    Epoch  2/10: total=23.7458, vae=1.0853, dsb=22.6605, bio=0.0000
    Epoch  3/10: total=23.3717, vae=1.0857, dsb=22.2860, bio=0.0000
    Epoch  4/10: total=23.2089, vae=1.0855, dsb=22.1234, bio=0.0000
    Epoch  5/10: total=23.0862, vae=1.0853, dsb=22.0009, bio=0.0000
    Epoch  6/10: total=23.2297, vae=1.0857, dsb=22.1440, bio=0.0000
    Epoch  7/10: total=23.0357, vae=1.0854, dsb=21.9503, bio=0.0000
    Epoch  8/10: total=22.9505, vae=1.0861, dsb=21.8644, bio=0.0000
    Epoch  9/10: total=22.9389, vae=1.0853, dsb=21.8536, bio=0.0000
    Epoch 10/10: total=22.9671, vae=1.0859, dsb=21.8812, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.5231, vae=1.0853, dsb=0.4378, bio=0.0000
    Epoch  2/10: total=1.4991, vae=1.0858, dsb=0.4133, bio=0.0000
    Epoch  3/10: total=1.4919, vae=1.0858, dsb=0.4061, bio=0.0000
    Epoch  4/10: total=1.4878, vae=1.0859, dsb=0.4019, bio=0.0000
    Epoch  5/10: total=1.4786, vae=1.0851, dsb=0.3936, bio=0.0000
    Epoch  6/10: total=1.4749, vae=1.0842, dsb=0.3907, bio=0.0000
    Epoch  7/10: total=1.4787, vae=1.0852, dsb=0.3935, bio=0.0000
    Epoch  8/10: total=1.4620, vae=1.0856, dsb=0.3764, bio=0.0000
    Epoch  9/10: total=1.4786, vae=1.0850, dsb=0.3936, bio=0.0000
    Epoch 10/10: total=1.4753, vae=1.0858, dsb=0.3895, bio=0.0000

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=20.6284, vae=1.0863, dsb=19.5420, bio=0.0000
    Epoch  2/10: total=20.2742, vae=1.0848, dsb=19.1894, bio=0.0000
    Epoch  3/10: total=20.0785, vae=1.0854, dsb=18.9931, bio=0.0000
    Epoch  4/10: total=20.0435, vae=1.0860, dsb=18.9576, bio=0.0000
    Epoch  5/10: total=19.9734, vae=1.0852, dsb=18.8882, bio=0.0000
    Epoch  6/10: total=20.0095, vae=1.0853, dsb=18.9242, bio=0.0000
    Epoch  7/10: total=20.0107, vae=1.0851, dsb=18.9256, bio=0.0000
    Epoch  8/10: total=19.8782, vae=1.0855, dsb=18.7926, bio=0.0000
    Epoch  9/10: total=19.9061, vae=1.0852, dsb=18.8209, bio=0.0000
    Epoch 10/10: total=19.8966, vae=1.0861, dsb=18.8106, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.4281, vae=1.0852, dsb=0.3429, bio=0.0000
    Epoch  2/10: total=1.4292, vae=1.0853, dsb=0.3439, bio=0.0000
    Epoch  3/10: total=1.4158, vae=1.0850, dsb=0.3307, bio=0.0000
    Epoch  4/10: total=1.4245, vae=1.0854, dsb=0.3391, bio=0.0000
    Epoch  5/10: total=1.4275, vae=1.0864, dsb=0.3411, bio=0.0000
    Epoch  6/10: total=1.4305, vae=1.0862, dsb=0.3443, bio=0.0000
    Epoch  7/10: total=1.4136, vae=1.0852, dsb=0.3284, bio=0.0000
    Epoch  8/10: total=1.4129, vae=1.0849, dsb=0.3280, bio=0.0000
    Epoch  9/10: total=1.4244, vae=1.0849, dsb=0.3395, bio=0.0000
    Epoch 10/10: total=1.4100, vae=1.0853, dsb=0.3248, bio=0.0000

[Seed 96] Joint training (ablation) complete; models and history saved.

[Seed 96] Drift genes saved in /home/yyuan/ICB_TCE/iter_results/run_096

[Seed 96] run finished.

================================================================================
[Seed 97] Starting running whole pipeline...
================================================================================

[Seed 97] Starting VAE pre-training...

    Epoch [01/20], Beta: 0.000, Average Loss: 532.6834
    Epoch [02/20], Beta: 0.000, Average Loss: 305.2766
    Epoch [03/20], Beta: 0.000, Average Loss: 268.7999
    Epoch [04/20], Beta: 0.000, Average Loss: 249.1676
    Epoch [05/20], Beta: 0.100, Average Loss: 244.3586
    Epoch [06/20], Beta: 0.200, Average Loss: 243.5388
    Epoch [07/20], Beta: 0.300, Average Loss: 244.0408
    Epoch [08/20], Beta: 0.400, Average Loss: 244.9181
    Epoch [09/20], Beta: 0.500, Average Loss: 246.0733
    Epoch [10/20], Beta: 0.600, Average Loss: 247.3213
    Epoch [11/20], Beta: 0.700, Average Loss: 248.6761
    Epoch [12/20], Beta: 0.800, Average Loss: 250.0996
    Epoch [13/20], Beta: 0.900, Average Loss: 251.3404
    Epoch [14/20], Beta: 1.000, Average Loss: 252.9938
    Epoch [15/20], Beta: 1.000, Average Loss: 252.5986
    Epoch [16/20], Beta: 1.000, Average Loss: 252.2484
    Epoch [17/20], Beta: 1.000, Average Loss: 251.9051
    Epoch [18/20], Beta: 1.000, Average Loss: 251.6155
    Epoch [19/20], Beta: 1.000, Average Loss: 251.2643
    Epoch [20/20], Beta: 1.000, Average Loss: 251.1043

[Seed 97] VAE pre-training complete.

[Seed 97] Starting joint training (original)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=395.1093, vae=3.5654, dsb=374.0564, bio=34.9750
    Epoch  2/10: total=125.5649, vae=1.1032, dsb=124.4296, bio=0.0643
    Epoch  3/10: total=115.5126, vae=1.0998, dsb=114.3987, bio=0.0281
    Epoch  4/10: total=110.7580, vae=1.0978, dsb=109.6518, bio=0.0167
    Epoch  5/10: total=108.0632, vae=1.0962, dsb=106.9615, bio=0.0111
    Epoch  6/10: total=106.5424, vae=1.0970, dsb=105.4412, bio=0.0083
    Epoch  7/10: total=104.8171, vae=1.0966, dsb=103.7172, bio=0.0065
    Epoch  8/10: total=104.2195, vae=1.0961, dsb=103.1207, bio=0.0054
    Epoch  9/10: total=103.1736, vae=1.0958, dsb=102.0756, bio=0.0046
    Epoch 10/10: total=102.4027, vae=1.0952, dsb=101.3055, bio=0.0041

  [Backward Policy Training]
    Epoch  1/10: total=3.3364, vae=1.0962, dsb=2.2338, bio=0.0129
    Epoch  2/10: total=2.8975, vae=1.0952, dsb=1.8001, bio=0.0044
    Epoch  3/10: total=2.7810, vae=1.0942, dsb=1.6852, bio=0.0033
    Epoch  4/10: total=2.6497, vae=1.0939, dsb=1.5544, bio=0.0028
    Epoch  5/10: total=2.6500, vae=1.0935, dsb=1.5552, bio=0.0025
    Epoch  6/10: total=2.6599, vae=1.0927, dsb=1.5661, bio=0.0023
    Epoch  7/10: total=2.5946, vae=1.0943, dsb=1.4992, bio=0.0021
    Epoch  8/10: total=2.5799, vae=1.0937, dsb=1.4851, bio=0.0022
    Epoch  9/10: total=2.5522, vae=1.0936, dsb=1.4576, bio=0.0021
    Epoch 10/10: total=2.5739, vae=1.0928, dsb=1.4801, bio=0.0020

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=87.6712, vae=1.0959, dsb=86.5735, bio=0.0036
    Epoch  2/10: total=82.5470, vae=1.0950, dsb=81.4509, bio=0.0021
    Epoch  3/10: total=80.9541, vae=1.0944, dsb=79.8587, bio=0.0020
    Epoch  4/10: total=80.2194, vae=1.0947, dsb=79.1238, bio=0.0019
    Epoch  5/10: total=79.5715, vae=1.0939, dsb=78.4766, bio=0.0018
    Epoch  6/10: total=79.6316, vae=1.0934, dsb=78.5372, bio=0.0021
    Epoch  7/10: total=79.4523, vae=1.0942, dsb=78.3571, bio=0.0020
    Epoch  8/10: total=79.0598, vae=1.0932, dsb=77.9656, bio=0.0019
    Epoch  9/10: total=78.6318, vae=1.0938, dsb=77.5370, bio=0.0019
    Epoch 10/10: total=78.6421, vae=1.0932, dsb=77.5480, bio=0.0019

  [Backward Policy Training]
    Epoch  1/10: total=2.2387, vae=1.0937, dsb=1.1421, bio=0.0059
    Epoch  2/10: total=2.1056, vae=1.0922, dsb=1.0124, bio=0.0020
    Epoch  3/10: total=2.0782, vae=1.0926, dsb=0.9848, bio=0.0018
    Epoch  4/10: total=2.0565, vae=1.0923, dsb=0.9632, bio=0.0020
    Epoch  5/10: total=2.0761, vae=1.0926, dsb=0.9827, bio=0.0017
    Epoch  6/10: total=2.0438, vae=1.0917, dsb=0.9513, bio=0.0017
    Epoch  7/10: total=2.0385, vae=1.0918, dsb=0.9458, bio=0.0017
    Epoch  8/10: total=2.0187, vae=1.0912, dsb=0.9267, bio=0.0016
    Epoch  9/10: total=1.9994, vae=1.0917, dsb=0.9069, bio=0.0016
    Epoch 10/10: total=2.0130, vae=1.0922, dsb=0.9200, bio=0.0016

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=70.3437, vae=1.0948, dsb=69.2473, bio=0.0031
    Epoch  2/10: total=67.9861, vae=1.0931, dsb=66.8921, bio=0.0017
    Epoch  3/10: total=67.7887, vae=1.0916, dsb=66.6963, bio=0.0017
    Epoch  4/10: total=67.5993, vae=1.0930, dsb=66.5055, bio=0.0016
    Epoch  5/10: total=67.5064, vae=1.0923, dsb=66.4133, bio=0.0017
    Epoch  6/10: total=67.0472, vae=1.0923, dsb=65.9539, bio=0.0020
    Epoch  7/10: total=67.1724, vae=1.0927, dsb=66.0788, bio=0.0016
    Epoch  8/10: total=67.0569, vae=1.0920, dsb=65.9641, bio=0.0016
    Epoch  9/10: total=67.2354, vae=1.0925, dsb=66.1421, bio=0.0016
    Epoch 10/10: total=66.8216, vae=1.0926, dsb=65.7281, bio=0.0016

  [Backward Policy Training]
    Epoch  1/10: total=1.8984, vae=1.0925, dsb=0.8002, bio=0.0114
    Epoch  2/10: total=1.8424, vae=1.0922, dsb=0.7494, bio=0.0016
    Epoch  3/10: total=1.8608, vae=1.0911, dsb=0.7690, bio=0.0015
    Epoch  4/10: total=1.8459, vae=1.0909, dsb=0.7541, bio=0.0017
    Epoch  5/10: total=1.8259, vae=1.0909, dsb=0.7343, bio=0.0014
    Epoch  6/10: total=1.8186, vae=1.0916, dsb=0.7263, bio=0.0014
    Epoch  7/10: total=1.8303, vae=1.0919, dsb=0.7377, bio=0.0014
    Epoch  8/10: total=1.8376, vae=1.0914, dsb=0.7455, bio=0.0014
    Epoch  9/10: total=1.8179, vae=1.0916, dsb=0.7256, bio=0.0014
    Epoch 10/10: total=1.8141, vae=1.0918, dsb=0.7216, bio=0.0013

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=59.7772, vae=1.0946, dsb=58.6813, bio=0.0027
    Epoch  2/10: total=59.5683, vae=1.0929, dsb=58.4748, bio=0.0014
    Epoch  3/10: total=58.9826, vae=1.0920, dsb=57.8899, bio=0.0014
    Epoch  4/10: total=59.0949, vae=1.0925, dsb=58.0016, bio=0.0016
    Epoch  5/10: total=58.7540, vae=1.0919, dsb=57.6615, bio=0.0014
    Epoch  6/10: total=59.4863, vae=1.0920, dsb=58.3935, bio=0.0014
    Epoch  7/10: total=58.8936, vae=1.0919, dsb=57.8009, bio=0.0014
    Epoch  8/10: total=58.7049, vae=1.0917, dsb=57.6125, bio=0.0014
    Epoch  9/10: total=58.9731, vae=1.0917, dsb=57.8806, bio=0.0018
    Epoch 10/10: total=59.0247, vae=1.0918, dsb=57.9322, bio=0.0014

  [Backward Policy Training]
    Epoch  1/10: total=1.7590, vae=1.0933, dsb=0.6422, bio=0.0472
    Epoch  2/10: total=1.7067, vae=1.0915, dsb=0.6145, bio=0.0014
    Epoch  3/10: total=1.7098, vae=1.0914, dsb=0.6177, bio=0.0013
    Epoch  4/10: total=1.6887, vae=1.0915, dsb=0.5966, bio=0.0012
    Epoch  5/10: total=1.7045, vae=1.0910, dsb=0.6130, bio=0.0011
    Epoch  6/10: total=1.7030, vae=1.0908, dsb=0.6116, bio=0.0012
    Epoch  7/10: total=1.6980, vae=1.0908, dsb=0.6066, bio=0.0012
    Epoch  8/10: total=1.6881, vae=1.0909, dsb=0.5966, bio=0.0012
    Epoch  9/10: total=1.6911, vae=1.0913, dsb=0.5992, bio=0.0012
    Epoch 10/10: total=1.7130, vae=1.0908, dsb=0.6216, bio=0.0011

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=53.5085, vae=1.0929, dsb=52.4142, bio=0.0028
    Epoch  2/10: total=53.4499, vae=1.0931, dsb=52.3562, bio=0.0012
    Epoch  3/10: total=53.4635, vae=1.0907, dsb=52.3723, bio=0.0012
    Epoch  4/10: total=53.2021, vae=1.0925, dsb=52.1090, bio=0.0012
    Epoch  5/10: total=52.8991, vae=1.0922, dsb=51.8064, bio=0.0011
    Epoch  6/10: total=53.2686, vae=1.0913, dsb=52.1767, bio=0.0012
    Epoch  7/10: total=53.1126, vae=1.0913, dsb=52.0207, bio=0.0011
    Epoch  8/10: total=53.0079, vae=1.0911, dsb=51.9162, bio=0.0011
    Epoch  9/10: total=52.9038, vae=1.0908, dsb=51.8125, bio=0.0011
    Epoch 10/10: total=53.2905, vae=1.0902, dsb=52.1997, bio=0.0012

  [Backward Policy Training]
    Epoch  1/10: total=1.7068, vae=1.0918, dsb=0.5574, bio=0.1151
    Epoch  2/10: total=1.6411, vae=1.0901, dsb=0.5503, bio=0.0012
    Epoch  3/10: total=1.6320, vae=1.0912, dsb=0.5401, bio=0.0014
    Epoch  4/10: total=1.6212, vae=1.0905, dsb=0.5301, bio=0.0011
    Epoch  5/10: total=1.6235, vae=1.0916, dsb=0.5315, bio=0.0010
    Epoch  6/10: total=1.6246, vae=1.0907, dsb=0.5334, bio=0.0010
    Epoch  7/10: total=1.6153, vae=1.0912, dsb=0.5236, bio=0.0010
    Epoch  8/10: total=1.6204, vae=1.0915, dsb=0.5284, bio=0.0010
    Epoch  9/10: total=1.6025, vae=1.0905, dsb=0.5116, bio=0.0010
    Epoch 10/10: total=1.6083, vae=1.0911, dsb=0.5167, bio=0.0010

[Seed 97] Joint training (original) complete; models and history saved.

[Seed 97] Starting joint training (ablation)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=375.0892, vae=1.9800, dsb=373.1092, bio=0.0000
    Epoch  2/10: total=124.9348, vae=1.0869, dsb=123.8479, bio=0.0000
    Epoch  3/10: total=115.2207, vae=1.0860, dsb=114.1347, bio=0.0000
    Epoch  4/10: total=110.5260, vae=1.0848, dsb=109.4412, bio=0.0000
    Epoch  5/10: total=107.8562, vae=1.0834, dsb=106.7727, bio=0.0000
    Epoch  6/10: total=106.3469, vae=1.0845, dsb=105.2624, bio=0.0000
    Epoch  7/10: total=104.7047, vae=1.0844, dsb=103.6203, bio=0.0000
    Epoch  8/10: total=104.1812, vae=1.0841, dsb=103.0971, bio=0.0000
    Epoch  9/10: total=103.1570, vae=1.0840, dsb=102.0730, bio=0.0000
    Epoch 10/10: total=102.3694, vae=1.0836, dsb=101.2858, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=3.1829, vae=1.0840, dsb=2.0988, bio=0.0000
    Epoch  2/10: total=2.7667, vae=1.0845, dsb=1.6822, bio=0.0000
    Epoch  3/10: total=2.6600, vae=1.0839, dsb=1.5762, bio=0.0000
    Epoch  4/10: total=2.5364, vae=1.0837, dsb=1.4527, bio=0.0000
    Epoch  5/10: total=2.5361, vae=1.0836, dsb=1.4525, bio=0.0000
    Epoch  6/10: total=2.5483, vae=1.0828, dsb=1.4655, bio=0.0000
    Epoch  7/10: total=2.4884, vae=1.0845, dsb=1.4039, bio=0.0000
    Epoch  8/10: total=2.4771, vae=1.0842, dsb=1.3929, bio=0.0000
    Epoch  9/10: total=2.4540, vae=1.0841, dsb=1.3699, bio=0.0000
    Epoch 10/10: total=2.4760, vae=1.0833, dsb=1.3927, bio=0.0000

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=86.8767, vae=1.0837, dsb=85.7930, bio=0.0000
    Epoch  2/10: total=81.9533, vae=1.0842, dsb=80.8691, bio=0.0000
    Epoch  3/10: total=80.5173, vae=1.0838, dsb=79.4335, bio=0.0000
    Epoch  4/10: total=79.8304, vae=1.0843, dsb=78.7461, bio=0.0000
    Epoch  5/10: total=79.2260, vae=1.0836, dsb=78.1425, bio=0.0000
    Epoch  6/10: total=79.3406, vae=1.0832, dsb=78.2573, bio=0.0000
    Epoch  7/10: total=79.1460, vae=1.0843, dsb=78.0617, bio=0.0000
    Epoch  8/10: total=78.8386, vae=1.0832, dsb=77.7553, bio=0.0000
    Epoch  9/10: total=78.4273, vae=1.0840, dsb=77.3434, bio=0.0000
    Epoch 10/10: total=78.4217, vae=1.0834, dsb=77.3383, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=2.1458, vae=1.0833, dsb=1.0626, bio=0.0000
    Epoch  2/10: total=2.0288, vae=1.0833, dsb=0.9455, bio=0.0000
    Epoch  3/10: total=2.0040, vae=1.0838, dsb=0.9202, bio=0.0000
    Epoch  4/10: total=1.9838, vae=1.0835, dsb=0.9003, bio=0.0000
    Epoch  5/10: total=2.0039, vae=1.0840, dsb=0.9198, bio=0.0000
    Epoch  6/10: total=1.9736, vae=1.0831, dsb=0.8905, bio=0.0000
    Epoch  7/10: total=1.9694, vae=1.0833, dsb=0.8861, bio=0.0000
    Epoch  8/10: total=1.9521, vae=1.0827, dsb=0.8694, bio=0.0000
    Epoch  9/10: total=1.9343, vae=1.0833, dsb=0.8511, bio=0.0000
    Epoch 10/10: total=1.9478, vae=1.0838, dsb=0.8641, bio=0.0000

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=68.2030, vae=1.0836, dsb=67.1194, bio=0.0000
    Epoch  2/10: total=66.0674, vae=1.0834, dsb=64.9840, bio=0.0000
    Epoch  3/10: total=65.9409, vae=1.0821, dsb=64.8588, bio=0.0000
    Epoch  4/10: total=65.7960, vae=1.0837, dsb=64.7123, bio=0.0000
    Epoch  5/10: total=65.7487, vae=1.0831, dsb=64.6656, bio=0.0000
    Epoch  6/10: total=65.3159, vae=1.0831, dsb=64.2329, bio=0.0000
    Epoch  7/10: total=65.4232, vae=1.0836, dsb=64.3396, bio=0.0000
    Epoch  8/10: total=65.2832, vae=1.0829, dsb=64.2003, bio=0.0000
    Epoch  9/10: total=65.4846, vae=1.0835, dsb=64.4011, bio=0.0000
    Epoch 10/10: total=65.1043, vae=1.0838, dsb=64.0205, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.8166, vae=1.0833, dsb=0.7332, bio=0.0000
    Epoch  2/10: total=1.7730, vae=1.0839, dsb=0.6891, bio=0.0000
    Epoch  3/10: total=1.7915, vae=1.0828, dsb=0.7087, bio=0.0000
    Epoch  4/10: total=1.7788, vae=1.0828, dsb=0.6960, bio=0.0000
    Epoch  5/10: total=1.7605, vae=1.0828, dsb=0.6777, bio=0.0000
    Epoch  6/10: total=1.7553, vae=1.0837, dsb=0.6716, bio=0.0000
    Epoch  7/10: total=1.7667, vae=1.0840, dsb=0.6827, bio=0.0000
    Epoch  8/10: total=1.7737, vae=1.0834, dsb=0.6902, bio=0.0000
    Epoch  9/10: total=1.7558, vae=1.0837, dsb=0.6721, bio=0.0000
    Epoch 10/10: total=1.7523, vae=1.0840, dsb=0.6683, bio=0.0000

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=58.6069, vae=1.0841, dsb=57.5228, bio=0.0000
    Epoch  2/10: total=58.4472, vae=1.0836, dsb=57.3635, bio=0.0000
    Epoch  3/10: total=57.9098, vae=1.0830, dsb=56.8268, bio=0.0000
    Epoch  4/10: total=58.0204, vae=1.0838, dsb=56.9366, bio=0.0000
    Epoch  5/10: total=57.7357, vae=1.0832, dsb=56.6524, bio=0.0000
    Epoch  6/10: total=58.4963, vae=1.0835, dsb=57.4128, bio=0.0000
    Epoch  7/10: total=57.8814, vae=1.0835, dsb=56.7979, bio=0.0000
    Epoch  8/10: total=57.6867, vae=1.0834, dsb=56.6033, bio=0.0000
    Epoch  9/10: total=58.0059, vae=1.0834, dsb=56.9225, bio=0.0000
    Epoch 10/10: total=58.0891, vae=1.0836, dsb=57.0056, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.6726, vae=1.0844, dsb=0.5882, bio=0.0000
    Epoch  2/10: total=1.6470, vae=1.0835, dsb=0.5635, bio=0.0000
    Epoch  3/10: total=1.6501, vae=1.0836, dsb=0.5665, bio=0.0000
    Epoch  4/10: total=1.6309, vae=1.0838, dsb=0.5471, bio=0.0000
    Epoch  5/10: total=1.6456, vae=1.0833, dsb=0.5624, bio=0.0000
    Epoch  6/10: total=1.6444, vae=1.0831, dsb=0.5613, bio=0.0000
    Epoch  7/10: total=1.6397, vae=1.0832, dsb=0.5565, bio=0.0000
    Epoch  8/10: total=1.6306, vae=1.0833, dsb=0.5473, bio=0.0000
    Epoch  9/10: total=1.6335, vae=1.0837, dsb=0.5498, bio=0.0000
    Epoch 10/10: total=1.6539, vae=1.0832, dsb=0.5707, bio=0.0000

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=51.3546, vae=1.0828, dsb=50.2718, bio=0.0000
    Epoch  2/10: total=51.3381, vae=1.0844, dsb=50.2538, bio=0.0000
    Epoch  3/10: total=51.3588, vae=1.0822, dsb=50.2766, bio=0.0000
    Epoch  4/10: total=51.0965, vae=1.0843, dsb=50.0123, bio=0.0000
    Epoch  5/10: total=50.8093, vae=1.0841, dsb=49.7252, bio=0.0000
    Epoch  6/10: total=51.1741, vae=1.0834, dsb=50.0907, bio=0.0000
    Epoch  7/10: total=51.0387, vae=1.0835, dsb=49.9552, bio=0.0000
    Epoch  8/10: total=50.9045, vae=1.0833, dsb=49.8212, bio=0.0000
    Epoch  9/10: total=50.8260, vae=1.0831, dsb=49.7429, bio=0.0000
    Epoch 10/10: total=51.2016, vae=1.0825, dsb=50.1191, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.6021, vae=1.0830, dsb=0.5191, bio=0.0000
    Epoch  2/10: total=1.5955, vae=1.0824, dsb=0.5132, bio=0.0000
    Epoch  3/10: total=1.5873, vae=1.0836, dsb=0.5038, bio=0.0000
    Epoch  4/10: total=1.5773, vae=1.0830, dsb=0.4944, bio=0.0000
    Epoch  5/10: total=1.5798, vae=1.0841, dsb=0.4957, bio=0.0000
    Epoch  6/10: total=1.5809, vae=1.0833, dsb=0.4976, bio=0.0000
    Epoch  7/10: total=1.5723, vae=1.0838, dsb=0.4886, bio=0.0000
    Epoch  8/10: total=1.5774, vae=1.0841, dsb=0.4933, bio=0.0000
    Epoch  9/10: total=1.5603, vae=1.0831, dsb=0.4772, bio=0.0000
    Epoch 10/10: total=1.5658, vae=1.0837, dsb=0.4820, bio=0.0000

[Seed 97] Joint training (ablation) complete; models and history saved.

[Seed 97] Drift genes saved in /home/yyuan/ICB_TCE/iter_results/run_097

[Seed 97] run finished.

================================================================================
[Seed 98] Starting running whole pipeline...
================================================================================

[Seed 98] Starting VAE pre-training...

    Epoch [01/20], Beta: 0.000, Average Loss: 536.1759
    Epoch [02/20], Beta: 0.000, Average Loss: 306.5779
    Epoch [03/20], Beta: 0.000, Average Loss: 269.3076
    Epoch [04/20], Beta: 0.000, Average Loss: 250.6306
    Epoch [05/20], Beta: 0.100, Average Loss: 246.3064
    Epoch [06/20], Beta: 0.200, Average Loss: 245.3070
    Epoch [07/20], Beta: 0.300, Average Loss: 245.4368
    Epoch [08/20], Beta: 0.400, Average Loss: 246.2103
    Epoch [09/20], Beta: 0.500, Average Loss: 247.2054
    Epoch [10/20], Beta: 0.600, Average Loss: 248.3277
    Epoch [11/20], Beta: 0.700, Average Loss: 249.5749
    Epoch [12/20], Beta: 0.800, Average Loss: 250.8317
    Epoch [13/20], Beta: 0.900, Average Loss: 252.0597
    Epoch [14/20], Beta: 1.000, Average Loss: 253.7038
    Epoch [15/20], Beta: 1.000, Average Loss: 253.2203
    Epoch [16/20], Beta: 1.000, Average Loss: 252.8252
    Epoch [17/20], Beta: 1.000, Average Loss: 252.4625
    Epoch [18/20], Beta: 1.000, Average Loss: 252.1760
    Epoch [19/20], Beta: 1.000, Average Loss: 251.7850
    Epoch [20/20], Beta: 1.000, Average Loss: 251.6050

[Seed 98] VAE pre-training complete.

[Seed 98] Starting joint training (original)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=336.3518, vae=3.7665, dsb=306.8755, bio=51.4196
    Epoch  2/10: total=112.2552, vae=1.1078, dsb=111.1054, bio=0.0841
    Epoch  3/10: total=100.3234, vae=1.1031, dsb=99.2012, bio=0.0380
    Epoch  4/10: total=94.9518, vae=1.1014, dsb=93.8392, bio=0.0224
    Epoch  5/10: total=91.2200, vae=1.1006, dsb=90.1120, bio=0.0149
    Epoch  6/10: total=89.2414, vae=1.1002, dsb=88.1357, bio=0.0110
    Epoch  7/10: total=87.1184, vae=1.0997, dsb=86.0144, bio=0.0086
    Epoch  8/10: total=85.3697, vae=1.0990, dsb=84.2673, bio=0.0069
    Epoch  9/10: total=84.5040, vae=1.0995, dsb=83.4016, bio=0.0059
    Epoch 10/10: total=83.8293, vae=1.0990, dsb=82.7278, bio=0.0050

  [Backward Policy Training]
    Epoch  1/10: total=3.5454, vae=1.0998, dsb=2.4385, bio=0.0141
    Epoch  2/10: total=2.9559, vae=1.0982, dsb=1.8552, bio=0.0050
    Epoch  3/10: total=2.8018, vae=1.0981, dsb=1.7019, bio=0.0036
    Epoch  4/10: total=2.7297, vae=1.0975, dsb=1.6308, bio=0.0029
    Epoch  5/10: total=2.7142, vae=1.0977, dsb=1.6151, bio=0.0029
    Epoch  6/10: total=2.5978, vae=1.0971, dsb=1.4995, bio=0.0024
    Epoch  7/10: total=2.6673, vae=1.0966, dsb=1.5696, bio=0.0022
    Epoch  8/10: total=2.6265, vae=1.0964, dsb=1.5290, bio=0.0021
    Epoch  9/10: total=2.5898, vae=1.0966, dsb=1.4922, bio=0.0020
    Epoch 10/10: total=2.5308, vae=1.0964, dsb=1.4334, bio=0.0020

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=71.8009, vae=1.0991, dsb=70.7000, bio=0.0035
    Epoch  2/10: total=64.2223, vae=1.0976, dsb=63.1237, bio=0.0020
    Epoch  3/10: total=62.3684, vae=1.0979, dsb=61.2696, bio=0.0019
    Epoch  4/10: total=61.5474, vae=1.0973, dsb=60.4492, bio=0.0019
    Epoch  5/10: total=60.6573, vae=1.0965, dsb=59.5598, bio=0.0020
    Epoch  6/10: total=60.4912, vae=1.0973, dsb=59.3930, bio=0.0018
    Epoch  7/10: total=59.8248, vae=1.0967, dsb=58.7272, bio=0.0018
    Epoch  8/10: total=59.9121, vae=1.0963, dsb=58.8149, bio=0.0019
    Epoch  9/10: total=59.3744, vae=1.0972, dsb=58.2762, bio=0.0019
    Epoch 10/10: total=59.1620, vae=1.0976, dsb=58.0635, bio=0.0019

  [Backward Policy Training]
    Epoch  1/10: total=2.3016, vae=1.0972, dsb=1.1982, bio=0.0124
    Epoch  2/10: total=2.1947, vae=1.0960, dsb=1.0977, bio=0.0019
    Epoch  3/10: total=2.1518, vae=1.0947, dsb=1.0562, bio=0.0018
    Epoch  4/10: total=2.1051, vae=1.0946, dsb=1.0097, bio=0.0017
    Epoch  5/10: total=2.0923, vae=1.0959, dsb=0.9956, bio=0.0016
    Epoch  6/10: total=2.0594, vae=1.0949, dsb=0.9637, bio=0.0016
    Epoch  7/10: total=2.0672, vae=1.0953, dsb=0.9711, bio=0.0016
    Epoch  8/10: total=2.0594, vae=1.0950, dsb=0.9636, bio=0.0016
    Epoch  9/10: total=2.0585, vae=1.0958, dsb=0.9620, bio=0.0016
    Epoch 10/10: total=2.0359, vae=1.0955, dsb=0.9396, bio=0.0015

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=54.6006, vae=1.0982, dsb=53.5004, bio=0.0038
    Epoch  2/10: total=51.3320, vae=1.0962, dsb=50.2350, bio=0.0016
    Epoch  3/10: total=50.8396, vae=1.0970, dsb=49.7419, bio=0.0016
    Epoch  4/10: total=50.5540, vae=1.0960, dsb=49.4573, bio=0.0016
    Epoch  5/10: total=49.9855, vae=1.0960, dsb=48.8888, bio=0.0015
    Epoch  6/10: total=49.8959, vae=1.0957, dsb=48.7995, bio=0.0016
    Epoch  7/10: total=49.6025, vae=1.0974, dsb=48.5043, bio=0.0016
    Epoch  8/10: total=49.7362, vae=1.0958, dsb=48.6396, bio=0.0016
    Epoch  9/10: total=49.2335, vae=1.0952, dsb=48.1374, bio=0.0016
    Epoch 10/10: total=49.2911, vae=1.0950, dsb=48.1953, bio=0.0016

  [Backward Policy Training]
    Epoch  1/10: total=1.8895, vae=1.0960, dsb=0.7828, bio=0.0214
    Epoch  2/10: total=1.8300, vae=1.0963, dsb=0.7329, bio=0.0016
    Epoch  3/10: total=1.8110, vae=1.0948, dsb=0.7155, bio=0.0014
    Epoch  4/10: total=1.8080, vae=1.0944, dsb=0.7129, bio=0.0013
    Epoch  5/10: total=1.7767, vae=1.0957, dsb=0.6803, bio=0.0014
    Epoch  6/10: total=1.7827, vae=1.0953, dsb=0.6867, bio=0.0014
    Epoch  7/10: total=1.7681, vae=1.0946, dsb=0.6728, bio=0.0013
    Epoch  8/10: total=1.7674, vae=1.0950, dsb=0.6717, bio=0.0013
    Epoch  9/10: total=1.7723, vae=1.0950, dsb=0.6767, bio=0.0013
    Epoch 10/10: total=1.7517, vae=1.0956, dsb=0.6555, bio=0.0013

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=43.6647, vae=1.0980, dsb=42.5652, bio=0.0029
    Epoch  2/10: total=42.1980, vae=1.0955, dsb=41.1019, bio=0.0013
    Epoch  3/10: total=42.1772, vae=1.0956, dsb=41.0810, bio=0.0012
    Epoch  4/10: total=41.4897, vae=1.0956, dsb=40.3933, bio=0.0017
    Epoch  5/10: total=41.7851, vae=1.0949, dsb=40.6895, bio=0.0014
    Epoch  6/10: total=41.4413, vae=1.0948, dsb=40.3458, bio=0.0014
    Epoch  7/10: total=41.6597, vae=1.0960, dsb=40.5630, bio=0.0014
    Epoch  8/10: total=41.4339, vae=1.0948, dsb=40.3384, bio=0.0013
    Epoch  9/10: total=41.5059, vae=1.0950, dsb=40.4103, bio=0.0013
    Epoch 10/10: total=41.4265, vae=1.0945, dsb=40.3314, bio=0.0013

  [Backward Policy Training]
    Epoch  1/10: total=1.7141, vae=1.0952, dsb=0.5903, bio=0.0570
    Epoch  2/10: total=1.6803, vae=1.0953, dsb=0.5843, bio=0.0014
    Epoch  3/10: total=1.6645, vae=1.0950, dsb=0.5690, bio=0.0012
    Epoch  4/10: total=1.6511, vae=1.0938, dsb=0.5567, bio=0.0012
    Epoch  5/10: total=1.6405, vae=1.0953, dsb=0.5446, bio=0.0012
    Epoch  6/10: total=1.6472, vae=1.0939, dsb=0.5528, bio=0.0011
    Epoch  7/10: total=1.6499, vae=1.0941, dsb=0.5552, bio=0.0011
    Epoch  8/10: total=1.6323, vae=1.0942, dsb=0.5375, bio=0.0011
    Epoch  9/10: total=1.6462, vae=1.0950, dsb=0.5507, bio=0.0011
    Epoch 10/10: total=1.6430, vae=1.0937, dsb=0.5488, bio=0.0011

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=40.5833, vae=1.0977, dsb=39.4842, bio=0.0028
    Epoch  2/10: total=39.7643, vae=1.0958, dsb=38.6679, bio=0.0012
    Epoch  3/10: total=39.8302, vae=1.0958, dsb=38.7338, bio=0.0012
    Epoch  4/10: total=39.7548, vae=1.0948, dsb=38.6594, bio=0.0012
    Epoch  5/10: total=39.7732, vae=1.0944, dsb=38.6782, bio=0.0011
    Epoch  6/10: total=39.8842, vae=1.0949, dsb=38.7888, bio=0.0011
    Epoch  7/10: total=39.5964, vae=1.0944, dsb=38.5014, bio=0.0011
    Epoch  8/10: total=39.7321, vae=1.0943, dsb=38.6372, bio=0.0011
    Epoch  9/10: total=39.6656, vae=1.0943, dsb=38.5709, bio=0.0007
    Epoch 10/10: total=39.9157, vae=1.0944, dsb=38.8208, bio=0.0011

  [Backward Policy Training]
    Epoch  1/10: total=1.6243, vae=1.0955, dsb=0.4756, bio=0.1063
    Epoch  2/10: total=1.5564, vae=1.0942, dsb=0.4615, bio=0.0012
    Epoch  3/10: total=1.5632, vae=1.0938, dsb=0.4689, bio=0.0011
    Epoch  4/10: total=1.5470, vae=1.0946, dsb=0.4520, bio=0.0009
    Epoch  5/10: total=1.5646, vae=1.0944, dsb=0.4696, bio=0.0012
    Epoch  6/10: total=1.5530, vae=1.0941, dsb=0.4584, bio=0.0010
    Epoch  7/10: total=1.5451, vae=1.0940, dsb=0.4506, bio=0.0010
    Epoch  8/10: total=1.5387, vae=1.0936, dsb=0.4446, bio=0.0010
    Epoch  9/10: total=1.5460, vae=1.0945, dsb=0.4510, bio=0.0010
    Epoch 10/10: total=1.5456, vae=1.0940, dsb=0.4513, bio=0.0007

[Seed 98] Joint training (original) complete; models and history saved.

[Seed 98] Starting joint training (ablation)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=308.5113, vae=2.0117, dsb=306.4995, bio=0.0000
    Epoch  2/10: total=111.9141, vae=1.0907, dsb=110.8234, bio=0.0000
    Epoch  3/10: total=99.9513, vae=1.0888, dsb=98.8624, bio=0.0000
    Epoch  4/10: total=94.5784, vae=1.0881, dsb=93.4903, bio=0.0000
    Epoch  5/10: total=90.7460, vae=1.0877, dsb=89.6583, bio=0.0000
    Epoch  6/10: total=88.7165, vae=1.0877, dsb=87.6288, bio=0.0000
    Epoch  7/10: total=86.6624, vae=1.0875, dsb=85.5749, bio=0.0000
    Epoch  8/10: total=84.9232, vae=1.0871, dsb=83.8361, bio=0.0000
    Epoch  9/10: total=84.0811, vae=1.0878, dsb=82.9933, bio=0.0000
    Epoch 10/10: total=83.4402, vae=1.0876, dsb=82.3526, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=3.4402, vae=1.0875, dsb=2.3527, bio=0.0000
    Epoch  2/10: total=2.8823, vae=1.0874, dsb=1.7949, bio=0.0000
    Epoch  3/10: total=2.7258, vae=1.0877, dsb=1.6381, bio=0.0000
    Epoch  4/10: total=2.6558, vae=1.0874, dsb=1.5684, bio=0.0000
    Epoch  5/10: total=2.6410, vae=1.0877, dsb=1.5533, bio=0.0000
    Epoch  6/10: total=2.5297, vae=1.0873, dsb=1.4424, bio=0.0000
    Epoch  7/10: total=2.5966, vae=1.0870, dsb=1.5097, bio=0.0000
    Epoch  8/10: total=2.5596, vae=1.0868, dsb=1.4728, bio=0.0000
    Epoch  9/10: total=2.5249, vae=1.0871, dsb=1.4378, bio=0.0000
    Epoch 10/10: total=2.4690, vae=1.0871, dsb=1.3819, bio=0.0000

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=71.1351, vae=1.0871, dsb=70.0480, bio=0.0000
    Epoch  2/10: total=63.4150, vae=1.0868, dsb=62.3282, bio=0.0000
    Epoch  3/10: total=61.6834, vae=1.0874, dsb=60.5961, bio=0.0000
    Epoch  4/10: total=60.8548, vae=1.0869, dsb=59.7678, bio=0.0000
    Epoch  5/10: total=60.0117, vae=1.0863, dsb=58.9254, bio=0.0000
    Epoch  6/10: total=59.7225, vae=1.0872, dsb=58.6353, bio=0.0000
    Epoch  7/10: total=59.0857, vae=1.0867, dsb=57.9990, bio=0.0000
    Epoch  8/10: total=59.1502, vae=1.0863, dsb=58.0639, bio=0.0000
    Epoch  9/10: total=58.6357, vae=1.0874, dsb=57.5483, bio=0.0000
    Epoch 10/10: total=58.3225, vae=1.0878, dsb=57.2346, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=2.2557, vae=1.0869, dsb=1.1688, bio=0.0000
    Epoch  2/10: total=2.1564, vae=1.0871, dsb=1.0693, bio=0.0000
    Epoch  3/10: total=2.1144, vae=1.0858, dsb=1.0285, bio=0.0000
    Epoch  4/10: total=2.0673, vae=1.0859, dsb=0.9814, bio=0.0000
    Epoch  5/10: total=2.0541, vae=1.0871, dsb=0.9670, bio=0.0000
    Epoch  6/10: total=2.0214, vae=1.0863, dsb=0.9351, bio=0.0000
    Epoch  7/10: total=2.0283, vae=1.0867, dsb=0.9416, bio=0.0000
    Epoch  8/10: total=2.0199, vae=1.0865, dsb=0.9335, bio=0.0000
    Epoch  9/10: total=2.0193, vae=1.0873, dsb=0.9320, bio=0.0000
    Epoch 10/10: total=1.9972, vae=1.0871, dsb=0.9100, bio=0.0000

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=55.9420, vae=1.0861, dsb=54.8559, bio=0.0000
    Epoch  2/10: total=52.5921, vae=1.0863, dsb=51.5058, bio=0.0000
    Epoch  3/10: total=52.0289, vae=1.0874, dsb=50.9415, bio=0.0000
    Epoch  4/10: total=51.6232, vae=1.0865, dsb=50.5366, bio=0.0000
    Epoch  5/10: total=51.0188, vae=1.0867, dsb=49.9321, bio=0.0000
    Epoch  6/10: total=50.9061, vae=1.0865, dsb=49.8196, bio=0.0000
    Epoch  7/10: total=50.7066, vae=1.0883, dsb=49.6183, bio=0.0000
    Epoch  8/10: total=50.7743, vae=1.0867, dsb=49.6876, bio=0.0000
    Epoch  9/10: total=50.2845, vae=1.0863, dsb=49.1983, bio=0.0000
    Epoch 10/10: total=50.2378, vae=1.0861, dsb=49.1517, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.8483, vae=1.0865, dsb=0.7618, bio=0.0000
    Epoch  2/10: total=1.7993, vae=1.0880, dsb=0.7113, bio=0.0000
    Epoch  3/10: total=1.7812, vae=1.0866, dsb=0.6946, bio=0.0000
    Epoch  4/10: total=1.7771, vae=1.0862, dsb=0.6909, bio=0.0000
    Epoch  5/10: total=1.7471, vae=1.0876, dsb=0.6595, bio=0.0000
    Epoch  6/10: total=1.7524, vae=1.0872, dsb=0.6652, bio=0.0000
    Epoch  7/10: total=1.7381, vae=1.0866, dsb=0.6516, bio=0.0000
    Epoch  8/10: total=1.7371, vae=1.0870, dsb=0.6501, bio=0.0000
    Epoch  9/10: total=1.7413, vae=1.0870, dsb=0.6543, bio=0.0000
    Epoch 10/10: total=1.7210, vae=1.0876, dsb=0.6334, bio=0.0000

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=43.9790, vae=1.0872, dsb=42.8917, bio=0.0000
    Epoch  2/10: total=42.3774, vae=1.0861, dsb=41.2913, bio=0.0000
    Epoch  3/10: total=42.3503, vae=1.0865, dsb=41.2638, bio=0.0000
    Epoch  4/10: total=41.6023, vae=1.0867, dsb=40.5156, bio=0.0000
    Epoch  5/10: total=41.9275, vae=1.0863, dsb=40.8412, bio=0.0000
    Epoch  6/10: total=41.5231, vae=1.0862, dsb=40.4368, bio=0.0000
    Epoch  7/10: total=41.8006, vae=1.0875, dsb=40.7132, bio=0.0000
    Epoch  8/10: total=41.5535, vae=1.0863, dsb=40.4672, bio=0.0000
    Epoch  9/10: total=41.6062, vae=1.0866, dsb=40.5196, bio=0.0000
    Epoch 10/10: total=41.5550, vae=1.0862, dsb=40.4687, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.6547, vae=1.0862, dsb=0.5685, bio=0.0000
    Epoch  2/10: total=1.6496, vae=1.0872, dsb=0.5624, bio=0.0000
    Epoch  3/10: total=1.6341, vae=1.0870, dsb=0.5471, bio=0.0000
    Epoch  4/10: total=1.6204, vae=1.0858, dsb=0.5346, bio=0.0000
    Epoch  5/10: total=1.6101, vae=1.0875, dsb=0.5226, bio=0.0000
    Epoch  6/10: total=1.6166, vae=1.0861, dsb=0.5306, bio=0.0000
    Epoch  7/10: total=1.6192, vae=1.0863, dsb=0.5329, bio=0.0000
    Epoch  8/10: total=1.6022, vae=1.0865, dsb=0.5157, bio=0.0000
    Epoch  9/10: total=1.6158, vae=1.0873, dsb=0.5285, bio=0.0000
    Epoch 10/10: total=1.6120, vae=1.0860, dsb=0.5260, bio=0.0000

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=40.2150, vae=1.0868, dsb=39.1282, bio=0.0000
    Epoch  2/10: total=39.4776, vae=1.0867, dsb=38.3909, bio=0.0000
    Epoch  3/10: total=39.4747, vae=1.0871, dsb=38.3875, bio=0.0000
    Epoch  4/10: total=39.3663, vae=1.0864, dsb=38.2799, bio=0.0000
    Epoch  5/10: total=39.4203, vae=1.0861, dsb=38.3342, bio=0.0000
    Epoch  6/10: total=39.5548, vae=1.0867, dsb=38.4682, bio=0.0000
    Epoch  7/10: total=39.2261, vae=1.0863, dsb=38.1397, bio=0.0000
    Epoch  8/10: total=39.3641, vae=1.0863, dsb=38.2778, bio=0.0000
    Epoch  9/10: total=39.3429, vae=1.0863, dsb=38.2565, bio=0.0000
    Epoch 10/10: total=39.5484, vae=1.0865, dsb=38.4618, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.5239, vae=1.0867, dsb=0.4372, bio=0.0000
    Epoch  2/10: total=1.5100, vae=1.0863, dsb=0.4237, bio=0.0000
    Epoch  3/10: total=1.5164, vae=1.0861, dsb=0.4304, bio=0.0000
    Epoch  4/10: total=1.5015, vae=1.0868, dsb=0.4147, bio=0.0000
    Epoch  5/10: total=1.5176, vae=1.0869, dsb=0.4308, bio=0.0000
    Epoch  6/10: total=1.5066, vae=1.0866, dsb=0.4200, bio=0.0000
    Epoch  7/10: total=1.4995, vae=1.0865, dsb=0.4130, bio=0.0000
    Epoch  8/10: total=1.4933, vae=1.0861, dsb=0.4072, bio=0.0000
    Epoch  9/10: total=1.5000, vae=1.0870, dsb=0.4130, bio=0.0000
    Epoch 10/10: total=1.4997, vae=1.0865, dsb=0.4132, bio=0.0000

[Seed 98] Joint training (ablation) complete; models and history saved.

[Seed 98] Drift genes saved in /home/yyuan/ICB_TCE/iter_results/run_098

[Seed 98] run finished.

================================================================================
[Seed 99] Starting running whole pipeline...
================================================================================

[Seed 99] Starting VAE pre-training...

    Epoch [01/20], Beta: 0.000, Average Loss: 534.0654
    Epoch [02/20], Beta: 0.000, Average Loss: 309.2468
    Epoch [03/20], Beta: 0.000, Average Loss: 269.9122
    Epoch [04/20], Beta: 0.000, Average Loss: 249.1794
    Epoch [05/20], Beta: 0.100, Average Loss: 244.4161
    Epoch [06/20], Beta: 0.200, Average Loss: 244.1025
    Epoch [07/20], Beta: 0.300, Average Loss: 244.6660
    Epoch [08/20], Beta: 0.400, Average Loss: 245.6212
    Epoch [09/20], Beta: 0.500, Average Loss: 246.7640
    Epoch [10/20], Beta: 0.600, Average Loss: 247.9717
    Epoch [11/20], Beta: 0.700, Average Loss: 249.3066
    Epoch [12/20], Beta: 0.800, Average Loss: 250.6596
    Epoch [13/20], Beta: 0.900, Average Loss: 251.9335
    Epoch [14/20], Beta: 1.000, Average Loss: 253.5741
    Epoch [15/20], Beta: 1.000, Average Loss: 253.1314
    Epoch [16/20], Beta: 1.000, Average Loss: 252.7223
    Epoch [17/20], Beta: 1.000, Average Loss: 252.3631
    Epoch [18/20], Beta: 1.000, Average Loss: 252.0549
    Epoch [19/20], Beta: 1.000, Average Loss: 251.6747
    Epoch [20/20], Beta: 1.000, Average Loss: 251.5073

[Seed 99] VAE pre-training complete.

[Seed 99] Starting joint training (original)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=283.6956, vae=3.7424, dsb=261.3804, bio=37.1455
    Epoch  2/10: total=84.4040, vae=1.0976, dsb=83.2628, bio=0.0871
    Epoch  3/10: total=70.4767, vae=1.0925, dsb=69.3669, bio=0.0348
    Epoch  4/10: total=64.3392, vae=1.0909, dsb=63.2381, bio=0.0203
    Epoch  5/10: total=60.6510, vae=1.0903, dsb=59.5540, bio=0.0135
    Epoch  6/10: total=57.9649, vae=1.0902, dsb=56.8698, bio=0.0099
    Epoch  7/10: total=56.0674, vae=1.0897, dsb=54.9739, bio=0.0076
    Epoch  8/10: total=54.9416, vae=1.0887, dsb=53.8499, bio=0.0061
    Epoch  9/10: total=53.9956, vae=1.0885, dsb=52.9045, bio=0.0053
    Epoch 10/10: total=53.1111, vae=1.0882, dsb=52.0207, bio=0.0045

  [Backward Policy Training]
    Epoch  1/10: total=3.4586, vae=1.0883, dsb=2.3640, bio=0.0126
    Epoch  2/10: total=2.8718, vae=1.0873, dsb=1.7822, bio=0.0046
    Epoch  3/10: total=2.7313, vae=1.0872, dsb=1.6425, bio=0.0034
    Epoch  4/10: total=2.6160, vae=1.0871, dsb=1.5275, bio=0.0028
    Epoch  5/10: total=2.6027, vae=1.0864, dsb=1.5151, bio=0.0025
    Epoch  6/10: total=2.4949, vae=1.0865, dsb=1.4072, bio=0.0023
    Epoch  7/10: total=2.4891, vae=1.0861, dsb=1.4020, bio=0.0021
    Epoch  8/10: total=2.4477, vae=1.0861, dsb=1.3606, bio=0.0020
    Epoch  9/10: total=2.4428, vae=1.0848, dsb=1.3570, bio=0.0019
    Epoch 10/10: total=2.4601, vae=1.0848, dsb=1.3744, bio=0.0019

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=52.9495, vae=1.0890, dsb=51.8587, bio=0.0036
    Epoch  2/10: total=43.8473, vae=1.0861, dsb=42.7604, bio=0.0017
    Epoch  3/10: total=41.5074, vae=1.0866, dsb=40.4199, bio=0.0018
    Epoch  4/10: total=40.4369, vae=1.0861, dsb=39.3499, bio=0.0018
    Epoch  5/10: total=39.6986, vae=1.0872, dsb=38.6105, bio=0.0018
    Epoch  6/10: total=39.1953, vae=1.0869, dsb=38.1074, bio=0.0018
    Epoch  7/10: total=38.7180, vae=1.0860, dsb=37.6311, bio=0.0018
    Epoch  8/10: total=38.3120, vae=1.0855, dsb=37.2256, bio=0.0018
    Epoch  9/10: total=38.2763, vae=1.0849, dsb=37.1905, bio=0.0018
    Epoch 10/10: total=38.0279, vae=1.0858, dsb=36.9411, bio=0.0018

  [Backward Policy Training]
    Epoch  1/10: total=2.2389, vae=1.0865, dsb=1.1473, bio=0.0104
    Epoch  2/10: total=2.0617, vae=1.0856, dsb=0.9751, bio=0.0018
    Epoch  3/10: total=2.0368, vae=1.0843, dsb=0.9517, bio=0.0016
    Epoch  4/10: total=1.9703, vae=1.0844, dsb=0.8851, bio=0.0016
    Epoch  5/10: total=1.9790, vae=1.0843, dsb=0.8940, bio=0.0015
    Epoch  6/10: total=1.9722, vae=1.0845, dsb=0.8870, bio=0.0015
    Epoch  7/10: total=1.9353, vae=1.0843, dsb=0.8503, bio=0.0014
    Epoch  8/10: total=1.9437, vae=1.0853, dsb=0.8577, bio=0.0015
    Epoch  9/10: total=1.9497, vae=1.0843, dsb=0.8647, bio=0.0014
    Epoch 10/10: total=1.9158, vae=1.0844, dsb=0.8307, bio=0.0014

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=39.5350, vae=1.0875, dsb=38.4461, bio=0.0028
    Epoch  2/10: total=36.0371, vae=1.0857, dsb=34.9507, bio=0.0015
    Epoch  3/10: total=35.2093, vae=1.0856, dsb=34.1230, bio=0.0016
    Epoch  4/10: total=34.5874, vae=1.0855, dsb=33.5011, bio=0.0016
    Epoch  5/10: total=34.2270, vae=1.0843, dsb=33.1419, bio=0.0015
    Epoch  6/10: total=34.0660, vae=1.0845, dsb=32.9807, bio=0.0015
    Epoch  7/10: total=33.8094, vae=1.0847, dsb=32.7240, bio=0.0015
    Epoch  8/10: total=33.5128, vae=1.0849, dsb=32.4270, bio=0.0018
    Epoch  9/10: total=33.5288, vae=1.0846, dsb=32.4434, bio=0.0014
    Epoch 10/10: total=33.6050, vae=1.0845, dsb=32.5198, bio=0.0014

  [Backward Policy Training]
    Epoch  1/10: total=1.8484, vae=1.0853, dsb=0.7331, bio=0.0600
    Epoch  2/10: total=1.7509, vae=1.0840, dsb=0.6662, bio=0.0014
    Epoch  3/10: total=1.7517, vae=1.0837, dsb=0.6673, bio=0.0013
    Epoch  4/10: total=1.7266, vae=1.0839, dsb=0.6421, bio=0.0013
    Epoch  5/10: total=1.7203, vae=1.0845, dsb=0.6352, bio=0.0012
    Epoch  6/10: total=1.7042, vae=1.0836, dsb=0.6200, bio=0.0012
    Epoch  7/10: total=1.6970, vae=1.0838, dsb=0.6126, bio=0.0012
    Epoch  8/10: total=1.6933, vae=1.0826, dsb=0.6100, bio=0.0012
    Epoch  9/10: total=1.7036, vae=1.0837, dsb=0.6193, bio=0.0012
    Epoch 10/10: total=1.7051, vae=1.0841, dsb=0.6204, bio=0.0012

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=30.3250, vae=1.0867, dsb=29.2370, bio=0.0026
    Epoch  2/10: total=28.6801, vae=1.0850, dsb=27.5944, bio=0.0016
    Epoch  3/10: total=28.2845, vae=1.0854, dsb=27.1985, bio=0.0011
    Epoch  4/10: total=28.0650, vae=1.0842, dsb=26.9801, bio=0.0014
    Epoch  5/10: total=27.9244, vae=1.0843, dsb=26.8394, bio=0.0013
    Epoch  6/10: total=27.6941, vae=1.0844, dsb=26.6090, bio=0.0013
    Epoch  7/10: total=27.8317, vae=1.0842, dsb=26.7469, bio=0.0013
    Epoch  8/10: total=27.7119, vae=1.0841, dsb=26.6272, bio=0.0013
    Epoch  9/10: total=27.6329, vae=1.0838, dsb=26.5485, bio=0.0012
    Epoch 10/10: total=27.6066, vae=1.0834, dsb=26.5227, bio=0.0012

  [Backward Policy Training]
    Epoch  1/10: total=1.6524, vae=1.0842, dsb=0.5315, bio=0.0734
    Epoch  2/10: total=1.5854, vae=1.0834, dsb=0.5013, bio=0.0012
    Epoch  3/10: total=1.5832, vae=1.0833, dsb=0.4994, bio=0.0011
    Epoch  4/10: total=1.5695, vae=1.0837, dsb=0.4852, bio=0.0011
    Epoch  5/10: total=1.5758, vae=1.0839, dsb=0.4913, bio=0.0010
    Epoch  6/10: total=1.5647, vae=1.0837, dsb=0.4804, bio=0.0010
    Epoch  7/10: total=1.5613, vae=1.0837, dsb=0.4771, bio=0.0010
    Epoch  8/10: total=1.5550, vae=1.0835, dsb=0.4710, bio=0.0010
    Epoch  9/10: total=1.5638, vae=1.0831, dsb=0.4802, bio=0.0010
    Epoch 10/10: total=1.5529, vae=1.0832, dsb=0.4693, bio=0.0009

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=25.3676, vae=1.0859, dsb=24.2802, bio=0.0030
    Epoch  2/10: total=24.7027, vae=1.0848, dsb=23.6174, bio=0.0012
    Epoch  3/10: total=24.5787, vae=1.0853, dsb=23.4928, bio=0.0012
    Epoch  4/10: total=24.5606, vae=1.0840, dsb=23.4760, bio=0.0012
    Epoch  5/10: total=24.3277, vae=1.0847, dsb=23.2424, bio=0.0012
    Epoch  6/10: total=24.2910, vae=1.0841, dsb=23.2063, bio=0.0011
    Epoch  7/10: total=24.3094, vae=1.0839, dsb=23.2250, bio=0.0011
    Epoch  8/10: total=24.4387, vae=1.0835, dsb=23.3549, bio=0.0008
    Epoch  9/10: total=23.9971, vae=1.0834, dsb=22.9130, bio=0.0014
    Epoch 10/10: total=24.2047, vae=1.0835, dsb=23.1207, bio=0.0011

  [Backward Policy Training]
    Epoch  1/10: total=1.5732, vae=1.0848, dsb=0.4349, bio=0.1069
    Epoch  2/10: total=1.4971, vae=1.0828, dsb=0.4137, bio=0.0012
    Epoch  3/10: total=1.5081, vae=1.0827, dsb=0.4249, bio=0.0010
    Epoch  4/10: total=1.4928, vae=1.0826, dsb=0.4097, bio=0.0010
    Epoch  5/10: total=1.4868, vae=1.0834, dsb=0.4029, bio=0.0010
    Epoch  6/10: total=1.4882, vae=1.0822, dsb=0.4056, bio=0.0009
    Epoch  7/10: total=1.4866, vae=1.0829, dsb=0.4033, bio=0.0009
    Epoch  8/10: total=1.4808, vae=1.0827, dsb=0.3978, bio=0.0005
    Epoch  9/10: total=1.4773, vae=1.0819, dsb=0.3949, bio=0.0011
    Epoch 10/10: total=1.4812, vae=1.0819, dsb=0.3988, bio=0.0010

[Seed 99] Joint training (original) complete; models and history saved.

[Seed 99] Starting joint training (ablation)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=263.0857, vae=2.0088, dsb=261.0769, bio=0.0000
    Epoch  2/10: total=84.0558, vae=1.0804, dsb=82.9753, bio=0.0000
    Epoch  3/10: total=70.2241, vae=1.0781, dsb=69.1461, bio=0.0000
    Epoch  4/10: total=64.0222, vae=1.0774, dsb=62.9448, bio=0.0000
    Epoch  5/10: total=60.4554, vae=1.0772, dsb=59.3782, bio=0.0000
    Epoch  6/10: total=57.8054, vae=1.0774, dsb=56.7279, bio=0.0000
    Epoch  7/10: total=55.9175, vae=1.0772, dsb=54.8403, bio=0.0000
    Epoch  8/10: total=54.7678, vae=1.0765, dsb=53.6914, bio=0.0000
    Epoch  9/10: total=53.7935, vae=1.0765, dsb=52.7170, bio=0.0000
    Epoch 10/10: total=52.8968, vae=1.0764, dsb=51.8204, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=3.3688, vae=1.0757, dsb=2.2931, bio=0.0000
    Epoch  2/10: total=2.8168, vae=1.0764, dsb=1.7404, bio=0.0000
    Epoch  3/10: total=2.6820, vae=1.0767, dsb=1.6053, bio=0.0000
    Epoch  4/10: total=2.5687, vae=1.0769, dsb=1.4919, bio=0.0000
    Epoch  5/10: total=2.5541, vae=1.0764, dsb=1.4777, bio=0.0000
    Epoch  6/10: total=2.4482, vae=1.0767, dsb=1.3715, bio=0.0000
    Epoch  7/10: total=2.4413, vae=1.0764, dsb=1.3649, bio=0.0000
    Epoch  8/10: total=2.4006, vae=1.0764, dsb=1.3242, bio=0.0000
    Epoch  9/10: total=2.3974, vae=1.0754, dsb=1.3220, bio=0.0000
    Epoch 10/10: total=2.4141, vae=1.0754, dsb=1.3388, bio=0.0000

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=52.3717, vae=1.0768, dsb=51.2949, bio=0.0000
    Epoch  2/10: total=43.4990, vae=1.0752, dsb=42.4238, bio=0.0000
    Epoch  3/10: total=41.2744, vae=1.0759, dsb=40.1985, bio=0.0000
    Epoch  4/10: total=40.2020, vae=1.0755, dsb=39.1265, bio=0.0000
    Epoch  5/10: total=39.4992, vae=1.0768, dsb=38.4225, bio=0.0000
    Epoch  6/10: total=38.9755, vae=1.0766, dsb=37.8989, bio=0.0000
    Epoch  7/10: total=38.5243, vae=1.0758, dsb=37.4485, bio=0.0000
    Epoch  8/10: total=38.0780, vae=1.0755, dsb=37.0025, bio=0.0000
    Epoch  9/10: total=38.0577, vae=1.0750, dsb=36.9828, bio=0.0000
    Epoch 10/10: total=37.7768, vae=1.0761, dsb=36.7007, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=2.2129, vae=1.0762, dsb=1.1366, bio=0.0000
    Epoch  2/10: total=2.0420, vae=1.0767, dsb=0.9653, bio=0.0000
    Epoch  3/10: total=2.0183, vae=1.0754, dsb=0.9429, bio=0.0000
    Epoch  4/10: total=1.9529, vae=1.0756, dsb=0.8773, bio=0.0000
    Epoch  5/10: total=1.9620, vae=1.0756, dsb=0.8864, bio=0.0000
    Epoch  6/10: total=1.9559, vae=1.0758, dsb=0.8800, bio=0.0000
    Epoch  7/10: total=1.9189, vae=1.0758, dsb=0.8431, bio=0.0000
    Epoch  8/10: total=1.9275, vae=1.0767, dsb=0.8508, bio=0.0000
    Epoch  9/10: total=1.9338, vae=1.0759, dsb=0.8580, bio=0.0000
    Epoch 10/10: total=1.9005, vae=1.0759, dsb=0.8246, bio=0.0000

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=40.3525, vae=1.0764, dsb=39.2761, bio=0.0000
    Epoch  2/10: total=36.7486, vae=1.0759, dsb=35.6727, bio=0.0000
    Epoch  3/10: total=35.8892, vae=1.0761, dsb=34.8131, bio=0.0000
    Epoch  4/10: total=35.2843, vae=1.0762, dsb=34.2080, bio=0.0000
    Epoch  5/10: total=34.8754, vae=1.0751, dsb=33.8002, bio=0.0000
    Epoch  6/10: total=34.7130, vae=1.0755, dsb=33.6375, bio=0.0000
    Epoch  7/10: total=34.4562, vae=1.0757, dsb=33.3804, bio=0.0000
    Epoch  8/10: total=34.1684, vae=1.0759, dsb=33.0924, bio=0.0000
    Epoch  9/10: total=34.1802, vae=1.0760, dsb=33.1042, bio=0.0000
    Epoch 10/10: total=34.2633, vae=1.0759, dsb=33.1874, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.7913, vae=1.0761, dsb=0.7152, bio=0.0000
    Epoch  2/10: total=1.7237, vae=1.0757, dsb=0.6480, bio=0.0000
    Epoch  3/10: total=1.7237, vae=1.0755, dsb=0.6482, bio=0.0000
    Epoch  4/10: total=1.6986, vae=1.0757, dsb=0.6229, bio=0.0000
    Epoch  5/10: total=1.6918, vae=1.0764, dsb=0.6154, bio=0.0000
    Epoch  6/10: total=1.6766, vae=1.0754, dsb=0.6011, bio=0.0000
    Epoch  7/10: total=1.6696, vae=1.0758, dsb=0.5938, bio=0.0000
    Epoch  8/10: total=1.6652, vae=1.0746, dsb=0.5905, bio=0.0000
    Epoch  9/10: total=1.6757, vae=1.0758, dsb=0.6000, bio=0.0000
    Epoch 10/10: total=1.6766, vae=1.0761, dsb=0.6005, bio=0.0000

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=31.8188, vae=1.0761, dsb=30.7427, bio=0.0000
    Epoch  2/10: total=30.1857, vae=1.0755, dsb=29.1102, bio=0.0000
    Epoch  3/10: total=29.7448, vae=1.0763, dsb=28.6685, bio=0.0000
    Epoch  4/10: total=29.5506, vae=1.0755, dsb=28.4751, bio=0.0000
    Epoch  5/10: total=29.4105, vae=1.0758, dsb=28.3347, bio=0.0000
    Epoch  6/10: total=29.1787, vae=1.0759, dsb=28.1028, bio=0.0000
    Epoch  7/10: total=29.3521, vae=1.0758, dsb=28.2763, bio=0.0000
    Epoch  8/10: total=29.1998, vae=1.0758, dsb=28.1240, bio=0.0000
    Epoch  9/10: total=29.1365, vae=1.0755, dsb=28.0610, bio=0.0000
    Epoch 10/10: total=29.1129, vae=1.0752, dsb=28.0377, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.5820, vae=1.0751, dsb=0.5069, bio=0.0000
    Epoch  2/10: total=1.5550, vae=1.0755, dsb=0.4795, bio=0.0000
    Epoch  3/10: total=1.5537, vae=1.0754, dsb=0.4783, bio=0.0000
    Epoch  4/10: total=1.5404, vae=1.0758, dsb=0.4646, bio=0.0000
    Epoch  5/10: total=1.5475, vae=1.0762, dsb=0.4713, bio=0.0000
    Epoch  6/10: total=1.5370, vae=1.0761, dsb=0.4609, bio=0.0000
    Epoch  7/10: total=1.5337, vae=1.0761, dsb=0.4576, bio=0.0000
    Epoch  8/10: total=1.5276, vae=1.0760, dsb=0.4516, bio=0.0000
    Epoch  9/10: total=1.5366, vae=1.0756, dsb=0.4610, bio=0.0000
    Epoch 10/10: total=1.5261, vae=1.0758, dsb=0.4502, bio=0.0000

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=26.9775, vae=1.0754, dsb=25.9021, bio=0.0000
    Epoch  2/10: total=26.3992, vae=1.0757, dsb=25.3235, bio=0.0000
    Epoch  3/10: total=26.3029, vae=1.0766, dsb=25.2262, bio=0.0000
    Epoch  4/10: total=26.2756, vae=1.0755, dsb=25.2001, bio=0.0000
    Epoch  5/10: total=26.0486, vae=1.0764, dsb=24.9722, bio=0.0000
    Epoch  6/10: total=26.0125, vae=1.0759, dsb=24.9365, bio=0.0000
    Epoch  7/10: total=26.0138, vae=1.0758, dsb=24.9380, bio=0.0000
    Epoch  8/10: total=26.2027, vae=1.0755, dsb=25.1272, bio=0.0000
    Epoch  9/10: total=25.6853, vae=1.0755, dsb=24.6098, bio=0.0000
    Epoch 10/10: total=25.9429, vae=1.0757, dsb=24.8671, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.4851, vae=1.0761, dsb=0.4090, bio=0.0000
    Epoch  2/10: total=1.4665, vae=1.0754, dsb=0.3911, bio=0.0000
    Epoch  3/10: total=1.4781, vae=1.0754, dsb=0.4027, bio=0.0000
    Epoch  4/10: total=1.4634, vae=1.0754, dsb=0.3880, bio=0.0000
    Epoch  5/10: total=1.4581, vae=1.0762, dsb=0.3819, bio=0.0000
    Epoch  6/10: total=1.4596, vae=1.0751, dsb=0.3845, bio=0.0000
    Epoch  7/10: total=1.4583, vae=1.0759, dsb=0.3824, bio=0.0000
    Epoch  8/10: total=1.4533, vae=1.0758, dsb=0.3774, bio=0.0000
    Epoch  9/10: total=1.4501, vae=1.0752, dsb=0.3749, bio=0.0000
    Epoch 10/10: total=1.4535, vae=1.0753, dsb=0.3782, bio=0.0000

[Seed 99] Joint training (ablation) complete; models and history saved.

[Seed 99] Drift genes saved in /home/yyuan/ICB_TCE/iter_results/run_099

[Seed 99] run finished.

================================================================================
[Seed 100] Starting running whole pipeline...
================================================================================

[Seed 100] Starting VAE pre-training...

    Epoch [01/20], Beta: 0.000, Average Loss: 534.4346
    Epoch [02/20], Beta: 0.000, Average Loss: 313.0114
    Epoch [03/20], Beta: 0.000, Average Loss: 274.3492
    Epoch [04/20], Beta: 0.000, Average Loss: 251.3691
    Epoch [05/20], Beta: 0.100, Average Loss: 245.5166
    Epoch [06/20], Beta: 0.200, Average Loss: 244.6364
    Epoch [07/20], Beta: 0.300, Average Loss: 244.9636
    Epoch [08/20], Beta: 0.400, Average Loss: 245.7558
    Epoch [09/20], Beta: 0.500, Average Loss: 246.8439
    Epoch [10/20], Beta: 0.600, Average Loss: 248.0121
    Epoch [11/20], Beta: 0.700, Average Loss: 249.1916
    Epoch [12/20], Beta: 0.800, Average Loss: 250.3904
    Epoch [13/20], Beta: 0.900, Average Loss: 251.6013
    Epoch [14/20], Beta: 1.000, Average Loss: 253.1918
    Epoch [15/20], Beta: 1.000, Average Loss: 252.7848
    Epoch [16/20], Beta: 1.000, Average Loss: 252.4127
    Epoch [17/20], Beta: 1.000, Average Loss: 252.0532
    Epoch [18/20], Beta: 1.000, Average Loss: 251.7269
    Epoch [19/20], Beta: 1.000, Average Loss: 251.3589
    Epoch [20/20], Beta: 1.000, Average Loss: 251.2103

[Seed 100] VAE pre-training complete.

[Seed 100] Starting joint training (original)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=328.2831, vae=3.5147, dsb=308.4930, bio=32.5506
    Epoch  2/10: total=86.6303, vae=1.0948, dsb=85.5029, bio=0.0654
    Epoch  3/10: total=74.0261, vae=1.0899, dsb=72.9222, bio=0.0280
    Epoch  4/10: total=67.8731, vae=1.0886, dsb=66.7764, bio=0.0161
    Epoch  5/10: total=64.5700, vae=1.0883, dsb=63.4764, bio=0.0106
    Epoch  6/10: total=62.1477, vae=1.0867, dsb=61.0572, bio=0.0077
    Epoch  7/10: total=60.5192, vae=1.0873, dsb=59.4289, bio=0.0059
    Epoch  8/10: total=59.3677, vae=1.0867, dsb=58.2785, bio=0.0050
    Epoch  9/10: total=58.0383, vae=1.0867, dsb=56.9497, bio=0.0039
    Epoch 10/10: total=57.4516, vae=1.0849, dsb=56.3649, bio=0.0035

  [Backward Policy Training]
    Epoch  1/10: total=3.2921, vae=1.0868, dsb=2.2002, bio=0.0102
    Epoch  2/10: total=2.8132, vae=1.0854, dsb=1.7261, bio=0.0035
    Epoch  3/10: total=2.6843, vae=1.0858, dsb=1.5971, bio=0.0027
    Epoch  4/10: total=2.6468, vae=1.0848, dsb=1.5608, bio=0.0024
    Epoch  5/10: total=2.5215, vae=1.0844, dsb=1.4360, bio=0.0022
    Epoch  6/10: total=2.4595, vae=1.0833, dsb=1.3751, bio=0.0021
    Epoch  7/10: total=2.4674, vae=1.0834, dsb=1.3829, bio=0.0020
    Epoch  8/10: total=2.4291, vae=1.0842, dsb=1.3439, bio=0.0019
    Epoch  9/10: total=2.4786, vae=1.0845, dsb=1.3932, bio=0.0019
    Epoch 10/10: total=2.4107, vae=1.0834, dsb=1.3264, bio=0.0018

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=57.4507, vae=1.0858, dsb=56.3634, bio=0.0030
    Epoch  2/10: total=49.3920, vae=1.0851, dsb=48.3057, bio=0.0023
    Epoch  3/10: total=47.5302, vae=1.0844, dsb=46.4449, bio=0.0018
    Epoch  4/10: total=46.2626, vae=1.0838, dsb=45.1779, bio=0.0017
    Epoch  5/10: total=45.6836, vae=1.0846, dsb=44.5981, bio=0.0017
    Epoch  6/10: total=45.4832, vae=1.0837, dsb=44.3986, bio=0.0017
    Epoch  7/10: total=44.9637, vae=1.0834, dsb=43.8793, bio=0.0018
    Epoch  8/10: total=44.6232, vae=1.0842, dsb=43.5383, bio=0.0016
    Epoch  9/10: total=44.1547, vae=1.0838, dsb=43.0701, bio=0.0017
    Epoch 10/10: total=43.9136, vae=1.0834, dsb=42.8293, bio=0.0016

  [Backward Policy Training]
    Epoch  1/10: total=2.1674, vae=1.0842, dsb=1.0791, bio=0.0082
    Epoch  2/10: total=2.0032, vae=1.0821, dsb=0.9202, bio=0.0017
    Epoch  3/10: total=1.9731, vae=1.0832, dsb=0.8891, bio=0.0015
    Epoch  4/10: total=1.9654, vae=1.0829, dsb=0.8818, bio=0.0015
    Epoch  5/10: total=1.9348, vae=1.0826, dsb=0.8515, bio=0.0014
    Epoch  6/10: total=1.9318, vae=1.0828, dsb=0.8483, bio=0.0015
    Epoch  7/10: total=1.8853, vae=1.0821, dsb=0.8025, bio=0.0014
    Epoch  8/10: total=1.8875, vae=1.0823, dsb=0.8045, bio=0.0014
    Epoch  9/10: total=1.8838, vae=1.0820, dsb=0.8012, bio=0.0014
    Epoch 10/10: total=1.8862, vae=1.0827, dsb=0.8028, bio=0.0013

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=39.7472, vae=1.0849, dsb=38.6611, bio=0.0024
    Epoch  2/10: total=36.8028, vae=1.0837, dsb=35.7183, bio=0.0016
    Epoch  3/10: total=35.9935, vae=1.0826, dsb=34.9102, bio=0.0014
    Epoch  4/10: total=35.5728, vae=1.0826, dsb=34.4894, bio=0.0013
    Epoch  5/10: total=35.0259, vae=1.0826, dsb=33.9426, bio=0.0013
    Epoch  6/10: total=35.0513, vae=1.0829, dsb=33.9677, bio=0.0013
    Epoch  7/10: total=34.5514, vae=1.0820, dsb=33.4687, bio=0.0013
    Epoch  8/10: total=34.7035, vae=1.0827, dsb=33.6200, bio=0.0014
    Epoch  9/10: total=34.5241, vae=1.0813, dsb=33.4421, bio=0.0012
    Epoch 10/10: total=34.3989, vae=1.0821, dsb=33.3161, bio=0.0012

  [Backward Policy Training]
    Epoch  1/10: total=1.8271, vae=1.0836, dsb=0.7143, bio=0.0584
    Epoch  2/10: total=1.7247, vae=1.0816, dsb=0.6424, bio=0.0014
    Epoch  3/10: total=1.6964, vae=1.0820, dsb=0.6138, bio=0.0013
    Epoch  4/10: total=1.6851, vae=1.0811, dsb=0.6034, bio=0.0012
    Epoch  5/10: total=1.6752, vae=1.0823, dsb=0.5923, bio=0.0012
    Epoch  6/10: total=1.6714, vae=1.0814, dsb=0.5895, bio=0.0011
    Epoch  7/10: total=1.6534, vae=1.0817, dsb=0.5711, bio=0.0011
    Epoch  8/10: total=1.6638, vae=1.0821, dsb=0.5812, bio=0.0011
    Epoch  9/10: total=1.6515, vae=1.0820, dsb=0.5690, bio=0.0011
    Epoch 10/10: total=1.6653, vae=1.0819, dsb=0.5828, bio=0.0010

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=33.4433, vae=1.0848, dsb=32.3572, bio=0.0027
    Epoch  2/10: total=32.0654, vae=1.0828, dsb=30.9820, bio=0.0012
    Epoch  3/10: total=31.5644, vae=1.0820, dsb=30.4818, bio=0.0011
    Epoch  4/10: total=31.3451, vae=1.0817, dsb=30.2628, bio=0.0011
    Epoch  5/10: total=31.2611, vae=1.0818, dsb=30.1787, bio=0.0011
    Epoch  6/10: total=31.2595, vae=1.0824, dsb=30.1766, bio=0.0010
    Epoch  7/10: total=31.0660, vae=1.0825, dsb=29.9831, bio=0.0007
    Epoch  8/10: total=31.1435, vae=1.0817, dsb=30.0613, bio=0.0011
    Epoch  9/10: total=31.1709, vae=1.0815, dsb=30.0889, bio=0.0010
    Epoch 10/10: total=31.0992, vae=1.0814, dsb=30.0173, bio=0.0010

  [Backward Policy Training]
    Epoch  1/10: total=1.6551, vae=1.0823, dsb=0.4997, bio=0.1461
    Epoch  2/10: total=1.5632, vae=1.0814, dsb=0.4812, bio=0.0012
    Epoch  3/10: total=1.5494, vae=1.0819, dsb=0.4670, bio=0.0011
    Epoch  4/10: total=1.5350, vae=1.0816, dsb=0.4529, bio=0.0011
    Epoch  5/10: total=1.5322, vae=1.0815, dsb=0.4503, bio=0.0008
    Epoch  6/10: total=1.5425, vae=1.0812, dsb=0.4607, bio=0.0010
    Epoch  7/10: total=1.5270, vae=1.0811, dsb=0.4453, bio=0.0010
    Epoch  8/10: total=1.5313, vae=1.0819, dsb=0.4489, bio=0.0010
    Epoch  9/10: total=1.5265, vae=1.0808, dsb=0.4452, bio=0.0009
    Epoch 10/10: total=1.5363, vae=1.0811, dsb=0.4551, bio=0.0003

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=25.9084, vae=1.0832, dsb=24.8228, bio=0.0047
    Epoch  2/10: total=25.5242, vae=1.0819, dsb=24.4418, bio=0.0011
    Epoch  3/10: total=25.2928, vae=1.0824, dsb=24.2099, bio=0.0011
    Epoch  4/10: total=25.3746, vae=1.0830, dsb=24.2913, bio=0.0006
    Epoch  5/10: total=25.0625, vae=1.0816, dsb=23.9807, bio=0.0005
    Epoch  6/10: total=25.0594, vae=1.0818, dsb=23.9772, bio=0.0007
    Epoch  7/10: total=25.1041, vae=1.0821, dsb=24.0212, bio=0.0016
    Epoch  8/10: total=25.2119, vae=1.0819, dsb=24.1295, bio=0.0010
    Epoch  9/10: total=25.1566, vae=1.0811, dsb=24.0750, bio=0.0009
    Epoch 10/10: total=25.1605, vae=1.0822, dsb=24.0781, bio=0.0004

  [Backward Policy Training]
    Epoch  1/10: total=1.5488, vae=1.0825, dsb=0.3740, bio=0.1847
    Epoch  2/10: total=1.4413, vae=1.0818, dsb=0.3588, bio=0.0013
    Epoch  3/10: total=1.4425, vae=1.0815, dsb=0.3606, bio=0.0007
    Epoch  4/10: total=1.4339, vae=1.0810, dsb=0.3524, bio=0.0010
    Epoch  5/10: total=1.4264, vae=1.0816, dsb=0.3442, bio=0.0011
    Epoch  6/10: total=1.4274, vae=1.0804, dsb=0.3465, bio=0.0009
    Epoch  7/10: total=1.4251, vae=1.0799, dsb=0.3448, bio=0.0007
    Epoch  8/10: total=1.4201, vae=1.0806, dsb=0.3390, bio=0.0010
    Epoch  9/10: total=1.4363, vae=1.0803, dsb=0.3556, bio=0.0010
    Epoch 10/10: total=1.4266, vae=1.0799, dsb=0.3463, bio=0.0007

[Seed 100] Joint training (original) complete; models and history saved.

[Seed 100] Starting joint training (ablation)...

======================================================================
STAGE 1/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=310.0156, vae=1.9677, dsb=308.0479, bio=0.0000
    Epoch  2/10: total=86.1584, vae=1.0777, dsb=85.0807, bio=0.0000
    Epoch  3/10: total=73.7302, vae=1.0757, dsb=72.6545, bio=0.0000
    Epoch  4/10: total=67.7767, vae=1.0752, dsb=66.7014, bio=0.0000
    Epoch  5/10: total=64.5601, vae=1.0752, dsb=63.4848, bio=0.0000
    Epoch  6/10: total=62.1327, vae=1.0740, dsb=61.0587, bio=0.0000
    Epoch  7/10: total=60.5078, vae=1.0748, dsb=59.4330, bio=0.0000
    Epoch  8/10: total=59.3655, vae=1.0746, dsb=58.2909, bio=0.0000
    Epoch  9/10: total=58.0567, vae=1.0749, dsb=56.9818, bio=0.0000
    Epoch 10/10: total=57.5087, vae=1.0733, dsb=56.4354, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=3.1978, vae=1.0739, dsb=2.1239, bio=0.0000
    Epoch  2/10: total=2.7381, vae=1.0744, dsb=1.6637, bio=0.0000
    Epoch  3/10: total=2.6129, vae=1.0753, dsb=1.5376, bio=0.0000
    Epoch  4/10: total=2.5735, vae=1.0745, dsb=1.4989, bio=0.0000
    Epoch  5/10: total=2.4506, vae=1.0743, dsb=1.3762, bio=0.0000
    Epoch  6/10: total=2.3902, vae=1.0735, dsb=1.3167, bio=0.0000
    Epoch  7/10: total=2.3959, vae=1.0737, dsb=1.3223, bio=0.0000
    Epoch  8/10: total=2.3607, vae=1.0746, dsb=1.2861, bio=0.0000
    Epoch  9/10: total=2.4075, vae=1.0750, dsb=1.3325, bio=0.0000
    Epoch 10/10: total=2.3417, vae=1.0739, dsb=1.2678, bio=0.0000

======================================================================
STAGE 2/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=55.2966, vae=1.0737, dsb=54.2229, bio=0.0000
    Epoch  2/10: total=47.1477, vae=1.0743, dsb=46.0734, bio=0.0000
    Epoch  3/10: total=45.3187, vae=1.0739, dsb=44.2448, bio=0.0000
    Epoch  4/10: total=44.1239, vae=1.0735, dsb=43.0504, bio=0.0000
    Epoch  5/10: total=43.5689, vae=1.0745, dsb=42.4944, bio=0.0000
    Epoch  6/10: total=43.3580, vae=1.0737, dsb=42.2844, bio=0.0000
    Epoch  7/10: total=42.8818, vae=1.0736, dsb=41.8082, bio=0.0000
    Epoch  8/10: total=42.5672, vae=1.0744, dsb=41.4928, bio=0.0000
    Epoch  9/10: total=42.1310, vae=1.0743, dsb=41.0568, bio=0.0000
    Epoch 10/10: total=41.8871, vae=1.0740, dsb=40.8130, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=2.0837, vae=1.0743, dsb=1.0094, bio=0.0000
    Epoch  2/10: total=1.9337, vae=1.0733, dsb=0.8604, bio=0.0000
    Epoch  3/10: total=1.9067, vae=1.0745, dsb=0.8322, bio=0.0000
    Epoch  4/10: total=1.9006, vae=1.0742, dsb=0.8263, bio=0.0000
    Epoch  5/10: total=1.8720, vae=1.0740, dsb=0.7980, bio=0.0000
    Epoch  6/10: total=1.8685, vae=1.0743, dsb=0.7942, bio=0.0000
    Epoch  7/10: total=1.8236, vae=1.0737, dsb=0.7499, bio=0.0000
    Epoch  8/10: total=1.8257, vae=1.0739, dsb=0.7517, bio=0.0000
    Epoch  9/10: total=1.8219, vae=1.0737, dsb=0.7481, bio=0.0000
    Epoch 10/10: total=1.8241, vae=1.0745, dsb=0.7496, bio=0.0000

======================================================================
STAGE 3/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=38.0180, vae=1.0742, dsb=36.9438, bio=0.0000
    Epoch  2/10: total=35.1019, vae=1.0744, dsb=34.0275, bio=0.0000
    Epoch  3/10: total=34.2774, vae=1.0734, dsb=33.2039, bio=0.0000
    Epoch  4/10: total=33.9288, vae=1.0736, dsb=32.8552, bio=0.0000
    Epoch  5/10: total=33.4542, vae=1.0738, dsb=32.3804, bio=0.0000
    Epoch  6/10: total=33.5000, vae=1.0742, dsb=32.4258, bio=0.0000
    Epoch  7/10: total=33.0421, vae=1.0734, dsb=31.9686, bio=0.0000
    Epoch  8/10: total=33.1840, vae=1.0742, dsb=32.1098, bio=0.0000
    Epoch  9/10: total=32.9986, vae=1.0730, dsb=31.9255, bio=0.0000
    Epoch 10/10: total=32.9651, vae=1.0739, dsb=31.8912, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.7258, vae=1.0742, dsb=0.6516, bio=0.0000
    Epoch  2/10: total=1.6583, vae=1.0734, dsb=0.5849, bio=0.0000
    Epoch  3/10: total=1.6334, vae=1.0740, dsb=0.5594, bio=0.0000
    Epoch  4/10: total=1.6240, vae=1.0731, dsb=0.5509, bio=0.0000
    Epoch  5/10: total=1.6151, vae=1.0745, dsb=0.5406, bio=0.0000
    Epoch  6/10: total=1.6117, vae=1.0735, dsb=0.5382, bio=0.0000
    Epoch  7/10: total=1.5961, vae=1.0740, dsb=0.5221, bio=0.0000
    Epoch  8/10: total=1.6060, vae=1.0743, dsb=0.5317, bio=0.0000
    Epoch  9/10: total=1.5951, vae=1.0742, dsb=0.5208, bio=0.0000
    Epoch 10/10: total=1.6085, vae=1.0744, dsb=0.5341, bio=0.0000

======================================================================
STAGE 4/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=31.4430, vae=1.0747, dsb=30.3683, bio=0.0000
    Epoch  2/10: total=30.2256, vae=1.0740, dsb=29.1516, bio=0.0000
    Epoch  3/10: total=29.7823, vae=1.0737, dsb=28.7087, bio=0.0000
    Epoch  4/10: total=29.6226, vae=1.0735, dsb=28.5491, bio=0.0000
    Epoch  5/10: total=29.5485, vae=1.0738, dsb=28.4747, bio=0.0000
    Epoch  6/10: total=29.5560, vae=1.0745, dsb=28.4815, bio=0.0000
    Epoch  7/10: total=29.3626, vae=1.0746, dsb=28.2880, bio=0.0000
    Epoch  8/10: total=29.4206, vae=1.0740, dsb=28.3466, bio=0.0000
    Epoch  9/10: total=29.4680, vae=1.0738, dsb=28.3942, bio=0.0000
    Epoch 10/10: total=29.3932, vae=1.0738, dsb=28.3194, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.5297, vae=1.0732, dsb=0.4566, bio=0.0000
    Epoch  2/10: total=1.5145, vae=1.0737, dsb=0.4408, bio=0.0000
    Epoch  3/10: total=1.5035, vae=1.0743, dsb=0.4292, bio=0.0000
    Epoch  4/10: total=1.4907, vae=1.0741, dsb=0.4167, bio=0.0000
    Epoch  5/10: total=1.4891, vae=1.0741, dsb=0.4149, bio=0.0000
    Epoch  6/10: total=1.4994, vae=1.0740, dsb=0.4254, bio=0.0000
    Epoch  7/10: total=1.4853, vae=1.0739, dsb=0.4113, bio=0.0000
    Epoch  8/10: total=1.4898, vae=1.0748, dsb=0.4150, bio=0.0000
    Epoch  9/10: total=1.4858, vae=1.0737, dsb=0.4121, bio=0.0000
    Epoch 10/10: total=1.4959, vae=1.0741, dsb=0.4218, bio=0.0000

======================================================================
STAGE 5/5
======================================================================

  [Forward Policy Training]
    Epoch  1/10: total=24.8971, vae=1.0733, dsb=23.8238, bio=0.0000
    Epoch  2/10: total=24.5516, vae=1.0732, dsb=23.4785, bio=0.0000
    Epoch  3/10: total=24.3750, vae=1.0739, dsb=23.3012, bio=0.0000
    Epoch  4/10: total=24.4212, vae=1.0747, dsb=23.3464, bio=0.0000
    Epoch  5/10: total=24.1840, vae=1.0737, dsb=23.1103, bio=0.0000
    Epoch  6/10: total=24.1624, vae=1.0740, dsb=23.0884, bio=0.0000
    Epoch  7/10: total=24.2241, vae=1.0745, dsb=23.1496, bio=0.0000
    Epoch  8/10: total=24.2721, vae=1.0742, dsb=23.1979, bio=0.0000
    Epoch  9/10: total=24.2726, vae=1.0735, dsb=23.1991, bio=0.0000
    Epoch 10/10: total=24.2480, vae=1.0747, dsb=23.1733, bio=0.0000

  [Backward Policy Training]
    Epoch  1/10: total=1.4200, vae=1.0735, dsb=0.3465, bio=0.0000
    Epoch  2/10: total=1.4083, vae=1.0742, dsb=0.3341, bio=0.0000
    Epoch  3/10: total=1.4103, vae=1.0740, dsb=0.3363, bio=0.0000
    Epoch  4/10: total=1.4027, vae=1.0739, dsb=0.3288, bio=0.0000
    Epoch  5/10: total=1.3960, vae=1.0746, dsb=0.3213, bio=0.0000
    Epoch  6/10: total=1.3972, vae=1.0735, dsb=0.3237, bio=0.0000
    Epoch  7/10: total=1.3955, vae=1.0731, dsb=0.3224, bio=0.0000
    Epoch  8/10: total=1.3906, vae=1.0739, dsb=0.3167, bio=0.0000
    Epoch  9/10: total=1.4065, vae=1.0736, dsb=0.3329, bio=0.0000
    Epoch 10/10: total=1.3974, vae=1.0733, dsb=0.3242, bio=0.0000

[Seed 100] Joint training (ablation) complete; models and history saved.

[Seed 100] Drift genes saved in /home/yyuan/ICB_TCE/iter_results/run_100

[Seed 100] run finished.
